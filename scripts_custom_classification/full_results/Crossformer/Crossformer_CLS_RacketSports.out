Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.371351718902588
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.790 Vali Acc: 0.230 Test Loss: 1.790 Test Acc: 0.230
Validation loss decreased (inf --> -0.230245).  Saving model ...
Epoch: 2 cost time: 1.3485360145568848
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.420 Vali Acc: 0.329 Test Loss: 1.420 Test Acc: 0.329
Validation loss decreased (-0.230245 --> -0.328933).  Saving model ...
Epoch: 3 cost time: 1.2826735973358154
Epoch: 3, Steps: 10 | Train Loss: 0.973 Vali Loss: 0.921 Vali Acc: 0.566 Test Loss: 0.921 Test Acc: 0.566
Validation loss decreased (-0.328933 --> -0.565780).  Saving model ...
Epoch: 4 cost time: 1.3285651206970215
Epoch: 4, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.824 Vali Acc: 0.638 Test Loss: 0.824 Test Acc: 0.638
Validation loss decreased (-0.565780 --> -0.638150).  Saving model ...
Epoch: 5 cost time: 1.2878241539001465
Epoch: 5, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.741 Vali Acc: 0.717 Test Loss: 0.741 Test Acc: 0.717
Validation loss decreased (-0.638150 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.3801302909851074
Epoch: 6, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756572).  Saving model ...
Epoch: 7 cost time: 1.4127352237701416
Epoch: 7, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782889).  Saving model ...
Epoch: 8 cost time: 1.5129568576812744
Epoch: 8, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.4531633853912354
Epoch: 9, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.750 Vali Acc: 0.770 Test Loss: 0.750 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3980822563171387
Epoch: 10, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.762 Vali Acc: 0.783 Test Loss: 0.762 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.230675220489502
Epoch: 11, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.674 Vali Acc: 0.776 Test Loss: 0.674 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5497715473175049
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.678 Vali Acc: 0.783 Test Loss: 0.678 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7961022853851318
Epoch: 13, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.813 Vali Acc: 0.776 Test Loss: 0.813 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7168264389038086
Epoch: 14, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.838 Vali Acc: 0.770 Test Loss: 0.838 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.7297115325927734
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.147900342941284
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.811 Vali Acc: 0.789 Test Loss: 0.811 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6967551708221436
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.889 Vali Acc: 0.750 Test Loss: 0.889 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4995872974395752
Epoch: 18, Steps: 10 | Train Loss: 0.076 Vali Loss: 1.004 Vali Acc: 0.776 Test Loss: 1.004 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 14269248
model size : 59.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1715002059936523
Epoch: 1, Steps: 10 | Train Loss: 1.589 Vali Loss: 1.480 Vali Acc: 0.237 Test Loss: 1.480 Test Acc: 0.237
Validation loss decreased (inf --> -0.236827).  Saving model ...
Epoch: 2 cost time: 1.6154351234436035
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.184 Vali Acc: 0.414 Test Loss: 1.184 Test Acc: 0.414
Validation loss decreased (-0.236827 --> -0.414462).  Saving model ...
Epoch: 3 cost time: 1.4808526039123535
Epoch: 3, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.128 Vali Acc: 0.382 Test Loss: 1.128 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.404623031616211
Epoch: 4, Steps: 10 | Train Loss: 0.788 Vali Loss: 1.040 Vali Acc: 0.533 Test Loss: 1.040 Test Acc: 0.533
Validation loss decreased (-0.414462 --> -0.532884).  Saving model ...
Epoch: 5 cost time: 1.478569746017456
Epoch: 5, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.815 Vali Acc: 0.704 Test Loss: 0.815 Test Acc: 0.704
Validation loss decreased (-0.532884 --> -0.703939).  Saving model ...
Epoch: 6 cost time: 1.5748207569122314
Epoch: 6, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
Validation loss decreased (-0.703939 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.6214962005615234
Epoch: 7, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 8 cost time: 1.4511709213256836
Epoch: 8, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7023866176605225
Epoch: 9, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3232181072235107
Epoch: 10, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.686 Vali Acc: 0.796 Test Loss: 0.686 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3427200317382812
Epoch: 11, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6049792766571045
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.774 Vali Acc: 0.803 Test Loss: 0.774 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 13 cost time: 1.5655455589294434
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6238629817962646
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4940853118896484
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.715 Vali Acc: 0.776 Test Loss: 0.715 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6469461917877197
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.787 Vali Acc: 0.796 Test Loss: 0.787 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4162828922271729
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.739 Vali Acc: 0.836 Test Loss: 0.739 Test Acc: 0.836
Validation loss decreased (-0.802624 --> -0.835519).  Saving model ...
Epoch: 18 cost time: 1.4704453945159912
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.878 Vali Acc: 0.803 Test Loss: 0.878 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4174237251281738
Epoch: 19, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.762 Vali Acc: 0.809 Test Loss: 0.762 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.622128963470459
Epoch: 20, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.913 Vali Acc: 0.822 Test Loss: 0.913 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5344929695129395
Epoch: 21, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.978 Vali Acc: 0.783 Test Loss: 0.978 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.514195442199707
Epoch: 22, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.827 Vali Acc: 0.809 Test Loss: 0.827 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.767488956451416
Epoch: 23, Steps: 10 | Train Loss: 0.081 Vali Loss: 1.098 Vali Acc: 0.803 Test Loss: 1.098 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3893418312072754
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.068 Vali Acc: 0.836 Test Loss: 1.068 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.5378186702728271
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.203 Vali Acc: 0.763 Test Loss: 1.203 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4607584476470947
Epoch: 26, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.809 Vali Acc: 0.763 Test Loss: 0.809 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.6276564598083496
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.852 Vali Acc: 0.750 Test Loss: 0.852 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 14267456
model size : 59.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6447901725769043
Epoch: 1, Steps: 10 | Train Loss: 1.605 Vali Loss: 1.691 Vali Acc: 0.316 Test Loss: 1.691 Test Acc: 0.316
Validation loss decreased (inf --> -0.315773).  Saving model ...
Epoch: 2 cost time: 1.728285312652588
Epoch: 2, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.388 Vali Acc: 0.257 Test Loss: 1.388 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5872304439544678
Epoch: 3, Steps: 10 | Train Loss: 1.079 Vali Loss: 0.906 Vali Acc: 0.704 Test Loss: 0.906 Test Acc: 0.704
Validation loss decreased (-0.315773 --> -0.703938).  Saving model ...
Epoch: 4 cost time: 1.4515926837921143
Epoch: 4, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.940 Vali Acc: 0.632 Test Loss: 0.940 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.223828077316284
Epoch: 5, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.887 Vali Acc: 0.671 Test Loss: 0.887 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6200170516967773
Epoch: 6, Steps: 10 | Train Loss: 0.537 Vali Loss: 1.069 Vali Acc: 0.638 Test Loss: 1.069 Test Acc: 0.638
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5151193141937256
Epoch: 7, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.606 Vali Acc: 0.757 Test Loss: 0.606 Test Acc: 0.757
Validation loss decreased (-0.703938 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.568253993988037
Epoch: 8, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.671 Vali Acc: 0.770 Test Loss: 0.671 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769730).  Saving model ...
Epoch: 9 cost time: 1.6947362422943115
Epoch: 9, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.636 Vali Acc: 0.783 Test Loss: 0.636 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782888).  Saving model ...
Epoch: 10 cost time: 1.7909162044525146
Epoch: 10, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.552 Vali Acc: 0.770 Test Loss: 0.552 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9811360836029053
Epoch: 11, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
Validation loss decreased (-0.782888 --> -0.809204).  Saving model ...
Epoch: 12 cost time: 1.916107177734375
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.783 Vali Acc: 0.789 Test Loss: 0.783 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.786473274230957
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.706 Vali Acc: 0.816 Test Loss: 0.706 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815782).  Saving model ...
Epoch: 14 cost time: 1.9999845027923584
Epoch: 14, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.709 Vali Acc: 0.803 Test Loss: 0.709 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9145174026489258
Epoch: 15, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.951399564743042
Epoch: 16, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.686 Vali Acc: 0.789 Test Loss: 0.686 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8451805114746094
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.759 Vali Acc: 0.789 Test Loss: 0.759 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9042150974273682
Epoch: 18, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.811 Vali Acc: 0.803 Test Loss: 0.811 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9294686317443848
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.826 Vali Acc: 0.803 Test Loss: 0.826 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.143026113510132
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.947 Vali Acc: 0.789 Test Loss: 0.947 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8815176486968994
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.885 Vali Acc: 0.816 Test Loss: 0.885 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6649885177612305
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.932 Vali Acc: 0.822 Test Loss: 0.932 Test Acc: 0.822
Validation loss decreased (-0.815782 --> -0.822359).  Saving model ...
Epoch: 23 cost time: 1.6515021324157715
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.957 Vali Acc: 0.816 Test Loss: 0.957 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.71689772605896
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.961 Vali Acc: 0.809 Test Loss: 0.961 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.120819568634033
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.970 Vali Acc: 0.816 Test Loss: 0.970 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.680450201034546
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.983 Vali Acc: 0.809 Test Loss: 0.983 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8919577598571777
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.816 Test Loss: 0.994 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7544028759002686
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.816 Test Loss: 1.001 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9190795421600342
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.008 Vali Acc: 0.809 Test Loss: 1.008 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9144978523254395
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.014 Vali Acc: 0.809 Test Loss: 1.014 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.0221123695373535
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.024 Vali Acc: 0.809 Test Loss: 1.024 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7102410793304443
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.031 Vali Acc: 0.809 Test Loss: 1.031 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 14265664
model size : 59.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.8171772956848145
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.354 Vali Acc: 0.322 Test Loss: 1.354 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 2.0813965797424316
Epoch: 2, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.172 Vali Acc: 0.493 Test Loss: 1.172 Test Acc: 0.493
Validation loss decreased (-0.322355 --> -0.493409).  Saving model ...
Epoch: 3 cost time: 2.5471675395965576
Epoch: 3, Steps: 10 | Train Loss: 0.960 Vali Loss: 0.939 Vali Acc: 0.618 Test Loss: 0.939 Test Acc: 0.618
Validation loss decreased (-0.493409 --> -0.618412).  Saving model ...
Epoch: 4 cost time: 2.6007802486419678
Epoch: 4, Steps: 10 | Train Loss: 0.770 Vali Loss: 0.708 Vali Acc: 0.651 Test Loss: 0.708 Test Acc: 0.651
Validation loss decreased (-0.618412 --> -0.651309).  Saving model ...
Epoch: 5 cost time: 2.1875033378601074
Epoch: 5, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.799 Vali Acc: 0.632 Test Loss: 0.799 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0978550910949707
Epoch: 6, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
Validation loss decreased (-0.651309 --> -0.776311).  Saving model ...
Epoch: 7 cost time: 2.2876555919647217
Epoch: 7, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.687 Vali Acc: 0.750 Test Loss: 0.687 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.325098991394043
Epoch: 8, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.743 Vali Acc: 0.789 Test Loss: 0.743 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789466).  Saving model ...
Epoch: 9 cost time: 2.106114149093628
Epoch: 9, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.334587335586548
Epoch: 10, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.553 Vali Acc: 0.796 Test Loss: 0.553 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 2.170836925506592
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3311116695404053
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.685 Vali Acc: 0.789 Test Loss: 0.685 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.539689540863037
Epoch: 13, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.737 Vali Acc: 0.783 Test Loss: 0.737 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.029639720916748
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.846 Vali Acc: 0.789 Test Loss: 0.846 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1523513793945312
Epoch: 15, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.876 Vali Acc: 0.816 Test Loss: 0.876 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815781).  Saving model ...
Epoch: 16 cost time: 2.4919073581695557
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.788 Vali Acc: 0.796 Test Loss: 0.788 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8310868740081787
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.894 Vali Acc: 0.809 Test Loss: 0.894 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9775569438934326
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.809 Vali Acc: 0.803 Test Loss: 0.809 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0569989681243896
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.969 Vali Acc: 0.803 Test Loss: 0.969 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0815165042877197
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.221 Vali Acc: 0.757 Test Loss: 1.221 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.794557809829712
Epoch: 21, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.233 Vali Acc: 0.783 Test Loss: 1.233 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9380714893341064
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.906 Vali Acc: 0.783 Test Loss: 0.906 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.211249828338623
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.790 Vali Acc: 0.783 Test Loss: 0.790 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.949566125869751
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.873 Vali Acc: 0.770 Test Loss: 0.873 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.1915037631988525
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.950 Vali Acc: 0.816 Test Loss: 0.950 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 14263872
model size : 59.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.156745195388794
Epoch: 1, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.346 Vali Acc: 0.349 Test Loss: 1.346 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.9048779010772705
Epoch: 2, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.135 Vali Acc: 0.500 Test Loss: 1.135 Test Acc: 0.500
Validation loss decreased (-0.348671 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 1.8484013080596924
Epoch: 3, Steps: 10 | Train Loss: 0.998 Vali Loss: 0.943 Vali Acc: 0.638 Test Loss: 0.943 Test Acc: 0.638
Validation loss decreased (-0.499989 --> -0.638148).  Saving model ...
Epoch: 4 cost time: 1.9450960159301758
Epoch: 4, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.733 Vali Acc: 0.704 Test Loss: 0.733 Test Acc: 0.704
Validation loss decreased (-0.638148 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 1.7872512340545654
Epoch: 5, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
Validation loss decreased (-0.703940 --> -0.756573).  Saving model ...
Epoch: 6 cost time: 1.691429853439331
Epoch: 6, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.693 Vali Acc: 0.743 Test Loss: 0.693 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.714144229888916
Epoch: 7, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.600 Vali Acc: 0.750 Test Loss: 0.600 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8152291774749756
Epoch: 8, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.016301393508911
Epoch: 9, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.771 Vali Acc: 0.783 Test Loss: 0.771 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782887).  Saving model ...
Epoch: 10 cost time: 1.8553745746612549
Epoch: 10, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.837 Vali Acc: 0.737 Test Loss: 0.837 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7060956954956055
Epoch: 11, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.710 Vali Acc: 0.783 Test Loss: 0.710 Test Acc: 0.783
Validation loss decreased (-0.782887 --> -0.782888).  Saving model ...
Epoch: 12 cost time: 1.624408483505249
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 1.118 Vali Acc: 0.770 Test Loss: 1.118 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.721813440322876
Epoch: 13, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.724 Vali Acc: 0.763 Test Loss: 0.724 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6465439796447754
Epoch: 14, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.764 Vali Acc: 0.770 Test Loss: 0.764 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7157416343688965
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.887 Vali Acc: 0.770 Test Loss: 0.887 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8552558422088623
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.949 Vali Acc: 0.763 Test Loss: 0.949 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.733734369277954
Epoch: 17, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.761 Vali Acc: 0.789 Test Loss: 0.761 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789466).  Saving model ...
Epoch: 18 cost time: 1.7106659412384033
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.827 Vali Acc: 0.757 Test Loss: 0.827 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6820993423461914
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.799 Vali Acc: 0.783 Test Loss: 0.799 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7775843143463135
Epoch: 20, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.812 Vali Acc: 0.776 Test Loss: 0.812 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.728804349899292
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.981 Vali Acc: 0.724 Test Loss: 0.981 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.150589942932129
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.947 Vali Acc: 0.789 Test Loss: 0.947 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.95701003074646
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.914 Vali Acc: 0.803 Test Loss: 0.914 Test Acc: 0.803
Validation loss decreased (-0.789466 --> -0.802622).  Saving model ...
Epoch: 24 cost time: 2.0184166431427
Epoch: 24, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.852 Vali Acc: 0.796 Test Loss: 0.852 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.5059914588928223
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.968 Vali Acc: 0.750 Test Loss: 0.968 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.278738260269165
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.944 Vali Acc: 0.750 Test Loss: 0.944 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4544107913970947
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.813 Vali Acc: 0.770 Test Loss: 0.813 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.423248767852783
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.953 Vali Acc: 0.776 Test Loss: 0.953 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.196821689605713
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.045 Vali Acc: 0.757 Test Loss: 1.045 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.447087287902832
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.123 Vali Acc: 0.789 Test Loss: 1.123 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.0260539054870605
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.279 Vali Acc: 0.783 Test Loss: 1.279 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.5362141132354736
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.313 Vali Acc: 0.750 Test Loss: 1.313 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9947361946105957
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.315 Vali Acc: 0.750 Test Loss: 1.315 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 11905344
model size : 50.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.190534830093384
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.445 Vali Acc: 0.283 Test Loss: 1.445 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 2.1257433891296387
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.109 Vali Acc: 0.632 Test Loss: 1.109 Test Acc: 0.632
Validation loss decreased (-0.282880 --> -0.631568).  Saving model ...
Epoch: 3 cost time: 2.283782482147217
Epoch: 3, Steps: 10 | Train Loss: 0.987 Vali Loss: 0.908 Vali Acc: 0.632 Test Loss: 0.908 Test Acc: 0.632
Validation loss decreased (-0.631568 --> -0.631570).  Saving model ...
Epoch: 4 cost time: 2.1169958114624023
Epoch: 4, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.743 Vali Acc: 0.684 Test Loss: 0.743 Test Acc: 0.684
Validation loss decreased (-0.631570 --> -0.684203).  Saving model ...
Epoch: 5 cost time: 2.3147594928741455
Epoch: 5, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.690 Vali Acc: 0.724 Test Loss: 0.690 Test Acc: 0.724
Validation loss decreased (-0.684203 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.9457290172576904
Epoch: 6, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.781 Vali Acc: 0.671 Test Loss: 0.781 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9098176956176758
Epoch: 7, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 2.165285110473633
Epoch: 8, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.714 Vali Acc: 0.757 Test Loss: 0.714 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0062406063079834
Epoch: 9, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782888).  Saving model ...
Epoch: 10 cost time: 1.7878341674804688
Epoch: 10, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.865 Vali Acc: 0.757 Test Loss: 0.865 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9919843673706055
Epoch: 11, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.692 Vali Acc: 0.770 Test Loss: 0.692 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2424941062927246
Epoch: 12, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.742 Vali Acc: 0.750 Test Loss: 0.742 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2365777492523193
Epoch: 13, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 14 cost time: 1.7025575637817383
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.781 Vali Acc: 0.783 Test Loss: 0.781 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.54892897605896
Epoch: 15, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.687 Vali Acc: 0.803 Test Loss: 0.687 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 16 cost time: 2.1280086040496826
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.721 Vali Acc: 0.789 Test Loss: 0.721 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.135348081588745
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.755 Vali Acc: 0.776 Test Loss: 0.755 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.117825746536255
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.827 Vali Acc: 0.783 Test Loss: 0.827 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0844390392303467
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.845 Vali Acc: 0.803 Test Loss: 0.845 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.2548060417175293
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.846 Vali Acc: 0.796 Test Loss: 0.846 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9451303482055664
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.897 Vali Acc: 0.803 Test Loss: 0.897 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.264376163482666
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.921 Vali Acc: 0.796 Test Loss: 0.921 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.1885769367218018
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.809 Test Loss: 0.960 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809201).  Saving model ...
Epoch: 24 cost time: 2.1668264865875244
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.970 Vali Acc: 0.809 Test Loss: 0.970 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.876976728439331
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.970 Vali Acc: 0.809 Test Loss: 0.970 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9822676181793213
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.971 Vali Acc: 0.803 Test Loss: 0.971 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8112280368804932
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.975 Vali Acc: 0.809 Test Loss: 0.975 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.147534132003784
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.982 Vali Acc: 0.809 Test Loss: 0.982 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.898038387298584
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.789 Test Loss: 0.991 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.082827091217041
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.994 Vali Acc: 0.803 Test Loss: 0.994 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.1522891521453857
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.004 Vali Acc: 0.803 Test Loss: 1.004 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.2833645343780518
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.006 Vali Acc: 0.803 Test Loss: 1.006 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9850561618804932
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.010 Vali Acc: 0.803 Test Loss: 1.010 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 11903552
model size : 50.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7160768508911133
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.419 Vali Acc: 0.243 Test Loss: 1.419 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.7470836639404297
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.352 Vali Acc: 0.283 Test Loss: 1.352 Test Acc: 0.283
Validation loss decreased (-0.243407 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.7906737327575684
Epoch: 3, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.000 Vali Acc: 0.586 Test Loss: 1.000 Test Acc: 0.586
Validation loss decreased (-0.282881 --> -0.585516).  Saving model ...
Epoch: 4 cost time: 1.6376476287841797
Epoch: 4, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.690 Vali Acc: 0.691 Test Loss: 0.690 Test Acc: 0.691
Validation loss decreased (-0.585516 --> -0.690783).  Saving model ...
Epoch: 5 cost time: 1.7456073760986328
Epoch: 5, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.569 Vali Acc: 0.757 Test Loss: 0.569 Test Acc: 0.757
Validation loss decreased (-0.690783 --> -0.756573).  Saving model ...
Epoch: 6 cost time: 1.633223295211792
Epoch: 6, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.591 Vali Acc: 0.743 Test Loss: 0.591 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.081155300140381
Epoch: 7, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.663 Vali Acc: 0.757 Test Loss: 0.663 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.760305643081665
Epoch: 8, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 2.016835927963257
Epoch: 9, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.636 Vali Acc: 0.783 Test Loss: 0.636 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7567284107208252
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.811 Vali Acc: 0.783 Test Loss: 0.811 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.737595796585083
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.871 Vali Acc: 0.783 Test Loss: 0.871 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.813995361328125
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 1.296 Vali Acc: 0.783 Test Loss: 1.296 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4827332496643066
Epoch: 13, Steps: 10 | Train Loss: 0.338 Vali Loss: 1.395 Vali Acc: 0.757 Test Loss: 1.395 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7987918853759766
Epoch: 14, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.986 Vali Acc: 0.763 Test Loss: 0.986 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.671271562576294
Epoch: 15, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.898 Vali Acc: 0.776 Test Loss: 0.898 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8149471282958984
Epoch: 16, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.730 Vali Acc: 0.803 Test Loss: 0.730 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802624).  Saving model ...
Epoch: 17 cost time: 1.6070234775543213
Epoch: 17, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.781 Vali Acc: 0.743 Test Loss: 0.781 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8411972522735596
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.744 Vali Acc: 0.789 Test Loss: 0.744 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.899742841720581
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.889 Vali Acc: 0.743 Test Loss: 0.889 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8746395111083984
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.964 Vali Acc: 0.770 Test Loss: 0.964 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9410083293914795
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.137 Vali Acc: 0.743 Test Loss: 1.137 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5960040092468262
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.937 Vali Acc: 0.783 Test Loss: 0.937 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.8927783966064453
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.837 Vali Acc: 0.783 Test Loss: 0.837 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.801710605621338
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.839 Vali Acc: 0.789 Test Loss: 0.839 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.972656488418579
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.908 Vali Acc: 0.783 Test Loss: 0.908 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.538191795349121
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.034 Vali Acc: 0.783 Test Loss: 1.034 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 11901760
model size : 50.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.386664390563965
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.428 Vali Acc: 0.289 Test Loss: 1.428 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 1.9696002006530762
Epoch: 2, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.165 Vali Acc: 0.559 Test Loss: 1.165 Test Acc: 0.559
Validation loss decreased (-0.289459 --> -0.559199).  Saving model ...
Epoch: 3 cost time: 1.7972018718719482
Epoch: 3, Steps: 10 | Train Loss: 0.981 Vali Loss: 0.944 Vali Acc: 0.599 Test Loss: 0.944 Test Acc: 0.599
Validation loss decreased (-0.559199 --> -0.598675).  Saving model ...
Epoch: 4 cost time: 1.629270076751709
Epoch: 4, Steps: 10 | Train Loss: 0.825 Vali Loss: 1.370 Vali Acc: 0.414 Test Loss: 1.370 Test Acc: 0.414
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.1543378829956055
Epoch: 5, Steps: 10 | Train Loss: 0.896 Vali Loss: 0.649 Vali Acc: 0.704 Test Loss: 0.649 Test Acc: 0.704
Validation loss decreased (-0.598675 --> -0.703941).  Saving model ...
Epoch: 6 cost time: 1.8350491523742676
Epoch: 6, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.591 Vali Acc: 0.743 Test Loss: 0.591 Test Acc: 0.743
Validation loss decreased (-0.703941 --> -0.743415).  Saving model ...
Epoch: 7 cost time: 1.768592119216919
Epoch: 7, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.569 Vali Acc: 0.743 Test Loss: 0.569 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.6863698959350586
Epoch: 8, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.685 Vali Acc: 0.776 Test Loss: 0.685 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776309).  Saving model ...
Epoch: 9 cost time: 1.7740662097930908
Epoch: 9, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5671789646148682
Epoch: 10, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.709 Vali Acc: 0.757 Test Loss: 0.709 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8205690383911133
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.717 Vali Acc: 0.776 Test Loss: 0.717 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.036792755126953
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.742 Vali Acc: 0.783 Test Loss: 0.742 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782887).  Saving model ...
Epoch: 13 cost time: 2.078503370285034
Epoch: 13, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.772 Vali Acc: 0.763 Test Loss: 0.772 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.175668478012085
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.873 Vali Acc: 0.770 Test Loss: 0.873 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7739357948303223
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.072 Vali Acc: 0.750 Test Loss: 1.072 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7521162033081055
Epoch: 16, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.975 Vali Acc: 0.757 Test Loss: 0.975 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8242716789245605
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.748 Vali Acc: 0.763 Test Loss: 0.748 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7828707695007324
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.741 Vali Acc: 0.783 Test Loss: 0.741 Test Acc: 0.783
Validation loss decreased (-0.782887 --> -0.782887).  Saving model ...
Epoch: 19 cost time: 1.8821110725402832
Epoch: 19, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.839 Vali Acc: 0.803 Test Loss: 0.839 Test Acc: 0.803
Validation loss decreased (-0.782887 --> -0.802623).  Saving model ...
Epoch: 20 cost time: 1.904839038848877
Epoch: 20, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.682 Vali Acc: 0.803 Test Loss: 0.682 Test Acc: 0.803
Validation loss decreased (-0.802623 --> -0.802625).  Saving model ...
Epoch: 21 cost time: 1.8362176418304443
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.787 Vali Acc: 0.789 Test Loss: 0.787 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0593719482421875
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.837 Vali Acc: 0.796 Test Loss: 0.837 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6276249885559082
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.112 Vali Acc: 0.770 Test Loss: 1.112 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6987733840942383
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.039 Vali Acc: 0.783 Test Loss: 1.039 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5511260032653809
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.986 Vali Acc: 0.770 Test Loss: 0.986 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8359098434448242
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.055 Vali Acc: 0.789 Test Loss: 1.055 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8480966091156006
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.065 Vali Acc: 0.803 Test Loss: 1.065 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7667551040649414
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.178 Vali Acc: 0.783 Test Loss: 1.178 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5741126537322998
Epoch: 29, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.199 Vali Acc: 0.757 Test Loss: 1.199 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.48433518409729
Epoch: 30, Steps: 10 | Train Loss: 0.113 Vali Loss: 1.019 Vali Acc: 0.770 Test Loss: 1.019 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 11899968
model size : 50.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.039882183074951
Epoch: 1, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.622 Vali Acc: 0.283 Test Loss: 1.622 Test Acc: 0.283
Validation loss decreased (inf --> -0.282879).  Saving model ...
Epoch: 2 cost time: 1.6178691387176514
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.222 Vali Acc: 0.388 Test Loss: 1.222 Test Acc: 0.388
Validation loss decreased (-0.282879 --> -0.388146).  Saving model ...
Epoch: 3 cost time: 1.638310432434082
Epoch: 3, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.098 Vali Acc: 0.513 Test Loss: 1.098 Test Acc: 0.513
Validation loss decreased (-0.388146 --> -0.513147).  Saving model ...
Epoch: 4 cost time: 1.6875231266021729
Epoch: 4, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.890 Vali Acc: 0.592 Test Loss: 0.890 Test Acc: 0.592
Validation loss decreased (-0.513147 --> -0.592096).  Saving model ...
Epoch: 5 cost time: 2.302377939224243
Epoch: 5, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.727 Vali Acc: 0.724 Test Loss: 0.727 Test Acc: 0.724
Validation loss decreased (-0.592096 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.6707088947296143
Epoch: 6, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.803 Vali Acc: 0.697 Test Loss: 0.803 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8602182865142822
Epoch: 7, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.703 Vali Acc: 0.763 Test Loss: 0.703 Test Acc: 0.763
Validation loss decreased (-0.723677 --> -0.763151).  Saving model ...
Epoch: 8 cost time: 1.528627634048462
Epoch: 8, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.873 Vali Acc: 0.704 Test Loss: 0.873 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.767735481262207
Epoch: 9, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.670 Vali Acc: 0.743 Test Loss: 0.670 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.507267951965332
Epoch: 10, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.691 Vali Acc: 0.763 Test Loss: 0.691 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 11 cost time: 1.4968526363372803
Epoch: 11, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
Validation loss decreased (-0.763151 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 1.7712984085083008
Epoch: 12, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.837 Vali Acc: 0.743 Test Loss: 0.837 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7720954418182373
Epoch: 13, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.877 Vali Acc: 0.763 Test Loss: 0.877 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8022000789642334
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.719 Vali Acc: 0.730 Test Loss: 0.719 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.3636977672576904
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.707 Vali Acc: 0.750 Test Loss: 0.707 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9570894241333008
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.728 Vali Acc: 0.796 Test Loss: 0.728 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796045).  Saving model ...
Epoch: 17 cost time: 1.7489128112792969
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.829 Vali Acc: 0.776 Test Loss: 0.829 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.844430923461914
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.941 Vali Acc: 0.770 Test Loss: 0.941 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.774122714996338
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.839 Vali Acc: 0.803 Test Loss: 0.839 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802623).  Saving model ...
Epoch: 20 cost time: 1.9112412929534912
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.899 Vali Acc: 0.763 Test Loss: 0.899 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.051393985748291
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.902 Vali Acc: 0.783 Test Loss: 0.902 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5760464668273926
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.947 Vali Acc: 0.783 Test Loss: 0.947 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9145939350128174
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.980 Vali Acc: 0.783 Test Loss: 0.980 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6436715126037598
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.039 Vali Acc: 0.776 Test Loss: 1.039 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7297720909118652
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.985 Vali Acc: 0.803 Test Loss: 0.985 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8652513027191162
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.865 Vali Acc: 0.796 Test Loss: 0.865 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8803350925445557
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.983 Vali Acc: 0.809 Test Loss: 0.983 Test Acc: 0.809
Validation loss decreased (-0.802623 --> -0.809201).  Saving model ...
Epoch: 28 cost time: 1.767941951751709
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.895 Vali Acc: 0.789 Test Loss: 0.895 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.844567060470581
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.930 Vali Acc: 0.783 Test Loss: 0.930 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8090729713439941
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.050 Vali Acc: 0.789 Test Loss: 1.050 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.0133848190307617
Epoch: 31, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.117 Vali Acc: 0.770 Test Loss: 1.117 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.989006519317627
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.197 Vali Acc: 0.750 Test Loss: 1.197 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.766796350479126
Epoch: 33, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.212 Vali Acc: 0.796 Test Loss: 1.212 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.738842248916626
Epoch: 34, Steps: 10 | Train Loss: 0.054 Vali Loss: 1.316 Vali Acc: 0.730 Test Loss: 1.316 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.7787165641784668
Epoch: 35, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.992 Vali Acc: 0.776 Test Loss: 0.992 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.835324764251709
Epoch: 36, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.008 Vali Acc: 0.757 Test Loss: 1.008 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.998732328414917
Epoch: 37, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.201 Vali Acc: 0.770 Test Loss: 1.201 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 10723392
model size : 45.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.247160196304321
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.362 Vali Acc: 0.368 Test Loss: 1.362 Test Acc: 0.368
Validation loss decreased (inf --> -0.368407).  Saving model ...
Epoch: 2 cost time: 1.8027799129486084
Epoch: 2, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.143 Vali Acc: 0.500 Test Loss: 1.143 Test Acc: 0.500
Validation loss decreased (-0.368407 --> -0.499989).  Saving model ...
Epoch: 3 cost time: 1.9201164245605469
Epoch: 3, Steps: 10 | Train Loss: 1.009 Vali Loss: 0.926 Vali Acc: 0.612 Test Loss: 0.926 Test Acc: 0.612
Validation loss decreased (-0.499989 --> -0.611833).  Saving model ...
Epoch: 4 cost time: 1.8242852687835693
Epoch: 4, Steps: 10 | Train Loss: 0.746 Vali Loss: 0.840 Vali Acc: 0.645 Test Loss: 0.840 Test Acc: 0.645
Validation loss decreased (-0.611833 --> -0.644728).  Saving model ...
Epoch: 5 cost time: 2.31451416015625
Epoch: 5, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.615 Vali Acc: 0.763 Test Loss: 0.615 Test Acc: 0.763
Validation loss decreased (-0.644728 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 1.9275908470153809
Epoch: 6, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.6563684940338135
Epoch: 7, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.534 Vali Acc: 0.776 Test Loss: 0.534 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.8518421649932861
Epoch: 8, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6574864387512207
Epoch: 9, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.897230863571167
Epoch: 10, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.716 Vali Acc: 0.770 Test Loss: 0.716 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.406560182571411
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7824759483337402
Epoch: 12, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.675 Vali Acc: 0.796 Test Loss: 0.675 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 13 cost time: 1.8986878395080566
Epoch: 13, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.773 Vali Acc: 0.776 Test Loss: 0.773 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7509186267852783
Epoch: 14, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.704 Vali Acc: 0.783 Test Loss: 0.704 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5954654216766357
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.748 Vali Acc: 0.776 Test Loss: 0.748 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4704866409301758
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.681 Vali Acc: 0.783 Test Loss: 0.681 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8551959991455078
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.243 Vali Acc: 0.750 Test Loss: 1.243 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8836398124694824
Epoch: 18, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.862 Vali Acc: 0.776 Test Loss: 0.862 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3142998218536377
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 1.030 Vali Acc: 0.770 Test Loss: 1.030 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6878383159637451
Epoch: 20, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.848 Vali Acc: 0.743 Test Loss: 0.848 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0089354515075684
Epoch: 21, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.713 Vali Acc: 0.770 Test Loss: 0.713 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.162607431411743
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.812 Vali Acc: 0.776 Test Loss: 0.812 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 10721600
model size : 45.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.479416608810425
Epoch: 1, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.545 Vali Acc: 0.342 Test Loss: 1.545 Test Acc: 0.342
Validation loss decreased (inf --> -0.342090).  Saving model ...
Epoch: 2 cost time: 1.8306684494018555
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.507 Vali Acc: 0.270 Test Loss: 1.507 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8701205253601074
Epoch: 3, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.377 Vali Acc: 0.296 Test Loss: 1.377 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.936051607131958
Epoch: 4, Steps: 10 | Train Loss: 0.866 Vali Loss: 0.800 Vali Acc: 0.664 Test Loss: 0.800 Test Acc: 0.664
Validation loss decreased (-0.342090 --> -0.664466).  Saving model ...
Epoch: 5 cost time: 1.961571216583252
Epoch: 5, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.815 Vali Acc: 0.684 Test Loss: 0.815 Test Acc: 0.684
Validation loss decreased (-0.664466 --> -0.684202).  Saving model ...
Epoch: 6 cost time: 1.9787521362304688
Epoch: 6, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
Validation loss decreased (-0.684202 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.8553194999694824
Epoch: 7, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.570 Vali Acc: 0.757 Test Loss: 0.570 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0144495964050293
Epoch: 8, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.619 Vali Acc: 0.737 Test Loss: 0.619 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0797557830810547
Epoch: 9, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.807 Vali Acc: 0.730 Test Loss: 0.807 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9732599258422852
Epoch: 10, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.675 Vali Acc: 0.763 Test Loss: 0.675 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.9263508319854736
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.625 Vali Acc: 0.783 Test Loss: 0.625 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782888).  Saving model ...
Epoch: 12 cost time: 1.7315361499786377
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.658 Vali Acc: 0.803 Test Loss: 0.658 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 13 cost time: 1.8520371913909912
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.92572021484375
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.874 Vali Acc: 0.763 Test Loss: 0.874 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7900075912475586
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.813 Vali Acc: 0.750 Test Loss: 0.813 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6921496391296387
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.821 Vali Acc: 0.743 Test Loss: 0.821 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.699059009552002
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.800 Vali Acc: 0.770 Test Loss: 0.800 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.876873254776001
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.894 Vali Acc: 0.770 Test Loss: 0.894 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.643040657043457
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.960 Vali Acc: 0.809 Test Loss: 0.960 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809201).  Saving model ...
Epoch: 20 cost time: 1.6989967823028564
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.027 Vali Acc: 0.783 Test Loss: 1.027 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7975127696990967
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.045 Vali Acc: 0.789 Test Loss: 1.045 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1417996883392334
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.085 Vali Acc: 0.796 Test Loss: 1.085 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0208511352539062
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.132 Vali Acc: 0.783 Test Loss: 1.132 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0556912422180176
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.175 Vali Acc: 0.776 Test Loss: 1.175 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.945948839187622
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.160 Vali Acc: 0.789 Test Loss: 1.160 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8694818019866943
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.150 Vali Acc: 0.803 Test Loss: 1.150 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9525914192199707
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.142 Vali Acc: 0.783 Test Loss: 1.142 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8759329319000244
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.143 Vali Acc: 0.776 Test Loss: 1.143 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9274423122406006
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.146 Vali Acc: 0.789 Test Loss: 1.146 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 10719808
model size : 45.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.0144429206848145
Epoch: 1, Steps: 10 | Train Loss: 1.522 Vali Loss: 1.406 Vali Acc: 0.382 Test Loss: 1.406 Test Acc: 0.382
Validation loss decreased (inf --> -0.381565).  Saving model ...
Epoch: 2 cost time: 1.9700284004211426
Epoch: 2, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.182 Vali Acc: 0.500 Test Loss: 1.182 Test Acc: 0.500
Validation loss decreased (-0.381565 --> -0.499988).  Saving model ...
Epoch: 3 cost time: 2.059891700744629
Epoch: 3, Steps: 10 | Train Loss: 1.074 Vali Loss: 0.975 Vali Acc: 0.592 Test Loss: 0.975 Test Acc: 0.592
Validation loss decreased (-0.499988 --> -0.592096).  Saving model ...
Epoch: 4 cost time: 1.8913180828094482
Epoch: 4, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.753 Vali Acc: 0.704 Test Loss: 0.753 Test Acc: 0.704
Validation loss decreased (-0.592096 --> -0.703940).  Saving model ...
Epoch: 5 cost time: 1.969205617904663
Epoch: 5, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.774 Vali Acc: 0.678 Test Loss: 0.774 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8727672100067139
Epoch: 6, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
Validation loss decreased (-0.703940 --> -0.782889).  Saving model ...
Epoch: 7 cost time: 1.9461729526519775
Epoch: 7, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.382164478302002
Epoch: 8, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.610 Vali Acc: 0.737 Test Loss: 0.610 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0456295013427734
Epoch: 9, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.805 Vali Acc: 0.770 Test Loss: 0.805 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.1621527671813965
Epoch: 10, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.694 Vali Acc: 0.796 Test Loss: 0.694 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796046).  Saving model ...
Epoch: 11 cost time: 1.8766250610351562
Epoch: 11, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.683 Vali Acc: 0.783 Test Loss: 0.683 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9898056983947754
Epoch: 12, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.815 Vali Acc: 0.757 Test Loss: 0.815 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2841994762420654
Epoch: 13, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.283 Vali Acc: 0.684 Test Loss: 1.283 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.434741497039795
Epoch: 14, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.843 Vali Acc: 0.763 Test Loss: 0.843 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.223680257797241
Epoch: 15, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.022 Vali Acc: 0.776 Test Loss: 1.022 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.234467029571533
Epoch: 16, Steps: 10 | Train Loss: 0.131 Vali Loss: 1.183 Vali Acc: 0.776 Test Loss: 1.183 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6674671173095703
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.897 Vali Acc: 0.809 Test Loss: 0.897 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809202).  Saving model ...
Epoch: 18 cost time: 2.323540449142456
Epoch: 18, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.799 Vali Acc: 0.816 Test Loss: 0.799 Test Acc: 0.816
Validation loss decreased (-0.809202 --> -0.815781).  Saving model ...
Epoch: 19 cost time: 1.8559563159942627
Epoch: 19, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.875 Vali Acc: 0.803 Test Loss: 0.875 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2986271381378174
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.846 Vali Acc: 0.776 Test Loss: 0.846 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.092801332473755
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.996 Vali Acc: 0.803 Test Loss: 0.996 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8802497386932373
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.083 Vali Acc: 0.770 Test Loss: 1.083 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8847668170928955
Epoch: 23, Steps: 10 | Train Loss: 0.067 Vali Loss: 1.114 Vali Acc: 0.776 Test Loss: 1.114 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.0188333988189697
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 1.143 Vali Acc: 0.743 Test Loss: 1.143 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7623803615570068
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.998 Vali Acc: 0.783 Test Loss: 0.998 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.913072109222412
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.994 Vali Acc: 0.783 Test Loss: 0.994 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.9039585590362549
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.141 Vali Acc: 0.750 Test Loss: 1.141 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.040012836456299
Epoch: 28, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.045 Vali Acc: 0.789 Test Loss: 1.045 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 10718016
model size : 45.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.59893798828125
Epoch: 1, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.402 Vali Acc: 0.263 Test Loss: 1.402 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.9587059020996094
Epoch: 2, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.287 Vali Acc: 0.467 Test Loss: 1.287 Test Acc: 0.467
Validation loss decreased (-0.263144 --> -0.467092).  Saving model ...
Epoch: 3 cost time: 2.0588016510009766
Epoch: 3, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.402 Vali Acc: 0.474 Test Loss: 1.402 Test Acc: 0.474
Validation loss decreased (-0.467092 --> -0.473670).  Saving model ...
Epoch: 4 cost time: 1.6520044803619385
Epoch: 4, Steps: 10 | Train Loss: 0.918 Vali Loss: 0.922 Vali Acc: 0.553 Test Loss: 0.922 Test Acc: 0.553
Validation loss decreased (-0.473670 --> -0.552622).  Saving model ...
Epoch: 5 cost time: 1.822632074356079
Epoch: 5, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.760 Vali Acc: 0.638 Test Loss: 0.760 Test Acc: 0.638
Validation loss decreased (-0.552622 --> -0.638150).  Saving model ...
Epoch: 6 cost time: 1.9177358150482178
Epoch: 6, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.627 Vali Acc: 0.763 Test Loss: 0.627 Test Acc: 0.763
Validation loss decreased (-0.638150 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 2.2839322090148926
Epoch: 7, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.750 Vali Acc: 0.743 Test Loss: 0.750 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9218988418579102
Epoch: 8, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.957932949066162
Epoch: 9, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.707 Vali Acc: 0.783 Test Loss: 0.707 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 10 cost time: 2.3483471870422363
Epoch: 10, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.742 Vali Acc: 0.763 Test Loss: 0.742 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.959951639175415
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.698 Vali Acc: 0.803 Test Loss: 0.698 Test Acc: 0.803
Validation loss decreased (-0.782888 --> -0.802625).  Saving model ...
Epoch: 12 cost time: 1.4504356384277344
Epoch: 12, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.827 Vali Acc: 0.789 Test Loss: 0.827 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8187336921691895
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.762 Vali Acc: 0.783 Test Loss: 0.762 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.643944263458252
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.896 Vali Acc: 0.789 Test Loss: 0.896 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7983601093292236
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.830 Vali Acc: 0.776 Test Loss: 0.830 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6531078815460205
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.789 Vali Acc: 0.770 Test Loss: 0.789 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6730093955993652
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.878 Vali Acc: 0.809 Test Loss: 0.878 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809202).  Saving model ...
Epoch: 18 cost time: 1.649111032485962
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.980 Vali Acc: 0.776 Test Loss: 0.980 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7886614799499512
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.004 Vali Acc: 0.770 Test Loss: 1.004 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6852610111236572
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.103 Vali Acc: 0.770 Test Loss: 1.103 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0191261768341064
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.131 Vali Acc: 0.776 Test Loss: 1.131 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.901669979095459
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.128 Vali Acc: 0.776 Test Loss: 1.128 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.8994081020355225
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.172 Vali Acc: 0.776 Test Loss: 1.172 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0424697399139404
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.181 Vali Acc: 0.783 Test Loss: 1.181 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6072580814361572
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.178 Vali Acc: 0.783 Test Loss: 1.178 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.650538682937622
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.197 Vali Acc: 0.770 Test Loss: 1.197 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8221924304962158
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.249 Vali Acc: 0.776 Test Loss: 1.249 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 10132416
model size : 43.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.846008539199829
Epoch: 1, Steps: 10 | Train Loss: 1.543 Vali Loss: 1.462 Vali Acc: 0.322 Test Loss: 1.462 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 2.004653215408325
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.234 Vali Acc: 0.526 Test Loss: 1.234 Test Acc: 0.526
Validation loss decreased (-0.322354 --> -0.526303).  Saving model ...
Epoch: 3 cost time: 2.367558717727661
Epoch: 3, Steps: 10 | Train Loss: 1.139 Vali Loss: 0.985 Vali Acc: 0.632 Test Loss: 0.985 Test Acc: 0.632
Validation loss decreased (-0.526303 --> -0.631569).  Saving model ...
Epoch: 4 cost time: 1.808868408203125
Epoch: 4, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.847 Vali Acc: 0.645 Test Loss: 0.847 Test Acc: 0.645
Validation loss decreased (-0.631569 --> -0.644728).  Saving model ...
Epoch: 5 cost time: 1.6353490352630615
Epoch: 5, Steps: 10 | Train Loss: 0.514 Vali Loss: 0.669 Vali Acc: 0.770 Test Loss: 0.669 Test Acc: 0.770
Validation loss decreased (-0.644728 --> -0.769730).  Saving model ...
Epoch: 6 cost time: 1.69649338722229
Epoch: 6, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 7 cost time: 1.5352931022644043
Epoch: 7, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 8 cost time: 1.7207250595092773
Epoch: 8, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.755 Vali Acc: 0.783 Test Loss: 0.755 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8341808319091797
Epoch: 9, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.586 Vali Acc: 0.776 Test Loss: 0.586 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8475072383880615
Epoch: 10, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9416050910949707
Epoch: 11, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.637 Vali Acc: 0.796 Test Loss: 0.637 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 12 cost time: 1.7949554920196533
Epoch: 12, Steps: 10 | Train Loss: 0.070 Vali Loss: 1.108 Vali Acc: 0.717 Test Loss: 1.108 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7841429710388184
Epoch: 13, Steps: 10 | Train Loss: 0.129 Vali Loss: 1.009 Vali Acc: 0.704 Test Loss: 1.009 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7383534908294678
Epoch: 14, Steps: 10 | Train Loss: 0.059 Vali Loss: 1.009 Vali Acc: 0.757 Test Loss: 1.009 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.70566725730896
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 1.047 Vali Acc: 0.763 Test Loss: 1.047 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7772393226623535
Epoch: 16, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.786 Vali Acc: 0.783 Test Loss: 0.786 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6896936893463135
Epoch: 17, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.856 Vali Acc: 0.737 Test Loss: 0.856 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7509841918945312
Epoch: 18, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.795 Vali Acc: 0.789 Test Loss: 0.795 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7071495056152344
Epoch: 19, Steps: 10 | Train Loss: 0.064 Vali Loss: 1.023 Vali Acc: 0.757 Test Loss: 1.023 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5216667652130127
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.006 Vali Acc: 0.783 Test Loss: 1.006 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7681715488433838
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.983 Vali Acc: 0.789 Test Loss: 0.983 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 10130624
model size : 43.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.990708827972412
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.622 Vali Acc: 0.322 Test Loss: 1.622 Test Acc: 0.322
Validation loss decreased (inf --> -0.322352).  Saving model ...
Epoch: 2 cost time: 2.244410991668701
Epoch: 2, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.191 Vali Acc: 0.434 Test Loss: 1.191 Test Acc: 0.434
Validation loss decreased (-0.322352 --> -0.434199).  Saving model ...
Epoch: 3 cost time: 1.9952600002288818
Epoch: 3, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.118 Vali Acc: 0.559 Test Loss: 1.118 Test Acc: 0.559
Validation loss decreased (-0.434199 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.9225502014160156
Epoch: 4, Steps: 10 | Train Loss: 0.826 Vali Loss: 1.171 Vali Acc: 0.454 Test Loss: 1.171 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8316633701324463
Epoch: 5, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.157 Vali Acc: 0.539 Test Loss: 1.157 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8903884887695312
Epoch: 6, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.736 Vali Acc: 0.717 Test Loss: 0.736 Test Acc: 0.717
Validation loss decreased (-0.559199 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 2.0226998329162598
Epoch: 7, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.875 Vali Acc: 0.697 Test Loss: 0.875 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.813136100769043
Epoch: 8, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.570 Vali Acc: 0.743 Test Loss: 0.570 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 2.2354869842529297
Epoch: 9, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.577 Vali Acc: 0.757 Test Loss: 0.577 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.7495746612548828
Epoch: 10, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.745 Vali Acc: 0.750 Test Loss: 0.745 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7339942455291748
Epoch: 11, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.613 Vali Acc: 0.750 Test Loss: 0.613 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.429837703704834
Epoch: 12, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.680 Vali Acc: 0.750 Test Loss: 0.680 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9441587924957275
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.823 Vali Acc: 0.750 Test Loss: 0.823 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6126818656921387
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.876 Vali Acc: 0.757 Test Loss: 0.876 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7809226512908936
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.817 Vali Acc: 0.757 Test Loss: 0.817 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.126413345336914
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.776 Vali Acc: 0.783 Test Loss: 0.776 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782887).  Saving model ...
Epoch: 17 cost time: 1.8176519870758057
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.893 Vali Acc: 0.763 Test Loss: 0.893 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.122042179107666
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.938 Vali Acc: 0.776 Test Loss: 0.938 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1945924758911133
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.951 Vali Acc: 0.783 Test Loss: 0.951 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9670288562774658
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.972 Vali Acc: 0.796 Test Loss: 0.972 Test Acc: 0.796
Validation loss decreased (-0.782887 --> -0.796043).  Saving model ...
Epoch: 21 cost time: 2.119809150695801
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.038 Vali Acc: 0.789 Test Loss: 1.038 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6692256927490234
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.026 Vali Acc: 0.789 Test Loss: 1.026 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6643190383911133
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.056 Vali Acc: 0.776 Test Loss: 1.056 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.9500336647033691
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.101 Vali Acc: 0.763 Test Loss: 1.101 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0201683044433594
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.770 Test Loss: 1.102 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.061779499053955
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.094 Vali Acc: 0.776 Test Loss: 1.094 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.029818058013916
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.103 Vali Acc: 0.776 Test Loss: 1.103 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.0461182594299316
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.776 Test Loss: 1.108 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.4748575687408447
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.117 Vali Acc: 0.789 Test Loss: 1.117 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9794747829437256
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.118 Vali Acc: 0.783 Test Loss: 1.118 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 10128832
model size : 43.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.507935047149658
Epoch: 1, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.466 Vali Acc: 0.283 Test Loss: 1.466 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 1.8378918170928955
Epoch: 2, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.350 Vali Acc: 0.401 Test Loss: 1.350 Test Acc: 0.401
Validation loss decreased (-0.282880 --> -0.401302).  Saving model ...
Epoch: 3 cost time: 1.6511049270629883
Epoch: 3, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.062 Vali Acc: 0.599 Test Loss: 1.062 Test Acc: 0.599
Validation loss decreased (-0.401302 --> -0.598674).  Saving model ...
Epoch: 4 cost time: 1.7084157466888428
Epoch: 4, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.969 Vali Acc: 0.612 Test Loss: 0.969 Test Acc: 0.612
Validation loss decreased (-0.598674 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 1.7164623737335205
Epoch: 5, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.897 Vali Acc: 0.572 Test Loss: 0.897 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.092895269393921
Epoch: 6, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.710 Vali Acc: 0.724 Test Loss: 0.710 Test Acc: 0.724
Validation loss decreased (-0.611832 --> -0.723677).  Saving model ...
Epoch: 7 cost time: 1.5082874298095703
Epoch: 7, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.828 Vali Acc: 0.743 Test Loss: 0.828 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743413).  Saving model ...
Epoch: 8 cost time: 1.597877025604248
Epoch: 8, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.736 Vali Acc: 0.704 Test Loss: 0.736 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7741398811340332
Epoch: 9, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.743413 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 1.5402283668518066
Epoch: 10, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.615 Vali Acc: 0.757 Test Loss: 0.615 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.8639295101165771
Epoch: 11, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.640 Vali Acc: 0.770 Test Loss: 0.640 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 2.1574699878692627
Epoch: 12, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.624 Vali Acc: 0.789 Test Loss: 0.624 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789467).  Saving model ...
Epoch: 13 cost time: 2.1801555156707764
Epoch: 13, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.706 Vali Acc: 0.770 Test Loss: 0.706 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1387581825256348
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.736 Vali Acc: 0.763 Test Loss: 0.736 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8540730476379395
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.857 Vali Acc: 0.803 Test Loss: 0.857 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802623).  Saving model ...
Epoch: 16 cost time: 1.8066020011901855
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.833 Vali Acc: 0.803 Test Loss: 0.833 Test Acc: 0.803
Validation loss decreased (-0.802623 --> -0.802623).  Saving model ...
Epoch: 17 cost time: 1.7133471965789795
Epoch: 17, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.866 Vali Acc: 0.803 Test Loss: 0.866 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6706798076629639
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.990 Vali Acc: 0.763 Test Loss: 0.990 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9847099781036377
Epoch: 19, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.792 Vali Acc: 0.776 Test Loss: 0.792 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6794698238372803
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
Validation loss decreased (-0.802623 --> -0.802624).  Saving model ...
Epoch: 21 cost time: 1.7276031970977783
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.816 Vali Acc: 0.816 Test Loss: 0.816 Test Acc: 0.816
Validation loss decreased (-0.802624 --> -0.815781).  Saving model ...
Epoch: 22 cost time: 1.5959358215332031
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.867 Vali Acc: 0.809 Test Loss: 0.867 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9507827758789062
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.783 Test Loss: 0.927 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8979458808898926
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.933 Vali Acc: 0.796 Test Loss: 0.933 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5274438858032227
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.946 Vali Acc: 0.796 Test Loss: 0.946 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.025578498840332
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.971 Vali Acc: 0.796 Test Loss: 0.971 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.003544807434082
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.988 Vali Acc: 0.803 Test Loss: 0.988 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8895289897918701
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.988 Vali Acc: 0.803 Test Loss: 0.988 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.7022957801818848
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.010 Vali Acc: 0.803 Test Loss: 1.010 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7642951011657715
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.068 Vali Acc: 0.803 Test Loss: 1.068 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.8532218933105469
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.039 Vali Acc: 0.803 Test Loss: 1.039 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 10127040
model size : 43.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6404671669006348
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.487 Vali Acc: 0.283 Test Loss: 1.487 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 1.5009469985961914
Epoch: 2, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.368 Vali Acc: 0.362 Test Loss: 1.368 Test Acc: 0.362
Validation loss decreased (-0.282880 --> -0.361828).  Saving model ...
Epoch: 3 cost time: 1.8838512897491455
Epoch: 3, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.210 Vali Acc: 0.421 Test Loss: 1.210 Test Acc: 0.421
Validation loss decreased (-0.361828 --> -0.421041).  Saving model ...
Epoch: 4 cost time: 1.7612600326538086
Epoch: 4, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.001 Vali Acc: 0.592 Test Loss: 1.001 Test Acc: 0.592
Validation loss decreased (-0.421041 --> -0.592095).  Saving model ...
Epoch: 5 cost time: 1.8573153018951416
Epoch: 5, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.777 Vali Acc: 0.678 Test Loss: 0.777 Test Acc: 0.678
Validation loss decreased (-0.592095 --> -0.677624).  Saving model ...
Epoch: 6 cost time: 1.6059026718139648
Epoch: 6, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.668 Vali Acc: 0.730 Test Loss: 0.668 Test Acc: 0.730
Validation loss decreased (-0.677624 --> -0.730256).  Saving model ...
Epoch: 7 cost time: 1.9944078922271729
Epoch: 7, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.625 Vali Acc: 0.743 Test Loss: 0.625 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 8 cost time: 1.7784502506256104
Epoch: 8, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.705 Vali Acc: 0.750 Test Loss: 0.705 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 1.655050277709961
Epoch: 9, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.711 Vali Acc: 0.750 Test Loss: 0.711 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.362957000732422
Epoch: 10, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.644 Vali Acc: 0.750 Test Loss: 0.644 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 2.300971269607544
Epoch: 11, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.729 Vali Acc: 0.776 Test Loss: 0.729 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776308).  Saving model ...
Epoch: 12 cost time: 1.7469332218170166
Epoch: 12, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.572 Vali Acc: 0.757 Test Loss: 0.572 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6787641048431396
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.717 Vali Acc: 0.743 Test Loss: 0.717 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9013197422027588
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9578886032104492
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.554 Vali Acc: 0.770 Test Loss: 0.554 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7210423946380615
Epoch: 16, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
Validation loss decreased (-0.776308 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.8329002857208252
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809204).  Saving model ...
Epoch: 18 cost time: 1.9120798110961914
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.638 Vali Acc: 0.803 Test Loss: 0.638 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1160664558410645
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.673 Vali Acc: 0.783 Test Loss: 0.673 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7965247631072998
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.838 Vali Acc: 0.789 Test Loss: 0.838 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.175467014312744
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.760 Vali Acc: 0.776 Test Loss: 0.760 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.755542278289795
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.764 Vali Acc: 0.763 Test Loss: 0.764 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7244110107421875
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.757 Vali Acc: 0.776 Test Loss: 0.757 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.6294512748718262
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.746 Vali Acc: 0.796 Test Loss: 0.746 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.662980556488037
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8640799522399902
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.760 Vali Acc: 0.789 Test Loss: 0.760 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.598658561706543
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.777 Vali Acc: 0.776 Test Loss: 0.777 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 4779968
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.021800518035889
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.395 Vali Acc: 0.257 Test Loss: 1.395 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 2.122471809387207
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.290 Vali Acc: 0.414 Test Loss: 1.290 Test Acc: 0.414
Validation loss decreased (-0.256565 --> -0.414461).  Saving model ...
Epoch: 3 cost time: 1.8708374500274658
Epoch: 3, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.237 Vali Acc: 0.368 Test Loss: 1.237 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9117188453674316
Epoch: 4, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.071 Vali Acc: 0.461 Test Loss: 1.071 Test Acc: 0.461
Validation loss decreased (-0.414461 --> -0.460516).  Saving model ...
Epoch: 5 cost time: 1.8562037944793701
Epoch: 5, Steps: 10 | Train Loss: 0.769 Vali Loss: 0.892 Vali Acc: 0.625 Test Loss: 0.892 Test Acc: 0.625
Validation loss decreased (-0.460516 --> -0.624991).  Saving model ...
Epoch: 6 cost time: 1.7503142356872559
Epoch: 6, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.763 Vali Acc: 0.704 Test Loss: 0.763 Test Acc: 0.704
Validation loss decreased (-0.624991 --> -0.703940).  Saving model ...
Epoch: 7 cost time: 1.6863040924072266
Epoch: 7, Steps: 10 | Train Loss: 0.356 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
Validation loss decreased (-0.703940 --> -0.756572).  Saving model ...
Epoch: 8 cost time: 2.056760311126709
Epoch: 8, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.8435640335083008
Epoch: 9, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 1.8591461181640625
Epoch: 10, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.589 Vali Acc: 0.776 Test Loss: 0.589 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9046523571014404
Epoch: 11, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6177868843078613
Epoch: 12, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.4340970516204834
Epoch: 13, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.656 Vali Acc: 0.789 Test Loss: 0.656 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6702179908752441
Epoch: 14, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.610 Vali Acc: 0.776 Test Loss: 0.610 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7423954010009766
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.670 Vali Acc: 0.796 Test Loss: 0.670 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 16 cost time: 2.1830997467041016
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.686 Vali Acc: 0.796 Test Loss: 0.686 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.550041913986206
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.707 Vali Acc: 0.783 Test Loss: 0.707 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.674647331237793
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.673 Vali Acc: 0.796 Test Loss: 0.673 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6693544387817383
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.764 Vali Acc: 0.796 Test Loss: 0.764 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.018573522567749
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.778 Vali Acc: 0.796 Test Loss: 0.778 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6799569129943848
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.787 Vali Acc: 0.789 Test Loss: 0.787 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.732645034790039
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.137 Vali Acc: 0.737 Test Loss: 1.137 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8789894580841064
Epoch: 23, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.893 Vali Acc: 0.770 Test Loss: 0.893 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6839423179626465
Epoch: 24, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.784 Vali Acc: 0.783 Test Loss: 0.784 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.888801097869873
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.810 Vali Acc: 0.763 Test Loss: 0.810 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 4779072
model size : 20.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2138493061065674
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.358 Vali Acc: 0.316 Test Loss: 1.358 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.7855067253112793
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.242 Vali Acc: 0.474 Test Loss: 1.242 Test Acc: 0.474
Validation loss decreased (-0.315776 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 2.218963384628296
Epoch: 3, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.124 Vali Acc: 0.526 Test Loss: 1.124 Test Acc: 0.526
Validation loss decreased (-0.473672 --> -0.526305).  Saving model ...
Epoch: 4 cost time: 1.7235107421875
Epoch: 4, Steps: 10 | Train Loss: 0.991 Vali Loss: 0.901 Vali Acc: 0.671 Test Loss: 0.901 Test Acc: 0.671
Validation loss decreased (-0.526305 --> -0.671044).  Saving model ...
Epoch: 5 cost time: 1.9135544300079346
Epoch: 5, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.755 Vali Acc: 0.651 Test Loss: 0.755 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.917328119277954
Epoch: 6, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.719 Vali Acc: 0.684 Test Loss: 0.719 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 1.825749158859253
Epoch: 7, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.624 Vali Acc: 0.776 Test Loss: 0.624 Test Acc: 0.776
Validation loss decreased (-0.684203 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.636673927307129
Epoch: 8, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.559 Vali Acc: 0.750 Test Loss: 0.559 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8776288032531738
Epoch: 9, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7031044960021973
Epoch: 10, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.7801587581634521
Epoch: 11, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 12 cost time: 2.034663200378418
Epoch: 12, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.538 Vali Acc: 0.796 Test Loss: 0.538 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9439973831176758
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.621 Vali Acc: 0.789 Test Loss: 0.621 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.723222255706787
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.717543601989746
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7967016696929932
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.682 Vali Acc: 0.776 Test Loss: 0.682 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8164761066436768
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.632 Vali Acc: 0.809 Test Loss: 0.632 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809204).  Saving model ...
Epoch: 18 cost time: 2.00468111038208
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.699 Vali Acc: 0.803 Test Loss: 0.699 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.093675374984741
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.731 Vali Acc: 0.776 Test Loss: 0.731 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7998056411743164
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.713 Vali Acc: 0.796 Test Loss: 0.713 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8402140140533447
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.729 Vali Acc: 0.809 Test Loss: 0.729 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9476351737976074
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.788 Vali Acc: 0.789 Test Loss: 0.788 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7465450763702393
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.800 Vali Acc: 0.783 Test Loss: 0.800 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1744322776794434
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.846 Vali Acc: 0.809 Test Loss: 0.846 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.642273187637329
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.021 Vali Acc: 0.789 Test Loss: 1.021 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9922904968261719
Epoch: 26, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.900 Vali Acc: 0.803 Test Loss: 0.900 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8706483840942383
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.787 Vali Acc: 0.789 Test Loss: 0.787 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 4778176
model size : 20.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8727664947509766
Epoch: 1, Steps: 10 | Train Loss: 1.557 Vali Loss: 1.506 Vali Acc: 0.329 Test Loss: 1.506 Test Acc: 0.329
Validation loss decreased (inf --> -0.328932).  Saving model ...
Epoch: 2 cost time: 1.7486534118652344
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.267 Vali Acc: 0.289 Test Loss: 1.267 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.703383207321167
Epoch: 3, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.277 Vali Acc: 0.316 Test Loss: 1.277 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.7086498737335205
Epoch: 4, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.127 Vali Acc: 0.493 Test Loss: 1.127 Test Acc: 0.493
Validation loss decreased (-0.328932 --> -0.493410).  Saving model ...
Epoch: 5 cost time: 1.8502225875854492
Epoch: 5, Steps: 10 | Train Loss: 0.820 Vali Loss: 0.965 Vali Acc: 0.566 Test Loss: 0.965 Test Acc: 0.566
Validation loss decreased (-0.493410 --> -0.565780).  Saving model ...
Epoch: 6 cost time: 1.7367732524871826
Epoch: 6, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.609 Vali Acc: 0.763 Test Loss: 0.609 Test Acc: 0.763
Validation loss decreased (-0.565780 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 2.027184247970581
Epoch: 7, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 2.1296873092651367
Epoch: 8, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.7297422885894775
Epoch: 9, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.483 Vali Acc: 0.776 Test Loss: 0.483 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5650887489318848
Epoch: 10, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9689078330993652
Epoch: 11, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 12 cost time: 1.8362185955047607
Epoch: 12, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.555 Vali Acc: 0.796 Test Loss: 0.555 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8601386547088623
Epoch: 13, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.636 Vali Acc: 0.776 Test Loss: 0.636 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8342030048370361
Epoch: 14, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7471857070922852
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8151562213897705
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.678 Vali Acc: 0.783 Test Loss: 0.678 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5948352813720703
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.739 Vali Acc: 0.789 Test Loss: 0.739 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5787811279296875
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.746 Vali Acc: 0.796 Test Loss: 0.746 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.43692946434021
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.904 Vali Acc: 0.796 Test Loss: 0.904 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6807115077972412
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.964 Vali Acc: 0.803 Test Loss: 0.964 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7399919033050537
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.774 Vali Acc: 0.822 Test Loss: 0.774 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822361).  Saving model ...
Epoch: 22 cost time: 1.5546648502349854
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.847 Vali Acc: 0.816 Test Loss: 0.847 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.018315076828003
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.868 Vali Acc: 0.816 Test Loss: 0.868 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8200256824493408
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.894 Vali Acc: 0.829 Test Loss: 0.894 Test Acc: 0.829
Validation loss decreased (-0.822361 --> -0.828938).  Saving model ...
Epoch: 25 cost time: 1.6527657508850098
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.910 Vali Acc: 0.836 Test Loss: 0.910 Test Acc: 0.836
Validation loss decreased (-0.828938 --> -0.835517).  Saving model ...
Epoch: 26 cost time: 1.687912940979004
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.887 Vali Acc: 0.822 Test Loss: 0.887 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.790032148361206
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.976 Vali Acc: 0.809 Test Loss: 0.976 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.044455051422119
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.025 Vali Acc: 0.803 Test Loss: 1.025 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.952211856842041
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.976 Vali Acc: 0.809 Test Loss: 0.976 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7874209880828857
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.939 Vali Acc: 0.803 Test Loss: 0.939 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.0241925716400146
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.809 Test Loss: 0.927 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7477035522460938
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.816 Test Loss: 0.974 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9759225845336914
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.981 Vali Acc: 0.816 Test Loss: 0.981 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.5509657859802246
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.002 Vali Acc: 0.816 Test Loss: 1.002 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.7951252460479736
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.014 Vali Acc: 0.822 Test Loss: 1.014 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 4777280
model size : 20.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.102874755859375
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.421 Vali Acc: 0.270 Test Loss: 1.421 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.9469780921936035
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.270 Vali Acc: 0.539 Test Loss: 1.270 Test Acc: 0.539
Validation loss decreased (-0.269723 --> -0.539461).  Saving model ...
Epoch: 3 cost time: 2.1980092525482178
Epoch: 3, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.115 Vali Acc: 0.586 Test Loss: 1.115 Test Acc: 0.586
Validation loss decreased (-0.539461 --> -0.585515).  Saving model ...
Epoch: 4 cost time: 2.0485312938690186
Epoch: 4, Steps: 10 | Train Loss: 0.918 Vali Loss: 0.994 Vali Acc: 0.553 Test Loss: 0.994 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.780182123184204
Epoch: 5, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.818 Vali Acc: 0.645 Test Loss: 0.818 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644729).  Saving model ...
Epoch: 6 cost time: 2.106293201446533
Epoch: 6, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.775 Vali Acc: 0.678 Test Loss: 0.775 Test Acc: 0.678
Validation loss decreased (-0.644729 --> -0.677624).  Saving model ...
Epoch: 7 cost time: 2.113023042678833
Epoch: 7, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.620 Vali Acc: 0.730 Test Loss: 0.620 Test Acc: 0.730
Validation loss decreased (-0.677624 --> -0.730257).  Saving model ...
Epoch: 8 cost time: 2.3800008296966553
Epoch: 8, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.618 Vali Acc: 0.743 Test Loss: 0.618 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.8850643634796143
Epoch: 9, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.591 Vali Acc: 0.763 Test Loss: 0.591 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 2.112534523010254
Epoch: 10, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.527 Vali Acc: 0.750 Test Loss: 0.527 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8267834186553955
Epoch: 11, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.475 Vali Acc: 0.783 Test Loss: 0.475 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782890).  Saving model ...
Epoch: 12 cost time: 1.7320377826690674
Epoch: 12, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 2.2196643352508545
Epoch: 13, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.572 Vali Acc: 0.803 Test Loss: 0.572 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.9596848487854004
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7050282955169678
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.614 Vali Acc: 0.789 Test Loss: 0.614 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.004868745803833
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.646 Vali Acc: 0.783 Test Loss: 0.646 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7379028797149658
Epoch: 17, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 18 cost time: 1.613086223602295
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5569002628326416
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.641 Vali Acc: 0.803 Test Loss: 0.641 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9381561279296875
Epoch: 20, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.644 Vali Acc: 0.836 Test Loss: 0.644 Test Acc: 0.836
Validation loss decreased (-0.809204 --> -0.835520).  Saving model ...
Epoch: 21 cost time: 2.0376522541046143
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.687 Vali Acc: 0.789 Test Loss: 0.687 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7581801414489746
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.712 Vali Acc: 0.783 Test Loss: 0.712 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.733539342880249
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.742 Vali Acc: 0.809 Test Loss: 0.742 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5953547954559326
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.782 Vali Acc: 0.796 Test Loss: 0.782 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.8912372589111328
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8533985614776611
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.785 Vali Acc: 0.803 Test Loss: 0.785 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.093485116958618
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.781 Vali Acc: 0.809 Test Loss: 0.781 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.1273996829986572
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.788 Vali Acc: 0.809 Test Loss: 0.788 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9539971351623535
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.796 Vali Acc: 0.809 Test Loss: 0.796 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9671833515167236
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.796 Vali Acc: 0.809 Test Loss: 0.796 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 3595712
model size : 16.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.885554552078247
Epoch: 1, Steps: 10 | Train Loss: 1.571 Vali Loss: 1.428 Vali Acc: 0.263 Test Loss: 1.428 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.7329423427581787
Epoch: 2, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.333 Vali Acc: 0.375 Test Loss: 1.333 Test Acc: 0.375
Validation loss decreased (-0.263144 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 2.1513125896453857
Epoch: 3, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.292 Vali Acc: 0.316 Test Loss: 1.292 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3354570865631104
Epoch: 4, Steps: 10 | Train Loss: 1.140 Vali Loss: 1.063 Vali Acc: 0.559 Test Loss: 1.063 Test Acc: 0.559
Validation loss decreased (-0.374987 --> -0.559200).  Saving model ...
Epoch: 5 cost time: 1.7853538990020752
Epoch: 5, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.894 Vali Acc: 0.599 Test Loss: 0.894 Test Acc: 0.599
Validation loss decreased (-0.559200 --> -0.598675).  Saving model ...
Epoch: 6 cost time: 1.9732589721679688
Epoch: 6, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.864 Vali Acc: 0.658 Test Loss: 0.864 Test Acc: 0.658
Validation loss decreased (-0.598675 --> -0.657886).  Saving model ...
Epoch: 7 cost time: 1.906545877456665
Epoch: 7, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.862 Vali Acc: 0.651 Test Loss: 0.862 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.499606132507324
Epoch: 8, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.841 Vali Acc: 0.618 Test Loss: 0.841 Test Acc: 0.618
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.061338424682617
Epoch: 9, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.691 Vali Acc: 0.717 Test Loss: 0.691 Test Acc: 0.717
Validation loss decreased (-0.657886 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 1.9121589660644531
Epoch: 10, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.622 Vali Acc: 0.757 Test Loss: 0.622 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.7058422565460205
Epoch: 11, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.7434418201446533
Epoch: 12, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.608 Vali Acc: 0.730 Test Loss: 0.608 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5801551342010498
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.616 Vali Acc: 0.763 Test Loss: 0.616 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.157193422317505
Epoch: 14, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789467).  Saving model ...
Epoch: 15 cost time: 1.6646292209625244
Epoch: 15, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.700 Vali Acc: 0.776 Test Loss: 0.700 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8002090454101562
Epoch: 16, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.857 Vali Acc: 0.770 Test Loss: 0.857 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7634179592132568
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.667 Vali Acc: 0.783 Test Loss: 0.667 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7643237113952637
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.707 Vali Acc: 0.783 Test Loss: 0.707 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6107263565063477
Epoch: 19, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.958 Vali Acc: 0.770 Test Loss: 0.958 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6302926540374756
Epoch: 20, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6425881385803223
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.861 Vali Acc: 0.783 Test Loss: 0.861 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0172691345214844
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.859 Vali Acc: 0.776 Test Loss: 0.859 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.055171251296997
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.895 Vali Acc: 0.796 Test Loss: 0.895 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796044).  Saving model ...
Epoch: 24 cost time: 1.7592883110046387
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.879 Vali Acc: 0.789 Test Loss: 0.879 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9545319080352783
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.911 Vali Acc: 0.803 Test Loss: 0.911 Test Acc: 0.803
Validation loss decreased (-0.796044 --> -0.802622).  Saving model ...
Epoch: 26 cost time: 2.08054518699646
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.921 Vali Acc: 0.803 Test Loss: 0.921 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.38387131690979
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.923 Vali Acc: 0.796 Test Loss: 0.923 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.1355884075164795
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.934 Vali Acc: 0.803 Test Loss: 0.934 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9035968780517578
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.941 Vali Acc: 0.796 Test Loss: 0.941 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1296403408050537
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.941 Vali Acc: 0.796 Test Loss: 0.941 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8883862495422363
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.945 Vali Acc: 0.803 Test Loss: 0.945 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.8646986484527588
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.965 Vali Acc: 0.803 Test Loss: 0.965 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8473215103149414
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.967 Vali Acc: 0.783 Test Loss: 0.967 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0541834831237793
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.954 Vali Acc: 0.783 Test Loss: 0.954 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8001539707183838
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.972 Vali Acc: 0.803 Test Loss: 0.972 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 3594816
model size : 16.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.806642293930054
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.385 Vali Acc: 0.342 Test Loss: 1.385 Test Acc: 0.342
Validation loss decreased (inf --> -0.342091).  Saving model ...
Epoch: 2 cost time: 1.9446253776550293
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.297 Vali Acc: 0.414 Test Loss: 1.297 Test Acc: 0.414
Validation loss decreased (-0.342091 --> -0.414461).  Saving model ...
Epoch: 3 cost time: 1.6192007064819336
Epoch: 3, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.178 Vali Acc: 0.447 Test Loss: 1.178 Test Acc: 0.447
Validation loss decreased (-0.414461 --> -0.447357).  Saving model ...
Epoch: 4 cost time: 2.024118661880493
Epoch: 4, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.109 Vali Acc: 0.520 Test Loss: 1.109 Test Acc: 0.520
Validation loss decreased (-0.447357 --> -0.519726).  Saving model ...
Epoch: 5 cost time: 1.850219488143921
Epoch: 5, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.072 Vali Acc: 0.500 Test Loss: 1.072 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6010022163391113
Epoch: 6, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.800 Vali Acc: 0.658 Test Loss: 0.800 Test Acc: 0.658
Validation loss decreased (-0.519726 --> -0.657887).  Saving model ...
Epoch: 7 cost time: 1.9136626720428467
Epoch: 7, Steps: 10 | Train Loss: 0.478 Vali Loss: 1.096 Vali Acc: 0.625 Test Loss: 1.096 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.026745557785034
Epoch: 8, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.900 Vali Acc: 0.678 Test Loss: 0.900 Test Acc: 0.678
Validation loss decreased (-0.657887 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 2.069068670272827
Epoch: 9, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.645 Vali Acc: 0.750 Test Loss: 0.645 Test Acc: 0.750
Validation loss decreased (-0.677623 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.6040573120117188
Epoch: 10, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.687 Vali Acc: 0.737 Test Loss: 0.687 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8508591651916504
Epoch: 11, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8288123607635498
Epoch: 12, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.668 Vali Acc: 0.724 Test Loss: 0.668 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.711219072341919
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.607 Vali Acc: 0.717 Test Loss: 0.607 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7295587062835693
Epoch: 14, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.683 Vali Acc: 0.737 Test Loss: 0.683 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6919965744018555
Epoch: 15, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.667 Vali Acc: 0.776 Test Loss: 0.667 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776309).  Saving model ...
Epoch: 16 cost time: 1.735851526260376
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.753 Vali Acc: 0.737 Test Loss: 0.753 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5083591938018799
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.853 Vali Acc: 0.711 Test Loss: 0.853 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5512657165527344
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.770 Vali Acc: 0.750 Test Loss: 0.770 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7969672679901123
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.874 Vali Acc: 0.750 Test Loss: 0.874 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4814157485961914
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.769 Vali Acc: 0.796 Test Loss: 0.769 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796045).  Saving model ...
Epoch: 21 cost time: 1.9293506145477295
Epoch: 21, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.771 Vali Acc: 0.776 Test Loss: 0.771 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7778961658477783
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.807 Vali Acc: 0.770 Test Loss: 0.807 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.102761745452881
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.078 Vali Acc: 0.809 Test Loss: 1.078 Test Acc: 0.809
Validation loss decreased (-0.796045 --> -0.809200).  Saving model ...
Epoch: 24 cost time: 1.6884315013885498
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.855 Vali Acc: 0.770 Test Loss: 0.855 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.730659008026123
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.054 Vali Acc: 0.783 Test Loss: 1.054 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0343363285064697
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.985 Vali Acc: 0.757 Test Loss: 0.985 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0268049240112305
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.990 Vali Acc: 0.750 Test Loss: 0.990 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0462253093719482
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.974 Vali Acc: 0.757 Test Loss: 0.974 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.0926425457000732
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.013 Vali Acc: 0.763 Test Loss: 1.013 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6836261749267578
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.055 Vali Acc: 0.757 Test Loss: 1.055 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6847460269927979
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.074 Vali Acc: 0.763 Test Loss: 1.074 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.9675536155700684
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.069 Vali Acc: 0.763 Test Loss: 1.069 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.9163944721221924
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.079 Vali Acc: 0.757 Test Loss: 1.079 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 3593920
model size : 16.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.166159152984619
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.387 Vali Acc: 0.257 Test Loss: 1.387 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 2.3594768047332764
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.324 Vali Acc: 0.428 Test Loss: 1.324 Test Acc: 0.428
Validation loss decreased (-0.256565 --> -0.427618).  Saving model ...
Epoch: 3 cost time: 2.0186197757720947
Epoch: 3, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.159 Vali Acc: 0.533 Test Loss: 1.159 Test Acc: 0.533
Validation loss decreased (-0.427618 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 2.495818853378296
Epoch: 4, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.075 Vali Acc: 0.526 Test Loss: 1.075 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9268693923950195
Epoch: 5, Steps: 10 | Train Loss: 0.794 Vali Loss: 1.010 Vali Acc: 0.533 Test Loss: 1.010 Test Acc: 0.533
Validation loss decreased (-0.532883 --> -0.532885).  Saving model ...
Epoch: 6 cost time: 1.6145403385162354
Epoch: 6, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.882 Vali Acc: 0.638 Test Loss: 0.882 Test Acc: 0.638
Validation loss decreased (-0.532885 --> -0.638149).  Saving model ...
Epoch: 7 cost time: 1.7988672256469727
Epoch: 7, Steps: 10 | Train Loss: 0.503 Vali Loss: 0.711 Vali Acc: 0.717 Test Loss: 0.711 Test Acc: 0.717
Validation loss decreased (-0.638149 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.7174360752105713
Epoch: 8, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
Validation loss decreased (-0.717098 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.5061218738555908
Epoch: 9, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.163637638092041
Epoch: 10, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.5566942691802979
Epoch: 11, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.665 Vali Acc: 0.704 Test Loss: 0.665 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.213259696960449
Epoch: 12, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.603 Vali Acc: 0.796 Test Loss: 0.603 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.9144089221954346
Epoch: 13, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.581 Vali Acc: 0.750 Test Loss: 0.581 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9953806400299072
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9186885356903076
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.598 Vali Acc: 0.783 Test Loss: 0.598 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7669901847839355
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.674 Vali Acc: 0.789 Test Loss: 0.674 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.781815528869629
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.655 Vali Acc: 0.789 Test Loss: 0.655 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7394778728485107
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.762 Vali Acc: 0.763 Test Loss: 0.762 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8199949264526367
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.711 Vali Acc: 0.789 Test Loss: 0.711 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.048214912414551
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.749 Vali Acc: 0.783 Test Loss: 0.749 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6317291259765625
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.753 Vali Acc: 0.803 Test Loss: 0.753 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 22 cost time: 1.7703545093536377
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.738 Vali Acc: 0.816 Test Loss: 0.738 Test Acc: 0.816
Validation loss decreased (-0.802624 --> -0.815782).  Saving model ...
Epoch: 23 cost time: 1.9830138683319092
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.755 Vali Acc: 0.816 Test Loss: 0.755 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6024222373962402
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.810 Vali Acc: 0.796 Test Loss: 0.810 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1570448875427246
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.853 Vali Acc: 0.803 Test Loss: 0.853 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9788591861724854
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.846 Vali Acc: 0.809 Test Loss: 0.846 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.280433416366577
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.864 Vali Acc: 0.809 Test Loss: 0.864 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.822645902633667
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.796 Test Loss: 0.905 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.0593008995056152
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.921 Vali Acc: 0.816 Test Loss: 0.921 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.1765224933624268
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.930 Vali Acc: 0.803 Test Loss: 0.930 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.8683855533599854
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.803 Test Loss: 0.945 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8351013660430908
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.960 Vali Acc: 0.796 Test Loss: 0.960 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 3593024
model size : 16.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.115921974182129
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.426 Vali Acc: 0.296 Test Loss: 1.426 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 1.5903730392456055
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.276 Vali Acc: 0.533 Test Loss: 1.276 Test Acc: 0.533
Validation loss decreased (-0.296038 --> -0.532882).  Saving model ...
Epoch: 3 cost time: 1.5960745811462402
Epoch: 3, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.168 Vali Acc: 0.586 Test Loss: 1.168 Test Acc: 0.586
Validation loss decreased (-0.532882 --> -0.585515).  Saving model ...
Epoch: 4 cost time: 1.9408490657806396
Epoch: 4, Steps: 10 | Train Loss: 1.033 Vali Loss: 0.997 Vali Acc: 0.625 Test Loss: 0.997 Test Acc: 0.625
Validation loss decreased (-0.585515 --> -0.624990).  Saving model ...
Epoch: 5 cost time: 1.725764513015747
Epoch: 5, Steps: 10 | Train Loss: 0.788 Vali Loss: 0.912 Vali Acc: 0.632 Test Loss: 0.912 Test Acc: 0.632
Validation loss decreased (-0.624990 --> -0.631570).  Saving model ...
Epoch: 6 cost time: 1.5821201801300049
Epoch: 6, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.754 Vali Acc: 0.684 Test Loss: 0.754 Test Acc: 0.684
Validation loss decreased (-0.631570 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 1.675471305847168
Epoch: 7, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.690 Vali Acc: 0.697 Test Loss: 0.690 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697362).  Saving model ...
Epoch: 8 cost time: 1.5253472328186035
Epoch: 8, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.679 Vali Acc: 0.730 Test Loss: 0.679 Test Acc: 0.730
Validation loss decreased (-0.697362 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 1.7429265975952148
Epoch: 9, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
Validation loss decreased (-0.730256 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.750345230102539
Epoch: 10, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.670 Vali Acc: 0.697 Test Loss: 0.670 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7482311725616455
Epoch: 11, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.7693557739257812
Epoch: 12, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.484 Vali Acc: 0.796 Test Loss: 0.484 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796048).  Saving model ...
Epoch: 13 cost time: 2.097036123275757
Epoch: 13, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.497 Vali Acc: 0.776 Test Loss: 0.497 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9007751941680908
Epoch: 14, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.543 Vali Acc: 0.770 Test Loss: 0.543 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7913539409637451
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8482389450073242
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.692 Vali Acc: 0.783 Test Loss: 0.692 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.0169167518615723
Epoch: 17, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.0267794132232666
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.603 Vali Acc: 0.809 Test Loss: 0.603 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809204).  Saving model ...
Epoch: 19 cost time: 1.9257421493530273
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9373767375946045
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8822157382965088
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.665 Vali Acc: 0.829 Test Loss: 0.665 Test Acc: 0.829
Validation loss decreased (-0.809204 --> -0.828941).  Saving model ...
Epoch: 22 cost time: 1.8649170398712158
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.699 Vali Acc: 0.816 Test Loss: 0.699 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5935859680175781
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.687 Vali Acc: 0.816 Test Loss: 0.687 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6075749397277832
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.723 Vali Acc: 0.822 Test Loss: 0.723 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8468017578125
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.766 Vali Acc: 0.809 Test Loss: 0.766 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6571426391601562
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.781 Vali Acc: 0.829 Test Loss: 0.781 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.0527548789978027
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.804 Vali Acc: 0.822 Test Loss: 0.804 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.005159616470337
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.799 Vali Acc: 0.822 Test Loss: 0.799 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.682084560394287
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.823 Vali Acc: 0.803 Test Loss: 0.823 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.741997241973877
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.841 Vali Acc: 0.816 Test Loss: 0.841 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.9906461238861084
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.853 Vali Acc: 0.829 Test Loss: 0.853 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 3003584
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5087783336639404
Epoch: 1, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.421 Vali Acc: 0.276 Test Loss: 1.421 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.7764897346496582
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.283 Vali Acc: 0.401 Test Loss: 1.283 Test Acc: 0.401
Validation loss decreased (-0.276302 --> -0.401303).  Saving model ...
Epoch: 3 cost time: 1.8604750633239746
Epoch: 3, Steps: 10 | Train Loss: 1.208 Vali Loss: 1.190 Vali Acc: 0.454 Test Loss: 1.190 Test Acc: 0.454
Validation loss decreased (-0.401303 --> -0.453935).  Saving model ...
Epoch: 4 cost time: 1.939115047454834
Epoch: 4, Steps: 10 | Train Loss: 1.030 Vali Loss: 0.987 Vali Acc: 0.612 Test Loss: 0.987 Test Acc: 0.612
Validation loss decreased (-0.453935 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 1.9818336963653564
Epoch: 5, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.884 Vali Acc: 0.586 Test Loss: 0.884 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.714637279510498
Epoch: 6, Steps: 10 | Train Loss: 0.597 Vali Loss: 0.729 Vali Acc: 0.678 Test Loss: 0.729 Test Acc: 0.678
Validation loss decreased (-0.611832 --> -0.677624).  Saving model ...
Epoch: 7 cost time: 1.7541735172271729
Epoch: 7, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.725 Vali Acc: 0.697 Test Loss: 0.725 Test Acc: 0.697
Validation loss decreased (-0.677624 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 1.9554049968719482
Epoch: 8, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
Validation loss decreased (-0.697361 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.797875165939331
Epoch: 9, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.594 Vali Acc: 0.757 Test Loss: 0.594 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.7365460395812988
Epoch: 10, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.756 Vali Acc: 0.750 Test Loss: 0.756 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.28837513923645
Epoch: 11, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.596 Vali Acc: 0.724 Test Loss: 0.596 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0932457447052
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.604 Vali Acc: 0.770 Test Loss: 0.604 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.8167636394500732
Epoch: 13, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.634 Vali Acc: 0.750 Test Loss: 0.634 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7413668632507324
Epoch: 14, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.608 Vali Acc: 0.770 Test Loss: 0.608 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7908391952514648
Epoch: 15, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.603 Vali Acc: 0.776 Test Loss: 0.603 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 2.129134178161621
Epoch: 16, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0870962142944336
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.754 Vali Acc: 0.770 Test Loss: 0.754 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.270678758621216
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.791 Vali Acc: 0.763 Test Loss: 0.791 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1722304821014404
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.718 Vali Acc: 0.776 Test Loss: 0.718 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7987465858459473
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.846 Vali Acc: 0.770 Test Loss: 0.846 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.227377414703369
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.800 Vali Acc: 0.783 Test Loss: 0.800 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782887).  Saving model ...
Epoch: 22 cost time: 1.9030823707580566
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.847 Vali Acc: 0.776 Test Loss: 0.847 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0272469520568848
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.017 Vali Acc: 0.763 Test Loss: 1.017 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.093548059463501
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.004 Vali Acc: 0.770 Test Loss: 1.004 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8649630546569824
Epoch: 25, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.848 Vali Acc: 0.816 Test Loss: 0.848 Test Acc: 0.816
Validation loss decreased (-0.782887 --> -0.815781).  Saving model ...
Epoch: 26 cost time: 1.7549517154693604
Epoch: 26, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.808 Vali Acc: 0.770 Test Loss: 0.808 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6947157382965088
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.882 Vali Acc: 0.763 Test Loss: 0.882 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.633305549621582
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.834 Vali Acc: 0.803 Test Loss: 0.834 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9502527713775635
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.860 Vali Acc: 0.783 Test Loss: 0.860 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6519842147827148
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.875 Vali Acc: 0.789 Test Loss: 0.875 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.0071659088134766
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.938 Vali Acc: 0.796 Test Loss: 0.938 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.5828883647918701
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.995 Vali Acc: 0.776 Test Loss: 0.995 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.0640203952789307
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.953 Vali Acc: 0.770 Test Loss: 0.953 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.7015202045440674
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.962 Vali Acc: 0.776 Test Loss: 0.962 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.9629523754119873
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.776 Test Loss: 0.968 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 3002688
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.117313861846924
Epoch: 1, Steps: 10 | Train Loss: 1.603 Vali Loss: 1.445 Vali Acc: 0.316 Test Loss: 1.445 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 2.4568328857421875
Epoch: 2, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.332 Vali Acc: 0.382 Test Loss: 1.332 Test Acc: 0.382
Validation loss decreased (-0.315775 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 2.2271676063537598
Epoch: 3, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.242 Vali Acc: 0.375 Test Loss: 1.242 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7930243015289307
Epoch: 4, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.112 Vali Acc: 0.572 Test Loss: 1.112 Test Acc: 0.572
Validation loss decreased (-0.381566 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 2.420440673828125
Epoch: 5, Steps: 10 | Train Loss: 0.937 Vali Loss: 0.874 Vali Acc: 0.704 Test Loss: 0.874 Test Acc: 0.704
Validation loss decreased (-0.572357 --> -0.703939).  Saving model ...
Epoch: 6 cost time: 1.7128539085388184
Epoch: 6, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.766 Vali Acc: 0.730 Test Loss: 0.766 Test Acc: 0.730
Validation loss decreased (-0.703939 --> -0.730255).  Saving model ...
Epoch: 7 cost time: 1.9751369953155518
Epoch: 7, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.705 Vali Acc: 0.711 Test Loss: 0.705 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.991070032119751
Epoch: 8, Steps: 10 | Train Loss: 0.351 Vali Loss: 0.727 Vali Acc: 0.684 Test Loss: 0.727 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.152743339538574
Epoch: 9, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.589 Vali Acc: 0.743 Test Loss: 0.589 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743415).  Saving model ...
Epoch: 10 cost time: 2.15812349319458
Epoch: 10, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 2.010110378265381
Epoch: 11, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 2.121478319168091
Epoch: 12, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.590 Vali Acc: 0.770 Test Loss: 0.590 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.9263412952423096
Epoch: 13, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 2.4195470809936523
Epoch: 14, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.636 Vali Acc: 0.730 Test Loss: 0.636 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.287240505218506
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.637 Vali Acc: 0.776 Test Loss: 0.637 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 16 cost time: 2.164829730987549
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8910706043243408
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.743 Vali Acc: 0.783 Test Loss: 0.743 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782887).  Saving model ...
Epoch: 18 cost time: 1.799752950668335
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.707 Vali Acc: 0.776 Test Loss: 0.707 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6546459197998047
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
Validation loss decreased (-0.782887 --> -0.782887).  Saving model ...
Epoch: 20 cost time: 1.8945298194885254
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.741 Vali Acc: 0.796 Test Loss: 0.741 Test Acc: 0.796
Validation loss decreased (-0.782887 --> -0.796045).  Saving model ...
Epoch: 21 cost time: 2.2046964168548584
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.748 Vali Acc: 0.803 Test Loss: 0.748 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802624).  Saving model ...
Epoch: 22 cost time: 2.3402259349823
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.792 Vali Acc: 0.816 Test Loss: 0.792 Test Acc: 0.816
Validation loss decreased (-0.802624 --> -0.815782).  Saving model ...
Epoch: 23 cost time: 2.2839913368225098
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.744 Vali Acc: 0.776 Test Loss: 0.744 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.386213779449463
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.829 Vali Acc: 0.776 Test Loss: 0.829 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1881697177886963
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.852 Vali Acc: 0.789 Test Loss: 0.852 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.1195311546325684
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.908 Vali Acc: 0.789 Test Loss: 0.908 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.0965969562530518
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.877 Vali Acc: 0.783 Test Loss: 0.877 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8448810577392578
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.029 Vali Acc: 0.770 Test Loss: 1.029 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7821805477142334
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.920 Vali Acc: 0.783 Test Loss: 0.920 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.036813497543335
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.029 Vali Acc: 0.757 Test Loss: 1.029 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.191282033920288
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.982 Vali Acc: 0.770 Test Loss: 0.982 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.5723216533660889
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.065 Vali Acc: 0.757 Test Loss: 1.065 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 3001792
model size : 14.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6053104400634766
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.408 Vali Acc: 0.342 Test Loss: 1.408 Test Acc: 0.342
Validation loss decreased (inf --> -0.342091).  Saving model ...
Epoch: 2 cost time: 1.7609539031982422
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.266 Vali Acc: 0.500 Test Loss: 1.266 Test Acc: 0.500
Validation loss decreased (-0.342091 --> -0.499987).  Saving model ...
Epoch: 3 cost time: 1.6699798107147217
Epoch: 3, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.174 Vali Acc: 0.454 Test Loss: 1.174 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8435382843017578
Epoch: 4, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.152 Vali Acc: 0.441 Test Loss: 1.152 Test Acc: 0.441
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5869016647338867
Epoch: 5, Steps: 10 | Train Loss: 0.925 Vali Loss: 0.855 Vali Acc: 0.664 Test Loss: 0.855 Test Acc: 0.664
Validation loss decreased (-0.499987 --> -0.664465).  Saving model ...
Epoch: 6 cost time: 1.8502299785614014
Epoch: 6, Steps: 10 | Train Loss: 0.603 Vali Loss: 0.735 Vali Acc: 0.724 Test Loss: 0.735 Test Acc: 0.724
Validation loss decreased (-0.664465 --> -0.723677).  Saving model ...
Epoch: 7 cost time: 1.793224811553955
Epoch: 7, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.837 Vali Acc: 0.717 Test Loss: 0.837 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9452717304229736
Epoch: 8, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.644 Vali Acc: 0.763 Test Loss: 0.644 Test Acc: 0.763
Validation loss decreased (-0.723677 --> -0.763151).  Saving model ...
Epoch: 9 cost time: 2.0981948375701904
Epoch: 9, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.750 Vali Acc: 0.691 Test Loss: 0.750 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8860814571380615
Epoch: 10, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.637 Vali Acc: 0.724 Test Loss: 0.637 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8240704536437988
Epoch: 11, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.7460930347442627
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.519 Vali Acc: 0.757 Test Loss: 0.519 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6916131973266602
Epoch: 13, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782890).  Saving model ...
Epoch: 14 cost time: 1.5224640369415283
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.9458718299865723
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.5137293338775635
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.560 Vali Acc: 0.796 Test Loss: 0.560 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 2.1417629718780518
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0180864334106445
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.675 Vali Acc: 0.796 Test Loss: 0.675 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8671231269836426
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.714 Vali Acc: 0.803 Test Loss: 0.714 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 20 cost time: 1.6487030982971191
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.668 Vali Acc: 0.796 Test Loss: 0.668 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.831651210784912
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.688 Vali Acc: 0.789 Test Loss: 0.688 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.818005084991455
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.763976812362671
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.736 Vali Acc: 0.783 Test Loss: 0.736 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6740832328796387
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.728 Vali Acc: 0.803 Test Loss: 0.728 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.9606828689575195
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.742 Vali Acc: 0.803 Test Loss: 0.742 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.6943120956420898
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.717 Vali Acc: 0.803 Test Loss: 0.717 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.841165542602539
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.762 Vali Acc: 0.796 Test Loss: 0.762 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.681020975112915
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.762 Vali Acc: 0.789 Test Loss: 0.762 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.707244873046875
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.796 Test Loss: 0.760 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 3000896
model size : 14.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.319836616516113
Epoch: 1, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.330 Vali Acc: 0.336 Test Loss: 1.330 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 2.03515887260437
Epoch: 2, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.246 Vali Acc: 0.480 Test Loss: 1.246 Test Acc: 0.480
Validation loss decreased (-0.335513 --> -0.480251).  Saving model ...
Epoch: 3 cost time: 1.8012778759002686
Epoch: 3, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.144 Vali Acc: 0.559 Test Loss: 1.144 Test Acc: 0.559
Validation loss decreased (-0.480251 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.9593939781188965
Epoch: 4, Steps: 10 | Train Loss: 0.991 Vali Loss: 0.993 Vali Acc: 0.632 Test Loss: 0.993 Test Acc: 0.632
Validation loss decreased (-0.559199 --> -0.631569).  Saving model ...
Epoch: 5 cost time: 1.731938123703003
Epoch: 5, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.931 Vali Acc: 0.572 Test Loss: 0.931 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9534313678741455
Epoch: 6, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.885 Vali Acc: 0.638 Test Loss: 0.885 Test Acc: 0.638
Validation loss decreased (-0.631569 --> -0.638149).  Saving model ...
Epoch: 7 cost time: 1.6830213069915771
Epoch: 7, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.778 Vali Acc: 0.684 Test Loss: 0.778 Test Acc: 0.684
Validation loss decreased (-0.638149 --> -0.684203).  Saving model ...
Epoch: 8 cost time: 1.9412896633148193
Epoch: 8, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.625 Vali Acc: 0.737 Test Loss: 0.625 Test Acc: 0.737
Validation loss decreased (-0.684203 --> -0.736836).  Saving model ...
Epoch: 9 cost time: 1.762291431427002
Epoch: 9, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.609 Vali Acc: 0.730 Test Loss: 0.609 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0242648124694824
Epoch: 10, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.8627769947052002
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.627 Vali Acc: 0.789 Test Loss: 0.627 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 1.9190571308135986
Epoch: 12, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7392079830169678
Epoch: 13, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.632 Vali Acc: 0.776 Test Loss: 0.632 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7291455268859863
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.587 Vali Acc: 0.776 Test Loss: 0.587 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7412116527557373
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.575 Vali Acc: 0.789 Test Loss: 0.575 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.7675457000732422
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.686 Vali Acc: 0.816 Test Loss: 0.686 Test Acc: 0.816
Validation loss decreased (-0.789468 --> -0.815783).  Saving model ...
Epoch: 17 cost time: 1.5167880058288574
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.623 Vali Acc: 0.763 Test Loss: 0.623 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5969440937042236
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.680 Vali Acc: 0.770 Test Loss: 0.680 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.0621917247772217
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.702 Vali Acc: 0.776 Test Loss: 0.702 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9681549072265625
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.679 Vali Acc: 0.770 Test Loss: 0.679 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.860027551651001
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.751 Vali Acc: 0.803 Test Loss: 0.751 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6357219219207764
Epoch: 22, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.785 Vali Acc: 0.776 Test Loss: 0.785 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.114527463912964
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.855 Vali Acc: 0.816 Test Loss: 0.855 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.9258325099945068
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.826 Vali Acc: 0.803 Test Loss: 0.826 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.1354594230651855
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.775 Vali Acc: 0.803 Test Loss: 0.775 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.8586809635162354
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.796 Vali Acc: 0.789 Test Loss: 0.796 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 2707520
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7168679237365723
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.393 Vali Acc: 0.322 Test Loss: 1.393 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 1.91585373878479
Epoch: 2, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.289 Vali Acc: 0.461 Test Loss: 1.289 Test Acc: 0.461
Validation loss decreased (-0.322354 --> -0.460513).  Saving model ...
Epoch: 3 cost time: 1.7544527053833008
Epoch: 3, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.155 Vali Acc: 0.539 Test Loss: 1.155 Test Acc: 0.539
Validation loss decreased (-0.460513 --> -0.539462).  Saving model ...
Epoch: 4 cost time: 1.8346905708312988
Epoch: 4, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.074 Vali Acc: 0.533 Test Loss: 1.074 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6528830528259277
Epoch: 5, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.858 Vali Acc: 0.632 Test Loss: 0.858 Test Acc: 0.632
Validation loss decreased (-0.539462 --> -0.631570).  Saving model ...
Epoch: 6 cost time: 2.089489221572876
Epoch: 6, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.742 Vali Acc: 0.704 Test Loss: 0.742 Test Acc: 0.704
Validation loss decreased (-0.631570 --> -0.703940).  Saving model ...
Epoch: 7 cost time: 2.310835361480713
Epoch: 7, Steps: 10 | Train Loss: 0.444 Vali Loss: 0.670 Vali Acc: 0.724 Test Loss: 0.670 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723678).  Saving model ...
Epoch: 8 cost time: 2.366218328475952
Epoch: 8, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.577 Vali Acc: 0.796 Test Loss: 0.577 Test Acc: 0.796
Validation loss decreased (-0.723678 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.8039546012878418
Epoch: 9, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.173912286758423
Epoch: 10, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.585 Vali Acc: 0.770 Test Loss: 0.585 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.106032371520996
Epoch: 11, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0389699935913086
Epoch: 12, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.578 Vali Acc: 0.750 Test Loss: 0.578 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3015332221984863
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4206151962280273
Epoch: 14, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.8938827514648438
Epoch: 15, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.799 Vali Acc: 0.789 Test Loss: 0.799 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.8626813888549805
Epoch: 16, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.629 Vali Acc: 0.783 Test Loss: 0.629 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0005481243133545
Epoch: 17, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.7699007987976074
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.649 Vali Acc: 0.796 Test Loss: 0.649 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 2706624
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6840085983276367
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.400 Vali Acc: 0.289 Test Loss: 1.400 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.2024526596069336
Epoch: 2, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.311 Vali Acc: 0.408 Test Loss: 1.311 Test Acc: 0.408
Validation loss decreased (-0.289460 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.9372165203094482
Epoch: 3, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.178 Vali Acc: 0.474 Test Loss: 1.178 Test Acc: 0.474
Validation loss decreased (-0.407882 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 2.140164852142334
Epoch: 4, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.023 Vali Acc: 0.618 Test Loss: 1.023 Test Acc: 0.618
Validation loss decreased (-0.473672 --> -0.618411).  Saving model ...
Epoch: 5 cost time: 1.4887335300445557
Epoch: 5, Steps: 10 | Train Loss: 0.837 Vali Loss: 0.894 Vali Acc: 0.658 Test Loss: 0.894 Test Acc: 0.658
Validation loss decreased (-0.618411 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.609360694885254
Epoch: 6, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.810 Vali Acc: 0.645 Test Loss: 0.810 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6044988632202148
Epoch: 7, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.680 Vali Acc: 0.737 Test Loss: 0.680 Test Acc: 0.737
Validation loss decreased (-0.657886 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 2.0589747428894043
Epoch: 8, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.715 Vali Acc: 0.697 Test Loss: 0.715 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7394530773162842
Epoch: 9, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.612 Vali Acc: 0.730 Test Loss: 0.612 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8736515045166016
Epoch: 10, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.8950073719024658
Epoch: 11, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
Validation loss decreased (-0.763152 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.9923248291015625
Epoch: 12, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7218890190124512
Epoch: 13, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.605 Vali Acc: 0.783 Test Loss: 0.605 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5866782665252686
Epoch: 14, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.698 Vali Acc: 0.757 Test Loss: 0.698 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7385902404785156
Epoch: 15, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.604 Vali Acc: 0.789 Test Loss: 0.604 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.830479383468628
Epoch: 16, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.522273063659668
Epoch: 17, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.9950308799743652
Epoch: 18, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.580 Vali Acc: 0.816 Test Loss: 0.580 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 19 cost time: 1.6474707126617432
Epoch: 19, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 20 cost time: 1.5871174335479736
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.680 Vali Acc: 0.783 Test Loss: 0.680 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5222933292388916
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.690 Vali Acc: 0.803 Test Loss: 0.690 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8214912414550781
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.733 Vali Acc: 0.796 Test Loss: 0.733 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.9863982200622559
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.724 Vali Acc: 0.809 Test Loss: 0.724 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7370765209197998
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8497755527496338
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.762 Vali Acc: 0.789 Test Loss: 0.762 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8755862712860107
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.778 Vali Acc: 0.803 Test Loss: 0.778 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.848581314086914
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.818 Vali Acc: 0.803 Test Loss: 0.818 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.5396709442138672
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.808 Vali Acc: 0.796 Test Loss: 0.808 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.553844928741455
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.834 Vali Acc: 0.796 Test Loss: 0.834 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 2705728
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4211649894714355
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.401 Vali Acc: 0.217 Test Loss: 1.401 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 1.5638108253479004
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.339 Vali Acc: 0.362 Test Loss: 1.339 Test Acc: 0.362
Validation loss decreased (-0.217091 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.673142910003662
Epoch: 3, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.197 Vali Acc: 0.553 Test Loss: 1.197 Test Acc: 0.553
Validation loss decreased (-0.361829 --> -0.552620).  Saving model ...
Epoch: 4 cost time: 1.95912504196167
Epoch: 4, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.079 Vali Acc: 0.572 Test Loss: 1.079 Test Acc: 0.572
Validation loss decreased (-0.552620 --> -0.572358).  Saving model ...
Epoch: 5 cost time: 1.590613603591919
Epoch: 5, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.021 Vali Acc: 0.526 Test Loss: 1.021 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8411083221435547
Epoch: 6, Steps: 10 | Train Loss: 0.720 Vali Loss: 0.810 Vali Acc: 0.671 Test Loss: 0.810 Test Acc: 0.671
Validation loss decreased (-0.572358 --> -0.671045).  Saving model ...
Epoch: 7 cost time: 1.6809825897216797
Epoch: 7, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.710 Vali Acc: 0.678 Test Loss: 0.710 Test Acc: 0.678
Validation loss decreased (-0.671045 --> -0.677624).  Saving model ...
Epoch: 8 cost time: 1.4704060554504395
Epoch: 8, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.699 Vali Acc: 0.711 Test Loss: 0.699 Test Acc: 0.711
Validation loss decreased (-0.677624 --> -0.710519).  Saving model ...
Epoch: 9 cost time: 1.8451669216156006
Epoch: 9, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.658 Vali Acc: 0.724 Test Loss: 0.658 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723678).  Saving model ...
Epoch: 10 cost time: 1.8221867084503174
Epoch: 10, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.608 Vali Acc: 0.763 Test Loss: 0.608 Test Acc: 0.763
Validation loss decreased (-0.723678 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.7853083610534668
Epoch: 11, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.651 Vali Acc: 0.763 Test Loss: 0.651 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5983223915100098
Epoch: 12, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.719 Vali Acc: 0.743 Test Loss: 0.719 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6384248733520508
Epoch: 13, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.717 Vali Acc: 0.750 Test Loss: 0.717 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.985548496246338
Epoch: 14, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 2.2722699642181396
Epoch: 15, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6725845336914062
Epoch: 16, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.602 Vali Acc: 0.757 Test Loss: 0.602 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6372578144073486
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6321158409118652
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.797 Vali Acc: 0.783 Test Loss: 0.797 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.145930051803589
Epoch: 19, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.902 Vali Acc: 0.776 Test Loss: 0.902 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.734361171722412
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.825 Vali Acc: 0.776 Test Loss: 0.825 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.174515962600708
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.817 Vali Acc: 0.783 Test Loss: 0.817 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5812726020812988
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.807 Vali Acc: 0.789 Test Loss: 0.807 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.64424729347229
Epoch: 23, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.794 Vali Acc: 0.789 Test Loss: 0.794 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6713042259216309
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.868 Vali Acc: 0.796 Test Loss: 0.868 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796044).  Saving model ...
Epoch: 25 cost time: 1.7303388118743896
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.854 Vali Acc: 0.783 Test Loss: 0.854 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6687226295471191
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.900 Vali Acc: 0.789 Test Loss: 0.900 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9483277797698975
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.934 Vali Acc: 0.796 Test Loss: 0.934 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.954721450805664
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.969 Vali Acc: 0.783 Test Loss: 0.969 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9647715091705322
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.999 Vali Acc: 0.789 Test Loss: 0.999 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9012455940246582
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.046 Vali Acc: 0.789 Test Loss: 1.046 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9556865692138672
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.789 Test Loss: 1.052 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7174265384674072
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.088 Vali Acc: 0.783 Test Loss: 1.088 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.612461805343628
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.088 Vali Acc: 0.783 Test Loss: 1.088 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.660050868988037
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.106 Vali Acc: 0.783 Test Loss: 1.106 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 2704832
model size : 12.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.531057834625244
Epoch: 1, Steps: 10 | Train Loss: 1.501 Vali Loss: 1.387 Vali Acc: 0.243 Test Loss: 1.387 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 2.0784761905670166
Epoch: 2, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.349 Vali Acc: 0.316 Test Loss: 1.349 Test Acc: 0.316
Validation loss decreased (-0.243407 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.9824512004852295
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.285 Vali Acc: 0.362 Test Loss: 1.285 Test Acc: 0.362
Validation loss decreased (-0.315776 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 1.7005400657653809
Epoch: 4, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.198 Vali Acc: 0.487 Test Loss: 1.198 Test Acc: 0.487
Validation loss decreased (-0.361829 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 1.9375560283660889
Epoch: 5, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.044 Vali Acc: 0.592 Test Loss: 1.044 Test Acc: 0.592
Validation loss decreased (-0.486830 --> -0.592095).  Saving model ...
Epoch: 6 cost time: 1.6348669528961182
Epoch: 6, Steps: 10 | Train Loss: 0.889 Vali Loss: 0.988 Vali Acc: 0.579 Test Loss: 0.988 Test Acc: 0.579
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7256157398223877
Epoch: 7, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.840 Vali Acc: 0.684 Test Loss: 0.840 Test Acc: 0.684
Validation loss decreased (-0.592095 --> -0.684202).  Saving model ...
Epoch: 8 cost time: 1.6290602684020996
Epoch: 8, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.721 Vali Acc: 0.717 Test Loss: 0.721 Test Acc: 0.717
Validation loss decreased (-0.684202 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 2.0144946575164795
Epoch: 9, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.661 Vali Acc: 0.730 Test Loss: 0.661 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 10 cost time: 1.8732309341430664
Epoch: 10, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.653 Vali Acc: 0.750 Test Loss: 0.653 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 1.6571431159973145
Epoch: 11, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.645 Vali Acc: 0.743 Test Loss: 0.645 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7659621238708496
Epoch: 12, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.660 Vali Acc: 0.711 Test Loss: 0.660 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9573421478271484
Epoch: 13, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.627 Vali Acc: 0.730 Test Loss: 0.627 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7952880859375
Epoch: 14, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.672748327255249
Epoch: 15, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 2.32441782951355
Epoch: 16, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 2.018897771835327
Epoch: 17, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.560 Vali Acc: 0.737 Test Loss: 0.560 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0803258419036865
Epoch: 18, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.658 Vali Acc: 0.803 Test Loss: 0.658 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802625).  Saving model ...
Epoch: 19 cost time: 1.7051737308502197
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.617 Vali Acc: 0.789 Test Loss: 0.617 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6420574188232422
Epoch: 20, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6607108116149902
Epoch: 21, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.619 Vali Acc: 0.763 Test Loss: 0.619 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8466782569885254
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.637 Vali Acc: 0.763 Test Loss: 0.637 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.8602192401885986
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.637 Vali Acc: 0.770 Test Loss: 0.637 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5476462841033936
Epoch: 24, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.674 Vali Acc: 0.757 Test Loss: 0.674 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8624815940856934
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.835 Vali Acc: 0.770 Test Loss: 0.835 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9924800395965576
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.675 Vali Acc: 0.770 Test Loss: 0.675 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6045496463775635
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.667 Vali Acc: 0.770 Test Loss: 0.667 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.546708345413208
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.739 Vali Acc: 0.796 Test Loss: 0.739 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1804800
model size : 8.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.964660406112671
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.354 Vali Acc: 0.270 Test Loss: 1.354 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.6496644020080566
Epoch: 2, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.287 Vali Acc: 0.368 Test Loss: 1.287 Test Acc: 0.368
Validation loss decreased (-0.269723 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.9805974960327148
Epoch: 3, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.180 Vali Acc: 0.533 Test Loss: 1.180 Test Acc: 0.533
Validation loss decreased (-0.368408 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 1.749453067779541
Epoch: 4, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.048 Vali Acc: 0.671 Test Loss: 1.048 Test Acc: 0.671
Validation loss decreased (-0.532883 --> -0.671042).  Saving model ...
Epoch: 5 cost time: 1.9463775157928467
Epoch: 5, Steps: 10 | Train Loss: 0.911 Vali Loss: 0.910 Vali Acc: 0.605 Test Loss: 0.910 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9855928421020508
Epoch: 6, Steps: 10 | Train Loss: 0.832 Vali Loss: 0.798 Vali Acc: 0.730 Test Loss: 0.798 Test Acc: 0.730
Validation loss decreased (-0.671042 --> -0.730255).  Saving model ...
Epoch: 7 cost time: 1.9024007320404053
Epoch: 7, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.690 Vali Acc: 0.757 Test Loss: 0.690 Test Acc: 0.757
Validation loss decreased (-0.730255 --> -0.756572).  Saving model ...
Epoch: 8 cost time: 2.0435523986816406
Epoch: 8, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.640 Vali Acc: 0.750 Test Loss: 0.640 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0235140323638916
Epoch: 9, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.9907586574554443
Epoch: 10, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
Validation loss decreased (-0.756572 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 2.130697250366211
Epoch: 11, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9871423244476318
Epoch: 12, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.566 Vali Acc: 0.757 Test Loss: 0.566 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3158888816833496
Epoch: 13, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.678 Vali Acc: 0.757 Test Loss: 0.678 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.178006887435913
Epoch: 14, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.226633071899414
Epoch: 15, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.266632556915283
Epoch: 16, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.520 Vali Acc: 0.822 Test Loss: 0.520 Test Acc: 0.822
Validation loss decreased (-0.802626 --> -0.822363).  Saving model ...
Epoch: 17 cost time: 1.9202368259429932
Epoch: 17, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.532 Vali Acc: 0.816 Test Loss: 0.532 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9854648113250732
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.358816623687744
Epoch: 19, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.094851493835449
Epoch: 20, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.534 Vali Acc: 0.803 Test Loss: 0.534 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.0240001678466797
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9466478824615479
Epoch: 22, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6881988048553467
Epoch: 23, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8029148578643799
Epoch: 24, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.221783399581909
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.0302860736846924
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.637 Vali Acc: 0.816 Test Loss: 0.637 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1804352
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4916703701019287
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.394 Vali Acc: 0.263 Test Loss: 1.394 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.823011875152588
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.349 Vali Acc: 0.342 Test Loss: 1.349 Test Acc: 0.342
Validation loss decreased (-0.263144 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.907670021057129
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.259 Vali Acc: 0.454 Test Loss: 1.259 Test Acc: 0.454
Validation loss decreased (-0.342092 --> -0.453935).  Saving model ...
Epoch: 4 cost time: 1.540100336074829
Epoch: 4, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.139 Vali Acc: 0.559 Test Loss: 1.139 Test Acc: 0.559
Validation loss decreased (-0.453935 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.405364990234375
Epoch: 5, Steps: 10 | Train Loss: 1.004 Vali Loss: 0.944 Vali Acc: 0.678 Test Loss: 0.944 Test Acc: 0.678
Validation loss decreased (-0.559199 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 1.5009698867797852
Epoch: 6, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.794 Vali Acc: 0.684 Test Loss: 0.794 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 1.7739622592926025
Epoch: 7, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.706 Vali Acc: 0.717 Test Loss: 0.706 Test Acc: 0.717
Validation loss decreased (-0.684203 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.768641471862793
Epoch: 8, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.620 Vali Acc: 0.776 Test Loss: 0.620 Test Acc: 0.776
Validation loss decreased (-0.717098 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.741858720779419
Epoch: 9, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.632 Vali Acc: 0.743 Test Loss: 0.632 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6026959419250488
Epoch: 10, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.577 Vali Acc: 0.776 Test Loss: 0.577 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.8396649360656738
Epoch: 11, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.547 Vali Acc: 0.770 Test Loss: 0.547 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7406575679779053
Epoch: 12, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.7893705368041992
Epoch: 13, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.7292768955230713
Epoch: 14, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 2.012868881225586
Epoch: 15, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.051389455795288
Epoch: 16, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.9033474922180176
Epoch: 17, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.590 Vali Acc: 0.796 Test Loss: 0.590 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8258531093597412
Epoch: 18, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5463035106658936
Epoch: 19, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.595 Vali Acc: 0.783 Test Loss: 0.595 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8103301525115967
Epoch: 20, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.568 Vali Acc: 0.803 Test Loss: 0.568 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 1.703427791595459
Epoch: 21, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8016033172607422
Epoch: 22, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.611 Vali Acc: 0.770 Test Loss: 0.611 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5918574333190918
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.577 Vali Acc: 0.796 Test Loss: 0.577 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6983356475830078
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.639 Vali Acc: 0.809 Test Loss: 0.639 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 25 cost time: 1.742281198501587
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.638 Vali Acc: 0.776 Test Loss: 0.638 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6291155815124512
Epoch: 26, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.661 Vali Acc: 0.776 Test Loss: 0.661 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7712059020996094
Epoch: 27, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6111009120941162
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.652 Vali Acc: 0.803 Test Loss: 0.652 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.9894232749938965
Epoch: 29, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.646 Vali Acc: 0.789 Test Loss: 0.646 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0012924671173096
Epoch: 30, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8283257484436035
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.680 Vali Acc: 0.803 Test Loss: 0.680 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.748732566833496
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.693 Vali Acc: 0.789 Test Loss: 0.693 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.5593106746673584
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.713 Vali Acc: 0.809 Test Loss: 0.713 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.990861177444458
Epoch: 34, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.747 Vali Acc: 0.796 Test Loss: 0.747 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1803904
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4038970470428467
Epoch: 1, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.390 Vali Acc: 0.263 Test Loss: 1.390 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.7493293285369873
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.320 Vali Acc: 0.322 Test Loss: 1.320 Test Acc: 0.322
Validation loss decreased (-0.263144 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 2.0724117755889893
Epoch: 3, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.240 Vali Acc: 0.408 Test Loss: 1.240 Test Acc: 0.408
Validation loss decreased (-0.322355 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 1.695425271987915
Epoch: 4, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.119 Vali Acc: 0.599 Test Loss: 1.119 Test Acc: 0.599
Validation loss decreased (-0.407882 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 1.9239301681518555
Epoch: 5, Steps: 10 | Train Loss: 0.940 Vali Loss: 0.983 Vali Acc: 0.605 Test Loss: 0.983 Test Acc: 0.605
Validation loss decreased (-0.598673 --> -0.605253).  Saving model ...
Epoch: 6 cost time: 1.630793571472168
Epoch: 6, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.850 Vali Acc: 0.664 Test Loss: 0.850 Test Acc: 0.664
Validation loss decreased (-0.605253 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 1.512450933456421
Epoch: 7, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.809 Vali Acc: 0.664 Test Loss: 0.809 Test Acc: 0.664
Validation loss decreased (-0.664465 --> -0.664466).  Saving model ...
Epoch: 8 cost time: 1.4655535221099854
Epoch: 8, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.716 Vali Acc: 0.691 Test Loss: 0.716 Test Acc: 0.691
Validation loss decreased (-0.664466 --> -0.690782).  Saving model ...
Epoch: 9 cost time: 1.6783382892608643
Epoch: 9, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.726 Vali Acc: 0.704 Test Loss: 0.726 Test Acc: 0.704
Validation loss decreased (-0.690782 --> -0.703940).  Saving model ...
Epoch: 10 cost time: 1.842925786972046
Epoch: 10, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.599 Vali Acc: 0.743 Test Loss: 0.599 Test Acc: 0.743
Validation loss decreased (-0.703940 --> -0.743415).  Saving model ...
Epoch: 11 cost time: 2.186023235321045
Epoch: 11, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.647 Vali Acc: 0.776 Test Loss: 0.647 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776309).  Saving model ...
Epoch: 12 cost time: 1.5901827812194824
Epoch: 12, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.575 Vali Acc: 0.770 Test Loss: 0.575 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7907383441925049
Epoch: 13, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.724 Vali Acc: 0.724 Test Loss: 0.724 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.965428352355957
Epoch: 14, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.6561307907104492
Epoch: 15, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6772067546844482
Epoch: 16, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5615200996398926
Epoch: 17, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.560 Vali Acc: 0.750 Test Loss: 0.560 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.885817050933838
Epoch: 18, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.5501561164855957
Epoch: 19, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.621 Vali Acc: 0.776 Test Loss: 0.621 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0401508808135986
Epoch: 20, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9148216247558594
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.633 Vali Acc: 0.776 Test Loss: 0.633 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.587113380432129
Epoch: 22, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.644 Vali Acc: 0.763 Test Loss: 0.644 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7352020740509033
Epoch: 23, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.609 Vali Acc: 0.770 Test Loss: 0.609 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.225715160369873
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.640 Vali Acc: 0.783 Test Loss: 0.640 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7429449558258057
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.667 Vali Acc: 0.770 Test Loss: 0.667 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.0469303131103516
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.703 Vali Acc: 0.770 Test Loss: 0.703 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.7432491779327393
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.719 Vali Acc: 0.763 Test Loss: 0.719 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.7976102828979492
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.710 Vali Acc: 0.776 Test Loss: 0.710 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 1803456
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.709993839263916
Epoch: 1, Steps: 10 | Train Loss: 1.450 Vali Loss: 1.378 Vali Acc: 0.296 Test Loss: 1.378 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.5984063148498535
Epoch: 2, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.340 Vali Acc: 0.362 Test Loss: 1.340 Test Acc: 0.362
Validation loss decreased (-0.296039 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.5167346000671387
Epoch: 3, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.256 Vali Acc: 0.546 Test Loss: 1.256 Test Acc: 0.546
Validation loss decreased (-0.361829 --> -0.546040).  Saving model ...
Epoch: 4 cost time: 1.692842721939087
Epoch: 4, Steps: 10 | Train Loss: 1.192 Vali Loss: 1.152 Vali Acc: 0.592 Test Loss: 1.152 Test Acc: 0.592
Validation loss decreased (-0.546040 --> -0.592094).  Saving model ...
Epoch: 5 cost time: 1.6781835556030273
Epoch: 5, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.027 Vali Acc: 0.671 Test Loss: 1.027 Test Acc: 0.671
Validation loss decreased (-0.592094 --> -0.671042).  Saving model ...
Epoch: 6 cost time: 1.9108426570892334
Epoch: 6, Steps: 10 | Train Loss: 0.894 Vali Loss: 0.939 Vali Acc: 0.618 Test Loss: 0.939 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8571527004241943
Epoch: 7, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.769 Vali Acc: 0.737 Test Loss: 0.769 Test Acc: 0.737
Validation loss decreased (-0.671042 --> -0.736834).  Saving model ...
Epoch: 8 cost time: 1.6976699829101562
Epoch: 8, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.722 Vali Acc: 0.691 Test Loss: 0.722 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4329986572265625
Epoch: 9, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.650 Vali Acc: 0.730 Test Loss: 0.650 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8027210235595703
Epoch: 10, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
Validation loss decreased (-0.736834 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.9702024459838867
Epoch: 11, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.599149465560913
Epoch: 12, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.565 Vali Acc: 0.757 Test Loss: 0.565 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.526569128036499
Epoch: 13, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.625 Vali Acc: 0.770 Test Loss: 0.625 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.4712400436401367
Epoch: 14, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.506 Vali Acc: 0.803 Test Loss: 0.506 Test Acc: 0.803
Validation loss decreased (-0.769731 --> -0.802627).  Saving model ...
Epoch: 15 cost time: 1.783919334411621
Epoch: 15, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.543 Vali Acc: 0.796 Test Loss: 0.543 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.55889892578125
Epoch: 16, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2342689037323
Epoch: 17, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2332053184509277
Epoch: 18, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.488 Vali Acc: 0.822 Test Loss: 0.488 Test Acc: 0.822
Validation loss decreased (-0.802627 --> -0.822364).  Saving model ...
Epoch: 19 cost time: 1.6955492496490479
Epoch: 19, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.564188003540039
Epoch: 20, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.564 Vali Acc: 0.796 Test Loss: 0.564 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7045271396636963
Epoch: 21, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9730114936828613
Epoch: 22, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.504 Vali Acc: 0.836 Test Loss: 0.504 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835521).  Saving model ...
Epoch: 23 cost time: 1.9919967651367188
Epoch: 23, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.525 Vali Acc: 0.822 Test Loss: 0.525 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8837575912475586
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.554 Vali Acc: 0.803 Test Loss: 0.554 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.2016656398773193
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.532 Vali Acc: 0.829 Test Loss: 0.532 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8188433647155762
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.565 Vali Acc: 0.816 Test Loss: 0.565 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7747678756713867
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7788755893707275
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.584 Vali Acc: 0.836 Test Loss: 0.584 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8336389064788818
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.576 Vali Acc: 0.836 Test Loss: 0.576 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.0955464839935303
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.682 Vali Acc: 0.803 Test Loss: 0.682 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.015360116958618
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.599 Vali Acc: 0.842 Test Loss: 0.599 Test Acc: 0.842
Validation loss decreased (-0.835521 --> -0.842099).  Saving model ...
Epoch: 32 cost time: 1.7407965660095215
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.604 Vali Acc: 0.822 Test Loss: 0.604 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.553783893585205
Epoch: 33, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.621 Vali Acc: 0.842 Test Loss: 0.621 Test Acc: 0.842
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7097599506378174
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.650 Vali Acc: 0.809 Test Loss: 0.650 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.9705612659454346
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.635 Vali Acc: 0.842 Test Loss: 0.635 Test Acc: 0.842
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.951488733291626
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.513232707977295
Epoch: 37, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.680 Vali Acc: 0.829 Test Loss: 0.680 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4948599338531494
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.663 Vali Acc: 0.816 Test Loss: 0.663 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.7457208633422852
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.666 Vali Acc: 0.829 Test Loss: 0.666 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.7658047676086426
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.683 Vali Acc: 0.822 Test Loss: 0.683 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.059126615524292
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.707 Vali Acc: 0.822 Test Loss: 0.707 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 1210368
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.919452428817749
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.380 Vali Acc: 0.336 Test Loss: 1.380 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 2.2030413150787354
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.370 Vali Acc: 0.382 Test Loss: 1.370 Test Acc: 0.382
Validation loss decreased (-0.335513 --> -0.381565).  Saving model ...
Epoch: 3 cost time: 1.8732433319091797
Epoch: 3, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.294 Vali Acc: 0.434 Test Loss: 1.294 Test Acc: 0.434
Validation loss decreased (-0.381565 --> -0.434198).  Saving model ...
Epoch: 4 cost time: 2.052802801132202
Epoch: 4, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.209 Vali Acc: 0.559 Test Loss: 1.209 Test Acc: 0.559
Validation loss decreased (-0.434198 --> -0.559198).  Saving model ...
Epoch: 5 cost time: 1.5620598793029785
Epoch: 5, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.127 Vali Acc: 0.539 Test Loss: 1.127 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5978264808654785
Epoch: 6, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.033 Vali Acc: 0.612 Test Loss: 1.033 Test Acc: 0.612
Validation loss decreased (-0.559198 --> -0.611832).  Saving model ...
Epoch: 7 cost time: 1.4743542671203613
Epoch: 7, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.964 Vali Acc: 0.618 Test Loss: 0.964 Test Acc: 0.618
Validation loss decreased (-0.611832 --> -0.618411).  Saving model ...
Epoch: 8 cost time: 1.818120002746582
Epoch: 8, Steps: 10 | Train Loss: 0.752 Vali Loss: 0.864 Vali Acc: 0.658 Test Loss: 0.864 Test Acc: 0.658
Validation loss decreased (-0.618411 --> -0.657886).  Saving model ...
Epoch: 9 cost time: 1.5133821964263916
Epoch: 9, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.798 Vali Acc: 0.691 Test Loss: 0.798 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 2.0100247859954834
Epoch: 10, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.819 Vali Acc: 0.664 Test Loss: 0.819 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8693146705627441
Epoch: 11, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.855 Vali Acc: 0.671 Test Loss: 0.855 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6173136234283447
Epoch: 12, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.789 Vali Acc: 0.684 Test Loss: 0.789 Test Acc: 0.684
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8186500072479248
Epoch: 13, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.723 Vali Acc: 0.711 Test Loss: 0.723 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710519).  Saving model ...
Epoch: 14 cost time: 2.00736403465271
Epoch: 14, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.660 Vali Acc: 0.770 Test Loss: 0.660 Test Acc: 0.770
Validation loss decreased (-0.710519 --> -0.769730).  Saving model ...
Epoch: 15 cost time: 1.8253931999206543
Epoch: 15, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.618 Vali Acc: 0.763 Test Loss: 0.618 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.877558708190918
Epoch: 16, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 2.3187849521636963
Epoch: 17, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.630 Vali Acc: 0.776 Test Loss: 0.630 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5483999252319336
Epoch: 18, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.591 Vali Acc: 0.770 Test Loss: 0.591 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.131382703781128
Epoch: 19, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.656 Vali Acc: 0.776 Test Loss: 0.656 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9379425048828125
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.596 Vali Acc: 0.770 Test Loss: 0.596 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7708299160003662
Epoch: 21, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802625).  Saving model ...
Epoch: 22 cost time: 1.7225089073181152
Epoch: 22, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.621 Vali Acc: 0.770 Test Loss: 0.621 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9464523792266846
Epoch: 23, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 24 cost time: 1.8296964168548584
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.647 Vali Acc: 0.776 Test Loss: 0.647 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7454161643981934
Epoch: 25, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.670 Vali Acc: 0.796 Test Loss: 0.670 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7060210704803467
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.680 Vali Acc: 0.803 Test Loss: 0.680 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8354759216308594
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.699 Vali Acc: 0.796 Test Loss: 0.699 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.0732932090759277
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.782 Vali Acc: 0.796 Test Loss: 0.782 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6386492252349854
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.686 Vali Acc: 0.776 Test Loss: 0.686 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7873873710632324
Epoch: 30, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.802 Vali Acc: 0.776 Test Loss: 0.802 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.747976541519165
Epoch: 31, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.761 Vali Acc: 0.796 Test Loss: 0.761 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.122445583343506
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.756 Vali Acc: 0.783 Test Loss: 0.756 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7518079280853271
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.743 Vali Acc: 0.796 Test Loss: 0.743 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1209920
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7687745094299316
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.384 Vali Acc: 0.257 Test Loss: 1.384 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.9484829902648926
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.256565 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.626878261566162
Epoch: 3, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.297 Vali Acc: 0.349 Test Loss: 1.297 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9779019355773926
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.180 Vali Acc: 0.526 Test Loss: 1.180 Test Acc: 0.526
Validation loss decreased (-0.374987 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 1.5548791885375977
Epoch: 5, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.058 Vali Acc: 0.618 Test Loss: 1.058 Test Acc: 0.618
Validation loss decreased (-0.526304 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 2.1965489387512207
Epoch: 6, Steps: 10 | Train Loss: 0.866 Vali Loss: 0.969 Vali Acc: 0.592 Test Loss: 0.969 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8063066005706787
Epoch: 7, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.918 Vali Acc: 0.645 Test Loss: 0.918 Test Acc: 0.645
Validation loss decreased (-0.618410 --> -0.644728).  Saving model ...
Epoch: 8 cost time: 1.8464083671569824
Epoch: 8, Steps: 10 | Train Loss: 0.605 Vali Loss: 0.851 Vali Acc: 0.678 Test Loss: 0.851 Test Acc: 0.678
Validation loss decreased (-0.644728 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 1.726001262664795
Epoch: 9, Steps: 10 | Train Loss: 0.546 Vali Loss: 0.721 Vali Acc: 0.711 Test Loss: 0.721 Test Acc: 0.711
Validation loss decreased (-0.677623 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.5884137153625488
Epoch: 10, Steps: 10 | Train Loss: 0.447 Vali Loss: 0.651 Vali Acc: 0.743 Test Loss: 0.651 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743415).  Saving model ...
Epoch: 11 cost time: 2.3053979873657227
Epoch: 11, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.644 Vali Acc: 0.763 Test Loss: 0.644 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763151).  Saving model ...
Epoch: 12 cost time: 1.9316332340240479
Epoch: 12, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.613 Vali Acc: 0.770 Test Loss: 0.613 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.933126449584961
Epoch: 13, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9246675968170166
Epoch: 14, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 2.8832926750183105
Epoch: 15, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.152775526046753
Epoch: 16, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 3.058605909347534
Epoch: 17, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.869 Vali Acc: 0.750 Test Loss: 0.869 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.8016204833984375
Epoch: 18, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5018372535705566
Epoch: 19, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.705 Vali Acc: 0.757 Test Loss: 0.705 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0120086669921875
Epoch: 20, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.588 Vali Acc: 0.789 Test Loss: 0.588 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 2.5644898414611816
Epoch: 21, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.334700345993042
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.642 Vali Acc: 0.770 Test Loss: 0.642 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1301445960998535
Epoch: 23, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.651 Vali Acc: 0.770 Test Loss: 0.651 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0863397121429443
Epoch: 24, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.627 Vali Acc: 0.770 Test Loss: 0.627 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6120364665985107
Epoch: 25, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.641 Vali Acc: 0.789 Test Loss: 0.641 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.6427903175354004
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.665 Vali Acc: 0.783 Test Loss: 0.665 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.3231444358825684
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.785 Vali Acc: 0.789 Test Loss: 0.785 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.2179291248321533
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.702 Vali Acc: 0.770 Test Loss: 0.702 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.331653356552124
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.761 Vali Acc: 0.796 Test Loss: 0.761 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796045).  Saving model ...
Epoch: 30 cost time: 2.2745726108551025
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.785 Vali Acc: 0.796 Test Loss: 0.785 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.202773094177246
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.769 Vali Acc: 0.783 Test Loss: 0.769 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.228820562362671
Epoch: 32, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.796 Vali Acc: 0.770 Test Loss: 0.796 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.1119937896728516
Epoch: 33, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.823 Vali Acc: 0.789 Test Loss: 0.823 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.628103256225586
Epoch: 34, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.830 Vali Acc: 0.776 Test Loss: 0.830 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.569275379180908
Epoch: 35, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.825 Vali Acc: 0.770 Test Loss: 0.825 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.5986156463623047
Epoch: 36, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.842 Vali Acc: 0.776 Test Loss: 0.842 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.4316887855529785
Epoch: 37, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.846 Vali Acc: 0.776 Test Loss: 0.846 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.0761663913726807
Epoch: 38, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.879 Vali Acc: 0.789 Test Loss: 0.879 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.8730418682098389
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.943 Vali Acc: 0.783 Test Loss: 0.943 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 1209472
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8348968029022217
Epoch: 1, Steps: 10 | Train Loss: 1.628 Vali Loss: 1.381 Vali Acc: 0.303 Test Loss: 1.381 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.9192650318145752
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.348 Vali Acc: 0.322 Test Loss: 1.348 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.8868751525878906
Epoch: 3, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.275 Vali Acc: 0.382 Test Loss: 1.275 Test Acc: 0.382
Validation loss decreased (-0.322355 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 1.7143254280090332
Epoch: 4, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.170 Vali Acc: 0.566 Test Loss: 1.170 Test Acc: 0.566
Validation loss decreased (-0.381566 --> -0.565778).  Saving model ...
Epoch: 5 cost time: 1.6454551219940186
Epoch: 5, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.063 Vali Acc: 0.612 Test Loss: 1.063 Test Acc: 0.612
Validation loss decreased (-0.565778 --> -0.611831).  Saving model ...
Epoch: 6 cost time: 1.994478464126587
Epoch: 6, Steps: 10 | Train Loss: 0.945 Vali Loss: 0.946 Vali Acc: 0.618 Test Loss: 0.946 Test Acc: 0.618
Validation loss decreased (-0.611831 --> -0.618412).  Saving model ...
Epoch: 7 cost time: 1.8184916973114014
Epoch: 7, Steps: 10 | Train Loss: 0.837 Vali Loss: 0.864 Vali Acc: 0.632 Test Loss: 0.864 Test Acc: 0.632
Validation loss decreased (-0.618412 --> -0.631570).  Saving model ...
Epoch: 8 cost time: 1.8607113361358643
Epoch: 8, Steps: 10 | Train Loss: 0.684 Vali Loss: 0.775 Vali Acc: 0.697 Test Loss: 0.775 Test Acc: 0.697
Validation loss decreased (-0.631570 --> -0.697361).  Saving model ...
Epoch: 9 cost time: 1.6628410816192627
Epoch: 9, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.651 Vali Acc: 0.717 Test Loss: 0.651 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717099).  Saving model ...
Epoch: 10 cost time: 1.692575216293335
Epoch: 10, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.660 Vali Acc: 0.724 Test Loss: 0.660 Test Acc: 0.724
Validation loss decreased (-0.717099 --> -0.723678).  Saving model ...
Epoch: 11 cost time: 1.9808554649353027
Epoch: 11, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.625 Vali Acc: 0.743 Test Loss: 0.625 Test Acc: 0.743
Validation loss decreased (-0.723678 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.7218947410583496
Epoch: 12, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.596 Vali Acc: 0.743 Test Loss: 0.596 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 13 cost time: 1.9507875442504883
Epoch: 13, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.577 Vali Acc: 0.743 Test Loss: 0.577 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 14 cost time: 2.4325411319732666
Epoch: 14, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.566 Vali Acc: 0.770 Test Loss: 0.566 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 2.1344382762908936
Epoch: 15, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.635 Vali Acc: 0.763 Test Loss: 0.635 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7294621467590332
Epoch: 16, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.592 Vali Acc: 0.796 Test Loss: 0.592 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 2.1343953609466553
Epoch: 17, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8844232559204102
Epoch: 18, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.602 Vali Acc: 0.757 Test Loss: 0.602 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.572512149810791
Epoch: 19, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.772796630859375
Epoch: 20, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.612 Vali Acc: 0.803 Test Loss: 0.612 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 21 cost time: 1.3543369770050049
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.683725357055664
Epoch: 22, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.811 Vali Acc: 0.796 Test Loss: 0.811 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8234164714813232
Epoch: 23, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0073864459991455
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.597 Vali Acc: 0.796 Test Loss: 0.597 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5823748111724854
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.653 Vali Acc: 0.770 Test Loss: 0.653 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9214115142822266
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.661 Vali Acc: 0.789 Test Loss: 0.661 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.959101676940918
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8709461688995361
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.786 Vali Acc: 0.803 Test Loss: 0.786 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8011198043823242
Epoch: 29, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.684 Vali Acc: 0.803 Test Loss: 0.684 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8508548736572266
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.685 Vali Acc: 0.783 Test Loss: 0.685 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1209024
model size : 6.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.670275926589966
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.378 Vali Acc: 0.303 Test Loss: 1.378 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.6692843437194824
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.347 Vali Acc: 0.322 Test Loss: 1.347 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.7370631694793701
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.303 Vali Acc: 0.428 Test Loss: 1.303 Test Acc: 0.428
Validation loss decreased (-0.322355 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 1.5878827571868896
Epoch: 4, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.195 Vali Acc: 0.572 Test Loss: 1.195 Test Acc: 0.572
Validation loss decreased (-0.427619 --> -0.572356).  Saving model ...
Epoch: 5 cost time: 1.7102258205413818
Epoch: 5, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.095 Vali Acc: 0.612 Test Loss: 1.095 Test Acc: 0.612
Validation loss decreased (-0.572356 --> -0.611831).  Saving model ...
Epoch: 6 cost time: 1.8110275268554688
Epoch: 6, Steps: 10 | Train Loss: 0.956 Vali Loss: 0.971 Vali Acc: 0.638 Test Loss: 0.971 Test Acc: 0.638
Validation loss decreased (-0.611831 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 2.022299289703369
Epoch: 7, Steps: 10 | Train Loss: 0.788 Vali Loss: 0.888 Vali Acc: 0.651 Test Loss: 0.888 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651307).  Saving model ...
Epoch: 8 cost time: 1.6088385581970215
Epoch: 8, Steps: 10 | Train Loss: 0.702 Vali Loss: 0.758 Vali Acc: 0.678 Test Loss: 0.758 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677624).  Saving model ...
Epoch: 9 cost time: 1.6629745960235596
Epoch: 9, Steps: 10 | Train Loss: 0.579 Vali Loss: 0.712 Vali Acc: 0.717 Test Loss: 0.712 Test Acc: 0.717
Validation loss decreased (-0.677624 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 1.7836904525756836
Epoch: 10, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.632 Vali Acc: 0.757 Test Loss: 0.632 Test Acc: 0.757
Validation loss decreased (-0.717098 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.6031508445739746
Epoch: 11, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.628 Vali Acc: 0.789 Test Loss: 0.628 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 1.5750770568847656
Epoch: 12, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.618 Vali Acc: 0.730 Test Loss: 0.618 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7423522472381592
Epoch: 13, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.551 Vali Acc: 0.743 Test Loss: 0.551 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8686127662658691
Epoch: 14, Steps: 10 | Train Loss: 0.265 Vali Loss: 0.564 Vali Acc: 0.789 Test Loss: 0.564 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.834373950958252
Epoch: 15, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.543499231338501
Epoch: 16, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.508 Vali Acc: 0.757 Test Loss: 0.508 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.592134714126587
Epoch: 17, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.484 Vali Acc: 0.796 Test Loss: 0.484 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 18 cost time: 1.708467721939087
Epoch: 18, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.983656883239746
Epoch: 19, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8231511116027832
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.556 Vali Acc: 0.816 Test Loss: 0.556 Test Acc: 0.816
Validation loss decreased (-0.796048 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.5562775135040283
Epoch: 21, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.515 Vali Acc: 0.809 Test Loss: 0.515 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.965102195739746
Epoch: 22, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.550 Vali Acc: 0.809 Test Loss: 0.550 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.704289436340332
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.558 Vali Acc: 0.822 Test Loss: 0.558 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 24 cost time: 1.7753374576568604
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.605 Vali Acc: 0.796 Test Loss: 0.605 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6115996837615967
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8673813343048096
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.789 Vali Acc: 0.809 Test Loss: 0.789 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9295003414154053
Epoch: 27, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.865 Vali Acc: 0.789 Test Loss: 0.865 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.741828203201294
Epoch: 28, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.720 Vali Acc: 0.763 Test Loss: 0.720 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8507635593414307
Epoch: 29, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.04116153717041
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.599 Vali Acc: 0.829 Test Loss: 0.599 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828941).  Saving model ...
Epoch: 31 cost time: 1.8005762100219727
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.640 Vali Acc: 0.836 Test Loss: 0.640 Test Acc: 0.836
Validation loss decreased (-0.828941 --> -0.835520).  Saving model ...
Epoch: 32 cost time: 1.7069957256317139
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.662 Vali Acc: 0.822 Test Loss: 0.662 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6039485931396484
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.676 Vali Acc: 0.836 Test Loss: 0.676 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.947575330734253
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.706 Vali Acc: 0.849 Test Loss: 0.706 Test Acc: 0.849
Validation loss decreased (-0.835520 --> -0.848677).  Saving model ...
Epoch: 35 cost time: 1.8818023204803467
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.721 Vali Acc: 0.822 Test Loss: 0.721 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7704997062683105
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.797 Vali Acc: 0.822 Test Loss: 0.797 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.016423463821411
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.760 Vali Acc: 0.816 Test Loss: 0.760 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7317595481872559
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.739 Vali Acc: 0.816 Test Loss: 0.739 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.9584548473358154
Epoch: 39, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.719 Vali Acc: 0.809 Test Loss: 0.719 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.7082054615020752
Epoch: 40, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.750 Vali Acc: 0.822 Test Loss: 0.750 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.0192699432373047
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.754 Vali Acc: 0.796 Test Loss: 0.754 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.8753242492675781
Epoch: 42, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.764 Vali Acc: 0.816 Test Loss: 0.764 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.6571638584136963
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.783 Vali Acc: 0.816 Test Loss: 0.783 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.9443037509918213
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.791 Vali Acc: 0.829 Test Loss: 0.791 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 913152
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.336660146713257
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.361 Vali Acc: 0.336 Test Loss: 1.361 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.6865015029907227
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.323 Vali Acc: 0.428 Test Loss: 1.323 Test Acc: 0.428
Validation loss decreased (-0.335513 --> -0.427618).  Saving model ...
Epoch: 3 cost time: 1.9421441555023193
Epoch: 3, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.278 Vali Acc: 0.467 Test Loss: 1.278 Test Acc: 0.467
Validation loss decreased (-0.427618 --> -0.467092).  Saving model ...
Epoch: 4 cost time: 1.8090770244598389
Epoch: 4, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.205 Vali Acc: 0.566 Test Loss: 1.205 Test Acc: 0.566
Validation loss decreased (-0.467092 --> -0.565777).  Saving model ...
Epoch: 5 cost time: 1.4605281352996826
Epoch: 5, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.109 Vali Acc: 0.618 Test Loss: 1.109 Test Acc: 0.618
Validation loss decreased (-0.565777 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 1.6709160804748535
Epoch: 6, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.013 Vali Acc: 0.586 Test Loss: 1.013 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8234641551971436
Epoch: 7, Steps: 10 | Train Loss: 0.928 Vali Loss: 0.942 Vali Acc: 0.566 Test Loss: 0.942 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7694170475006104
Epoch: 8, Steps: 10 | Train Loss: 0.825 Vali Loss: 0.862 Vali Acc: 0.651 Test Loss: 0.862 Test Acc: 0.651
Validation loss decreased (-0.618410 --> -0.651307).  Saving model ...
Epoch: 9 cost time: 1.7680203914642334
Epoch: 9, Steps: 10 | Train Loss: 0.691 Vali Loss: 0.751 Vali Acc: 0.697 Test Loss: 0.751 Test Acc: 0.697
Validation loss decreased (-0.651307 --> -0.697361).  Saving model ...
Epoch: 10 cost time: 1.6215646266937256
Epoch: 10, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.9262046813964844
Epoch: 11, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.641 Vali Acc: 0.730 Test Loss: 0.641 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 12 cost time: 1.5374963283538818
Epoch: 12, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.659 Vali Acc: 0.737 Test Loss: 0.659 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 1.6294431686401367
Epoch: 13, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.544 Vali Acc: 0.809 Test Loss: 0.544 Test Acc: 0.809
Validation loss decreased (-0.736836 --> -0.809205).  Saving model ...
Epoch: 14 cost time: 1.6413936614990234
Epoch: 14, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1446127891540527
Epoch: 15, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.977010726928711
Epoch: 16, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7771556377410889
Epoch: 17, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.501 Vali Acc: 0.770 Test Loss: 0.501 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.693495750427246
Epoch: 18, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.583 Vali Acc: 0.783 Test Loss: 0.583 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8418543338775635
Epoch: 19, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7530972957611084
Epoch: 20, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7640223503112793
Epoch: 21, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6055083274841309
Epoch: 22, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9010210037231445
Epoch: 23, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 912704
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3766865730285645
Epoch: 1, Steps: 10 | Train Loss: 1.512 Vali Loss: 1.449 Vali Acc: 0.230 Test Loss: 1.449 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.743955135345459
Epoch: 2, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.425 Vali Acc: 0.283 Test Loss: 1.425 Test Acc: 0.283
Validation loss decreased (-0.230249 --> -0.282880).  Saving model ...
Epoch: 3 cost time: 1.7941477298736572
Epoch: 3, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.323 Vali Acc: 0.447 Test Loss: 1.323 Test Acc: 0.447
Validation loss decreased (-0.282880 --> -0.447355).  Saving model ...
Epoch: 4 cost time: 1.8744263648986816
Epoch: 4, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.227 Vali Acc: 0.513 Test Loss: 1.227 Test Acc: 0.513
Validation loss decreased (-0.447355 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 1.6070427894592285
Epoch: 5, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.100 Vali Acc: 0.632 Test Loss: 1.100 Test Acc: 0.632
Validation loss decreased (-0.513146 --> -0.631568).  Saving model ...
Epoch: 6 cost time: 1.758296251296997
Epoch: 6, Steps: 10 | Train Loss: 1.038 Vali Loss: 0.984 Vali Acc: 0.678 Test Loss: 0.984 Test Acc: 0.678
Validation loss decreased (-0.631568 --> -0.677622).  Saving model ...
Epoch: 7 cost time: 1.6177988052368164
Epoch: 7, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.847 Vali Acc: 0.717 Test Loss: 0.847 Test Acc: 0.717
Validation loss decreased (-0.677622 --> -0.717097).  Saving model ...
Epoch: 8 cost time: 1.785747766494751
Epoch: 8, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.722 Vali Acc: 0.750 Test Loss: 0.722 Test Acc: 0.750
Validation loss decreased (-0.717097 --> -0.749993).  Saving model ...
Epoch: 9 cost time: 1.8384425640106201
Epoch: 9, Steps: 10 | Train Loss: 0.564 Vali Loss: 0.620 Vali Acc: 0.743 Test Loss: 0.620 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.707685947418213
Epoch: 10, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.569 Vali Acc: 0.757 Test Loss: 0.569 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.456430196762085
Epoch: 11, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.596 Vali Acc: 0.717 Test Loss: 0.596 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6432433128356934
Epoch: 12, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.486 Vali Acc: 0.809 Test Loss: 0.486 Test Acc: 0.809
Validation loss decreased (-0.756573 --> -0.809206).  Saving model ...
Epoch: 13 cost time: 1.638615608215332
Epoch: 13, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.557539701461792
Epoch: 14, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.462 Vali Acc: 0.796 Test Loss: 0.462 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5906994342803955
Epoch: 15, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.463 Vali Acc: 0.809 Test Loss: 0.463 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 16 cost time: 1.5643012523651123
Epoch: 16, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.418 Vali Acc: 0.829 Test Loss: 0.418 Test Acc: 0.829
Validation loss decreased (-0.809206 --> -0.828943).  Saving model ...
Epoch: 17 cost time: 1.5551493167877197
Epoch: 17, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.422 Vali Acc: 0.822 Test Loss: 0.422 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4408578872680664
Epoch: 18, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.498 Vali Acc: 0.803 Test Loss: 0.498 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.478421688079834
Epoch: 19, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.463 Vali Acc: 0.816 Test Loss: 0.463 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0358479022979736
Epoch: 20, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.488 Vali Acc: 0.763 Test Loss: 0.488 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5404961109161377
Epoch: 21, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.461 Vali Acc: 0.816 Test Loss: 0.461 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5194306373596191
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.482 Vali Acc: 0.822 Test Loss: 0.482 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6396851539611816
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.509 Vali Acc: 0.803 Test Loss: 0.509 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6199183464050293
Epoch: 24, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.536 Vali Acc: 0.822 Test Loss: 0.536 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7790601253509521
Epoch: 25, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.521 Vali Acc: 0.836 Test Loss: 0.521 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835521).  Saving model ...
Epoch: 26 cost time: 1.504267692565918
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.458 Vali Acc: 0.829 Test Loss: 0.458 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5517699718475342
Epoch: 27, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.597 Vali Acc: 0.796 Test Loss: 0.597 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5418288707733154
Epoch: 28, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.542 Vali Acc: 0.809 Test Loss: 0.542 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7619707584381104
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.7334001064300537
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.639 Vali Acc: 0.803 Test Loss: 0.639 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.6028430461883545
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.536 Vali Acc: 0.816 Test Loss: 0.536 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.663750410079956
Epoch: 32, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.573 Vali Acc: 0.816 Test Loss: 0.573 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4917690753936768
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4548051357269287
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.558 Vali Acc: 0.816 Test Loss: 0.558 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.6194171905517578
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.564 Vali Acc: 0.829 Test Loss: 0.564 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 912256
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3542122840881348
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.377 Vali Acc: 0.257 Test Loss: 1.377 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.4623794555664062
Epoch: 2, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.383 Vali Acc: 0.283 Test Loss: 1.383 Test Acc: 0.283
Validation loss decreased (-0.256565 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.7171335220336914
Epoch: 3, Steps: 10 | Train Loss: 1.313 Vali Loss: 1.267 Vali Acc: 0.447 Test Loss: 1.267 Test Acc: 0.447
Validation loss decreased (-0.282881 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.5404994487762451
Epoch: 4, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.185 Vali Acc: 0.559 Test Loss: 1.185 Test Acc: 0.559
Validation loss decreased (-0.447356 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.6836607456207275
Epoch: 5, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.079 Vali Acc: 0.586 Test Loss: 1.079 Test Acc: 0.586
Validation loss decreased (-0.559199 --> -0.585516).  Saving model ...
Epoch: 6 cost time: 1.7595434188842773
Epoch: 6, Steps: 10 | Train Loss: 0.880 Vali Loss: 1.016 Vali Acc: 0.559 Test Loss: 1.016 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9886894226074219
Epoch: 7, Steps: 10 | Train Loss: 0.770 Vali Loss: 0.918 Vali Acc: 0.605 Test Loss: 0.918 Test Acc: 0.605
Validation loss decreased (-0.585516 --> -0.605254).  Saving model ...
Epoch: 8 cost time: 1.8150527477264404
Epoch: 8, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.842 Vali Acc: 0.704 Test Loss: 0.842 Test Acc: 0.704
Validation loss decreased (-0.605254 --> -0.703939).  Saving model ...
Epoch: 9 cost time: 1.6753637790679932
Epoch: 9, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.786 Vali Acc: 0.711 Test Loss: 0.786 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710518).  Saving model ...
Epoch: 10 cost time: 1.7008333206176758
Epoch: 10, Steps: 10 | Train Loss: 0.463 Vali Loss: 0.733 Vali Acc: 0.704 Test Loss: 0.733 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4195966720581055
Epoch: 11, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.703 Vali Acc: 0.724 Test Loss: 0.703 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723677).  Saving model ...
Epoch: 12 cost time: 1.4962961673736572
Epoch: 12, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.707 Vali Acc: 0.717 Test Loss: 0.707 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0822432041168213
Epoch: 13, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.759 Vali Acc: 0.684 Test Loss: 0.759 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7200870513916016
Epoch: 14, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.692 Vali Acc: 0.750 Test Loss: 0.692 Test Acc: 0.750
Validation loss decreased (-0.723677 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 1.591261625289917
Epoch: 15, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.661 Vali Acc: 0.730 Test Loss: 0.661 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0316503047943115
Epoch: 16, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.603 Vali Acc: 0.750 Test Loss: 0.603 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 17 cost time: 1.6243832111358643
Epoch: 17, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.595 Vali Acc: 0.776 Test Loss: 0.595 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.5458133220672607
Epoch: 18, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.578 Vali Acc: 0.757 Test Loss: 0.578 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6356635093688965
Epoch: 19, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.591 Vali Acc: 0.763 Test Loss: 0.591 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6766629219055176
Epoch: 20, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.608 Vali Acc: 0.763 Test Loss: 0.608 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6304843425750732
Epoch: 21, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.614 Vali Acc: 0.776 Test Loss: 0.614 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5950522422790527
Epoch: 22, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 1.6263444423675537
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8385560512542725
Epoch: 24, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.624 Vali Acc: 0.796 Test Loss: 0.624 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 25 cost time: 1.545928955078125
Epoch: 25, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.727 Vali Acc: 0.776 Test Loss: 0.727 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7575247287750244
Epoch: 26, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.626 Vali Acc: 0.763 Test Loss: 0.626 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6023533344268799
Epoch: 27, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.634 Vali Acc: 0.796 Test Loss: 0.634 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0223801136016846
Epoch: 28, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.820014238357544
Epoch: 29, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.666 Vali Acc: 0.789 Test Loss: 0.666 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6448390483856201
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.735 Vali Acc: 0.789 Test Loss: 0.735 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.2084341049194336
Epoch: 31, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.0021395683288574
Epoch: 32, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.738 Vali Acc: 0.789 Test Loss: 0.738 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.0153422355651855
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.713 Vali Acc: 0.796 Test Loss: 0.713 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.210907220840454
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.734 Vali Acc: 0.783 Test Loss: 0.734 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 911808
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.8323023319244385
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.411 Vali Acc: 0.237 Test Loss: 1.411 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 2.1604080200195312
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.412 Vali Acc: 0.263 Test Loss: 1.412 Test Acc: 0.263
Validation loss decreased (-0.236828 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 2.1378817558288574
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.356 Vali Acc: 0.296 Test Loss: 1.356 Test Acc: 0.296
Validation loss decreased (-0.263144 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 2.256263017654419
Epoch: 4, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.337 Vali Acc: 0.329 Test Loss: 1.337 Test Acc: 0.329
Validation loss decreased (-0.296039 --> -0.328934).  Saving model ...
Epoch: 5 cost time: 1.9005367755889893
Epoch: 5, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.278 Vali Acc: 0.474 Test Loss: 1.278 Test Acc: 0.474
Validation loss decreased (-0.328934 --> -0.473671).  Saving model ...
Epoch: 6 cost time: 2.168710947036743
Epoch: 6, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.214 Vali Acc: 0.467 Test Loss: 1.214 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9054977893829346
Epoch: 7, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.146 Vali Acc: 0.513 Test Loss: 1.146 Test Acc: 0.513
Validation loss decreased (-0.473671 --> -0.513146).  Saving model ...
Epoch: 8 cost time: 2.110197067260742
Epoch: 8, Steps: 10 | Train Loss: 0.924 Vali Loss: 1.078 Vali Acc: 0.526 Test Loss: 1.078 Test Acc: 0.526
Validation loss decreased (-0.513146 --> -0.526305).  Saving model ...
Epoch: 9 cost time: 1.9666881561279297
Epoch: 9, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.978 Vali Acc: 0.592 Test Loss: 0.978 Test Acc: 0.592
Validation loss decreased (-0.526305 --> -0.592095).  Saving model ...
Epoch: 10 cost time: 1.6108527183532715
Epoch: 10, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.879 Vali Acc: 0.605 Test Loss: 0.879 Test Acc: 0.605
Validation loss decreased (-0.592095 --> -0.605254).  Saving model ...
Epoch: 11 cost time: 1.764477252960205
Epoch: 11, Steps: 10 | Train Loss: 0.578 Vali Loss: 0.816 Vali Acc: 0.684 Test Loss: 0.816 Test Acc: 0.684
Validation loss decreased (-0.605254 --> -0.684202).  Saving model ...
Epoch: 12 cost time: 2.1979808807373047
Epoch: 12, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.759 Vali Acc: 0.671 Test Loss: 0.759 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0694055557250977
Epoch: 13, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.775 Vali Acc: 0.684 Test Loss: 0.775 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684203).  Saving model ...
Epoch: 14 cost time: 2.1322336196899414
Epoch: 14, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.741 Vali Acc: 0.638 Test Loss: 0.741 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2285361289978027
Epoch: 15, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.661 Vali Acc: 0.743 Test Loss: 0.661 Test Acc: 0.743
Validation loss decreased (-0.684203 --> -0.743414).  Saving model ...
Epoch: 16 cost time: 2.1445422172546387
Epoch: 16, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.673 Vali Acc: 0.711 Test Loss: 0.673 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.342960834503174
Epoch: 17, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.615 Vali Acc: 0.730 Test Loss: 0.615 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1869633197784424
Epoch: 18, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.648 Vali Acc: 0.757 Test Loss: 0.648 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 19 cost time: 2.3366494178771973
Epoch: 19, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.659 Vali Acc: 0.730 Test Loss: 0.659 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9340848922729492
Epoch: 20, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.636 Vali Acc: 0.750 Test Loss: 0.636 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.18589186668396
Epoch: 21, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.622 Vali Acc: 0.770 Test Loss: 0.622 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 2.1364688873291016
Epoch: 22, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.263298273086548
Epoch: 23, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.665 Vali Acc: 0.757 Test Loss: 0.665 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2031471729278564
Epoch: 24, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.669 Vali Acc: 0.743 Test Loss: 0.669 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8302643299102783
Epoch: 25, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.662 Vali Acc: 0.776 Test Loss: 0.662 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 26 cost time: 2.552155017852783
Epoch: 26, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.694 Vali Acc: 0.743 Test Loss: 0.694 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5533347129821777
Epoch: 27, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.669 Vali Acc: 0.757 Test Loss: 0.669 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.44744873046875
Epoch: 28, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.650 Vali Acc: 0.770 Test Loss: 0.650 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.434675693511963
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.669 Vali Acc: 0.783 Test Loss: 0.669 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 30 cost time: 2.635097026824951
Epoch: 30, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.767 Vali Acc: 0.770 Test Loss: 0.767 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.738308906555176
Epoch: 31, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.736 Vali Acc: 0.770 Test Loss: 0.736 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.3446784019470215
Epoch: 32, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.808 Vali Acc: 0.776 Test Loss: 0.808 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.4288008213043213
Epoch: 33, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.897 Vali Acc: 0.750 Test Loss: 0.897 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.647341728210449
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.865 Vali Acc: 0.750 Test Loss: 0.865 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.046088695526123
Epoch: 35, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.815 Vali Acc: 0.783 Test Loss: 0.815 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.4209463596343994
Epoch: 36, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.890 Vali Acc: 0.776 Test Loss: 0.890 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.8287410736083984
Epoch: 37, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.885 Vali Acc: 0.763 Test Loss: 0.885 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.501502275466919
Epoch: 38, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.817 Vali Acc: 0.763 Test Loss: 0.817 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.4701731204986572
Epoch: 39, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.846 Vali Acc: 0.750 Test Loss: 0.846 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 764544
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8337717056274414
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.382 Vali Acc: 0.243 Test Loss: 1.382 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.6654777526855469
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.346 Vali Acc: 0.355 Test Loss: 1.346 Test Acc: 0.355
Validation loss decreased (-0.243407 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.7950806617736816
Epoch: 3, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.313 Vali Acc: 0.362 Test Loss: 1.313 Test Acc: 0.362
Validation loss decreased (-0.355250 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 1.8472743034362793
Epoch: 4, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.253 Vali Acc: 0.401 Test Loss: 1.253 Test Acc: 0.401
Validation loss decreased (-0.361829 --> -0.401303).  Saving model ...
Epoch: 5 cost time: 2.148710250854492
Epoch: 5, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.160 Vali Acc: 0.618 Test Loss: 1.160 Test Acc: 0.618
Validation loss decreased (-0.401303 --> -0.618409).  Saving model ...
Epoch: 6 cost time: 1.748549461364746
Epoch: 6, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.110 Vali Acc: 0.566 Test Loss: 1.110 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8993327617645264
Epoch: 7, Steps: 10 | Train Loss: 0.966 Vali Loss: 1.015 Vali Acc: 0.566 Test Loss: 1.015 Test Acc: 0.566
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.602358341217041
Epoch: 8, Steps: 10 | Train Loss: 0.872 Vali Loss: 0.903 Vali Acc: 0.658 Test Loss: 0.903 Test Acc: 0.658
Validation loss decreased (-0.618409 --> -0.657886).  Saving model ...
Epoch: 9 cost time: 1.7103807926177979
Epoch: 9, Steps: 10 | Train Loss: 0.734 Vali Loss: 0.852 Vali Acc: 0.658 Test Loss: 0.852 Test Acc: 0.658
Validation loss decreased (-0.657886 --> -0.657886).  Saving model ...
Epoch: 10 cost time: 1.7017841339111328
Epoch: 10, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.756 Vali Acc: 0.711 Test Loss: 0.756 Test Acc: 0.711
Validation loss decreased (-0.657886 --> -0.710519).  Saving model ...
Epoch: 11 cost time: 1.812089204788208
Epoch: 11, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.668 Vali Acc: 0.737 Test Loss: 0.668 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 1.6703166961669922
Epoch: 12, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.600 Vali Acc: 0.776 Test Loss: 0.600 Test Acc: 0.776
Validation loss decreased (-0.736835 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.5110130310058594
Epoch: 13, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.662 Vali Acc: 0.717 Test Loss: 0.662 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5909147262573242
Epoch: 14, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 15 cost time: 1.782844066619873
Epoch: 15, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.9605846405029297
Epoch: 16, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802627).  Saving model ...
Epoch: 17 cost time: 1.5775325298309326
Epoch: 17, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9294369220733643
Epoch: 18, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.569 Vali Acc: 0.809 Test Loss: 0.569 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 19 cost time: 1.7764966487884521
Epoch: 19, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.478 Vali Acc: 0.789 Test Loss: 0.478 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.544111967086792
Epoch: 20, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.477 Vali Acc: 0.796 Test Loss: 0.477 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9287467002868652
Epoch: 21, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 22 cost time: 1.7362000942230225
Epoch: 22, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6237640380859375
Epoch: 23, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.499 Vali Acc: 0.803 Test Loss: 0.499 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8436548709869385
Epoch: 24, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0011022090911865
Epoch: 25, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6302330493927002
Epoch: 26, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.593 Vali Acc: 0.796 Test Loss: 0.593 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9871087074279785
Epoch: 27, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8965156078338623
Epoch: 28, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.594 Vali Acc: 0.822 Test Loss: 0.594 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.9017586708068848
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.589 Vali Acc: 0.816 Test Loss: 0.589 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9644114971160889
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.641 Vali Acc: 0.829 Test Loss: 0.641 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828941).  Saving model ...
Epoch: 31 cost time: 2.0268189907073975
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.596 Vali Acc: 0.829 Test Loss: 0.596 Test Acc: 0.829
Validation loss decreased (-0.828941 --> -0.828941).  Saving model ...
Epoch: 32 cost time: 1.8634223937988281
Epoch: 32, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.673 Vali Acc: 0.789 Test Loss: 0.673 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8828599452972412
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.706 Vali Acc: 0.796 Test Loss: 0.706 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6147005558013916
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.768 Vali Acc: 0.816 Test Loss: 0.768 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.971853494644165
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.710 Vali Acc: 0.816 Test Loss: 0.710 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.7533185482025146
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.773 Vali Acc: 0.822 Test Loss: 0.773 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.551833152770996
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.733 Vali Acc: 0.829 Test Loss: 0.733 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.7727413177490234
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.744 Vali Acc: 0.836 Test Loss: 0.744 Test Acc: 0.836
Validation loss decreased (-0.828941 --> -0.835519).  Saving model ...
Epoch: 39 cost time: 1.9179527759552002
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.814 Vali Acc: 0.816 Test Loss: 0.814 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.7216570377349854
Epoch: 40, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.795 Vali Acc: 0.796 Test Loss: 0.795 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.6921970844268799
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.761 Vali Acc: 0.789 Test Loss: 0.761 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.938293218612671
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.794 Vali Acc: 0.796 Test Loss: 0.794 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6526761054992676
Epoch: 43, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.715 Vali Acc: 0.836 Test Loss: 0.715 Test Acc: 0.836
Validation loss decreased (-0.835519 --> -0.835519).  Saving model ...
Epoch: 44 cost time: 1.6909191608428955
Epoch: 44, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.775 Vali Acc: 0.809 Test Loss: 0.775 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.8498313426971436
Epoch: 45, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.700 Vali Acc: 0.822 Test Loss: 0.700 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6302165985107422
Epoch: 46, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.908 Vali Acc: 0.803 Test Loss: 0.908 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.8123841285705566
Epoch: 47, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.729 Vali Acc: 0.836 Test Loss: 0.729 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6390018463134766
Epoch: 48, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.741 Vali Acc: 0.836 Test Loss: 0.741 Test Acc: 0.836
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.8562586307525635
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.788 Vali Acc: 0.829 Test Loss: 0.788 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.9953420162200928
Epoch: 50, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.798 Vali Acc: 0.829 Test Loss: 0.798 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.998009443283081
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.829 Test Loss: 0.814 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.6205217838287354
Epoch: 52, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.851 Vali Acc: 0.816 Test Loss: 0.851 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.420748233795166
Epoch: 53, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.851 Vali Acc: 0.836 Test Loss: 0.851 Test Acc: 0.836
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 764096
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.934051275253296
Epoch: 1, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.365 Vali Acc: 0.303 Test Loss: 1.365 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.83280348777771
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.358 Vali Acc: 0.329 Test Loss: 1.358 Test Acc: 0.329
Validation loss decreased (-0.302618 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.8334393501281738
Epoch: 3, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.287 Vali Acc: 0.461 Test Loss: 1.287 Test Acc: 0.461
Validation loss decreased (-0.328934 --> -0.460513).  Saving model ...
Epoch: 4 cost time: 1.725442886352539
Epoch: 4, Steps: 10 | Train Loss: 1.267 Vali Loss: 1.234 Vali Acc: 0.467 Test Loss: 1.234 Test Acc: 0.467
Validation loss decreased (-0.460513 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 1.6154851913452148
Epoch: 5, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.142 Vali Acc: 0.546 Test Loss: 1.142 Test Acc: 0.546
Validation loss decreased (-0.467093 --> -0.546041).  Saving model ...
Epoch: 6 cost time: 1.7678022384643555
Epoch: 6, Steps: 10 | Train Loss: 1.064 Vali Loss: 1.039 Vali Acc: 0.625 Test Loss: 1.039 Test Acc: 0.625
Validation loss decreased (-0.546041 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 1.3764376640319824
Epoch: 7, Steps: 10 | Train Loss: 0.984 Vali Loss: 0.963 Vali Acc: 0.632 Test Loss: 0.963 Test Acc: 0.632
Validation loss decreased (-0.624990 --> -0.631569).  Saving model ...
Epoch: 8 cost time: 1.555616855621338
Epoch: 8, Steps: 10 | Train Loss: 0.794 Vali Loss: 0.864 Vali Acc: 0.671 Test Loss: 0.864 Test Acc: 0.671
Validation loss decreased (-0.631569 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 1.8637712001800537
Epoch: 9, Steps: 10 | Train Loss: 0.684 Vali Loss: 0.803 Vali Acc: 0.691 Test Loss: 0.803 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690781).  Saving model ...
Epoch: 10 cost time: 1.7815771102905273
Epoch: 10, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.809 Vali Acc: 0.645 Test Loss: 0.809 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9288241863250732
Epoch: 11, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.645 Vali Acc: 0.737 Test Loss: 0.645 Test Acc: 0.737
Validation loss decreased (-0.690781 --> -0.736836).  Saving model ...
Epoch: 12 cost time: 1.6718432903289795
Epoch: 12, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.600 Vali Acc: 0.770 Test Loss: 0.600 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.8670880794525146
Epoch: 13, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.618 Vali Acc: 0.730 Test Loss: 0.618 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.824483871459961
Epoch: 14, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.557 Vali Acc: 0.796 Test Loss: 0.557 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.9008374214172363
Epoch: 15, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.518 Vali Acc: 0.796 Test Loss: 0.518 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.9720332622528076
Epoch: 16, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.502 Vali Acc: 0.789 Test Loss: 0.502 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9527521133422852
Epoch: 17, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7521507740020752
Epoch: 18, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7476067543029785
Epoch: 19, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 20 cost time: 1.6562821865081787
Epoch: 20, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.028865337371826
Epoch: 21, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.584 Vali Acc: 0.796 Test Loss: 0.584 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0449812412261963
Epoch: 22, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.012918710708618
Epoch: 23, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.587 Vali Acc: 0.789 Test Loss: 0.587 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.8363733291625977
Epoch: 24, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 25 cost time: 1.6833367347717285
Epoch: 25, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.649 Vali Acc: 0.816 Test Loss: 0.649 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8451557159423828
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.616 Vali Acc: 0.796 Test Loss: 0.616 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.1089117527008057
Epoch: 27, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.0164575576782227
Epoch: 28, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.590 Vali Acc: 0.803 Test Loss: 0.590 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8474369049072266
Epoch: 29, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.620 Vali Acc: 0.796 Test Loss: 0.620 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.1400697231292725
Epoch: 30, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.628 Vali Acc: 0.809 Test Loss: 0.628 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9018940925598145
Epoch: 31, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.683 Vali Acc: 0.803 Test Loss: 0.683 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.0467350482940674
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.0166432857513428
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.665 Vali Acc: 0.836 Test Loss: 0.665 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835520).  Saving model ...
Epoch: 34 cost time: 1.8565990924835205
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.724 Vali Acc: 0.803 Test Loss: 0.724 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.202636241912842
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.716 Vali Acc: 0.789 Test Loss: 0.716 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6893599033355713
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.712 Vali Acc: 0.809 Test Loss: 0.712 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.0827274322509766
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.752 Vali Acc: 0.796 Test Loss: 0.752 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.056941270828247
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.749 Vali Acc: 0.809 Test Loss: 0.749 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.056382894515991
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.756 Vali Acc: 0.809 Test Loss: 0.756 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.9753880500793457
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.793 Vali Acc: 0.809 Test Loss: 0.793 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.9182138442993164
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.815 Vali Acc: 0.809 Test Loss: 0.815 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.6426303386688232
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.820 Vali Acc: 0.803 Test Loss: 0.820 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.8346302509307861
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.830 Vali Acc: 0.789 Test Loss: 0.830 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 763648
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.0594305992126465
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.400 Vali Acc: 0.283 Test Loss: 1.400 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.9761781692504883
Epoch: 2, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.416 Vali Acc: 0.224 Test Loss: 1.416 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9666175842285156
Epoch: 3, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.297 Vali Acc: 0.480 Test Loss: 1.297 Test Acc: 0.480
Validation loss decreased (-0.282881 --> -0.480250).  Saving model ...
Epoch: 4 cost time: 1.9615466594696045
Epoch: 4, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.215 Vali Acc: 0.592 Test Loss: 1.215 Test Acc: 0.592
Validation loss decreased (-0.480250 --> -0.592093).  Saving model ...
Epoch: 5 cost time: 1.9727122783660889
Epoch: 5, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.139 Vali Acc: 0.592 Test Loss: 1.139 Test Acc: 0.592
Validation loss decreased (-0.592093 --> -0.592094).  Saving model ...
Epoch: 6 cost time: 1.9189174175262451
Epoch: 6, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.010 Vali Acc: 0.618 Test Loss: 1.010 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618411).  Saving model ...
Epoch: 7 cost time: 1.7045836448669434
Epoch: 7, Steps: 10 | Train Loss: 0.831 Vali Loss: 0.905 Vali Acc: 0.664 Test Loss: 0.905 Test Acc: 0.664
Validation loss decreased (-0.618411 --> -0.664465).  Saving model ...
Epoch: 8 cost time: 1.7225978374481201
Epoch: 8, Steps: 10 | Train Loss: 0.705 Vali Loss: 0.824 Vali Acc: 0.704 Test Loss: 0.824 Test Acc: 0.704
Validation loss decreased (-0.664465 --> -0.703939).  Saving model ...
Epoch: 9 cost time: 1.8747777938842773
Epoch: 9, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.754 Vali Acc: 0.678 Test Loss: 0.754 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7694346904754639
Epoch: 10, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.679 Vali Acc: 0.737 Test Loss: 0.679 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 1.643784761428833
Epoch: 11, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.631 Vali Acc: 0.730 Test Loss: 0.631 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8887076377868652
Epoch: 12, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.585 Vali Acc: 0.789 Test Loss: 0.585 Test Acc: 0.789
Validation loss decreased (-0.736835 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.8156437873840332
Epoch: 13, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.648 Vali Acc: 0.730 Test Loss: 0.648 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7816565036773682
Epoch: 14, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.535 Vali Acc: 0.776 Test Loss: 0.535 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.052468776702881
Epoch: 15, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.547 Vali Acc: 0.757 Test Loss: 0.547 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.833608865737915
Epoch: 16, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8780624866485596
Epoch: 17, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.903853416442871
Epoch: 18, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.955148696899414
Epoch: 19, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 20 cost time: 1.8183071613311768
Epoch: 20, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8828938007354736
Epoch: 21, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.470 Vali Acc: 0.809 Test Loss: 0.470 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 22 cost time: 1.6780836582183838
Epoch: 22, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.919410228729248
Epoch: 23, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.2349588871002197
Epoch: 24, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.617 Vali Acc: 0.770 Test Loss: 0.617 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0059854984283447
Epoch: 25, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.546 Vali Acc: 0.789 Test Loss: 0.546 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.1994643211364746
Epoch: 26, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.505 Vali Acc: 0.809 Test Loss: 0.505 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8592183589935303
Epoch: 27, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 28 cost time: 2.0730955600738525
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.612 Vali Acc: 0.763 Test Loss: 0.612 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.9292571544647217
Epoch: 29, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.569 Vali Acc: 0.796 Test Loss: 0.569 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8987088203430176
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.9592745304107666
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.649 Vali Acc: 0.776 Test Loss: 0.649 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.0736501216888428
Epoch: 32, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.670 Vali Acc: 0.809 Test Loss: 0.670 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.0386440753936768
Epoch: 33, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.0830273628234863
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.677 Vali Acc: 0.776 Test Loss: 0.677 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.89493989944458
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.585 Vali Acc: 0.822 Test Loss: 0.585 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 36 cost time: 1.9434881210327148
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.665 Vali Acc: 0.789 Test Loss: 0.665 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.3716490268707275
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.396451950073242
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.744 Vali Acc: 0.783 Test Loss: 0.744 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 2.2689943313598633
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.704 Vali Acc: 0.822 Test Loss: 0.704 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.0807838439941406
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.809 Vali Acc: 0.796 Test Loss: 0.809 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.94920015335083
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.760 Vali Acc: 0.822 Test Loss: 0.760 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.728689432144165
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.756 Vali Acc: 0.789 Test Loss: 0.756 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.6816279888153076
Epoch: 43, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.787 Vali Acc: 0.783 Test Loss: 0.787 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.7113745212554932
Epoch: 44, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.769 Vali Acc: 0.822 Test Loss: 0.769 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.6493842601776123
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.813 Vali Acc: 0.783 Test Loss: 0.813 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 763200
model size : 4.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7352445125579834
Epoch: 1, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.392 Vali Acc: 0.270 Test Loss: 1.392 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.5916297435760498
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.358 Vali Acc: 0.368 Test Loss: 1.358 Test Acc: 0.368
Validation loss decreased (-0.269723 --> -0.368407).  Saving model ...
Epoch: 3 cost time: 2.0048606395721436
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.315 Vali Acc: 0.368 Test Loss: 1.315 Test Acc: 0.368
Validation loss decreased (-0.368407 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.9012291431427002
Epoch: 4, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.263 Vali Acc: 0.454 Test Loss: 1.263 Test Acc: 0.454
Validation loss decreased (-0.368408 --> -0.453935).  Saving model ...
Epoch: 5 cost time: 1.746061086654663
Epoch: 5, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
Validation loss decreased (-0.453935 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 1.907738447189331
Epoch: 6, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.130 Vali Acc: 0.539 Test Loss: 1.130 Test Acc: 0.539
Validation loss decreased (-0.467093 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 1.8943798542022705
Epoch: 7, Steps: 10 | Train Loss: 0.916 Vali Loss: 1.036 Vali Acc: 0.559 Test Loss: 1.036 Test Acc: 0.559
Validation loss decreased (-0.539462 --> -0.559200).  Saving model ...
Epoch: 8 cost time: 1.7573182582855225
Epoch: 8, Steps: 10 | Train Loss: 0.830 Vali Loss: 0.989 Vali Acc: 0.579 Test Loss: 0.989 Test Acc: 0.579
Validation loss decreased (-0.559200 --> -0.578937).  Saving model ...
Epoch: 9 cost time: 1.8405756950378418
Epoch: 9, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.907 Vali Acc: 0.599 Test Loss: 0.907 Test Acc: 0.599
Validation loss decreased (-0.578937 --> -0.598675).  Saving model ...
Epoch: 10 cost time: 2.248420000076294
Epoch: 10, Steps: 10 | Train Loss: 0.639 Vali Loss: 0.895 Vali Acc: 0.618 Test Loss: 0.895 Test Acc: 0.618
Validation loss decreased (-0.598675 --> -0.618412).  Saving model ...
Epoch: 11 cost time: 2.1884918212890625
Epoch: 11, Steps: 10 | Train Loss: 0.610 Vali Loss: 0.829 Vali Acc: 0.658 Test Loss: 0.829 Test Acc: 0.658
Validation loss decreased (-0.618412 --> -0.657886).  Saving model ...
Epoch: 12 cost time: 1.5981025695800781
Epoch: 12, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.782 Vali Acc: 0.730 Test Loss: 0.782 Test Acc: 0.730
Validation loss decreased (-0.657886 --> -0.730255).  Saving model ...
Epoch: 13 cost time: 1.6610727310180664
Epoch: 13, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.695 Vali Acc: 0.717 Test Loss: 0.695 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0053865909576416
Epoch: 14, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.668 Vali Acc: 0.750 Test Loss: 0.668 Test Acc: 0.750
Validation loss decreased (-0.730255 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 1.4254045486450195
Epoch: 15, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.6421773433685303
Epoch: 16, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.660 Vali Acc: 0.730 Test Loss: 0.660 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9097793102264404
Epoch: 17, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0469632148742676
Epoch: 18, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.621 Vali Acc: 0.770 Test Loss: 0.621 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.151343822479248
Epoch: 19, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.678 Vali Acc: 0.730 Test Loss: 0.678 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.4344868659973145
Epoch: 20, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.635 Vali Acc: 0.737 Test Loss: 0.635 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1987030506134033
Epoch: 21, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7829556465148926
Epoch: 22, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.557 Vali Acc: 0.724 Test Loss: 0.557 Test Acc: 0.724
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.392483949661255
Epoch: 23, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9640674591064453
Epoch: 24, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.589 Vali Acc: 0.776 Test Loss: 0.589 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4407782554626465
Epoch: 25, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.575 Vali Acc: 0.743 Test Loss: 0.575 Test Acc: 0.743
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 759584
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9060380458831787
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.385 Vali Acc: 0.230 Test Loss: 1.385 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 2.11086106300354
Epoch: 2, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.372 Vali Acc: 0.316 Test Loss: 1.372 Test Acc: 0.316
Validation loss decreased (-0.230249 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.9238767623901367
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.312 Vali Acc: 0.368 Test Loss: 1.312 Test Acc: 0.368
Validation loss decreased (-0.315776 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.8709678649902344
Epoch: 4, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.256 Vali Acc: 0.414 Test Loss: 1.256 Test Acc: 0.414
Validation loss decreased (-0.368408 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 2.4869983196258545
Epoch: 5, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.173 Vali Acc: 0.461 Test Loss: 1.173 Test Acc: 0.461
Validation loss decreased (-0.414461 --> -0.460515).  Saving model ...
Epoch: 6 cost time: 2.351928949356079
Epoch: 6, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.136 Vali Acc: 0.507 Test Loss: 1.136 Test Acc: 0.507
Validation loss decreased (-0.460515 --> -0.506568).  Saving model ...
Epoch: 7 cost time: 2.0994784832000732
Epoch: 7, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.087 Vali Acc: 0.493 Test Loss: 1.087 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3740079402923584
Epoch: 8, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.051 Vali Acc: 0.546 Test Loss: 1.051 Test Acc: 0.546
Validation loss decreased (-0.506568 --> -0.546042).  Saving model ...
Epoch: 9 cost time: 1.7886817455291748
Epoch: 9, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.978 Vali Acc: 0.599 Test Loss: 0.978 Test Acc: 0.599
Validation loss decreased (-0.546042 --> -0.598674).  Saving model ...
Epoch: 10 cost time: 1.869210958480835
Epoch: 10, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.912 Vali Acc: 0.599 Test Loss: 0.912 Test Acc: 0.599
Validation loss decreased (-0.598674 --> -0.598675).  Saving model ...
Epoch: 11 cost time: 2.6431446075439453
Epoch: 11, Steps: 10 | Train Loss: 0.625 Vali Loss: 0.907 Vali Acc: 0.664 Test Loss: 0.907 Test Acc: 0.664
Validation loss decreased (-0.598675 --> -0.664465).  Saving model ...
Epoch: 12 cost time: 2.377542495727539
Epoch: 12, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.810 Vali Acc: 0.664 Test Loss: 0.810 Test Acc: 0.664
Validation loss decreased (-0.664465 --> -0.664466).  Saving model ...
Epoch: 13 cost time: 2.384915351867676
Epoch: 13, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.748 Vali Acc: 0.684 Test Loss: 0.748 Test Acc: 0.684
Validation loss decreased (-0.664466 --> -0.684203).  Saving model ...
Epoch: 14 cost time: 1.8570690155029297
Epoch: 14, Steps: 10 | Train Loss: 0.394 Vali Loss: 0.693 Vali Acc: 0.750 Test Loss: 0.693 Test Acc: 0.750
Validation loss decreased (-0.684203 --> -0.749993).  Saving model ...
Epoch: 15 cost time: 2.0030062198638916
Epoch: 15, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.655 Vali Acc: 0.737 Test Loss: 0.655 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2695369720458984
Epoch: 16, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.684 Vali Acc: 0.684 Test Loss: 0.684 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2236313819885254
Epoch: 17, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.637 Vali Acc: 0.743 Test Loss: 0.637 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.1457228660583496
Epoch: 18, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.625 Vali Acc: 0.737 Test Loss: 0.625 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.526259183883667
Epoch: 19, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.586 Vali Acc: 0.750 Test Loss: 0.586 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 20 cost time: 2.492377281188965
Epoch: 20, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.647 Vali Acc: 0.737 Test Loss: 0.647 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.461609363555908
Epoch: 21, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.585 Vali Acc: 0.757 Test Loss: 0.585 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 22 cost time: 2.7458932399749756
Epoch: 22, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 23 cost time: 2.500762939453125
Epoch: 23, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.523 Vali Acc: 0.770 Test Loss: 0.523 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.40675687789917
Epoch: 24, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796048).  Saving model ...
Epoch: 25 cost time: 1.7666900157928467
Epoch: 25, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.580 Vali Acc: 0.770 Test Loss: 0.580 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.2113535404205322
Epoch: 26, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.4739677906036377
Epoch: 27, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9644832611083984
Epoch: 28, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.1855406761169434
Epoch: 29, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.8286828994750977
Epoch: 30, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.966137409210205
Epoch: 31, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.545 Vali Acc: 0.783 Test Loss: 0.545 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.2444241046905518
Epoch: 32, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.9822912216186523
Epoch: 33, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.608 Vali Acc: 0.770 Test Loss: 0.608 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.1671786308288574
Epoch: 34, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.532 Vali Acc: 0.796 Test Loss: 0.532 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 759360
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.599222421646118
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.408 Vali Acc: 0.276 Test Loss: 1.408 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 2.3716318607330322
Epoch: 2, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.374 Vali Acc: 0.316 Test Loss: 1.374 Test Acc: 0.316
Validation loss decreased (-0.276302 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.887188196182251
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.334 Vali Acc: 0.368 Test Loss: 1.334 Test Acc: 0.368
Validation loss decreased (-0.315776 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.7343223094940186
Epoch: 4, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.272 Vali Acc: 0.414 Test Loss: 1.272 Test Acc: 0.414
Validation loss decreased (-0.368408 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 1.735088586807251
Epoch: 5, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.208 Vali Acc: 0.467 Test Loss: 1.208 Test Acc: 0.467
Validation loss decreased (-0.414461 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 1.7930405139923096
Epoch: 6, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.139 Vali Acc: 0.546 Test Loss: 1.139 Test Acc: 0.546
Validation loss decreased (-0.467093 --> -0.546041).  Saving model ...
Epoch: 7 cost time: 2.0263888835906982
Epoch: 7, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.048 Vali Acc: 0.559 Test Loss: 1.048 Test Acc: 0.559
Validation loss decreased (-0.546041 --> -0.559200).  Saving model ...
Epoch: 8 cost time: 1.63279128074646
Epoch: 8, Steps: 10 | Train Loss: 0.830 Vali Loss: 0.977 Vali Acc: 0.579 Test Loss: 0.977 Test Acc: 0.579
Validation loss decreased (-0.559200 --> -0.578938).  Saving model ...
Epoch: 9 cost time: 1.7572886943817139
Epoch: 9, Steps: 10 | Train Loss: 0.786 Vali Loss: 0.928 Vali Acc: 0.520 Test Loss: 0.928 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0726516246795654
Epoch: 10, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.895 Vali Acc: 0.612 Test Loss: 0.895 Test Acc: 0.612
Validation loss decreased (-0.578938 --> -0.611833).  Saving model ...
Epoch: 11 cost time: 1.7772982120513916
Epoch: 11, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.836 Vali Acc: 0.658 Test Loss: 0.836 Test Acc: 0.658
Validation loss decreased (-0.611833 --> -0.657886).  Saving model ...
Epoch: 12 cost time: 1.7842254638671875
Epoch: 12, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.759 Vali Acc: 0.678 Test Loss: 0.759 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677624).  Saving model ...
Epoch: 13 cost time: 1.703789472579956
Epoch: 13, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.770 Vali Acc: 0.678 Test Loss: 0.770 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9687120914459229
Epoch: 14, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.750 Vali Acc: 0.678 Test Loss: 0.750 Test Acc: 0.678
Validation loss decreased (-0.677624 --> -0.677624).  Saving model ...
Epoch: 15 cost time: 1.6721291542053223
Epoch: 15, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.693 Vali Acc: 0.717 Test Loss: 0.693 Test Acc: 0.717
Validation loss decreased (-0.677624 --> -0.717098).  Saving model ...
Epoch: 16 cost time: 1.7526209354400635
Epoch: 16, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.707 Vali Acc: 0.704 Test Loss: 0.707 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0709192752838135
Epoch: 17, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.631 Vali Acc: 0.697 Test Loss: 0.631 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9617295265197754
Epoch: 18, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.645 Vali Acc: 0.724 Test Loss: 0.645 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723678).  Saving model ...
Epoch: 19 cost time: 1.900245189666748
Epoch: 19, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.632 Vali Acc: 0.704 Test Loss: 0.632 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7593519687652588
Epoch: 20, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.608 Vali Acc: 0.697 Test Loss: 0.608 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7906889915466309
Epoch: 21, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.612 Vali Acc: 0.711 Test Loss: 0.612 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6227705478668213
Epoch: 22, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.666 Vali Acc: 0.704 Test Loss: 0.666 Test Acc: 0.704
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.505969762802124
Epoch: 23, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.591 Vali Acc: 0.717 Test Loss: 0.591 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7785699367523193
Epoch: 24, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.616 Vali Acc: 0.730 Test Loss: 0.616 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 25 cost time: 2.1878244876861572
Epoch: 25, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.602 Vali Acc: 0.750 Test Loss: 0.602 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 26 cost time: 2.245286226272583
Epoch: 26, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.583 Vali Acc: 0.750 Test Loss: 0.583 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 27 cost time: 1.7235321998596191
Epoch: 27, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 28 cost time: 1.7906584739685059
Epoch: 28, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.624 Vali Acc: 0.730 Test Loss: 0.624 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6074779033660889
Epoch: 29, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.591 Vali Acc: 0.743 Test Loss: 0.591 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7632782459259033
Epoch: 30, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.655 Vali Acc: 0.737 Test Loss: 0.655 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7565655708312988
Epoch: 31, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.644 Vali Acc: 0.730 Test Loss: 0.644 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.019146203994751
Epoch: 32, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 33 cost time: 1.9419431686401367
Epoch: 33, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.641 Vali Acc: 0.776 Test Loss: 0.641 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776309).  Saving model ...
Epoch: 34 cost time: 2.309537887573242
Epoch: 34, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.803861379623413
Epoch: 35, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.634 Vali Acc: 0.730 Test Loss: 0.634 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.8900763988494873
Epoch: 36, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.674 Vali Acc: 0.743 Test Loss: 0.674 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.7792494297027588
Epoch: 37, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.715 Vali Acc: 0.724 Test Loss: 0.715 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.902714729309082
Epoch: 38, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.678 Vali Acc: 0.737 Test Loss: 0.678 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.341357469558716
Epoch: 39, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.746 Vali Acc: 0.783 Test Loss: 0.746 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782887).  Saving model ...
Epoch: 40 cost time: 1.726407527923584
Epoch: 40, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.679 Vali Acc: 0.750 Test Loss: 0.679 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.013526439666748
Epoch: 41, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.728 Vali Acc: 0.717 Test Loss: 0.728 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.4470610618591309
Epoch: 42, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.727 Vali Acc: 0.763 Test Loss: 0.727 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.9529006481170654
Epoch: 43, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.757 Vali Acc: 0.789 Test Loss: 0.757 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789466).  Saving model ...
Epoch: 44 cost time: 1.7760636806488037
Epoch: 44, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.738 Vali Acc: 0.750 Test Loss: 0.738 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.7503955364227295
Epoch: 45, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.768 Vali Acc: 0.770 Test Loss: 0.768 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.595754861831665
Epoch: 46, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.737 Vali Acc: 0.757 Test Loss: 0.737 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6935977935791016
Epoch: 47, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.700 Vali Acc: 0.770 Test Loss: 0.700 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6925408840179443
Epoch: 48, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.824 Vali Acc: 0.750 Test Loss: 0.824 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 2.1124515533447266
Epoch: 49, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.804 Vali Acc: 0.789 Test Loss: 0.804 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.2588229179382324
Epoch: 50, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.847 Vali Acc: 0.763 Test Loss: 0.847 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.002169132232666
Epoch: 51, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.824 Vali Acc: 0.743 Test Loss: 0.824 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 2.0746846199035645
Epoch: 52, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.739 Vali Acc: 0.750 Test Loss: 0.739 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 2.0867648124694824
Epoch: 53, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.736 Vali Acc: 0.803 Test Loss: 0.736 Test Acc: 0.803
Validation loss decreased (-0.789466 --> -0.802624).  Saving model ...
Epoch: 54 cost time: 1.5881078243255615
Epoch: 54, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.726 Vali Acc: 0.770 Test Loss: 0.726 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.6349644660949707
Epoch: 55, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.888 Vali Acc: 0.776 Test Loss: 0.888 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.7633376121520996
Epoch: 56, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.773 Vali Acc: 0.763 Test Loss: 0.773 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 2.0508475303649902
Epoch: 57, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.782 Vali Acc: 0.757 Test Loss: 0.782 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.705716848373413
Epoch: 58, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.768 Vali Acc: 0.776 Test Loss: 0.768 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.926964521408081
Epoch: 59, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.788 Vali Acc: 0.796 Test Loss: 0.788 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.9725265502929688
Epoch: 60, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.885 Vali Acc: 0.770 Test Loss: 0.885 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.54056715965271
Epoch: 61, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.873 Vali Acc: 0.770 Test Loss: 0.873 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 1.7928106784820557
Epoch: 62, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.844 Vali Acc: 0.783 Test Loss: 0.844 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 1.7921953201293945
Epoch: 63, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.872 Vali Acc: 0.789 Test Loss: 0.872 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 759136
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4136552810668945
Epoch: 1, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.335 Vali Acc: 0.276 Test Loss: 1.335 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.6251213550567627
Epoch: 2, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.298 Vali Acc: 0.289 Test Loss: 1.298 Test Acc: 0.289
Validation loss decreased (-0.276302 --> -0.289461).  Saving model ...
Epoch: 3 cost time: 1.9895591735839844
Epoch: 3, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.251 Vali Acc: 0.500 Test Loss: 1.251 Test Acc: 0.500
Validation loss decreased (-0.289461 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.9850177764892578
Epoch: 4, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.192 Vali Acc: 0.414 Test Loss: 1.192 Test Acc: 0.414
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9249253273010254
Epoch: 5, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.126 Vali Acc: 0.500 Test Loss: 1.126 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 1.9299492835998535
Epoch: 6, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.032 Vali Acc: 0.572 Test Loss: 1.032 Test Acc: 0.572
Validation loss decreased (-0.499989 --> -0.572358).  Saving model ...
Epoch: 7 cost time: 1.9418835639953613
Epoch: 7, Steps: 10 | Train Loss: 0.886 Vali Loss: 0.993 Vali Acc: 0.566 Test Loss: 0.993 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8703460693359375
Epoch: 8, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.911 Vali Acc: 0.638 Test Loss: 0.911 Test Acc: 0.638
Validation loss decreased (-0.572358 --> -0.638149).  Saving model ...
Epoch: 9 cost time: 1.7881994247436523
Epoch: 9, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.854 Vali Acc: 0.651 Test Loss: 0.854 Test Acc: 0.651
Validation loss decreased (-0.638149 --> -0.651307).  Saving model ...
Epoch: 10 cost time: 1.9918227195739746
Epoch: 10, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.821 Vali Acc: 0.618 Test Loss: 0.821 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9292492866516113
Epoch: 11, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.786 Vali Acc: 0.658 Test Loss: 0.786 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657887).  Saving model ...
Epoch: 12 cost time: 1.7026300430297852
Epoch: 12, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.732 Vali Acc: 0.684 Test Loss: 0.732 Test Acc: 0.684
Validation loss decreased (-0.657887 --> -0.684203).  Saving model ...
Epoch: 13 cost time: 2.465689182281494
Epoch: 13, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.696 Vali Acc: 0.684 Test Loss: 0.696 Test Acc: 0.684
Validation loss decreased (-0.684203 --> -0.684204).  Saving model ...
Epoch: 14 cost time: 1.981665849685669
Epoch: 14, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.681 Vali Acc: 0.684 Test Loss: 0.681 Test Acc: 0.684
Validation loss decreased (-0.684204 --> -0.684204).  Saving model ...
Epoch: 15 cost time: 1.8426027297973633
Epoch: 15, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.660 Vali Acc: 0.711 Test Loss: 0.660 Test Acc: 0.711
Validation loss decreased (-0.684204 --> -0.710520).  Saving model ...
Epoch: 16 cost time: 1.9473938941955566
Epoch: 16, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.659 Vali Acc: 0.704 Test Loss: 0.659 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9080612659454346
Epoch: 17, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.782 Vali Acc: 0.664 Test Loss: 0.782 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.069923162460327
Epoch: 18, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.634 Vali Acc: 0.737 Test Loss: 0.634 Test Acc: 0.737
Validation loss decreased (-0.710520 --> -0.736836).  Saving model ...
Epoch: 19 cost time: 1.8528497219085693
Epoch: 19, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.630 Vali Acc: 0.691 Test Loss: 0.630 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8488624095916748
Epoch: 20, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.634 Vali Acc: 0.717 Test Loss: 0.634 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.13820743560791
Epoch: 21, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.609 Vali Acc: 0.763 Test Loss: 0.609 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 22 cost time: 1.719911813735962
Epoch: 22, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.587 Vali Acc: 0.743 Test Loss: 0.587 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5711097717285156
Epoch: 23, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.627 Vali Acc: 0.730 Test Loss: 0.627 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8762891292572021
Epoch: 24, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.585 Vali Acc: 0.757 Test Loss: 0.585 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8274211883544922
Epoch: 25, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.577 Vali Acc: 0.763 Test Loss: 0.577 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 1.5916447639465332
Epoch: 26, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.604 Vali Acc: 0.743 Test Loss: 0.604 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.117708921432495
Epoch: 27, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.625 Vali Acc: 0.776 Test Loss: 0.625 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.6675267219543457
Epoch: 28, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.588 Vali Acc: 0.770 Test Loss: 0.588 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8784315586090088
Epoch: 29, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.659 Vali Acc: 0.776 Test Loss: 0.659 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.132559061050415
Epoch: 30, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.630 Vali Acc: 0.770 Test Loss: 0.630 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.9677975177764893
Epoch: 31, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.585 Vali Acc: 0.789 Test Loss: 0.585 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 2.141874074935913
Epoch: 32, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.135638952255249
Epoch: 33, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.894758701324463
Epoch: 34, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.630 Vali Acc: 0.803 Test Loss: 0.630 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802625).  Saving model ...
Epoch: 35 cost time: 1.8621289730072021
Epoch: 35, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.641 Vali Acc: 0.776 Test Loss: 0.641 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8003969192504883
Epoch: 36, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.698 Vali Acc: 0.776 Test Loss: 0.698 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9338748455047607
Epoch: 37, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.680 Vali Acc: 0.770 Test Loss: 0.680 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8150601387023926
Epoch: 38, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.708 Vali Acc: 0.763 Test Loss: 0.708 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.087553024291992
Epoch: 39, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.708 Vali Acc: 0.783 Test Loss: 0.708 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.9379017353057861
Epoch: 40, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.688 Vali Acc: 0.763 Test Loss: 0.688 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.8604621887207031
Epoch: 41, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.849 Vali Acc: 0.743 Test Loss: 0.849 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.9195427894592285
Epoch: 42, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.805 Vali Acc: 0.737 Test Loss: 0.805 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.9388058185577393
Epoch: 43, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.755 Vali Acc: 0.770 Test Loss: 0.755 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.849890947341919
Epoch: 44, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.707 Vali Acc: 0.789 Test Loss: 0.707 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 758912
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.811551094055176
Epoch: 1, Steps: 10 | Train Loss: 1.545 Vali Loss: 1.473 Vali Acc: 0.211 Test Loss: 1.473 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 1.4890530109405518
Epoch: 2, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.441 Vali Acc: 0.316 Test Loss: 1.441 Test Acc: 0.316
Validation loss decreased (-0.210512 --> -0.315775).  Saving model ...
Epoch: 3 cost time: 1.5982513427734375
Epoch: 3, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.388 Vali Acc: 0.329 Test Loss: 1.388 Test Acc: 0.329
Validation loss decreased (-0.315775 --> -0.328933).  Saving model ...
Epoch: 4 cost time: 1.6771996021270752
Epoch: 4, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.337 Vali Acc: 0.349 Test Loss: 1.337 Test Acc: 0.349
Validation loss decreased (-0.328933 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 1.5068995952606201
Epoch: 5, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.297 Vali Acc: 0.461 Test Loss: 1.297 Test Acc: 0.461
Validation loss decreased (-0.348671 --> -0.460513).  Saving model ...
Epoch: 6 cost time: 1.9711782932281494
Epoch: 6, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.250 Vali Acc: 0.454 Test Loss: 1.250 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.034308671951294
Epoch: 7, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.192 Vali Acc: 0.480 Test Loss: 1.192 Test Acc: 0.480
Validation loss decreased (-0.460513 --> -0.480251).  Saving model ...
Epoch: 8 cost time: 1.9419264793395996
Epoch: 8, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.115 Vali Acc: 0.526 Test Loss: 1.115 Test Acc: 0.526
Validation loss decreased (-0.480251 --> -0.526305).  Saving model ...
Epoch: 9 cost time: 1.8697826862335205
Epoch: 9, Steps: 10 | Train Loss: 0.893 Vali Loss: 1.061 Vali Acc: 0.546 Test Loss: 1.061 Test Acc: 0.546
Validation loss decreased (-0.526305 --> -0.546042).  Saving model ...
Epoch: 10 cost time: 1.6035215854644775
Epoch: 10, Steps: 10 | Train Loss: 0.750 Vali Loss: 0.958 Vali Acc: 0.586 Test Loss: 0.958 Test Acc: 0.586
Validation loss decreased (-0.546042 --> -0.585517).  Saving model ...
Epoch: 11 cost time: 2.190762996673584
Epoch: 11, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.908 Vali Acc: 0.599 Test Loss: 0.908 Test Acc: 0.599
Validation loss decreased (-0.585517 --> -0.598675).  Saving model ...
Epoch: 12 cost time: 1.5632970333099365
Epoch: 12, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.860 Vali Acc: 0.651 Test Loss: 0.860 Test Acc: 0.651
Validation loss decreased (-0.598675 --> -0.651307).  Saving model ...
Epoch: 13 cost time: 1.6209094524383545
Epoch: 13, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.789 Vali Acc: 0.678 Test Loss: 0.789 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677624).  Saving model ...
Epoch: 14 cost time: 1.9400134086608887
Epoch: 14, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.757 Vali Acc: 0.678 Test Loss: 0.757 Test Acc: 0.678
Validation loss decreased (-0.677624 --> -0.677624).  Saving model ...
Epoch: 15 cost time: 1.9660682678222656
Epoch: 15, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.747 Vali Acc: 0.730 Test Loss: 0.747 Test Acc: 0.730
Validation loss decreased (-0.677624 --> -0.730256).  Saving model ...
Epoch: 16 cost time: 2.349792718887329
Epoch: 16, Steps: 10 | Train Loss: 0.445 Vali Loss: 0.717 Vali Acc: 0.711 Test Loss: 0.717 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9063234329223633
Epoch: 17, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.678 Vali Acc: 0.743 Test Loss: 0.678 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743414).  Saving model ...
Epoch: 18 cost time: 1.9803078174591064
Epoch: 18, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.675 Vali Acc: 0.770 Test Loss: 0.675 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769730).  Saving model ...
Epoch: 19 cost time: 1.8150966167449951
Epoch: 19, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789467).  Saving model ...
Epoch: 20 cost time: 1.993175983428955
Epoch: 20, Steps: 10 | Train Loss: 0.325 Vali Loss: 0.636 Vali Acc: 0.750 Test Loss: 0.636 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9435834884643555
Epoch: 21, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 22 cost time: 2.0683722496032715
Epoch: 22, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.582 Vali Acc: 0.809 Test Loss: 0.582 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 23 cost time: 1.9621198177337646
Epoch: 23, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8623430728912354
Epoch: 24, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822363).  Saving model ...
Epoch: 25 cost time: 1.647810935974121
Epoch: 25, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.631 Vali Acc: 0.737 Test Loss: 0.631 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8060166835784912
Epoch: 26, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0439841747283936
Epoch: 27, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.520 Vali Acc: 0.803 Test Loss: 0.520 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7952320575714111
Epoch: 28, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.918924331665039
Epoch: 29, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.591 Vali Acc: 0.796 Test Loss: 0.591 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9953758716583252
Epoch: 30, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.541 Vali Acc: 0.809 Test Loss: 0.541 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8482298851013184
Epoch: 31, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.8851661682128906
Epoch: 32, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.82423734664917
Epoch: 33, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.545 Vali Acc: 0.809 Test Loss: 0.545 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.039517879486084
Epoch: 34, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.557 Vali Acc: 0.822 Test Loss: 0.557 Test Acc: 0.822
Validation loss decreased (-0.822363 --> -0.822363).  Saving model ...
Epoch: 35 cost time: 1.6123111248016357
Epoch: 35, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.8269195556640625
Epoch: 36, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.9630842208862305
Epoch: 37, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.535 Vali Acc: 0.816 Test Loss: 0.535 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8440766334533691
Epoch: 38, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6817073822021484
Epoch: 39, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.0280063152313232
Epoch: 40, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.596 Vali Acc: 0.796 Test Loss: 0.596 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.1256189346313477
Epoch: 41, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.9703986644744873
Epoch: 42, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.9935412406921387
Epoch: 43, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.605 Vali Acc: 0.776 Test Loss: 0.605 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.0709481239318848
Epoch: 44, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 460064
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.289800405502319
Epoch: 1, Steps: 10 | Train Loss: 1.669 Vali Loss: 1.440 Vali Acc: 0.224 Test Loss: 1.440 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 2.2338969707489014
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.422 Vali Acc: 0.303 Test Loss: 1.422 Test Acc: 0.303
Validation loss decreased (-0.223670 --> -0.302617).  Saving model ...
Epoch: 3 cost time: 2.102759838104248
Epoch: 3, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.412 Vali Acc: 0.355 Test Loss: 1.412 Test Acc: 0.355
Validation loss decreased (-0.302617 --> -0.355249).  Saving model ...
Epoch: 4 cost time: 2.2655482292175293
Epoch: 4, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.352 Vali Acc: 0.395 Test Loss: 1.352 Test Acc: 0.395
Validation loss decreased (-0.355249 --> -0.394723).  Saving model ...
Epoch: 5 cost time: 2.175407648086548
Epoch: 5, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.326 Vali Acc: 0.428 Test Loss: 1.326 Test Acc: 0.428
Validation loss decreased (-0.394723 --> -0.427618).  Saving model ...
Epoch: 6 cost time: 1.7583093643188477
Epoch: 6, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.281 Vali Acc: 0.507 Test Loss: 1.281 Test Acc: 0.507
Validation loss decreased (-0.427618 --> -0.506566).  Saving model ...
Epoch: 7 cost time: 2.3173277378082275
Epoch: 7, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.227 Vali Acc: 0.507 Test Loss: 1.227 Test Acc: 0.507
Validation loss decreased (-0.506566 --> -0.506567).  Saving model ...
Epoch: 8 cost time: 2.3531715869903564
Epoch: 8, Steps: 10 | Train Loss: 1.055 Vali Loss: 1.165 Vali Acc: 0.467 Test Loss: 1.165 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.389146089553833
Epoch: 9, Steps: 10 | Train Loss: 0.950 Vali Loss: 1.084 Vali Acc: 0.546 Test Loss: 1.084 Test Acc: 0.546
Validation loss decreased (-0.506567 --> -0.546042).  Saving model ...
Epoch: 10 cost time: 2.0404391288757324
Epoch: 10, Steps: 10 | Train Loss: 0.839 Vali Loss: 0.998 Vali Acc: 0.605 Test Loss: 0.998 Test Acc: 0.605
Validation loss decreased (-0.546042 --> -0.605253).  Saving model ...
Epoch: 11 cost time: 2.035672187805176
Epoch: 11, Steps: 10 | Train Loss: 0.775 Vali Loss: 0.917 Vali Acc: 0.658 Test Loss: 0.917 Test Acc: 0.658
Validation loss decreased (-0.605253 --> -0.657886).  Saving model ...
Epoch: 12 cost time: 2.7669827938079834
Epoch: 12, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.883 Vali Acc: 0.632 Test Loss: 0.883 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4394640922546387
Epoch: 13, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.874 Vali Acc: 0.684 Test Loss: 0.874 Test Acc: 0.684
Validation loss decreased (-0.657886 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 2.0534801483154297
Epoch: 14, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.808 Vali Acc: 0.664 Test Loss: 0.808 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.384011745452881
Epoch: 15, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.760 Vali Acc: 0.697 Test Loss: 0.760 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697361).  Saving model ...
Epoch: 16 cost time: 1.948333978652954
Epoch: 16, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.713 Vali Acc: 0.704 Test Loss: 0.713 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 17 cost time: 2.146031618118286
Epoch: 17, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.719 Vali Acc: 0.711 Test Loss: 0.719 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 18 cost time: 1.864478588104248
Epoch: 18, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.657 Vali Acc: 0.737 Test Loss: 0.657 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736836).  Saving model ...
Epoch: 19 cost time: 1.958324670791626
Epoch: 19, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.655 Vali Acc: 0.770 Test Loss: 0.655 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769730).  Saving model ...
Epoch: 20 cost time: 2.0593230724334717
Epoch: 20, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.623 Vali Acc: 0.757 Test Loss: 0.623 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2910683155059814
Epoch: 21, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.607 Vali Acc: 0.737 Test Loss: 0.607 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6739206314086914
Epoch: 22, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 23 cost time: 2.5979795455932617
Epoch: 23, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0175206661224365
Epoch: 24, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.584 Vali Acc: 0.763 Test Loss: 0.584 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.3304028511047363
Epoch: 25, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.586 Vali Acc: 0.757 Test Loss: 0.586 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.61271333694458
Epoch: 26, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.637 Vali Acc: 0.737 Test Loss: 0.637 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.550445318222046
Epoch: 27, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.6188766956329346
Epoch: 28, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.610 Vali Acc: 0.757 Test Loss: 0.610 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.205801486968994
Epoch: 29, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.5572543144226074
Epoch: 30, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.598 Vali Acc: 0.763 Test Loss: 0.598 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.306506633758545
Epoch: 31, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.630 Vali Acc: 0.763 Test Loss: 0.630 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.29649019241333
Epoch: 32, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782888).  Saving model ...
Epoch: 33 cost time: 2.2329750061035156
Epoch: 33, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.620 Vali Acc: 0.743 Test Loss: 0.620 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.33790922164917
Epoch: 34, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.6435253620147705
Epoch: 35, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.701 Vali Acc: 0.776 Test Loss: 0.701 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.1872904300689697
Epoch: 36, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.660 Vali Acc: 0.743 Test Loss: 0.660 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.3807191848754883
Epoch: 37, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.611 Vali Acc: 0.770 Test Loss: 0.611 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.0721824169158936
Epoch: 38, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.648 Vali Acc: 0.743 Test Loss: 0.648 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.2551045417785645
Epoch: 39, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.651 Vali Acc: 0.757 Test Loss: 0.651 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.477966547012329
Epoch: 40, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.621 Vali Acc: 0.770 Test Loss: 0.621 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.293003797531128
Epoch: 41, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.644 Vali Acc: 0.757 Test Loss: 0.644 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.053243637084961
Epoch: 42, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.644 Vali Acc: 0.796 Test Loss: 0.644 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 43 cost time: 2.129342794418335
Epoch: 43, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.694 Vali Acc: 0.757 Test Loss: 0.694 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.4939377307891846
Epoch: 44, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.708 Vali Acc: 0.770 Test Loss: 0.708 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.038921594619751
Epoch: 45, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.661 Vali Acc: 0.776 Test Loss: 0.661 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.233757972717285
Epoch: 46, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.776 Vali Acc: 0.750 Test Loss: 0.776 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.8041718006134033
Epoch: 47, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.750 Vali Acc: 0.776 Test Loss: 0.750 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.954561710357666
Epoch: 48, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.760 Vali Acc: 0.743 Test Loss: 0.760 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 2.1906232833862305
Epoch: 49, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.788 Vali Acc: 0.770 Test Loss: 0.788 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.0311310291290283
Epoch: 50, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.801 Vali Acc: 0.783 Test Loss: 0.801 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.100630283355713
Epoch: 51, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.953 Vali Acc: 0.730 Test Loss: 0.953 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 2.4619498252868652
Epoch: 52, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.779 Vali Acc: 0.789 Test Loss: 0.779 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 459840
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.620561122894287
Epoch: 1, Steps: 10 | Train Loss: 1.502 Vali Loss: 1.389 Vali Acc: 0.204 Test Loss: 1.389 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 2.778752565383911
Epoch: 2, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.403 Vali Acc: 0.309 Test Loss: 1.403 Test Acc: 0.309
Validation loss decreased (-0.203933 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 2.1252593994140625
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.355 Vali Acc: 0.375 Test Loss: 1.355 Test Acc: 0.375
Validation loss decreased (-0.309197 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 2.5223710536956787
Epoch: 4, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.307 Vali Acc: 0.408 Test Loss: 1.307 Test Acc: 0.408
Validation loss decreased (-0.374986 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 2.1982710361480713
Epoch: 5, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.281 Vali Acc: 0.520 Test Loss: 1.281 Test Acc: 0.520
Validation loss decreased (-0.407882 --> -0.519724).  Saving model ...
Epoch: 6 cost time: 2.1806321144104004
Epoch: 6, Steps: 10 | Train Loss: 1.255 Vali Loss: 1.234 Vali Acc: 0.500 Test Loss: 1.234 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.423923969268799
Epoch: 7, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.153 Vali Acc: 0.586 Test Loss: 1.153 Test Acc: 0.586
Validation loss decreased (-0.519724 --> -0.585515).  Saving model ...
Epoch: 8 cost time: 2.659105062484741
Epoch: 8, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.070 Vali Acc: 0.605 Test Loss: 1.070 Test Acc: 0.605
Validation loss decreased (-0.585515 --> -0.605252).  Saving model ...
Epoch: 9 cost time: 2.116536855697632
Epoch: 9, Steps: 10 | Train Loss: 0.931 Vali Loss: 0.976 Vali Acc: 0.605 Test Loss: 0.976 Test Acc: 0.605
Validation loss decreased (-0.605252 --> -0.605253).  Saving model ...
Epoch: 10 cost time: 1.816502571105957
Epoch: 10, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.915 Vali Acc: 0.664 Test Loss: 0.915 Test Acc: 0.664
Validation loss decreased (-0.605253 --> -0.664465).  Saving model ...
Epoch: 11 cost time: 2.176638126373291
Epoch: 11, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.847 Vali Acc: 0.651 Test Loss: 0.847 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5345451831817627
Epoch: 12, Steps: 10 | Train Loss: 0.630 Vali Loss: 0.764 Vali Acc: 0.711 Test Loss: 0.764 Test Acc: 0.711
Validation loss decreased (-0.664465 --> -0.710519).  Saving model ...
Epoch: 13 cost time: 2.532564878463745
Epoch: 13, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.721 Vali Acc: 0.750 Test Loss: 0.721 Test Acc: 0.750
Validation loss decreased (-0.710519 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 1.7796893119812012
Epoch: 14, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.702 Vali Acc: 0.717 Test Loss: 0.702 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2980103492736816
Epoch: 15, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.642 Vali Acc: 0.757 Test Loss: 0.642 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 2.3036651611328125
Epoch: 16, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.625 Vali Acc: 0.757 Test Loss: 0.625 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 2.379831075668335
Epoch: 17, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.600 Vali Acc: 0.789 Test Loss: 0.600 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 2.6954920291900635
Epoch: 18, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.619 Vali Acc: 0.730 Test Loss: 0.619 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.4927151203155518
Epoch: 19, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.632 Vali Acc: 0.750 Test Loss: 0.632 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7832825183868408
Epoch: 20, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.582 Vali Acc: 0.757 Test Loss: 0.582 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.026677131652832
Epoch: 21, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.565 Vali Acc: 0.757 Test Loss: 0.565 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2167105674743652
Epoch: 22, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 2.160778760910034
Epoch: 23, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1964340209960938
Epoch: 24, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.493 Vali Acc: 0.757 Test Loss: 0.493 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.099787712097168
Epoch: 25, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.518 Vali Acc: 0.816 Test Loss: 0.518 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 26 cost time: 2.17818546295166
Epoch: 26, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.517 Vali Acc: 0.763 Test Loss: 0.517 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1423444747924805
Epoch: 27, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0718564987182617
Epoch: 28, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.393880605697632
Epoch: 29, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9201610088348389
Epoch: 30, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.9772136211395264
Epoch: 31, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.501 Vali Acc: 0.776 Test Loss: 0.501 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.4293882846832275
Epoch: 32, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.510 Vali Acc: 0.763 Test Loss: 0.510 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.219614267349243
Epoch: 33, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.486 Vali Acc: 0.783 Test Loss: 0.486 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.0825626850128174
Epoch: 34, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.3260650634765625
Epoch: 35, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.506 Vali Acc: 0.796 Test Loss: 0.506 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 459616
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.242140054702759
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.385 Vali Acc: 0.276 Test Loss: 1.385 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 2.006556987762451
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.352 Vali Acc: 0.395 Test Loss: 1.352 Test Acc: 0.395
Validation loss decreased (-0.276302 --> -0.394723).  Saving model ...
Epoch: 3 cost time: 1.7338449954986572
Epoch: 3, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.316 Vali Acc: 0.414 Test Loss: 1.316 Test Acc: 0.414
Validation loss decreased (-0.394723 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 1.9303300380706787
Epoch: 4, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.281 Vali Acc: 0.362 Test Loss: 1.281 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.107935905456543
Epoch: 5, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.233 Vali Acc: 0.461 Test Loss: 1.233 Test Acc: 0.461
Validation loss decreased (-0.414461 --> -0.460514).  Saving model ...
Epoch: 6 cost time: 1.919637680053711
Epoch: 6, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.181 Vali Acc: 0.454 Test Loss: 1.181 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.140664577484131
Epoch: 7, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.118 Vali Acc: 0.520 Test Loss: 1.118 Test Acc: 0.520
Validation loss decreased (-0.460514 --> -0.519726).  Saving model ...
Epoch: 8 cost time: 2.2504069805145264
Epoch: 8, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.051 Vali Acc: 0.592 Test Loss: 1.051 Test Acc: 0.592
Validation loss decreased (-0.519726 --> -0.592095).  Saving model ...
Epoch: 9 cost time: 2.180323600769043
Epoch: 9, Steps: 10 | Train Loss: 0.851 Vali Loss: 0.995 Vali Acc: 0.599 Test Loss: 0.995 Test Acc: 0.599
Validation loss decreased (-0.592095 --> -0.598674).  Saving model ...
Epoch: 10 cost time: 2.037184000015259
Epoch: 10, Steps: 10 | Train Loss: 0.796 Vali Loss: 0.952 Vali Acc: 0.586 Test Loss: 0.952 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0015718936920166
Epoch: 11, Steps: 10 | Train Loss: 0.674 Vali Loss: 0.866 Vali Acc: 0.658 Test Loss: 0.866 Test Acc: 0.658
Validation loss decreased (-0.598674 --> -0.657886).  Saving model ...
Epoch: 12 cost time: 2.2835731506347656
Epoch: 12, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.787 Vali Acc: 0.691 Test Loss: 0.787 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690782).  Saving model ...
Epoch: 13 cost time: 2.0998055934906006
Epoch: 13, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.779 Vali Acc: 0.678 Test Loss: 0.779 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.307527542114258
Epoch: 14, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.731 Vali Acc: 0.743 Test Loss: 0.731 Test Acc: 0.743
Validation loss decreased (-0.690782 --> -0.743414).  Saving model ...
Epoch: 15 cost time: 2.2713258266448975
Epoch: 15, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.702 Vali Acc: 0.737 Test Loss: 0.702 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.713026523590088
Epoch: 16, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.699 Vali Acc: 0.730 Test Loss: 0.699 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.089695453643799
Epoch: 17, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.655 Vali Acc: 0.743 Test Loss: 0.655 Test Acc: 0.743
Validation loss decreased (-0.743414 --> -0.743414).  Saving model ...
Epoch: 18 cost time: 2.2734875679016113
Epoch: 18, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.705 Vali Acc: 0.684 Test Loss: 0.705 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8866889476776123
Epoch: 19, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.641 Vali Acc: 0.763 Test Loss: 0.641 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763151).  Saving model ...
Epoch: 20 cost time: 2.278568983078003
Epoch: 20, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.597 Vali Acc: 0.757 Test Loss: 0.597 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.1162428855895996
Epoch: 21, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.617 Vali Acc: 0.724 Test Loss: 0.617 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9378068447113037
Epoch: 22, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.600 Vali Acc: 0.743 Test Loss: 0.600 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0569777488708496
Epoch: 23, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.609 Vali Acc: 0.750 Test Loss: 0.609 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.897202491760254
Epoch: 24, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 25 cost time: 1.8642354011535645
Epoch: 25, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.610 Vali Acc: 0.724 Test Loss: 0.610 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7108855247497559
Epoch: 26, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 1.6576533317565918
Epoch: 27, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 2.4420218467712402
Epoch: 28, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7791123390197754
Epoch: 29, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.598 Vali Acc: 0.750 Test Loss: 0.598 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.05922269821167
Epoch: 30, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.538 Vali Acc: 0.763 Test Loss: 0.538 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8258328437805176
Epoch: 31, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7494053840637207
Epoch: 32, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.632 Vali Acc: 0.743 Test Loss: 0.632 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7721078395843506
Epoch: 33, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.532 Vali Acc: 0.763 Test Loss: 0.532 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.957219123840332
Epoch: 34, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.549 Vali Acc: 0.776 Test Loss: 0.549 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 35 cost time: 2.0411763191223145
Epoch: 35, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.548 Vali Acc: 0.757 Test Loss: 0.548 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.2889180183410645
Epoch: 36, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 37 cost time: 2.334432363510132
Epoch: 37, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.537 Vali Acc: 0.789 Test Loss: 0.537 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 2.0366642475128174
Epoch: 38, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.2960684299468994
Epoch: 39, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.9658539295196533
Epoch: 40, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.575 Vali Acc: 0.796 Test Loss: 0.575 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 41 cost time: 1.7889180183410645
Epoch: 41, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.588 Vali Acc: 0.770 Test Loss: 0.588 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 2.0940818786621094
Epoch: 42, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.7236855030059814
Epoch: 43, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.665 Vali Acc: 0.750 Test Loss: 0.665 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.376540422439575
Epoch: 44, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.656 Vali Acc: 0.750 Test Loss: 0.656 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.220607280731201
Epoch: 45, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.752 Vali Acc: 0.757 Test Loss: 0.752 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 2.0810697078704834
Epoch: 46, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.721 Vali Acc: 0.757 Test Loss: 0.721 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.8487727642059326
Epoch: 47, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.8370435237884521
Epoch: 48, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.690 Vali Acc: 0.789 Test Loss: 0.690 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.8379371166229248
Epoch: 49, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.721 Vali Acc: 0.789 Test Loss: 0.721 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 2.1682236194610596
Epoch: 50, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.712 Vali Acc: 0.803 Test Loss: 0.712 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 51 cost time: 1.9813308715820312
Epoch: 51, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.774 Vali Acc: 0.750 Test Loss: 0.774 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 2.169177770614624
Epoch: 52, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.765 Vali Acc: 0.789 Test Loss: 0.765 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.6103460788726807
Epoch: 53, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.737 Vali Acc: 0.763 Test Loss: 0.737 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.9705660343170166
Epoch: 54, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.738 Vali Acc: 0.783 Test Loss: 0.738 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 2.439532995223999
Epoch: 55, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.767 Vali Acc: 0.776 Test Loss: 0.767 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 2.344158887863159
Epoch: 56, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.792 Vali Acc: 0.763 Test Loss: 0.792 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.785996437072754
Epoch: 57, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.752 Vali Acc: 0.789 Test Loss: 0.752 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.9006845951080322
Epoch: 58, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.763 Vali Acc: 0.796 Test Loss: 0.763 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 2.240196943283081
Epoch: 59, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.808 Vali Acc: 0.776 Test Loss: 0.808 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.7676022052764893
Epoch: 60, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.777 Vali Acc: 0.783 Test Loss: 0.777 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 459392
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.825294017791748
Epoch: 1, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.365 Vali Acc: 0.283 Test Loss: 1.365 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.5451693534851074
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.353 Vali Acc: 0.309 Test Loss: 1.353 Test Acc: 0.309
Validation loss decreased (-0.282881 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 1.6415374279022217
Epoch: 3, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.335 Vali Acc: 0.368 Test Loss: 1.335 Test Acc: 0.368
Validation loss decreased (-0.309197 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.8197786808013916
Epoch: 4, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.287 Vali Acc: 0.441 Test Loss: 1.287 Test Acc: 0.441
Validation loss decreased (-0.368408 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 1.6830501556396484
Epoch: 5, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.243 Vali Acc: 0.487 Test Loss: 1.243 Test Acc: 0.487
Validation loss decreased (-0.440777 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 1.8777644634246826
Epoch: 6, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.191 Vali Acc: 0.586 Test Loss: 1.191 Test Acc: 0.586
Validation loss decreased (-0.486830 --> -0.585514).  Saving model ...
Epoch: 7 cost time: 1.5809097290039062
Epoch: 7, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.142 Vali Acc: 0.586 Test Loss: 1.142 Test Acc: 0.586
Validation loss decreased (-0.585514 --> -0.585515).  Saving model ...
Epoch: 8 cost time: 1.6583325862884521
Epoch: 8, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.073 Vali Acc: 0.592 Test Loss: 1.073 Test Acc: 0.592
Validation loss decreased (-0.585515 --> -0.592095).  Saving model ...
Epoch: 9 cost time: 1.8282697200775146
Epoch: 9, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.006 Vali Acc: 0.664 Test Loss: 1.006 Test Acc: 0.664
Validation loss decreased (-0.592095 --> -0.664464).  Saving model ...
Epoch: 10 cost time: 1.77470064163208
Epoch: 10, Steps: 10 | Train Loss: 0.886 Vali Loss: 0.935 Vali Acc: 0.671 Test Loss: 0.935 Test Acc: 0.671
Validation loss decreased (-0.664464 --> -0.671043).  Saving model ...
Epoch: 11 cost time: 1.7111320495605469
Epoch: 11, Steps: 10 | Train Loss: 0.818 Vali Loss: 0.879 Vali Acc: 0.671 Test Loss: 0.879 Test Acc: 0.671
Validation loss decreased (-0.671043 --> -0.671044).  Saving model ...
Epoch: 12 cost time: 2.3972837924957275
Epoch: 12, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.837 Vali Acc: 0.724 Test Loss: 0.837 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723676).  Saving model ...
Epoch: 13 cost time: 2.4330921173095703
Epoch: 13, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.866 Vali Acc: 0.671 Test Loss: 0.866 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.873368740081787
Epoch: 14, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.762 Vali Acc: 0.711 Test Loss: 0.762 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8393254280090332
Epoch: 15, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.738 Vali Acc: 0.691 Test Loss: 0.738 Test Acc: 0.691
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8571066856384277
Epoch: 16, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.677 Vali Acc: 0.730 Test Loss: 0.677 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 17 cost time: 2.0285160541534424
Epoch: 17, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.659 Vali Acc: 0.730 Test Loss: 0.659 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 18 cost time: 1.641775369644165
Epoch: 18, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.628 Vali Acc: 0.743 Test Loss: 0.628 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 19 cost time: 1.8735954761505127
Epoch: 19, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.623 Vali Acc: 0.717 Test Loss: 0.623 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6738355159759521
Epoch: 20, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
Validation loss decreased (-0.743415 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 1.8784868717193604
Epoch: 21, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.585 Vali Acc: 0.750 Test Loss: 0.585 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.779160976409912
Epoch: 22, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.552 Vali Acc: 0.743 Test Loss: 0.552 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8363981246948242
Epoch: 23, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.544 Vali Acc: 0.763 Test Loss: 0.544 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6374232769012451
Epoch: 24, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 25 cost time: 2.1127822399139404
Epoch: 25, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.576 Vali Acc: 0.750 Test Loss: 0.576 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8565926551818848
Epoch: 26, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.000094175338745
Epoch: 27, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.321516513824463
Epoch: 28, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.565 Vali Acc: 0.750 Test Loss: 0.565 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7383267879486084
Epoch: 29, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.580 Vali Acc: 0.770 Test Loss: 0.580 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7495930194854736
Epoch: 30, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8156473636627197
Epoch: 31, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7064249515533447
Epoch: 32, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.680 Vali Acc: 0.763 Test Loss: 0.680 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.8112030029296875
Epoch: 33, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.804293155670166
Epoch: 34, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.586 Vali Acc: 0.750 Test Loss: 0.586 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 310304
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.860563278198242
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.414 Vali Acc: 0.230 Test Loss: 1.414 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 2.057795286178589
Epoch: 2, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.382 Vali Acc: 0.276 Test Loss: 1.382 Test Acc: 0.276
Validation loss decreased (-0.230249 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 2.1903374195098877
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.348 Vali Acc: 0.283 Test Loss: 1.348 Test Acc: 0.283
Validation loss decreased (-0.276302 --> -0.282881).  Saving model ...
Epoch: 4 cost time: 1.74489426612854
Epoch: 4, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.317 Vali Acc: 0.355 Test Loss: 1.317 Test Acc: 0.355
Validation loss decreased (-0.282881 --> -0.355250).  Saving model ...
Epoch: 5 cost time: 1.9164090156555176
Epoch: 5, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.264 Vali Acc: 0.408 Test Loss: 1.264 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407882).  Saving model ...
Epoch: 6 cost time: 2.362067461013794
Epoch: 6, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.214 Vali Acc: 0.461 Test Loss: 1.214 Test Acc: 0.461
Validation loss decreased (-0.407882 --> -0.460514).  Saving model ...
Epoch: 7 cost time: 2.686086416244507
Epoch: 7, Steps: 10 | Train Loss: 1.139 Vali Loss: 1.168 Vali Acc: 0.434 Test Loss: 1.168 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.738003730773926
Epoch: 8, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.102 Vali Acc: 0.520 Test Loss: 1.102 Test Acc: 0.520
Validation loss decreased (-0.460514 --> -0.519726).  Saving model ...
Epoch: 9 cost time: 1.7467334270477295
Epoch: 9, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.038 Vali Acc: 0.539 Test Loss: 1.038 Test Acc: 0.539
Validation loss decreased (-0.519726 --> -0.539463).  Saving model ...
Epoch: 10 cost time: 2.1076972484588623
Epoch: 10, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.010 Vali Acc: 0.572 Test Loss: 1.010 Test Acc: 0.572
Validation loss decreased (-0.539463 --> -0.572358).  Saving model ...
Epoch: 11 cost time: 2.4332807064056396
Epoch: 11, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.937 Vali Acc: 0.592 Test Loss: 0.937 Test Acc: 0.592
Validation loss decreased (-0.572358 --> -0.592096).  Saving model ...
Epoch: 12 cost time: 2.262122869491577
Epoch: 12, Steps: 10 | Train Loss: 0.769 Vali Loss: 0.933 Vali Acc: 0.638 Test Loss: 0.933 Test Acc: 0.638
Validation loss decreased (-0.592096 --> -0.638149).  Saving model ...
Epoch: 13 cost time: 1.9498746395111084
Epoch: 13, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.848 Vali Acc: 0.625 Test Loss: 0.848 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0570948123931885
Epoch: 14, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.816 Vali Acc: 0.678 Test Loss: 0.816 Test Acc: 0.678
Validation loss decreased (-0.638149 --> -0.677623).  Saving model ...
Epoch: 15 cost time: 1.9224953651428223
Epoch: 15, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.806 Vali Acc: 0.678 Test Loss: 0.806 Test Acc: 0.678
Validation loss decreased (-0.677623 --> -0.677624).  Saving model ...
Epoch: 16 cost time: 1.9372804164886475
Epoch: 16, Steps: 10 | Train Loss: 0.553 Vali Loss: 0.744 Vali Acc: 0.645 Test Loss: 0.744 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.948354721069336
Epoch: 17, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.860 Vali Acc: 0.625 Test Loss: 0.860 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.3817832469940186
Epoch: 18, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
Validation loss decreased (-0.677624 --> -0.736835).  Saving model ...
Epoch: 19 cost time: 1.726618766784668
Epoch: 19, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.641 Vali Acc: 0.730 Test Loss: 0.641 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2942214012145996
Epoch: 20, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.726 Vali Acc: 0.691 Test Loss: 0.726 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.644430637359619
Epoch: 21, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.603 Vali Acc: 0.743 Test Loss: 0.603 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 22 cost time: 2.0912258625030518
Epoch: 22, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.612 Vali Acc: 0.763 Test Loss: 0.612 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 23 cost time: 1.9543240070343018
Epoch: 23, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.568 Vali Acc: 0.789 Test Loss: 0.568 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 24 cost time: 1.9117226600646973
Epoch: 24, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.473562717437744
Epoch: 25, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.569 Vali Acc: 0.757 Test Loss: 0.569 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.729602336883545
Epoch: 26, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8627095222473145
Epoch: 27, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8990402221679688
Epoch: 28, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.558 Vali Acc: 0.770 Test Loss: 0.558 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.903355598449707
Epoch: 29, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.558 Vali Acc: 0.763 Test Loss: 0.558 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.31506085395813
Epoch: 30, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.579 Vali Acc: 0.743 Test Loss: 0.579 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.049480676651001
Epoch: 31, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.603 Vali Acc: 0.783 Test Loss: 0.603 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.559264659881592
Epoch: 32, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.655 Vali Acc: 0.730 Test Loss: 0.655 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.169667959213257
Epoch: 33, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.609 Vali Acc: 0.750 Test Loss: 0.609 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 310080
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.811025619506836
Epoch: 1, Steps: 10 | Train Loss: 1.420 Vali Loss: 1.400 Vali Acc: 0.289 Test Loss: 1.400 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.081484317779541
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.370 Vali Acc: 0.329 Test Loss: 1.370 Test Acc: 0.329
Validation loss decreased (-0.289460 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.968632459640503
Epoch: 3, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.334 Vali Acc: 0.362 Test Loss: 1.334 Test Acc: 0.362
Validation loss decreased (-0.328934 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 1.800999641418457
Epoch: 4, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.287 Vali Acc: 0.441 Test Loss: 1.287 Test Acc: 0.441
Validation loss decreased (-0.361829 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 2.1583147048950195
Epoch: 5, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.440777 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.7764697074890137
Epoch: 6, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.149 Vali Acc: 0.579 Test Loss: 1.149 Test Acc: 0.579
Validation loss decreased (-0.499988 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 2.0860185623168945
Epoch: 7, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.081 Vali Acc: 0.599 Test Loss: 1.081 Test Acc: 0.599
Validation loss decreased (-0.578936 --> -0.598673).  Saving model ...
Epoch: 8 cost time: 1.8510584831237793
Epoch: 8, Steps: 10 | Train Loss: 0.978 Vali Loss: 1.009 Vali Acc: 0.599 Test Loss: 1.009 Test Acc: 0.599
Validation loss decreased (-0.598673 --> -0.598674).  Saving model ...
Epoch: 9 cost time: 1.812605619430542
Epoch: 9, Steps: 10 | Train Loss: 0.919 Vali Loss: 0.938 Vali Acc: 0.625 Test Loss: 0.938 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624991).  Saving model ...
Epoch: 10 cost time: 1.6252963542938232
Epoch: 10, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.886 Vali Acc: 0.632 Test Loss: 0.886 Test Acc: 0.632
Validation loss decreased (-0.624991 --> -0.631570).  Saving model ...
Epoch: 11 cost time: 1.826350450515747
Epoch: 11, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.836 Vali Acc: 0.658 Test Loss: 0.836 Test Acc: 0.658
Validation loss decreased (-0.631570 --> -0.657886).  Saving model ...
Epoch: 12 cost time: 1.80733323097229
Epoch: 12, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.780 Vali Acc: 0.664 Test Loss: 0.780 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664466).  Saving model ...
Epoch: 13 cost time: 1.975883960723877
Epoch: 13, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.740 Vali Acc: 0.691 Test Loss: 0.740 Test Acc: 0.691
Validation loss decreased (-0.664466 --> -0.690782).  Saving model ...
Epoch: 14 cost time: 2.0472466945648193
Epoch: 14, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.727 Vali Acc: 0.697 Test Loss: 0.727 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 15 cost time: 1.9870796203613281
Epoch: 15, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.685 Vali Acc: 0.678 Test Loss: 0.685 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1333425045013428
Epoch: 16, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.662 Vali Acc: 0.711 Test Loss: 0.662 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710520).  Saving model ...
Epoch: 17 cost time: 2.1413040161132812
Epoch: 17, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
Validation loss decreased (-0.710520 --> -0.717099).  Saving model ...
Epoch: 18 cost time: 1.9182453155517578
Epoch: 18, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.635 Vali Acc: 0.730 Test Loss: 0.635 Test Acc: 0.730
Validation loss decreased (-0.717099 --> -0.730257).  Saving model ...
Epoch: 19 cost time: 2.0120279788970947
Epoch: 19, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.614 Vali Acc: 0.730 Test Loss: 0.614 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 20 cost time: 1.9135375022888184
Epoch: 20, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.590 Vali Acc: 0.743 Test Loss: 0.590 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 21 cost time: 1.997464895248413
Epoch: 21, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.829582929611206
Epoch: 22, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.603 Vali Acc: 0.743 Test Loss: 0.603 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.6224403381347656
Epoch: 23, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.572 Vali Acc: 0.750 Test Loss: 0.572 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 24 cost time: 1.6414544582366943
Epoch: 24, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
Validation loss decreased (-0.749994 --> -0.789468).  Saving model ...
Epoch: 25 cost time: 1.7077600955963135
Epoch: 25, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.580 Vali Acc: 0.730 Test Loss: 0.580 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.953561782836914
Epoch: 26, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.6164038181304932
Epoch: 27, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.568 Vali Acc: 0.737 Test Loss: 0.568 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.769880771636963
Epoch: 28, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.572 Vali Acc: 0.776 Test Loss: 0.572 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7181141376495361
Epoch: 29, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.581 Vali Acc: 0.750 Test Loss: 0.581 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8213191032409668
Epoch: 30, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.6116549968719482
Epoch: 31, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.620 Vali Acc: 0.770 Test Loss: 0.620 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7503278255462646
Epoch: 32, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.620 Vali Acc: 0.763 Test Loss: 0.620 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.556349515914917
Epoch: 33, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.611 Vali Acc: 0.757 Test Loss: 0.611 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.0388667583465576
Epoch: 34, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.730 Vali Acc: 0.757 Test Loss: 0.730 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 309856
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.200773000717163
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.401 Vali Acc: 0.329 Test Loss: 1.401 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 2.1521918773651123
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.344 Vali Acc: 0.342 Test Loss: 1.344 Test Acc: 0.342
Validation loss decreased (-0.328933 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.8191580772399902
Epoch: 3, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.312 Vali Acc: 0.434 Test Loss: 1.312 Test Acc: 0.434
Validation loss decreased (-0.342092 --> -0.434197).  Saving model ...
Epoch: 4 cost time: 1.991210699081421
Epoch: 4, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.277 Vali Acc: 0.467 Test Loss: 1.277 Test Acc: 0.467
Validation loss decreased (-0.434197 --> -0.467092).  Saving model ...
Epoch: 5 cost time: 2.1911211013793945
Epoch: 5, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
Validation loss decreased (-0.467092 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 2.2422211170196533
Epoch: 6, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.199 Vali Acc: 0.553 Test Loss: 1.199 Test Acc: 0.553
Validation loss decreased (-0.499988 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 2.4821276664733887
Epoch: 7, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.162 Vali Acc: 0.520 Test Loss: 1.162 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.338094711303711
Epoch: 8, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.093 Vali Acc: 0.572 Test Loss: 1.093 Test Acc: 0.572
Validation loss decreased (-0.552620 --> -0.572357).  Saving model ...
Epoch: 9 cost time: 2.0674710273742676
Epoch: 9, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.041 Vali Acc: 0.586 Test Loss: 1.041 Test Acc: 0.586
Validation loss decreased (-0.572357 --> -0.585516).  Saving model ...
Epoch: 10 cost time: 2.1585049629211426
Epoch: 10, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.978 Vali Acc: 0.605 Test Loss: 0.978 Test Acc: 0.605
Validation loss decreased (-0.585516 --> -0.605253).  Saving model ...
Epoch: 11 cost time: 2.072328567504883
Epoch: 11, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.924 Vali Acc: 0.645 Test Loss: 0.924 Test Acc: 0.645
Validation loss decreased (-0.605253 --> -0.644728).  Saving model ...
Epoch: 12 cost time: 2.09128999710083
Epoch: 12, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.872 Vali Acc: 0.651 Test Loss: 0.872 Test Acc: 0.651
Validation loss decreased (-0.644728 --> -0.651307).  Saving model ...
Epoch: 13 cost time: 2.1457409858703613
Epoch: 13, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.832 Vali Acc: 0.691 Test Loss: 0.832 Test Acc: 0.691
Validation loss decreased (-0.651307 --> -0.690781).  Saving model ...
Epoch: 14 cost time: 2.0765600204467773
Epoch: 14, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.791 Vali Acc: 0.684 Test Loss: 0.791 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.2340493202209473
Epoch: 15, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.740 Vali Acc: 0.717 Test Loss: 0.740 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717098).  Saving model ...
Epoch: 16 cost time: 1.913116216659546
Epoch: 16, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.709 Vali Acc: 0.737 Test Loss: 0.709 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 17 cost time: 2.333503007888794
Epoch: 17, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.704 Vali Acc: 0.697 Test Loss: 0.704 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8322384357452393
Epoch: 18, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.674 Vali Acc: 0.757 Test Loss: 0.674 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 19 cost time: 2.0880846977233887
Epoch: 19, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.619 Vali Acc: 0.737 Test Loss: 0.619 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.1479854583740234
Epoch: 20, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.636 Vali Acc: 0.757 Test Loss: 0.636 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 21 cost time: 2.1670665740966797
Epoch: 21, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 22 cost time: 2.2497456073760986
Epoch: 22, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.4235880374908447
Epoch: 23, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 2.0870566368103027
Epoch: 24, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.570 Vali Acc: 0.743 Test Loss: 0.570 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7572875022888184
Epoch: 25, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 1.6461894512176514
Epoch: 26, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5329039096832275
Epoch: 27, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.611 Vali Acc: 0.757 Test Loss: 0.611 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.458885431289673
Epoch: 28, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.525 Vali Acc: 0.757 Test Loss: 0.525 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3407766819000244
Epoch: 29, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 2.151597023010254
Epoch: 30, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.541 Vali Acc: 0.763 Test Loss: 0.541 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.4281086921691895
Epoch: 31, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.1989290714263916
Epoch: 32, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.546 Vali Acc: 0.757 Test Loss: 0.546 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.142937183380127
Epoch: 33, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.110745906829834
Epoch: 34, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.9384377002716064
Epoch: 35, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.696 Vali Acc: 0.776 Test Loss: 0.696 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.7129127979278564
Epoch: 36, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 37 cost time: 1.7599449157714844
Epoch: 37, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.547 Vali Acc: 0.757 Test Loss: 0.547 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.049093723297119
Epoch: 38, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.868274211883545
Epoch: 39, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.0560078620910645
Epoch: 40, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.560 Vali Acc: 0.776 Test Loss: 0.560 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.8758299350738525
Epoch: 41, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6692373752593994
Epoch: 42, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.579 Vali Acc: 0.770 Test Loss: 0.579 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.814314365386963
Epoch: 43, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.858161449432373
Epoch: 44, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802625).  Saving model ...
Epoch: 45 cost time: 1.81742262840271
Epoch: 45, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.612 Vali Acc: 0.796 Test Loss: 0.612 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.9188649654388428
Epoch: 46, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.9088037014007568
Epoch: 47, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.633 Vali Acc: 0.783 Test Loss: 0.633 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.137556791305542
Epoch: 48, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.671 Vali Acc: 0.796 Test Loss: 0.671 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.0679094791412354
Epoch: 49, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.660 Vali Acc: 0.776 Test Loss: 0.660 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.9943556785583496
Epoch: 50, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.648 Vali Acc: 0.776 Test Loss: 0.648 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.807098388671875
Epoch: 51, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.647 Vali Acc: 0.776 Test Loss: 0.647 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.868943452835083
Epoch: 52, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.747 Vali Acc: 0.776 Test Loss: 0.747 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.8806710243225098
Epoch: 53, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.664 Vali Acc: 0.829 Test Loss: 0.664 Test Acc: 0.829
Validation loss decreased (-0.802625 --> -0.828941).  Saving model ...
Epoch: 54 cost time: 1.6731321811676025
Epoch: 54, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.744 Vali Acc: 0.763 Test Loss: 0.744 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.790609359741211
Epoch: 55, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.675 Vali Acc: 0.816 Test Loss: 0.675 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.6674816608428955
Epoch: 56, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.714 Vali Acc: 0.783 Test Loss: 0.714 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.5468673706054688
Epoch: 57, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.677 Vali Acc: 0.829 Test Loss: 0.677 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.5206928253173828
Epoch: 58, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.674 Vali Acc: 0.816 Test Loss: 0.674 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.4203135967254639
Epoch: 59, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.663 Vali Acc: 0.816 Test Loss: 0.663 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 1.6749053001403809
Epoch: 60, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.670 Vali Acc: 0.816 Test Loss: 0.670 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.7425920963287354
Epoch: 61, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.714 Vali Acc: 0.803 Test Loss: 0.714 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 2.230558156967163
Epoch: 62, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.702 Vali Acc: 0.822 Test Loss: 0.702 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 2.4462594985961914
Epoch: 63, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.700 Vali Acc: 0.822 Test Loss: 0.700 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 309632
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.796626091003418
Epoch: 1, Steps: 10 | Train Loss: 1.538 Vali Loss: 1.433 Vali Acc: 0.184 Test Loss: 1.433 Test Acc: 0.184
Validation loss decreased (inf --> -0.184196).  Saving model ...
Epoch: 2 cost time: 1.878190279006958
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.409 Vali Acc: 0.224 Test Loss: 1.409 Test Acc: 0.224
Validation loss decreased (-0.184196 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 2.112445831298828
Epoch: 3, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.394 Vali Acc: 0.237 Test Loss: 1.394 Test Acc: 0.237
Validation loss decreased (-0.223670 --> -0.236828).  Saving model ...
Epoch: 4 cost time: 1.9568290710449219
Epoch: 4, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.374 Vali Acc: 0.224 Test Loss: 1.374 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4545693397521973
Epoch: 5, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.358 Vali Acc: 0.270 Test Loss: 1.358 Test Acc: 0.270
Validation loss decreased (-0.236828 --> -0.269723).  Saving model ...
Epoch: 6 cost time: 2.389303207397461
Epoch: 6, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.344 Vali Acc: 0.289 Test Loss: 1.344 Test Acc: 0.289
Validation loss decreased (-0.269723 --> -0.289460).  Saving model ...
Epoch: 7 cost time: 2.325704336166382
Epoch: 7, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.311 Vali Acc: 0.342 Test Loss: 1.311 Test Acc: 0.342
Validation loss decreased (-0.289460 --> -0.342092).  Saving model ...
Epoch: 8 cost time: 2.1438281536102295
Epoch: 8, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.270 Vali Acc: 0.375 Test Loss: 1.270 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 9 cost time: 2.661431312561035
Epoch: 9, Steps: 10 | Train Loss: 1.227 Vali Loss: 1.221 Vali Acc: 0.493 Test Loss: 1.221 Test Acc: 0.493
Validation loss decreased (-0.374987 --> -0.493409).  Saving model ...
Epoch: 10 cost time: 2.027195453643799
Epoch: 10, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.154 Vali Acc: 0.500 Test Loss: 1.154 Test Acc: 0.500
Validation loss decreased (-0.493409 --> -0.499988).  Saving model ...
Epoch: 11 cost time: 2.1497550010681152
Epoch: 11, Steps: 10 | Train Loss: 1.027 Vali Loss: 1.069 Vali Acc: 0.592 Test Loss: 1.069 Test Acc: 0.592
Validation loss decreased (-0.499988 --> -0.592095).  Saving model ...
Epoch: 12 cost time: 2.02351450920105
Epoch: 12, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.005 Vali Acc: 0.599 Test Loss: 1.005 Test Acc: 0.599
Validation loss decreased (-0.592095 --> -0.598674).  Saving model ...
Epoch: 13 cost time: 2.15342378616333
Epoch: 13, Steps: 10 | Train Loss: 0.839 Vali Loss: 0.937 Vali Acc: 0.605 Test Loss: 0.937 Test Acc: 0.605
Validation loss decreased (-0.598674 --> -0.605254).  Saving model ...
Epoch: 14 cost time: 2.2904608249664307
Epoch: 14, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.864 Vali Acc: 0.658 Test Loss: 0.864 Test Acc: 0.658
Validation loss decreased (-0.605254 --> -0.657886).  Saving model ...
Epoch: 15 cost time: 2.093886613845825
Epoch: 15, Steps: 10 | Train Loss: 0.734 Vali Loss: 0.814 Vali Acc: 0.678 Test Loss: 0.814 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677623).  Saving model ...
Epoch: 16 cost time: 1.9546840190887451
Epoch: 16, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.823 Vali Acc: 0.671 Test Loss: 0.823 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2323524951934814
Epoch: 17, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.789 Vali Acc: 0.678 Test Loss: 0.789 Test Acc: 0.678
Validation loss decreased (-0.677623 --> -0.677624).  Saving model ...
Epoch: 18 cost time: 2.2527716159820557
Epoch: 18, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.695 Vali Acc: 0.717 Test Loss: 0.695 Test Acc: 0.717
Validation loss decreased (-0.677624 --> -0.717098).  Saving model ...
Epoch: 19 cost time: 2.159632682800293
Epoch: 19, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.645 Vali Acc: 0.711 Test Loss: 0.645 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.227623224258423
Epoch: 20, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.629 Vali Acc: 0.711 Test Loss: 0.629 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.7741527557373047
Epoch: 21, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.611 Vali Acc: 0.717 Test Loss: 0.611 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717099).  Saving model ...
Epoch: 22 cost time: 2.2872259616851807
Epoch: 22, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.634 Vali Acc: 0.704 Test Loss: 0.634 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.2709853649139404
Epoch: 23, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
Validation loss decreased (-0.717099 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 2.216296434402466
Epoch: 24, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.555 Vali Acc: 0.743 Test Loss: 0.555 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.004349708557129
Epoch: 25, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.546 Vali Acc: 0.763 Test Loss: 0.546 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 1.9691171646118164
Epoch: 26, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.525 Vali Acc: 0.750 Test Loss: 0.525 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.206251859664917
Epoch: 27, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.515 Vali Acc: 0.770 Test Loss: 0.515 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769732).  Saving model ...
Epoch: 28 cost time: 2.195044994354248
Epoch: 28, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.523 Vali Acc: 0.770 Test Loss: 0.523 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0374343395233154
Epoch: 29, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7867355346679688
Epoch: 30, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.9229059219360352
Epoch: 31, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 32 cost time: 1.9515800476074219
Epoch: 32, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.503 Vali Acc: 0.789 Test Loss: 0.503 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 33 cost time: 2.1246304512023926
Epoch: 33, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.503 Vali Acc: 0.763 Test Loss: 0.503 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.45839524269104
Epoch: 34, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.504 Vali Acc: 0.750 Test Loss: 0.504 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.1213841438293457
Epoch: 35, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.009310722351074
Epoch: 36, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.4147369861602783
Epoch: 37, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.3417818546295166
Epoch: 38, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.104386568069458
Epoch: 39, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.1580071449279785
Epoch: 40, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809205).  Saving model ...
Epoch: 41 cost time: 2.5221621990203857
Epoch: 41, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 42 cost time: 2.036635637283325
Epoch: 42, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.239779233932495
Epoch: 43, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.8772432804107666
Epoch: 44, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.529 Vali Acc: 0.809 Test Loss: 0.529 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.4592504501342773
Epoch: 45, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.580 Vali Acc: 0.829 Test Loss: 0.580 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828942).  Saving model ...
Epoch: 46 cost time: 2.506563663482666
Epoch: 46, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.569 Vali Acc: 0.796 Test Loss: 0.569 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 2.2062671184539795
Epoch: 47, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 2.018178939819336
Epoch: 48, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 2.4162492752075195
Epoch: 49, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.257749080657959
Epoch: 50, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 2.433831214904785
Epoch: 51, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.566 Vali Acc: 0.816 Test Loss: 0.566 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.038167953491211
Epoch: 52, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.596 Vali Acc: 0.803 Test Loss: 0.596 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 2.1486575603485107
Epoch: 53, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.601 Vali Acc: 0.816 Test Loss: 0.601 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 2.0666677951812744
Epoch: 54, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.637 Vali Acc: 0.783 Test Loss: 0.637 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.8832342624664307
Epoch: 55, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.588 Vali Acc: 0.796 Test Loss: 0.588 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 235424
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.44725775718689
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.411 Vali Acc: 0.283 Test Loss: 1.411 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.9501562118530273
Epoch: 2, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1171343326568604
Epoch: 3, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.382 Vali Acc: 0.276 Test Loss: 1.382 Test Acc: 0.276
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.3797738552093506
Epoch: 4, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.362 Vali Acc: 0.289 Test Loss: 1.362 Test Acc: 0.289
Validation loss decreased (-0.282881 --> -0.289460).  Saving model ...
Epoch: 5 cost time: 2.1427505016326904
Epoch: 5, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.332 Vali Acc: 0.336 Test Loss: 1.332 Test Acc: 0.336
Validation loss decreased (-0.289460 --> -0.335513).  Saving model ...
Epoch: 6 cost time: 2.0361106395721436
Epoch: 6, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.304 Vali Acc: 0.329 Test Loss: 1.304 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4888088703155518
Epoch: 7, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.265 Vali Acc: 0.447 Test Loss: 1.265 Test Acc: 0.447
Validation loss decreased (-0.335513 --> -0.447356).  Saving model ...
Epoch: 8 cost time: 2.337191104888916
Epoch: 8, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.217 Vali Acc: 0.513 Test Loss: 1.217 Test Acc: 0.513
Validation loss decreased (-0.447356 --> -0.513146).  Saving model ...
Epoch: 9 cost time: 2.0545825958251953
Epoch: 9, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.140 Vali Acc: 0.572 Test Loss: 1.140 Test Acc: 0.572
Validation loss decreased (-0.513146 --> -0.572357).  Saving model ...
Epoch: 10 cost time: 1.7701244354248047
Epoch: 10, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.090 Vali Acc: 0.539 Test Loss: 1.090 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2639482021331787
Epoch: 11, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.036 Vali Acc: 0.605 Test Loss: 1.036 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605253).  Saving model ...
Epoch: 12 cost time: 2.145597457885742
Epoch: 12, Steps: 10 | Train Loss: 0.963 Vali Loss: 0.983 Vali Acc: 0.632 Test Loss: 0.983 Test Acc: 0.632
Validation loss decreased (-0.605253 --> -0.631569).  Saving model ...
Epoch: 13 cost time: 2.093946933746338
Epoch: 13, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.925 Vali Acc: 0.651 Test Loss: 0.925 Test Acc: 0.651
Validation loss decreased (-0.631569 --> -0.651307).  Saving model ...
Epoch: 14 cost time: 2.2369437217712402
Epoch: 14, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.867 Vali Acc: 0.691 Test Loss: 0.867 Test Acc: 0.691
Validation loss decreased (-0.651307 --> -0.690781).  Saving model ...
Epoch: 15 cost time: 2.0568125247955322
Epoch: 15, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.835 Vali Acc: 0.664 Test Loss: 0.835 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1755802631378174
Epoch: 16, Steps: 10 | Train Loss: 0.683 Vali Loss: 0.788 Vali Acc: 0.691 Test Loss: 0.788 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690782).  Saving model ...
Epoch: 17 cost time: 2.0751028060913086
Epoch: 17, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.751 Vali Acc: 0.678 Test Loss: 0.751 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.911869764328003
Epoch: 18, Steps: 10 | Train Loss: 0.604 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 19 cost time: 1.8988313674926758
Epoch: 19, Steps: 10 | Train Loss: 0.546 Vali Loss: 0.679 Vali Acc: 0.724 Test Loss: 0.679 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 20 cost time: 2.194511651992798
Epoch: 20, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.673 Vali Acc: 0.737 Test Loss: 0.673 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 21 cost time: 2.3381729125976562
Epoch: 21, Steps: 10 | Train Loss: 0.445 Vali Loss: 0.647 Vali Acc: 0.730 Test Loss: 0.647 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9882800579071045
Epoch: 22, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.629 Vali Acc: 0.730 Test Loss: 0.629 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.115462064743042
Epoch: 23, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.619 Vali Acc: 0.737 Test Loss: 0.619 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 24 cost time: 1.995208740234375
Epoch: 24, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 25 cost time: 2.651034355163574
Epoch: 25, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 2.36930251121521
Epoch: 26, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1583549976348877
Epoch: 27, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.580 Vali Acc: 0.750 Test Loss: 0.580 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.8378467559814453
Epoch: 28, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.288311719894409
Epoch: 29, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.2261292934417725
Epoch: 30, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.580 Vali Acc: 0.750 Test Loss: 0.580 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.320014715194702
Epoch: 31, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 32 cost time: 2.315289258956909
Epoch: 32, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.537 Vali Acc: 0.757 Test Loss: 0.537 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9789848327636719
Epoch: 33, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.569 Vali Acc: 0.757 Test Loss: 0.569 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.9566349983215332
Epoch: 34, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.0284547805786133
Epoch: 35, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.200420618057251
Epoch: 36, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.3469319343566895
Epoch: 37, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.1192328929901123
Epoch: 38, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.358577013015747
Epoch: 39, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.097045421600342
Epoch: 40, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.601 Vali Acc: 0.770 Test Loss: 0.601 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.8224472999572754
Epoch: 41, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.607 Vali Acc: 0.770 Test Loss: 0.607 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 235200
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.389289140701294
Epoch: 1, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.432 Vali Acc: 0.309 Test Loss: 1.432 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 2.614704132080078
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.383 Vali Acc: 0.316 Test Loss: 1.383 Test Acc: 0.316
Validation loss decreased (-0.309196 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 2.7046196460723877
Epoch: 3, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.357 Vali Acc: 0.375 Test Loss: 1.357 Test Acc: 0.375
Validation loss decreased (-0.315776 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 2.3541347980499268
Epoch: 4, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.335 Vali Acc: 0.447 Test Loss: 1.335 Test Acc: 0.447
Validation loss decreased (-0.374986 --> -0.447355).  Saving model ...
Epoch: 5 cost time: 2.454911231994629
Epoch: 5, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.306 Vali Acc: 0.434 Test Loss: 1.306 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3977625370025635
Epoch: 6, Steps: 10 | Train Loss: 1.240 Vali Loss: 1.275 Vali Acc: 0.382 Test Loss: 1.275 Test Acc: 0.382
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1368911266326904
Epoch: 7, Steps: 10 | Train Loss: 1.212 Vali Loss: 1.220 Vali Acc: 0.513 Test Loss: 1.220 Test Acc: 0.513
Validation loss decreased (-0.447355 --> -0.513146).  Saving model ...
Epoch: 8 cost time: 2.2446694374084473
Epoch: 8, Steps: 10 | Train Loss: 1.159 Vali Loss: 1.170 Vali Acc: 0.559 Test Loss: 1.170 Test Acc: 0.559
Validation loss decreased (-0.513146 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 2.393718719482422
Epoch: 9, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.118 Vali Acc: 0.553 Test Loss: 1.118 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2385787963867188
Epoch: 10, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.065 Vali Acc: 0.618 Test Loss: 1.065 Test Acc: 0.618
Validation loss decreased (-0.559199 --> -0.618410).  Saving model ...
Epoch: 11 cost time: 1.7208263874053955
Epoch: 11, Steps: 10 | Train Loss: 0.936 Vali Loss: 0.998 Vali Acc: 0.618 Test Loss: 0.998 Test Acc: 0.618
Validation loss decreased (-0.618410 --> -0.618411).  Saving model ...
Epoch: 12 cost time: 1.8328850269317627
Epoch: 12, Steps: 10 | Train Loss: 0.876 Vali Loss: 0.940 Vali Acc: 0.625 Test Loss: 0.940 Test Acc: 0.625
Validation loss decreased (-0.618411 --> -0.624991).  Saving model ...
Epoch: 13 cost time: 1.9633986949920654
Epoch: 13, Steps: 10 | Train Loss: 0.805 Vali Loss: 0.886 Vali Acc: 0.632 Test Loss: 0.886 Test Acc: 0.632
Validation loss decreased (-0.624991 --> -0.631570).  Saving model ...
Epoch: 14 cost time: 2.676583766937256
Epoch: 14, Steps: 10 | Train Loss: 0.686 Vali Loss: 0.840 Vali Acc: 0.658 Test Loss: 0.840 Test Acc: 0.658
Validation loss decreased (-0.631570 --> -0.657886).  Saving model ...
Epoch: 15 cost time: 1.8559448719024658
Epoch: 15, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.788 Vali Acc: 0.671 Test Loss: 0.788 Test Acc: 0.671
Validation loss decreased (-0.657886 --> -0.671045).  Saving model ...
Epoch: 16 cost time: 1.7866368293762207
Epoch: 16, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.743 Vali Acc: 0.724 Test Loss: 0.743 Test Acc: 0.724
Validation loss decreased (-0.671045 --> -0.723677).  Saving model ...
Epoch: 17 cost time: 1.8018524646759033
Epoch: 17, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.718 Vali Acc: 0.724 Test Loss: 0.718 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 1.8421292304992676
Epoch: 18, Steps: 10 | Train Loss: 0.492 Vali Loss: 0.661 Vali Acc: 0.730 Test Loss: 0.661 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730257).  Saving model ...
Epoch: 19 cost time: 1.794165849685669
Epoch: 19, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.638 Vali Acc: 0.770 Test Loss: 0.638 Test Acc: 0.770
Validation loss decreased (-0.730257 --> -0.769730).  Saving model ...
Epoch: 20 cost time: 2.1996121406555176
Epoch: 20, Steps: 10 | Train Loss: 0.426 Vali Loss: 0.623 Vali Acc: 0.743 Test Loss: 0.623 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2607779502868652
Epoch: 21, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.935884952545166
Epoch: 22, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.588 Vali Acc: 0.763 Test Loss: 0.588 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.371171236038208
Epoch: 23, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.601 Vali Acc: 0.757 Test Loss: 0.601 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9423978328704834
Epoch: 24, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.551 Vali Acc: 0.757 Test Loss: 0.551 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.1703639030456543
Epoch: 25, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 2.132871627807617
Epoch: 26, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.545 Vali Acc: 0.750 Test Loss: 0.545 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.2610983848571777
Epoch: 27, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.533 Vali Acc: 0.743 Test Loss: 0.533 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.104579448699951
Epoch: 28, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 29 cost time: 1.8757739067077637
Epoch: 29, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.509 Vali Acc: 0.776 Test Loss: 0.509 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 30 cost time: 2.249729633331299
Epoch: 30, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.561 Vali Acc: 0.763 Test Loss: 0.561 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.926462173461914
Epoch: 31, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.593 Vali Acc: 0.763 Test Loss: 0.593 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.082857847213745
Epoch: 32, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.532 Vali Acc: 0.770 Test Loss: 0.532 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.3291025161743164
Epoch: 33, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.120251417160034
Epoch: 34, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.550 Vali Acc: 0.770 Test Loss: 0.550 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.2114267349243164
Epoch: 35, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8580543994903564
Epoch: 36, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789468).  Saving model ...
Epoch: 37 cost time: 2.183953285217285
Epoch: 37, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.629 Vali Acc: 0.770 Test Loss: 0.629 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.325369119644165
Epoch: 38, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.699364423751831
Epoch: 39, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.552910327911377
Epoch: 40, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.324676036834717
Epoch: 41, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.565 Vali Acc: 0.776 Test Loss: 0.565 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 2.0424208641052246
Epoch: 42, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.613 Vali Acc: 0.789 Test Loss: 0.613 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 2.3725876808166504
Epoch: 43, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.702 Vali Acc: 0.757 Test Loss: 0.702 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 2.5690622329711914
Epoch: 44, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809204).  Saving model ...
Epoch: 45 cost time: 2.2706587314605713
Epoch: 45, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.050194501876831
Epoch: 46, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.604 Vali Acc: 0.776 Test Loss: 0.604 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 2.08693790435791
Epoch: 47, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.673 Vali Acc: 0.770 Test Loss: 0.673 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 2.0341033935546875
Epoch: 48, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.658 Vali Acc: 0.770 Test Loss: 0.658 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.9056973457336426
Epoch: 49, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.692 Vali Acc: 0.763 Test Loss: 0.692 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.2554125785827637
Epoch: 50, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.762 Vali Acc: 0.750 Test Loss: 0.762 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.8133668899536133
Epoch: 51, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.713 Vali Acc: 0.763 Test Loss: 0.713 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.1126439571380615
Epoch: 52, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.735 Vali Acc: 0.770 Test Loss: 0.735 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 2.2987351417541504
Epoch: 53, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.763 Vali Acc: 0.743 Test Loss: 0.763 Test Acc: 0.743
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.3085484504699707
Epoch: 54, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.747 Vali Acc: 0.776 Test Loss: 0.747 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 234976
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.854632377624512
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.481 Vali Acc: 0.283 Test Loss: 1.481 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 2.38215970993042
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.402 Vali Acc: 0.250 Test Loss: 1.402 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9194040298461914
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.371 Vali Acc: 0.263 Test Loss: 1.371 Test Acc: 0.263
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.086338758468628
Epoch: 4, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.341 Vali Acc: 0.316 Test Loss: 1.341 Test Acc: 0.316
Validation loss decreased (-0.282880 --> -0.315776).  Saving model ...
Epoch: 5 cost time: 1.8328697681427002
Epoch: 5, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.318 Vali Acc: 0.342 Test Loss: 1.318 Test Acc: 0.342
Validation loss decreased (-0.315776 --> -0.342092).  Saving model ...
Epoch: 6 cost time: 1.7775638103485107
Epoch: 6, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.291 Vali Acc: 0.375 Test Loss: 1.291 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.794909954071045
Epoch: 7, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.243 Vali Acc: 0.434 Test Loss: 1.243 Test Acc: 0.434
Validation loss decreased (-0.374987 --> -0.434198).  Saving model ...
Epoch: 8 cost time: 1.9270904064178467
Epoch: 8, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.202 Vali Acc: 0.434 Test Loss: 1.202 Test Acc: 0.434
Validation loss decreased (-0.434198 --> -0.434199).  Saving model ...
Epoch: 9 cost time: 2.271034002304077
Epoch: 9, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.162 Vali Acc: 0.487 Test Loss: 1.162 Test Acc: 0.487
Validation loss decreased (-0.434199 --> -0.486830).  Saving model ...
Epoch: 10 cost time: 1.794691562652588
Epoch: 10, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.121 Vali Acc: 0.507 Test Loss: 1.121 Test Acc: 0.507
Validation loss decreased (-0.486830 --> -0.506568).  Saving model ...
Epoch: 11 cost time: 1.7788455486297607
Epoch: 11, Steps: 10 | Train Loss: 0.974 Vali Loss: 1.070 Vali Acc: 0.539 Test Loss: 1.070 Test Acc: 0.539
Validation loss decreased (-0.506568 --> -0.539463).  Saving model ...
Epoch: 12 cost time: 1.9898958206176758
Epoch: 12, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.009 Vali Acc: 0.559 Test Loss: 1.009 Test Acc: 0.559
Validation loss decreased (-0.539463 --> -0.559200).  Saving model ...
Epoch: 13 cost time: 2.110764980316162
Epoch: 13, Steps: 10 | Train Loss: 0.802 Vali Loss: 0.952 Vali Acc: 0.612 Test Loss: 0.952 Test Acc: 0.612
Validation loss decreased (-0.559200 --> -0.611833).  Saving model ...
Epoch: 14 cost time: 2.0225353240966797
Epoch: 14, Steps: 10 | Train Loss: 0.753 Vali Loss: 0.903 Vali Acc: 0.599 Test Loss: 0.903 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.017596483230591
Epoch: 15, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.856 Vali Acc: 0.632 Test Loss: 0.856 Test Acc: 0.632
Validation loss decreased (-0.611833 --> -0.631570).  Saving model ...
Epoch: 16 cost time: 1.8428523540496826
Epoch: 16, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.821 Vali Acc: 0.645 Test Loss: 0.821 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644729).  Saving model ...
Epoch: 17 cost time: 2.0360286235809326
Epoch: 17, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.776 Vali Acc: 0.671 Test Loss: 0.776 Test Acc: 0.671
Validation loss decreased (-0.644729 --> -0.671045).  Saving model ...
Epoch: 18 cost time: 2.2589540481567383
Epoch: 18, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.761 Vali Acc: 0.697 Test Loss: 0.761 Test Acc: 0.697
Validation loss decreased (-0.671045 --> -0.697361).  Saving model ...
Epoch: 19 cost time: 2.035292863845825
Epoch: 19, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.696 Vali Acc: 0.691 Test Loss: 0.696 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7178747653961182
Epoch: 20, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.673 Vali Acc: 0.704 Test Loss: 0.673 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703941).  Saving model ...
Epoch: 21 cost time: 2.0407118797302246
Epoch: 21, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.664 Vali Acc: 0.717 Test Loss: 0.664 Test Acc: 0.717
Validation loss decreased (-0.703941 --> -0.717099).  Saving model ...
Epoch: 22 cost time: 1.8893632888793945
Epoch: 22, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.614 Vali Acc: 0.743 Test Loss: 0.614 Test Acc: 0.743
Validation loss decreased (-0.717099 --> -0.743415).  Saving model ...
Epoch: 23 cost time: 2.123340368270874
Epoch: 23, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.623 Vali Acc: 0.730 Test Loss: 0.623 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9797186851501465
Epoch: 24, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.607 Vali Acc: 0.743 Test Loss: 0.607 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 25 cost time: 2.146670341491699
Epoch: 25, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.594 Vali Acc: 0.730 Test Loss: 0.594 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9729690551757812
Epoch: 26, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.588 Vali Acc: 0.750 Test Loss: 0.588 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 27 cost time: 2.1073057651519775
Epoch: 27, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.616 Vali Acc: 0.757 Test Loss: 0.616 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 28 cost time: 1.8344240188598633
Epoch: 28, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.541 Vali Acc: 0.776 Test Loss: 0.541 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 29 cost time: 1.7873146533966064
Epoch: 29, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 30 cost time: 1.9400765895843506
Epoch: 30, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.533 Vali Acc: 0.757 Test Loss: 0.533 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8290722370147705
Epoch: 31, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.0794484615325928
Epoch: 32, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 33 cost time: 2.1595823764801025
Epoch: 33, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.539 Vali Acc: 0.783 Test Loss: 0.539 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.1020498275756836
Epoch: 34, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 35 cost time: 2.090604782104492
Epoch: 35, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.985375165939331
Epoch: 36, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7960169315338135
Epoch: 37, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.8553977012634277
Epoch: 38, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.607 Vali Acc: 0.783 Test Loss: 0.607 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.510127305984497
Epoch: 39, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.0187127590179443
Epoch: 40, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.620 Vali Acc: 0.809 Test Loss: 0.620 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809204).  Saving model ...
Epoch: 41 cost time: 2.5928382873535156
Epoch: 41, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.939826250076294
Epoch: 42, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.156052350997925
Epoch: 43, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 2.0228207111358643
Epoch: 44, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 2.2111001014709473
Epoch: 45, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.616 Vali Acc: 0.789 Test Loss: 0.616 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.9682276248931885
Epoch: 46, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809205).  Saving model ...
Epoch: 47 cost time: 2.000164270401001
Epoch: 47, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.685 Vali Acc: 0.796 Test Loss: 0.685 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.808215618133545
Epoch: 48, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.5823400020599365
Epoch: 49, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.8756005764007568
Epoch: 50, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.742 Vali Acc: 0.757 Test Loss: 0.742 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.8794934749603271
Epoch: 51, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.672 Vali Acc: 0.809 Test Loss: 0.672 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 2.10121488571167
Epoch: 52, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.618 Vali Acc: 0.796 Test Loss: 0.618 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.964195966720581
Epoch: 53, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.658 Vali Acc: 0.789 Test Loss: 0.658 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.008633613586426
Epoch: 54, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.661 Vali Acc: 0.809 Test Loss: 0.661 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.8895421028137207
Epoch: 55, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.675 Vali Acc: 0.803 Test Loss: 0.675 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 2.065908670425415
Epoch: 56, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.687 Vali Acc: 0.796 Test Loss: 0.687 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 234752
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.943882465362549
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.606 Vali Acc: 0.283 Test Loss: 1.606 Test Acc: 0.283
Validation loss decreased (inf --> -0.282879).  Saving model ...
Epoch: 2 cost time: 1.7949652671813965
Epoch: 2, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.420 Vali Acc: 0.322 Test Loss: 1.420 Test Acc: 0.322
Validation loss decreased (-0.282879 --> -0.322354).  Saving model ...
Epoch: 3 cost time: 1.6232469081878662
Epoch: 3, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.115 Vali Acc: 0.566 Test Loss: 1.115 Test Acc: 0.566
Validation loss decreased (-0.322354 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 1.875739336013794
Epoch: 4, Steps: 10 | Train Loss: 0.832 Vali Loss: 0.773 Vali Acc: 0.678 Test Loss: 0.773 Test Acc: 0.678
Validation loss decreased (-0.565778 --> -0.677624).  Saving model ...
Epoch: 5 cost time: 1.7656376361846924
Epoch: 5, Steps: 10 | Train Loss: 0.496 Vali Loss: 0.624 Vali Acc: 0.763 Test Loss: 0.624 Test Acc: 0.763
Validation loss decreased (-0.677624 --> -0.763152).  Saving model ...
Epoch: 6 cost time: 2.061574697494507
Epoch: 6, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.5702719688415527
Epoch: 7, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6800129413604736
Epoch: 8, Steps: 10 | Train Loss: 0.151 Vali Loss: 1.050 Vali Acc: 0.724 Test Loss: 1.050 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9696319103240967
Epoch: 9, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.530 Vali Acc: 0.809 Test Loss: 0.530 Test Acc: 0.809
Validation loss decreased (-0.769731 --> -0.809205).  Saving model ...
Epoch: 10 cost time: 1.6484532356262207
Epoch: 10, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.715 Vali Acc: 0.743 Test Loss: 0.715 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.974184274673462
Epoch: 11, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.708 Vali Acc: 0.783 Test Loss: 0.708 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7738618850708008
Epoch: 12, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4027981758117676
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.716 Vali Acc: 0.803 Test Loss: 0.716 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6367335319519043
Epoch: 14, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.682 Vali Acc: 0.789 Test Loss: 0.682 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7545177936553955
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7002003192901611
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.774 Vali Acc: 0.796 Test Loss: 0.774 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9029157161712646
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.745 Vali Acc: 0.803 Test Loss: 0.745 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6912510395050049
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.770 Vali Acc: 0.803 Test Loss: 0.770 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.7381744384765625
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.793 Vali Acc: 0.796 Test Loss: 0.793 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 11102260
model size : 47.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.1368796825408936
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.394 Vali Acc: 0.263 Test Loss: 1.394 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.9254252910614014
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.121 Vali Acc: 0.612 Test Loss: 1.121 Test Acc: 0.612
Validation loss decreased (-0.263144 --> -0.611831).  Saving model ...
Epoch: 3 cost time: 1.6388888359069824
Epoch: 3, Steps: 10 | Train Loss: 1.019 Vali Loss: 0.904 Vali Acc: 0.618 Test Loss: 0.904 Test Acc: 0.618
Validation loss decreased (-0.611831 --> -0.618412).  Saving model ...
Epoch: 4 cost time: 1.6641299724578857
Epoch: 4, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.985 Vali Acc: 0.572 Test Loss: 0.985 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8683817386627197
Epoch: 5, Steps: 10 | Train Loss: 0.665 Vali Loss: 0.680 Vali Acc: 0.724 Test Loss: 0.680 Test Acc: 0.724
Validation loss decreased (-0.618412 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.5104663372039795
Epoch: 6, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.769 Vali Acc: 0.730 Test Loss: 0.769 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730255).  Saving model ...
Epoch: 7 cost time: 1.472409725189209
Epoch: 7, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.758 Vali Acc: 0.730 Test Loss: 0.758 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.452221393585205
Epoch: 8, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.560 Vali Acc: 0.776 Test Loss: 0.560 Test Acc: 0.776
Validation loss decreased (-0.730256 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.9877581596374512
Epoch: 9, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8743443489074707
Epoch: 10, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.4755234718322754
Epoch: 11, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.737 Vali Acc: 0.763 Test Loss: 0.737 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.590094804763794
Epoch: 12, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.598 Vali Acc: 0.796 Test Loss: 0.598 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8383512496948242
Epoch: 13, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.677 Vali Acc: 0.776 Test Loss: 0.677 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5541777610778809
Epoch: 14, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.860 Vali Acc: 0.796 Test Loss: 0.860 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5073940753936768
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.738 Vali Acc: 0.789 Test Loss: 0.738 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.449683666229248
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.769 Vali Acc: 0.803 Test Loss: 0.769 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 17 cost time: 1.7227180004119873
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.718 Vali Acc: 0.803 Test Loss: 0.718 Test Acc: 0.803
Validation loss decreased (-0.802624 --> -0.802624).  Saving model ...
Epoch: 18 cost time: 1.7696120738983154
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.795 Vali Acc: 0.783 Test Loss: 0.795 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8375287055969238
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.851 Vali Acc: 0.783 Test Loss: 0.851 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.081805944442749
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.880 Vali Acc: 0.803 Test Loss: 0.880 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2616655826568604
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.899 Vali Acc: 0.796 Test Loss: 0.899 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.80055832862854
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.907 Vali Acc: 0.789 Test Loss: 0.907 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1209070682525635
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.914 Vali Acc: 0.796 Test Loss: 0.914 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.948162317276001
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.796 Test Loss: 0.926 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6736156940460205
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.938 Vali Acc: 0.789 Test Loss: 0.938 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9491205215454102
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.943 Vali Acc: 0.783 Test Loss: 0.943 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7259886264801025
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.955 Vali Acc: 0.789 Test Loss: 0.955 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 11100724
model size : 47.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.524177551269531
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.397 Vali Acc: 0.224 Test Loss: 1.397 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.8078510761260986
Epoch: 2, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.254 Vali Acc: 0.421 Test Loss: 1.254 Test Acc: 0.421
Validation loss decreased (-0.223670 --> -0.421040).  Saving model ...
Epoch: 3 cost time: 1.5925180912017822
Epoch: 3, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.029 Vali Acc: 0.572 Test Loss: 1.029 Test Acc: 0.572
Validation loss decreased (-0.421040 --> -0.572358).  Saving model ...
Epoch: 4 cost time: 1.5717949867248535
Epoch: 4, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.811 Vali Acc: 0.658 Test Loss: 0.811 Test Acc: 0.658
Validation loss decreased (-0.572358 --> -0.657887).  Saving model ...
Epoch: 5 cost time: 1.8596711158752441
Epoch: 5, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.641 Vali Acc: 0.724 Test Loss: 0.641 Test Acc: 0.724
Validation loss decreased (-0.657887 --> -0.723678).  Saving model ...
Epoch: 6 cost time: 1.6936702728271484
Epoch: 6, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.696 Vali Acc: 0.717 Test Loss: 0.696 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4581549167633057
Epoch: 7, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
Validation loss decreased (-0.723678 --> -0.769731).  Saving model ...
Epoch: 8 cost time: 1.5925073623657227
Epoch: 8, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.737 Vali Acc: 0.724 Test Loss: 0.737 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6959679126739502
Epoch: 9, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.764 Vali Acc: 0.763 Test Loss: 0.764 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1268486976623535
Epoch: 10, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.599 Vali Acc: 0.776 Test Loss: 0.599 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.5463805198669434
Epoch: 11, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.655 Vali Acc: 0.783 Test Loss: 0.655 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 12 cost time: 1.6999680995941162
Epoch: 12, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6871116161346436
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.743 Vali Acc: 0.796 Test Loss: 0.743 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796045).  Saving model ...
Epoch: 14 cost time: 1.611668348312378
Epoch: 14, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.810 Vali Acc: 0.803 Test Loss: 0.810 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802623).  Saving model ...
Epoch: 15 cost time: 1.681704044342041
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.842 Vali Acc: 0.789 Test Loss: 0.842 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5922777652740479
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.913 Vali Acc: 0.789 Test Loss: 0.913 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5035219192504883
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.774 Vali Acc: 0.803 Test Loss: 0.774 Test Acc: 0.803
Validation loss decreased (-0.802623 --> -0.802624).  Saving model ...
Epoch: 18 cost time: 1.5135524272918701
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.797 Vali Acc: 0.789 Test Loss: 0.797 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4955193996429443
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.817 Vali Acc: 0.803 Test Loss: 0.817 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.723304271697998
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.811 Vali Acc: 0.796 Test Loss: 0.811 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3733747005462646
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.816 Vali Acc: 0.809 Test Loss: 0.816 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809202).  Saving model ...
Epoch: 22 cost time: 1.779090166091919
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.822 Test Loss: 0.858 Test Acc: 0.822
Validation loss decreased (-0.809202 --> -0.822360).  Saving model ...
Epoch: 23 cost time: 1.7227990627288818
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.853 Vali Acc: 0.816 Test Loss: 0.853 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8177406787872314
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.871 Vali Acc: 0.796 Test Loss: 0.871 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6380181312561035
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.887 Vali Acc: 0.783 Test Loss: 0.887 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.663822889328003
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.903 Vali Acc: 0.803 Test Loss: 0.903 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7641656398773193
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.906 Vali Acc: 0.796 Test Loss: 0.906 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7123515605926514
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.789 Test Loss: 0.910 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8342177867889404
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.789 Test Loss: 0.916 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8681354522705078
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.923 Vali Acc: 0.809 Test Loss: 0.923 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4702110290527344
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.928 Vali Acc: 0.803 Test Loss: 0.928 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8527371883392334
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 0.932 Vali Acc: 0.796 Test Loss: 0.932 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 11099188
model size : 47.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.205414056777954
Epoch: 1, Steps: 10 | Train Loss: 1.545 Vali Loss: 1.440 Vali Acc: 0.230 Test Loss: 1.440 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.6482133865356445
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.353 Vali Acc: 0.257 Test Loss: 1.353 Test Acc: 0.257
Validation loss decreased (-0.230249 --> -0.256565).  Saving model ...
Epoch: 3 cost time: 1.8835349082946777
Epoch: 3, Steps: 10 | Train Loss: 1.206 Vali Loss: 1.035 Vali Acc: 0.513 Test Loss: 1.035 Test Acc: 0.513
Validation loss decreased (-0.256565 --> -0.513148).  Saving model ...
Epoch: 4 cost time: 1.7904324531555176
Epoch: 4, Steps: 10 | Train Loss: 0.848 Vali Loss: 0.805 Vali Acc: 0.671 Test Loss: 0.805 Test Acc: 0.671
Validation loss decreased (-0.513148 --> -0.671045).  Saving model ...
Epoch: 5 cost time: 1.4616429805755615
Epoch: 5, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.606 Vali Acc: 0.776 Test Loss: 0.606 Test Acc: 0.776
Validation loss decreased (-0.671045 --> -0.776310).  Saving model ...
Epoch: 6 cost time: 1.5608699321746826
Epoch: 6, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7058050632476807
Epoch: 7, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.550 Vali Acc: 0.770 Test Loss: 0.550 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7701709270477295
Epoch: 8, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.5017871856689453
Epoch: 9, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 10 cost time: 1.6473534107208252
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7286369800567627
Epoch: 11, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.646 Vali Acc: 0.776 Test Loss: 0.646 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4001944065093994
Epoch: 12, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.714 Vali Acc: 0.796 Test Loss: 0.714 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796045).  Saving model ...
Epoch: 13 cost time: 1.367906093597412
Epoch: 13, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.752 Vali Acc: 0.789 Test Loss: 0.752 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8499057292938232
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.806 Vali Acc: 0.783 Test Loss: 0.806 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6816022396087646
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.907 Vali Acc: 0.809 Test Loss: 0.907 Test Acc: 0.809
Validation loss decreased (-0.796045 --> -0.809201).  Saving model ...
Epoch: 16 cost time: 1.794325828552246
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.872 Vali Acc: 0.776 Test Loss: 0.872 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4710137844085693
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.922 Vali Acc: 0.789 Test Loss: 0.922 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.8136494159698486
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.919 Vali Acc: 0.789 Test Loss: 0.919 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5637061595916748
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.040 Vali Acc: 0.803 Test Loss: 1.040 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.620410680770874
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.039 Vali Acc: 0.789 Test Loss: 1.039 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7122972011566162
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.044 Vali Acc: 0.796 Test Loss: 1.044 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.137664556503296
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.285 Vali Acc: 0.803 Test Loss: 1.285 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.760180950164795
Epoch: 23, Steps: 10 | Train Loss: 0.112 Vali Loss: 1.075 Vali Acc: 0.757 Test Loss: 1.075 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6809158325195312
Epoch: 24, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.799 Vali Acc: 0.770 Test Loss: 0.799 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6752581596374512
Epoch: 25, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.757 Vali Acc: 0.796 Test Loss: 0.757 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 11097652
model size : 47.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.174323558807373
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.398 Vali Acc: 0.289 Test Loss: 1.398 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.9044582843780518
Epoch: 2, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.150 Vali Acc: 0.526 Test Loss: 1.150 Test Acc: 0.526
Validation loss decreased (-0.289460 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 1.5225772857666016
Epoch: 3, Steps: 10 | Train Loss: 1.037 Vali Loss: 1.049 Vali Acc: 0.579 Test Loss: 1.049 Test Acc: 0.579
Validation loss decreased (-0.526304 --> -0.578937).  Saving model ...
Epoch: 4 cost time: 1.4136900901794434
Epoch: 4, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.763 Vali Acc: 0.711 Test Loss: 0.763 Test Acc: 0.711
Validation loss decreased (-0.578937 --> -0.710519).  Saving model ...
Epoch: 5 cost time: 1.7455766201019287
Epoch: 5, Steps: 10 | Train Loss: 0.564 Vali Loss: 0.620 Vali Acc: 0.711 Test Loss: 0.620 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710520).  Saving model ...
Epoch: 6 cost time: 1.6252427101135254
Epoch: 6, Steps: 10 | Train Loss: 0.378 Vali Loss: 0.639 Vali Acc: 0.730 Test Loss: 0.639 Test Acc: 0.730
Validation loss decreased (-0.710520 --> -0.730257).  Saving model ...
Epoch: 7 cost time: 1.962590217590332
Epoch: 7, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.777 Vali Acc: 0.678 Test Loss: 0.777 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.843247413635254
Epoch: 8, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.569 Vali Acc: 0.796 Test Loss: 0.569 Test Acc: 0.796
Validation loss decreased (-0.730257 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.6527214050292969
Epoch: 9, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.697770595550537
Epoch: 10, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8348746299743652
Epoch: 11, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.617 Vali Acc: 0.803 Test Loss: 0.617 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 12 cost time: 1.3313047885894775
Epoch: 12, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.691 Vali Acc: 0.776 Test Loss: 0.691 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5757863521575928
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.862 Vali Acc: 0.796 Test Loss: 0.862 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5413599014282227
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.820 Vali Acc: 0.789 Test Loss: 0.820 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.83384108543396
Epoch: 15, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.832 Vali Acc: 0.803 Test Loss: 0.832 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.7606136798858643
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.914 Vali Acc: 0.809 Test Loss: 0.914 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809201).  Saving model ...
Epoch: 17 cost time: 1.8198108673095703
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.926 Vali Acc: 0.816 Test Loss: 0.926 Test Acc: 0.816
Validation loss decreased (-0.809201 --> -0.815780).  Saving model ...
Epoch: 18 cost time: 1.7104957103729248
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.953 Vali Acc: 0.809 Test Loss: 0.953 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9664146900177002
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.995 Vali Acc: 0.809 Test Loss: 0.995 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6111783981323242
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.031 Vali Acc: 0.789 Test Loss: 1.031 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3845758438110352
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.042 Vali Acc: 0.809 Test Loss: 1.042 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5173184871673584
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.057 Vali Acc: 0.809 Test Loss: 1.057 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9148001670837402
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.073 Vali Acc: 0.803 Test Loss: 1.073 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.5431013107299805
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.093 Vali Acc: 0.796 Test Loss: 1.093 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.6112024784088135
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.102 Vali Acc: 0.809 Test Loss: 1.102 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4166674613952637
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.117 Vali Acc: 0.809 Test Loss: 1.117 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.5558369159698486
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.130 Vali Acc: 0.809 Test Loss: 1.130 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 9263668
model size : 40.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.163851022720337
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.536 Vali Acc: 0.263 Test Loss: 1.536 Test Acc: 0.263
Validation loss decreased (inf --> -0.263143).  Saving model ...
Epoch: 2 cost time: 2.2211949825286865
Epoch: 2, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.315 Vali Acc: 0.368 Test Loss: 1.315 Test Acc: 0.368
Validation loss decreased (-0.263143 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 2.0841288566589355
Epoch: 3, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.121 Vali Acc: 0.500 Test Loss: 1.121 Test Acc: 0.500
Validation loss decreased (-0.368408 --> -0.499989).  Saving model ...
Epoch: 4 cost time: 2.3888700008392334
Epoch: 4, Steps: 10 | Train Loss: 0.851 Vali Loss: 0.826 Vali Acc: 0.671 Test Loss: 0.826 Test Acc: 0.671
Validation loss decreased (-0.499989 --> -0.671044).  Saving model ...
Epoch: 5 cost time: 2.0501909255981445
Epoch: 5, Steps: 10 | Train Loss: 0.648 Vali Loss: 0.730 Vali Acc: 0.704 Test Loss: 0.730 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703940).  Saving model ...
Epoch: 6 cost time: 1.795980453491211
Epoch: 6, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.738 Vali Acc: 0.743 Test Loss: 0.738 Test Acc: 0.743
Validation loss decreased (-0.703940 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 1.7115881443023682
Epoch: 7, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
Validation loss decreased (-0.743414 --> -0.782888).  Saving model ...
Epoch: 8 cost time: 1.9258005619049072
Epoch: 8, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 9 cost time: 1.612870693206787
Epoch: 9, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.404557943344116
Epoch: 10, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.864 Vali Acc: 0.704 Test Loss: 0.864 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9354546070098877
Epoch: 11, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.642 Vali Acc: 0.776 Test Loss: 0.642 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7875640392303467
Epoch: 12, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.647 Vali Acc: 0.763 Test Loss: 0.647 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7047677040100098
Epoch: 13, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.697 Vali Acc: 0.770 Test Loss: 0.697 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.7756619453430176
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.813 Vali Acc: 0.783 Test Loss: 0.813 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6714704036712646
Epoch: 15, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.880 Vali Acc: 0.770 Test Loss: 0.880 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0486221313476562
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.915 Vali Acc: 0.763 Test Loss: 0.915 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.714397668838501
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.909 Vali Acc: 0.796 Test Loss: 0.909 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796044).  Saving model ...
Epoch: 18 cost time: 1.6309270858764648
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.931 Vali Acc: 0.796 Test Loss: 0.931 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8325896263122559
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.963 Vali Acc: 0.796 Test Loss: 0.963 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0082058906555176
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.983 Vali Acc: 0.783 Test Loss: 0.983 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7022168636322021
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.011 Vali Acc: 0.783 Test Loss: 1.011 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0154693126678467
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.012 Vali Acc: 0.796 Test Loss: 1.012 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7983689308166504
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.020 Vali Acc: 0.796 Test Loss: 1.020 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.2892608642578125
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.789 Test Loss: 1.027 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8511419296264648
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.082 Vali Acc: 0.783 Test Loss: 1.082 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.3458178043365479
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.109 Vali Acc: 0.776 Test Loss: 1.109 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.955765724182129
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.121 Vali Acc: 0.783 Test Loss: 1.121 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 9262132
model size : 40.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.617074728012085
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.369 Vali Acc: 0.263 Test Loss: 1.369 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.75118088722229
Epoch: 2, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.211 Vali Acc: 0.539 Test Loss: 1.211 Test Acc: 0.539
Validation loss decreased (-0.263144 --> -0.539462).  Saving model ...
Epoch: 3 cost time: 1.6570611000061035
Epoch: 3, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.193 Vali Acc: 0.368 Test Loss: 1.193 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6790087223052979
Epoch: 4, Steps: 10 | Train Loss: 0.914 Vali Loss: 0.841 Vali Acc: 0.671 Test Loss: 0.841 Test Acc: 0.671
Validation loss decreased (-0.539462 --> -0.671044).  Saving model ...
Epoch: 5 cost time: 1.9305040836334229
Epoch: 5, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.714 Vali Acc: 0.697 Test Loss: 0.714 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697361).  Saving model ...
Epoch: 6 cost time: 1.5001986026763916
Epoch: 6, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.668 Vali Acc: 0.743 Test Loss: 0.668 Test Acc: 0.743
Validation loss decreased (-0.697361 --> -0.743414).  Saving model ...
Epoch: 7 cost time: 2.464850425720215
Epoch: 7, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.575 Vali Acc: 0.757 Test Loss: 0.575 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.7790813446044922
Epoch: 8, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.598 Vali Acc: 0.757 Test Loss: 0.598 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.2068405151367188
Epoch: 9, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0654850006103516
Epoch: 10, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.675 Vali Acc: 0.757 Test Loss: 0.675 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9430439472198486
Epoch: 11, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.759 Vali Acc: 0.783 Test Loss: 0.759 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782887).  Saving model ...
Epoch: 12 cost time: 1.867030382156372
Epoch: 12, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.943 Vali Acc: 0.776 Test Loss: 0.943 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2327661514282227
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.823 Vali Acc: 0.776 Test Loss: 0.823 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7864463329315186
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.828 Vali Acc: 0.776 Test Loss: 0.828 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.666121482849121
Epoch: 15, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.902 Vali Acc: 0.757 Test Loss: 0.902 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9646780490875244
Epoch: 16, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.883 Vali Acc: 0.757 Test Loss: 0.883 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9289438724517822
Epoch: 17, Steps: 10 | Train Loss: 0.072 Vali Loss: 1.421 Vali Acc: 0.691 Test Loss: 1.421 Test Acc: 0.691
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0384814739227295
Epoch: 18, Steps: 10 | Train Loss: 0.122 Vali Loss: 1.241 Vali Acc: 0.704 Test Loss: 1.241 Test Acc: 0.704
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9515299797058105
Epoch: 19, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.918 Vali Acc: 0.770 Test Loss: 0.918 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.5097615718841553
Epoch: 20, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.714 Vali Acc: 0.770 Test Loss: 0.714 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.4202096462249756
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.889 Vali Acc: 0.789 Test Loss: 0.889 Test Acc: 0.789
Validation loss decreased (-0.782887 --> -0.789465).  Saving model ...
Epoch: 22 cost time: 2.167555332183838
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 1.142 Vali Acc: 0.757 Test Loss: 1.142 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.804520606994629
Epoch: 23, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.243 Vali Acc: 0.743 Test Loss: 1.243 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9792346954345703
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.227 Vali Acc: 0.750 Test Loss: 1.227 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9733977317810059
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 1.087 Vali Acc: 0.776 Test Loss: 1.087 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7506060600280762
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.092 Vali Acc: 0.809 Test Loss: 1.092 Test Acc: 0.809
Validation loss decreased (-0.789465 --> -0.809200).  Saving model ...
Epoch: 27 cost time: 1.4423673152923584
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.062 Vali Acc: 0.803 Test Loss: 1.062 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7159841060638428
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.117 Vali Acc: 0.816 Test Loss: 1.117 Test Acc: 0.816
Validation loss decreased (-0.809200 --> -0.815778).  Saving model ...
Epoch: 29 cost time: 1.6385154724121094
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.068 Vali Acc: 0.809 Test Loss: 1.068 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.028553009033203
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.364 Vali Acc: 0.803 Test Loss: 1.364 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.115835189819336
Epoch: 31, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.091 Vali Acc: 0.776 Test Loss: 1.091 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.215768814086914
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.214 Vali Acc: 0.796 Test Loss: 1.214 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.737278938293457
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.122 Vali Acc: 0.809 Test Loss: 1.122 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.9023218154907227
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.124 Vali Acc: 0.803 Test Loss: 1.124 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8694109916687012
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.154 Vali Acc: 0.816 Test Loss: 1.154 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.144256591796875
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.176 Vali Acc: 0.809 Test Loss: 1.176 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.3082590103149414
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.809 Test Loss: 1.188 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 2.306220531463623
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.188 Vali Acc: 0.803 Test Loss: 1.188 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 9260596
model size : 40.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.262566566467285
Epoch: 1, Steps: 10 | Train Loss: 1.557 Vali Loss: 1.419 Vali Acc: 0.388 Test Loss: 1.419 Test Acc: 0.388
Validation loss decreased (inf --> -0.388144).  Saving model ...
Epoch: 2 cost time: 1.819493055343628
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.341 Vali Acc: 0.322 Test Loss: 1.341 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5119483470916748
Epoch: 3, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.015 Vali Acc: 0.651 Test Loss: 1.015 Test Acc: 0.651
Validation loss decreased (-0.388144 --> -0.651306).  Saving model ...
Epoch: 4 cost time: 1.8172404766082764
Epoch: 4, Steps: 10 | Train Loss: 0.787 Vali Loss: 0.827 Vali Acc: 0.651 Test Loss: 0.827 Test Acc: 0.651
Validation loss decreased (-0.651306 --> -0.651308).  Saving model ...
Epoch: 5 cost time: 1.3938953876495361
Epoch: 5, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.714 Vali Acc: 0.724 Test Loss: 0.714 Test Acc: 0.724
Validation loss decreased (-0.651308 --> -0.723677).  Saving model ...
Epoch: 6 cost time: 1.3725430965423584
Epoch: 6, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.710 Vali Acc: 0.704 Test Loss: 0.710 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.840463638305664
Epoch: 7, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.878 Vali Acc: 0.664 Test Loss: 0.878 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4228591918945312
Epoch: 8, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.617 Vali Acc: 0.757 Test Loss: 0.617 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 1.7741320133209229
Epoch: 9, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.743 Vali Acc: 0.783 Test Loss: 0.743 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782887).  Saving model ...
Epoch: 10 cost time: 1.7314510345458984
Epoch: 10, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
Validation loss decreased (-0.782887 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.4712166786193848
Epoch: 11, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.611 Vali Acc: 0.776 Test Loss: 0.611 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9718358516693115
Epoch: 12, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.678144931793213
Epoch: 13, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.823 Vali Acc: 0.789 Test Loss: 0.823 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789465).  Saving model ...
Epoch: 14 cost time: 1.7230281829833984
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.815 Vali Acc: 0.783 Test Loss: 0.815 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1323299407958984
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.853 Vali Acc: 0.789 Test Loss: 0.853 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6289269924163818
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.808 Vali Acc: 0.776 Test Loss: 0.808 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9143469333648682
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.055 Vali Acc: 0.789 Test Loss: 1.055 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3551106452941895
Epoch: 18, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.819 Vali Acc: 0.816 Test Loss: 0.819 Test Acc: 0.816
Validation loss decreased (-0.789465 --> -0.815781).  Saving model ...
Epoch: 19 cost time: 1.5767784118652344
Epoch: 19, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.998 Vali Acc: 0.803 Test Loss: 0.998 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6898233890533447
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.940 Vali Acc: 0.809 Test Loss: 0.940 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4744820594787598
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.917 Vali Acc: 0.783 Test Loss: 0.917 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.708867073059082
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.855 Vali Acc: 0.809 Test Loss: 0.855 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6693861484527588
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.869 Vali Acc: 0.796 Test Loss: 0.869 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.523376703262329
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.911 Vali Acc: 0.789 Test Loss: 0.911 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6458184719085693
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.942 Vali Acc: 0.809 Test Loss: 0.942 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5247223377227783
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.959 Vali Acc: 0.809 Test Loss: 0.959 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.575700044631958
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.978 Vali Acc: 0.796 Test Loss: 0.978 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.513434648513794
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.796 Test Loss: 0.996 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 9259060
model size : 40.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3355915546417236
Epoch: 1, Steps: 10 | Train Loss: 1.515 Vali Loss: 1.378 Vali Acc: 0.316 Test Loss: 1.378 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.5070526599884033
Epoch: 2, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.336 Vali Acc: 0.316 Test Loss: 1.336 Test Acc: 0.316
Validation loss decreased (-0.315776 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.7272086143493652
Epoch: 3, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.225 Vali Acc: 0.447 Test Loss: 1.225 Test Acc: 0.447
Validation loss decreased (-0.315776 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.6908268928527832
Epoch: 4, Steps: 10 | Train Loss: 1.045 Vali Loss: 0.956 Vali Acc: 0.612 Test Loss: 0.956 Test Acc: 0.612
Validation loss decreased (-0.447356 --> -0.611833).  Saving model ...
Epoch: 5 cost time: 1.4002554416656494
Epoch: 5, Steps: 10 | Train Loss: 0.662 Vali Loss: 0.768 Vali Acc: 0.664 Test Loss: 0.768 Test Acc: 0.664
Validation loss decreased (-0.611833 --> -0.664466).  Saving model ...
Epoch: 6 cost time: 1.4635400772094727
Epoch: 6, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
Validation loss decreased (-0.664466 --> -0.789468).  Saving model ...
Epoch: 7 cost time: 1.7438123226165771
Epoch: 7, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.711 Vali Acc: 0.750 Test Loss: 0.711 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6614718437194824
Epoch: 8, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.663 Vali Acc: 0.757 Test Loss: 0.663 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8388352394104004
Epoch: 9, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.5285651683807373
Epoch: 10, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.882479190826416
Epoch: 11, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 1.9925892353057861
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.757 Vali Acc: 0.803 Test Loss: 0.757 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 13 cost time: 1.565227746963501
Epoch: 13, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.666 Vali Acc: 0.809 Test Loss: 0.666 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809204).  Saving model ...
Epoch: 14 cost time: 1.724020004272461
Epoch: 14, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6703763008117676
Epoch: 15, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.704 Vali Acc: 0.783 Test Loss: 0.704 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9302978515625
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.834 Vali Acc: 0.796 Test Loss: 0.834 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5142102241516113
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.818 Vali Acc: 0.796 Test Loss: 0.818 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6475193500518799
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.923 Vali Acc: 0.783 Test Loss: 0.923 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6485626697540283
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.934 Vali Acc: 0.789 Test Loss: 0.934 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.950610876083374
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.105 Vali Acc: 0.789 Test Loss: 1.105 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5621707439422607
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.201 Vali Acc: 0.783 Test Loss: 1.201 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6915793418884277
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.881 Vali Acc: 0.796 Test Loss: 0.881 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.762481689453125
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.912 Vali Acc: 0.776 Test Loss: 0.912 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 8344372
model size : 36.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.453730821609497
Epoch: 1, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.373 Vali Acc: 0.316 Test Loss: 1.373 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.6454083919525146
Epoch: 2, Steps: 10 | Train Loss: 1.299 Vali Loss: 1.257 Vali Acc: 0.434 Test Loss: 1.257 Test Acc: 0.434
Validation loss decreased (-0.315776 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 1.6343908309936523
Epoch: 3, Steps: 10 | Train Loss: 1.008 Vali Loss: 1.058 Vali Acc: 0.513 Test Loss: 1.058 Test Acc: 0.513
Validation loss decreased (-0.434198 --> -0.513147).  Saving model ...
Epoch: 4 cost time: 1.6389844417572021
Epoch: 4, Steps: 10 | Train Loss: 0.811 Vali Loss: 0.841 Vali Acc: 0.625 Test Loss: 0.841 Test Acc: 0.625
Validation loss decreased (-0.513147 --> -0.624992).  Saving model ...
Epoch: 5 cost time: 1.6187708377838135
Epoch: 5, Steps: 10 | Train Loss: 0.597 Vali Loss: 0.661 Vali Acc: 0.730 Test Loss: 0.661 Test Acc: 0.730
Validation loss decreased (-0.624992 --> -0.730257).  Saving model ...
Epoch: 6 cost time: 1.5601081848144531
Epoch: 6, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.680 Vali Acc: 0.737 Test Loss: 0.680 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736835).  Saving model ...
Epoch: 7 cost time: 1.5564384460449219
Epoch: 7, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.650 Vali Acc: 0.770 Test Loss: 0.650 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 1.3892109394073486
Epoch: 8, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5524744987487793
Epoch: 9, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7574009895324707
Epoch: 10, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.586 Vali Acc: 0.776 Test Loss: 0.586 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.434540033340454
Epoch: 11, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4533569812774658
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.630 Vali Acc: 0.776 Test Loss: 0.630 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7156422138214111
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.809 Vali Acc: 0.796 Test Loss: 0.809 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796045).  Saving model ...
Epoch: 14 cost time: 1.637740135192871
Epoch: 14, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.770 Vali Acc: 0.770 Test Loss: 0.770 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6734750270843506
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.827 Vali Acc: 0.776 Test Loss: 0.827 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6266062259674072
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.897 Vali Acc: 0.783 Test Loss: 0.897 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6761493682861328
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.855 Vali Acc: 0.789 Test Loss: 0.855 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4699060916900635
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.809 Vali Acc: 0.796 Test Loss: 0.809 Test Acc: 0.796
Validation loss decreased (-0.796045 --> -0.796045).  Saving model ...
Epoch: 19 cost time: 1.6191189289093018
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.966 Vali Acc: 0.783 Test Loss: 0.966 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6357707977294922
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.162 Vali Acc: 0.789 Test Loss: 1.162 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0437562465667725
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 1.321 Vali Acc: 0.770 Test Loss: 1.321 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8011715412139893
Epoch: 22, Steps: 10 | Train Loss: 0.149 Vali Loss: 1.258 Vali Acc: 0.750 Test Loss: 1.258 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5751838684082031
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.932 Vali Acc: 0.763 Test Loss: 0.932 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5534098148345947
Epoch: 24, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.791 Vali Acc: 0.796 Test Loss: 0.791 Test Acc: 0.796
Validation loss decreased (-0.796045 --> -0.796045).  Saving model ...
Epoch: 25 cost time: 1.7539701461791992
Epoch: 25, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.918 Vali Acc: 0.763 Test Loss: 0.918 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.1571898460388184
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.831 Vali Acc: 0.776 Test Loss: 0.831 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5156922340393066
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.850 Vali Acc: 0.796 Test Loss: 0.850 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7797601222991943
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.854 Vali Acc: 0.796 Test Loss: 0.854 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.0629348754882812
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.915 Vali Acc: 0.803 Test Loss: 0.915 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802622).  Saving model ...
Epoch: 30 cost time: 2.0885307788848877
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.803 Test Loss: 0.957 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8510587215423584
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.981 Vali Acc: 0.816 Test Loss: 0.981 Test Acc: 0.816
Validation loss decreased (-0.802622 --> -0.815780).  Saving model ...
Epoch: 32 cost time: 1.8882787227630615
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.011 Vali Acc: 0.809 Test Loss: 1.011 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.7672419548034668
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.032 Vali Acc: 0.803 Test Loss: 1.032 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6718969345092773
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.045 Vali Acc: 0.803 Test Loss: 1.045 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5676453113555908
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.055 Vali Acc: 0.803 Test Loss: 1.055 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4542510509490967
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.065 Vali Acc: 0.809 Test Loss: 1.065 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7276601791381836
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.816 Test Loss: 1.071 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.7632670402526855
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.087 Vali Acc: 0.803 Test Loss: 1.087 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.6407995223999023
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.098 Vali Acc: 0.803 Test Loss: 1.098 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.8417811393737793
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.102 Vali Acc: 0.809 Test Loss: 1.102 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.8976211547851562
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.809 Test Loss: 1.108 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 8342836
model size : 36.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.993751049041748
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.474 Vali Acc: 0.316 Test Loss: 1.474 Test Acc: 0.316
Validation loss decreased (inf --> -0.315775).  Saving model ...
Epoch: 2 cost time: 2.1113626956939697
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.255 Vali Acc: 0.388 Test Loss: 1.255 Test Acc: 0.388
Validation loss decreased (-0.315775 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.673112154006958
Epoch: 3, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.174 Vali Acc: 0.441 Test Loss: 1.174 Test Acc: 0.441
Validation loss decreased (-0.388145 --> -0.440778).  Saving model ...
Epoch: 4 cost time: 1.6642019748687744
Epoch: 4, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.110 Vali Acc: 0.461 Test Loss: 1.110 Test Acc: 0.461
Validation loss decreased (-0.440778 --> -0.460515).  Saving model ...
Epoch: 5 cost time: 1.757981300354004
Epoch: 5, Steps: 10 | Train Loss: 0.753 Vali Loss: 0.769 Vali Acc: 0.691 Test Loss: 0.769 Test Acc: 0.691
Validation loss decreased (-0.460515 --> -0.690782).  Saving model ...
Epoch: 6 cost time: 1.618661642074585
Epoch: 6, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.805 Vali Acc: 0.678 Test Loss: 0.805 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8589301109313965
Epoch: 7, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.764 Vali Acc: 0.684 Test Loss: 0.764 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7943456172943115
Epoch: 8, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.636 Vali Acc: 0.763 Test Loss: 0.636 Test Acc: 0.763
Validation loss decreased (-0.690782 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 2.108362913131714
Epoch: 9, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.612 Vali Acc: 0.776 Test Loss: 0.612 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 2.0298166275024414
Epoch: 10, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.715 Vali Acc: 0.770 Test Loss: 0.715 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7299745082855225
Epoch: 11, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.598 Vali Acc: 0.763 Test Loss: 0.598 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8298611640930176
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.688 Vali Acc: 0.770 Test Loss: 0.688 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7419939041137695
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.835 Vali Acc: 0.803 Test Loss: 0.835 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802623).  Saving model ...
Epoch: 14 cost time: 1.570979356765747
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.841 Vali Acc: 0.803 Test Loss: 0.841 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.047952651977539
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.806 Vali Acc: 0.789 Test Loss: 0.806 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2256805896759033
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.818 Vali Acc: 0.789 Test Loss: 0.818 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.352121353149414
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.896 Vali Acc: 0.776 Test Loss: 0.896 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8683693408966064
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.916 Vali Acc: 0.803 Test Loss: 0.916 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.201465606689453
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.926 Vali Acc: 0.783 Test Loss: 0.926 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.306871175765991
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.993 Vali Acc: 0.776 Test Loss: 0.993 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6532557010650635
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.006 Vali Acc: 0.776 Test Loss: 1.006 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.0683462619781494
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.010 Vali Acc: 0.776 Test Loss: 1.010 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.223107099533081
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.776 Test Loss: 1.027 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 8341300
model size : 36.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9524388313293457
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.364 Vali Acc: 0.296 Test Loss: 1.364 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.7216687202453613
Epoch: 2, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.219 Vali Acc: 0.401 Test Loss: 1.219 Test Acc: 0.401
Validation loss decreased (-0.296039 --> -0.401304).  Saving model ...
Epoch: 3 cost time: 1.4425320625305176
Epoch: 3, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.180 Vali Acc: 0.539 Test Loss: 1.180 Test Acc: 0.539
Validation loss decreased (-0.401304 --> -0.539462).  Saving model ...
Epoch: 4 cost time: 1.7812299728393555
Epoch: 4, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.849 Vali Acc: 0.651 Test Loss: 0.849 Test Acc: 0.651
Validation loss decreased (-0.539462 --> -0.651307).  Saving model ...
Epoch: 5 cost time: 1.7220027446746826
Epoch: 5, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.891 Vali Acc: 0.572 Test Loss: 0.891 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5527424812316895
Epoch: 6, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.649 Vali Acc: 0.704 Test Loss: 0.649 Test Acc: 0.704
Validation loss decreased (-0.651307 --> -0.703941).  Saving model ...
Epoch: 7 cost time: 1.5345501899719238
Epoch: 7, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.733 Vali Acc: 0.724 Test Loss: 0.733 Test Acc: 0.724
Validation loss decreased (-0.703941 --> -0.723677).  Saving model ...
Epoch: 8 cost time: 1.8300325870513916
Epoch: 8, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.658 Vali Acc: 0.770 Test Loss: 0.658 Test Acc: 0.770
Validation loss decreased (-0.723677 --> -0.769730).  Saving model ...
Epoch: 9 cost time: 1.4863767623901367
Epoch: 9, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
Validation loss decreased (-0.769730 --> -0.796047).  Saving model ...
Epoch: 10 cost time: 1.4135441780090332
Epoch: 10, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.632 Vali Acc: 0.743 Test Loss: 0.632 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4427478313446045
Epoch: 11, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5363399982452393
Epoch: 12, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 13 cost time: 1.905998706817627
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.766 Vali Acc: 0.770 Test Loss: 0.766 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.701742172241211
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.798 Vali Acc: 0.796 Test Loss: 0.798 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5278429985046387
Epoch: 15, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.762 Vali Acc: 0.783 Test Loss: 0.762 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5169172286987305
Epoch: 16, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.834 Vali Acc: 0.783 Test Loss: 0.834 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8035035133361816
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.026 Vali Acc: 0.796 Test Loss: 1.026 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6018669605255127
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.937 Vali Acc: 0.789 Test Loss: 0.937 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9186038970947266
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.971 Vali Acc: 0.789 Test Loss: 0.971 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6105647087097168
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.001 Vali Acc: 0.796 Test Loss: 1.001 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.5104827880859375
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.019 Vali Acc: 0.796 Test Loss: 1.019 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.572190284729004
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.783 Test Loss: 1.027 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 8339764
model size : 36.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.876867294311523
Epoch: 1, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.433 Vali Acc: 0.329 Test Loss: 1.433 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 1.5688872337341309
Epoch: 2, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.232 Vali Acc: 0.579 Test Loss: 1.232 Test Acc: 0.579
Validation loss decreased (-0.328933 --> -0.578935).  Saving model ...
Epoch: 3 cost time: 1.7931652069091797
Epoch: 3, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.084 Vali Acc: 0.487 Test Loss: 1.084 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4885778427124023
Epoch: 4, Steps: 10 | Train Loss: 0.801 Vali Loss: 0.795 Vali Acc: 0.678 Test Loss: 0.795 Test Acc: 0.678
Validation loss decreased (-0.578935 --> -0.677624).  Saving model ...
Epoch: 5 cost time: 2.27364182472229
Epoch: 5, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.683 Vali Acc: 0.704 Test Loss: 0.683 Test Acc: 0.704
Validation loss decreased (-0.677624 --> -0.703941).  Saving model ...
Epoch: 6 cost time: 1.4616436958312988
Epoch: 6, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.636 Vali Acc: 0.770 Test Loss: 0.636 Test Acc: 0.770
Validation loss decreased (-0.703941 --> -0.769730).  Saving model ...
Epoch: 7 cost time: 1.6284675598144531
Epoch: 7, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.960 Vali Acc: 0.671 Test Loss: 0.960 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7115390300750732
Epoch: 8, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.652 Vali Acc: 0.757 Test Loss: 0.652 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6502265930175781
Epoch: 9, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.561 Vali Acc: 0.770 Test Loss: 0.561 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.5623886585235596
Epoch: 10, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.8177645206451416
Epoch: 11, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.680 Vali Acc: 0.789 Test Loss: 0.680 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 1.8102655410766602
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8073890209197998
Epoch: 13, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.720 Vali Acc: 0.763 Test Loss: 0.720 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.767977237701416
Epoch: 14, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.766 Vali Acc: 0.763 Test Loss: 0.766 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9869723320007324
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.727 Vali Acc: 0.757 Test Loss: 0.727 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0405611991882324
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8412034511566162
Epoch: 17, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.820 Vali Acc: 0.789 Test Loss: 0.820 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7607307434082031
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.882 Vali Acc: 0.789 Test Loss: 0.882 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.813063383102417
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.899 Vali Acc: 0.789 Test Loss: 0.899 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0010247230529785
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.929 Vali Acc: 0.776 Test Loss: 0.929 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8320317268371582
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.927 Vali Acc: 0.770 Test Loss: 0.927 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 7884724
model size : 35.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.312539100646973
Epoch: 1, Steps: 10 | Train Loss: 1.625 Vali Loss: 1.567 Vali Acc: 0.276 Test Loss: 1.567 Test Acc: 0.276
Validation loss decreased (inf --> -0.276300).  Saving model ...
Epoch: 2 cost time: 2.003664016723633
Epoch: 2, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.312 Vali Acc: 0.342 Test Loss: 1.312 Test Acc: 0.342
Validation loss decreased (-0.276300 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.929093360900879
Epoch: 3, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.330 Vali Acc: 0.368 Test Loss: 1.330 Test Acc: 0.368
Validation loss decreased (-0.342092 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 2.184098243713379
Epoch: 4, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.041 Vali Acc: 0.553 Test Loss: 1.041 Test Acc: 0.553
Validation loss decreased (-0.368408 --> -0.552621).  Saving model ...
Epoch: 5 cost time: 1.6902241706848145
Epoch: 5, Steps: 10 | Train Loss: 0.777 Vali Loss: 0.833 Vali Acc: 0.645 Test Loss: 0.833 Test Acc: 0.645
Validation loss decreased (-0.552621 --> -0.644729).  Saving model ...
Epoch: 6 cost time: 1.5739917755126953
Epoch: 6, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.811 Vali Acc: 0.671 Test Loss: 0.811 Test Acc: 0.671
Validation loss decreased (-0.644729 --> -0.671045).  Saving model ...
Epoch: 7 cost time: 2.155724048614502
Epoch: 7, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.648 Vali Acc: 0.730 Test Loss: 0.648 Test Acc: 0.730
Validation loss decreased (-0.671045 --> -0.730257).  Saving model ...
Epoch: 8 cost time: 2.4866578578948975
Epoch: 8, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.737 Vali Acc: 0.737 Test Loss: 0.737 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 1.6038568019866943
Epoch: 9, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.591 Vali Acc: 0.770 Test Loss: 0.591 Test Acc: 0.770
Validation loss decreased (-0.736835 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 2.1221466064453125
Epoch: 10, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.643 Vali Acc: 0.757 Test Loss: 0.643 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8915245532989502
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.742 Vali Acc: 0.737 Test Loss: 0.742 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6165928840637207
Epoch: 12, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.635 Vali Acc: 0.770 Test Loss: 0.635 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8359804153442383
Epoch: 13, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.807 Vali Acc: 0.783 Test Loss: 0.807 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782887).  Saving model ...
Epoch: 14 cost time: 1.914168357849121
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
Validation loss decreased (-0.782887 --> -0.782887).  Saving model ...
Epoch: 15 cost time: 2.4394989013671875
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.803 Vali Acc: 0.803 Test Loss: 0.803 Test Acc: 0.803
Validation loss decreased (-0.782887 --> -0.802624).  Saving model ...
Epoch: 16 cost time: 1.9734928607940674
Epoch: 16, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.873 Vali Acc: 0.789 Test Loss: 0.873 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.4720842838287354
Epoch: 17, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.967 Vali Acc: 0.803 Test Loss: 0.967 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7948784828186035
Epoch: 18, Steps: 10 | Train Loss: 0.040 Vali Loss: 1.022 Vali Acc: 0.796 Test Loss: 1.022 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.884032964706421
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.132 Vali Acc: 0.783 Test Loss: 1.132 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7540721893310547
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.916 Vali Acc: 0.783 Test Loss: 0.916 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.00540828704834
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.910 Vali Acc: 0.776 Test Loss: 0.910 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8850409984588623
Epoch: 22, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.993 Vali Acc: 0.783 Test Loss: 0.993 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.367539882659912
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.048 Vali Acc: 0.803 Test Loss: 1.048 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.9011428356170654
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.085 Vali Acc: 0.803 Test Loss: 1.085 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.6740303039550781
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.120 Vali Acc: 0.783 Test Loss: 1.120 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 7883188
model size : 35.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.046824216842651
Epoch: 1, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.544 Vali Acc: 0.388 Test Loss: 1.544 Test Acc: 0.388
Validation loss decreased (inf --> -0.388142).  Saving model ...
Epoch: 2 cost time: 1.9515995979309082
Epoch: 2, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.243 Vali Acc: 0.434 Test Loss: 1.243 Test Acc: 0.434
Validation loss decreased (-0.388142 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 2.2794551849365234
Epoch: 3, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.220 Vali Acc: 0.546 Test Loss: 1.220 Test Acc: 0.546
Validation loss decreased (-0.434198 --> -0.546040).  Saving model ...
Epoch: 4 cost time: 1.5820684432983398
Epoch: 4, Steps: 10 | Train Loss: 0.915 Vali Loss: 0.920 Vali Acc: 0.638 Test Loss: 0.920 Test Acc: 0.638
Validation loss decreased (-0.546040 --> -0.638149).  Saving model ...
Epoch: 5 cost time: 1.633861780166626
Epoch: 5, Steps: 10 | Train Loss: 0.660 Vali Loss: 0.848 Vali Acc: 0.638 Test Loss: 0.848 Test Acc: 0.638
Validation loss decreased (-0.638149 --> -0.638149).  Saving model ...
Epoch: 6 cost time: 1.7395832538604736
Epoch: 6, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.719 Vali Acc: 0.658 Test Loss: 0.719 Test Acc: 0.658
Validation loss decreased (-0.638149 --> -0.657888).  Saving model ...
Epoch: 7 cost time: 1.727315902709961
Epoch: 7, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.813 Vali Acc: 0.678 Test Loss: 0.813 Test Acc: 0.678
Validation loss decreased (-0.657888 --> -0.677623).  Saving model ...
Epoch: 8 cost time: 1.710991382598877
Epoch: 8, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.610 Vali Acc: 0.757 Test Loss: 0.610 Test Acc: 0.757
Validation loss decreased (-0.677623 --> -0.756573).  Saving model ...
Epoch: 9 cost time: 1.879749059677124
Epoch: 9, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.546 Vali Acc: 0.763 Test Loss: 0.546 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.4441800117492676
Epoch: 10, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.781322717666626
Epoch: 11, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.687 Vali Acc: 0.763 Test Loss: 0.687 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.543236255645752
Epoch: 12, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.720 Vali Acc: 0.796 Test Loss: 0.720 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796045).  Saving model ...
Epoch: 13 cost time: 2.113823175430298
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.876 Vali Acc: 0.763 Test Loss: 0.876 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.972564697265625
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.780 Vali Acc: 0.783 Test Loss: 0.780 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.9561059474945068
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.036 Vali Acc: 0.697 Test Loss: 1.036 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.2191669940948486
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.902 Vali Acc: 0.783 Test Loss: 0.902 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8192458152770996
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.920 Vali Acc: 0.783 Test Loss: 0.920 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5332920551300049
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 1.043 Vali Acc: 0.803 Test Loss: 1.043 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802621).  Saving model ...
Epoch: 19 cost time: 1.781400203704834
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.129 Vali Acc: 0.803 Test Loss: 1.129 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.371408224105835
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.200 Vali Acc: 0.796 Test Loss: 1.200 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.0790882110595703
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.211 Vali Acc: 0.803 Test Loss: 1.211 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7056524753570557
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.242 Vali Acc: 0.809 Test Loss: 1.242 Test Acc: 0.809
Validation loss decreased (-0.802621 --> -0.809198).  Saving model ...
Epoch: 23 cost time: 1.9246571063995361
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.265 Vali Acc: 0.803 Test Loss: 1.265 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8156602382659912
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.264 Vali Acc: 0.809 Test Loss: 1.264 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.834810733795166
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.269 Vali Acc: 0.809 Test Loss: 1.269 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.157360553741455
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.279 Vali Acc: 0.803 Test Loss: 1.279 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.734074592590332
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.284 Vali Acc: 0.809 Test Loss: 1.284 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.1329402923583984
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.292 Vali Acc: 0.803 Test Loss: 1.292 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7366809844970703
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.809 Test Loss: 1.297 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.4001920223236084
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.301 Vali Acc: 0.803 Test Loss: 1.301 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.2577672004699707
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.304 Vali Acc: 0.803 Test Loss: 1.304 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.099320650100708
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.305 Vali Acc: 0.803 Test Loss: 1.305 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 7881652
model size : 35.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.339397668838501
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.426 Vali Acc: 0.283 Test Loss: 1.426 Test Acc: 0.283
Validation loss decreased (inf --> -0.282880).  Saving model ...
Epoch: 2 cost time: 2.211951494216919
Epoch: 2, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.225 Vali Acc: 0.447 Test Loss: 1.225 Test Acc: 0.447
Validation loss decreased (-0.282880 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 2.078491687774658
Epoch: 3, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.232 Vali Acc: 0.329 Test Loss: 1.232 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.312910556793213
Epoch: 4, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.176 Vali Acc: 0.461 Test Loss: 1.176 Test Acc: 0.461
Validation loss decreased (-0.447356 --> -0.460515).  Saving model ...
Epoch: 5 cost time: 2.3397884368896484
Epoch: 5, Steps: 10 | Train Loss: 0.770 Vali Loss: 0.724 Vali Acc: 0.717 Test Loss: 0.724 Test Acc: 0.717
Validation loss decreased (-0.460515 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 2.0929131507873535
Epoch: 6, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.664 Vali Acc: 0.730 Test Loss: 0.664 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 7 cost time: 2.09519624710083
Epoch: 7, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 2.2835261821746826
Epoch: 8, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.744 Vali Acc: 0.717 Test Loss: 0.744 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5150625705718994
Epoch: 9, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.655 Vali Acc: 0.789 Test Loss: 0.655 Test Acc: 0.789
Validation loss decreased (-0.736835 --> -0.789467).  Saving model ...
Epoch: 10 cost time: 2.248401403427124
Epoch: 10, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.838 Vali Acc: 0.743 Test Loss: 0.838 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8422338962554932
Epoch: 11, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.705 Vali Acc: 0.789 Test Loss: 0.705 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.949420690536499
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
Validation loss decreased (-0.789467 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 2.089160680770874
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.637 Vali Acc: 0.822 Test Loss: 0.637 Test Acc: 0.822
Validation loss decreased (-0.789468 --> -0.822362).  Saving model ...
Epoch: 14 cost time: 1.9393134117126465
Epoch: 14, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.715 Vali Acc: 0.783 Test Loss: 0.715 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3184854984283447
Epoch: 15, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.766 Vali Acc: 0.803 Test Loss: 0.766 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.237401247024536
Epoch: 16, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.960 Vali Acc: 0.757 Test Loss: 0.960 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4224774837493896
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.899 Vali Acc: 0.789 Test Loss: 0.899 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7987792491912842
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.914 Vali Acc: 0.796 Test Loss: 0.914 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9544501304626465
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.911 Vali Acc: 0.822 Test Loss: 0.911 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0462827682495117
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.955 Vali Acc: 0.822 Test Loss: 0.955 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.3435230255126953
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.930 Vali Acc: 0.796 Test Loss: 0.930 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2411246299743652
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.917 Vali Acc: 0.796 Test Loss: 0.917 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9137883186340332
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.939 Vali Acc: 0.796 Test Loss: 0.939 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 7880116
model size : 35.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.211693525314331
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.419 Vali Acc: 0.237 Test Loss: 1.419 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 2.4433398246765137
Epoch: 2, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.332 Vali Acc: 0.382 Test Loss: 1.332 Test Acc: 0.382
Validation loss decreased (-0.236828 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 2.7943522930145264
Epoch: 3, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.223 Vali Acc: 0.520 Test Loss: 1.223 Test Acc: 0.520
Validation loss decreased (-0.381566 --> -0.519725).  Saving model ...
Epoch: 4 cost time: 2.41310977935791
Epoch: 4, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.114 Vali Acc: 0.599 Test Loss: 1.114 Test Acc: 0.599
Validation loss decreased (-0.519725 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 2.106654405593872
Epoch: 5, Steps: 10 | Train Loss: 0.854 Vali Loss: 0.903 Vali Acc: 0.651 Test Loss: 0.903 Test Acc: 0.651
Validation loss decreased (-0.598673 --> -0.651307).  Saving model ...
Epoch: 6 cost time: 1.9961957931518555
Epoch: 6, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.854 Vali Acc: 0.651 Test Loss: 0.854 Test Acc: 0.651
Validation loss decreased (-0.651307 --> -0.651307).  Saving model ...
Epoch: 7 cost time: 3.208353281021118
Epoch: 7, Steps: 10 | Train Loss: 0.479 Vali Loss: 0.738 Vali Acc: 0.691 Test Loss: 0.738 Test Acc: 0.691
Validation loss decreased (-0.651307 --> -0.690782).  Saving model ...
Epoch: 8 cost time: 2.4430534839630127
Epoch: 8, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.911 Vali Acc: 0.651 Test Loss: 0.911 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3930931091308594
Epoch: 9, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.644 Vali Acc: 0.776 Test Loss: 0.644 Test Acc: 0.776
Validation loss decreased (-0.690782 --> -0.776309).  Saving model ...
Epoch: 10 cost time: 2.052485227584839
Epoch: 10, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.706 Vali Acc: 0.750 Test Loss: 0.706 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9519720077514648
Epoch: 11, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.590 Vali Acc: 0.737 Test Loss: 0.590 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1818923950195312
Epoch: 12, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.8741211891174316
Epoch: 13, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.691 Vali Acc: 0.776 Test Loss: 0.691 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.940239667892456
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 2.3299198150634766
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.647 Vali Acc: 0.763 Test Loss: 0.647 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8494110107421875
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1543595790863037
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.634 Vali Acc: 0.763 Test Loss: 0.634 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8168046474456787
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.707 Vali Acc: 0.763 Test Loss: 0.707 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7131564617156982
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.753 Vali Acc: 0.776 Test Loss: 0.753 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.1393775939941406
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.714 Vali Acc: 0.776 Test Loss: 0.714 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.036862850189209
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.719 Vali Acc: 0.776 Test Loss: 0.719 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0866589546203613
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.715 Vali Acc: 0.796 Test Loss: 0.715 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796045).  Saving model ...
Epoch: 23 cost time: 2.064596652984619
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.734 Vali Acc: 0.789 Test Loss: 0.734 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.549757480621338
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.754 Vali Acc: 0.796 Test Loss: 0.754 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.157919406890869
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.777 Vali Acc: 0.770 Test Loss: 0.777 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.0046191215515137
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.785 Vali Acc: 0.776 Test Loss: 0.785 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9722871780395508
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.811 Vali Acc: 0.789 Test Loss: 0.811 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.642815351486206
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.808 Vali Acc: 0.776 Test Loss: 0.808 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.905949354171753
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.817 Vali Acc: 0.789 Test Loss: 0.817 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.958759069442749
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.838 Vali Acc: 0.783 Test Loss: 0.838 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.1561412811279297
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.860 Vali Acc: 0.770 Test Loss: 0.860 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.4237661361694336
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.854 Vali Acc: 0.789 Test Loss: 0.854 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 3719732
model size : 16.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.278881311416626
Epoch: 1, Steps: 10 | Train Loss: 1.523 Vali Loss: 1.461 Vali Acc: 0.276 Test Loss: 1.461 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 1.3357839584350586
Epoch: 2, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.354 Vali Acc: 0.355 Test Loss: 1.354 Test Acc: 0.355
Validation loss decreased (-0.276301 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.641000509262085
Epoch: 3, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.200 Vali Acc: 0.474 Test Loss: 1.200 Test Acc: 0.474
Validation loss decreased (-0.355250 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 1.651451587677002
Epoch: 4, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.068 Vali Acc: 0.638 Test Loss: 1.068 Test Acc: 0.638
Validation loss decreased (-0.473672 --> -0.638147).  Saving model ...
Epoch: 5 cost time: 2.0649096965789795
Epoch: 5, Steps: 10 | Train Loss: 0.799 Vali Loss: 0.930 Vali Acc: 0.632 Test Loss: 0.930 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0031301975250244
Epoch: 6, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.734 Vali Acc: 0.678 Test Loss: 0.734 Test Acc: 0.678
Validation loss decreased (-0.638147 --> -0.677624).  Saving model ...
Epoch: 7 cost time: 1.531475305557251
Epoch: 7, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.741 Vali Acc: 0.691 Test Loss: 0.741 Test Acc: 0.691
Validation loss decreased (-0.677624 --> -0.690782).  Saving model ...
Epoch: 8 cost time: 1.763803482055664
Epoch: 8, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.775 Vali Acc: 0.684 Test Loss: 0.775 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8095989227294922
Epoch: 9, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.546 Vali Acc: 0.757 Test Loss: 0.546 Test Acc: 0.757
Validation loss decreased (-0.690782 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.7981352806091309
Epoch: 10, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.540 Vali Acc: 0.750 Test Loss: 0.540 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8015210628509521
Epoch: 11, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.672 Vali Acc: 0.750 Test Loss: 0.672 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9402351379394531
Epoch: 12, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.520 Vali Acc: 0.763 Test Loss: 0.520 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763153).  Saving model ...
Epoch: 13 cost time: 1.514369010925293
Epoch: 13, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
Validation loss decreased (-0.763153 --> -0.802626).  Saving model ...
Epoch: 14 cost time: 1.7422852516174316
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.597 Vali Acc: 0.757 Test Loss: 0.597 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7154440879821777
Epoch: 15, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.8786211013793945
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.577 Vali Acc: 0.796 Test Loss: 0.577 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7483935356140137
Epoch: 17, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.724 Vali Acc: 0.743 Test Loss: 0.724 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6303448677062988
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.635 Vali Acc: 0.776 Test Loss: 0.635 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.722236156463623
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.730 Vali Acc: 0.763 Test Loss: 0.730 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.693572759628296
Epoch: 20, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.631 Vali Acc: 0.809 Test Loss: 0.631 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4267075061798096
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.646 Vali Acc: 0.783 Test Loss: 0.646 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7352969646453857
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.681 Vali Acc: 0.783 Test Loss: 0.681 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.6021478176116943
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.701 Vali Acc: 0.796 Test Loss: 0.701 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8268513679504395
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.729 Vali Acc: 0.796 Test Loss: 0.729 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5294544696807861
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.777 Vali Acc: 0.809 Test Loss: 0.777 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 3718964
model size : 16.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.673645496368408
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.366 Vali Acc: 0.336 Test Loss: 1.366 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.848348617553711
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.260 Vali Acc: 0.388 Test Loss: 1.260 Test Acc: 0.388
Validation loss decreased (-0.335513 --> -0.388145).  Saving model ...
Epoch: 3 cost time: 1.841735601425171
Epoch: 3, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.142 Vali Acc: 0.546 Test Loss: 1.142 Test Acc: 0.546
Validation loss decreased (-0.388145 --> -0.546041).  Saving model ...
Epoch: 4 cost time: 2.1884191036224365
Epoch: 4, Steps: 10 | Train Loss: 0.989 Vali Loss: 0.995 Vali Acc: 0.618 Test Loss: 0.995 Test Acc: 0.618
Validation loss decreased (-0.546041 --> -0.618411).  Saving model ...
Epoch: 5 cost time: 2.1932213306427
Epoch: 5, Steps: 10 | Train Loss: 0.770 Vali Loss: 0.807 Vali Acc: 0.684 Test Loss: 0.807 Test Acc: 0.684
Validation loss decreased (-0.618411 --> -0.684202).  Saving model ...
Epoch: 6 cost time: 2.283534288406372
Epoch: 6, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.741 Vali Acc: 0.684 Test Loss: 0.741 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 1.771484375
Epoch: 7, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
Validation loss decreased (-0.684203 --> -0.756573).  Saving model ...
Epoch: 8 cost time: 1.7588281631469727
Epoch: 8, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.676 Vali Acc: 0.770 Test Loss: 0.676 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769730).  Saving model ...
Epoch: 9 cost time: 1.7122390270233154
Epoch: 9, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.579 Vali Acc: 0.770 Test Loss: 0.579 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.763730764389038
Epoch: 10, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.599 Vali Acc: 0.796 Test Loss: 0.599 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.9876794815063477
Epoch: 11, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.645 Vali Acc: 0.750 Test Loss: 0.645 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.338825225830078
Epoch: 12, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.590 Vali Acc: 0.770 Test Loss: 0.590 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.366413116455078
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.694 Vali Acc: 0.770 Test Loss: 0.694 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.990860939025879
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.717 Vali Acc: 0.776 Test Loss: 0.717 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.182922840118408
Epoch: 15, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.663 Vali Acc: 0.776 Test Loss: 0.663 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.041318416595459
Epoch: 16, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 17 cost time: 2.6642508506774902
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.733 Vali Acc: 0.763 Test Loss: 0.733 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8378517627716064
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.616 Vali Acc: 0.809 Test Loss: 0.616 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 19 cost time: 2.580739974975586
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.380603790283203
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9615483283996582
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.683 Vali Acc: 0.803 Test Loss: 0.683 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.770531177520752
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.719 Vali Acc: 0.816 Test Loss: 0.719 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815782).  Saving model ...
Epoch: 23 cost time: 1.4697489738464355
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.743 Vali Acc: 0.809 Test Loss: 0.743 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8578908443450928
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.773 Vali Acc: 0.803 Test Loss: 0.773 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.260775566101074
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.785 Vali Acc: 0.809 Test Loss: 0.785 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.8372673988342285
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.794 Vali Acc: 0.809 Test Loss: 0.794 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7928993701934814
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.816 Vali Acc: 0.803 Test Loss: 0.816 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.702260971069336
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.836 Vali Acc: 0.803 Test Loss: 0.836 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8564531803131104
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.843 Vali Acc: 0.816 Test Loss: 0.843 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.0692801475524902
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.859 Vali Acc: 0.809 Test Loss: 0.859 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9468073844909668
Epoch: 31, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.873 Vali Acc: 0.809 Test Loss: 0.873 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.0867342948913574
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.874 Vali Acc: 0.803 Test Loss: 0.874 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 3718196
model size : 16.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.0425519943237305
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.391 Vali Acc: 0.224 Test Loss: 1.391 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.4328131675720215
Epoch: 2, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.272 Vali Acc: 0.447 Test Loss: 1.272 Test Acc: 0.447
Validation loss decreased (-0.223670 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 1.558410406112671
Epoch: 3, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.129 Vali Acc: 0.605 Test Loss: 1.129 Test Acc: 0.605
Validation loss decreased (-0.447356 --> -0.605252).  Saving model ...
Epoch: 4 cost time: 1.7413651943206787
Epoch: 4, Steps: 10 | Train Loss: 0.957 Vali Loss: 0.964 Vali Acc: 0.586 Test Loss: 0.964 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9138920307159424
Epoch: 5, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.970 Vali Acc: 0.579 Test Loss: 0.970 Test Acc: 0.579
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6383106708526611
Epoch: 6, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.679 Vali Acc: 0.704 Test Loss: 0.679 Test Acc: 0.704
Validation loss decreased (-0.605252 --> -0.703941).  Saving model ...
Epoch: 7 cost time: 1.6139934062957764
Epoch: 7, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.632 Vali Acc: 0.717 Test Loss: 0.632 Test Acc: 0.717
Validation loss decreased (-0.703941 --> -0.717099).  Saving model ...
Epoch: 8 cost time: 1.574049711227417
Epoch: 8, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.686 Vali Acc: 0.743 Test Loss: 0.686 Test Acc: 0.743
Validation loss decreased (-0.717099 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 1.7790958881378174
Epoch: 9, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.500 Vali Acc: 0.763 Test Loss: 0.500 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763153).  Saving model ...
Epoch: 10 cost time: 1.6947412490844727
Epoch: 10, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.590 Vali Acc: 0.750 Test Loss: 0.590 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7475135326385498
Epoch: 11, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.525 Vali Acc: 0.763 Test Loss: 0.525 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.899308681488037
Epoch: 12, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
Validation loss decreased (-0.763153 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 1.6811189651489258
Epoch: 13, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.535571575164795
Epoch: 14, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4593055248260498
Epoch: 15, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.872 Vali Acc: 0.796 Test Loss: 0.872 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4874022006988525
Epoch: 16, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.676 Vali Acc: 0.789 Test Loss: 0.676 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6229724884033203
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.655 Vali Acc: 0.789 Test Loss: 0.655 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5610511302947998
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.667 Vali Acc: 0.796 Test Loss: 0.667 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5797348022460938
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.703 Vali Acc: 0.789 Test Loss: 0.703 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6202077865600586
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.737 Vali Acc: 0.796 Test Loss: 0.737 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8323407173156738
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.741 Vali Acc: 0.796 Test Loss: 0.741 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.8463904857635498
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.781 Vali Acc: 0.783 Test Loss: 0.781 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 3717428
model size : 16.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5418620109558105
Epoch: 1, Steps: 10 | Train Loss: 1.489 Vali Loss: 1.363 Vali Acc: 0.329 Test Loss: 1.363 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.5209252834320068
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.312 Vali Acc: 0.322 Test Loss: 1.312 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3549041748046875
Epoch: 3, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.190 Vali Acc: 0.493 Test Loss: 1.190 Test Acc: 0.493
Validation loss decreased (-0.328934 --> -0.493409).  Saving model ...
Epoch: 4 cost time: 1.2341337203979492
Epoch: 4, Steps: 10 | Train Loss: 1.087 Vali Loss: 1.053 Vali Acc: 0.559 Test Loss: 1.053 Test Acc: 0.559
Validation loss decreased (-0.493409 --> -0.559200).  Saving model ...
Epoch: 5 cost time: 1.529362440109253
Epoch: 5, Steps: 10 | Train Loss: 0.879 Vali Loss: 0.901 Vali Acc: 0.678 Test Loss: 0.901 Test Acc: 0.678
Validation loss decreased (-0.559200 --> -0.677623).  Saving model ...
Epoch: 6 cost time: 1.7084743976593018
Epoch: 6, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.788 Vali Acc: 0.684 Test Loss: 0.788 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684203).  Saving model ...
Epoch: 7 cost time: 1.6924526691436768
Epoch: 7, Steps: 10 | Train Loss: 0.534 Vali Loss: 0.668 Vali Acc: 0.750 Test Loss: 0.668 Test Acc: 0.750
Validation loss decreased (-0.684203 --> -0.749993).  Saving model ...
Epoch: 8 cost time: 1.6940979957580566
Epoch: 8, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.659 Vali Acc: 0.730 Test Loss: 0.659 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3962159156799316
Epoch: 9, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.3126134872436523
Epoch: 10, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.4401588439941406
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.328826904296875
Epoch: 12, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.528 Vali Acc: 0.763 Test Loss: 0.528 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3916196823120117
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.612 Vali Acc: 0.809 Test Loss: 0.612 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809204).  Saving model ...
Epoch: 14 cost time: 1.6288745403289795
Epoch: 14, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.582 Vali Acc: 0.776 Test Loss: 0.582 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9361026287078857
Epoch: 15, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.685 Vali Acc: 0.796 Test Loss: 0.685 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.324375867843628
Epoch: 16, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.602 Vali Acc: 0.803 Test Loss: 0.602 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5237486362457275
Epoch: 17, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.631 Vali Acc: 0.803 Test Loss: 0.631 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4369630813598633
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.602 Vali Acc: 0.770 Test Loss: 0.602 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.403731107711792
Epoch: 19, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3142602443695068
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.635 Vali Acc: 0.776 Test Loss: 0.635 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4180443286895752
Epoch: 21, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.776 Vali Acc: 0.783 Test Loss: 0.776 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.433722972869873
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.634 Vali Acc: 0.796 Test Loss: 0.634 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.385930061340332
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.696 Vali Acc: 0.809 Test Loss: 0.696 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2798644
model size : 13.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.177333354949951
Epoch: 1, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.411 Vali Acc: 0.270 Test Loss: 1.411 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.8339829444885254
Epoch: 2, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.305 Vali Acc: 0.408 Test Loss: 1.305 Test Acc: 0.408
Validation loss decreased (-0.269723 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 1.6633448600769043
Epoch: 3, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.300 Vali Acc: 0.414 Test Loss: 1.300 Test Acc: 0.414
Validation loss decreased (-0.407882 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 1.8186075687408447
Epoch: 4, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.149 Vali Acc: 0.447 Test Loss: 1.149 Test Acc: 0.447
Validation loss decreased (-0.414461 --> -0.447357).  Saving model ...
Epoch: 5 cost time: 1.6163837909698486
Epoch: 5, Steps: 10 | Train Loss: 0.996 Vali Loss: 0.969 Vali Acc: 0.651 Test Loss: 0.969 Test Acc: 0.651
Validation loss decreased (-0.447357 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 2.03521466255188
Epoch: 6, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.842 Vali Acc: 0.658 Test Loss: 0.842 Test Acc: 0.658
Validation loss decreased (-0.651306 --> -0.657886).  Saving model ...
Epoch: 7 cost time: 1.7044734954833984
Epoch: 7, Steps: 10 | Train Loss: 0.567 Vali Loss: 0.750 Vali Acc: 0.664 Test Loss: 0.750 Test Acc: 0.664
Validation loss decreased (-0.657886 --> -0.664466).  Saving model ...
Epoch: 8 cost time: 1.8498094081878662
Epoch: 8, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.619 Vali Acc: 0.743 Test Loss: 0.619 Test Acc: 0.743
Validation loss decreased (-0.664466 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.6614961624145508
Epoch: 9, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.634 Vali Acc: 0.750 Test Loss: 0.634 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.6637990474700928
Epoch: 10, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.563 Vali Acc: 0.763 Test Loss: 0.563 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.7946906089782715
Epoch: 11, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.572 Vali Acc: 0.757 Test Loss: 0.572 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5751023292541504
Epoch: 12, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.635 Vali Acc: 0.743 Test Loss: 0.635 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9633350372314453
Epoch: 13, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.492 Vali Acc: 0.796 Test Loss: 0.492 Test Acc: 0.796
Validation loss decreased (-0.763152 --> -0.796048).  Saving model ...
Epoch: 14 cost time: 1.8238856792449951
Epoch: 14, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0623605251312256
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.7825307846069336
Epoch: 16, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.579 Vali Acc: 0.796 Test Loss: 0.579 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9492061138153076
Epoch: 17, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.602 Vali Acc: 0.796 Test Loss: 0.602 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6477997303009033
Epoch: 18, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.645 Vali Acc: 0.796 Test Loss: 0.645 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3987805843353271
Epoch: 19, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.670 Vali Acc: 0.789 Test Loss: 0.670 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.037747383117676
Epoch: 20, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0904271602630615
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.645 Vali Acc: 0.770 Test Loss: 0.645 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5446405410766602
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.604 Vali Acc: 0.816 Test Loss: 0.604 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 23 cost time: 1.6794953346252441
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6333894729614258
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.62959623336792
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.682 Vali Acc: 0.796 Test Loss: 0.682 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5617849826812744
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.698 Vali Acc: 0.816 Test Loss: 0.698 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5782337188720703
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.739 Vali Acc: 0.816 Test Loss: 0.739 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8312022686004639
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.772 Vali Acc: 0.809 Test Loss: 0.772 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7681312561035156
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.756 Vali Acc: 0.822 Test Loss: 0.756 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822361).  Saving model ...
Epoch: 30 cost time: 1.604708194732666
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.765 Vali Acc: 0.816 Test Loss: 0.765 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8589773178100586
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.822 Test Loss: 0.794 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7876620292663574
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.809 Test Loss: 0.778 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.9195332527160645
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.783 Vali Acc: 0.809 Test Loss: 0.783 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.7235651016235352
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.804 Vali Acc: 0.809 Test Loss: 0.804 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.4149491786956787
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.807 Vali Acc: 0.816 Test Loss: 0.807 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.9060263633728027
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.814 Vali Acc: 0.816 Test Loss: 0.814 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.972527027130127
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.822 Test Loss: 0.818 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6197404861450195
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.833 Vali Acc: 0.816 Test Loss: 0.833 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.684520959854126
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.838 Vali Acc: 0.829 Test Loss: 0.838 Test Acc: 0.829
Validation loss decreased (-0.822361 --> -0.828939).  Saving model ...
Epoch: 40 cost time: 1.3843357563018799
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.865 Vali Acc: 0.816 Test Loss: 0.865 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4433379173278809
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.822 Test Loss: 0.857 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.4577851295471191
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.866 Vali Acc: 0.816 Test Loss: 0.866 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.5259244441986084
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.878 Vali Acc: 0.822 Test Loss: 0.878 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.7668769359588623
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.893 Vali Acc: 0.822 Test Loss: 0.893 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.6057071685791016
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.883 Vali Acc: 0.816 Test Loss: 0.883 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.7273507118225098
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.895 Vali Acc: 0.816 Test Loss: 0.895 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.6035091876983643
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.908 Vali Acc: 0.809 Test Loss: 0.908 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.635718584060669
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.910 Vali Acc: 0.803 Test Loss: 0.910 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.682563304901123
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.922 Vali Acc: 0.809 Test Loss: 0.922 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 2797876
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.336673974990845
Epoch: 1, Steps: 10 | Train Loss: 1.496 Vali Loss: 1.422 Vali Acc: 0.257 Test Loss: 1.422 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.4859180450439453
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.301 Vali Acc: 0.467 Test Loss: 1.301 Test Acc: 0.467
Validation loss decreased (-0.256565 --> -0.467092).  Saving model ...
Epoch: 3 cost time: 1.7775535583496094
Epoch: 3, Steps: 10 | Train Loss: 1.235 Vali Loss: 1.188 Vali Acc: 0.487 Test Loss: 1.188 Test Acc: 0.487
Validation loss decreased (-0.467092 --> -0.486830).  Saving model ...
Epoch: 4 cost time: 2.0230886936187744
Epoch: 4, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.079 Vali Acc: 0.526 Test Loss: 1.079 Test Acc: 0.526
Validation loss decreased (-0.486830 --> -0.526305).  Saving model ...
Epoch: 5 cost time: 2.083761215209961
Epoch: 5, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.161 Vali Acc: 0.500 Test Loss: 1.161 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.698554515838623
Epoch: 6, Steps: 10 | Train Loss: 0.798 Vali Loss: 0.959 Vali Acc: 0.599 Test Loss: 0.959 Test Acc: 0.599
Validation loss decreased (-0.526305 --> -0.598675).  Saving model ...
Epoch: 7 cost time: 2.2651569843292236
Epoch: 7, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.747 Vali Acc: 0.697 Test Loss: 0.747 Test Acc: 0.697
Validation loss decreased (-0.598675 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 1.2604050636291504
Epoch: 8, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.714 Vali Acc: 0.717 Test Loss: 0.714 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 1.8609910011291504
Epoch: 9, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
Validation loss decreased (-0.717098 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 1.8563768863677979
Epoch: 10, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.659 Vali Acc: 0.757 Test Loss: 0.659 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6988182067871094
Epoch: 11, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
Validation loss decreased (-0.769731 --> -0.802626).  Saving model ...
Epoch: 12 cost time: 1.7591896057128906
Epoch: 12, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8793582916259766
Epoch: 13, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.655 Vali Acc: 0.776 Test Loss: 0.655 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0061051845550537
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9847679138183594
Epoch: 15, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.799 Vali Acc: 0.789 Test Loss: 0.799 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.836176872253418
Epoch: 16, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.665 Vali Acc: 0.763 Test Loss: 0.665 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8689491748809814
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.604 Vali Acc: 0.796 Test Loss: 0.604 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.283491611480713
Epoch: 18, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8870298862457275
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7622413635253906
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.673 Vali Acc: 0.803 Test Loss: 0.673 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8800480365753174
Epoch: 21, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.781 Vali Acc: 0.789 Test Loss: 0.781 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 2797108
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.959589958190918
Epoch: 1, Steps: 10 | Train Loss: 1.438 Vali Loss: 1.393 Vali Acc: 0.250 Test Loss: 1.393 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.5629057884216309
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.298 Vali Acc: 0.467 Test Loss: 1.298 Test Acc: 0.467
Validation loss decreased (-0.249986 --> -0.467092).  Saving model ...
Epoch: 3 cost time: 1.8865480422973633
Epoch: 3, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.191 Vali Acc: 0.553 Test Loss: 1.191 Test Acc: 0.553
Validation loss decreased (-0.467092 --> -0.552620).  Saving model ...
Epoch: 4 cost time: 1.6639022827148438
Epoch: 4, Steps: 10 | Train Loss: 1.035 Vali Loss: 1.046 Vali Acc: 0.599 Test Loss: 1.046 Test Acc: 0.599
Validation loss decreased (-0.552620 --> -0.598674).  Saving model ...
Epoch: 5 cost time: 1.6491138935089111
Epoch: 5, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.000 Vali Acc: 0.599 Test Loss: 1.000 Test Acc: 0.599
Validation loss decreased (-0.598674 --> -0.598674).  Saving model ...
Epoch: 6 cost time: 1.7178804874420166
Epoch: 6, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.817 Vali Acc: 0.664 Test Loss: 0.817 Test Acc: 0.664
Validation loss decreased (-0.598674 --> -0.664466).  Saving model ...
Epoch: 7 cost time: 1.8958516120910645
Epoch: 7, Steps: 10 | Train Loss: 0.526 Vali Loss: 0.759 Vali Acc: 0.632 Test Loss: 0.759 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6297132968902588
Epoch: 8, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.763 Vali Acc: 0.697 Test Loss: 0.763 Test Acc: 0.697
Validation loss decreased (-0.664466 --> -0.697361).  Saving model ...
Epoch: 9 cost time: 1.6408131122589111
Epoch: 9, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.697361 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 1.5626826286315918
Epoch: 10, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.597 Vali Acc: 0.737 Test Loss: 0.597 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5408642292022705
Epoch: 11, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.636 Vali Acc: 0.757 Test Loss: 0.636 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 1.5385286808013916
Epoch: 12, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.584 Vali Acc: 0.789 Test Loss: 0.584 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.7811996936798096
Epoch: 13, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.653 Vali Acc: 0.763 Test Loss: 0.653 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.590552568435669
Epoch: 14, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.624 Vali Acc: 0.750 Test Loss: 0.624 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5769071578979492
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.606 Vali Acc: 0.776 Test Loss: 0.606 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7186405658721924
Epoch: 16, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.650 Vali Acc: 0.789 Test Loss: 0.650 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5506081581115723
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.591 Vali Acc: 0.776 Test Loss: 0.591 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5916309356689453
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.621 Vali Acc: 0.796 Test Loss: 0.621 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 19 cost time: 1.533959150314331
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.704 Vali Acc: 0.783 Test Loss: 0.704 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3603911399841309
Epoch: 20, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.683 Vali Acc: 0.803 Test Loss: 0.683 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 21 cost time: 1.5654144287109375
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.732 Vali Acc: 0.776 Test Loss: 0.732 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4059786796569824
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.774 Vali Acc: 0.796 Test Loss: 0.774 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.727569818496704
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.795 Vali Acc: 0.789 Test Loss: 0.795 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4034147262573242
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.830 Vali Acc: 0.776 Test Loss: 0.830 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5196421146392822
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.861 Vali Acc: 0.783 Test Loss: 0.861 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4122841358184814
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.878 Vali Acc: 0.789 Test Loss: 0.878 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.602792501449585
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.878 Vali Acc: 0.796 Test Loss: 0.878 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.753791332244873
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.915 Vali Acc: 0.783 Test Loss: 0.915 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8324370384216309
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.930 Vali Acc: 0.809 Test Loss: 0.930 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809201).  Saving model ...
Epoch: 30 cost time: 1.4827191829681396
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.943 Vali Acc: 0.796 Test Loss: 0.943 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6929571628570557
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.965 Vali Acc: 0.803 Test Loss: 0.965 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.4150452613830566
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.996 Vali Acc: 0.789 Test Loss: 0.996 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.557222604751587
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.994 Vali Acc: 0.783 Test Loss: 0.994 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4480082988739014
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.997 Vali Acc: 0.789 Test Loss: 0.997 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5626473426818848
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.022 Vali Acc: 0.796 Test Loss: 1.022 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.915992259979248
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.803 Test Loss: 1.036 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.4115891456604004
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.035 Vali Acc: 0.803 Test Loss: 1.035 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.946254014968872
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.060 Vali Acc: 0.796 Test Loss: 1.060 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.7678272724151611
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.062 Vali Acc: 0.796 Test Loss: 1.062 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2796340
model size : 13.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.5767340660095215
Epoch: 1, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.414 Vali Acc: 0.211 Test Loss: 1.414 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 2.114840030670166
Epoch: 2, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.336 Vali Acc: 0.355 Test Loss: 1.336 Test Acc: 0.355
Validation loss decreased (-0.210512 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 2.2895073890686035
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.252 Vali Acc: 0.513 Test Loss: 1.252 Test Acc: 0.513
Validation loss decreased (-0.355250 --> -0.513145).  Saving model ...
Epoch: 4 cost time: 2.7261431217193604
Epoch: 4, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.147 Vali Acc: 0.480 Test Loss: 1.147 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8658840656280518
Epoch: 5, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.080 Vali Acc: 0.546 Test Loss: 1.080 Test Acc: 0.546
Validation loss decreased (-0.513145 --> -0.546042).  Saving model ...
Epoch: 6 cost time: 1.9403188228607178
Epoch: 6, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.952 Vali Acc: 0.651 Test Loss: 0.952 Test Acc: 0.651
Validation loss decreased (-0.546042 --> -0.651306).  Saving model ...
Epoch: 7 cost time: 1.8417456150054932
Epoch: 7, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.934 Vali Acc: 0.566 Test Loss: 0.934 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5642378330230713
Epoch: 8, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.730 Vali Acc: 0.737 Test Loss: 0.730 Test Acc: 0.737
Validation loss decreased (-0.651306 --> -0.736835).  Saving model ...
Epoch: 9 cost time: 2.2637593746185303
Epoch: 9, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.669 Vali Acc: 0.730 Test Loss: 0.669 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.218219518661499
Epoch: 10, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.938251256942749
Epoch: 11, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
Validation loss decreased (-0.763152 --> -0.796047).  Saving model ...
Epoch: 12 cost time: 2.050450325012207
Epoch: 12, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.631 Vali Acc: 0.789 Test Loss: 0.631 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.718398094177246
Epoch: 13, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.588 Vali Acc: 0.770 Test Loss: 0.588 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8312623500823975
Epoch: 14, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.632 Vali Acc: 0.763 Test Loss: 0.632 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5847764015197754
Epoch: 15, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.589 Vali Acc: 0.783 Test Loss: 0.589 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1627140045166016
Epoch: 16, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.572 Vali Acc: 0.776 Test Loss: 0.572 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.059861898422241
Epoch: 17, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.638 Vali Acc: 0.763 Test Loss: 0.638 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4682390689849854
Epoch: 18, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.601 Vali Acc: 0.803 Test Loss: 0.601 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 19 cost time: 1.7665529251098633
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.693 Vali Acc: 0.789 Test Loss: 0.693 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2867560386657715
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6959972381591797
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.688 Vali Acc: 0.803 Test Loss: 0.688 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9906363487243652
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.731 Vali Acc: 0.783 Test Loss: 0.731 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6130750179290771
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.714 Vali Acc: 0.803 Test Loss: 0.714 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.4816858768463135
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.740 Vali Acc: 0.783 Test Loss: 0.740 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.7074739933013916
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.760 Vali Acc: 0.789 Test Loss: 0.760 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.129446268081665
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.781 Vali Acc: 0.776 Test Loss: 0.781 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5567278861999512
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.821 Vali Acc: 0.796 Test Loss: 0.821 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.1400418281555176
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.810 Vali Acc: 0.796 Test Loss: 0.810 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 2338100
model size : 11.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.484559774398804
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.392 Vali Acc: 0.309 Test Loss: 1.392 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.6482257843017578
Epoch: 2, Steps: 10 | Train Loss: 1.375 Vali Loss: 1.318 Vali Acc: 0.467 Test Loss: 1.318 Test Acc: 0.467
Validation loss decreased (-0.309197 --> -0.467092).  Saving model ...
Epoch: 3 cost time: 2.7695069313049316
Epoch: 3, Steps: 10 | Train Loss: 1.243 Vali Loss: 1.222 Vali Acc: 0.553 Test Loss: 1.222 Test Acc: 0.553
Validation loss decreased (-0.467092 --> -0.552619).  Saving model ...
Epoch: 4 cost time: 2.019158363342285
Epoch: 4, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.116 Vali Acc: 0.507 Test Loss: 1.116 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9848122596740723
Epoch: 5, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.965 Vali Acc: 0.599 Test Loss: 0.965 Test Acc: 0.599
Validation loss decreased (-0.552619 --> -0.598675).  Saving model ...
Epoch: 6 cost time: 1.8701395988464355
Epoch: 6, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.856 Vali Acc: 0.638 Test Loss: 0.856 Test Acc: 0.638
Validation loss decreased (-0.598675 --> -0.638149).  Saving model ...
Epoch: 7 cost time: 1.8022894859313965
Epoch: 7, Steps: 10 | Train Loss: 0.650 Vali Loss: 0.880 Vali Acc: 0.605 Test Loss: 0.880 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3154494762420654
Epoch: 8, Steps: 10 | Train Loss: 0.538 Vali Loss: 0.725 Vali Acc: 0.684 Test Loss: 0.725 Test Acc: 0.684
Validation loss decreased (-0.638149 --> -0.684203).  Saving model ...
Epoch: 9 cost time: 1.881091594696045
Epoch: 9, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.647 Vali Acc: 0.763 Test Loss: 0.647 Test Acc: 0.763
Validation loss decreased (-0.684203 --> -0.763151).  Saving model ...
Epoch: 10 cost time: 1.8357083797454834
Epoch: 10, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.582 Vali Acc: 0.743 Test Loss: 0.582 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1552751064300537
Epoch: 11, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.620 Vali Acc: 0.776 Test Loss: 0.620 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 2.443002939224243
Epoch: 12, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.530 Vali Acc: 0.763 Test Loss: 0.530 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.057429075241089
Epoch: 13, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.513 Vali Acc: 0.763 Test Loss: 0.513 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1460678577423096
Epoch: 14, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.640 Vali Acc: 0.763 Test Loss: 0.640 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.355896472930908
Epoch: 15, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.492 Vali Acc: 0.803 Test Loss: 0.492 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802627).  Saving model ...
Epoch: 16 cost time: 2.000845193862915
Epoch: 16, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.293217897415161
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.7955379486083984
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.602 Vali Acc: 0.803 Test Loss: 0.602 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.0737526416778564
Epoch: 19, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4005203247070312
Epoch: 20, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.621 Vali Acc: 0.816 Test Loss: 0.621 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815783).  Saving model ...
Epoch: 21 cost time: 2.2568418979644775
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0041444301605225
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822362).  Saving model ...
Epoch: 23 cost time: 2.0470330715179443
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.690 Vali Acc: 0.816 Test Loss: 0.690 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0152761936187744
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.709 Vali Acc: 0.836 Test Loss: 0.709 Test Acc: 0.836
Validation loss decreased (-0.822362 --> -0.835519).  Saving model ...
Epoch: 25 cost time: 1.8553237915039062
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.712 Vali Acc: 0.816 Test Loss: 0.712 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.177165985107422
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.760 Vali Acc: 0.829 Test Loss: 0.760 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8138270378112793
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.739 Vali Acc: 0.803 Test Loss: 0.739 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.619065999984741
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.768 Vali Acc: 0.803 Test Loss: 0.768 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.4221277236938477
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.790 Vali Acc: 0.816 Test Loss: 0.790 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.709535837173462
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.788 Vali Acc: 0.789 Test Loss: 0.788 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.4585680961608887
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.803 Vali Acc: 0.796 Test Loss: 0.803 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.88301420211792
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.824 Vali Acc: 0.803 Test Loss: 0.824 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.210020065307617
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.827 Vali Acc: 0.803 Test Loss: 0.827 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9460866451263428
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.846 Vali Acc: 0.809 Test Loss: 0.846 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 2337332
model size : 11.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.041138410568237
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.407 Vali Acc: 0.211 Test Loss: 1.407 Test Acc: 0.211
Validation loss decreased (inf --> -0.210512).  Saving model ...
Epoch: 2 cost time: 2.1964666843414307
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.329 Vali Acc: 0.296 Test Loss: 1.329 Test Acc: 0.296
Validation loss decreased (-0.210512 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.679755687713623
Epoch: 3, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.231 Vali Acc: 0.461 Test Loss: 1.231 Test Acc: 0.461
Validation loss decreased (-0.296039 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 1.7250087261199951
Epoch: 4, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.130 Vali Acc: 0.533 Test Loss: 1.130 Test Acc: 0.533
Validation loss decreased (-0.460514 --> -0.532883).  Saving model ...
Epoch: 5 cost time: 1.817779779434204
Epoch: 5, Steps: 10 | Train Loss: 0.935 Vali Loss: 0.978 Vali Acc: 0.638 Test Loss: 0.978 Test Acc: 0.638
Validation loss decreased (-0.532883 --> -0.638148).  Saving model ...
Epoch: 6 cost time: 1.8602769374847412
Epoch: 6, Steps: 10 | Train Loss: 0.724 Vali Loss: 0.918 Vali Acc: 0.625 Test Loss: 0.918 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1583311557769775
Epoch: 7, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.736 Vali Acc: 0.684 Test Loss: 0.736 Test Acc: 0.684
Validation loss decreased (-0.638148 --> -0.684203).  Saving model ...
Epoch: 8 cost time: 1.9895501136779785
Epoch: 8, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.745 Vali Acc: 0.684 Test Loss: 0.745 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6756505966186523
Epoch: 9, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.685 Vali Acc: 0.724 Test Loss: 0.685 Test Acc: 0.724
Validation loss decreased (-0.684203 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 1.576977014541626
Epoch: 10, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.636 Vali Acc: 0.724 Test Loss: 0.636 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723678).  Saving model ...
Epoch: 11 cost time: 1.9133846759796143
Epoch: 11, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.623 Vali Acc: 0.763 Test Loss: 0.623 Test Acc: 0.763
Validation loss decreased (-0.723678 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.861055850982666
Epoch: 12, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.630 Vali Acc: 0.776 Test Loss: 0.630 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776309).  Saving model ...
Epoch: 13 cost time: 1.864776849746704
Epoch: 13, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.787 Vali Acc: 0.717 Test Loss: 0.787 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6793103218078613
Epoch: 14, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
Validation loss decreased (-0.776309 --> -0.789467).  Saving model ...
Epoch: 15 cost time: 2.0165271759033203
Epoch: 15, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.668 Vali Acc: 0.763 Test Loss: 0.668 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.0179617404937744
Epoch: 16, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.638 Vali Acc: 0.783 Test Loss: 0.638 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.857206106185913
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.671 Vali Acc: 0.757 Test Loss: 0.671 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8180046081542969
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.789 Vali Acc: 0.770 Test Loss: 0.789 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.7817409038543701
Epoch: 19, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.732 Vali Acc: 0.776 Test Loss: 0.732 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7875545024871826
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.788 Vali Acc: 0.783 Test Loss: 0.788 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7738690376281738
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.806 Vali Acc: 0.809 Test Loss: 0.806 Test Acc: 0.809
Validation loss decreased (-0.789467 --> -0.809202).  Saving model ...
Epoch: 22 cost time: 1.5259315967559814
Epoch: 22, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.842 Vali Acc: 0.776 Test Loss: 0.842 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.143183708190918
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.826 Vali Acc: 0.796 Test Loss: 0.826 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7612993717193604
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.888 Vali Acc: 0.796 Test Loss: 0.888 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6130995750427246
Epoch: 25, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.904 Vali Acc: 0.789 Test Loss: 0.904 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8958470821380615
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.948 Vali Acc: 0.776 Test Loss: 0.948 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9307963848114014
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.036 Vali Acc: 0.783 Test Loss: 1.036 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9977140426635742
Epoch: 28, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.995 Vali Acc: 0.783 Test Loss: 0.995 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.925093650817871
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 1.080 Vali Acc: 0.750 Test Loss: 1.080 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6755540370941162
Epoch: 30, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.030 Vali Acc: 0.743 Test Loss: 1.030 Test Acc: 0.743
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6497271060943604
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.928 Vali Acc: 0.783 Test Loss: 0.928 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2336564
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7343032360076904
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.361 Vali Acc: 0.342 Test Loss: 1.361 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.4974234104156494
Epoch: 2, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.292 Vali Acc: 0.447 Test Loss: 1.292 Test Acc: 0.447
Validation loss decreased (-0.342092 --> -0.447355).  Saving model ...
Epoch: 3 cost time: 1.4888007640838623
Epoch: 3, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.202 Vali Acc: 0.539 Test Loss: 1.202 Test Acc: 0.539
Validation loss decreased (-0.447355 --> -0.539462).  Saving model ...
Epoch: 4 cost time: 1.8549716472625732
Epoch: 4, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.080 Vali Acc: 0.599 Test Loss: 1.080 Test Acc: 0.599
Validation loss decreased (-0.539462 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 1.783116102218628
Epoch: 5, Steps: 10 | Train Loss: 0.988 Vali Loss: 0.984 Vali Acc: 0.612 Test Loss: 0.984 Test Acc: 0.612
Validation loss decreased (-0.598673 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 1.829357385635376
Epoch: 6, Steps: 10 | Train Loss: 0.751 Vali Loss: 0.795 Vali Acc: 0.678 Test Loss: 0.795 Test Acc: 0.678
Validation loss decreased (-0.611832 --> -0.677624).  Saving model ...
Epoch: 7 cost time: 1.6728286743164062
Epoch: 7, Steps: 10 | Train Loss: 0.573 Vali Loss: 0.705 Vali Acc: 0.684 Test Loss: 0.705 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 8 cost time: 1.407456636428833
Epoch: 8, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.691 Vali Acc: 0.671 Test Loss: 0.691 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3650386333465576
Epoch: 9, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.614 Vali Acc: 0.737 Test Loss: 0.614 Test Acc: 0.737
Validation loss decreased (-0.684203 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.6363458633422852
Epoch: 10, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.707 Vali Acc: 0.724 Test Loss: 0.707 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8018097877502441
Epoch: 11, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.566 Vali Acc: 0.789 Test Loss: 0.566 Test Acc: 0.789
Validation loss decreased (-0.736836 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.4598150253295898
Epoch: 12, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.491 Vali Acc: 0.783 Test Loss: 0.491 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4513237476348877
Epoch: 13, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6553118228912354
Epoch: 14, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.518 Vali Acc: 0.763 Test Loss: 0.518 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7192115783691406
Epoch: 15, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.505019187927246
Epoch: 16, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.5070242881774902
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.585 Vali Acc: 0.789 Test Loss: 0.585 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6607611179351807
Epoch: 18, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.645 Vali Acc: 0.783 Test Loss: 0.645 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6748647689819336
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.634 Vali Acc: 0.789 Test Loss: 0.634 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6269338130950928
Epoch: 20, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.684 Vali Acc: 0.809 Test Loss: 0.684 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 21 cost time: 1.616227149963379
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.731 Vali Acc: 0.770 Test Loss: 0.731 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6707236766815186
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.735 Vali Acc: 0.776 Test Loss: 0.735 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7052721977233887
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.858 Vali Acc: 0.783 Test Loss: 0.858 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.623920202255249
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.930 Vali Acc: 0.776 Test Loss: 0.930 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4998483657836914
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.868 Vali Acc: 0.816 Test Loss: 0.868 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815781).  Saving model ...
Epoch: 26 cost time: 1.4418971538543701
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.801 Vali Acc: 0.796 Test Loss: 0.801 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.037848949432373
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.821 Vali Acc: 0.809 Test Loss: 0.821 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.6325123310089111
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.939 Vali Acc: 0.789 Test Loss: 0.939 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3624558448791504
Epoch: 29, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.894 Vali Acc: 0.822 Test Loss: 0.894 Test Acc: 0.822
Validation loss decreased (-0.815781 --> -0.822359).  Saving model ...
Epoch: 30 cost time: 1.4252662658691406
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 1.006 Vali Acc: 0.757 Test Loss: 1.006 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.583418607711792
Epoch: 31, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.878 Vali Acc: 0.796 Test Loss: 0.878 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5514163970947266
Epoch: 32, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.905 Vali Acc: 0.789 Test Loss: 0.905 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6938834190368652
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.917 Vali Acc: 0.789 Test Loss: 0.917 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.7846062183380127
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.930 Vali Acc: 0.816 Test Loss: 0.930 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7285714149475098
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.919 Vali Acc: 0.816 Test Loss: 0.919 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.679743766784668
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.930 Vali Acc: 0.789 Test Loss: 0.930 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.6871769428253174
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.816 Test Loss: 0.933 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.1035335063934326
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.937 Vali Acc: 0.809 Test Loss: 0.937 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.7938947677612305
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.789 Test Loss: 0.949 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 2335796
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.3741536140441895
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.399 Vali Acc: 0.276 Test Loss: 1.399 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.6953716278076172
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.341 Vali Acc: 0.309 Test Loss: 1.341 Test Acc: 0.309
Validation loss decreased (-0.276302 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 1.5724339485168457
Epoch: 3, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.234 Vali Acc: 0.513 Test Loss: 1.234 Test Acc: 0.513
Validation loss decreased (-0.309197 --> -0.513146).  Saving model ...
Epoch: 4 cost time: 1.9341561794281006
Epoch: 4, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.147 Vali Acc: 0.487 Test Loss: 1.147 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.957698106765747
Epoch: 5, Steps: 10 | Train Loss: 1.025 Vali Loss: 0.992 Vali Acc: 0.612 Test Loss: 0.992 Test Acc: 0.612
Validation loss decreased (-0.513146 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 1.8641741275787354
Epoch: 6, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.866 Vali Acc: 0.645 Test Loss: 0.866 Test Acc: 0.645
Validation loss decreased (-0.611832 --> -0.644728).  Saving model ...
Epoch: 7 cost time: 2.1061108112335205
Epoch: 7, Steps: 10 | Train Loss: 0.650 Vali Loss: 0.786 Vali Acc: 0.704 Test Loss: 0.786 Test Acc: 0.704
Validation loss decreased (-0.644728 --> -0.703940).  Saving model ...
Epoch: 8 cost time: 1.9687612056732178
Epoch: 8, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.729 Vali Acc: 0.717 Test Loss: 0.729 Test Acc: 0.717
Validation loss decreased (-0.703940 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 1.6612334251403809
Epoch: 9, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.676 Vali Acc: 0.717 Test Loss: 0.676 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717099).  Saving model ...
Epoch: 10 cost time: 1.7606773376464844
Epoch: 10, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
Validation loss decreased (-0.717099 --> -0.776310).  Saving model ...
Epoch: 11 cost time: 1.952108383178711
Epoch: 11, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8758599758148193
Epoch: 12, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6194403171539307
Epoch: 13, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8977656364440918
Epoch: 14, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0656380653381348
Epoch: 15, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.711 Vali Acc: 0.770 Test Loss: 0.711 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7863023281097412
Epoch: 16, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.584 Vali Acc: 0.770 Test Loss: 0.584 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9745967388153076
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.599111557006836
Epoch: 18, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.624 Vali Acc: 0.757 Test Loss: 0.624 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3556110858917236
Epoch: 19, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.666 Vali Acc: 0.770 Test Loss: 0.666 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0809860229492188
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.671 Vali Acc: 0.783 Test Loss: 0.671 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.765472173690796
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.755 Vali Acc: 0.770 Test Loss: 0.755 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7776882648468018
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.683 Vali Acc: 0.796 Test Loss: 0.683 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 23 cost time: 1.9213838577270508
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.763 Vali Acc: 0.776 Test Loss: 0.763 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9049196243286133
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.837 Vali Acc: 0.770 Test Loss: 0.837 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4895470142364502
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.744 Vali Acc: 0.803 Test Loss: 0.744 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 26 cost time: 1.5438361167907715
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.779 Vali Acc: 0.776 Test Loss: 0.779 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4655711650848389
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.798 Vali Acc: 0.783 Test Loss: 0.798 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5330142974853516
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.823 Vali Acc: 0.789 Test Loss: 0.823 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.163001775741577
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.842 Vali Acc: 0.809 Test Loss: 0.842 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809202).  Saving model ...
Epoch: 30 cost time: 1.6257236003875732
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.865 Vali Acc: 0.796 Test Loss: 0.865 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9939508438110352
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.885 Vali Acc: 0.803 Test Loss: 0.885 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.928069829940796
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.902 Vali Acc: 0.776 Test Loss: 0.902 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7947404384613037
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.901 Vali Acc: 0.816 Test Loss: 0.901 Test Acc: 0.816
Validation loss decreased (-0.809202 --> -0.815780).  Saving model ...
Epoch: 34 cost time: 1.4157238006591797
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.936 Vali Acc: 0.776 Test Loss: 0.936 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5457863807678223
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.924 Vali Acc: 0.789 Test Loss: 0.924 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6664721965789795
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.932 Vali Acc: 0.796 Test Loss: 0.932 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4145441055297852
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.947 Vali Acc: 0.783 Test Loss: 0.947 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.5743484497070312
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.951 Vali Acc: 0.776 Test Loss: 0.951 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.6043744087219238
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.967 Vali Acc: 0.783 Test Loss: 0.967 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.8927898406982422
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.965 Vali Acc: 0.796 Test Loss: 0.965 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.5222241878509521
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.783 Test Loss: 0.974 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.5364196300506592
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.990 Vali Acc: 0.783 Test Loss: 0.990 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.4387218952178955
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.001 Vali Acc: 0.783 Test Loss: 1.001 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 2107828
model size : 10.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.038849592208862
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.387 Vali Acc: 0.263 Test Loss: 1.387 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.4591760635375977
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.336 Vali Acc: 0.336 Test Loss: 1.336 Test Acc: 0.336
Validation loss decreased (-0.263144 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.6385154724121094
Epoch: 3, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.236 Vali Acc: 0.421 Test Loss: 1.236 Test Acc: 0.421
Validation loss decreased (-0.335513 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.7207298278808594
Epoch: 4, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.165 Vali Acc: 0.493 Test Loss: 1.165 Test Acc: 0.493
Validation loss decreased (-0.421040 --> -0.493409).  Saving model ...
Epoch: 5 cost time: 1.530383825302124
Epoch: 5, Steps: 10 | Train Loss: 1.038 Vali Loss: 1.015 Vali Acc: 0.592 Test Loss: 1.015 Test Acc: 0.592
Validation loss decreased (-0.493409 --> -0.592095).  Saving model ...
Epoch: 6 cost time: 1.4312026500701904
Epoch: 6, Steps: 10 | Train Loss: 0.848 Vali Loss: 0.913 Vali Acc: 0.664 Test Loss: 0.913 Test Acc: 0.664
Validation loss decreased (-0.592095 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 1.8030920028686523
Epoch: 7, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.921 Vali Acc: 0.671 Test Loss: 0.921 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671043).  Saving model ...
Epoch: 8 cost time: 1.2942895889282227
Epoch: 8, Steps: 10 | Train Loss: 0.602 Vali Loss: 0.830 Vali Acc: 0.605 Test Loss: 0.830 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4741630554199219
Epoch: 9, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.821 Vali Acc: 0.671 Test Loss: 0.821 Test Acc: 0.671
Validation loss decreased (-0.671043 --> -0.671044).  Saving model ...
Epoch: 10 cost time: 1.3993113040924072
Epoch: 10, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.635 Vali Acc: 0.757 Test Loss: 0.635 Test Acc: 0.757
Validation loss decreased (-0.671044 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.4601709842681885
Epoch: 11, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.725 Vali Acc: 0.684 Test Loss: 0.725 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2843317985534668
Epoch: 12, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.619 Vali Acc: 0.783 Test Loss: 0.619 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.4255437850952148
Epoch: 13, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3882298469543457
Epoch: 14, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.571 Vali Acc: 0.737 Test Loss: 0.571 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5301494598388672
Epoch: 15, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.3034846782684326
Epoch: 16, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.560 Vali Acc: 0.750 Test Loss: 0.560 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4639837741851807
Epoch: 17, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.801903486251831
Epoch: 18, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.646 Vali Acc: 0.763 Test Loss: 0.646 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4465398788452148
Epoch: 19, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.835 Vali Acc: 0.763 Test Loss: 0.835 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.629060983657837
Epoch: 20, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.832 Vali Acc: 0.743 Test Loss: 0.832 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5033948421478271
Epoch: 21, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.654 Vali Acc: 0.796 Test Loss: 0.654 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796046).  Saving model ...
Epoch: 22 cost time: 1.9458577632904053
Epoch: 22, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.697 Vali Acc: 0.776 Test Loss: 0.697 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7830626964569092
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.717 Vali Acc: 0.763 Test Loss: 0.717 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4176082611083984
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.755 Vali Acc: 0.776 Test Loss: 0.755 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.0310494899749756
Epoch: 25, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.774 Vali Acc: 0.796 Test Loss: 0.774 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9583404064178467
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.758 Vali Acc: 0.783 Test Loss: 0.758 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.9414243698120117
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.766 Vali Acc: 0.789 Test Loss: 0.766 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8505175113677979
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.779 Vali Acc: 0.796 Test Loss: 0.779 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5357084274291992
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.801 Vali Acc: 0.796 Test Loss: 0.801 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4359402656555176
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.844 Vali Acc: 0.809 Test Loss: 0.844 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809202).  Saving model ...
Epoch: 31 cost time: 1.534224271774292
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.849 Vali Acc: 0.789 Test Loss: 0.849 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9493308067321777
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.862 Vali Acc: 0.796 Test Loss: 0.862 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5419762134552002
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.879 Vali Acc: 0.796 Test Loss: 0.879 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.5979020595550537
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.884 Vali Acc: 0.789 Test Loss: 0.884 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.55415678024292
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.893 Vali Acc: 0.803 Test Loss: 0.893 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5691184997558594
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.911 Vali Acc: 0.789 Test Loss: 0.911 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5869693756103516
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.925 Vali Acc: 0.789 Test Loss: 0.925 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5860507488250732
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.925 Vali Acc: 0.796 Test Loss: 0.925 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8005881309509277
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.934 Vali Acc: 0.796 Test Loss: 0.934 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.8429346084594727
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.945 Vali Acc: 0.789 Test Loss: 0.945 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2107060
model size : 10.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.300976514816284
Epoch: 1, Steps: 10 | Train Loss: 1.476 Vali Loss: 1.413 Vali Acc: 0.296 Test Loss: 1.413 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 2.452526092529297
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.332 Vali Acc: 0.401 Test Loss: 1.332 Test Acc: 0.401
Validation loss decreased (-0.296039 --> -0.401302).  Saving model ...
Epoch: 3 cost time: 2.0111804008483887
Epoch: 3, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.235 Vali Acc: 0.507 Test Loss: 1.235 Test Acc: 0.507
Validation loss decreased (-0.401302 --> -0.506567).  Saving model ...
Epoch: 4 cost time: 1.727226734161377
Epoch: 4, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.186 Vali Acc: 0.467 Test Loss: 1.186 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8541648387908936
Epoch: 5, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.006 Vali Acc: 0.671 Test Loss: 1.006 Test Acc: 0.671
Validation loss decreased (-0.506567 --> -0.671043).  Saving model ...
Epoch: 6 cost time: 2.2229857444763184
Epoch: 6, Steps: 10 | Train Loss: 0.844 Vali Loss: 0.918 Vali Acc: 0.638 Test Loss: 0.918 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2726173400878906
Epoch: 7, Steps: 10 | Train Loss: 0.648 Vali Loss: 0.813 Vali Acc: 0.664 Test Loss: 0.813 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.9398832321166992
Epoch: 8, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.657 Vali Acc: 0.757 Test Loss: 0.657 Test Acc: 0.757
Validation loss decreased (-0.671043 --> -0.756572).  Saving model ...
Epoch: 9 cost time: 1.803802728652954
Epoch: 9, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.617 Vali Acc: 0.763 Test Loss: 0.617 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.5114552974700928
Epoch: 10, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.613 Vali Acc: 0.730 Test Loss: 0.613 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5114641189575195
Epoch: 11, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.890528917312622
Epoch: 12, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1794753074645996
Epoch: 13, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7019495964050293
Epoch: 14, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.906806230545044
Epoch: 15, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.658 Vali Acc: 0.757 Test Loss: 0.658 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.208468198776245
Epoch: 16, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.736 Vali Acc: 0.770 Test Loss: 0.736 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.1802380084991455
Epoch: 17, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.651 Vali Acc: 0.789 Test Loss: 0.651 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789467).  Saving model ...
Epoch: 18 cost time: 2.10436749458313
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.748 Vali Acc: 0.789 Test Loss: 0.748 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.1756176948547363
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.743 Vali Acc: 0.763 Test Loss: 0.743 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.592442274093628
Epoch: 20, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.745 Vali Acc: 0.803 Test Loss: 0.745 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802624).  Saving model ...
Epoch: 21 cost time: 1.8456947803497314
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.335005521774292
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.923 Vali Acc: 0.783 Test Loss: 0.923 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.099517345428467
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.820 Vali Acc: 0.796 Test Loss: 0.820 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0463755130767822
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.853 Vali Acc: 0.789 Test Loss: 0.853 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.850954532623291
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.870 Vali Acc: 0.809 Test Loss: 0.870 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809202).  Saving model ...
Epoch: 26 cost time: 1.554863452911377
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.887 Vali Acc: 0.803 Test Loss: 0.887 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9689137935638428
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.897 Vali Acc: 0.796 Test Loss: 0.897 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.553661584854126
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.899 Vali Acc: 0.796 Test Loss: 0.899 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.0563199520111084
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.929 Vali Acc: 0.796 Test Loss: 0.929 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.528132438659668
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.936 Vali Acc: 0.789 Test Loss: 0.936 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.306358575820923
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.994 Vali Acc: 0.796 Test Loss: 0.994 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.2602269649505615
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.991 Vali Acc: 0.803 Test Loss: 0.991 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.2985401153564453
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.992 Vali Acc: 0.796 Test Loss: 0.992 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.008802652359009
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.043 Vali Acc: 0.796 Test Loss: 1.043 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.1267056465148926
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.049 Vali Acc: 0.803 Test Loss: 1.049 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2106292
model size : 10.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5376908779144287
Epoch: 1, Steps: 10 | Train Loss: 1.573 Vali Loss: 1.433 Vali Acc: 0.270 Test Loss: 1.433 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.763423204421997
Epoch: 2, Steps: 10 | Train Loss: 1.474 Vali Loss: 1.422 Vali Acc: 0.289 Test Loss: 1.422 Test Acc: 0.289
Validation loss decreased (-0.269723 --> -0.289459).  Saving model ...
Epoch: 3 cost time: 1.6375508308410645
Epoch: 3, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.328 Vali Acc: 0.395 Test Loss: 1.328 Test Acc: 0.395
Validation loss decreased (-0.289459 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 1.6170780658721924
Epoch: 4, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.235 Vali Acc: 0.401 Test Loss: 1.235 Test Acc: 0.401
Validation loss decreased (-0.394724 --> -0.401303).  Saving model ...
Epoch: 5 cost time: 1.5728776454925537
Epoch: 5, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.113 Vali Acc: 0.599 Test Loss: 1.113 Test Acc: 0.599
Validation loss decreased (-0.401303 --> -0.598673).  Saving model ...
Epoch: 6 cost time: 1.6062235832214355
Epoch: 6, Steps: 10 | Train Loss: 0.975 Vali Loss: 0.999 Vali Acc: 0.605 Test Loss: 0.999 Test Acc: 0.605
Validation loss decreased (-0.598673 --> -0.605253).  Saving model ...
Epoch: 7 cost time: 1.3881268501281738
Epoch: 7, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.904 Vali Acc: 0.605 Test Loss: 0.904 Test Acc: 0.605
Validation loss decreased (-0.605253 --> -0.605254).  Saving model ...
Epoch: 8 cost time: 1.378462791442871
Epoch: 8, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.811 Vali Acc: 0.664 Test Loss: 0.811 Test Acc: 0.664
Validation loss decreased (-0.605254 --> -0.664466).  Saving model ...
Epoch: 9 cost time: 1.6882965564727783
Epoch: 9, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.823 Vali Acc: 0.618 Test Loss: 0.823 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.764296531677246
Epoch: 10, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.675 Vali Acc: 0.757 Test Loss: 0.675 Test Acc: 0.757
Validation loss decreased (-0.664466 --> -0.756572).  Saving model ...
Epoch: 11 cost time: 1.933586835861206
Epoch: 11, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.622 Vali Acc: 0.730 Test Loss: 0.622 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9810993671417236
Epoch: 12, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.641 Vali Acc: 0.757 Test Loss: 0.641 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.5446467399597168
Epoch: 13, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.618 Vali Acc: 0.763 Test Loss: 0.618 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 1.538010597229004
Epoch: 14, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.604 Vali Acc: 0.770 Test Loss: 0.604 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.3574419021606445
Epoch: 15, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.565284252166748
Epoch: 16, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.6661744117736816
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6769816875457764
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.606 Vali Acc: 0.796 Test Loss: 0.606 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4552764892578125
Epoch: 19, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.713 Vali Acc: 0.783 Test Loss: 0.713 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.022987127304077
Epoch: 20, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.732 Vali Acc: 0.789 Test Loss: 0.732 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3050477504730225
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.748 Vali Acc: 0.803 Test Loss: 0.748 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 22 cost time: 1.5595974922180176
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.771 Vali Acc: 0.803 Test Loss: 0.771 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9669551849365234
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.799 Vali Acc: 0.783 Test Loss: 0.799 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5452353954315186
Epoch: 24, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.744 Vali Acc: 0.796 Test Loss: 0.744 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4575276374816895
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.788 Vali Acc: 0.796 Test Loss: 0.788 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6056270599365234
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.857 Vali Acc: 0.796 Test Loss: 0.857 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8909969329833984
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.881 Vali Acc: 0.789 Test Loss: 0.881 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8631534576416016
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.873 Vali Acc: 0.803 Test Loss: 0.873 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5424842834472656
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.878 Vali Acc: 0.809 Test Loss: 0.878 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809202).  Saving model ...
Epoch: 30 cost time: 1.3870854377746582
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.895 Vali Acc: 0.789 Test Loss: 0.895 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6002213954925537
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.909 Vali Acc: 0.783 Test Loss: 0.909 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.5070335865020752
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.898 Vali Acc: 0.789 Test Loss: 0.898 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.746220350265503
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 1.130 Vali Acc: 0.770 Test Loss: 1.130 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.772735834121704
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.925 Vali Acc: 0.789 Test Loss: 0.925 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7924606800079346
Epoch: 35, Steps: 10 | Train Loss: 0.056 Vali Loss: 1.034 Vali Acc: 0.730 Test Loss: 1.034 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8922672271728516
Epoch: 36, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.051 Vali Acc: 0.763 Test Loss: 1.051 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.4138538837432861
Epoch: 37, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.897 Vali Acc: 0.796 Test Loss: 0.897 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.6298828125
Epoch: 38, Steps: 10 | Train Loss: 0.048 Vali Loss: 1.005 Vali Acc: 0.750 Test Loss: 1.005 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.5616567134857178
Epoch: 39, Steps: 10 | Train Loss: 0.052 Vali Loss: 1.093 Vali Acc: 0.783 Test Loss: 1.093 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2105524
model size : 10.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3850297927856445
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.410 Vali Acc: 0.237 Test Loss: 1.410 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.3707315921783447
Epoch: 2, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.362 Vali Acc: 0.322 Test Loss: 1.362 Test Acc: 0.322
Validation loss decreased (-0.236828 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.4879200458526611
Epoch: 3, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.303 Vali Acc: 0.401 Test Loss: 1.303 Test Acc: 0.401
Validation loss decreased (-0.322355 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 1.9899754524230957
Epoch: 4, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.234 Vali Acc: 0.513 Test Loss: 1.234 Test Acc: 0.513
Validation loss decreased (-0.401303 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 1.6277384757995605
Epoch: 5, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.136 Vali Acc: 0.579 Test Loss: 1.136 Test Acc: 0.579
Validation loss decreased (-0.513146 --> -0.578936).  Saving model ...
Epoch: 6 cost time: 1.7107906341552734
Epoch: 6, Steps: 10 | Train Loss: 0.968 Vali Loss: 0.976 Vali Acc: 0.625 Test Loss: 0.976 Test Acc: 0.625
Validation loss decreased (-0.578936 --> -0.624990).  Saving model ...
Epoch: 7 cost time: 1.6904265880584717
Epoch: 7, Steps: 10 | Train Loss: 0.858 Vali Loss: 0.880 Vali Acc: 0.651 Test Loss: 0.880 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651307).  Saving model ...
Epoch: 8 cost time: 1.7279369831085205
Epoch: 8, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.729 Vali Acc: 0.743 Test Loss: 0.729 Test Acc: 0.743
Validation loss decreased (-0.651307 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 1.5425798892974854
Epoch: 9, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.652 Vali Acc: 0.770 Test Loss: 0.652 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769730).  Saving model ...
Epoch: 10 cost time: 1.5607950687408447
Epoch: 10, Steps: 10 | Train Loss: 0.428 Vali Loss: 0.637 Vali Acc: 0.770 Test Loss: 0.637 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769730).  Saving model ...
Epoch: 11 cost time: 2.0125460624694824
Epoch: 11, Steps: 10 | Train Loss: 0.342 Vali Loss: 0.539 Vali Acc: 0.737 Test Loss: 0.539 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.023881435394287
Epoch: 12, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
Validation loss decreased (-0.769730 --> -0.809205).  Saving model ...
Epoch: 13 cost time: 1.7783324718475342
Epoch: 13, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.482 Vali Acc: 0.809 Test Loss: 0.482 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809206).  Saving model ...
Epoch: 14 cost time: 1.8750717639923096
Epoch: 14, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.442 Vali Acc: 0.796 Test Loss: 0.442 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6108124256134033
Epoch: 15, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.457 Vali Acc: 0.803 Test Loss: 0.457 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6362206935882568
Epoch: 16, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.500 Vali Acc: 0.776 Test Loss: 0.500 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5425667762756348
Epoch: 17, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.505 Vali Acc: 0.803 Test Loss: 0.505 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6495563983917236
Epoch: 18, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8490684032440186
Epoch: 19, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.460 Vali Acc: 0.796 Test Loss: 0.460 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.761979579925537
Epoch: 20, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.472 Vali Acc: 0.783 Test Loss: 0.472 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8993761539459229
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.519 Vali Acc: 0.796 Test Loss: 0.519 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8565421104431152
Epoch: 22, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4239170551300049
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1404724
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.398665189743042
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.418 Vali Acc: 0.329 Test Loss: 1.418 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 1.6911330223083496
Epoch: 2, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.350 Vali Acc: 0.349 Test Loss: 1.350 Test Acc: 0.349
Validation loss decreased (-0.328933 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 2.1774916648864746
Epoch: 3, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.287 Vali Acc: 0.428 Test Loss: 1.287 Test Acc: 0.428
Validation loss decreased (-0.348671 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 2.0711441040039062
Epoch: 4, Steps: 10 | Train Loss: 1.216 Vali Loss: 1.156 Vali Acc: 0.539 Test Loss: 1.156 Test Acc: 0.539
Validation loss decreased (-0.427619 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 1.9486396312713623
Epoch: 5, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.029 Vali Acc: 0.592 Test Loss: 1.029 Test Acc: 0.592
Validation loss decreased (-0.539462 --> -0.592095).  Saving model ...
Epoch: 6 cost time: 1.8464717864990234
Epoch: 6, Steps: 10 | Train Loss: 0.838 Vali Loss: 0.883 Vali Acc: 0.658 Test Loss: 0.883 Test Acc: 0.658
Validation loss decreased (-0.592095 --> -0.657886).  Saving model ...
Epoch: 7 cost time: 2.607139825820923
Epoch: 7, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.772 Vali Acc: 0.691 Test Loss: 0.772 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690782).  Saving model ...
Epoch: 8 cost time: 1.9659771919250488
Epoch: 8, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.706 Vali Acc: 0.697 Test Loss: 0.706 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 9 cost time: 1.9717433452606201
Epoch: 9, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.646 Vali Acc: 0.757 Test Loss: 0.646 Test Acc: 0.757
Validation loss decreased (-0.697361 --> -0.756572).  Saving model ...
Epoch: 10 cost time: 1.7918963432312012
Epoch: 10, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.603 Vali Acc: 0.743 Test Loss: 0.603 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.01169753074646
Epoch: 11, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.569 Vali Acc: 0.743 Test Loss: 0.569 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.334467887878418
Epoch: 12, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.612 Vali Acc: 0.763 Test Loss: 0.612 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 2.38999080657959
Epoch: 13, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.665196657180786
Epoch: 14, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.529 Vali Acc: 0.796 Test Loss: 0.529 Test Acc: 0.796
Validation loss decreased (-0.763152 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.8560004234313965
Epoch: 15, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.530 Vali Acc: 0.763 Test Loss: 0.530 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7924857139587402
Epoch: 16, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.545 Vali Acc: 0.776 Test Loss: 0.545 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6788971424102783
Epoch: 17, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7226839065551758
Epoch: 18, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.613 Vali Acc: 0.789 Test Loss: 0.613 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0358808040618896
Epoch: 19, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.498377561569214
Epoch: 20, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.829636812210083
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.622 Vali Acc: 0.763 Test Loss: 0.622 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5792856216430664
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.595 Vali Acc: 0.750 Test Loss: 0.595 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9245028495788574
Epoch: 23, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.633 Vali Acc: 0.763 Test Loss: 0.633 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.0114352703094482
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 25 cost time: 2.048820734024048
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.621 Vali Acc: 0.776 Test Loss: 0.621 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.052100658416748
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.659 Vali Acc: 0.763 Test Loss: 0.659 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.620107650756836
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.637 Vali Acc: 0.776 Test Loss: 0.637 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.1440885066986084
Epoch: 28, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.644 Vali Acc: 0.770 Test Loss: 0.644 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.984161376953125
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.078556776046753
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.678 Vali Acc: 0.776 Test Loss: 0.678 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.7131712436676025
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.679 Vali Acc: 0.783 Test Loss: 0.679 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.5044796466827393
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.714 Vali Acc: 0.770 Test Loss: 0.714 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.8341619968414307
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.696 Vali Acc: 0.763 Test Loss: 0.696 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.0471909046173096
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.738 Vali Acc: 0.770 Test Loss: 0.738 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1404340
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.484066486358643
Epoch: 1, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.384 Vali Acc: 0.257 Test Loss: 1.384 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 2.8005337715148926
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.367 Vali Acc: 0.276 Test Loss: 1.367 Test Acc: 0.276
Validation loss decreased (-0.256565 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 2.578615188598633
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.272 Vali Acc: 0.401 Test Loss: 1.272 Test Acc: 0.401
Validation loss decreased (-0.276302 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 1.9325907230377197
Epoch: 4, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.207 Vali Acc: 0.533 Test Loss: 1.207 Test Acc: 0.533
Validation loss decreased (-0.401303 --> -0.532883).  Saving model ...
Epoch: 5 cost time: 1.6950528621673584
Epoch: 5, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.072 Vali Acc: 0.625 Test Loss: 1.072 Test Acc: 0.625
Validation loss decreased (-0.532883 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.9894371032714844
Epoch: 6, Steps: 10 | Train Loss: 0.905 Vali Loss: 0.941 Vali Acc: 0.697 Test Loss: 0.941 Test Acc: 0.697
Validation loss decreased (-0.624989 --> -0.697359).  Saving model ...
Epoch: 7 cost time: 1.9364373683929443
Epoch: 7, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.802 Vali Acc: 0.724 Test Loss: 0.802 Test Acc: 0.724
Validation loss decreased (-0.697359 --> -0.723676).  Saving model ...
Epoch: 8 cost time: 1.9316372871398926
Epoch: 8, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.749 Vali Acc: 0.757 Test Loss: 0.749 Test Acc: 0.757
Validation loss decreased (-0.723676 --> -0.756571).  Saving model ...
Epoch: 9 cost time: 1.8536970615386963
Epoch: 9, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.667 Vali Acc: 0.730 Test Loss: 0.667 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.785602331161499
Epoch: 10, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.590 Vali Acc: 0.783 Test Loss: 0.590 Test Acc: 0.783
Validation loss decreased (-0.756571 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 2.1105892658233643
Epoch: 11, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.600 Vali Acc: 0.770 Test Loss: 0.600 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0896806716918945
Epoch: 12, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5219473838806152
Epoch: 13, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.641 Vali Acc: 0.704 Test Loss: 0.641 Test Acc: 0.704
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2738687992095947
Epoch: 14, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.630 Vali Acc: 0.750 Test Loss: 0.630 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.522179365158081
Epoch: 15, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 2.4395556449890137
Epoch: 16, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.6381330490112305
Epoch: 17, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.581 Vali Acc: 0.796 Test Loss: 0.581 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 2.2241718769073486
Epoch: 18, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.203068733215332
Epoch: 19, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 20 cost time: 1.683084487915039
Epoch: 20, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 1.702284336090088
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.540 Vali Acc: 0.822 Test Loss: 0.540 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 22 cost time: 1.6616206169128418
Epoch: 22, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.586 Vali Acc: 0.809 Test Loss: 0.586 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.0665040016174316
Epoch: 23, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9575376510620117
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6473932266235352
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.673 Vali Acc: 0.809 Test Loss: 0.673 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.2868919372558594
Epoch: 26, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.668 Vali Acc: 0.809 Test Loss: 0.668 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.5314967632293701
Epoch: 27, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.7117388248443604
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.801 Vali Acc: 0.750 Test Loss: 0.801 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.755824327468872
Epoch: 29, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.2019057273864746
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.634 Vali Acc: 0.809 Test Loss: 0.634 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.0210750102996826
Epoch: 31, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.723 Vali Acc: 0.809 Test Loss: 0.723 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1403956
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.640121698379517
Epoch: 1, Steps: 10 | Train Loss: 1.610 Vali Loss: 1.418 Vali Acc: 0.171 Test Loss: 1.418 Test Acc: 0.171
Validation loss decreased (inf --> -0.171038).  Saving model ...
Epoch: 2 cost time: 2.125821352005005
Epoch: 2, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.405 Vali Acc: 0.316 Test Loss: 1.405 Test Acc: 0.316
Validation loss decreased (-0.171038 --> -0.315775).  Saving model ...
Epoch: 3 cost time: 1.8933815956115723
Epoch: 3, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.306 Vali Acc: 0.382 Test Loss: 1.306 Test Acc: 0.382
Validation loss decreased (-0.315775 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 1.8190574645996094
Epoch: 4, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.234 Vali Acc: 0.592 Test Loss: 1.234 Test Acc: 0.592
Validation loss decreased (-0.381566 --> -0.592093).  Saving model ...
Epoch: 5 cost time: 1.7388050556182861
Epoch: 5, Steps: 10 | Train Loss: 1.116 Vali Loss: 1.093 Vali Acc: 0.625 Test Loss: 1.093 Test Acc: 0.625
Validation loss decreased (-0.592093 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.6011836528778076
Epoch: 6, Steps: 10 | Train Loss: 0.961 Vali Loss: 0.971 Vali Acc: 0.632 Test Loss: 0.971 Test Acc: 0.632
Validation loss decreased (-0.624989 --> -0.631569).  Saving model ...
Epoch: 7 cost time: 1.564267635345459
Epoch: 7, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.872 Vali Acc: 0.632 Test Loss: 0.872 Test Acc: 0.632
Validation loss decreased (-0.631569 --> -0.631570).  Saving model ...
Epoch: 8 cost time: 1.7790639400482178
Epoch: 8, Steps: 10 | Train Loss: 0.629 Vali Loss: 0.738 Vali Acc: 0.717 Test Loss: 0.738 Test Acc: 0.717
Validation loss decreased (-0.631570 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 1.7673656940460205
Epoch: 9, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.669 Vali Acc: 0.704 Test Loss: 0.669 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7133653163909912
Epoch: 10, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.605 Vali Acc: 0.717 Test Loss: 0.605 Test Acc: 0.717
Validation loss decreased (-0.717098 --> -0.717099).  Saving model ...
Epoch: 11 cost time: 1.8304314613342285
Epoch: 11, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.565 Vali Acc: 0.737 Test Loss: 0.565 Test Acc: 0.737
Validation loss decreased (-0.717099 --> -0.736836).  Saving model ...
Epoch: 12 cost time: 1.4414806365966797
Epoch: 12, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.575 Vali Acc: 0.750 Test Loss: 0.575 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.3729429244995117
Epoch: 13, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.552 Vali Acc: 0.743 Test Loss: 0.552 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6496000289916992
Epoch: 14, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
Validation loss decreased (-0.749994 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.6981449127197266
Epoch: 15, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9472334384918213
Epoch: 16, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0647225379943848
Epoch: 17, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.614 Vali Acc: 0.763 Test Loss: 0.614 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7474956512451172
Epoch: 18, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1458208560943604
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.498 Vali Acc: 0.796 Test Loss: 0.498 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 20 cost time: 1.7142541408538818
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.522 Vali Acc: 0.776 Test Loss: 0.522 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9039411544799805
Epoch: 21, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.546 Vali Acc: 0.757 Test Loss: 0.546 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.520268201828003
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.557 Vali Acc: 0.757 Test Loss: 0.557 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8794407844543457
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9832170009613037
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.027275800704956
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.588 Vali Acc: 0.796 Test Loss: 0.588 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.613262414932251
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.632 Vali Acc: 0.750 Test Loss: 0.632 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6893694400787354
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.600 Vali Acc: 0.776 Test Loss: 0.600 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.6446247100830078
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.643 Vali Acc: 0.763 Test Loss: 0.643 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.494307518005371
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 1403572
model size : 6.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8471453189849854
Epoch: 1, Steps: 10 | Train Loss: 1.511 Vali Loss: 1.450 Vali Acc: 0.237 Test Loss: 1.450 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.9119935035705566
Epoch: 2, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.427 Vali Acc: 0.204 Test Loss: 1.427 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.84633469581604
Epoch: 3, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.367 Vali Acc: 0.336 Test Loss: 1.367 Test Acc: 0.336
Validation loss decreased (-0.236828 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 1.716155767440796
Epoch: 4, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.316 Vali Acc: 0.401 Test Loss: 1.316 Test Acc: 0.401
Validation loss decreased (-0.335513 --> -0.401303).  Saving model ...
Epoch: 5 cost time: 2.1623828411102295
Epoch: 5, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.265 Vali Acc: 0.441 Test Loss: 1.265 Test Acc: 0.441
Validation loss decreased (-0.401303 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 2.337841749191284
Epoch: 6, Steps: 10 | Train Loss: 1.124 Vali Loss: 1.187 Vali Acc: 0.480 Test Loss: 1.187 Test Acc: 0.480
Validation loss decreased (-0.440777 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 2.2312545776367188
Epoch: 7, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.115 Vali Acc: 0.533 Test Loss: 1.115 Test Acc: 0.533
Validation loss decreased (-0.480251 --> -0.532884).  Saving model ...
Epoch: 8 cost time: 1.7404184341430664
Epoch: 8, Steps: 10 | Train Loss: 0.869 Vali Loss: 1.020 Vali Acc: 0.618 Test Loss: 1.020 Test Acc: 0.618
Validation loss decreased (-0.532884 --> -0.618411).  Saving model ...
Epoch: 9 cost time: 1.6028659343719482
Epoch: 9, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.930 Vali Acc: 0.599 Test Loss: 0.930 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.526118278503418
Epoch: 10, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.825 Vali Acc: 0.632 Test Loss: 0.825 Test Acc: 0.632
Validation loss decreased (-0.618411 --> -0.631571).  Saving model ...
Epoch: 11 cost time: 1.936622142791748
Epoch: 11, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.830 Vali Acc: 0.664 Test Loss: 0.830 Test Acc: 0.664
Validation loss decreased (-0.631571 --> -0.664465).  Saving model ...
Epoch: 12 cost time: 1.7992734909057617
Epoch: 12, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.707 Vali Acc: 0.724 Test Loss: 0.707 Test Acc: 0.724
Validation loss decreased (-0.664465 --> -0.723677).  Saving model ...
Epoch: 13 cost time: 1.984663724899292
Epoch: 13, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.659 Vali Acc: 0.724 Test Loss: 0.659 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723678).  Saving model ...
Epoch: 14 cost time: 1.9978349208831787
Epoch: 14, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.597 Vali Acc: 0.763 Test Loss: 0.597 Test Acc: 0.763
Validation loss decreased (-0.723678 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.6201701164245605
Epoch: 15, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.591 Vali Acc: 0.743 Test Loss: 0.591 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6637561321258545
Epoch: 16, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.563 Vali Acc: 0.763 Test Loss: 0.563 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.5776169300079346
Epoch: 17, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.713390588760376
Epoch: 18, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.608 Vali Acc: 0.737 Test Loss: 0.608 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9801876544952393
Epoch: 19, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.589 Vali Acc: 0.763 Test Loss: 0.589 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9978430271148682
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8371267318725586
Epoch: 21, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.624 Vali Acc: 0.770 Test Loss: 0.624 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.644355297088623
Epoch: 22, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.601 Vali Acc: 0.796 Test Loss: 0.601 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 1.7581136226654053
Epoch: 23, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.657 Vali Acc: 0.796 Test Loss: 0.657 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9343316555023193
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.647 Vali Acc: 0.796 Test Loss: 0.647 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7382826805114746
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.704 Vali Acc: 0.776 Test Loss: 0.704 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5721030235290527
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.731 Vali Acc: 0.763 Test Loss: 0.731 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.183933973312378
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.749 Vali Acc: 0.776 Test Loss: 0.749 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.731848955154419
Epoch: 28, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.748 Vali Acc: 0.803 Test Loss: 0.748 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 29 cost time: 1.8697099685668945
Epoch: 29, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.834 Vali Acc: 0.776 Test Loss: 0.834 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.610976219177246
Epoch: 30, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.788 Vali Acc: 0.776 Test Loss: 0.788 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7424147129058838
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.768 Vali Acc: 0.789 Test Loss: 0.768 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.773390293121338
Epoch: 32, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.790 Vali Acc: 0.796 Test Loss: 0.790 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.6139404773712158
Epoch: 33, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.994 Vali Acc: 0.789 Test Loss: 0.994 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5448298454284668
Epoch: 34, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.777 Vali Acc: 0.803 Test Loss: 0.777 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.6767277717590332
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.802 Vali Acc: 0.776 Test Loss: 0.802 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.837120771408081
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.794 Vali Acc: 0.796 Test Loss: 0.794 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.8247096538543701
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.838 Vali Acc: 0.789 Test Loss: 0.838 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.8946664333343506
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.881 Vali Acc: 0.789 Test Loss: 0.881 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 942388
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.6106603145599365
Epoch: 1, Steps: 10 | Train Loss: 1.515 Vali Loss: 1.424 Vali Acc: 0.250 Test Loss: 1.424 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 2.2480568885803223
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.398 Vali Acc: 0.243 Test Loss: 1.398 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8989975452423096
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.321 Vali Acc: 0.362 Test Loss: 1.321 Test Acc: 0.362
Validation loss decreased (-0.249986 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 1.6573412418365479
Epoch: 4, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.257 Vali Acc: 0.493 Test Loss: 1.257 Test Acc: 0.493
Validation loss decreased (-0.361829 --> -0.493408).  Saving model ...
Epoch: 5 cost time: 2.314539909362793
Epoch: 5, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.194 Vali Acc: 0.513 Test Loss: 1.194 Test Acc: 0.513
Validation loss decreased (-0.493408 --> -0.513146).  Saving model ...
Epoch: 6 cost time: 2.2881736755371094
Epoch: 6, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.080 Vali Acc: 0.599 Test Loss: 1.080 Test Acc: 0.599
Validation loss decreased (-0.513146 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 1.972848892211914
Epoch: 7, Steps: 10 | Train Loss: 0.960 Vali Loss: 0.983 Vali Acc: 0.612 Test Loss: 0.983 Test Acc: 0.612
Validation loss decreased (-0.598673 --> -0.611832).  Saving model ...
Epoch: 8 cost time: 1.8856477737426758
Epoch: 8, Steps: 10 | Train Loss: 0.875 Vali Loss: 0.912 Vali Acc: 0.638 Test Loss: 0.912 Test Acc: 0.638
Validation loss decreased (-0.611832 --> -0.638149).  Saving model ...
Epoch: 9 cost time: 2.550058126449585
Epoch: 9, Steps: 10 | Train Loss: 0.754 Vali Loss: 0.795 Vali Acc: 0.671 Test Loss: 0.795 Test Acc: 0.671
Validation loss decreased (-0.638149 --> -0.671045).  Saving model ...
Epoch: 10 cost time: 1.8674256801605225
Epoch: 10, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.738 Vali Acc: 0.658 Test Loss: 0.738 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0890145301818848
Epoch: 11, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.650 Vali Acc: 0.743 Test Loss: 0.650 Test Acc: 0.743
Validation loss decreased (-0.671045 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 2.661463975906372
Epoch: 12, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 2.1822526454925537
Epoch: 13, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.614 Vali Acc: 0.770 Test Loss: 0.614 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.436673879623413
Epoch: 14, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.554 Vali Acc: 0.750 Test Loss: 0.554 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.086470603942871
Epoch: 15, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.671 Vali Acc: 0.757 Test Loss: 0.671 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.767890453338623
Epoch: 16, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.606 Vali Acc: 0.770 Test Loss: 0.606 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.071603775024414
Epoch: 17, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.596 Vali Acc: 0.783 Test Loss: 0.596 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.674243688583374
Epoch: 18, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.518 Vali Acc: 0.770 Test Loss: 0.518 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6816892623901367
Epoch: 19, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.515 Vali Acc: 0.816 Test Loss: 0.515 Test Acc: 0.816
Validation loss decreased (-0.782889 --> -0.815784).  Saving model ...
Epoch: 20 cost time: 1.753263235092163
Epoch: 20, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.552 Vali Acc: 0.757 Test Loss: 0.552 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3210442066192627
Epoch: 21, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1139025688171387
Epoch: 22, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.0859904289245605
Epoch: 23, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0492608547210693
Epoch: 24, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.554 Vali Acc: 0.783 Test Loss: 0.554 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.002190589904785
Epoch: 25, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.618 Vali Acc: 0.783 Test Loss: 0.618 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.4305922985076904
Epoch: 26, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.0661375522613525
Epoch: 27, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.358248233795166
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.553 Vali Acc: 0.809 Test Loss: 0.553 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.116053581237793
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.591 Vali Acc: 0.803 Test Loss: 0.591 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 942004
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 5.088557004928589
Epoch: 1, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.351 Vali Acc: 0.322 Test Loss: 1.351 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.6649937629699707
Epoch: 2, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.318 Vali Acc: 0.434 Test Loss: 1.318 Test Acc: 0.434
Validation loss decreased (-0.322355 --> -0.434197).  Saving model ...
Epoch: 3 cost time: 1.6847336292266846
Epoch: 3, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.270 Vali Acc: 0.428 Test Loss: 1.270 Test Acc: 0.428
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0351076126098633
Epoch: 4, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.183 Vali Acc: 0.618 Test Loss: 1.183 Test Acc: 0.618
Validation loss decreased (-0.434197 --> -0.618409).  Saving model ...
Epoch: 5 cost time: 2.0039353370666504
Epoch: 5, Steps: 10 | Train Loss: 1.111 Vali Loss: 1.099 Vali Acc: 0.605 Test Loss: 1.099 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4165899753570557
Epoch: 6, Steps: 10 | Train Loss: 0.975 Vali Loss: 0.980 Vali Acc: 0.678 Test Loss: 0.980 Test Acc: 0.678
Validation loss decreased (-0.618409 --> -0.677622).  Saving model ...
Epoch: 7 cost time: 2.3177483081817627
Epoch: 7, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.879 Vali Acc: 0.678 Test Loss: 0.879 Test Acc: 0.678
Validation loss decreased (-0.677622 --> -0.677623).  Saving model ...
Epoch: 8 cost time: 1.9651696681976318
Epoch: 8, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.772 Vali Acc: 0.724 Test Loss: 0.772 Test Acc: 0.724
Validation loss decreased (-0.677623 --> -0.723676).  Saving model ...
Epoch: 9 cost time: 1.9493470191955566
Epoch: 9, Steps: 10 | Train Loss: 0.535 Vali Loss: 0.691 Vali Acc: 0.743 Test Loss: 0.691 Test Acc: 0.743
Validation loss decreased (-0.723676 --> -0.743414).  Saving model ...
Epoch: 10 cost time: 1.9366154670715332
Epoch: 10, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.633 Vali Acc: 0.763 Test Loss: 0.633 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.9131743907928467
Epoch: 11, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6477582454681396
Epoch: 12, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.986957311630249
Epoch: 13, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782888).  Saving model ...
Epoch: 14 cost time: 1.9249975681304932
Epoch: 14, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.5995802879333496
Epoch: 15, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.572 Vali Acc: 0.809 Test Loss: 0.572 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809205).  Saving model ...
Epoch: 16 cost time: 1.8360869884490967
Epoch: 16, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9623162746429443
Epoch: 17, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.005805253982544
Epoch: 18, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.546 Vali Acc: 0.757 Test Loss: 0.546 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.946702003479004
Epoch: 19, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.188901901245117
Epoch: 20, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1879806518554688
Epoch: 21, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7866787910461426
Epoch: 22, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9772999286651611
Epoch: 23, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.9409167766571045
Epoch: 24, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.634 Vali Acc: 0.763 Test Loss: 0.634 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0132017135620117
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.689 Vali Acc: 0.776 Test Loss: 0.689 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 941620
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.663211822509766
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.385 Vali Acc: 0.257 Test Loss: 1.385 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.886429786682129
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.355 Vali Acc: 0.336 Test Loss: 1.355 Test Acc: 0.336
Validation loss decreased (-0.256565 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.883457899093628
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.297 Vali Acc: 0.382 Test Loss: 1.297 Test Acc: 0.382
Validation loss decreased (-0.335513 --> -0.381566).  Saving model ...
Epoch: 4 cost time: 1.6307191848754883
Epoch: 4, Steps: 10 | Train Loss: 1.234 Vali Loss: 1.227 Vali Acc: 0.428 Test Loss: 1.227 Test Acc: 0.428
Validation loss decreased (-0.381566 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 1.8759403228759766
Epoch: 5, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.145 Vali Acc: 0.500 Test Loss: 1.145 Test Acc: 0.500
Validation loss decreased (-0.427619 --> -0.499989).  Saving model ...
Epoch: 6 cost time: 2.0563695430755615
Epoch: 6, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.059 Vali Acc: 0.520 Test Loss: 1.059 Test Acc: 0.520
Validation loss decreased (-0.499989 --> -0.519726).  Saving model ...
Epoch: 7 cost time: 1.6330914497375488
Epoch: 7, Steps: 10 | Train Loss: 0.857 Vali Loss: 0.947 Vali Acc: 0.572 Test Loss: 0.947 Test Acc: 0.572
Validation loss decreased (-0.519726 --> -0.572359).  Saving model ...
Epoch: 8 cost time: 1.3525440692901611
Epoch: 8, Steps: 10 | Train Loss: 0.772 Vali Loss: 0.861 Vali Acc: 0.612 Test Loss: 0.861 Test Acc: 0.612
Validation loss decreased (-0.572359 --> -0.611833).  Saving model ...
Epoch: 9 cost time: 1.871253490447998
Epoch: 9, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.751 Vali Acc: 0.671 Test Loss: 0.751 Test Acc: 0.671
Validation loss decreased (-0.611833 --> -0.671045).  Saving model ...
Epoch: 10 cost time: 2.314039707183838
Epoch: 10, Steps: 10 | Train Loss: 0.545 Vali Loss: 0.739 Vali Acc: 0.704 Test Loss: 0.739 Test Acc: 0.704
Validation loss decreased (-0.671045 --> -0.703940).  Saving model ...
Epoch: 11 cost time: 1.9432802200317383
Epoch: 11, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.670 Vali Acc: 0.737 Test Loss: 0.670 Test Acc: 0.737
Validation loss decreased (-0.703940 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 1.9106693267822266
Epoch: 12, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.630 Vali Acc: 0.757 Test Loss: 0.630 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.647763967514038
Epoch: 13, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8011500835418701
Epoch: 14, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.7294552326202393
Epoch: 15, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5689027309417725
Epoch: 16, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.747 Vali Acc: 0.704 Test Loss: 0.747 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8117947578430176
Epoch: 17, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.518 Vali Acc: 0.809 Test Loss: 0.518 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.5487391948699951
Epoch: 18, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.554 Vali Acc: 0.750 Test Loss: 0.554 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8680198192596436
Epoch: 19, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.565 Vali Acc: 0.789 Test Loss: 0.565 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.410017967224121
Epoch: 20, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.620 Vali Acc: 0.770 Test Loss: 0.620 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.832854986190796
Epoch: 21, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2251274585723877
Epoch: 22, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.641 Vali Acc: 0.763 Test Loss: 0.641 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.1192476749420166
Epoch: 23, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.627262830734253
Epoch: 24, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.622 Vali Acc: 0.789 Test Loss: 0.622 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8866043090820312
Epoch: 25, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.590 Vali Acc: 0.796 Test Loss: 0.590 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.380711078643799
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.641 Vali Acc: 0.789 Test Loss: 0.641 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.099606513977051
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.636 Vali Acc: 0.796 Test Loss: 0.636 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 941236
model size : 4.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.015199661254883
Epoch: 1, Steps: 10 | Train Loss: 1.619 Vali Loss: 1.414 Vali Acc: 0.197 Test Loss: 1.414 Test Acc: 0.197
Validation loss decreased (inf --> -0.197354).  Saving model ...
Epoch: 2 cost time: 1.7945384979248047
Epoch: 2, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.419 Vali Acc: 0.296 Test Loss: 1.419 Test Acc: 0.296
Validation loss decreased (-0.197354 --> -0.296038).  Saving model ...
Epoch: 3 cost time: 1.9270975589752197
Epoch: 3, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.334 Vali Acc: 0.342 Test Loss: 1.334 Test Acc: 0.342
Validation loss decreased (-0.296038 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.5927801132202148
Epoch: 4, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.261 Vali Acc: 0.487 Test Loss: 1.261 Test Acc: 0.487
Validation loss decreased (-0.342092 --> -0.486829).  Saving model ...
Epoch: 5 cost time: 1.7615795135498047
Epoch: 5, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.187 Vali Acc: 0.572 Test Loss: 1.187 Test Acc: 0.572
Validation loss decreased (-0.486829 --> -0.572357).  Saving model ...
Epoch: 6 cost time: 1.7320451736450195
Epoch: 6, Steps: 10 | Train Loss: 1.137 Vali Loss: 1.111 Vali Acc: 0.618 Test Loss: 1.111 Test Acc: 0.618
Validation loss decreased (-0.572357 --> -0.618410).  Saving model ...
Epoch: 7 cost time: 2.0425732135772705
Epoch: 7, Steps: 10 | Train Loss: 0.964 Vali Loss: 0.991 Vali Acc: 0.605 Test Loss: 0.991 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.953838586807251
Epoch: 8, Steps: 10 | Train Loss: 0.849 Vali Loss: 0.898 Vali Acc: 0.651 Test Loss: 0.898 Test Acc: 0.651
Validation loss decreased (-0.618410 --> -0.651307).  Saving model ...
Epoch: 9 cost time: 2.1952404975891113
Epoch: 9, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.772 Vali Acc: 0.684 Test Loss: 0.772 Test Acc: 0.684
Validation loss decreased (-0.651307 --> -0.684203).  Saving model ...
Epoch: 10 cost time: 1.9424214363098145
Epoch: 10, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.697 Vali Acc: 0.730 Test Loss: 0.697 Test Acc: 0.730
Validation loss decreased (-0.684203 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.7515332698822021
Epoch: 11, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.655 Vali Acc: 0.737 Test Loss: 0.655 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 12 cost time: 2.2552027702331543
Epoch: 12, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.605 Vali Acc: 0.770 Test Loss: 0.605 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.9155418872833252
Epoch: 13, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.652 Vali Acc: 0.704 Test Loss: 0.652 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.834099531173706
Epoch: 14, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.564 Vali Acc: 0.743 Test Loss: 0.564 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.120142936706543
Epoch: 15, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.537 Vali Acc: 0.763 Test Loss: 0.537 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.186466693878174
Epoch: 16, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.794684886932373
Epoch: 17, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.501 Vali Acc: 0.809 Test Loss: 0.501 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809206).  Saving model ...
Epoch: 18 cost time: 1.8194448947906494
Epoch: 18, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.506 Vali Acc: 0.770 Test Loss: 0.506 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3429007530212402
Epoch: 19, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6300976276397705
Epoch: 20, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.534 Vali Acc: 0.757 Test Loss: 0.534 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8944129943847656
Epoch: 21, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.539 Vali Acc: 0.796 Test Loss: 0.539 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.073887825012207
Epoch: 22, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.713285207748413
Epoch: 23, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4460346698760986
Epoch: 24, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.610 Vali Acc: 0.776 Test Loss: 0.610 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.280932903289795
Epoch: 25, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0277717113494873
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.604 Vali Acc: 0.803 Test Loss: 0.604 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.3358426094055176
Epoch: 27, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.611 Vali Acc: 0.796 Test Loss: 0.611 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 711220
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.6984498500823975
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.422 Vali Acc: 0.237 Test Loss: 1.422 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.4870259761810303
Epoch: 2, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.409 Vali Acc: 0.296 Test Loss: 1.409 Test Acc: 0.296
Validation loss decreased (-0.236828 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.9145991802215576
Epoch: 3, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.359 Vali Acc: 0.362 Test Loss: 1.359 Test Acc: 0.362
Validation loss decreased (-0.296039 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 1.7930598258972168
Epoch: 4, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.312 Vali Acc: 0.349 Test Loss: 1.312 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5444021224975586
Epoch: 5, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.279 Vali Acc: 0.480 Test Loss: 1.279 Test Acc: 0.480
Validation loss decreased (-0.361829 --> -0.480250).  Saving model ...
Epoch: 6 cost time: 1.9799840450286865
Epoch: 6, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.190 Vali Acc: 0.513 Test Loss: 1.190 Test Acc: 0.513
Validation loss decreased (-0.480250 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 1.7363548278808594
Epoch: 7, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.127 Vali Acc: 0.592 Test Loss: 1.127 Test Acc: 0.592
Validation loss decreased (-0.513146 --> -0.592094).  Saving model ...
Epoch: 8 cost time: 2.1470634937286377
Epoch: 8, Steps: 10 | Train Loss: 0.924 Vali Loss: 1.018 Vali Acc: 0.612 Test Loss: 1.018 Test Acc: 0.612
Validation loss decreased (-0.592094 --> -0.611832).  Saving model ...
Epoch: 9 cost time: 2.5959646701812744
Epoch: 9, Steps: 10 | Train Loss: 0.795 Vali Loss: 0.919 Vali Acc: 0.632 Test Loss: 0.919 Test Acc: 0.632
Validation loss decreased (-0.611832 --> -0.631570).  Saving model ...
Epoch: 10 cost time: 1.8433616161346436
Epoch: 10, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.833 Vali Acc: 0.651 Test Loss: 0.833 Test Acc: 0.651
Validation loss decreased (-0.631570 --> -0.651307).  Saving model ...
Epoch: 11 cost time: 1.7505886554718018
Epoch: 11, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.742 Vali Acc: 0.671 Test Loss: 0.742 Test Acc: 0.671
Validation loss decreased (-0.651307 --> -0.671045).  Saving model ...
Epoch: 12 cost time: 1.8767879009246826
Epoch: 12, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.723 Vali Acc: 0.697 Test Loss: 0.723 Test Acc: 0.697
Validation loss decreased (-0.671045 --> -0.697361).  Saving model ...
Epoch: 13 cost time: 2.076882839202881
Epoch: 13, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.674 Vali Acc: 0.717 Test Loss: 0.674 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717099).  Saving model ...
Epoch: 14 cost time: 2.4239118099212646
Epoch: 14, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.620 Vali Acc: 0.743 Test Loss: 0.620 Test Acc: 0.743
Validation loss decreased (-0.717099 --> -0.743415).  Saving model ...
Epoch: 15 cost time: 2.3789985179901123
Epoch: 15, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.613 Vali Acc: 0.743 Test Loss: 0.613 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 16 cost time: 2.0494725704193115
Epoch: 16, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.589 Vali Acc: 0.737 Test Loss: 0.589 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.106522560119629
Epoch: 17, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.596 Vali Acc: 0.770 Test Loss: 0.596 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 18 cost time: 1.8366804122924805
Epoch: 18, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.636 Vali Acc: 0.743 Test Loss: 0.636 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8574960231781006
Epoch: 19, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 2.2699615955352783
Epoch: 20, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.621 Vali Acc: 0.770 Test Loss: 0.621 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.174915313720703
Epoch: 21, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.585 Vali Acc: 0.783 Test Loss: 0.585 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 22 cost time: 1.8142976760864258
Epoch: 22, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.606 Vali Acc: 0.783 Test Loss: 0.606 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.591313362121582
Epoch: 23, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.608 Vali Acc: 0.809 Test Loss: 0.608 Test Acc: 0.809
Validation loss decreased (-0.782889 --> -0.809204).  Saving model ...
Epoch: 24 cost time: 1.917017936706543
Epoch: 24, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.594 Vali Acc: 0.776 Test Loss: 0.594 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.136383056640625
Epoch: 25, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.044951915740967
Epoch: 26, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.631 Vali Acc: 0.757 Test Loss: 0.631 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7126328945159912
Epoch: 27, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.722 Vali Acc: 0.796 Test Loss: 0.722 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.2214910984039307
Epoch: 28, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.693 Vali Acc: 0.770 Test Loss: 0.693 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.2234556674957275
Epoch: 29, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.671 Vali Acc: 0.789 Test Loss: 0.671 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7606756687164307
Epoch: 30, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.729 Vali Acc: 0.796 Test Loss: 0.729 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.0675547122955322
Epoch: 31, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.743 Vali Acc: 0.763 Test Loss: 0.743 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.917738437652588
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.745 Vali Acc: 0.776 Test Loss: 0.745 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.106513738632202
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.759 Vali Acc: 0.789 Test Loss: 0.759 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 710836
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.0722105503082275
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.399 Vali Acc: 0.329 Test Loss: 1.399 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 1.8868272304534912
Epoch: 2, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.361 Vali Acc: 0.336 Test Loss: 1.361 Test Acc: 0.336
Validation loss decreased (-0.328933 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.880448579788208
Epoch: 3, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.317 Vali Acc: 0.395 Test Loss: 1.317 Test Acc: 0.395
Validation loss decreased (-0.335513 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 1.9859390258789062
Epoch: 4, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.253 Vali Acc: 0.526 Test Loss: 1.253 Test Acc: 0.526
Validation loss decreased (-0.394724 --> -0.526303).  Saving model ...
Epoch: 5 cost time: 1.778723955154419
Epoch: 5, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.196 Vali Acc: 0.513 Test Loss: 1.196 Test Acc: 0.513
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6389155387878418
Epoch: 6, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.105 Vali Acc: 0.599 Test Loss: 1.105 Test Acc: 0.599
Validation loss decreased (-0.526303 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 1.8197972774505615
Epoch: 7, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.005 Vali Acc: 0.625 Test Loss: 1.005 Test Acc: 0.625
Validation loss decreased (-0.598673 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 1.9015398025512695
Epoch: 8, Steps: 10 | Train Loss: 0.886 Vali Loss: 0.915 Vali Acc: 0.645 Test Loss: 0.915 Test Acc: 0.645
Validation loss decreased (-0.624990 --> -0.644728).  Saving model ...
Epoch: 9 cost time: 1.7940921783447266
Epoch: 9, Steps: 10 | Train Loss: 0.715 Vali Loss: 0.797 Vali Acc: 0.678 Test Loss: 0.797 Test Acc: 0.678
Validation loss decreased (-0.644728 --> -0.677624).  Saving model ...
Epoch: 10 cost time: 1.7745800018310547
Epoch: 10, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.716 Vali Acc: 0.724 Test Loss: 0.716 Test Acc: 0.724
Validation loss decreased (-0.677624 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 1.7134764194488525
Epoch: 11, Steps: 10 | Train Loss: 0.520 Vali Loss: 0.650 Vali Acc: 0.743 Test Loss: 0.650 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.6787481307983398
Epoch: 12, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
Validation loss decreased (-0.743415 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.7577941417694092
Epoch: 13, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.547 Vali Acc: 0.776 Test Loss: 0.547 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5536754131317139
Epoch: 14, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.6862642765045166
Epoch: 15, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.499 Vali Acc: 0.776 Test Loss: 0.499 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9036719799041748
Epoch: 16, Steps: 10 | Train Loss: 0.213 Vali Loss: 0.488 Vali Acc: 0.776 Test Loss: 0.488 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.674593210220337
Epoch: 17, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.491 Vali Acc: 0.783 Test Loss: 0.491 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4931211471557617
Epoch: 18, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.467 Vali Acc: 0.783 Test Loss: 0.467 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8880746364593506
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.475 Vali Acc: 0.803 Test Loss: 0.475 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802627).  Saving model ...
Epoch: 20 cost time: 1.565760850906372
Epoch: 20, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.476 Vali Acc: 0.796 Test Loss: 0.476 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4954872131347656
Epoch: 21, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.482 Vali Acc: 0.816 Test Loss: 0.482 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815785).  Saving model ...
Epoch: 22 cost time: 2.077709674835205
Epoch: 22, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.19215726852417
Epoch: 23, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.155869722366333
Epoch: 24, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9924554824829102
Epoch: 25, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8279664516448975
Epoch: 26, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4783952236175537
Epoch: 27, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.490 Vali Acc: 0.822 Test Loss: 0.490 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 28 cost time: 2.2071118354797363
Epoch: 28, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5440332889556885
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.8720016479492188
Epoch: 30, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7070941925048828
Epoch: 31, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7014641761779785
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.622 Vali Acc: 0.822 Test Loss: 0.622 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.320931911468506
Epoch: 33, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.635 Vali Acc: 0.822 Test Loss: 0.635 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.7131102085113525
Epoch: 34, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.665 Vali Acc: 0.822 Test Loss: 0.665 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.4122321605682373
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.667 Vali Acc: 0.822 Test Loss: 0.667 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.5309300422668457
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.686 Vali Acc: 0.816 Test Loss: 0.686 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.8497459888458252
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.696 Vali Acc: 0.809 Test Loss: 0.696 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 710452
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7161335945129395
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.363 Vali Acc: 0.355 Test Loss: 1.363 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.9520957469940186
Epoch: 2, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.331 Vali Acc: 0.349 Test Loss: 1.331 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1917028427124023
Epoch: 3, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.287 Vali Acc: 0.467 Test Loss: 1.287 Test Acc: 0.467
Validation loss decreased (-0.355250 --> -0.467092).  Saving model ...
Epoch: 4 cost time: 2.1607861518859863
Epoch: 4, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.224 Vali Acc: 0.586 Test Loss: 1.224 Test Acc: 0.586
Validation loss decreased (-0.467092 --> -0.585514).  Saving model ...
Epoch: 5 cost time: 2.0020835399627686
Epoch: 5, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.154 Vali Acc: 0.579 Test Loss: 1.154 Test Acc: 0.579
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9282512664794922
Epoch: 6, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.065 Vali Acc: 0.592 Test Loss: 1.065 Test Acc: 0.592
Validation loss decreased (-0.585514 --> -0.592095).  Saving model ...
Epoch: 7 cost time: 2.2011284828186035
Epoch: 7, Steps: 10 | Train Loss: 0.943 Vali Loss: 0.973 Vali Acc: 0.658 Test Loss: 0.973 Test Acc: 0.658
Validation loss decreased (-0.592095 --> -0.657885).  Saving model ...
Epoch: 8 cost time: 2.137826919555664
Epoch: 8, Steps: 10 | Train Loss: 0.839 Vali Loss: 0.875 Vali Acc: 0.638 Test Loss: 0.875 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3518543243408203
Epoch: 9, Steps: 10 | Train Loss: 0.652 Vali Loss: 0.783 Vali Acc: 0.678 Test Loss: 0.783 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677624).  Saving model ...
Epoch: 10 cost time: 2.340447187423706
Epoch: 10, Steps: 10 | Train Loss: 0.560 Vali Loss: 0.721 Vali Acc: 0.717 Test Loss: 0.721 Test Acc: 0.717
Validation loss decreased (-0.677624 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.51499605178833
Epoch: 11, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.662 Vali Acc: 0.737 Test Loss: 0.662 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 2.742767333984375
Epoch: 12, Steps: 10 | Train Loss: 0.403 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 2.0082242488861084
Epoch: 13, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.9001092910766602
Epoch: 14, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9230964183807373
Epoch: 15, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.614 Vali Acc: 0.750 Test Loss: 0.614 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7518279552459717
Epoch: 16, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.580 Vali Acc: 0.730 Test Loss: 0.580 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6827328205108643
Epoch: 17, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.8871040344238281
Epoch: 18, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.477203130722046
Epoch: 19, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.922638177871704
Epoch: 20, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.0262465476989746
Epoch: 21, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.534 Vali Acc: 0.770 Test Loss: 0.534 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.639775276184082
Epoch: 22, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.557 Vali Acc: 0.776 Test Loss: 0.557 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5194976329803467
Epoch: 23, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7080025672912598
Epoch: 24, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.583 Vali Acc: 0.789 Test Loss: 0.583 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 25 cost time: 1.7586400508880615
Epoch: 25, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.518737554550171
Epoch: 26, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.675 Vali Acc: 0.776 Test Loss: 0.675 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.5019216537475586
Epoch: 27, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.021432876586914
Epoch: 28, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.644 Vali Acc: 0.783 Test Loss: 0.644 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8580162525177002
Epoch: 29, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.188969612121582
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.631 Vali Acc: 0.783 Test Loss: 0.631 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8726866245269775
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.684 Vali Acc: 0.809 Test Loss: 0.684 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809204).  Saving model ...
Epoch: 32 cost time: 1.6943635940551758
Epoch: 32, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.712 Vali Acc: 0.770 Test Loss: 0.712 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9506478309631348
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.684 Vali Acc: 0.763 Test Loss: 0.684 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.1879961490631104
Epoch: 34, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.703 Vali Acc: 0.783 Test Loss: 0.703 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7029199600219727
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.721 Vali Acc: 0.783 Test Loss: 0.721 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.0402233600616455
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.736 Vali Acc: 0.789 Test Loss: 0.736 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.083263635635376
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.783 Vali Acc: 0.783 Test Loss: 0.783 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.3861277103424072
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.776 Vali Acc: 0.789 Test Loss: 0.776 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.9708633422851562
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.768 Vali Acc: 0.789 Test Loss: 0.768 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.2734031677246094
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.794 Vali Acc: 0.789 Test Loss: 0.794 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.382328510284424
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.803 Vali Acc: 0.783 Test Loss: 0.803 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 710068
model size : 4.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.915249347686768
Epoch: 1, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.390 Vali Acc: 0.349 Test Loss: 1.390 Test Acc: 0.349
Validation loss decreased (inf --> -0.348670).  Saving model ...
Epoch: 2 cost time: 1.7915184497833252
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.361 Vali Acc: 0.322 Test Loss: 1.361 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.658167839050293
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.311 Vali Acc: 0.362 Test Loss: 1.311 Test Acc: 0.362
Validation loss decreased (-0.348670 --> -0.361829).  Saving model ...
Epoch: 4 cost time: 1.8181920051574707
Epoch: 4, Steps: 10 | Train Loss: 1.252 Vali Loss: 1.258 Vali Acc: 0.526 Test Loss: 1.258 Test Acc: 0.526
Validation loss decreased (-0.361829 --> -0.526303).  Saving model ...
Epoch: 5 cost time: 1.5910000801086426
Epoch: 5, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.196 Vali Acc: 0.539 Test Loss: 1.196 Test Acc: 0.539
Validation loss decreased (-0.526303 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 1.7409577369689941
Epoch: 6, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.145 Vali Acc: 0.586 Test Loss: 1.145 Test Acc: 0.586
Validation loss decreased (-0.539462 --> -0.585515).  Saving model ...
Epoch: 7 cost time: 2.289358615875244
Epoch: 7, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.035 Vali Acc: 0.632 Test Loss: 1.035 Test Acc: 0.632
Validation loss decreased (-0.585515 --> -0.631569).  Saving model ...
Epoch: 8 cost time: 1.7025835514068604
Epoch: 8, Steps: 10 | Train Loss: 0.900 Vali Loss: 0.972 Vali Acc: 0.632 Test Loss: 0.972 Test Acc: 0.632
Validation loss decreased (-0.631569 --> -0.631569).  Saving model ...
Epoch: 9 cost time: 1.961613416671753
Epoch: 9, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.874 Vali Acc: 0.638 Test Loss: 0.874 Test Acc: 0.638
Validation loss decreased (-0.631569 --> -0.638149).  Saving model ...
Epoch: 10 cost time: 1.9162774085998535
Epoch: 10, Steps: 10 | Train Loss: 0.674 Vali Loss: 0.792 Vali Acc: 0.724 Test Loss: 0.792 Test Acc: 0.724
Validation loss decreased (-0.638149 --> -0.723676).  Saving model ...
Epoch: 11 cost time: 2.250760555267334
Epoch: 11, Steps: 10 | Train Loss: 0.596 Vali Loss: 0.761 Vali Acc: 0.691 Test Loss: 0.761 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9728221893310547
Epoch: 12, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.673 Vali Acc: 0.750 Test Loss: 0.673 Test Acc: 0.750
Validation loss decreased (-0.723676 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 2.539867401123047
Epoch: 13, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.634 Vali Acc: 0.763 Test Loss: 0.634 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 1.441612720489502
Epoch: 14, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.607 Vali Acc: 0.757 Test Loss: 0.607 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0308704376220703
Epoch: 15, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.580 Vali Acc: 0.783 Test Loss: 0.580 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.8663101196289062
Epoch: 16, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.372642993927002
Epoch: 17, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.568 Vali Acc: 0.770 Test Loss: 0.568 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5383388996124268
Epoch: 18, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.547 Vali Acc: 0.796 Test Loss: 0.547 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 1.8364884853363037
Epoch: 19, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.509 Vali Acc: 0.789 Test Loss: 0.509 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5226311683654785
Epoch: 20, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.540 Vali Acc: 0.776 Test Loss: 0.540 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6845712661743164
Epoch: 21, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.6994903087615967
Epoch: 22, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 1.8176779747009277
Epoch: 23, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8318183422088623
Epoch: 24, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.149747133255005
Epoch: 25, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.549 Vali Acc: 0.796 Test Loss: 0.549 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6935040950775146
Epoch: 26, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.586 Vali Acc: 0.789 Test Loss: 0.586 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9932098388671875
Epoch: 27, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 28 cost time: 1.6675453186035156
Epoch: 28, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.605 Vali Acc: 0.796 Test Loss: 0.605 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8712635040283203
Epoch: 29, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.2203619480133057
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.594 Vali Acc: 0.816 Test Loss: 0.594 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 31 cost time: 1.8016083240509033
Epoch: 31, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.630 Vali Acc: 0.789 Test Loss: 0.630 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.2095930576324463
Epoch: 32, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.608 Vali Acc: 0.796 Test Loss: 0.608 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.312657117843628
Epoch: 33, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.1264538764953613
Epoch: 34, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.2945034503936768
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.677 Vali Acc: 0.809 Test Loss: 0.677 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.895172119140625
Epoch: 36, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.669 Vali Acc: 0.809 Test Loss: 0.669 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.2493460178375244
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.717 Vali Acc: 0.789 Test Loss: 0.717 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.7755191326141357
Epoch: 38, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.731 Vali Acc: 0.796 Test Loss: 0.731 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8301730155944824
Epoch: 39, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.734 Vali Acc: 0.816 Test Loss: 0.734 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.7783374786376953
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.773 Vali Acc: 0.783 Test Loss: 0.773 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 595636
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.175463914871216
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.378 Vali Acc: 0.283 Test Loss: 1.378 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.9024758338928223
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.349 Vali Acc: 0.316 Test Loss: 1.349 Test Acc: 0.316
Validation loss decreased (-0.282881 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.8394992351531982
Epoch: 3, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.297 Vali Acc: 0.388 Test Loss: 1.297 Test Acc: 0.388
Validation loss decreased (-0.315776 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 2.0940306186676025
Epoch: 4, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.252 Vali Acc: 0.434 Test Loss: 1.252 Test Acc: 0.434
Validation loss decreased (-0.388145 --> -0.434198).  Saving model ...
Epoch: 5 cost time: 1.725297451019287
Epoch: 5, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.178 Vali Acc: 0.539 Test Loss: 1.178 Test Acc: 0.539
Validation loss decreased (-0.434198 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 2.3320133686065674
Epoch: 6, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.106 Vali Acc: 0.592 Test Loss: 1.106 Test Acc: 0.592
Validation loss decreased (-0.539462 --> -0.592094).  Saving model ...
Epoch: 7 cost time: 1.924621343612671
Epoch: 7, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.006 Vali Acc: 0.618 Test Loss: 1.006 Test Acc: 0.618
Validation loss decreased (-0.592094 --> -0.618411).  Saving model ...
Epoch: 8 cost time: 1.7057650089263916
Epoch: 8, Steps: 10 | Train Loss: 0.821 Vali Loss: 0.930 Vali Acc: 0.645 Test Loss: 0.930 Test Acc: 0.645
Validation loss decreased (-0.618411 --> -0.644728).  Saving model ...
Epoch: 9 cost time: 1.6050467491149902
Epoch: 9, Steps: 10 | Train Loss: 0.741 Vali Loss: 0.835 Vali Acc: 0.671 Test Loss: 0.835 Test Acc: 0.671
Validation loss decreased (-0.644728 --> -0.671044).  Saving model ...
Epoch: 10 cost time: 1.9327995777130127
Epoch: 10, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.752 Vali Acc: 0.724 Test Loss: 0.752 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 1.7367215156555176
Epoch: 11, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.730 Vali Acc: 0.711 Test Loss: 0.730 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0376932621002197
Epoch: 12, Steps: 10 | Train Loss: 0.459 Vali Loss: 0.662 Vali Acc: 0.717 Test Loss: 0.662 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3445169925689697
Epoch: 13, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.701 Vali Acc: 0.711 Test Loss: 0.701 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.2855288982391357
Epoch: 14, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.651 Vali Acc: 0.730 Test Loss: 0.651 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730257).  Saving model ...
Epoch: 15 cost time: 1.8734314441680908
Epoch: 15, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.688 Vali Acc: 0.730 Test Loss: 0.688 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.8464720249176025
Epoch: 16, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.648 Vali Acc: 0.776 Test Loss: 0.648 Test Acc: 0.776
Validation loss decreased (-0.730257 --> -0.776309).  Saving model ...
Epoch: 17 cost time: 2.39397931098938
Epoch: 17, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.566 Vali Acc: 0.770 Test Loss: 0.566 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1094970703125
Epoch: 18, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.159818649291992
Epoch: 19, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.514 Vali Acc: 0.770 Test Loss: 0.514 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.515867233276367
Epoch: 20, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.518 Vali Acc: 0.770 Test Loss: 0.518 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.917163610458374
Epoch: 21, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1862316131591797
Epoch: 22, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.546 Vali Acc: 0.770 Test Loss: 0.546 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.169482707977295
Epoch: 23, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.543 Vali Acc: 0.776 Test Loss: 0.543 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 1.8773612976074219
Epoch: 24, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.0481207370758057
Epoch: 25, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 26 cost time: 3.0728321075439453
Epoch: 26, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.578 Vali Acc: 0.770 Test Loss: 0.578 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.51277494430542
Epoch: 27, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.552 Vali Acc: 0.770 Test Loss: 0.552 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.327955961227417
Epoch: 28, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.9954607486724854
Epoch: 29, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.2898216247558594
Epoch: 30, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 31 cost time: 2.6603739261627197
Epoch: 31, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.620 Vali Acc: 0.783 Test Loss: 0.620 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.1991591453552246
Epoch: 32, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.835523843765259
Epoch: 33, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.714 Vali Acc: 0.770 Test Loss: 0.714 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.385749101638794
Epoch: 34, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.657 Vali Acc: 0.783 Test Loss: 0.657 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.843141794204712
Epoch: 35, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.601 Vali Acc: 0.783 Test Loss: 0.601 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.4688494205474854
Epoch: 36, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.662 Vali Acc: 0.776 Test Loss: 0.662 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.4312636852264404
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.626 Vali Acc: 0.796 Test Loss: 0.626 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.43992018699646
Epoch: 38, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.7402992248535156
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.622 Vali Acc: 0.816 Test Loss: 0.622 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815783).  Saving model ...
Epoch: 40 cost time: 2.2838521003723145
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.720 Vali Acc: 0.789 Test Loss: 0.720 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.007084846496582
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.725 Vali Acc: 0.796 Test Loss: 0.725 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.293513536453247
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.701 Vali Acc: 0.809 Test Loss: 0.701 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 2.104966640472412
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.732 Vali Acc: 0.796 Test Loss: 0.732 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.7558751106262207
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.721 Vali Acc: 0.803 Test Loss: 0.721 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.6312360763549805
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.750 Vali Acc: 0.803 Test Loss: 0.750 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 2.1231601238250732
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.713 Vali Acc: 0.809 Test Loss: 0.713 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.3809406757354736
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.773 Vali Acc: 0.803 Test Loss: 0.773 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.037106990814209
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.757 Vali Acc: 0.803 Test Loss: 0.757 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.4624693393707275
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.737 Vali Acc: 0.803 Test Loss: 0.737 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 595252
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.692677736282349
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.434 Vali Acc: 0.336 Test Loss: 1.434 Test Acc: 0.336
Validation loss decreased (inf --> -0.335512).  Saving model ...
Epoch: 2 cost time: 2.311774253845215
Epoch: 2, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.358 Vali Acc: 0.309 Test Loss: 1.358 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8100628852844238
Epoch: 3, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.320 Vali Acc: 0.401 Test Loss: 1.320 Test Acc: 0.401
Validation loss decreased (-0.335512 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 1.7766931056976318
Epoch: 4, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.275 Vali Acc: 0.474 Test Loss: 1.275 Test Acc: 0.474
Validation loss decreased (-0.401303 --> -0.473671).  Saving model ...
Epoch: 5 cost time: 1.4869685173034668
Epoch: 5, Steps: 10 | Train Loss: 1.173 Vali Loss: 1.212 Vali Acc: 0.539 Test Loss: 1.212 Test Acc: 0.539
Validation loss decreased (-0.473671 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 1.9668574333190918
Epoch: 6, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.141 Vali Acc: 0.566 Test Loss: 1.141 Test Acc: 0.566
Validation loss decreased (-0.539462 --> -0.565778).  Saving model ...
Epoch: 7 cost time: 2.3059632778167725
Epoch: 7, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.053 Vali Acc: 0.579 Test Loss: 1.053 Test Acc: 0.579
Validation loss decreased (-0.565778 --> -0.578937).  Saving model ...
Epoch: 8 cost time: 1.8191742897033691
Epoch: 8, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.955 Vali Acc: 0.625 Test Loss: 0.955 Test Acc: 0.625
Validation loss decreased (-0.578937 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 1.5444097518920898
Epoch: 9, Steps: 10 | Train Loss: 0.722 Vali Loss: 0.893 Vali Acc: 0.605 Test Loss: 0.893 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7240536212921143
Epoch: 10, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.787 Vali Acc: 0.691 Test Loss: 0.787 Test Acc: 0.691
Validation loss decreased (-0.624990 --> -0.690782).  Saving model ...
Epoch: 11 cost time: 2.2280209064483643
Epoch: 11, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.742 Vali Acc: 0.684 Test Loss: 0.742 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9285955429077148
Epoch: 12, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.680 Vali Acc: 0.717 Test Loss: 0.680 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 13 cost time: 1.4566049575805664
Epoch: 13, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.634 Vali Acc: 0.743 Test Loss: 0.634 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743415).  Saving model ...
Epoch: 14 cost time: 1.9690310955047607
Epoch: 14, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.630 Vali Acc: 0.737 Test Loss: 0.630 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3779189586639404
Epoch: 15, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.85715913772583
Epoch: 16, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.571 Vali Acc: 0.743 Test Loss: 0.571 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 17 cost time: 2.085491895675659
Epoch: 17, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.569 Vali Acc: 0.750 Test Loss: 0.569 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 1.5660369396209717
Epoch: 18, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.548 Vali Acc: 0.757 Test Loss: 0.548 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 19 cost time: 1.7933597564697266
Epoch: 19, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.559 Vali Acc: 0.757 Test Loss: 0.559 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.285982608795166
Epoch: 20, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.568 Vali Acc: 0.750 Test Loss: 0.568 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.9872446060180664
Epoch: 21, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.617 Vali Acc: 0.763 Test Loss: 0.617 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 22 cost time: 1.7503442764282227
Epoch: 22, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8454184532165527
Epoch: 23, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.575 Vali Acc: 0.757 Test Loss: 0.575 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.0085947513580322
Epoch: 24, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.728 Vali Acc: 0.743 Test Loss: 0.728 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9775657653808594
Epoch: 25, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.606 Vali Acc: 0.763 Test Loss: 0.606 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 1.3544559478759766
Epoch: 26, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 27 cost time: 1.9798924922943115
Epoch: 27, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.606 Vali Acc: 0.763 Test Loss: 0.606 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7390573024749756
Epoch: 28, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.626 Vali Acc: 0.763 Test Loss: 0.626 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8775742053985596
Epoch: 29, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.666 Vali Acc: 0.757 Test Loss: 0.666 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6378390789031982
Epoch: 30, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.673 Vali Acc: 0.770 Test Loss: 0.673 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.9644699096679688
Epoch: 31, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8666431903839111
Epoch: 32, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.760 Vali Acc: 0.776 Test Loss: 0.760 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.1364634037017822
Epoch: 33, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.732 Vali Acc: 0.750 Test Loss: 0.732 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.2575271129608154
Epoch: 34, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.2544078826904297
Epoch: 35, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.767 Vali Acc: 0.750 Test Loss: 0.767 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.4203014373779297
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.718 Vali Acc: 0.783 Test Loss: 0.718 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 37 cost time: 2.186830997467041
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.760 Vali Acc: 0.776 Test Loss: 0.760 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 2.3719289302825928
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789466).  Saving model ...
Epoch: 39 cost time: 2.362240791320801
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.755 Vali Acc: 0.776 Test Loss: 0.755 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.3470726013183594
Epoch: 40, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.793 Vali Acc: 0.789 Test Loss: 0.793 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 2.7599096298217773
Epoch: 41, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.825 Vali Acc: 0.763 Test Loss: 0.825 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 2.34920334815979
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.889 Vali Acc: 0.763 Test Loss: 0.889 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 2.2582924365997314
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.923 Vali Acc: 0.743 Test Loss: 0.923 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 2.073133945465088
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.922 Vali Acc: 0.783 Test Loss: 0.922 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 2.2287068367004395
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.939 Vali Acc: 0.757 Test Loss: 0.939 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 2.4372639656066895
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.965 Vali Acc: 0.763 Test Loss: 0.965 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.879483938217163
Epoch: 47, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.978 Vali Acc: 0.789 Test Loss: 0.978 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 2.00500226020813
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.987 Vali Acc: 0.757 Test Loss: 0.987 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 594868
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.072255373001099
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.403 Vali Acc: 0.276 Test Loss: 1.403 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.7947189807891846
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.396 Vali Acc: 0.289 Test Loss: 1.396 Test Acc: 0.289
Validation loss decreased (-0.276302 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 1.5199363231658936
Epoch: 3, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.323 Vali Acc: 0.408 Test Loss: 1.323 Test Acc: 0.408
Validation loss decreased (-0.289460 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 1.8291404247283936
Epoch: 4, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.276 Vali Acc: 0.414 Test Loss: 1.276 Test Acc: 0.414
Validation loss decreased (-0.407882 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 1.8805601596832275
Epoch: 5, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.216 Vali Acc: 0.539 Test Loss: 1.216 Test Acc: 0.539
Validation loss decreased (-0.414461 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 1.4612812995910645
Epoch: 6, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.147 Vali Acc: 0.539 Test Loss: 1.147 Test Acc: 0.539
Validation loss decreased (-0.539462 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 1.8397703170776367
Epoch: 7, Steps: 10 | Train Loss: 0.942 Vali Loss: 1.023 Vali Acc: 0.645 Test Loss: 1.023 Test Acc: 0.645
Validation loss decreased (-0.539462 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 1.5733425617218018
Epoch: 8, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.926 Vali Acc: 0.645 Test Loss: 0.926 Test Acc: 0.645
Validation loss decreased (-0.644727 --> -0.644728).  Saving model ...
Epoch: 9 cost time: 1.771245002746582
Epoch: 9, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.831 Vali Acc: 0.678 Test Loss: 0.831 Test Acc: 0.678
Validation loss decreased (-0.644728 --> -0.677623).  Saving model ...
Epoch: 10 cost time: 1.8872594833374023
Epoch: 10, Steps: 10 | Train Loss: 0.621 Vali Loss: 0.772 Vali Acc: 0.697 Test Loss: 0.772 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 11 cost time: 1.8693757057189941
Epoch: 11, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.692 Vali Acc: 0.737 Test Loss: 0.692 Test Acc: 0.737
Validation loss decreased (-0.697361 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 2.215514659881592
Epoch: 12, Steps: 10 | Train Loss: 0.460 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4168484210968018
Epoch: 13, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.630 Vali Acc: 0.750 Test Loss: 0.630 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 2.3826913833618164
Epoch: 14, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.582 Vali Acc: 0.750 Test Loss: 0.582 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 2.207883834838867
Epoch: 15, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.568 Vali Acc: 0.757 Test Loss: 0.568 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 2.4970479011535645
Epoch: 16, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.594 Vali Acc: 0.763 Test Loss: 0.594 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.9229223728179932
Epoch: 17, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.559 Vali Acc: 0.750 Test Loss: 0.559 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1675493717193604
Epoch: 18, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.540 Vali Acc: 0.757 Test Loss: 0.540 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8708539009094238
Epoch: 19, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 1.8353619575500488
Epoch: 20, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.594 Vali Acc: 0.763 Test Loss: 0.594 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.506577253341675
Epoch: 21, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.569 Vali Acc: 0.763 Test Loss: 0.569 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.935603141784668
Epoch: 22, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.565 Vali Acc: 0.757 Test Loss: 0.565 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8322460651397705
Epoch: 23, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.592 Vali Acc: 0.743 Test Loss: 0.592 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6299710273742676
Epoch: 24, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.654 Vali Acc: 0.757 Test Loss: 0.654 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.0785129070281982
Epoch: 25, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.677 Vali Acc: 0.770 Test Loss: 0.677 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8114328384399414
Epoch: 26, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.654 Vali Acc: 0.776 Test Loss: 0.654 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6907472610473633
Epoch: 27, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.668 Vali Acc: 0.770 Test Loss: 0.668 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8250000476837158
Epoch: 28, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.709 Vali Acc: 0.763 Test Loss: 0.709 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.6924808025360107
Epoch: 29, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.808 Vali Acc: 0.783 Test Loss: 0.808 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782887).  Saving model ...
Epoch: 30 cost time: 1.7262837886810303
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.756 Vali Acc: 0.750 Test Loss: 0.756 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.599867820739746
Epoch: 31, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.769 Vali Acc: 0.757 Test Loss: 0.769 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3534424304962158
Epoch: 32, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.836 Vali Acc: 0.763 Test Loss: 0.836 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4268038272857666
Epoch: 33, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.822 Vali Acc: 0.770 Test Loss: 0.822 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.672309398651123
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.809 Vali Acc: 0.770 Test Loss: 0.809 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7778713703155518
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.809 Vali Acc: 0.763 Test Loss: 0.809 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8024561405181885
Epoch: 36, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.823 Vali Acc: 0.783 Test Loss: 0.823 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.668684482574463
Epoch: 37, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.826 Vali Acc: 0.776 Test Loss: 0.826 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.065528154373169
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.864 Vali Acc: 0.776 Test Loss: 0.864 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.837735652923584
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.834 Vali Acc: 0.783 Test Loss: 0.834 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 594484
model size : 3.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9052674770355225
Epoch: 1, Steps: 10 | Train Loss: 1.482 Vali Loss: 1.428 Vali Acc: 0.243 Test Loss: 1.428 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.582305669784546
Epoch: 2, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.386 Vali Acc: 0.263 Test Loss: 1.386 Test Acc: 0.263
Validation loss decreased (-0.243407 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 1.4550583362579346
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.336 Vali Acc: 0.368 Test Loss: 1.336 Test Acc: 0.368
Validation loss decreased (-0.263144 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 2.1207375526428223
Epoch: 4, Steps: 10 | Train Loss: 1.325 Vali Loss: 1.288 Vali Acc: 0.428 Test Loss: 1.288 Test Acc: 0.428
Validation loss decreased (-0.368408 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 2.5528814792633057
Epoch: 5, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.230 Vali Acc: 0.434 Test Loss: 1.230 Test Acc: 0.434
Validation loss decreased (-0.427619 --> -0.434198).  Saving model ...
Epoch: 6 cost time: 1.6191487312316895
Epoch: 6, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.167 Vali Acc: 0.513 Test Loss: 1.167 Test Acc: 0.513
Validation loss decreased (-0.434198 --> -0.513146).  Saving model ...
Epoch: 7 cost time: 1.4714715480804443
Epoch: 7, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.081 Vali Acc: 0.553 Test Loss: 1.081 Test Acc: 0.553
Validation loss decreased (-0.513146 --> -0.552621).  Saving model ...
Epoch: 8 cost time: 1.6298754215240479
Epoch: 8, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.017 Vali Acc: 0.612 Test Loss: 1.017 Test Acc: 0.612
Validation loss decreased (-0.552621 --> -0.611832).  Saving model ...
Epoch: 9 cost time: 1.7293710708618164
Epoch: 9, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.987 Vali Acc: 0.618 Test Loss: 0.987 Test Acc: 0.618
Validation loss decreased (-0.611832 --> -0.618411).  Saving model ...
Epoch: 10 cost time: 1.723909854888916
Epoch: 10, Steps: 10 | Train Loss: 0.743 Vali Loss: 0.921 Vali Acc: 0.605 Test Loss: 0.921 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9359440803527832
Epoch: 11, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.847 Vali Acc: 0.678 Test Loss: 0.847 Test Acc: 0.678
Validation loss decreased (-0.618411 --> -0.677623).  Saving model ...
Epoch: 12 cost time: 1.8129122257232666
Epoch: 12, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.787 Vali Acc: 0.664 Test Loss: 0.787 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0399274826049805
Epoch: 13, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.719 Vali Acc: 0.724 Test Loss: 0.719 Test Acc: 0.724
Validation loss decreased (-0.677623 --> -0.723677).  Saving model ...
Epoch: 14 cost time: 1.5994017124176025
Epoch: 14, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.694 Vali Acc: 0.717 Test Loss: 0.694 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.559934139251709
Epoch: 15, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.660 Vali Acc: 0.757 Test Loss: 0.660 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756572).  Saving model ...
Epoch: 16 cost time: 1.727966547012329
Epoch: 16, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.633 Vali Acc: 0.730 Test Loss: 0.633 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8446452617645264
Epoch: 17, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.640 Vali Acc: 0.770 Test Loss: 0.640 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769730).  Saving model ...
Epoch: 18 cost time: 1.6283743381500244
Epoch: 18, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.598 Vali Acc: 0.757 Test Loss: 0.598 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.274038314819336
Epoch: 19, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 20 cost time: 1.9622607231140137
Epoch: 20, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.618 Vali Acc: 0.770 Test Loss: 0.618 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8028061389923096
Epoch: 21, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.561 Vali Acc: 0.763 Test Loss: 0.561 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.778108835220337
Epoch: 22, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.563 Vali Acc: 0.757 Test Loss: 0.563 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7441487312316895
Epoch: 23, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.566 Vali Acc: 0.757 Test Loss: 0.566 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2970707416534424
Epoch: 24, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.606 Vali Acc: 0.750 Test Loss: 0.606 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7368106842041016
Epoch: 25, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.572 Vali Acc: 0.743 Test Loss: 0.572 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.02405047416687
Epoch: 26, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.8968255519866943
Epoch: 27, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.642 Vali Acc: 0.750 Test Loss: 0.642 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.493669033050537
Epoch: 28, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.613 Vali Acc: 0.763 Test Loss: 0.613 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2882368564605713
Epoch: 29, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.577 Vali Acc: 0.757 Test Loss: 0.577 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 591284
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.384151935577393
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.367 Vali Acc: 0.237 Test Loss: 1.367 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.6731090545654297
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.343 Vali Acc: 0.336 Test Loss: 1.343 Test Acc: 0.336
Validation loss decreased (-0.236828 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.4488246440887451
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.289 Vali Acc: 0.414 Test Loss: 1.289 Test Acc: 0.414
Validation loss decreased (-0.335513 --> -0.414461).  Saving model ...
Epoch: 4 cost time: 1.5452044010162354
Epoch: 4, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.233 Vali Acc: 0.507 Test Loss: 1.233 Test Acc: 0.507
Validation loss decreased (-0.414461 --> -0.506567).  Saving model ...
Epoch: 5 cost time: 1.7612454891204834
Epoch: 5, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.187 Vali Acc: 0.487 Test Loss: 1.187 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9251461029052734
Epoch: 6, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.102 Vali Acc: 0.513 Test Loss: 1.102 Test Acc: 0.513
Validation loss decreased (-0.506567 --> -0.513147).  Saving model ...
Epoch: 7 cost time: 1.9454712867736816
Epoch: 7, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.047 Vali Acc: 0.493 Test Loss: 1.047 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.464827299118042
Epoch: 8, Steps: 10 | Train Loss: 0.902 Vali Loss: 0.985 Vali Acc: 0.559 Test Loss: 0.985 Test Acc: 0.559
Validation loss decreased (-0.513147 --> -0.559201).  Saving model ...
Epoch: 9 cost time: 1.5028743743896484
Epoch: 9, Steps: 10 | Train Loss: 0.833 Vali Loss: 0.928 Vali Acc: 0.605 Test Loss: 0.928 Test Acc: 0.605
Validation loss decreased (-0.559201 --> -0.605254).  Saving model ...
Epoch: 10 cost time: 1.5760247707366943
Epoch: 10, Steps: 10 | Train Loss: 0.715 Vali Loss: 0.853 Vali Acc: 0.658 Test Loss: 0.853 Test Acc: 0.658
Validation loss decreased (-0.605254 --> -0.657886).  Saving model ...
Epoch: 11 cost time: 1.9823906421661377
Epoch: 11, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.784 Vali Acc: 0.691 Test Loss: 0.784 Test Acc: 0.691
Validation loss decreased (-0.657886 --> -0.690782).  Saving model ...
Epoch: 12 cost time: 2.085875988006592
Epoch: 12, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.723 Vali Acc: 0.704 Test Loss: 0.723 Test Acc: 0.704
Validation loss decreased (-0.690782 --> -0.703940).  Saving model ...
Epoch: 13 cost time: 1.782961368560791
Epoch: 13, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.669 Vali Acc: 0.704 Test Loss: 0.669 Test Acc: 0.704
Validation loss decreased (-0.703940 --> -0.703941).  Saving model ...
Epoch: 14 cost time: 1.8951818943023682
Epoch: 14, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.622 Vali Acc: 0.724 Test Loss: 0.622 Test Acc: 0.724
Validation loss decreased (-0.703941 --> -0.723678).  Saving model ...
Epoch: 15 cost time: 1.5189452171325684
Epoch: 15, Steps: 10 | Train Loss: 0.375 Vali Loss: 0.668 Vali Acc: 0.724 Test Loss: 0.668 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.840411901473999
Epoch: 16, Steps: 10 | Train Loss: 0.353 Vali Loss: 0.672 Vali Acc: 0.697 Test Loss: 0.672 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0426626205444336
Epoch: 17, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.571 Vali Acc: 0.730 Test Loss: 0.571 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 18 cost time: 2.0211899280548096
Epoch: 18, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.558 Vali Acc: 0.737 Test Loss: 0.558 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736837).  Saving model ...
Epoch: 19 cost time: 2.0460145473480225
Epoch: 19, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
Validation loss decreased (-0.736837 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 1.7100517749786377
Epoch: 20, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.522 Vali Acc: 0.770 Test Loss: 0.522 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8539693355560303
Epoch: 21, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 22 cost time: 1.723900318145752
Epoch: 22, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.511 Vali Acc: 0.776 Test Loss: 0.511 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6246018409729004
Epoch: 23, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4364240169525146
Epoch: 24, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.498 Vali Acc: 0.789 Test Loss: 0.498 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 25 cost time: 1.9070074558258057
Epoch: 25, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9410533905029297
Epoch: 26, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0308830738067627
Epoch: 27, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4781813621520996
Epoch: 28, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.522 Vali Acc: 0.783 Test Loss: 0.522 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.8067450523376465
Epoch: 29, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.536 Vali Acc: 0.809 Test Loss: 0.536 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809205).  Saving model ...
Epoch: 30 cost time: 1.5243771076202393
Epoch: 30, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9621546268463135
Epoch: 31, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.072033643722534
Epoch: 32, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.471 Vali Acc: 0.816 Test Loss: 0.471 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815785).  Saving model ...
Epoch: 33 cost time: 1.5272300243377686
Epoch: 33, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.658 Vali Acc: 0.737 Test Loss: 0.658 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9857256412506104
Epoch: 34, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.478 Vali Acc: 0.829 Test Loss: 0.478 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828943).  Saving model ...
Epoch: 35 cost time: 2.0104122161865234
Epoch: 35, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.586 Vali Acc: 0.783 Test Loss: 0.586 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0070736408233643
Epoch: 36, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.520 Vali Acc: 0.816 Test Loss: 0.520 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.832831859588623
Epoch: 37, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.562 Vali Acc: 0.796 Test Loss: 0.562 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.1271376609802246
Epoch: 38, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.103165864944458
Epoch: 39, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.566 Vali Acc: 0.822 Test Loss: 0.566 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.5309970378875732
Epoch: 40, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.566 Vali Acc: 0.803 Test Loss: 0.566 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.6343655586242676
Epoch: 41, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.703134775161743
Epoch: 42, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.524 Vali Acc: 0.816 Test Loss: 0.524 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.258608102798462
Epoch: 43, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.164121627807617
Epoch: 44, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.562 Vali Acc: 0.836 Test Loss: 0.562 Test Acc: 0.836
Validation loss decreased (-0.828943 --> -0.835521).  Saving model ...
Epoch: 45 cost time: 2.1303586959838867
Epoch: 45, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.133380889892578
Epoch: 46, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.564 Vali Acc: 0.822 Test Loss: 0.564 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.9618580341339111
Epoch: 47, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.833216905593872
Epoch: 48, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.580 Vali Acc: 0.836 Test Loss: 0.580 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.137491226196289
Epoch: 49, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.625 Vali Acc: 0.829 Test Loss: 0.625 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 2.262626886367798
Epoch: 50, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.685 Vali Acc: 0.809 Test Loss: 0.685 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.2385592460632324
Epoch: 51, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.639 Vali Acc: 0.829 Test Loss: 0.639 Test Acc: 0.829
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 2.387803077697754
Epoch: 52, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.824674367904663
Epoch: 53, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 2.2671687602996826
Epoch: 54, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.638 Vali Acc: 0.822 Test Loss: 0.638 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 591092
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.039796829223633
Epoch: 1, Steps: 10 | Train Loss: 1.526 Vali Loss: 1.414 Vali Acc: 0.309 Test Loss: 1.414 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 1.7715041637420654
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.346 Vali Acc: 0.322 Test Loss: 1.346 Test Acc: 0.322
Validation loss decreased (-0.309196 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.5139284133911133
Epoch: 3, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.294 Vali Acc: 0.375 Test Loss: 1.294 Test Acc: 0.375
Validation loss decreased (-0.322355 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 1.6821765899658203
Epoch: 4, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.236 Vali Acc: 0.487 Test Loss: 1.236 Test Acc: 0.487
Validation loss decreased (-0.374987 --> -0.486830).  Saving model ...
Epoch: 5 cost time: 1.6728379726409912
Epoch: 5, Steps: 10 | Train Loss: 1.207 Vali Loss: 1.160 Vali Acc: 0.612 Test Loss: 1.160 Test Acc: 0.612
Validation loss decreased (-0.486830 --> -0.611831).  Saving model ...
Epoch: 6 cost time: 1.6929099559783936
Epoch: 6, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.082 Vali Acc: 0.572 Test Loss: 1.082 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6377003192901611
Epoch: 7, Steps: 10 | Train Loss: 0.989 Vali Loss: 0.979 Vali Acc: 0.645 Test Loss: 0.979 Test Acc: 0.645
Validation loss decreased (-0.611831 --> -0.644727).  Saving model ...
Epoch: 8 cost time: 1.8011417388916016
Epoch: 8, Steps: 10 | Train Loss: 0.861 Vali Loss: 0.891 Vali Acc: 0.632 Test Loss: 0.891 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.017214775085449
Epoch: 9, Steps: 10 | Train Loss: 0.769 Vali Loss: 0.834 Vali Acc: 0.678 Test Loss: 0.834 Test Acc: 0.678
Validation loss decreased (-0.644727 --> -0.677623).  Saving model ...
Epoch: 10 cost time: 1.7461633682250977
Epoch: 10, Steps: 10 | Train Loss: 0.652 Vali Loss: 0.763 Vali Acc: 0.691 Test Loss: 0.763 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690782).  Saving model ...
Epoch: 11 cost time: 1.8277807235717773
Epoch: 11, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.697 Vali Acc: 0.711 Test Loss: 0.697 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 12 cost time: 1.5088908672332764
Epoch: 12, Steps: 10 | Train Loss: 0.504 Vali Loss: 0.652 Vali Acc: 0.717 Test Loss: 0.652 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717099).  Saving model ...
Epoch: 13 cost time: 1.9959897994995117
Epoch: 13, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.609 Vali Acc: 0.789 Test Loss: 0.609 Test Acc: 0.789
Validation loss decreased (-0.717099 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.7751638889312744
Epoch: 14, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.635 Vali Acc: 0.730 Test Loss: 0.635 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7620892524719238
Epoch: 15, Steps: 10 | Train Loss: 0.407 Vali Loss: 0.588 Vali Acc: 0.743 Test Loss: 0.588 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.829918622970581
Epoch: 16, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.569 Vali Acc: 0.750 Test Loss: 0.569 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8198161125183105
Epoch: 17, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7334718704223633
Epoch: 18, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.551 Vali Acc: 0.750 Test Loss: 0.551 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8891139030456543
Epoch: 19, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.568 Vali Acc: 0.757 Test Loss: 0.568 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.689244270324707
Epoch: 20, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.548 Vali Acc: 0.750 Test Loss: 0.548 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.741588830947876
Epoch: 21, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.527 Vali Acc: 0.750 Test Loss: 0.527 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8553690910339355
Epoch: 22, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5760869979858398
Epoch: 23, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.524 Vali Acc: 0.750 Test Loss: 0.524 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 590900
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.424600124359131
Epoch: 1, Steps: 10 | Train Loss: 1.488 Vali Loss: 1.403 Vali Acc: 0.289 Test Loss: 1.403 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 2.438776731491089
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.392 Vali Acc: 0.243 Test Loss: 1.392 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.206355571746826
Epoch: 3, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.361 Vali Acc: 0.283 Test Loss: 1.361 Test Acc: 0.283
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.1691198348999023
Epoch: 4, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.327 Vali Acc: 0.395 Test Loss: 1.327 Test Acc: 0.395
Validation loss decreased (-0.289460 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 1.8780624866485596
Epoch: 5, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.295 Vali Acc: 0.408 Test Loss: 1.295 Test Acc: 0.408
Validation loss decreased (-0.394724 --> -0.407882).  Saving model ...
Epoch: 6 cost time: 1.9519217014312744
Epoch: 6, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.250 Vali Acc: 0.454 Test Loss: 1.250 Test Acc: 0.454
Validation loss decreased (-0.407882 --> -0.453935).  Saving model ...
Epoch: 7 cost time: 1.6105799674987793
Epoch: 7, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.201 Vali Acc: 0.487 Test Loss: 1.201 Test Acc: 0.487
Validation loss decreased (-0.453935 --> -0.486830).  Saving model ...
Epoch: 8 cost time: 2.0910511016845703
Epoch: 8, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.133 Vali Acc: 0.533 Test Loss: 1.133 Test Acc: 0.533
Validation loss decreased (-0.486830 --> -0.532883).  Saving model ...
Epoch: 9 cost time: 1.9815022945404053
Epoch: 9, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.062 Vali Acc: 0.539 Test Loss: 1.062 Test Acc: 0.539
Validation loss decreased (-0.532883 --> -0.539463).  Saving model ...
Epoch: 10 cost time: 1.8211736679077148
Epoch: 10, Steps: 10 | Train Loss: 0.895 Vali Loss: 0.989 Vali Acc: 0.572 Test Loss: 0.989 Test Acc: 0.572
Validation loss decreased (-0.539463 --> -0.572359).  Saving model ...
Epoch: 11 cost time: 2.002370834350586
Epoch: 11, Steps: 10 | Train Loss: 0.797 Vali Loss: 0.921 Vali Acc: 0.625 Test Loss: 0.921 Test Acc: 0.625
Validation loss decreased (-0.572359 --> -0.624991).  Saving model ...
Epoch: 12 cost time: 2.1667675971984863
Epoch: 12, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.860 Vali Acc: 0.671 Test Loss: 0.860 Test Acc: 0.671
Validation loss decreased (-0.624991 --> -0.671044).  Saving model ...
Epoch: 13 cost time: 2.289951801300049
Epoch: 13, Steps: 10 | Train Loss: 0.617 Vali Loss: 0.805 Vali Acc: 0.684 Test Loss: 0.805 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684202).  Saving model ...
Epoch: 14 cost time: 1.4847412109375
Epoch: 14, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.791 Vali Acc: 0.704 Test Loss: 0.791 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703939).  Saving model ...
Epoch: 15 cost time: 2.1544642448425293
Epoch: 15, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.767 Vali Acc: 0.691 Test Loss: 0.767 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.236583948135376
Epoch: 16, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.691 Vali Acc: 0.730 Test Loss: 0.691 Test Acc: 0.730
Validation loss decreased (-0.703939 --> -0.730256).  Saving model ...
Epoch: 17 cost time: 2.4664740562438965
Epoch: 17, Steps: 10 | Train Loss: 0.404 Vali Loss: 0.718 Vali Acc: 0.724 Test Loss: 0.718 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3821709156036377
Epoch: 18, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.672 Vali Acc: 0.717 Test Loss: 0.672 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.122678279876709
Epoch: 19, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.642 Vali Acc: 0.717 Test Loss: 0.642 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.381265163421631
Epoch: 20, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.599 Vali Acc: 0.724 Test Loss: 0.599 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2792153358459473
Epoch: 21, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 22 cost time: 2.3706510066986084
Epoch: 22, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.601 Vali Acc: 0.724 Test Loss: 0.601 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7276942729949951
Epoch: 23, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.569 Vali Acc: 0.770 Test Loss: 0.569 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 24 cost time: 1.6706087589263916
Epoch: 24, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7533020973205566
Epoch: 25, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.566 Vali Acc: 0.743 Test Loss: 0.566 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8900260925292969
Epoch: 26, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.600 Vali Acc: 0.704 Test Loss: 0.600 Test Acc: 0.704
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.7906382083892822
Epoch: 27, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.642 Vali Acc: 0.743 Test Loss: 0.642 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8804917335510254
Epoch: 28, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.634 Vali Acc: 0.730 Test Loss: 0.634 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8703899383544922
Epoch: 29, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.595 Vali Acc: 0.743 Test Loss: 0.595 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.3166632652282715
Epoch: 30, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.574 Vali Acc: 0.750 Test Loss: 0.574 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8628065586090088
Epoch: 31, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.559 Vali Acc: 0.757 Test Loss: 0.559 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.016723871231079
Epoch: 32, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.585 Vali Acc: 0.763 Test Loss: 0.585 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.285268545150757
Epoch: 33, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.599 Vali Acc: 0.757 Test Loss: 0.599 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 590708
model size : 3.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4809439182281494
Epoch: 1, Steps: 10 | Train Loss: 1.466 Vali Loss: 1.418 Vali Acc: 0.250 Test Loss: 1.418 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 2.1104753017425537
Epoch: 2, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.388 Vali Acc: 0.276 Test Loss: 1.388 Test Acc: 0.276
Validation loss decreased (-0.249986 --> -0.276302).  Saving model ...
Epoch: 3 cost time: 1.930654525756836
Epoch: 3, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.371 Vali Acc: 0.243 Test Loss: 1.371 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7550292015075684
Epoch: 4, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.339 Vali Acc: 0.355 Test Loss: 1.339 Test Acc: 0.355
Validation loss decreased (-0.276302 --> -0.355250).  Saving model ...
Epoch: 5 cost time: 1.4830265045166016
Epoch: 5, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.313 Vali Acc: 0.355 Test Loss: 1.313 Test Acc: 0.355
Validation loss decreased (-0.355250 --> -0.355250).  Saving model ...
Epoch: 6 cost time: 1.7367255687713623
Epoch: 6, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.269 Vali Acc: 0.461 Test Loss: 1.269 Test Acc: 0.461
Validation loss decreased (-0.355250 --> -0.460514).  Saving model ...
Epoch: 7 cost time: 1.8494713306427002
Epoch: 7, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.223 Vali Acc: 0.454 Test Loss: 1.223 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.666238784790039
Epoch: 8, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.144 Vali Acc: 0.493 Test Loss: 1.144 Test Acc: 0.493
Validation loss decreased (-0.460514 --> -0.493410).  Saving model ...
Epoch: 9 cost time: 1.6113765239715576
Epoch: 9, Steps: 10 | Train Loss: 1.067 Vali Loss: 1.081 Vali Acc: 0.467 Test Loss: 1.081 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.554009199142456
Epoch: 10, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.045 Vali Acc: 0.526 Test Loss: 1.045 Test Acc: 0.526
Validation loss decreased (-0.493410 --> -0.526305).  Saving model ...
Epoch: 11 cost time: 1.7742276191711426
Epoch: 11, Steps: 10 | Train Loss: 0.897 Vali Loss: 0.976 Vali Acc: 0.579 Test Loss: 0.976 Test Acc: 0.579
Validation loss decreased (-0.526305 --> -0.578938).  Saving model ...
Epoch: 12 cost time: 1.6266610622406006
Epoch: 12, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.931 Vali Acc: 0.579 Test Loss: 0.931 Test Acc: 0.579
Validation loss decreased (-0.578938 --> -0.578938).  Saving model ...
Epoch: 13 cost time: 1.629040002822876
Epoch: 13, Steps: 10 | Train Loss: 0.768 Vali Loss: 0.879 Vali Acc: 0.645 Test Loss: 0.879 Test Acc: 0.645
Validation loss decreased (-0.578938 --> -0.644728).  Saving model ...
Epoch: 14 cost time: 1.3247871398925781
Epoch: 14, Steps: 10 | Train Loss: 0.714 Vali Loss: 0.851 Vali Acc: 0.638 Test Loss: 0.851 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3866140842437744
Epoch: 15, Steps: 10 | Train Loss: 0.656 Vali Loss: 0.811 Vali Acc: 0.658 Test Loss: 0.811 Test Acc: 0.658
Validation loss decreased (-0.644728 --> -0.657887).  Saving model ...
Epoch: 16 cost time: 1.402874231338501
Epoch: 16, Steps: 10 | Train Loss: 0.611 Vali Loss: 0.823 Vali Acc: 0.697 Test Loss: 0.823 Test Acc: 0.697
Validation loss decreased (-0.657887 --> -0.697360).  Saving model ...
Epoch: 17 cost time: 1.6819806098937988
Epoch: 17, Steps: 10 | Train Loss: 0.529 Vali Loss: 0.771 Vali Acc: 0.664 Test Loss: 0.771 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7398934364318848
Epoch: 18, Steps: 10 | Train Loss: 0.523 Vali Loss: 0.700 Vali Acc: 0.717 Test Loss: 0.700 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 19 cost time: 1.5638039112091064
Epoch: 19, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.671 Vali Acc: 0.711 Test Loss: 0.671 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5574655532836914
Epoch: 20, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.671 Vali Acc: 0.737 Test Loss: 0.671 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 21 cost time: 1.9838457107543945
Epoch: 21, Steps: 10 | Train Loss: 0.372 Vali Loss: 0.650 Vali Acc: 0.737 Test Loss: 0.650 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 22 cost time: 1.5487501621246338
Epoch: 22, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 23 cost time: 1.5073766708374023
Epoch: 23, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.621 Vali Acc: 0.757 Test Loss: 0.621 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 24 cost time: 1.222754716873169
Epoch: 24, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.535522699356079
Epoch: 25, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.560 Vali Acc: 0.757 Test Loss: 0.560 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 26 cost time: 1.4526822566986084
Epoch: 26, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.578 Vali Acc: 0.757 Test Loss: 0.578 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4569859504699707
Epoch: 27, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.542 Vali Acc: 0.770 Test Loss: 0.542 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 28 cost time: 1.6921675205230713
Epoch: 28, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.586 Vali Acc: 0.750 Test Loss: 0.586 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6785316467285156
Epoch: 29, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.563 Vali Acc: 0.783 Test Loss: 0.563 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 30 cost time: 1.7581374645233154
Epoch: 30, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.537 Vali Acc: 0.776 Test Loss: 0.537 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.6164052486419678
Epoch: 31, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.594057321548462
Epoch: 32, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 33 cost time: 1.8051750659942627
Epoch: 33, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.592 Vali Acc: 0.783 Test Loss: 0.592 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.6952223777770996
Epoch: 34, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.584 Vali Acc: 0.763 Test Loss: 0.584 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.8206002712249756
Epoch: 35, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.597 Vali Acc: 0.809 Test Loss: 0.597 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 36 cost time: 1.9089019298553467
Epoch: 36, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.7683336734771729
Epoch: 37, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.604 Vali Acc: 0.796 Test Loss: 0.604 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7465183734893799
Epoch: 38, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.543 Vali Acc: 0.789 Test Loss: 0.543 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.8860950469970703
Epoch: 39, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.8261284828186035
Epoch: 40, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.9809882640838623
Epoch: 41, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.6300616264343262
Epoch: 42, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.2692229747772217
Epoch: 43, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 44 cost time: 2.0921177864074707
Epoch: 44, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 45 cost time: 1.8792874813079834
Epoch: 45, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.556 Vali Acc: 0.829 Test Loss: 0.556 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828942).  Saving model ...
Epoch: 46 cost time: 1.8133506774902344
Epoch: 46, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.563 Vali Acc: 0.822 Test Loss: 0.563 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.7584350109100342
Epoch: 47, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.625 Vali Acc: 0.789 Test Loss: 0.625 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.536238431930542
Epoch: 48, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.602 Vali Acc: 0.803 Test Loss: 0.602 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.5271947383880615
Epoch: 49, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.602 Vali Acc: 0.789 Test Loss: 0.602 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.521423101425171
Epoch: 50, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.549 Vali Acc: 0.816 Test Loss: 0.549 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.4586281776428223
Epoch: 51, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.603 Vali Acc: 0.796 Test Loss: 0.603 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.7054870128631592
Epoch: 52, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.590 Vali Acc: 0.809 Test Loss: 0.590 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.481745719909668
Epoch: 53, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.600 Vali Acc: 0.796 Test Loss: 0.600 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.7851884365081787
Epoch: 54, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.629 Vali Acc: 0.809 Test Loss: 0.629 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.5999839305877686
Epoch: 55, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 358324
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.186166524887085
Epoch: 1, Steps: 10 | Train Loss: 1.535 Vali Loss: 1.499 Vali Acc: 0.270 Test Loss: 1.499 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 1.6381385326385498
Epoch: 2, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.397 Vali Acc: 0.243 Test Loss: 1.397 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7915058135986328
Epoch: 3, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.370 Vali Acc: 0.336 Test Loss: 1.370 Test Acc: 0.336
Validation loss decreased (-0.269722 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 1.2964966297149658
Epoch: 4, Steps: 10 | Train Loss: 1.394 Vali Loss: 1.346 Vali Acc: 0.375 Test Loss: 1.346 Test Acc: 0.375
Validation loss decreased (-0.335513 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.6224706172943115
Epoch: 5, Steps: 10 | Train Loss: 1.328 Vali Loss: 1.329 Vali Acc: 0.342 Test Loss: 1.329 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.502814531326294
Epoch: 6, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.277 Vali Acc: 0.513 Test Loss: 1.277 Test Acc: 0.513
Validation loss decreased (-0.374987 --> -0.513145).  Saving model ...
Epoch: 7 cost time: 1.4144582748413086
Epoch: 7, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.219 Vali Acc: 0.500 Test Loss: 1.219 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6453437805175781
Epoch: 8, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.139 Vali Acc: 0.586 Test Loss: 1.139 Test Acc: 0.586
Validation loss decreased (-0.513145 --> -0.585515).  Saving model ...
Epoch: 9 cost time: 1.5869958400726318
Epoch: 9, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.051 Vali Acc: 0.592 Test Loss: 1.051 Test Acc: 0.592
Validation loss decreased (-0.585515 --> -0.592095).  Saving model ...
Epoch: 10 cost time: 1.7490992546081543
Epoch: 10, Steps: 10 | Train Loss: 0.940 Vali Loss: 0.997 Vali Acc: 0.599 Test Loss: 0.997 Test Acc: 0.599
Validation loss decreased (-0.592095 --> -0.598674).  Saving model ...
Epoch: 11 cost time: 1.7917814254760742
Epoch: 11, Steps: 10 | Train Loss: 0.852 Vali Loss: 0.945 Vali Acc: 0.638 Test Loss: 0.945 Test Acc: 0.638
Validation loss decreased (-0.598674 --> -0.638148).  Saving model ...
Epoch: 12 cost time: 1.603231430053711
Epoch: 12, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.861 Vali Acc: 0.671 Test Loss: 0.861 Test Acc: 0.671
Validation loss decreased (-0.638148 --> -0.671044).  Saving model ...
Epoch: 13 cost time: 1.436152458190918
Epoch: 13, Steps: 10 | Train Loss: 0.647 Vali Loss: 0.830 Vali Acc: 0.691 Test Loss: 0.830 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690781).  Saving model ...
Epoch: 14 cost time: 1.7087767124176025
Epoch: 14, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.777 Vali Acc: 0.691 Test Loss: 0.777 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690782).  Saving model ...
Epoch: 15 cost time: 1.54891037940979
Epoch: 15, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.771 Vali Acc: 0.678 Test Loss: 0.771 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4446592330932617
Epoch: 16, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.717 Vali Acc: 0.711 Test Loss: 0.717 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 17 cost time: 1.5753061771392822
Epoch: 17, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.704 Vali Acc: 0.691 Test Loss: 0.704 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.916886568069458
Epoch: 18, Steps: 10 | Train Loss: 0.400 Vali Loss: 0.679 Vali Acc: 0.730 Test Loss: 0.679 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 19 cost time: 2.0509748458862305
Epoch: 19, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.690 Vali Acc: 0.684 Test Loss: 0.690 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.059338331222534
Epoch: 20, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.656 Vali Acc: 0.737 Test Loss: 0.656 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 21 cost time: 1.8967609405517578
Epoch: 21, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.625 Vali Acc: 0.717 Test Loss: 0.625 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2991244792938232
Epoch: 22, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.611 Vali Acc: 0.724 Test Loss: 0.611 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.0893704891204834
Epoch: 23, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 24 cost time: 1.9432806968688965
Epoch: 24, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.595 Vali Acc: 0.737 Test Loss: 0.595 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 25 cost time: 2.3953816890716553
Epoch: 25, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.598 Vali Acc: 0.750 Test Loss: 0.598 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 26 cost time: 2.1088674068450928
Epoch: 26, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.600 Vali Acc: 0.750 Test Loss: 0.600 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7411181926727295
Epoch: 27, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.604 Vali Acc: 0.743 Test Loss: 0.604 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.558539867401123
Epoch: 28, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.587 Vali Acc: 0.757 Test Loss: 0.587 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 29 cost time: 2.1342546939849854
Epoch: 29, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.591 Vali Acc: 0.757 Test Loss: 0.591 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.994995355606079
Epoch: 30, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.995283842086792
Epoch: 31, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.650 Vali Acc: 0.750 Test Loss: 0.650 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.817505121231079
Epoch: 32, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.591 Vali Acc: 0.770 Test Loss: 0.591 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 33 cost time: 1.9612550735473633
Epoch: 33, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.593 Vali Acc: 0.757 Test Loss: 0.593 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.232210874557495
Epoch: 34, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.655 Vali Acc: 0.724 Test Loss: 0.655 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.6824021339416504
Epoch: 35, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.634 Vali Acc: 0.750 Test Loss: 0.634 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.0319910049438477
Epoch: 36, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.602 Vali Acc: 0.770 Test Loss: 0.602 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7586259841918945
Epoch: 37, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 1.9886102676391602
Epoch: 38, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8283390998840332
Epoch: 39, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0885233879089355
Epoch: 40, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.721 Vali Acc: 0.730 Test Loss: 0.721 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.0343689918518066
Epoch: 41, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.2755050659179688
Epoch: 42, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.656 Vali Acc: 0.770 Test Loss: 0.656 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.7803750038146973
Epoch: 43, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.607 Vali Acc: 0.763 Test Loss: 0.607 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.8789973258972168
Epoch: 44, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.628 Vali Acc: 0.770 Test Loss: 0.628 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.203791618347168
Epoch: 45, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.630 Vali Acc: 0.783 Test Loss: 0.630 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.207573413848877
Epoch: 46, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.673 Vali Acc: 0.763 Test Loss: 0.673 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.5938634872436523
Epoch: 47, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.634 Vali Acc: 0.796 Test Loss: 0.634 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 48 cost time: 2.5264313220977783
Epoch: 48, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.672 Vali Acc: 0.763 Test Loss: 0.672 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.8419013023376465
Epoch: 49, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.668 Vali Acc: 0.763 Test Loss: 0.668 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.8610284328460693
Epoch: 50, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.665 Vali Acc: 0.770 Test Loss: 0.665 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.7265739440917969
Epoch: 51, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.667 Vali Acc: 0.763 Test Loss: 0.667 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.8241333961486816
Epoch: 52, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.655 Vali Acc: 0.770 Test Loss: 0.655 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.9815032482147217
Epoch: 53, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.687 Vali Acc: 0.783 Test Loss: 0.687 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.863961935043335
Epoch: 54, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 2.153259515762329
Epoch: 55, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.698 Vali Acc: 0.789 Test Loss: 0.698 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.2508111000061035
Epoch: 56, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.735 Vali Acc: 0.776 Test Loss: 0.735 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.4712755680084229
Epoch: 57, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.699 Vali Acc: 0.796 Test Loss: 0.699 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 358132
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8325467109680176
Epoch: 1, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.445 Vali Acc: 0.237 Test Loss: 1.445 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.9514660835266113
Epoch: 2, Steps: 10 | Train Loss: 1.415 Vali Loss: 1.377 Vali Acc: 0.349 Test Loss: 1.377 Test Acc: 0.349
Validation loss decreased (-0.236828 --> -0.348670).  Saving model ...
Epoch: 3 cost time: 1.8937897682189941
Epoch: 3, Steps: 10 | Train Loss: 1.412 Vali Loss: 1.351 Vali Acc: 0.322 Test Loss: 1.351 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.260247230529785
Epoch: 4, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.337 Vali Acc: 0.342 Test Loss: 1.337 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9147224426269531
Epoch: 5, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.309 Vali Acc: 0.362 Test Loss: 1.309 Test Acc: 0.362
Validation loss decreased (-0.348670 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 1.6743323802947998
Epoch: 6, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.258 Vali Acc: 0.388 Test Loss: 1.258 Test Acc: 0.388
Validation loss decreased (-0.361829 --> -0.388145).  Saving model ...
Epoch: 7 cost time: 1.471860647201538
Epoch: 7, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.207 Vali Acc: 0.441 Test Loss: 1.207 Test Acc: 0.441
Validation loss decreased (-0.388145 --> -0.440777).  Saving model ...
Epoch: 8 cost time: 1.7785029411315918
Epoch: 8, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.143 Vali Acc: 0.487 Test Loss: 1.143 Test Acc: 0.487
Validation loss decreased (-0.440777 --> -0.486831).  Saving model ...
Epoch: 9 cost time: 1.6352417469024658
Epoch: 9, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.084 Vali Acc: 0.467 Test Loss: 1.084 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7122623920440674
Epoch: 10, Steps: 10 | Train Loss: 0.957 Vali Loss: 1.025 Vali Acc: 0.520 Test Loss: 1.025 Test Acc: 0.520
Validation loss decreased (-0.486831 --> -0.519727).  Saving model ...
Epoch: 11 cost time: 1.8743414878845215
Epoch: 11, Steps: 10 | Train Loss: 0.844 Vali Loss: 0.973 Vali Acc: 0.579 Test Loss: 0.973 Test Acc: 0.579
Validation loss decreased (-0.519727 --> -0.578938).  Saving model ...
Epoch: 12 cost time: 2.0093483924865723
Epoch: 12, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.929 Vali Acc: 0.546 Test Loss: 0.929 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.874415636062622
Epoch: 13, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.881 Vali Acc: 0.599 Test Loss: 0.881 Test Acc: 0.599
Validation loss decreased (-0.578938 --> -0.598675).  Saving model ...
Epoch: 14 cost time: 2.4321818351745605
Epoch: 14, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.836 Vali Acc: 0.632 Test Loss: 0.836 Test Acc: 0.632
Validation loss decreased (-0.598675 --> -0.631571).  Saving model ...
Epoch: 15 cost time: 1.5807013511657715
Epoch: 15, Steps: 10 | Train Loss: 0.591 Vali Loss: 0.787 Vali Acc: 0.632 Test Loss: 0.787 Test Acc: 0.632
Validation loss decreased (-0.631571 --> -0.631571).  Saving model ...
Epoch: 16 cost time: 1.7611162662506104
Epoch: 16, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.776 Vali Acc: 0.638 Test Loss: 0.776 Test Acc: 0.638
Validation loss decreased (-0.631571 --> -0.638150).  Saving model ...
Epoch: 17 cost time: 2.007951021194458
Epoch: 17, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.765 Vali Acc: 0.638 Test Loss: 0.765 Test Acc: 0.638
Validation loss decreased (-0.638150 --> -0.638150).  Saving model ...
Epoch: 18 cost time: 1.9401545524597168
Epoch: 18, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.702 Vali Acc: 0.678 Test Loss: 0.702 Test Acc: 0.678
Validation loss decreased (-0.638150 --> -0.677625).  Saving model ...
Epoch: 19 cost time: 1.7974300384521484
Epoch: 19, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.684 Vali Acc: 0.678 Test Loss: 0.684 Test Acc: 0.678
Validation loss decreased (-0.677625 --> -0.677625).  Saving model ...
Epoch: 20 cost time: 2.0735695362091064
Epoch: 20, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.639 Vali Acc: 0.724 Test Loss: 0.639 Test Acc: 0.724
Validation loss decreased (-0.677625 --> -0.723678).  Saving model ...
Epoch: 21 cost time: 2.2065117359161377
Epoch: 21, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.613 Vali Acc: 0.724 Test Loss: 0.613 Test Acc: 0.724
Validation loss decreased (-0.723678 --> -0.723678).  Saving model ...
Epoch: 22 cost time: 2.417144536972046
Epoch: 22, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.586 Vali Acc: 0.757 Test Loss: 0.586 Test Acc: 0.757
Validation loss decreased (-0.723678 --> -0.756573).  Saving model ...
Epoch: 23 cost time: 2.135030746459961
Epoch: 23, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 24 cost time: 1.560866117477417
Epoch: 24, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.589 Vali Acc: 0.743 Test Loss: 0.589 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9515862464904785
Epoch: 25, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.561 Vali Acc: 0.770 Test Loss: 0.561 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 2.2807960510253906
Epoch: 26, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 27 cost time: 1.7926592826843262
Epoch: 27, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 28 cost time: 1.7326281070709229
Epoch: 28, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 1.898810863494873
Epoch: 29, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 30 cost time: 1.8871259689331055
Epoch: 30, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 31 cost time: 2.1291377544403076
Epoch: 31, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.524 Vali Acc: 0.796 Test Loss: 0.524 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7803056240081787
Epoch: 32, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.509 Vali Acc: 0.816 Test Loss: 0.509 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 33 cost time: 1.9136676788330078
Epoch: 33, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.950942039489746
Epoch: 34, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.518 Vali Acc: 0.803 Test Loss: 0.518 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.9217002391815186
Epoch: 35, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.4194211959838867
Epoch: 36, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.178514003753662
Epoch: 37, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.551 Vali Acc: 0.822 Test Loss: 0.551 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 38 cost time: 1.8133692741394043
Epoch: 38, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.9234731197357178
Epoch: 39, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.112382173538208
Epoch: 40, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.2149431705474854
Epoch: 41, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.576 Vali Acc: 0.776 Test Loss: 0.576 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.9578673839569092
Epoch: 42, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.7961938381195068
Epoch: 43, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.7407019138336182
Epoch: 44, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.0953829288482666
Epoch: 45, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.577 Vali Acc: 0.816 Test Loss: 0.577 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.1669483184814453
Epoch: 46, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.586 Vali Acc: 0.803 Test Loss: 0.586 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.5676462650299072
Epoch: 47, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 357940
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.17875075340271
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.377 Vali Acc: 0.289 Test Loss: 1.377 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.8812675476074219
Epoch: 2, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.352 Vali Acc: 0.368 Test Loss: 1.352 Test Acc: 0.368
Validation loss decreased (-0.289460 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.8599483966827393
Epoch: 3, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.326 Vali Acc: 0.362 Test Loss: 1.326 Test Acc: 0.362
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6668479442596436
Epoch: 4, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.293 Vali Acc: 0.461 Test Loss: 1.293 Test Acc: 0.461
Validation loss decreased (-0.368408 --> -0.460513).  Saving model ...
Epoch: 5 cost time: 1.7317564487457275
Epoch: 5, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.256 Vali Acc: 0.493 Test Loss: 1.256 Test Acc: 0.493
Validation loss decreased (-0.460513 --> -0.493408).  Saving model ...
Epoch: 6 cost time: 2.2320716381073
Epoch: 6, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.220 Vali Acc: 0.467 Test Loss: 1.220 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0240814685821533
Epoch: 7, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.159 Vali Acc: 0.566 Test Loss: 1.159 Test Acc: 0.566
Validation loss decreased (-0.493408 --> -0.565778).  Saving model ...
Epoch: 8 cost time: 2.0260815620422363
Epoch: 8, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.100 Vali Acc: 0.559 Test Loss: 1.100 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6367266178131104
Epoch: 9, Steps: 10 | Train Loss: 0.971 Vali Loss: 1.035 Vali Acc: 0.605 Test Loss: 1.035 Test Acc: 0.605
Validation loss decreased (-0.565778 --> -0.605253).  Saving model ...
Epoch: 10 cost time: 1.5908029079437256
Epoch: 10, Steps: 10 | Train Loss: 0.907 Vali Loss: 0.963 Vali Acc: 0.618 Test Loss: 0.963 Test Acc: 0.618
Validation loss decreased (-0.605253 --> -0.618411).  Saving model ...
Epoch: 11 cost time: 2.06376576423645
Epoch: 11, Steps: 10 | Train Loss: 0.846 Vali Loss: 0.919 Vali Acc: 0.651 Test Loss: 0.919 Test Acc: 0.651
Validation loss decreased (-0.618411 --> -0.651307).  Saving model ...
Epoch: 12 cost time: 1.834047794342041
Epoch: 12, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.839 Vali Acc: 0.664 Test Loss: 0.839 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664465).  Saving model ...
Epoch: 13 cost time: 1.907360315322876
Epoch: 13, Steps: 10 | Train Loss: 0.645 Vali Loss: 0.809 Vali Acc: 0.697 Test Loss: 0.809 Test Acc: 0.697
Validation loss decreased (-0.664465 --> -0.697360).  Saving model ...
Epoch: 14 cost time: 1.8477745056152344
Epoch: 14, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.759 Vali Acc: 0.678 Test Loss: 0.759 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.212575674057007
Epoch: 15, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.723 Vali Acc: 0.711 Test Loss: 0.723 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710519).  Saving model ...
Epoch: 16 cost time: 1.6238455772399902
Epoch: 16, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.707 Vali Acc: 0.711 Test Loss: 0.707 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 17 cost time: 1.6139299869537354
Epoch: 17, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.644 Vali Acc: 0.737 Test Loss: 0.644 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736836).  Saving model ...
Epoch: 18 cost time: 2.103703022003174
Epoch: 18, Steps: 10 | Train Loss: 0.399 Vali Loss: 0.645 Vali Acc: 0.691 Test Loss: 0.645 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7381236553192139
Epoch: 19, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.604 Vali Acc: 0.724 Test Loss: 0.604 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.655677080154419
Epoch: 20, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.672 Vali Acc: 0.724 Test Loss: 0.672 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8377840518951416
Epoch: 21, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.584 Vali Acc: 0.724 Test Loss: 0.584 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7321152687072754
Epoch: 22, Steps: 10 | Train Loss: 0.287 Vali Loss: 0.636 Vali Acc: 0.717 Test Loss: 0.636 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9882032871246338
Epoch: 23, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.558 Vali Acc: 0.730 Test Loss: 0.558 Test Acc: 0.730
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.0817391872406006
Epoch: 24, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.603 Vali Acc: 0.730 Test Loss: 0.603 Test Acc: 0.730
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.1166441440582275
Epoch: 25, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 26 cost time: 2.028704881668091
Epoch: 26, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 27 cost time: 1.9667294025421143
Epoch: 27, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.529 Vali Acc: 0.750 Test Loss: 0.529 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749995).  Saving model ...
Epoch: 28 cost time: 1.4607176780700684
Epoch: 28, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.583 Vali Acc: 0.730 Test Loss: 0.583 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.580986738204956
Epoch: 29, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.544 Vali Acc: 0.757 Test Loss: 0.544 Test Acc: 0.757
Validation loss decreased (-0.749995 --> -0.756574).  Saving model ...
Epoch: 30 cost time: 1.846398115158081
Epoch: 30, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.532 Vali Acc: 0.757 Test Loss: 0.532 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 31 cost time: 2.2989838123321533
Epoch: 31, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.560 Vali Acc: 0.743 Test Loss: 0.560 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9592432975769043
Epoch: 32, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
Validation loss decreased (-0.756574 --> -0.769731).  Saving model ...
Epoch: 33 cost time: 1.7873642444610596
Epoch: 33, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.596 Vali Acc: 0.743 Test Loss: 0.596 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.7802455425262451
Epoch: 34, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.563 Vali Acc: 0.763 Test Loss: 0.563 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7258632183074951
Epoch: 35, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.602 Vali Acc: 0.711 Test Loss: 0.602 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.9285178184509277
Epoch: 36, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.560 Vali Acc: 0.743 Test Loss: 0.560 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.6648070812225342
Epoch: 37, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.666 Vali Acc: 0.770 Test Loss: 0.666 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.33829402923584
Epoch: 38, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.566 Vali Acc: 0.770 Test Loss: 0.566 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.845409870147705
Epoch: 39, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.571 Vali Acc: 0.743 Test Loss: 0.571 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.004960060119629
Epoch: 40, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.7869906425476074
Epoch: 41, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.534 Vali Acc: 0.770 Test Loss: 0.534 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 42 cost time: 2.4533374309539795
Epoch: 42, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.861114740371704
Epoch: 43, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.3113975524902344
Epoch: 44, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.989931344985962
Epoch: 45, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776310).  Saving model ...
Epoch: 46 cost time: 1.7677497863769531
Epoch: 46, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 47 cost time: 1.9012033939361572
Epoch: 47, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.682 Vali Acc: 0.750 Test Loss: 0.682 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.9175896644592285
Epoch: 48, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.618 Vali Acc: 0.763 Test Loss: 0.618 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 2.3183302879333496
Epoch: 49, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.689 Vali Acc: 0.750 Test Loss: 0.689 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 2.3214333057403564
Epoch: 50, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.616 Vali Acc: 0.776 Test Loss: 0.616 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 2.2305095195770264
Epoch: 51, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.649 Vali Acc: 0.763 Test Loss: 0.649 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.9930918216705322
Epoch: 52, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.626 Vali Acc: 0.770 Test Loss: 0.626 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.9677445888519287
Epoch: 53, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.635 Vali Acc: 0.789 Test Loss: 0.635 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 2.1113460063934326
Epoch: 54, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.9059174060821533
Epoch: 55, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.656 Vali Acc: 0.770 Test Loss: 0.656 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.8107807636260986
Epoch: 56, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.687 Vali Acc: 0.776 Test Loss: 0.687 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 357748
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.722773551940918
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.440 Vali Acc: 0.243 Test Loss: 1.440 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.6887645721435547
Epoch: 2, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.411 Vali Acc: 0.283 Test Loss: 1.411 Test Acc: 0.283
Validation loss decreased (-0.243407 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.5687222480773926
Epoch: 3, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.390 Vali Acc: 0.303 Test Loss: 1.390 Test Acc: 0.303
Validation loss decreased (-0.282881 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 1.611840009689331
Epoch: 4, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.367 Vali Acc: 0.329 Test Loss: 1.367 Test Acc: 0.329
Validation loss decreased (-0.302618 --> -0.328934).  Saving model ...
Epoch: 5 cost time: 1.8596184253692627
Epoch: 5, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.339 Vali Acc: 0.362 Test Loss: 1.339 Test Acc: 0.362
Validation loss decreased (-0.328934 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 2.219943046569824
Epoch: 6, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.321 Vali Acc: 0.368 Test Loss: 1.321 Test Acc: 0.368
Validation loss decreased (-0.361829 --> -0.368408).  Saving model ...
Epoch: 7 cost time: 1.5865793228149414
Epoch: 7, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.284 Vali Acc: 0.421 Test Loss: 1.284 Test Acc: 0.421
Validation loss decreased (-0.368408 --> -0.421040).  Saving model ...
Epoch: 8 cost time: 1.5191988945007324
Epoch: 8, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.257 Vali Acc: 0.480 Test Loss: 1.257 Test Acc: 0.480
Validation loss decreased (-0.421040 --> -0.480251).  Saving model ...
Epoch: 9 cost time: 1.9263339042663574
Epoch: 9, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.205 Vali Acc: 0.474 Test Loss: 1.205 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9447622299194336
Epoch: 10, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5547356605529785
Epoch: 11, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.110 Vali Acc: 0.520 Test Loss: 1.110 Test Acc: 0.520
Validation loss decreased (-0.480251 --> -0.519726).  Saving model ...
Epoch: 12 cost time: 2.1691272258758545
Epoch: 12, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.060 Vali Acc: 0.526 Test Loss: 1.060 Test Acc: 0.526
Validation loss decreased (-0.519726 --> -0.526305).  Saving model ...
Epoch: 13 cost time: 1.850574016571045
Epoch: 13, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.010 Vali Acc: 0.586 Test Loss: 1.010 Test Acc: 0.586
Validation loss decreased (-0.526305 --> -0.585516).  Saving model ...
Epoch: 14 cost time: 1.7649121284484863
Epoch: 14, Steps: 10 | Train Loss: 0.806 Vali Loss: 0.969 Vali Acc: 0.566 Test Loss: 0.969 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6323432922363281
Epoch: 15, Steps: 10 | Train Loss: 0.734 Vali Loss: 0.913 Vali Acc: 0.645 Test Loss: 0.913 Test Acc: 0.645
Validation loss decreased (-0.585516 --> -0.644728).  Saving model ...
Epoch: 16 cost time: 1.6420681476593018
Epoch: 16, Steps: 10 | Train Loss: 0.705 Vali Loss: 0.915 Vali Acc: 0.625 Test Loss: 0.915 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8475205898284912
Epoch: 17, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.900 Vali Acc: 0.632 Test Loss: 0.900 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.216860055923462
Epoch: 18, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.845 Vali Acc: 0.645 Test Loss: 0.845 Test Acc: 0.645
Validation loss decreased (-0.644728 --> -0.644728).  Saving model ...
Epoch: 19 cost time: 1.8149054050445557
Epoch: 19, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.798 Vali Acc: 0.651 Test Loss: 0.798 Test Acc: 0.651
Validation loss decreased (-0.644728 --> -0.651308).  Saving model ...
Epoch: 20 cost time: 1.9697339534759521
Epoch: 20, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.751 Vali Acc: 0.664 Test Loss: 0.751 Test Acc: 0.664
Validation loss decreased (-0.651308 --> -0.664466).  Saving model ...
Epoch: 21 cost time: 1.7632954120635986
Epoch: 21, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.747 Vali Acc: 0.684 Test Loss: 0.747 Test Acc: 0.684
Validation loss decreased (-0.664466 --> -0.684203).  Saving model ...
Epoch: 22 cost time: 2.0669608116149902
Epoch: 22, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.697 Vali Acc: 0.704 Test Loss: 0.697 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703940).  Saving model ...
Epoch: 23 cost time: 1.7155838012695312
Epoch: 23, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.667 Vali Acc: 0.737 Test Loss: 0.667 Test Acc: 0.737
Validation loss decreased (-0.703940 --> -0.736835).  Saving model ...
Epoch: 24 cost time: 1.5635406970977783
Epoch: 24, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.660 Vali Acc: 0.717 Test Loss: 0.660 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9397478103637695
Epoch: 25, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.633 Vali Acc: 0.711 Test Loss: 0.633 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.8544881343841553
Epoch: 26, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.622 Vali Acc: 0.730 Test Loss: 0.622 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.8248279094696045
Epoch: 27, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.605 Vali Acc: 0.737 Test Loss: 0.605 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 28 cost time: 2.1117584705352783
Epoch: 28, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 29 cost time: 1.988903284072876
Epoch: 29, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.588 Vali Acc: 0.737 Test Loss: 0.588 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 30 cost time: 1.5235717296600342
Epoch: 30, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 31 cost time: 1.9297637939453125
Epoch: 31, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.584 Vali Acc: 0.776 Test Loss: 0.584 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 32 cost time: 1.7132973670959473
Epoch: 32, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1836471557617188
Epoch: 33, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.590 Vali Acc: 0.776 Test Loss: 0.590 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5705742835998535
Epoch: 34, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.588 Vali Acc: 0.770 Test Loss: 0.588 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7248380184173584
Epoch: 35, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.624 Vali Acc: 0.783 Test Loss: 0.624 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 36 cost time: 1.4107990264892578
Epoch: 36, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8806207180023193
Epoch: 37, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.595 Vali Acc: 0.789 Test Loss: 0.595 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789468).  Saving model ...
Epoch: 38 cost time: 1.7402231693267822
Epoch: 38, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.601 Vali Acc: 0.803 Test Loss: 0.601 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 39 cost time: 1.6425237655639648
Epoch: 39, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.616 Vali Acc: 0.750 Test Loss: 0.616 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.502159595489502
Epoch: 40, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.635 Vali Acc: 0.763 Test Loss: 0.635 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.4831995964050293
Epoch: 41, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.597 Vali Acc: 0.776 Test Loss: 0.597 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.5274100303649902
Epoch: 42, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.620 Vali Acc: 0.763 Test Loss: 0.620 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.801016092300415
Epoch: 43, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.581 Vali Acc: 0.803 Test Loss: 0.581 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 44 cost time: 1.9093742370605469
Epoch: 44, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.621 Vali Acc: 0.783 Test Loss: 0.621 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.5628719329833984
Epoch: 45, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.642 Vali Acc: 0.789 Test Loss: 0.642 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.406390905380249
Epoch: 46, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.659 Vali Acc: 0.783 Test Loss: 0.659 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.4973571300506592
Epoch: 47, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.657 Vali Acc: 0.770 Test Loss: 0.657 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.571270227432251
Epoch: 48, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.7759931087493896
Epoch: 49, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.623 Vali Acc: 0.783 Test Loss: 0.623 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.121246099472046
Epoch: 50, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.633 Vali Acc: 0.783 Test Loss: 0.633 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.293848991394043
Epoch: 51, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.708 Vali Acc: 0.750 Test Loss: 0.708 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.633235216140747
Epoch: 52, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.680 Vali Acc: 0.783 Test Loss: 0.680 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.803140640258789
Epoch: 53, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.679 Vali Acc: 0.789 Test Loss: 0.679 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 241844
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2857072353363037
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.429 Vali Acc: 0.303 Test Loss: 1.429 Test Acc: 0.303
Validation loss decreased (inf --> -0.302617).  Saving model ...
Epoch: 2 cost time: 1.8300321102142334
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.339 Vali Acc: 0.322 Test Loss: 1.339 Test Acc: 0.322
Validation loss decreased (-0.302617 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.893218994140625
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.317 Vali Acc: 0.434 Test Loss: 1.317 Test Acc: 0.434
Validation loss decreased (-0.322355 --> -0.434197).  Saving model ...
Epoch: 4 cost time: 1.363614559173584
Epoch: 4, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.294 Vali Acc: 0.441 Test Loss: 1.294 Test Acc: 0.441
Validation loss decreased (-0.434197 --> -0.440777).  Saving model ...
Epoch: 5 cost time: 1.7096335887908936
Epoch: 5, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.246 Vali Acc: 0.500 Test Loss: 1.246 Test Acc: 0.500
Validation loss decreased (-0.440777 --> -0.499988).  Saving model ...
Epoch: 6 cost time: 1.8995592594146729
Epoch: 6, Steps: 10 | Train Loss: 1.178 Vali Loss: 1.198 Vali Acc: 0.454 Test Loss: 1.198 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.1499149799346924
Epoch: 7, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.182 Vali Acc: 0.461 Test Loss: 1.182 Test Acc: 0.461
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4884748458862305
Epoch: 8, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.111 Vali Acc: 0.586 Test Loss: 1.111 Test Acc: 0.586
Validation loss decreased (-0.499988 --> -0.585515).  Saving model ...
Epoch: 9 cost time: 1.4050321578979492
Epoch: 9, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.063 Vali Acc: 0.572 Test Loss: 1.063 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7382721900939941
Epoch: 10, Steps: 10 | Train Loss: 0.907 Vali Loss: 1.018 Vali Acc: 0.592 Test Loss: 1.018 Test Acc: 0.592
Validation loss decreased (-0.585515 --> -0.592095).  Saving model ...
Epoch: 11 cost time: 1.7189176082611084
Epoch: 11, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.969 Vali Acc: 0.632 Test Loss: 0.969 Test Acc: 0.632
Validation loss decreased (-0.592095 --> -0.631569).  Saving model ...
Epoch: 12 cost time: 1.8514015674591064
Epoch: 12, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.927 Vali Acc: 0.625 Test Loss: 0.927 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7035212516784668
Epoch: 13, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.896 Vali Acc: 0.658 Test Loss: 0.896 Test Acc: 0.658
Validation loss decreased (-0.631569 --> -0.657886).  Saving model ...
Epoch: 14 cost time: 1.7602651119232178
Epoch: 14, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.880 Vali Acc: 0.632 Test Loss: 0.880 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.94510817527771
Epoch: 15, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.839 Vali Acc: 0.651 Test Loss: 0.839 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3533008098602295
Epoch: 16, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.816 Vali Acc: 0.658 Test Loss: 0.816 Test Acc: 0.658
Validation loss decreased (-0.657886 --> -0.657887).  Saving model ...
Epoch: 17 cost time: 1.7383296489715576
Epoch: 17, Steps: 10 | Train Loss: 0.469 Vali Loss: 0.780 Vali Acc: 0.697 Test Loss: 0.780 Test Acc: 0.697
Validation loss decreased (-0.657887 --> -0.697361).  Saving model ...
Epoch: 18 cost time: 2.0884735584259033
Epoch: 18, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.774 Vali Acc: 0.691 Test Loss: 0.774 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8679001331329346
Epoch: 19, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.759 Vali Acc: 0.691 Test Loss: 0.759 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8865594863891602
Epoch: 20, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.739 Vali Acc: 0.704 Test Loss: 0.739 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 21 cost time: 1.4399082660675049
Epoch: 21, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.706 Vali Acc: 0.711 Test Loss: 0.706 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 22 cost time: 1.7023656368255615
Epoch: 22, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.696 Vali Acc: 0.724 Test Loss: 0.696 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 23 cost time: 1.777665615081787
Epoch: 23, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.675 Vali Acc: 0.730 Test Loss: 0.675 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 24 cost time: 1.7365219593048096
Epoch: 24, Steps: 10 | Train Loss: 0.288 Vali Loss: 0.738 Vali Acc: 0.704 Test Loss: 0.738 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8326561450958252
Epoch: 25, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.663 Vali Acc: 0.737 Test Loss: 0.663 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 26 cost time: 1.9149622917175293
Epoch: 26, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.634 Vali Acc: 0.730 Test Loss: 0.634 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4320948123931885
Epoch: 27, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.619 Vali Acc: 0.737 Test Loss: 0.619 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 28 cost time: 1.5025889873504639
Epoch: 28, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.622 Vali Acc: 0.737 Test Loss: 0.622 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6743309497833252
Epoch: 29, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.626 Vali Acc: 0.730 Test Loss: 0.626 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.699768304824829
Epoch: 30, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.631 Vali Acc: 0.757 Test Loss: 0.631 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 31 cost time: 1.9158401489257812
Epoch: 31, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 32 cost time: 1.7889354228973389
Epoch: 32, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.606 Vali Acc: 0.763 Test Loss: 0.606 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 33 cost time: 1.8233654499053955
Epoch: 33, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.3920793533325195
Epoch: 34, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.632 Vali Acc: 0.737 Test Loss: 0.632 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6767079830169678
Epoch: 35, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.659 Vali Acc: 0.737 Test Loss: 0.659 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4574778079986572
Epoch: 36, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.650 Vali Acc: 0.730 Test Loss: 0.650 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4904413223266602
Epoch: 37, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.651 Vali Acc: 0.730 Test Loss: 0.651 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.7043535709381104
Epoch: 38, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.674 Vali Acc: 0.717 Test Loss: 0.674 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.9131009578704834
Epoch: 39, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.675 Vali Acc: 0.717 Test Loss: 0.675 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6808462142944336
Epoch: 40, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.661 Vali Acc: 0.730 Test Loss: 0.661 Test Acc: 0.730
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.5982916355133057
Epoch: 41, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.706 Vali Acc: 0.717 Test Loss: 0.706 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.8982622623443604
Epoch: 42, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.715 Vali Acc: 0.737 Test Loss: 0.715 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7631578947368421
model parameter : 241652
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.140858888626099
Epoch: 1, Steps: 10 | Train Loss: 1.521 Vali Loss: 1.452 Vali Acc: 0.230 Test Loss: 1.452 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.7849066257476807
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.384 Vali Acc: 0.355 Test Loss: 1.384 Test Acc: 0.355
Validation loss decreased (-0.230249 --> -0.355249).  Saving model ...
Epoch: 3 cost time: 1.5568358898162842
Epoch: 3, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.394 Vali Acc: 0.355 Test Loss: 1.394 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9752018451690674
Epoch: 4, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.347 Vali Acc: 0.355 Test Loss: 1.347 Test Acc: 0.355
Validation loss decreased (-0.355249 --> -0.355250).  Saving model ...
Epoch: 5 cost time: 1.7678923606872559
Epoch: 5, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.304 Vali Acc: 0.467 Test Loss: 1.304 Test Acc: 0.467
Validation loss decreased (-0.355250 --> -0.467092).  Saving model ...
Epoch: 6 cost time: 1.4883804321289062
Epoch: 6, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.276 Vali Acc: 0.493 Test Loss: 1.276 Test Acc: 0.493
Validation loss decreased (-0.467092 --> -0.493408).  Saving model ...
Epoch: 7 cost time: 1.9502875804901123
Epoch: 7, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.219 Vali Acc: 0.566 Test Loss: 1.219 Test Acc: 0.566
Validation loss decreased (-0.493408 --> -0.565777).  Saving model ...
Epoch: 8 cost time: 1.9586760997772217
Epoch: 8, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.168 Vali Acc: 0.559 Test Loss: 1.168 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.334764003753662
Epoch: 9, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.082 Vali Acc: 0.592 Test Loss: 1.082 Test Acc: 0.592
Validation loss decreased (-0.565777 --> -0.592094).  Saving model ...
Epoch: 10 cost time: 1.4027354717254639
Epoch: 10, Steps: 10 | Train Loss: 0.902 Vali Loss: 1.041 Vali Acc: 0.599 Test Loss: 1.041 Test Acc: 0.599
Validation loss decreased (-0.592094 --> -0.598674).  Saving model ...
Epoch: 11 cost time: 1.4910273551940918
Epoch: 11, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.956 Vali Acc: 0.632 Test Loss: 0.956 Test Acc: 0.632
Validation loss decreased (-0.598674 --> -0.631569).  Saving model ...
Epoch: 12 cost time: 1.5192182064056396
Epoch: 12, Steps: 10 | Train Loss: 0.709 Vali Loss: 0.900 Vali Acc: 0.678 Test Loss: 0.900 Test Acc: 0.678
Validation loss decreased (-0.631569 --> -0.677623).  Saving model ...
Epoch: 13 cost time: 1.6000733375549316
Epoch: 13, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.830 Vali Acc: 0.691 Test Loss: 0.830 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690781).  Saving model ...
Epoch: 14 cost time: 1.6892399787902832
Epoch: 14, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.796 Vali Acc: 0.711 Test Loss: 0.796 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710518).  Saving model ...
Epoch: 15 cost time: 1.605132818222046
Epoch: 15, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.755 Vali Acc: 0.730 Test Loss: 0.755 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 16 cost time: 1.6568317413330078
Epoch: 16, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.721 Vali Acc: 0.737 Test Loss: 0.721 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 17 cost time: 1.694545030593872
Epoch: 17, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.679 Vali Acc: 0.724 Test Loss: 0.679 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4363739490509033
Epoch: 18, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.688 Vali Acc: 0.724 Test Loss: 0.688 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5574243068695068
Epoch: 19, Steps: 10 | Train Loss: 0.397 Vali Loss: 0.622 Vali Acc: 0.743 Test Loss: 0.622 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 20 cost time: 1.8719258308410645
Epoch: 20, Steps: 10 | Train Loss: 0.381 Vali Loss: 0.638 Vali Acc: 0.717 Test Loss: 0.638 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9980182647705078
Epoch: 21, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.590 Vali Acc: 0.750 Test Loss: 0.590 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 22 cost time: 1.6809916496276855
Epoch: 22, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.607 Vali Acc: 0.750 Test Loss: 0.607 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7893860340118408
Epoch: 23, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.523 Vali Acc: 0.776 Test Loss: 0.523 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776311).  Saving model ...
Epoch: 24 cost time: 1.5148658752441406
Epoch: 24, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 25 cost time: 1.8869624137878418
Epoch: 25, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.504 Vali Acc: 0.770 Test Loss: 0.504 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7800335884094238
Epoch: 26, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
Validation loss decreased (-0.782890 --> -0.809206).  Saving model ...
Epoch: 27 cost time: 2.0728604793548584
Epoch: 27, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.487 Vali Acc: 0.803 Test Loss: 0.487 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.3873085975646973
Epoch: 28, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.490 Vali Acc: 0.783 Test Loss: 0.490 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5835931301116943
Epoch: 29, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.485 Vali Acc: 0.816 Test Loss: 0.485 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 30 cost time: 1.938081979751587
Epoch: 30, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.014174461364746
Epoch: 31, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.506 Vali Acc: 0.789 Test Loss: 0.506 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7044792175292969
Epoch: 32, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7768898010253906
Epoch: 33, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.507 Vali Acc: 0.829 Test Loss: 0.507 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828942).  Saving model ...
Epoch: 34 cost time: 2.073413848876953
Epoch: 34, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.9148848056793213
Epoch: 35, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.7719054222106934
Epoch: 36, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.511 Vali Acc: 0.829 Test Loss: 0.511 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.8320236206054688
Epoch: 37, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.695361614227295
Epoch: 38, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.535 Vali Acc: 0.822 Test Loss: 0.535 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.9293384552001953
Epoch: 39, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.567 Vali Acc: 0.789 Test Loss: 0.567 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.8396146297454834
Epoch: 40, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.950826644897461
Epoch: 41, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.500 Vali Acc: 0.809 Test Loss: 0.500 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.0983736515045166
Epoch: 42, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.510 Vali Acc: 0.816 Test Loss: 0.510 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.089777946472168
Epoch: 43, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 241460
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.093880653381348
Epoch: 1, Steps: 10 | Train Loss: 1.679 Vali Loss: 1.617 Vali Acc: 0.204 Test Loss: 1.617 Test Acc: 0.204
Validation loss decreased (inf --> -0.203931).  Saving model ...
Epoch: 2 cost time: 1.658684253692627
Epoch: 2, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.488 Vali Acc: 0.211 Test Loss: 1.488 Test Acc: 0.211
Validation loss decreased (-0.203931 --> -0.210511).  Saving model ...
Epoch: 3 cost time: 1.79056978225708
Epoch: 3, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.459 Vali Acc: 0.211 Test Loss: 1.459 Test Acc: 0.211
Validation loss decreased (-0.210511 --> -0.210512).  Saving model ...
Epoch: 4 cost time: 1.5255448818206787
Epoch: 4, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.427 Vali Acc: 0.191 Test Loss: 1.427 Test Acc: 0.191
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.249744415283203
Epoch: 5, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.401 Vali Acc: 0.243 Test Loss: 1.401 Test Acc: 0.243
Validation loss decreased (-0.210512 --> -0.243407).  Saving model ...
Epoch: 6 cost time: 1.5944557189941406
Epoch: 6, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.381 Vali Acc: 0.263 Test Loss: 1.381 Test Acc: 0.263
Validation loss decreased (-0.243407 --> -0.263144).  Saving model ...
Epoch: 7 cost time: 1.7468469142913818
Epoch: 7, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.359 Vali Acc: 0.316 Test Loss: 1.359 Test Acc: 0.316
Validation loss decreased (-0.263144 --> -0.315776).  Saving model ...
Epoch: 8 cost time: 1.608152151107788
Epoch: 8, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.332 Vali Acc: 0.336 Test Loss: 1.332 Test Acc: 0.336
Validation loss decreased (-0.315776 --> -0.335513).  Saving model ...
Epoch: 9 cost time: 1.6672427654266357
Epoch: 9, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.300 Vali Acc: 0.382 Test Loss: 1.300 Test Acc: 0.382
Validation loss decreased (-0.335513 --> -0.381566).  Saving model ...
Epoch: 10 cost time: 1.5632483959197998
Epoch: 10, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.264 Vali Acc: 0.421 Test Loss: 1.264 Test Acc: 0.421
Validation loss decreased (-0.381566 --> -0.421040).  Saving model ...
Epoch: 11 cost time: 1.8193697929382324
Epoch: 11, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.230 Vali Acc: 0.441 Test Loss: 1.230 Test Acc: 0.441
Validation loss decreased (-0.421040 --> -0.440777).  Saving model ...
Epoch: 12 cost time: 1.9448435306549072
Epoch: 12, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.174 Vali Acc: 0.467 Test Loss: 1.174 Test Acc: 0.467
Validation loss decreased (-0.440777 --> -0.467094).  Saving model ...
Epoch: 13 cost time: 1.9237163066864014
Epoch: 13, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.141 Vali Acc: 0.513 Test Loss: 1.141 Test Acc: 0.513
Validation loss decreased (-0.467094 --> -0.513146).  Saving model ...
Epoch: 14 cost time: 2.015141010284424
Epoch: 14, Steps: 10 | Train Loss: 0.849 Vali Loss: 1.060 Vali Acc: 0.553 Test Loss: 1.060 Test Acc: 0.553
Validation loss decreased (-0.513146 --> -0.552621).  Saving model ...
Epoch: 15 cost time: 1.662879467010498
Epoch: 15, Steps: 10 | Train Loss: 0.822 Vali Loss: 1.019 Vali Acc: 0.572 Test Loss: 1.019 Test Acc: 0.572
Validation loss decreased (-0.552621 --> -0.572358).  Saving model ...
Epoch: 16 cost time: 1.4138798713684082
Epoch: 16, Steps: 10 | Train Loss: 0.679 Vali Loss: 0.940 Vali Acc: 0.618 Test Loss: 0.940 Test Acc: 0.618
Validation loss decreased (-0.572358 --> -0.618412).  Saving model ...
Epoch: 17 cost time: 1.7359364032745361
Epoch: 17, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.910 Vali Acc: 0.572 Test Loss: 0.910 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.796640396118164
Epoch: 18, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.841 Vali Acc: 0.651 Test Loss: 0.841 Test Acc: 0.651
Validation loss decreased (-0.618412 --> -0.651307).  Saving model ...
Epoch: 19 cost time: 1.6625263690948486
Epoch: 19, Steps: 10 | Train Loss: 0.543 Vali Loss: 0.801 Vali Acc: 0.664 Test Loss: 0.801 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664466).  Saving model ...
Epoch: 20 cost time: 1.8268284797668457
Epoch: 20, Steps: 10 | Train Loss: 0.486 Vali Loss: 0.755 Vali Acc: 0.678 Test Loss: 0.755 Test Acc: 0.678
Validation loss decreased (-0.664466 --> -0.677624).  Saving model ...
Epoch: 21 cost time: 1.4829092025756836
Epoch: 21, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.700 Vali Acc: 0.691 Test Loss: 0.700 Test Acc: 0.691
Validation loss decreased (-0.677624 --> -0.690782).  Saving model ...
Epoch: 22 cost time: 1.5181434154510498
Epoch: 22, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.681 Vali Acc: 0.691 Test Loss: 0.681 Test Acc: 0.691
Validation loss decreased (-0.690782 --> -0.690783).  Saving model ...
Epoch: 23 cost time: 1.4904181957244873
Epoch: 23, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.655 Vali Acc: 0.724 Test Loss: 0.655 Test Acc: 0.724
Validation loss decreased (-0.690783 --> -0.723678).  Saving model ...
Epoch: 24 cost time: 1.733034610748291
Epoch: 24, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.619 Vali Acc: 0.757 Test Loss: 0.619 Test Acc: 0.757
Validation loss decreased (-0.723678 --> -0.756573).  Saving model ...
Epoch: 25 cost time: 1.6043932437896729
Epoch: 25, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.584 Vali Acc: 0.750 Test Loss: 0.584 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7349600791931152
Epoch: 26, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.570 Vali Acc: 0.743 Test Loss: 0.570 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.032737970352173
Epoch: 27, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.565 Vali Acc: 0.730 Test Loss: 0.565 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5963134765625
Epoch: 28, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.546 Vali Acc: 0.750 Test Loss: 0.546 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.6054861545562744
Epoch: 29, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.577 Vali Acc: 0.757 Test Loss: 0.577 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 30 cost time: 1.9225807189941406
Epoch: 30, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.549 Vali Acc: 0.750 Test Loss: 0.549 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9246647357940674
Epoch: 31, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.566 Vali Acc: 0.757 Test Loss: 0.566 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 32 cost time: 1.8800280094146729
Epoch: 32, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.540 Vali Acc: 0.763 Test Loss: 0.540 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 33 cost time: 1.7400882244110107
Epoch: 33, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.512 Vali Acc: 0.770 Test Loss: 0.512 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769732).  Saving model ...
Epoch: 34 cost time: 1.7452964782714844
Epoch: 34, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.531 Vali Acc: 0.757 Test Loss: 0.531 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3836359977722168
Epoch: 35, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.518 Vali Acc: 0.757 Test Loss: 0.518 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4462206363677979
Epoch: 36, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.518 Vali Acc: 0.770 Test Loss: 0.518 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.6434645652770996
Epoch: 37, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.7710943222045898
Epoch: 38, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.579 Vali Acc: 0.763 Test Loss: 0.579 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.418368101119995
Epoch: 39, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782889).  Saving model ...
Epoch: 40 cost time: 1.6624891757965088
Epoch: 40, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 41 cost time: 1.8170104026794434
Epoch: 41, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.572 Vali Acc: 0.763 Test Loss: 0.572 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7396948337554932
Epoch: 42, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 43 cost time: 1.673901081085205
Epoch: 43, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.566 Vali Acc: 0.776 Test Loss: 0.566 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.956651210784912
Epoch: 44, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.618 Vali Acc: 0.763 Test Loss: 0.618 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.7948191165924072
Epoch: 45, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.623 Vali Acc: 0.789 Test Loss: 0.623 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 46 cost time: 2.0772223472595215
Epoch: 46, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.623 Vali Acc: 0.770 Test Loss: 0.623 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.5969750881195068
Epoch: 47, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.680 Vali Acc: 0.757 Test Loss: 0.680 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.654956340789795
Epoch: 48, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.683 Vali Acc: 0.789 Test Loss: 0.683 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.7148282527923584
Epoch: 49, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.622 Vali Acc: 0.763 Test Loss: 0.622 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.5723464488983154
Epoch: 50, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.653 Vali Acc: 0.776 Test Loss: 0.653 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.6573290824890137
Epoch: 51, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 2.191370964050293
Epoch: 52, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.678 Vali Acc: 0.770 Test Loss: 0.678 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.8972103595733643
Epoch: 53, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.695 Vali Acc: 0.763 Test Loss: 0.695 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.9382059574127197
Epoch: 54, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.8148462772369385
Epoch: 55, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.626 Vali Acc: 0.757 Test Loss: 0.626 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 241268
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.305948734283447
Epoch: 1, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.391 Vali Acc: 0.230 Test Loss: 1.391 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.8203673362731934
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.382 Vali Acc: 0.283 Test Loss: 1.382 Test Acc: 0.283
Validation loss decreased (-0.230249 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.622434139251709
Epoch: 3, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.363 Vali Acc: 0.349 Test Loss: 1.363 Test Acc: 0.349
Validation loss decreased (-0.282881 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 1.4195823669433594
Epoch: 4, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.342 Vali Acc: 0.355 Test Loss: 1.342 Test Acc: 0.355
Validation loss decreased (-0.348671 --> -0.355250).  Saving model ...
Epoch: 5 cost time: 1.5353350639343262
Epoch: 5, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.325 Vali Acc: 0.349 Test Loss: 1.325 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.164785385131836
Epoch: 6, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.298 Vali Acc: 0.395 Test Loss: 1.298 Test Acc: 0.395
Validation loss decreased (-0.355250 --> -0.394724).  Saving model ...
Epoch: 7 cost time: 1.7442891597747803
Epoch: 7, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.268 Vali Acc: 0.434 Test Loss: 1.268 Test Acc: 0.434
Validation loss decreased (-0.394724 --> -0.434198).  Saving model ...
Epoch: 8 cost time: 1.4018933773040771
Epoch: 8, Steps: 10 | Train Loss: 1.209 Vali Loss: 1.234 Vali Acc: 0.474 Test Loss: 1.234 Test Acc: 0.474
Validation loss decreased (-0.434198 --> -0.473672).  Saving model ...
Epoch: 9 cost time: 2.052959680557251
Epoch: 9, Steps: 10 | Train Loss: 1.146 Vali Loss: 1.189 Vali Acc: 0.461 Test Loss: 1.189 Test Acc: 0.461
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2338714599609375
Epoch: 10, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.132 Vali Acc: 0.533 Test Loss: 1.132 Test Acc: 0.533
Validation loss decreased (-0.473672 --> -0.532883).  Saving model ...
Epoch: 11 cost time: 2.193636655807495
Epoch: 11, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.088 Vali Acc: 0.553 Test Loss: 1.088 Test Acc: 0.553
Validation loss decreased (-0.532883 --> -0.552621).  Saving model ...
Epoch: 12 cost time: 1.504610300064087
Epoch: 12, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.020 Vali Acc: 0.539 Test Loss: 1.020 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.221275568008423
Epoch: 13, Steps: 10 | Train Loss: 0.852 Vali Loss: 0.960 Vali Acc: 0.605 Test Loss: 0.960 Test Acc: 0.605
Validation loss decreased (-0.552621 --> -0.605254).  Saving model ...
Epoch: 14 cost time: 1.7678182125091553
Epoch: 14, Steps: 10 | Train Loss: 0.786 Vali Loss: 0.924 Vali Acc: 0.579 Test Loss: 0.924 Test Acc: 0.579
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7493817806243896
Epoch: 15, Steps: 10 | Train Loss: 0.697 Vali Loss: 0.859 Vali Acc: 0.632 Test Loss: 0.859 Test Acc: 0.632
Validation loss decreased (-0.605254 --> -0.631570).  Saving model ...
Epoch: 16 cost time: 2.1727309226989746
Epoch: 16, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.797 Vali Acc: 0.691 Test Loss: 0.797 Test Acc: 0.691
Validation loss decreased (-0.631570 --> -0.690782).  Saving model ...
Epoch: 17 cost time: 1.9065117835998535
Epoch: 17, Steps: 10 | Train Loss: 0.585 Vali Loss: 0.762 Vali Acc: 0.671 Test Loss: 0.762 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.083617687225342
Epoch: 18, Steps: 10 | Train Loss: 0.516 Vali Loss: 0.716 Vali Acc: 0.704 Test Loss: 0.716 Test Acc: 0.704
Validation loss decreased (-0.690782 --> -0.703940).  Saving model ...
Epoch: 19 cost time: 2.021693468093872
Epoch: 19, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.679 Vali Acc: 0.691 Test Loss: 0.679 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2535829544067383
Epoch: 20, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.645 Vali Acc: 0.730 Test Loss: 0.645 Test Acc: 0.730
Validation loss decreased (-0.703940 --> -0.730257).  Saving model ...
Epoch: 21 cost time: 1.970595121383667
Epoch: 21, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.633 Vali Acc: 0.737 Test Loss: 0.633 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 22 cost time: 1.750983476638794
Epoch: 22, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.600 Vali Acc: 0.743 Test Loss: 0.600 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 23 cost time: 2.0434787273406982
Epoch: 23, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.584 Vali Acc: 0.750 Test Loss: 0.584 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 24 cost time: 2.2045700550079346
Epoch: 24, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.568 Vali Acc: 0.750 Test Loss: 0.568 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 25 cost time: 2.2314610481262207
Epoch: 25, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.564 Vali Acc: 0.750 Test Loss: 0.564 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 26 cost time: 1.7086386680603027
Epoch: 26, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.582 Vali Acc: 0.757 Test Loss: 0.582 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 27 cost time: 2.1897811889648438
Epoch: 27, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.562 Vali Acc: 0.743 Test Loss: 0.562 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.0778489112854004
Epoch: 28, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776311).  Saving model ...
Epoch: 29 cost time: 1.632025957107544
Epoch: 29, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.513 Vali Acc: 0.770 Test Loss: 0.513 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9361824989318848
Epoch: 30, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789469).  Saving model ...
Epoch: 31 cost time: 2.0508997440338135
Epoch: 31, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0795536041259766
Epoch: 32, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.502 Vali Acc: 0.776 Test Loss: 0.502 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7432856559753418
Epoch: 33, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.503 Vali Acc: 0.796 Test Loss: 0.503 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 34 cost time: 1.9666404724121094
Epoch: 34, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.8300857543945312
Epoch: 35, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 36 cost time: 2.019454002380371
Epoch: 36, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.8119027614593506
Epoch: 37, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.3849143981933594
Epoch: 38, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.507 Vali Acc: 0.770 Test Loss: 0.507 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.699901819229126
Epoch: 39, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.512 Vali Acc: 0.789 Test Loss: 0.512 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 2.0332489013671875
Epoch: 40, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.656982421875
Epoch: 41, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.9204330444335938
Epoch: 42, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 2.2457382678985596
Epoch: 43, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.523 Vali Acc: 0.816 Test Loss: 0.523 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815784).  Saving model ...
Epoch: 44 cost time: 2.245497703552246
Epoch: 44, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.9107561111450195
Epoch: 45, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.526442527770996
Epoch: 46, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.131655693054199
Epoch: 47, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 2.0181119441986084
Epoch: 48, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.8510382175445557
Epoch: 49, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 2.1446187496185303
Epoch: 50, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 2.0540101528167725
Epoch: 51, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.8110039234161377
Epoch: 52, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.575 Vali Acc: 0.803 Test Loss: 0.575 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.8943827152252197
Epoch: 53, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.583 Vali Acc: 0.803 Test Loss: 0.583 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 183604
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.094184637069702
Epoch: 1, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.414 Vali Acc: 0.336 Test Loss: 1.414 Test Acc: 0.336
Validation loss decreased (inf --> -0.335512).  Saving model ...
Epoch: 2 cost time: 1.8371572494506836
Epoch: 2, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.386 Vali Acc: 0.329 Test Loss: 1.386 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2907843589782715
Epoch: 3, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.366 Vali Acc: 0.316 Test Loss: 1.366 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9956705570220947
Epoch: 4, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.347 Vali Acc: 0.329 Test Loss: 1.347 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7990481853485107
Epoch: 5, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.325 Vali Acc: 0.322 Test Loss: 1.325 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3788390159606934
Epoch: 6, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.296 Vali Acc: 0.395 Test Loss: 1.296 Test Acc: 0.395
Validation loss decreased (-0.335512 --> -0.394724).  Saving model ...
Epoch: 7 cost time: 1.6296215057373047
Epoch: 7, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.264 Vali Acc: 0.375 Test Loss: 1.264 Test Acc: 0.375
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8551249504089355
Epoch: 8, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.233 Vali Acc: 0.441 Test Loss: 1.233 Test Acc: 0.441
Validation loss decreased (-0.394724 --> -0.440777).  Saving model ...
Epoch: 9 cost time: 1.990769386291504
Epoch: 9, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.201 Vali Acc: 0.454 Test Loss: 1.201 Test Acc: 0.454
Validation loss decreased (-0.440777 --> -0.453935).  Saving model ...
Epoch: 10 cost time: 1.7685515880584717
Epoch: 10, Steps: 10 | Train Loss: 1.072 Vali Loss: 1.158 Vali Acc: 0.467 Test Loss: 1.158 Test Acc: 0.467
Validation loss decreased (-0.453935 --> -0.467094).  Saving model ...
Epoch: 11 cost time: 1.7790272235870361
Epoch: 11, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.116 Vali Acc: 0.507 Test Loss: 1.116 Test Acc: 0.507
Validation loss decreased (-0.467094 --> -0.506568).  Saving model ...
Epoch: 12 cost time: 2.127098321914673
Epoch: 12, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.093 Vali Acc: 0.520 Test Loss: 1.093 Test Acc: 0.520
Validation loss decreased (-0.506568 --> -0.519726).  Saving model ...
Epoch: 13 cost time: 1.6034533977508545
Epoch: 13, Steps: 10 | Train Loss: 0.885 Vali Loss: 1.040 Vali Acc: 0.539 Test Loss: 1.040 Test Acc: 0.539
Validation loss decreased (-0.519726 --> -0.539463).  Saving model ...
Epoch: 14 cost time: 2.1349260807037354
Epoch: 14, Steps: 10 | Train Loss: 0.835 Vali Loss: 0.994 Vali Acc: 0.605 Test Loss: 0.994 Test Acc: 0.605
Validation loss decreased (-0.539463 --> -0.605253).  Saving model ...
Epoch: 15 cost time: 2.0846097469329834
Epoch: 15, Steps: 10 | Train Loss: 0.751 Vali Loss: 0.945 Vali Acc: 0.638 Test Loss: 0.945 Test Acc: 0.638
Validation loss decreased (-0.605253 --> -0.638148).  Saving model ...
Epoch: 16 cost time: 2.1523215770721436
Epoch: 16, Steps: 10 | Train Loss: 0.733 Vali Loss: 0.900 Vali Acc: 0.651 Test Loss: 0.900 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651307).  Saving model ...
Epoch: 17 cost time: 2.068124532699585
Epoch: 17, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.874 Vali Acc: 0.632 Test Loss: 0.874 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.864328145980835
Epoch: 18, Steps: 10 | Train Loss: 0.628 Vali Loss: 0.845 Vali Acc: 0.651 Test Loss: 0.845 Test Acc: 0.651
Validation loss decreased (-0.651307 --> -0.651307).  Saving model ...
Epoch: 19 cost time: 1.8353941440582275
Epoch: 19, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.805 Vali Acc: 0.658 Test Loss: 0.805 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657887).  Saving model ...
Epoch: 20 cost time: 1.89833664894104
Epoch: 20, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.771 Vali Acc: 0.678 Test Loss: 0.771 Test Acc: 0.678
Validation loss decreased (-0.657887 --> -0.677624).  Saving model ...
Epoch: 21 cost time: 2.142881155014038
Epoch: 21, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.745 Vali Acc: 0.678 Test Loss: 0.745 Test Acc: 0.678
Validation loss decreased (-0.677624 --> -0.677624).  Saving model ...
Epoch: 22 cost time: 1.7020297050476074
Epoch: 22, Steps: 10 | Train Loss: 0.424 Vali Loss: 0.718 Vali Acc: 0.730 Test Loss: 0.718 Test Acc: 0.730
Validation loss decreased (-0.677624 --> -0.730256).  Saving model ...
Epoch: 23 cost time: 1.7928550243377686
Epoch: 23, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.682 Vali Acc: 0.717 Test Loss: 0.682 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1691842079162598
Epoch: 24, Steps: 10 | Train Loss: 0.377 Vali Loss: 0.655 Vali Acc: 0.724 Test Loss: 0.655 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8432433605194092
Epoch: 25, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.636 Vali Acc: 0.711 Test Loss: 0.636 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.056077480316162
Epoch: 26, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.627 Vali Acc: 0.711 Test Loss: 0.627 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.140674591064453
Epoch: 27, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.620 Vali Acc: 0.691 Test Loss: 0.620 Test Acc: 0.691
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9693012237548828
Epoch: 28, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 29 cost time: 1.7445282936096191
Epoch: 29, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.588 Vali Acc: 0.711 Test Loss: 0.588 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8686599731445312
Epoch: 30, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.574 Vali Acc: 0.757 Test Loss: 0.574 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 31 cost time: 1.5933802127838135
Epoch: 31, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 32 cost time: 1.6951687335968018
Epoch: 32, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.9847025871276855
Epoch: 33, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.554 Vali Acc: 0.757 Test Loss: 0.554 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5933032035827637
Epoch: 34, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.279553174972534
Epoch: 35, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.557 Vali Acc: 0.770 Test Loss: 0.557 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 36 cost time: 1.8373289108276367
Epoch: 36, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 37 cost time: 1.8527114391326904
Epoch: 37, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9222958087921143
Epoch: 38, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.834855318069458
Epoch: 39, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7907700538635254
Epoch: 40, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.598 Vali Acc: 0.750 Test Loss: 0.598 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.7639284133911133
Epoch: 41, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.631 Vali Acc: 0.763 Test Loss: 0.631 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.9359114170074463
Epoch: 42, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.616 Vali Acc: 0.770 Test Loss: 0.616 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.6219482421875
Epoch: 43, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.625 Vali Acc: 0.757 Test Loss: 0.625 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.4728147983551025
Epoch: 44, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.694 Vali Acc: 0.783 Test Loss: 0.694 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 45 cost time: 1.6372759342193604
Epoch: 45, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.649 Vali Acc: 0.770 Test Loss: 0.649 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 2.148904323577881
Epoch: 46, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.676 Vali Acc: 0.770 Test Loss: 0.676 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.8761804103851318
Epoch: 47, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.671 Vali Acc: 0.783 Test Loss: 0.671 Test Acc: 0.783
Validation loss decreased (-0.782888 --> -0.782888).  Saving model ...
Epoch: 48 cost time: 1.8016669750213623
Epoch: 48, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.692 Vali Acc: 0.783 Test Loss: 0.692 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.633347749710083
Epoch: 49, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.795 Vali Acc: 0.757 Test Loss: 0.795 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.6363532543182373
Epoch: 50, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.730 Vali Acc: 0.770 Test Loss: 0.730 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 1.9551739692687988
Epoch: 51, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.741 Vali Acc: 0.770 Test Loss: 0.741 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.8242366313934326
Epoch: 52, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.716 Vali Acc: 0.763 Test Loss: 0.716 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.8295025825500488
Epoch: 53, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.765 Vali Acc: 0.757 Test Loss: 0.765 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.7106387615203857
Epoch: 54, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.768 Vali Acc: 0.770 Test Loss: 0.768 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 1.7689874172210693
Epoch: 55, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.711 Vali Acc: 0.776 Test Loss: 0.711 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.7365283966064453
Epoch: 56, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.788 Vali Acc: 0.770 Test Loss: 0.788 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 1.7467670440673828
Epoch: 57, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.760 Vali Acc: 0.776 Test Loss: 0.760 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 183412
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7648508548736572
Epoch: 1, Steps: 10 | Train Loss: 1.650 Vali Loss: 1.512 Vali Acc: 0.250 Test Loss: 1.512 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.6673963069915771
Epoch: 2, Steps: 10 | Train Loss: 1.504 Vali Loss: 1.413 Vali Acc: 0.204 Test Loss: 1.413 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.863734245300293
Epoch: 3, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.401 Vali Acc: 0.342 Test Loss: 1.401 Test Acc: 0.342
Validation loss decreased (-0.249985 --> -0.342091).  Saving model ...
Epoch: 4 cost time: 1.6146149635314941
Epoch: 4, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.375 Vali Acc: 0.382 Test Loss: 1.375 Test Acc: 0.382
Validation loss decreased (-0.342091 --> -0.381565).  Saving model ...
Epoch: 5 cost time: 2.2108960151672363
Epoch: 5, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.340 Vali Acc: 0.401 Test Loss: 1.340 Test Acc: 0.401
Validation loss decreased (-0.381565 --> -0.401302).  Saving model ...
Epoch: 6 cost time: 1.7145264148712158
Epoch: 6, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.317 Vali Acc: 0.421 Test Loss: 1.317 Test Acc: 0.421
Validation loss decreased (-0.401302 --> -0.421039).  Saving model ...
Epoch: 7 cost time: 1.9580097198486328
Epoch: 7, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.291 Vali Acc: 0.447 Test Loss: 1.291 Test Acc: 0.447
Validation loss decreased (-0.421039 --> -0.447356).  Saving model ...
Epoch: 8 cost time: 1.8415391445159912
Epoch: 8, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.266 Vali Acc: 0.493 Test Loss: 1.266 Test Acc: 0.493
Validation loss decreased (-0.447356 --> -0.493408).  Saving model ...
Epoch: 9 cost time: 1.9454843997955322
Epoch: 9, Steps: 10 | Train Loss: 1.221 Vali Loss: 1.229 Vali Acc: 0.507 Test Loss: 1.229 Test Acc: 0.507
Validation loss decreased (-0.493408 --> -0.506567).  Saving model ...
Epoch: 10 cost time: 2.012927532196045
Epoch: 10, Steps: 10 | Train Loss: 1.167 Vali Loss: 1.197 Vali Acc: 0.500 Test Loss: 1.197 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7326602935791016
Epoch: 11, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.144 Vali Acc: 0.513 Test Loss: 1.144 Test Acc: 0.513
Validation loss decreased (-0.506567 --> -0.513146).  Saving model ...
Epoch: 12 cost time: 2.3338730335235596
Epoch: 12, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.118 Vali Acc: 0.546 Test Loss: 1.118 Test Acc: 0.546
Validation loss decreased (-0.513146 --> -0.546041).  Saving model ...
Epoch: 13 cost time: 1.7977397441864014
Epoch: 13, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.041 Vali Acc: 0.586 Test Loss: 1.041 Test Acc: 0.586
Validation loss decreased (-0.546041 --> -0.585516).  Saving model ...
Epoch: 14 cost time: 1.4819984436035156
Epoch: 14, Steps: 10 | Train Loss: 0.840 Vali Loss: 0.990 Vali Acc: 0.592 Test Loss: 0.990 Test Acc: 0.592
Validation loss decreased (-0.585516 --> -0.592095).  Saving model ...
Epoch: 15 cost time: 1.8222508430480957
Epoch: 15, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.939 Vali Acc: 0.612 Test Loss: 0.939 Test Acc: 0.612
Validation loss decreased (-0.592095 --> -0.611833).  Saving model ...
Epoch: 16 cost time: 2.0199320316314697
Epoch: 16, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.866 Vali Acc: 0.664 Test Loss: 0.866 Test Acc: 0.664
Validation loss decreased (-0.611833 --> -0.664465).  Saving model ...
Epoch: 17 cost time: 1.525653600692749
Epoch: 17, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.845 Vali Acc: 0.638 Test Loss: 0.845 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0759799480438232
Epoch: 18, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.773 Vali Acc: 0.691 Test Loss: 0.773 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690782).  Saving model ...
Epoch: 19 cost time: 2.0868356227874756
Epoch: 19, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.754 Vali Acc: 0.711 Test Loss: 0.754 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710519).  Saving model ...
Epoch: 20 cost time: 1.885291576385498
Epoch: 20, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.731 Vali Acc: 0.704 Test Loss: 0.731 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4741206169128418
Epoch: 21, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.733 Vali Acc: 0.711 Test Loss: 0.733 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 22 cost time: 2.2432587146759033
Epoch: 22, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.719 Vali Acc: 0.697 Test Loss: 0.719 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3063595294952393
Epoch: 23, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.677 Vali Acc: 0.704 Test Loss: 0.677 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9807195663452148
Epoch: 24, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.645 Vali Acc: 0.697 Test Loss: 0.645 Test Acc: 0.697
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.9218757152557373
Epoch: 25, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.628 Vali Acc: 0.730 Test Loss: 0.628 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730257).  Saving model ...
Epoch: 26 cost time: 1.8477723598480225
Epoch: 26, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.632 Vali Acc: 0.717 Test Loss: 0.632 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.9922122955322266
Epoch: 27, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.599 Vali Acc: 0.743 Test Loss: 0.599 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 28 cost time: 1.658756971359253
Epoch: 28, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.593 Vali Acc: 0.717 Test Loss: 0.593 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7780508995056152
Epoch: 29, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.581 Vali Acc: 0.750 Test Loss: 0.581 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 30 cost time: 1.6658272743225098
Epoch: 30, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.615 Vali Acc: 0.724 Test Loss: 0.615 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4859042167663574
Epoch: 31, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.588 Vali Acc: 0.776 Test Loss: 0.588 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776310).  Saving model ...
Epoch: 32 cost time: 1.8234105110168457
Epoch: 32, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.561 Vali Acc: 0.743 Test Loss: 0.561 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6819117069244385
Epoch: 33, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.559 Vali Acc: 0.763 Test Loss: 0.559 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.2429909706115723
Epoch: 34, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.585 Vali Acc: 0.750 Test Loss: 0.585 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.708573818206787
Epoch: 35, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.556 Vali Acc: 0.730 Test Loss: 0.556 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.9428744316101074
Epoch: 36, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.579 Vali Acc: 0.743 Test Loss: 0.579 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.946687936782837
Epoch: 37, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.555 Vali Acc: 0.724 Test Loss: 0.555 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.8735551834106445
Epoch: 38, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 39 cost time: 1.6047651767730713
Epoch: 39, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.563 Vali Acc: 0.750 Test Loss: 0.563 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6547460556030273
Epoch: 40, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 41 cost time: 2.072587013244629
Epoch: 41, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.602 Vali Acc: 0.763 Test Loss: 0.602 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.6653733253479004
Epoch: 42, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.611 Vali Acc: 0.770 Test Loss: 0.611 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 2.0644965171813965
Epoch: 43, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.641 Vali Acc: 0.796 Test Loss: 0.641 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 44 cost time: 1.7749223709106445
Epoch: 44, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.628 Vali Acc: 0.757 Test Loss: 0.628 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 2.001873731613159
Epoch: 45, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.667 Vali Acc: 0.803 Test Loss: 0.667 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 46 cost time: 2.1056466102600098
Epoch: 46, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.665 Vali Acc: 0.770 Test Loss: 0.665 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.6876623630523682
Epoch: 47, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.664 Vali Acc: 0.796 Test Loss: 0.664 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.694427728652954
Epoch: 48, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.679 Vali Acc: 0.776 Test Loss: 0.679 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.9998948574066162
Epoch: 49, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.699 Vali Acc: 0.763 Test Loss: 0.699 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 2.0513792037963867
Epoch: 50, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.699 Vali Acc: 0.783 Test Loss: 0.699 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.7789762020111084
Epoch: 51, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.753 Vali Acc: 0.770 Test Loss: 0.753 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.5261194705963135
Epoch: 52, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.712 Vali Acc: 0.770 Test Loss: 0.712 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.8919994831085205
Epoch: 53, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.755 Vali Acc: 0.789 Test Loss: 0.755 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.8258693218231201
Epoch: 54, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.801 Vali Acc: 0.757 Test Loss: 0.801 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.6609349250793457
Epoch: 55, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.841 Vali Acc: 0.776 Test Loss: 0.841 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 183220
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.825082063674927
Epoch: 1, Steps: 10 | Train Loss: 1.581 Vali Loss: 1.493 Vali Acc: 0.276 Test Loss: 1.493 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 1.5006563663482666
Epoch: 2, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.410 Vali Acc: 0.296 Test Loss: 1.410 Test Acc: 0.296
Validation loss decreased (-0.276301 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.2929911613464355
Epoch: 3, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.378 Vali Acc: 0.211 Test Loss: 1.378 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6471490859985352
Epoch: 4, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.347 Vali Acc: 0.296 Test Loss: 1.347 Test Acc: 0.296
Validation loss decreased (-0.296039 --> -0.296039).  Saving model ...
Epoch: 5 cost time: 1.701298713684082
Epoch: 5, Steps: 10 | Train Loss: 1.362 Vali Loss: 1.321 Vali Acc: 0.408 Test Loss: 1.321 Test Acc: 0.408
Validation loss decreased (-0.296039 --> -0.407882).  Saving model ...
Epoch: 6 cost time: 1.8716540336608887
Epoch: 6, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.280 Vali Acc: 0.447 Test Loss: 1.280 Test Acc: 0.447
Validation loss decreased (-0.407882 --> -0.447356).  Saving model ...
Epoch: 7 cost time: 1.7750234603881836
Epoch: 7, Steps: 10 | Train Loss: 1.265 Vali Loss: 1.247 Vali Acc: 0.461 Test Loss: 1.247 Test Acc: 0.461
Validation loss decreased (-0.447356 --> -0.460514).  Saving model ...
Epoch: 8 cost time: 1.5916073322296143
Epoch: 8, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.210 Vali Acc: 0.493 Test Loss: 1.210 Test Acc: 0.493
Validation loss decreased (-0.460514 --> -0.493409).  Saving model ...
Epoch: 9 cost time: 1.6455445289611816
Epoch: 9, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.161 Vali Acc: 0.520 Test Loss: 1.161 Test Acc: 0.520
Validation loss decreased (-0.493409 --> -0.519725).  Saving model ...
Epoch: 10 cost time: 1.2644600868225098
Epoch: 10, Steps: 10 | Train Loss: 1.108 Vali Loss: 1.118 Vali Acc: 0.520 Test Loss: 1.118 Test Acc: 0.520
Validation loss decreased (-0.519725 --> -0.519726).  Saving model ...
Epoch: 11 cost time: 1.640716791152954
Epoch: 11, Steps: 10 | Train Loss: 0.993 Vali Loss: 1.081 Vali Acc: 0.533 Test Loss: 1.081 Test Acc: 0.533
Validation loss decreased (-0.519726 --> -0.532884).  Saving model ...
Epoch: 12 cost time: 1.3316562175750732
Epoch: 12, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.033 Vali Acc: 0.546 Test Loss: 1.033 Test Acc: 0.546
Validation loss decreased (-0.532884 --> -0.546042).  Saving model ...
Epoch: 13 cost time: 1.5709424018859863
Epoch: 13, Steps: 10 | Train Loss: 0.850 Vali Loss: 0.985 Vali Acc: 0.579 Test Loss: 0.985 Test Acc: 0.579
Validation loss decreased (-0.546042 --> -0.578938).  Saving model ...
Epoch: 14 cost time: 1.615208387374878
Epoch: 14, Steps: 10 | Train Loss: 0.834 Vali Loss: 0.946 Vali Acc: 0.599 Test Loss: 0.946 Test Acc: 0.599
Validation loss decreased (-0.578938 --> -0.598675).  Saving model ...
Epoch: 15 cost time: 1.6875805854797363
Epoch: 15, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.907 Vali Acc: 0.605 Test Loss: 0.907 Test Acc: 0.605
Validation loss decreased (-0.598675 --> -0.605254).  Saving model ...
Epoch: 16 cost time: 1.5750243663787842
Epoch: 16, Steps: 10 | Train Loss: 0.719 Vali Loss: 0.874 Vali Acc: 0.625 Test Loss: 0.874 Test Acc: 0.625
Validation loss decreased (-0.605254 --> -0.624991).  Saving model ...
Epoch: 17 cost time: 1.3744986057281494
Epoch: 17, Steps: 10 | Train Loss: 0.620 Vali Loss: 0.833 Vali Acc: 0.671 Test Loss: 0.833 Test Acc: 0.671
Validation loss decreased (-0.624991 --> -0.671044).  Saving model ...
Epoch: 18 cost time: 1.6321656703948975
Epoch: 18, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.803 Vali Acc: 0.664 Test Loss: 0.803 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4374241828918457
Epoch: 19, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.760 Vali Acc: 0.678 Test Loss: 0.760 Test Acc: 0.678
Validation loss decreased (-0.671044 --> -0.677624).  Saving model ...
Epoch: 20 cost time: 1.4131214618682861
Epoch: 20, Steps: 10 | Train Loss: 0.492 Vali Loss: 0.723 Vali Acc: 0.697 Test Loss: 0.723 Test Acc: 0.697
Validation loss decreased (-0.677624 --> -0.697361).  Saving model ...
Epoch: 21 cost time: 1.7950351238250732
Epoch: 21, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.704 Vali Acc: 0.711 Test Loss: 0.704 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 22 cost time: 1.5672380924224854
Epoch: 22, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.663 Vali Acc: 0.711 Test Loss: 0.663 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710520).  Saving model ...
Epoch: 23 cost time: 1.5156567096710205
Epoch: 23, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.656 Vali Acc: 0.717 Test Loss: 0.656 Test Acc: 0.717
Validation loss decreased (-0.710520 --> -0.717099).  Saving model ...
Epoch: 24 cost time: 1.9185280799865723
Epoch: 24, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.624 Vali Acc: 0.743 Test Loss: 0.624 Test Acc: 0.743
Validation loss decreased (-0.717099 --> -0.743415).  Saving model ...
Epoch: 25 cost time: 1.3343467712402344
Epoch: 25, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.625 Vali Acc: 0.737 Test Loss: 0.625 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.637139081954956
Epoch: 26, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.610 Vali Acc: 0.743 Test Loss: 0.610 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 27 cost time: 1.926353931427002
Epoch: 27, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 28 cost time: 1.4765994548797607
Epoch: 28, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.582 Vali Acc: 0.737 Test Loss: 0.582 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6026549339294434
Epoch: 29, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.609 Vali Acc: 0.737 Test Loss: 0.609 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7166883945465088
Epoch: 30, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.558 Vali Acc: 0.743 Test Loss: 0.558 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.932065725326538
Epoch: 31, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 32 cost time: 1.4908900260925293
Epoch: 32, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 33 cost time: 1.6116671562194824
Epoch: 33, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.8467094898223877
Epoch: 34, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.504077434539795
Epoch: 35, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.596 Vali Acc: 0.757 Test Loss: 0.596 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.3444371223449707
Epoch: 36, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.594 Vali Acc: 0.757 Test Loss: 0.594 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.3395085334777832
Epoch: 37, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.5044865608215332
Epoch: 38, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.560 Vali Acc: 0.750 Test Loss: 0.560 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.4482817649841309
Epoch: 39, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.577 Vali Acc: 0.757 Test Loss: 0.577 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.5370616912841797
Epoch: 40, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.7560961246490479
Epoch: 41, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.574 Vali Acc: 0.724 Test Loss: 0.574 Test Acc: 0.724
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.663877010345459
Epoch: 42, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 183028
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.59833025932312
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.387 Vali Acc: 0.388 Test Loss: 1.387 Test Acc: 0.388
Validation loss decreased (inf --> -0.388144).  Saving model ...
Epoch: 2 cost time: 1.8578767776489258
Epoch: 2, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.286 Vali Acc: 0.329 Test Loss: 1.286 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4549405574798584
Epoch: 3, Steps: 10 | Train Loss: 1.181 Vali Loss: 1.119 Vali Acc: 0.539 Test Loss: 1.119 Test Acc: 0.539
Validation loss decreased (-0.388144 --> -0.539462).  Saving model ...
Epoch: 4 cost time: 1.3614161014556885
Epoch: 4, Steps: 10 | Train Loss: 0.924 Vali Loss: 1.180 Vali Acc: 0.414 Test Loss: 1.180 Test Acc: 0.414
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.219954013824463
Epoch: 5, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.746 Vali Acc: 0.737 Test Loss: 0.746 Test Acc: 0.737
Validation loss decreased (-0.539462 --> -0.736835).  Saving model ...
Epoch: 6 cost time: 1.4557955265045166
Epoch: 6, Steps: 10 | Train Loss: 0.541 Vali Loss: 0.745 Vali Acc: 0.717 Test Loss: 0.745 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0642218589782715
Epoch: 7, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.576 Vali Acc: 0.763 Test Loss: 0.576 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 8 cost time: 1.246211051940918
Epoch: 8, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.664 Vali Acc: 0.717 Test Loss: 0.664 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9967825412750244
Epoch: 9, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
Validation loss decreased (-0.763152 --> -0.802626).  Saving model ...
Epoch: 10 cost time: 1.7944812774658203
Epoch: 10, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 11 cost time: 1.5745372772216797
Epoch: 11, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.730 Vali Acc: 0.776 Test Loss: 0.730 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7568187713623047
Epoch: 12, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.640 Vali Acc: 0.776 Test Loss: 0.640 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6689481735229492
Epoch: 13, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8814804553985596
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.837 Vali Acc: 0.796 Test Loss: 0.837 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5698480606079102
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.993 Vali Acc: 0.783 Test Loss: 0.993 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.22990345954895
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.801 Vali Acc: 0.796 Test Loss: 0.801 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3992624282836914
Epoch: 17, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.839 Vali Acc: 0.783 Test Loss: 0.839 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.948096513748169
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.929 Vali Acc: 0.789 Test Loss: 0.929 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7702968120574951
Epoch: 19, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.929 Vali Acc: 0.796 Test Loss: 0.929 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.8580000400543213
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.041 Vali Acc: 0.789 Test Loss: 1.041 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 7941416
model size : 35.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.44618558883667
Epoch: 1, Steps: 10 | Train Loss: 1.520 Vali Loss: 1.455 Vali Acc: 0.250 Test Loss: 1.455 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 1.4917430877685547
Epoch: 2, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.313 Vali Acc: 0.309 Test Loss: 1.313 Test Acc: 0.309
Validation loss decreased (-0.249985 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 1.643716812133789
Epoch: 3, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.221 Vali Acc: 0.480 Test Loss: 1.221 Test Acc: 0.480
Validation loss decreased (-0.309197 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 1.3351030349731445
Epoch: 4, Steps: 10 | Train Loss: 0.903 Vali Loss: 0.876 Vali Acc: 0.737 Test Loss: 0.876 Test Acc: 0.737
Validation loss decreased (-0.480251 --> -0.736833).  Saving model ...
Epoch: 5 cost time: 1.5041804313659668
Epoch: 5, Steps: 10 | Train Loss: 0.623 Vali Loss: 0.790 Vali Acc: 0.684 Test Loss: 0.790 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7160825729370117
Epoch: 6, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.671 Vali Acc: 0.724 Test Loss: 0.671 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5803883075714111
Epoch: 7, Steps: 10 | Train Loss: 0.322 Vali Loss: 0.541 Vali Acc: 0.750 Test Loss: 0.541 Test Acc: 0.750
Validation loss decreased (-0.736833 --> -0.749995).  Saving model ...
Epoch: 8 cost time: 1.3969523906707764
Epoch: 8, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.698 Vali Acc: 0.704 Test Loss: 0.698 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6153514385223389
Epoch: 9, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.532 Vali Acc: 0.757 Test Loss: 0.532 Test Acc: 0.757
Validation loss decreased (-0.749995 --> -0.756574).  Saving model ...
Epoch: 10 cost time: 1.5939900875091553
Epoch: 10, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.762 Vali Acc: 0.783 Test Loss: 0.762 Test Acc: 0.783
Validation loss decreased (-0.756574 --> -0.782887).  Saving model ...
Epoch: 11 cost time: 1.5236518383026123
Epoch: 11, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.739 Vali Acc: 0.809 Test Loss: 0.739 Test Acc: 0.809
Validation loss decreased (-0.782887 --> -0.809203).  Saving model ...
Epoch: 12 cost time: 1.77783203125
Epoch: 12, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.678 Vali Acc: 0.796 Test Loss: 0.678 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7385833263397217
Epoch: 13, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.705 Vali Acc: 0.796 Test Loss: 0.705 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.481724500656128
Epoch: 14, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8418188095092773
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.681 Vali Acc: 0.789 Test Loss: 0.681 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5404858589172363
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.792 Vali Acc: 0.783 Test Loss: 0.792 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.560131311416626
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.911 Vali Acc: 0.783 Test Loss: 0.911 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7218234539031982
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.943 Vali Acc: 0.750 Test Loss: 0.943 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.6914494037628174
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.911 Vali Acc: 0.783 Test Loss: 0.911 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.9835758209228516
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.951 Vali Acc: 0.789 Test Loss: 0.951 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9262449741363525
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.924 Vali Acc: 0.776 Test Loss: 0.924 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 7940136
model size : 35.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.146386623382568
Epoch: 1, Steps: 10 | Train Loss: 1.405 Vali Loss: 1.310 Vali Acc: 0.368 Test Loss: 1.310 Test Acc: 0.368
Validation loss decreased (inf --> -0.368408).  Saving model ...
Epoch: 2 cost time: 1.6506133079528809
Epoch: 2, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.161 Vali Acc: 0.526 Test Loss: 1.161 Test Acc: 0.526
Validation loss decreased (-0.368408 --> -0.526304).  Saving model ...
Epoch: 3 cost time: 1.908937692642212
Epoch: 3, Steps: 10 | Train Loss: 1.061 Vali Loss: 1.042 Vali Acc: 0.599 Test Loss: 1.042 Test Acc: 0.599
Validation loss decreased (-0.526304 --> -0.598674).  Saving model ...
Epoch: 4 cost time: 1.5600435733795166
Epoch: 4, Steps: 10 | Train Loss: 0.857 Vali Loss: 1.000 Vali Acc: 0.612 Test Loss: 1.000 Test Acc: 0.612
Validation loss decreased (-0.598674 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 2.0494956970214844
Epoch: 5, Steps: 10 | Train Loss: 0.750 Vali Loss: 0.809 Vali Acc: 0.612 Test Loss: 0.809 Test Acc: 0.612
Validation loss decreased (-0.611832 --> -0.611834).  Saving model ...
Epoch: 6 cost time: 1.728926420211792
Epoch: 6, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.806 Vali Acc: 0.724 Test Loss: 0.806 Test Acc: 0.724
Validation loss decreased (-0.611834 --> -0.723676).  Saving model ...
Epoch: 7 cost time: 2.410339832305908
Epoch: 7, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736837).  Saving model ...
Epoch: 8 cost time: 1.544020414352417
Epoch: 8, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
Validation loss decreased (-0.736837 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.8837826251983643
Epoch: 9, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.658 Vali Acc: 0.730 Test Loss: 0.658 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.068633556365967
Epoch: 10, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.582 Vali Acc: 0.757 Test Loss: 0.582 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6373660564422607
Epoch: 11, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.818814754486084
Epoch: 12, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.748 Vali Acc: 0.776 Test Loss: 0.748 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776308).  Saving model ...
Epoch: 13 cost time: 1.8994555473327637
Epoch: 13, Steps: 10 | Train Loss: 0.062 Vali Loss: 1.051 Vali Acc: 0.770 Test Loss: 1.051 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.642003059387207
Epoch: 14, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.808 Vali Acc: 0.803 Test Loss: 0.808 Test Acc: 0.803
Validation loss decreased (-0.776308 --> -0.802623).  Saving model ...
Epoch: 15 cost time: 1.785402536392212
Epoch: 15, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.954 Vali Acc: 0.776 Test Loss: 0.954 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7969961166381836
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.782 Vali Acc: 0.770 Test Loss: 0.782 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.3811779022216797
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.957 Vali Acc: 0.803 Test Loss: 0.957 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3365864753723145
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.896 Vali Acc: 0.770 Test Loss: 0.896 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.3956749439239502
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.925 Vali Acc: 0.776 Test Loss: 0.925 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7170493602752686
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.978 Vali Acc: 0.783 Test Loss: 0.978 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7242250442504883
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.009 Vali Acc: 0.770 Test Loss: 1.009 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5047717094421387
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.017 Vali Acc: 0.776 Test Loss: 1.017 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.548658847808838
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.032 Vali Acc: 0.789 Test Loss: 1.032 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5291318893432617
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.039 Vali Acc: 0.783 Test Loss: 1.039 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 7938856
model size : 35.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.198306322097778
Epoch: 1, Steps: 10 | Train Loss: 1.413 Vali Loss: 1.383 Vali Acc: 0.263 Test Loss: 1.383 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.9109675884246826
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.228 Vali Acc: 0.428 Test Loss: 1.228 Test Acc: 0.428
Validation loss decreased (-0.263144 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 1.3349177837371826
Epoch: 3, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.061 Vali Acc: 0.599 Test Loss: 1.061 Test Acc: 0.599
Validation loss decreased (-0.427619 --> -0.598674).  Saving model ...
Epoch: 4 cost time: 1.2753300666809082
Epoch: 4, Steps: 10 | Train Loss: 0.859 Vali Loss: 0.840 Vali Acc: 0.658 Test Loss: 0.840 Test Acc: 0.658
Validation loss decreased (-0.598674 --> -0.657886).  Saving model ...
Epoch: 5 cost time: 1.412729024887085
Epoch: 5, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.700 Vali Acc: 0.717 Test Loss: 0.700 Test Acc: 0.717
Validation loss decreased (-0.657886 --> -0.717098).  Saving model ...
Epoch: 6 cost time: 1.8774876594543457
Epoch: 6, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
Validation loss decreased (-0.717098 --> -0.763152).  Saving model ...
Epoch: 7 cost time: 1.8665988445281982
Epoch: 7, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.641 Vali Acc: 0.770 Test Loss: 0.641 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769730).  Saving model ...
Epoch: 8 cost time: 1.7403342723846436
Epoch: 8, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.607 Vali Acc: 0.803 Test Loss: 0.607 Test Acc: 0.803
Validation loss decreased (-0.769730 --> -0.802626).  Saving model ...
Epoch: 9 cost time: 1.6543378829956055
Epoch: 9, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.531 Vali Acc: 0.770 Test Loss: 0.531 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4331436157226562
Epoch: 10, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2808449268341064
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.600952386856079
Epoch: 12, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.585 Vali Acc: 0.770 Test Loss: 0.585 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.648064374923706
Epoch: 13, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.778 Vali Acc: 0.816 Test Loss: 0.778 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815782).  Saving model ...
Epoch: 14 cost time: 1.782698154449463
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.844 Vali Acc: 0.789 Test Loss: 0.844 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8473968505859375
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.836 Vali Acc: 0.783 Test Loss: 0.836 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5266757011413574
Epoch: 16, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.901 Vali Acc: 0.776 Test Loss: 0.901 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4700102806091309
Epoch: 17, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.980 Vali Acc: 0.796 Test Loss: 0.980 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6221423149108887
Epoch: 18, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.037 Vali Acc: 0.783 Test Loss: 1.037 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6224009990692139
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.039 Vali Acc: 0.770 Test Loss: 1.039 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7878758907318115
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.049 Vali Acc: 0.776 Test Loss: 1.049 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7814700603485107
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.045 Vali Acc: 0.789 Test Loss: 1.045 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.4653403759002686
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.041 Vali Acc: 0.783 Test Loss: 1.041 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6026315689086914
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.051 Vali Acc: 0.789 Test Loss: 1.051 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 7937576
model size : 35.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5351362228393555
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.417 Vali Acc: 0.217 Test Loss: 1.417 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 1.1723072528839111
Epoch: 2, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.303 Vali Acc: 0.355 Test Loss: 1.303 Test Acc: 0.355
Validation loss decreased (-0.217091 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.3525047302246094
Epoch: 3, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.166 Vali Acc: 0.566 Test Loss: 1.166 Test Acc: 0.566
Validation loss decreased (-0.355250 --> -0.565778).  Saving model ...
Epoch: 4 cost time: 1.1346156597137451
Epoch: 4, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.031 Vali Acc: 0.579 Test Loss: 1.031 Test Acc: 0.579
Validation loss decreased (-0.565778 --> -0.578937).  Saving model ...
Epoch: 5 cost time: 1.2943840026855469
Epoch: 5, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.979 Vali Acc: 0.612 Test Loss: 0.979 Test Acc: 0.612
Validation loss decreased (-0.578937 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 1.397629737854004
Epoch: 6, Steps: 10 | Train Loss: 0.625 Vali Loss: 0.688 Vali Acc: 0.763 Test Loss: 0.688 Test Acc: 0.763
Validation loss decreased (-0.611832 --> -0.763151).  Saving model ...
Epoch: 7 cost time: 1.3024682998657227
Epoch: 7, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.761 Vali Acc: 0.684 Test Loss: 0.761 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4027800559997559
Epoch: 8, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.601 Vali Acc: 0.763 Test Loss: 0.601 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 1.485424518585205
Epoch: 9, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.525 Vali Acc: 0.757 Test Loss: 0.525 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6322658061981201
Epoch: 10, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.545 Vali Acc: 0.743 Test Loss: 0.545 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8127715587615967
Epoch: 11, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.2387256622314453
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.677 Vali Acc: 0.763 Test Loss: 0.677 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.44313645362854
Epoch: 13, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.665 Vali Acc: 0.750 Test Loss: 0.665 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.5990583896636963
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789467).  Saving model ...
Epoch: 15 cost time: 1.3816895484924316
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.817 Vali Acc: 0.776 Test Loss: 0.817 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4982850551605225
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.856 Vali Acc: 0.796 Test Loss: 0.856 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796044).  Saving model ...
Epoch: 17 cost time: 1.4405841827392578
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.866 Vali Acc: 0.783 Test Loss: 0.866 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6455864906311035
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.966 Vali Acc: 0.789 Test Loss: 0.966 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4168734550476074
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.998 Vali Acc: 0.796 Test Loss: 0.998 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5319268703460693
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 1.010 Vali Acc: 0.803 Test Loss: 1.010 Test Acc: 0.803
Validation loss decreased (-0.796044 --> -0.802621).  Saving model ...
Epoch: 21 cost time: 1.5921940803527832
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.006 Vali Acc: 0.776 Test Loss: 1.006 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6666514873504639
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.042 Vali Acc: 0.796 Test Loss: 1.042 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.526404619216919
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.022 Vali Acc: 0.796 Test Loss: 1.022 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.553241491317749
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.796 Test Loss: 1.046 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4411461353302002
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.078 Vali Acc: 0.783 Test Loss: 1.078 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5710434913635254
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.098 Vali Acc: 0.783 Test Loss: 1.098 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5203526020050049
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.111 Vali Acc: 0.783 Test Loss: 1.111 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5305712223052979
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.116 Vali Acc: 0.783 Test Loss: 1.116 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.553950309753418
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.123 Vali Acc: 0.783 Test Loss: 1.123 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.4583401679992676
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.134 Vali Acc: 0.783 Test Loss: 1.134 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 6628136
model size : 30.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.762197971343994
Epoch: 1, Steps: 10 | Train Loss: 1.550 Vali Loss: 1.535 Vali Acc: 0.296 Test Loss: 1.535 Test Acc: 0.296
Validation loss decreased (inf --> -0.296037).  Saving model ...
Epoch: 2 cost time: 1.6560425758361816
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.272 Vali Acc: 0.428 Test Loss: 1.272 Test Acc: 0.428
Validation loss decreased (-0.296037 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 1.4753985404968262
Epoch: 3, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.166 Vali Acc: 0.421 Test Loss: 1.166 Test Acc: 0.421
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6349985599517822
Epoch: 4, Steps: 10 | Train Loss: 0.995 Vali Loss: 0.946 Vali Acc: 0.638 Test Loss: 0.946 Test Acc: 0.638
Validation loss decreased (-0.427619 --> -0.638148).  Saving model ...
Epoch: 5 cost time: 1.656494379043579
Epoch: 5, Steps: 10 | Train Loss: 0.776 Vali Loss: 0.761 Vali Acc: 0.691 Test Loss: 0.761 Test Acc: 0.691
Validation loss decreased (-0.638148 --> -0.690782).  Saving model ...
Epoch: 6 cost time: 1.3335015773773193
Epoch: 6, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.770 Vali Acc: 0.671 Test Loss: 0.770 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5357182025909424
Epoch: 7, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.985 Vali Acc: 0.632 Test Loss: 0.985 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.407905101776123
Epoch: 8, Steps: 10 | Train Loss: 0.429 Vali Loss: 0.792 Vali Acc: 0.711 Test Loss: 0.792 Test Acc: 0.711
Validation loss decreased (-0.690782 --> -0.710518).  Saving model ...
Epoch: 9 cost time: 1.3028573989868164
Epoch: 9, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.599 Vali Acc: 0.737 Test Loss: 0.599 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.9650299549102783
Epoch: 10, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.602 Vali Acc: 0.757 Test Loss: 0.602 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 11 cost time: 1.7050232887268066
Epoch: 11, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.594 Vali Acc: 0.763 Test Loss: 0.594 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.500138282775879
Epoch: 12, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7692139148712158
Epoch: 13, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.633 Vali Acc: 0.796 Test Loss: 0.633 Test Acc: 0.796
Validation loss decreased (-0.763152 --> -0.796046).  Saving model ...
Epoch: 14 cost time: 1.5481836795806885
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.794 Vali Acc: 0.816 Test Loss: 0.794 Test Acc: 0.816
Validation loss decreased (-0.796046 --> -0.815782).  Saving model ...
Epoch: 15 cost time: 1.2415990829467773
Epoch: 15, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.765 Vali Acc: 0.776 Test Loss: 0.765 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8438260555267334
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.868 Vali Acc: 0.796 Test Loss: 0.868 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.033635377883911
Epoch: 17, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.890 Vali Acc: 0.789 Test Loss: 0.890 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.8229918479919434
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.902 Vali Acc: 0.796 Test Loss: 0.902 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5926525592803955
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.909 Vali Acc: 0.803 Test Loss: 0.909 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.8358643054962158
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.960 Vali Acc: 0.796 Test Loss: 0.960 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6388204097747803
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.094 Vali Acc: 0.809 Test Loss: 1.094 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4860179424285889
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.061 Vali Acc: 0.803 Test Loss: 1.061 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5183966159820557
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.122 Vali Acc: 0.796 Test Loss: 1.122 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.590843915939331
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.139 Vali Acc: 0.803 Test Loss: 1.139 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 6626856
model size : 30.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8904125690460205
Epoch: 1, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.390 Vali Acc: 0.204 Test Loss: 1.390 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 1.9090046882629395
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.294 Vali Acc: 0.382 Test Loss: 1.294 Test Acc: 0.382
Validation loss decreased (-0.203933 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.4217181205749512
Epoch: 3, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.095 Vali Acc: 0.618 Test Loss: 1.095 Test Acc: 0.618
Validation loss decreased (-0.381566 --> -0.618410).  Saving model ...
Epoch: 4 cost time: 1.7366878986358643
Epoch: 4, Steps: 10 | Train Loss: 0.928 Vali Loss: 0.915 Vali Acc: 0.691 Test Loss: 0.915 Test Acc: 0.691
Validation loss decreased (-0.618410 --> -0.690780).  Saving model ...
Epoch: 5 cost time: 2.330537796020508
Epoch: 5, Steps: 10 | Train Loss: 0.703 Vali Loss: 0.733 Vali Acc: 0.770 Test Loss: 0.733 Test Acc: 0.770
Validation loss decreased (-0.690780 --> -0.769730).  Saving model ...
Epoch: 6 cost time: 1.7311480045318604
Epoch: 6, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.597 Vali Acc: 0.770 Test Loss: 0.597 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 7 cost time: 1.9340863227844238
Epoch: 7, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.576 Vali Acc: 0.730 Test Loss: 0.576 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5407211780548096
Epoch: 8, Steps: 10 | Train Loss: 0.267 Vali Loss: 0.542 Vali Acc: 0.763 Test Loss: 0.542 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8468031883239746
Epoch: 9, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.605 Vali Acc: 0.763 Test Loss: 0.605 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6876740455627441
Epoch: 10, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.594 Vali Acc: 0.783 Test Loss: 0.594 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.6790523529052734
Epoch: 11, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.598 Vali Acc: 0.770 Test Loss: 0.598 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6863796710968018
Epoch: 12, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.666 Vali Acc: 0.743 Test Loss: 0.666 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8492052555084229
Epoch: 13, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.730 Vali Acc: 0.757 Test Loss: 0.730 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5875842571258545
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.716 Vali Acc: 0.803 Test Loss: 0.716 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802624).  Saving model ...
Epoch: 15 cost time: 1.5257835388183594
Epoch: 15, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.907 Vali Acc: 0.809 Test Loss: 0.907 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809201).  Saving model ...
Epoch: 16 cost time: 1.6424791812896729
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.927 Vali Acc: 0.789 Test Loss: 0.927 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7076959609985352
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 1.110 Vali Acc: 0.711 Test Loss: 1.110 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6555354595184326
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.989 Vali Acc: 0.757 Test Loss: 0.989 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5657851696014404
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.933 Vali Acc: 0.789 Test Loss: 0.933 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4106404781341553
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.049 Vali Acc: 0.783 Test Loss: 1.049 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5712223052978516
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.079 Vali Acc: 0.783 Test Loss: 1.079 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8434207439422607
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.078 Vali Acc: 0.783 Test Loss: 1.078 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8584387302398682
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.097 Vali Acc: 0.796 Test Loss: 1.097 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6428143978118896
Epoch: 24, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.112 Vali Acc: 0.783 Test Loss: 1.112 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.7062127590179443
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.142 Vali Acc: 0.789 Test Loss: 1.142 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 6625576
model size : 30.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.834963321685791
Epoch: 1, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.402 Vali Acc: 0.283 Test Loss: 1.402 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.572249412536621
Epoch: 2, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.266 Vali Acc: 0.421 Test Loss: 1.266 Test Acc: 0.421
Validation loss decreased (-0.282881 --> -0.421040).  Saving model ...
Epoch: 3 cost time: 1.5507495403289795
Epoch: 3, Steps: 10 | Train Loss: 1.187 Vali Loss: 1.122 Vali Acc: 0.520 Test Loss: 1.122 Test Acc: 0.520
Validation loss decreased (-0.421040 --> -0.519726).  Saving model ...
Epoch: 4 cost time: 1.650831699371338
Epoch: 4, Steps: 10 | Train Loss: 0.977 Vali Loss: 0.939 Vali Acc: 0.664 Test Loss: 0.939 Test Acc: 0.664
Validation loss decreased (-0.519726 --> -0.664464).  Saving model ...
Epoch: 5 cost time: 1.6840720176696777
Epoch: 5, Steps: 10 | Train Loss: 0.782 Vali Loss: 0.837 Vali Acc: 0.638 Test Loss: 0.837 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7334561347961426
Epoch: 6, Steps: 10 | Train Loss: 0.552 Vali Loss: 0.722 Vali Acc: 0.664 Test Loss: 0.722 Test Acc: 0.664
Validation loss decreased (-0.664464 --> -0.664466).  Saving model ...
Epoch: 7 cost time: 1.5625648498535156
Epoch: 7, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.674 Vali Acc: 0.711 Test Loss: 0.674 Test Acc: 0.711
Validation loss decreased (-0.664466 --> -0.710520).  Saving model ...
Epoch: 8 cost time: 1.4595012664794922
Epoch: 8, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.541 Vali Acc: 0.770 Test Loss: 0.541 Test Acc: 0.770
Validation loss decreased (-0.710520 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.296170711517334
Epoch: 9, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.601 Vali Acc: 0.770 Test Loss: 0.601 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6712822914123535
Epoch: 10, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.515 Vali Acc: 0.803 Test Loss: 0.515 Test Acc: 0.803
Validation loss decreased (-0.769731 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.5015833377838135
Epoch: 11, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.673426866531372
Epoch: 12, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.722 Vali Acc: 0.803 Test Loss: 0.722 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4355676174163818
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809203).  Saving model ...
Epoch: 14 cost time: 1.3823556900024414
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.767 Vali Acc: 0.803 Test Loss: 0.767 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.256235122680664
Epoch: 15, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.833 Vali Acc: 0.809 Test Loss: 0.833 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4671592712402344
Epoch: 16, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.911 Vali Acc: 0.803 Test Loss: 0.911 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4891281127929688
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.955 Vali Acc: 0.796 Test Loss: 0.955 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3568050861358643
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.046 Vali Acc: 0.809 Test Loss: 1.046 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2872138023376465
Epoch: 19, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.959 Vali Acc: 0.789 Test Loss: 0.959 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5356791019439697
Epoch: 20, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.882 Vali Acc: 0.776 Test Loss: 0.882 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.343937873840332
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.030 Vali Acc: 0.809 Test Loss: 1.030 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2870068550109863
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.968 Vali Acc: 0.809 Test Loss: 0.968 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4339416027069092
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.024 Vali Acc: 0.816 Test Loss: 1.024 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815779).  Saving model ...
Epoch: 24 cost time: 1.219766616821289
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.992 Vali Acc: 0.809 Test Loss: 0.992 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3609771728515625
Epoch: 25, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.060 Vali Acc: 0.816 Test Loss: 1.060 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.339296579360962
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.079 Vali Acc: 0.822 Test Loss: 1.079 Test Acc: 0.822
Validation loss decreased (-0.815779 --> -0.822358).  Saving model ...
Epoch: 27 cost time: 1.3028545379638672
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.049 Vali Acc: 0.809 Test Loss: 1.049 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.237457513809204
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.043 Vali Acc: 0.809 Test Loss: 1.043 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6450796127319336
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.061 Vali Acc: 0.803 Test Loss: 1.061 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6340103149414062
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.083 Vali Acc: 0.816 Test Loss: 1.083 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4250528812408447
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.095 Vali Acc: 0.809 Test Loss: 1.095 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.8056528568267822
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.112 Vali Acc: 0.809 Test Loss: 1.112 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.539175033569336
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.125 Vali Acc: 0.803 Test Loss: 1.125 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.7082362174987793
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.141 Vali Acc: 0.809 Test Loss: 1.141 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.553995132446289
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.151 Vali Acc: 0.809 Test Loss: 1.151 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.307783842086792
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.148 Vali Acc: 0.809 Test Loss: 1.148 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 6624296
model size : 30.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.163358688354492
Epoch: 1, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.423 Vali Acc: 0.263 Test Loss: 1.423 Test Acc: 0.263
Validation loss decreased (inf --> -0.263144).  Saving model ...
Epoch: 2 cost time: 1.2159481048583984
Epoch: 2, Steps: 10 | Train Loss: 1.376 Vali Loss: 1.391 Vali Acc: 0.329 Test Loss: 1.391 Test Acc: 0.329
Validation loss decreased (-0.263144 --> -0.328933).  Saving model ...
Epoch: 3 cost time: 1.4762086868286133
Epoch: 3, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.145 Vali Acc: 0.539 Test Loss: 1.145 Test Acc: 0.539
Validation loss decreased (-0.328933 --> -0.539462).  Saving model ...
Epoch: 4 cost time: 1.4897243976593018
Epoch: 4, Steps: 10 | Train Loss: 1.013 Vali Loss: 0.954 Vali Acc: 0.704 Test Loss: 0.954 Test Acc: 0.704
Validation loss decreased (-0.539462 --> -0.703938).  Saving model ...
Epoch: 5 cost time: 1.6152925491333008
Epoch: 5, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.779 Vali Acc: 0.750 Test Loss: 0.779 Test Acc: 0.750
Validation loss decreased (-0.703938 --> -0.749992).  Saving model ...
Epoch: 6 cost time: 2.0600318908691406
Epoch: 6, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.828 Vali Acc: 0.592 Test Loss: 0.828 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5966506004333496
Epoch: 7, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.692 Vali Acc: 0.717 Test Loss: 0.692 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6089262962341309
Epoch: 8, Steps: 10 | Train Loss: 0.338 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
Validation loss decreased (-0.749992 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.1575536727905273
Epoch: 9, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.550 Vali Acc: 0.789 Test Loss: 0.550 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.3194708824157715
Epoch: 10, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.328080177307129
Epoch: 11, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.624 Vali Acc: 0.770 Test Loss: 0.624 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4626479148864746
Epoch: 12, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.559 Vali Acc: 0.789 Test Loss: 0.559 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6293022632598877
Epoch: 13, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 14 cost time: 1.5129027366638184
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.670 Vali Acc: 0.809 Test Loss: 0.670 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809204).  Saving model ...
Epoch: 15 cost time: 1.5634088516235352
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.744 Vali Acc: 0.789 Test Loss: 0.744 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3207952976226807
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.749 Vali Acc: 0.809 Test Loss: 0.749 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.41337251663208
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.849 Vali Acc: 0.789 Test Loss: 0.849 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3475337028503418
Epoch: 18, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.874 Vali Acc: 0.836 Test Loss: 0.874 Test Acc: 0.836
Validation loss decreased (-0.809204 --> -0.835518).  Saving model ...
Epoch: 19 cost time: 1.2704455852508545
Epoch: 19, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.878 Vali Acc: 0.789 Test Loss: 0.878 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.343763828277588
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.016 Vali Acc: 0.776 Test Loss: 1.016 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2626674175262451
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.948 Vali Acc: 0.816 Test Loss: 0.948 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3232545852661133
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.953 Vali Acc: 0.796 Test Loss: 0.953 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2968006134033203
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.920 Vali Acc: 0.803 Test Loss: 0.920 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3614428043365479
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.924 Vali Acc: 0.803 Test Loss: 0.924 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2218561172485352
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.930 Vali Acc: 0.796 Test Loss: 0.930 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.3945086002349854
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.956 Vali Acc: 0.803 Test Loss: 0.956 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3450102806091309
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.809 Test Loss: 0.996 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.368126630783081
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.042 Vali Acc: 0.789 Test Loss: 1.042 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 5971496
model size : 27.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.262124538421631
Epoch: 1, Steps: 10 | Train Loss: 1.515 Vali Loss: 1.457 Vali Acc: 0.270 Test Loss: 1.457 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 1.2877907752990723
Epoch: 2, Steps: 10 | Train Loss: 1.562 Vali Loss: 1.297 Vali Acc: 0.322 Test Loss: 1.297 Test Acc: 0.322
Validation loss decreased (-0.269722 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.2520558834075928
Epoch: 3, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.160 Vali Acc: 0.520 Test Loss: 1.160 Test Acc: 0.520
Validation loss decreased (-0.322355 --> -0.519725).  Saving model ...
Epoch: 4 cost time: 1.3165326118469238
Epoch: 4, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.055 Vali Acc: 0.605 Test Loss: 1.055 Test Acc: 0.605
Validation loss decreased (-0.519725 --> -0.605253).  Saving model ...
Epoch: 5 cost time: 1.5641417503356934
Epoch: 5, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.873 Vali Acc: 0.671 Test Loss: 0.873 Test Acc: 0.671
Validation loss decreased (-0.605253 --> -0.671044).  Saving model ...
Epoch: 6 cost time: 1.6596674919128418
Epoch: 6, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.696 Vali Acc: 0.737 Test Loss: 0.696 Test Acc: 0.737
Validation loss decreased (-0.671044 --> -0.736835).  Saving model ...
Epoch: 7 cost time: 1.3501248359680176
Epoch: 7, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.879 Vali Acc: 0.625 Test Loss: 0.879 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5742268562316895
Epoch: 8, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
Validation loss decreased (-0.736835 --> -0.782889).  Saving model ...
Epoch: 9 cost time: 1.575620412826538
Epoch: 9, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.446523904800415
Epoch: 10, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3709886074066162
Epoch: 11, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.656 Vali Acc: 0.789 Test Loss: 0.656 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 12 cost time: 1.7926015853881836
Epoch: 12, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.660 Vali Acc: 0.776 Test Loss: 0.660 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.598564863204956
Epoch: 13, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.740 Vali Acc: 0.783 Test Loss: 0.740 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.570500135421753
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.806 Vali Acc: 0.783 Test Loss: 0.806 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.447403907775879
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.913 Vali Acc: 0.770 Test Loss: 0.913 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5947630405426025
Epoch: 16, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.869 Vali Acc: 0.770 Test Loss: 0.869 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5454823970794678
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.868 Vali Acc: 0.770 Test Loss: 0.868 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5077919960021973
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.900 Vali Acc: 0.783 Test Loss: 0.900 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4793682098388672
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.922 Vali Acc: 0.776 Test Loss: 0.922 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8182802200317383
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.077 Vali Acc: 0.763 Test Loss: 1.077 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5761134624481201
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.986 Vali Acc: 0.783 Test Loss: 0.986 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 5970216
model size : 27.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.903770685195923
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.408 Vali Acc: 0.283 Test Loss: 1.408 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.6134965419769287
Epoch: 2, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.281 Vali Acc: 0.533 Test Loss: 1.281 Test Acc: 0.533
Validation loss decreased (-0.282881 --> -0.532882).  Saving model ...
Epoch: 3 cost time: 1.7144370079040527
Epoch: 3, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.165 Vali Acc: 0.599 Test Loss: 1.165 Test Acc: 0.599
Validation loss decreased (-0.532882 --> -0.598673).  Saving model ...
Epoch: 4 cost time: 1.5443689823150635
Epoch: 4, Steps: 10 | Train Loss: 1.004 Vali Loss: 1.106 Vali Acc: 0.355 Test Loss: 1.106 Test Acc: 0.355
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4819896221160889
Epoch: 5, Steps: 10 | Train Loss: 0.785 Vali Loss: 0.855 Vali Acc: 0.632 Test Loss: 0.855 Test Acc: 0.632
Validation loss decreased (-0.598673 --> -0.631570).  Saving model ...
Epoch: 6 cost time: 1.577606439590454
Epoch: 6, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.791 Vali Acc: 0.678 Test Loss: 0.791 Test Acc: 0.678
Validation loss decreased (-0.631570 --> -0.677624).  Saving model ...
Epoch: 7 cost time: 1.226757526397705
Epoch: 7, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
Validation loss decreased (-0.677624 --> -0.776310).  Saving model ...
Epoch: 8 cost time: 1.5838086605072021
Epoch: 8, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.606 Vali Acc: 0.743 Test Loss: 0.606 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4261078834533691
Epoch: 9, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.690 Vali Acc: 0.737 Test Loss: 0.690 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2896196842193604
Epoch: 10, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.591 Vali Acc: 0.763 Test Loss: 0.591 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3401479721069336
Epoch: 11, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.779 Vali Acc: 0.743 Test Loss: 0.779 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5233898162841797
Epoch: 12, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.628 Vali Acc: 0.770 Test Loss: 0.628 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.593926191329956
Epoch: 13, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.703 Vali Acc: 0.776 Test Loss: 0.703 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3335437774658203
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.847 Vali Acc: 0.796 Test Loss: 0.847 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796044).  Saving model ...
Epoch: 15 cost time: 1.2741715908050537
Epoch: 15, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.093 Vali Acc: 0.776 Test Loss: 1.093 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5311245918273926
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.993 Vali Acc: 0.822 Test Loss: 0.993 Test Acc: 0.822
Validation loss decreased (-0.796044 --> -0.822358).  Saving model ...
Epoch: 17 cost time: 1.2488937377929688
Epoch: 17, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.896 Vali Acc: 0.809 Test Loss: 0.896 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4055371284484863
Epoch: 18, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.018 Vali Acc: 0.776 Test Loss: 1.018 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4436116218566895
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.082 Vali Acc: 0.809 Test Loss: 1.082 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4940192699432373
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.078 Vali Acc: 0.796 Test Loss: 1.078 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1501076221466064
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.040 Vali Acc: 0.809 Test Loss: 1.040 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6159584522247314
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.042 Vali Acc: 0.829 Test Loss: 1.042 Test Acc: 0.829
Validation loss decreased (-0.822358 --> -0.828937).  Saving model ...
Epoch: 23 cost time: 1.4068703651428223
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.074 Vali Acc: 0.809 Test Loss: 1.074 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8998701572418213
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.098 Vali Acc: 0.822 Test Loss: 1.098 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.453305959701538
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.112 Vali Acc: 0.829 Test Loss: 1.112 Test Acc: 0.829
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3456048965454102
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.125 Vali Acc: 0.816 Test Loss: 1.125 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.318390130996704
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.171 Vali Acc: 0.803 Test Loss: 1.171 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.684671401977539
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.160 Vali Acc: 0.809 Test Loss: 1.160 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7592699527740479
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.165 Vali Acc: 0.836 Test Loss: 1.165 Test Acc: 0.836
Validation loss decreased (-0.828937 --> -0.835515).  Saving model ...
Epoch: 30 cost time: 1.6783394813537598
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.167 Vali Acc: 0.822 Test Loss: 1.167 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4385333061218262
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.173 Vali Acc: 0.816 Test Loss: 1.173 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3643805980682373
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.809 Test Loss: 1.181 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4145278930664062
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.189 Vali Acc: 0.816 Test Loss: 1.189 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.6047968864440918
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.196 Vali Acc: 0.822 Test Loss: 1.196 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.6802797317504883
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.203 Vali Acc: 0.822 Test Loss: 1.203 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.4944069385528564
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.209 Vali Acc: 0.822 Test Loss: 1.209 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.084834098815918
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.213 Vali Acc: 0.822 Test Loss: 1.213 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.2793188095092773
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.220 Vali Acc: 0.822 Test Loss: 1.220 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.979416847229004
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.226 Vali Acc: 0.822 Test Loss: 1.226 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 5968936
model size : 27.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.724161148071289
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.390 Vali Acc: 0.303 Test Loss: 1.390 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.3643944263458252
Epoch: 2, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.306 Vali Acc: 0.322 Test Loss: 1.306 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.6313390731811523
Epoch: 3, Steps: 10 | Train Loss: 1.168 Vali Loss: 1.199 Vali Acc: 0.362 Test Loss: 1.199 Test Acc: 0.362
Validation loss decreased (-0.322355 --> -0.361830).  Saving model ...
Epoch: 4 cost time: 1.473623514175415
Epoch: 4, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.075 Vali Acc: 0.520 Test Loss: 1.075 Test Acc: 0.520
Validation loss decreased (-0.361830 --> -0.519726).  Saving model ...
Epoch: 5 cost time: 1.3521368503570557
Epoch: 5, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.849 Vali Acc: 0.684 Test Loss: 0.849 Test Acc: 0.684
Validation loss decreased (-0.519726 --> -0.684202).  Saving model ...
Epoch: 6 cost time: 1.4096977710723877
Epoch: 6, Steps: 10 | Train Loss: 0.511 Vali Loss: 0.651 Vali Acc: 0.750 Test Loss: 0.651 Test Acc: 0.750
Validation loss decreased (-0.684202 --> -0.749993).  Saving model ...
Epoch: 7 cost time: 1.4854693412780762
Epoch: 7, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.686 Vali Acc: 0.691 Test Loss: 0.686 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5320944786071777
Epoch: 8, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.552 Vali Acc: 0.750 Test Loss: 0.552 Test Acc: 0.750
Validation loss decreased (-0.749993 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.5237681865692139
Epoch: 9, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.682 Vali Acc: 0.737 Test Loss: 0.682 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3525745868682861
Epoch: 10, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.922 Vali Acc: 0.697 Test Loss: 0.922 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7184834480285645
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.697 Vali Acc: 0.809 Test Loss: 0.697 Test Acc: 0.809
Validation loss decreased (-0.749994 --> -0.809204).  Saving model ...
Epoch: 12 cost time: 1.6394226551055908
Epoch: 12, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.613 Vali Acc: 0.776 Test Loss: 0.613 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4692420959472656
Epoch: 13, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.617 Vali Acc: 0.789 Test Loss: 0.617 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.503169298171997
Epoch: 14, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.697 Vali Acc: 0.809 Test Loss: 0.697 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809204).  Saving model ...
Epoch: 15 cost time: 1.406916856765747
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.814 Vali Acc: 0.796 Test Loss: 0.814 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7291159629821777
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.782 Vali Acc: 0.789 Test Loss: 0.782 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5830230712890625
Epoch: 17, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.858 Vali Acc: 0.809 Test Loss: 0.858 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2633473873138428
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.844 Vali Acc: 0.783 Test Loss: 0.844 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5726218223571777
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.917 Vali Acc: 0.796 Test Loss: 0.917 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7363924980163574
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.976 Vali Acc: 0.789 Test Loss: 0.976 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4747014045715332
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.007 Vali Acc: 0.789 Test Loss: 1.007 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5610086917877197
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.012 Vali Acc: 0.796 Test Loss: 1.012 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6772503852844238
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.789 Test Loss: 1.045 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5316967964172363
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.051 Vali Acc: 0.789 Test Loss: 1.051 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 5967656
model size : 27.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3594632148742676
Epoch: 1, Steps: 10 | Train Loss: 1.560 Vali Loss: 1.428 Vali Acc: 0.217 Test Loss: 1.428 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 1.3601715564727783
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.359 Vali Acc: 0.375 Test Loss: 1.359 Test Acc: 0.375
Validation loss decreased (-0.217091 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.3710789680480957
Epoch: 3, Steps: 10 | Train Loss: 1.205 Vali Loss: 1.210 Vali Acc: 0.461 Test Loss: 1.210 Test Acc: 0.461
Validation loss decreased (-0.374986 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 1.5779576301574707
Epoch: 4, Steps: 10 | Train Loss: 1.001 Vali Loss: 1.124 Vali Acc: 0.526 Test Loss: 1.124 Test Acc: 0.526
Validation loss decreased (-0.460514 --> -0.526305).  Saving model ...
Epoch: 5 cost time: 1.2616009712219238
Epoch: 5, Steps: 10 | Train Loss: 0.767 Vali Loss: 1.079 Vali Acc: 0.566 Test Loss: 1.079 Test Acc: 0.566
Validation loss decreased (-0.526305 --> -0.565779).  Saving model ...
Epoch: 6 cost time: 1.743452787399292
Epoch: 6, Steps: 10 | Train Loss: 0.695 Vali Loss: 1.066 Vali Acc: 0.553 Test Loss: 1.066 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4741597175598145
Epoch: 7, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.666 Vali Acc: 0.691 Test Loss: 0.666 Test Acc: 0.691
Validation loss decreased (-0.565779 --> -0.690783).  Saving model ...
Epoch: 8 cost time: 1.3409678936004639
Epoch: 8, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.641 Vali Acc: 0.724 Test Loss: 0.641 Test Acc: 0.724
Validation loss decreased (-0.690783 --> -0.723678).  Saving model ...
Epoch: 9 cost time: 1.4776709079742432
Epoch: 9, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.566 Vali Acc: 0.750 Test Loss: 0.566 Test Acc: 0.750
Validation loss decreased (-0.723678 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.7571256160736084
Epoch: 10, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.611 Vali Acc: 0.730 Test Loss: 0.611 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3388371467590332
Epoch: 11, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.910 Vali Acc: 0.704 Test Loss: 0.910 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6013035774230957
Epoch: 12, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.714 Vali Acc: 0.750 Test Loss: 0.714 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5042335987091064
Epoch: 13, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.659 Vali Acc: 0.776 Test Loss: 0.659 Test Acc: 0.776
Validation loss decreased (-0.749994 --> -0.776309).  Saving model ...
Epoch: 14 cost time: 1.4803459644317627
Epoch: 14, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.711 Vali Acc: 0.776 Test Loss: 0.711 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3084914684295654
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.739 Vali Acc: 0.776 Test Loss: 0.739 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1343867778778076
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.812 Vali Acc: 0.796 Test Loss: 0.812 Test Acc: 0.796
Validation loss decreased (-0.776309 --> -0.796045).  Saving model ...
Epoch: 17 cost time: 1.6962807178497314
Epoch: 17, Steps: 10 | Train Loss: 0.042 Vali Loss: 1.093 Vali Acc: 0.803 Test Loss: 1.093 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802621).  Saving model ...
Epoch: 18 cost time: 1.4836575984954834
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.854 Vali Acc: 0.763 Test Loss: 0.854 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7564780712127686
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.876 Vali Acc: 0.770 Test Loss: 0.876 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.784430742263794
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.917 Vali Acc: 0.776 Test Loss: 0.917 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7271957397460938
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.938 Vali Acc: 0.796 Test Loss: 0.938 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4400947093963623
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.993 Vali Acc: 0.803 Test Loss: 0.993 Test Acc: 0.803
Validation loss decreased (-0.802621 --> -0.802622).  Saving model ...
Epoch: 23 cost time: 1.644963264465332
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.789 Test Loss: 1.052 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4311177730560303
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.054 Vali Acc: 0.789 Test Loss: 1.054 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.725480079650879
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.059 Vali Acc: 0.789 Test Loss: 1.059 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5496125221252441
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.073 Vali Acc: 0.789 Test Loss: 1.073 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.4553468227386475
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.084 Vali Acc: 0.783 Test Loss: 1.084 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8023271560668945
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.087 Vali Acc: 0.783 Test Loss: 1.087 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9018795490264893
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.089 Vali Acc: 0.783 Test Loss: 1.089 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.6226344108581543
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.095 Vali Acc: 0.796 Test Loss: 1.095 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7714097499847412
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.114 Vali Acc: 0.776 Test Loss: 1.114 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6391870975494385
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.125 Vali Acc: 0.789 Test Loss: 1.125 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 5643176
model size : 26.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5645906925201416
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.376 Vali Acc: 0.283 Test Loss: 1.376 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.6112585067749023
Epoch: 2, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.260 Vali Acc: 0.428 Test Loss: 1.260 Test Acc: 0.428
Validation loss decreased (-0.282881 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 1.645301342010498
Epoch: 3, Steps: 10 | Train Loss: 1.182 Vali Loss: 1.212 Vali Acc: 0.368 Test Loss: 1.212 Test Acc: 0.368
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6021480560302734
Epoch: 4, Steps: 10 | Train Loss: 1.049 Vali Loss: 1.072 Vali Acc: 0.632 Test Loss: 1.072 Test Acc: 0.632
Validation loss decreased (-0.427619 --> -0.631568).  Saving model ...
Epoch: 5 cost time: 1.2965137958526611
Epoch: 5, Steps: 10 | Train Loss: 0.917 Vali Loss: 0.957 Vali Acc: 0.592 Test Loss: 0.957 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5276856422424316
Epoch: 6, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.917 Vali Acc: 0.625 Test Loss: 0.917 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.644477367401123
Epoch: 7, Steps: 10 | Train Loss: 0.625 Vali Loss: 0.827 Vali Acc: 0.638 Test Loss: 0.827 Test Acc: 0.638
Validation loss decreased (-0.631568 --> -0.638150).  Saving model ...
Epoch: 8 cost time: 1.3397507667541504
Epoch: 8, Steps: 10 | Train Loss: 0.445 Vali Loss: 0.611 Vali Acc: 0.730 Test Loss: 0.611 Test Acc: 0.730
Validation loss decreased (-0.638150 --> -0.730257).  Saving model ...
Epoch: 9 cost time: 1.2914135456085205
Epoch: 9, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.522 Vali Acc: 0.770 Test Loss: 0.522 Test Acc: 0.770
Validation loss decreased (-0.730257 --> -0.769732).  Saving model ...
Epoch: 10 cost time: 1.3408493995666504
Epoch: 10, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.533 Vali Acc: 0.757 Test Loss: 0.533 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4871885776519775
Epoch: 11, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.678 Vali Acc: 0.770 Test Loss: 0.678 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5642776489257812
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.886 Vali Acc: 0.763 Test Loss: 0.886 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.527421236038208
Epoch: 13, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.782 Vali Acc: 0.789 Test Loss: 0.782 Test Acc: 0.789
Validation loss decreased (-0.769732 --> -0.789466).  Saving model ...
Epoch: 14 cost time: 1.334801435470581
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.731 Vali Acc: 0.770 Test Loss: 0.731 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.020047187805176
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.804 Vali Acc: 0.783 Test Loss: 0.804 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4720149040222168
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.872 Vali Acc: 0.763 Test Loss: 0.872 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4130513668060303
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.922 Vali Acc: 0.763 Test Loss: 0.922 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3721425533294678
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.958 Vali Acc: 0.783 Test Loss: 0.958 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.6299211978912354
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.962 Vali Acc: 0.783 Test Loss: 0.962 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.644078016281128
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.077 Vali Acc: 0.776 Test Loss: 1.077 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5593714714050293
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.120 Vali Acc: 0.789 Test Loss: 1.120 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.249281406402588
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.125 Vali Acc: 0.789 Test Loss: 1.125 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5451459884643555
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.102 Vali Acc: 0.783 Test Loss: 1.102 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 5641896
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.93953537940979
Epoch: 1, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.447 Vali Acc: 0.296 Test Loss: 1.447 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 1.3943994045257568
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.264 Vali Acc: 0.428 Test Loss: 1.264 Test Acc: 0.428
Validation loss decreased (-0.296038 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 1.2047383785247803
Epoch: 3, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.187 Vali Acc: 0.487 Test Loss: 1.187 Test Acc: 0.487
Validation loss decreased (-0.427619 --> -0.486830).  Saving model ...
Epoch: 4 cost time: 1.683454990386963
Epoch: 4, Steps: 10 | Train Loss: 1.070 Vali Loss: 0.997 Vali Acc: 0.618 Test Loss: 0.997 Test Acc: 0.618
Validation loss decreased (-0.486830 --> -0.618411).  Saving model ...
Epoch: 5 cost time: 1.412750244140625
Epoch: 5, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.900 Vali Acc: 0.618 Test Loss: 0.900 Test Acc: 0.618
Validation loss decreased (-0.618411 --> -0.618412).  Saving model ...
Epoch: 6 cost time: 1.2669506072998047
Epoch: 6, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.708 Vali Acc: 0.711 Test Loss: 0.708 Test Acc: 0.711
Validation loss decreased (-0.618412 --> -0.710519).  Saving model ...
Epoch: 7 cost time: 1.3908939361572266
Epoch: 7, Steps: 10 | Train Loss: 0.474 Vali Loss: 0.678 Vali Acc: 0.717 Test Loss: 0.678 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 8 cost time: 1.4489881992340088
Epoch: 8, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.617 Vali Acc: 0.711 Test Loss: 0.617 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.031068801879883
Epoch: 9, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.523 Vali Acc: 0.776 Test Loss: 0.523 Test Acc: 0.776
Validation loss decreased (-0.717098 --> -0.776311).  Saving model ...
Epoch: 10 cost time: 1.5408940315246582
Epoch: 10, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.523 Vali Acc: 0.737 Test Loss: 0.523 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7829279899597168
Epoch: 11, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.594 Vali Acc: 0.737 Test Loss: 0.594 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.513063669204712
Epoch: 12, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.660 Vali Acc: 0.763 Test Loss: 0.660 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7165522575378418
Epoch: 13, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.807 Vali Acc: 0.763 Test Loss: 0.807 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4150359630584717
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.906 Vali Acc: 0.750 Test Loss: 0.906 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.449096441268921
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.940 Vali Acc: 0.763 Test Loss: 0.940 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.553070068359375
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.824 Vali Acc: 0.789 Test Loss: 0.824 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789465).  Saving model ...
Epoch: 17 cost time: 1.259537696838379
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.827 Vali Acc: 0.783 Test Loss: 0.827 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.809974193572998
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.889 Vali Acc: 0.776 Test Loss: 0.889 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8307955265045166
Epoch: 19, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.017 Vali Acc: 0.796 Test Loss: 1.017 Test Acc: 0.796
Validation loss decreased (-0.789465 --> -0.796042).  Saving model ...
Epoch: 20 cost time: 1.4739902019500732
Epoch: 20, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.137 Vali Acc: 0.803 Test Loss: 1.137 Test Acc: 0.803
Validation loss decreased (-0.796042 --> -0.802620).  Saving model ...
Epoch: 21 cost time: 1.535907506942749
Epoch: 21, Steps: 10 | Train Loss: 0.035 Vali Loss: 1.136 Vali Acc: 0.763 Test Loss: 1.136 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7493107318878174
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.258 Vali Acc: 0.789 Test Loss: 1.258 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4253816604614258
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 1.059 Vali Acc: 0.763 Test Loss: 1.059 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6723148822784424
Epoch: 24, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.130 Vali Acc: 0.789 Test Loss: 1.130 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2824735641479492
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 1.169 Vali Acc: 0.796 Test Loss: 1.169 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.6281085014343262
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 1.332 Vali Acc: 0.789 Test Loss: 1.332 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7077622413635254
Epoch: 27, Steps: 10 | Train Loss: 0.049 Vali Loss: 1.280 Vali Acc: 0.770 Test Loss: 1.280 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1694650650024414
Epoch: 28, Steps: 10 | Train Loss: 0.166 Vali Loss: 1.014 Vali Acc: 0.776 Test Loss: 1.014 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.3956289291381836
Epoch: 29, Steps: 10 | Train Loss: 0.057 Vali Loss: 1.301 Vali Acc: 0.796 Test Loss: 1.301 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3646178245544434
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 1.411 Vali Acc: 0.743 Test Loss: 1.411 Test Acc: 0.743
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 5640616
model size : 26.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3742780685424805
Epoch: 1, Steps: 10 | Train Loss: 1.495 Vali Loss: 1.446 Vali Acc: 0.263 Test Loss: 1.446 Test Acc: 0.263
Validation loss decreased (inf --> -0.263143).  Saving model ...
Epoch: 2 cost time: 1.8752963542938232
Epoch: 2, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.321 Vali Acc: 0.296 Test Loss: 1.321 Test Acc: 0.296
Validation loss decreased (-0.263143 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.4464211463928223
Epoch: 3, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.114 Vali Acc: 0.612 Test Loss: 1.114 Test Acc: 0.612
Validation loss decreased (-0.296039 --> -0.611831).  Saving model ...
Epoch: 4 cost time: 1.6469497680664062
Epoch: 4, Steps: 10 | Train Loss: 1.012 Vali Loss: 1.021 Vali Acc: 0.566 Test Loss: 1.021 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.336808443069458
Epoch: 5, Steps: 10 | Train Loss: 0.865 Vali Loss: 0.884 Vali Acc: 0.651 Test Loss: 0.884 Test Acc: 0.651
Validation loss decreased (-0.611831 --> -0.651307).  Saving model ...
Epoch: 6 cost time: 1.111609935760498
Epoch: 6, Steps: 10 | Train Loss: 0.664 Vali Loss: 0.826 Vali Acc: 0.645 Test Loss: 0.826 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.155705451965332
Epoch: 7, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.703 Vali Acc: 0.697 Test Loss: 0.703 Test Acc: 0.697
Validation loss decreased (-0.651307 --> -0.697361).  Saving model ...
Epoch: 8 cost time: 1.6303355693817139
Epoch: 8, Steps: 10 | Train Loss: 0.329 Vali Loss: 0.555 Vali Acc: 0.776 Test Loss: 0.555 Test Acc: 0.776
Validation loss decreased (-0.697361 --> -0.776310).  Saving model ...
Epoch: 9 cost time: 1.4639904499053955
Epoch: 9, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.514 Vali Acc: 0.776 Test Loss: 0.514 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 10 cost time: 1.4668617248535156
Epoch: 10, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
Validation loss decreased (-0.776311 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.4476096630096436
Epoch: 11, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.682 Vali Acc: 0.776 Test Loss: 0.682 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.639176607131958
Epoch: 12, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.661 Vali Acc: 0.822 Test Loss: 0.661 Test Acc: 0.822
Validation loss decreased (-0.796047 --> -0.822362).  Saving model ...
Epoch: 13 cost time: 1.6805298328399658
Epoch: 13, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.716 Vali Acc: 0.803 Test Loss: 0.716 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4976956844329834
Epoch: 14, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.827 Vali Acc: 0.796 Test Loss: 0.827 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3930487632751465
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.681 Vali Acc: 0.803 Test Loss: 0.681 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4679291248321533
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.560166597366333
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.796 Vali Acc: 0.796 Test Loss: 0.796 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4592196941375732
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.860 Vali Acc: 0.803 Test Loss: 0.860 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5772132873535156
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.938 Vali Acc: 0.796 Test Loss: 0.938 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7415282726287842
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.969 Vali Acc: 0.803 Test Loss: 0.969 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.483719825744629
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.951 Vali Acc: 0.803 Test Loss: 0.951 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3373773097991943
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.968 Vali Acc: 0.803 Test Loss: 0.968 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 5639336
model size : 26.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.030900239944458
Epoch: 1, Steps: 10 | Train Loss: 1.469 Vali Loss: 1.407 Vali Acc: 0.296 Test Loss: 1.407 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.303520917892456
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.331 Vali Acc: 0.382 Test Loss: 1.331 Test Acc: 0.382
Validation loss decreased (-0.296039 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.5483639240264893
Epoch: 3, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.260 Vali Acc: 0.322 Test Loss: 1.260 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5675618648529053
Epoch: 4, Steps: 10 | Train Loss: 1.161 Vali Loss: 1.127 Vali Acc: 0.579 Test Loss: 1.127 Test Acc: 0.579
Validation loss decreased (-0.381566 --> -0.578936).  Saving model ...
Epoch: 5 cost time: 1.6661243438720703
Epoch: 5, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.026 Vali Acc: 0.651 Test Loss: 1.026 Test Acc: 0.651
Validation loss decreased (-0.578936 --> -0.651306).  Saving model ...
Epoch: 6 cost time: 1.372962236404419
Epoch: 6, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.971 Vali Acc: 0.592 Test Loss: 0.971 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7057616710662842
Epoch: 7, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.909 Vali Acc: 0.599 Test Loss: 0.909 Test Acc: 0.599
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7129125595092773
Epoch: 8, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.676 Vali Acc: 0.717 Test Loss: 0.676 Test Acc: 0.717
Validation loss decreased (-0.651306 --> -0.717098).  Saving model ...
Epoch: 9 cost time: 1.5329749584197998
Epoch: 9, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.597 Vali Acc: 0.737 Test Loss: 0.597 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.7861051559448242
Epoch: 10, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.547 Vali Acc: 0.763 Test Loss: 0.547 Test Acc: 0.763
Validation loss decreased (-0.736836 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.8836476802825928
Epoch: 11, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.518 Vali Acc: 0.763 Test Loss: 0.518 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 12 cost time: 1.6107144355773926
Epoch: 12, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 13 cost time: 2.18733811378479
Epoch: 13, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.538 Vali Acc: 0.757 Test Loss: 0.538 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7987005710601807
Epoch: 14, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.548 Vali Acc: 0.789 Test Loss: 0.548 Test Acc: 0.789
Validation loss decreased (-0.769732 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.2620248794555664
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6632065773010254
Epoch: 16, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8850715160369873
Epoch: 17, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.626 Vali Acc: 0.763 Test Loss: 0.626 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2993059158325195
Epoch: 18, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.671 Vali Acc: 0.770 Test Loss: 0.671 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6774771213531494
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.633 Vali Acc: 0.763 Test Loss: 0.633 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.020007610321045
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.720 Vali Acc: 0.796 Test Loss: 0.720 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796045).  Saving model ...
Epoch: 21 cost time: 1.463942289352417
Epoch: 21, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.703 Vali Acc: 0.796 Test Loss: 0.703 Test Acc: 0.796
Validation loss decreased (-0.796045 --> -0.796046).  Saving model ...
Epoch: 22 cost time: 2.1006674766540527
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.666 Vali Acc: 0.789 Test Loss: 0.666 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.728074312210083
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.750 Vali Acc: 0.789 Test Loss: 0.750 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8751769065856934
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.937319040298462
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.762 Vali Acc: 0.783 Test Loss: 0.762 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.0547866821289062
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.753 Vali Acc: 0.776 Test Loss: 0.753 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.191791296005249
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.769 Vali Acc: 0.776 Test Loss: 0.769 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.8892765045166016
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.774 Vali Acc: 0.776 Test Loss: 0.774 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.812727689743042
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.794 Vali Acc: 0.776 Test Loss: 0.794 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.9348673820495605
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.805 Vali Acc: 0.783 Test Loss: 0.805 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.7303054332733154
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.814 Vali Acc: 0.776 Test Loss: 0.814 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 2662568
model size : 12.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.44879150390625
Epoch: 1, Steps: 10 | Train Loss: 1.475 Vali Loss: 1.413 Vali Acc: 0.197 Test Loss: 1.413 Test Acc: 0.197
Validation loss decreased (inf --> -0.197354).  Saving model ...
Epoch: 2 cost time: 1.8839731216430664
Epoch: 2, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.337 Vali Acc: 0.329 Test Loss: 1.337 Test Acc: 0.329
Validation loss decreased (-0.197354 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.4914722442626953
Epoch: 3, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.241 Vali Acc: 0.500 Test Loss: 1.241 Test Acc: 0.500
Validation loss decreased (-0.328934 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 2.3717315196990967
Epoch: 4, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.127 Vali Acc: 0.553 Test Loss: 1.127 Test Acc: 0.553
Validation loss decreased (-0.499988 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 1.9012877941131592
Epoch: 5, Steps: 10 | Train Loss: 0.977 Vali Loss: 1.081 Vali Acc: 0.553 Test Loss: 1.081 Test Acc: 0.553
Validation loss decreased (-0.552620 --> -0.552621).  Saving model ...
Epoch: 6 cost time: 1.5925006866455078
Epoch: 6, Steps: 10 | Train Loss: 0.797 Vali Loss: 0.887 Vali Acc: 0.658 Test Loss: 0.887 Test Acc: 0.658
Validation loss decreased (-0.552621 --> -0.657886).  Saving model ...
Epoch: 7 cost time: 1.958942174911499
Epoch: 7, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.741 Vali Acc: 0.737 Test Loss: 0.741 Test Acc: 0.737
Validation loss decreased (-0.657886 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 1.2727723121643066
Epoch: 8, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.769 Vali Acc: 0.658 Test Loss: 0.769 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1106374263763428
Epoch: 9, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.6527893543243408
Epoch: 10, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 2.0949583053588867
Epoch: 11, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.577 Vali Acc: 0.737 Test Loss: 0.577 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8926403522491455
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.631 Vali Acc: 0.776 Test Loss: 0.631 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 13 cost time: 1.5149874687194824
Epoch: 13, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6289262771606445
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
Validation loss decreased (-0.776309 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.7899043560028076
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4743318557739258
Epoch: 16, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.602 Vali Acc: 0.783 Test Loss: 0.602 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.7340643405914307
Epoch: 17, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.617 Vali Acc: 0.783 Test Loss: 0.617 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6967296600341797
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.661 Vali Acc: 0.763 Test Loss: 0.661 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.853851556777954
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.745 Vali Acc: 0.770 Test Loss: 0.745 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.409679889678955
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.783 Vali Acc: 0.796 Test Loss: 0.783 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796045).  Saving model ...
Epoch: 21 cost time: 1.6434385776519775
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.775 Vali Acc: 0.783 Test Loss: 0.775 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3631539344787598
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.797 Vali Acc: 0.783 Test Loss: 0.797 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2806768417358398
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.900 Vali Acc: 0.776 Test Loss: 0.900 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2751295566558838
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.867 Vali Acc: 0.789 Test Loss: 0.867 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4820473194122314
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.857 Vali Acc: 0.796 Test Loss: 0.857 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4761953353881836
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.937 Vali Acc: 0.783 Test Loss: 0.937 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0386786460876465
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.918 Vali Acc: 0.796 Test Loss: 0.918 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.087970733642578
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.965 Vali Acc: 0.770 Test Loss: 0.965 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.715575933456421
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.982 Vali Acc: 0.763 Test Loss: 0.982 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.5415656566619873
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.976 Vali Acc: 0.783 Test Loss: 0.976 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 2661928
model size : 12.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.788200855255127
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.419 Vali Acc: 0.250 Test Loss: 1.419 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.461838722229004
Epoch: 2, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.364 Vali Acc: 0.289 Test Loss: 1.364 Test Acc: 0.289
Validation loss decreased (-0.249986 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 1.4125127792358398
Epoch: 3, Steps: 10 | Train Loss: 1.304 Vali Loss: 1.272 Vali Acc: 0.461 Test Loss: 1.272 Test Acc: 0.461
Validation loss decreased (-0.289460 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 1.4789948463439941
Epoch: 4, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.143 Vali Acc: 0.559 Test Loss: 1.143 Test Acc: 0.559
Validation loss decreased (-0.460514 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.6194636821746826
Epoch: 5, Steps: 10 | Train Loss: 1.011 Vali Loss: 1.078 Vali Acc: 0.592 Test Loss: 1.078 Test Acc: 0.592
Validation loss decreased (-0.559199 --> -0.592094).  Saving model ...
Epoch: 6 cost time: 1.386892318725586
Epoch: 6, Steps: 10 | Train Loss: 0.867 Vali Loss: 0.915 Vali Acc: 0.651 Test Loss: 0.915 Test Acc: 0.651
Validation loss decreased (-0.592094 --> -0.651307).  Saving model ...
Epoch: 7 cost time: 1.6261532306671143
Epoch: 7, Steps: 10 | Train Loss: 0.752 Vali Loss: 0.889 Vali Acc: 0.632 Test Loss: 0.889 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9268271923065186
Epoch: 8, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.794 Vali Acc: 0.658 Test Loss: 0.794 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657887).  Saving model ...
Epoch: 9 cost time: 1.9769651889801025
Epoch: 9, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
Validation loss decreased (-0.657887 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.4511215686798096
Epoch: 10, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.565 Vali Acc: 0.763 Test Loss: 0.565 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.3101482391357422
Epoch: 11, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.550 Vali Acc: 0.743 Test Loss: 0.550 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.36625075340271
Epoch: 12, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.575 Vali Acc: 0.743 Test Loss: 0.575 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1909973621368408
Epoch: 13, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.2277183532714844
Epoch: 14, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.550 Vali Acc: 0.770 Test Loss: 0.550 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3047127723693848
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.552016019821167
Epoch: 16, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802625).  Saving model ...
Epoch: 17 cost time: 1.6913151741027832
Epoch: 17, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.609 Vali Acc: 0.770 Test Loss: 0.609 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4195725917816162
Epoch: 18, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.611 Vali Acc: 0.783 Test Loss: 0.611 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4952988624572754
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.441357135772705
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.672 Vali Acc: 0.783 Test Loss: 0.672 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.2273504734039307
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.691 Vali Acc: 0.789 Test Loss: 0.691 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4047234058380127
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.724 Vali Acc: 0.783 Test Loss: 0.724 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.376319169998169
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.752 Vali Acc: 0.770 Test Loss: 0.752 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3124346733093262
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.758 Vali Acc: 0.789 Test Loss: 0.758 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.5682590007781982
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.774 Vali Acc: 0.783 Test Loss: 0.774 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.5108764171600342
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.786 Vali Acc: 0.783 Test Loss: 0.786 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 2661288
model size : 12.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.051245927810669
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.353 Vali Acc: 0.309 Test Loss: 1.353 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.4979102611541748
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.272 Vali Acc: 0.447 Test Loss: 1.272 Test Acc: 0.447
Validation loss decreased (-0.309197 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 1.5086684226989746
Epoch: 3, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.187 Vali Acc: 0.533 Test Loss: 1.187 Test Acc: 0.533
Validation loss decreased (-0.447356 --> -0.532883).  Saving model ...
Epoch: 4 cost time: 1.1740539073944092
Epoch: 4, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.065 Vali Acc: 0.658 Test Loss: 1.065 Test Acc: 0.658
Validation loss decreased (-0.532883 --> -0.657884).  Saving model ...
Epoch: 5 cost time: 1.1601004600524902
Epoch: 5, Steps: 10 | Train Loss: 0.968 Vali Loss: 0.941 Vali Acc: 0.658 Test Loss: 0.941 Test Acc: 0.658
Validation loss decreased (-0.657884 --> -0.657885).  Saving model ...
Epoch: 6 cost time: 1.2209196090698242
Epoch: 6, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.813 Vali Acc: 0.704 Test Loss: 0.813 Test Acc: 0.704
Validation loss decreased (-0.657885 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.5112907886505127
Epoch: 7, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.820 Vali Acc: 0.645 Test Loss: 0.820 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3899359703063965
Epoch: 8, Steps: 10 | Train Loss: 0.516 Vali Loss: 0.693 Vali Acc: 0.697 Test Loss: 0.693 Test Acc: 0.697
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5217490196228027
Epoch: 9, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.619 Vali Acc: 0.763 Test Loss: 0.619 Test Acc: 0.763
Validation loss decreased (-0.703939 --> -0.763152).  Saving model ...
Epoch: 10 cost time: 1.6947925090789795
Epoch: 10, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.535 Vali Acc: 0.789 Test Loss: 0.535 Test Acc: 0.789
Validation loss decreased (-0.763152 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 1.3403129577636719
Epoch: 11, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.553 Vali Acc: 0.783 Test Loss: 0.553 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3747234344482422
Epoch: 12, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.538 Vali Acc: 0.789 Test Loss: 0.538 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3468213081359863
Epoch: 13, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.603743314743042
Epoch: 14, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3426704406738281
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 1.544234037399292
Epoch: 16, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.4224703311920166
Epoch: 17, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.662 Vali Acc: 0.783 Test Loss: 0.662 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7667438983917236
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.199465274810791
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.682 Vali Acc: 0.796 Test Loss: 0.682 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1763801574707031
Epoch: 20, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.723 Vali Acc: 0.789 Test Loss: 0.723 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4314277172088623
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.743 Vali Acc: 0.789 Test Loss: 0.743 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4451568126678467
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.761 Vali Acc: 0.789 Test Loss: 0.761 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.379880428314209
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.796 Vali Acc: 0.809 Test Loss: 0.796 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809203).  Saving model ...
Epoch: 24 cost time: 1.710315465927124
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.796 Vali Acc: 0.789 Test Loss: 0.796 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3791289329528809
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.826 Vali Acc: 0.803 Test Loss: 0.826 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3380801677703857
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.841 Vali Acc: 0.803 Test Loss: 0.841 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2366852760314941
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.857 Vali Acc: 0.809 Test Loss: 0.857 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.3806850910186768
Epoch: 28, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.854 Vali Acc: 0.803 Test Loss: 0.854 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.379209280014038
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.856 Vali Acc: 0.783 Test Loss: 0.856 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.4282560348510742
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.867 Vali Acc: 0.796 Test Loss: 0.867 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2192676067352295
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.881 Vali Acc: 0.803 Test Loss: 0.881 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.3380930423736572
Epoch: 32, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.895 Vali Acc: 0.783 Test Loss: 0.895 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2900691032409668
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.901 Vali Acc: 0.789 Test Loss: 0.901 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2660648
model size : 12.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6868088245391846
Epoch: 1, Steps: 10 | Train Loss: 1.436 Vali Loss: 1.345 Vali Acc: 0.355 Test Loss: 1.345 Test Acc: 0.355
Validation loss decreased (inf --> -0.355250).  Saving model ...
Epoch: 2 cost time: 1.7496695518493652
Epoch: 2, Steps: 10 | Train Loss: 1.344 Vali Loss: 1.271 Vali Acc: 0.474 Test Loss: 1.271 Test Acc: 0.474
Validation loss decreased (-0.355250 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 1.3529250621795654
Epoch: 3, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.185 Vali Acc: 0.559 Test Loss: 1.185 Test Acc: 0.559
Validation loss decreased (-0.473672 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.5602672100067139
Epoch: 4, Steps: 10 | Train Loss: 1.109 Vali Loss: 1.104 Vali Acc: 0.605 Test Loss: 1.104 Test Acc: 0.605
Validation loss decreased (-0.559199 --> -0.605252).  Saving model ...
Epoch: 5 cost time: 1.4888534545898438
Epoch: 5, Steps: 10 | Train Loss: 0.994 Vali Loss: 0.992 Vali Acc: 0.632 Test Loss: 0.992 Test Acc: 0.632
Validation loss decreased (-0.605252 --> -0.631569).  Saving model ...
Epoch: 6 cost time: 1.5407023429870605
Epoch: 6, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.889 Vali Acc: 0.664 Test Loss: 0.889 Test Acc: 0.664
Validation loss decreased (-0.631569 --> -0.664465).  Saving model ...
Epoch: 7 cost time: 1.5144834518432617
Epoch: 7, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.813 Vali Acc: 0.664 Test Loss: 0.813 Test Acc: 0.664
Validation loss decreased (-0.664465 --> -0.664466).  Saving model ...
Epoch: 8 cost time: 1.2292890548706055
Epoch: 8, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.694 Vali Acc: 0.730 Test Loss: 0.694 Test Acc: 0.730
Validation loss decreased (-0.664466 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 1.3278610706329346
Epoch: 9, Steps: 10 | Train Loss: 0.408 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 10 cost time: 1.6272013187408447
Epoch: 10, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.588 Vali Acc: 0.750 Test Loss: 0.588 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 11 cost time: 1.6998329162597656
Epoch: 11, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.561 Vali Acc: 0.750 Test Loss: 0.561 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 1.2723088264465332
Epoch: 12, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.577 Vali Acc: 0.803 Test Loss: 0.577 Test Acc: 0.803
Validation loss decreased (-0.749994 --> -0.802626).  Saving model ...
Epoch: 13 cost time: 1.4806761741638184
Epoch: 13, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5736567974090576
Epoch: 14, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.841 Vali Acc: 0.671 Test Loss: 0.841 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4631569385528564
Epoch: 15, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.654921054840088
Epoch: 16, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.593 Vali Acc: 0.789 Test Loss: 0.593 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4089717864990234
Epoch: 17, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7908082008361816
Epoch: 18, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.679 Vali Acc: 0.796 Test Loss: 0.679 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7186880111694336
Epoch: 19, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.653 Vali Acc: 0.803 Test Loss: 0.653 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5292234420776367
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.667 Vali Acc: 0.789 Test Loss: 0.667 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7835509777069092
Epoch: 21, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.734 Vali Acc: 0.757 Test Loss: 0.734 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4800283908843994
Epoch: 22, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.702 Vali Acc: 0.776 Test Loss: 0.702 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 2004648
model size : 10.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.592999458312988
Epoch: 1, Steps: 10 | Train Loss: 1.545 Vali Loss: 1.364 Vali Acc: 0.257 Test Loss: 1.364 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.6287336349487305
Epoch: 2, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.285 Vali Acc: 0.395 Test Loss: 1.285 Test Acc: 0.395
Validation loss decreased (-0.256565 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 1.3445391654968262
Epoch: 3, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.234 Vali Acc: 0.467 Test Loss: 1.234 Test Acc: 0.467
Validation loss decreased (-0.394724 --> -0.467093).  Saving model ...
Epoch: 4 cost time: 1.3819539546966553
Epoch: 4, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.103 Vali Acc: 0.632 Test Loss: 1.103 Test Acc: 0.632
Validation loss decreased (-0.467093 --> -0.631568).  Saving model ...
Epoch: 5 cost time: 1.2132465839385986
Epoch: 5, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.002 Vali Acc: 0.711 Test Loss: 1.002 Test Acc: 0.711
Validation loss decreased (-0.631568 --> -0.710516).  Saving model ...
Epoch: 6 cost time: 1.4759345054626465
Epoch: 6, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.877 Vali Acc: 0.737 Test Loss: 0.877 Test Acc: 0.737
Validation loss decreased (-0.710516 --> -0.736833).  Saving model ...
Epoch: 7 cost time: 1.305849552154541
Epoch: 7, Steps: 10 | Train Loss: 0.662 Vali Loss: 0.777 Vali Acc: 0.717 Test Loss: 0.777 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4034600257873535
Epoch: 8, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.733 Vali Acc: 0.730 Test Loss: 0.733 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4452221393585205
Epoch: 9, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.657 Vali Acc: 0.750 Test Loss: 0.657 Test Acc: 0.750
Validation loss decreased (-0.736833 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 1.2906193733215332
Epoch: 10, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.565 Vali Acc: 0.770 Test Loss: 0.565 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.362372636795044
Epoch: 11, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.577 Vali Acc: 0.730 Test Loss: 0.577 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2924134731292725
Epoch: 12, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 13 cost time: 1.3010613918304443
Epoch: 13, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
Validation loss decreased (-0.776311 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.5296547412872314
Epoch: 14, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.475834846496582
Epoch: 15, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.806 Vali Acc: 0.730 Test Loss: 0.806 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.358450174331665
Epoch: 16, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.575 Vali Acc: 0.809 Test Loss: 0.575 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 1.5377180576324463
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.5634253025054932
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.607 Vali Acc: 0.796 Test Loss: 0.607 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3826258182525635
Epoch: 19, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.593 Vali Acc: 0.822 Test Loss: 0.593 Test Acc: 0.822
Validation loss decreased (-0.809205 --> -0.822362).  Saving model ...
Epoch: 20 cost time: 1.2485430240631104
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.431497573852539
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.708 Vali Acc: 0.809 Test Loss: 0.708 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.926987648010254
Epoch: 22, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.683 Vali Acc: 0.803 Test Loss: 0.683 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6306185722351074
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3409616947174072
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.729 Vali Acc: 0.809 Test Loss: 0.729 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.547734022140503
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.758 Vali Acc: 0.822 Test Loss: 0.758 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8356115818023682
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.821 Vali Acc: 0.809 Test Loss: 0.821 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5373671054840088
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.807 Vali Acc: 0.796 Test Loss: 0.807 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.7717866897583008
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.817 Vali Acc: 0.822 Test Loss: 0.817 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5125293731689453
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.852 Vali Acc: 0.803 Test Loss: 0.852 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 2004008
model size : 10.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.7035229206085205
Epoch: 1, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.358 Vali Acc: 0.382 Test Loss: 1.358 Test Acc: 0.382
Validation loss decreased (inf --> -0.381565).  Saving model ...
Epoch: 2 cost time: 1.5584683418273926
Epoch: 2, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.280 Vali Acc: 0.447 Test Loss: 1.280 Test Acc: 0.447
Validation loss decreased (-0.381565 --> -0.447356).  Saving model ...
Epoch: 3 cost time: 1.670257568359375
Epoch: 3, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.183 Vali Acc: 0.612 Test Loss: 1.183 Test Acc: 0.612
Validation loss decreased (-0.447356 --> -0.611830).  Saving model ...
Epoch: 4 cost time: 1.3153505325317383
Epoch: 4, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.128 Vali Acc: 0.546 Test Loss: 1.128 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.796358585357666
Epoch: 5, Steps: 10 | Train Loss: 0.938 Vali Loss: 0.956 Vali Acc: 0.671 Test Loss: 0.956 Test Acc: 0.671
Validation loss decreased (-0.611830 --> -0.671043).  Saving model ...
Epoch: 6 cost time: 1.8662407398223877
Epoch: 6, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.912 Vali Acc: 0.651 Test Loss: 0.912 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4556193351745605
Epoch: 7, Steps: 10 | Train Loss: 0.642 Vali Loss: 0.777 Vali Acc: 0.678 Test Loss: 0.777 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677624).  Saving model ...
Epoch: 8 cost time: 1.9036486148834229
Epoch: 8, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.714 Vali Acc: 0.711 Test Loss: 0.714 Test Acc: 0.711
Validation loss decreased (-0.677624 --> -0.710519).  Saving model ...
Epoch: 9 cost time: 1.9438090324401855
Epoch: 9, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.661 Vali Acc: 0.757 Test Loss: 0.661 Test Acc: 0.757
Validation loss decreased (-0.710519 --> -0.756572).  Saving model ...
Epoch: 10 cost time: 1.7497804164886475
Epoch: 10, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.439878225326538
Epoch: 11, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.704498052597046
Epoch: 12, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.580 Vali Acc: 0.750 Test Loss: 0.580 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6612520217895508
Epoch: 13, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.600 Vali Acc: 0.750 Test Loss: 0.600 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5192384719848633
Epoch: 14, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.540 Vali Acc: 0.763 Test Loss: 0.540 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.5897681713104248
Epoch: 15, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.5520899295806885
Epoch: 16, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.564 Vali Acc: 0.743 Test Loss: 0.564 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5448055267333984
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.599 Vali Acc: 0.796 Test Loss: 0.599 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.797114610671997
Epoch: 18, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.616 Vali Acc: 0.770 Test Loss: 0.616 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.497838020324707
Epoch: 19, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3040390014648438
Epoch: 20, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.652 Vali Acc: 0.796 Test Loss: 0.652 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5850505828857422
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.692 Vali Acc: 0.803 Test Loss: 0.692 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 22 cost time: 1.5197608470916748
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.730 Vali Acc: 0.796 Test Loss: 0.730 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.05037260055542
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.750 Vali Acc: 0.796 Test Loss: 0.750 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5340371131896973
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.826 Vali Acc: 0.783 Test Loss: 0.826 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.512655258178711
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.896 Vali Acc: 0.796 Test Loss: 0.896 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5404813289642334
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.844 Vali Acc: 0.763 Test Loss: 0.844 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.599076747894287
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.852 Vali Acc: 0.770 Test Loss: 0.852 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.779383659362793
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.876 Vali Acc: 0.757 Test Loss: 0.876 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5942716598510742
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.887 Vali Acc: 0.763 Test Loss: 0.887 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6553292274475098
Epoch: 30, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.898 Vali Acc: 0.763 Test Loss: 0.898 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6545813083648682
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.910 Vali Acc: 0.770 Test Loss: 0.910 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 2003368
model size : 10.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.077726125717163
Epoch: 1, Steps: 10 | Train Loss: 1.477 Vali Loss: 1.395 Vali Acc: 0.237 Test Loss: 1.395 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.6313791275024414
Epoch: 2, Steps: 10 | Train Loss: 1.400 Vali Loss: 1.339 Vali Acc: 0.342 Test Loss: 1.339 Test Acc: 0.342
Validation loss decreased (-0.236828 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.3865830898284912
Epoch: 3, Steps: 10 | Train Loss: 1.286 Vali Loss: 1.267 Vali Acc: 0.500 Test Loss: 1.267 Test Acc: 0.500
Validation loss decreased (-0.342092 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 1.5149264335632324
Epoch: 4, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.163 Vali Acc: 0.553 Test Loss: 1.163 Test Acc: 0.553
Validation loss decreased (-0.499987 --> -0.552620).  Saving model ...
Epoch: 5 cost time: 1.5141301155090332
Epoch: 5, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.055 Vali Acc: 0.638 Test Loss: 1.055 Test Acc: 0.638
Validation loss decreased (-0.552620 --> -0.638147).  Saving model ...
Epoch: 6 cost time: 2.1356236934661865
Epoch: 6, Steps: 10 | Train Loss: 0.935 Vali Loss: 0.955 Vali Acc: 0.664 Test Loss: 0.955 Test Acc: 0.664
Validation loss decreased (-0.638147 --> -0.664464).  Saving model ...
Epoch: 7 cost time: 1.2778334617614746
Epoch: 7, Steps: 10 | Train Loss: 0.770 Vali Loss: 0.923 Vali Acc: 0.651 Test Loss: 0.923 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3906819820404053
Epoch: 8, Steps: 10 | Train Loss: 0.646 Vali Loss: 0.766 Vali Acc: 0.684 Test Loss: 0.766 Test Acc: 0.684
Validation loss decreased (-0.664464 --> -0.684203).  Saving model ...
Epoch: 9 cost time: 1.5212843418121338
Epoch: 9, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.646 Vali Acc: 0.737 Test Loss: 0.646 Test Acc: 0.737
Validation loss decreased (-0.684203 --> -0.736836).  Saving model ...
Epoch: 10 cost time: 1.2558097839355469
Epoch: 10, Steps: 10 | Train Loss: 0.350 Vali Loss: 0.670 Vali Acc: 0.717 Test Loss: 0.670 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2333195209503174
Epoch: 11, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.558 Vali Acc: 0.743 Test Loss: 0.558 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.4537835121154785
Epoch: 12, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 2.289205551147461
Epoch: 13, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.539 Vali Acc: 0.750 Test Loss: 0.539 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5139851570129395
Epoch: 14, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776311).  Saving model ...
Epoch: 15 cost time: 1.859797477722168
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.5532047748565674
Epoch: 16, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809205).  Saving model ...
Epoch: 17 cost time: 1.464979648590088
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.578 Vali Acc: 0.796 Test Loss: 0.578 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7190637588500977
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.618 Vali Acc: 0.789 Test Loss: 0.618 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.622267484664917
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.682 Vali Acc: 0.783 Test Loss: 0.682 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7145249843597412
Epoch: 20, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.795 Vali Acc: 0.796 Test Loss: 0.795 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8955721855163574
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.701 Vali Acc: 0.796 Test Loss: 0.701 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.7881731986999512
Epoch: 22, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.745 Vali Acc: 0.776 Test Loss: 0.745 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.626180648803711
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.800 Vali Acc: 0.796 Test Loss: 0.800 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7794334888458252
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.824 Vali Acc: 0.783 Test Loss: 0.824 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.758533239364624
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.863 Vali Acc: 0.809 Test Loss: 0.863 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6421847343444824
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.911 Vali Acc: 0.783 Test Loss: 0.911 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 2002728
model size : 10.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3499183654785156
Epoch: 1, Steps: 10 | Train Loss: 1.440 Vali Loss: 1.376 Vali Acc: 0.289 Test Loss: 1.376 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.469954013824463
Epoch: 2, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.328 Vali Acc: 0.382 Test Loss: 1.328 Test Acc: 0.382
Validation loss decreased (-0.289460 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.346146583557129
Epoch: 3, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.255 Vali Acc: 0.421 Test Loss: 1.255 Test Acc: 0.421
Validation loss decreased (-0.381566 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.393101692199707
Epoch: 4, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.185 Vali Acc: 0.539 Test Loss: 1.185 Test Acc: 0.539
Validation loss decreased (-0.421040 --> -0.539462).  Saving model ...
Epoch: 5 cost time: 1.3007454872131348
Epoch: 5, Steps: 10 | Train Loss: 1.058 Vali Loss: 1.087 Vali Acc: 0.658 Test Loss: 1.087 Test Acc: 0.658
Validation loss decreased (-0.539462 --> -0.657884).  Saving model ...
Epoch: 6 cost time: 1.3145513534545898
Epoch: 6, Steps: 10 | Train Loss: 0.935 Vali Loss: 0.989 Vali Acc: 0.638 Test Loss: 0.989 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4108490943908691
Epoch: 7, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.914 Vali Acc: 0.632 Test Loss: 0.914 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.361065149307251
Epoch: 8, Steps: 10 | Train Loss: 0.667 Vali Loss: 0.802 Vali Acc: 0.691 Test Loss: 0.802 Test Acc: 0.691
Validation loss decreased (-0.657884 --> -0.690781).  Saving model ...
Epoch: 9 cost time: 1.275167465209961
Epoch: 9, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.730 Vali Acc: 0.711 Test Loss: 0.730 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.228837490081787
Epoch: 10, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.675 Vali Acc: 0.737 Test Loss: 0.675 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 1.2967829704284668
Epoch: 11, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.1741211414337158
Epoch: 12, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.3527750968933105
Epoch: 13, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.537 Vali Acc: 0.770 Test Loss: 0.537 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4946069717407227
Epoch: 14, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.535 Vali Acc: 0.757 Test Loss: 0.535 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3941307067871094
Epoch: 15, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 2.1398870944976807
Epoch: 16, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
Validation loss decreased (-0.782889 --> -0.802625).  Saving model ...
Epoch: 17 cost time: 1.2941489219665527
Epoch: 17, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.590 Vali Acc: 0.763 Test Loss: 0.590 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4324891567230225
Epoch: 18, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.545 Vali Acc: 0.776 Test Loss: 0.545 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5484638214111328
Epoch: 19, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809205).  Saving model ...
Epoch: 20 cost time: 1.5429749488830566
Epoch: 20, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.593 Vali Acc: 0.789 Test Loss: 0.593 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5489630699157715
Epoch: 21, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.615 Vali Acc: 0.803 Test Loss: 0.615 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4839932918548584
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5825283527374268
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.685 Vali Acc: 0.789 Test Loss: 0.685 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3084726333618164
Epoch: 24, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.702 Vali Acc: 0.803 Test Loss: 0.702 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3724956512451172
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.722 Vali Acc: 0.816 Test Loss: 0.722 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815782).  Saving model ...
Epoch: 26 cost time: 1.119258165359497
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.775 Vali Acc: 0.789 Test Loss: 0.775 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.4909656047821045
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.750 Vali Acc: 0.809 Test Loss: 0.750 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4466423988342285
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.783 Vali Acc: 0.803 Test Loss: 0.783 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3026177883148193
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.814 Vali Acc: 0.796 Test Loss: 0.814 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5772526264190674
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.834 Vali Acc: 0.796 Test Loss: 0.834 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.5721244812011719
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.852 Vali Acc: 0.803 Test Loss: 0.852 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.515692949295044
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.866 Vali Acc: 0.789 Test Loss: 0.866 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5531587600708008
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.873 Vali Acc: 0.796 Test Loss: 0.873 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2979578971862793
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.879 Vali Acc: 0.809 Test Loss: 0.879 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.6241919994354248
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.897 Vali Acc: 0.809 Test Loss: 0.897 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1675688
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.770137548446655
Epoch: 1, Steps: 10 | Train Loss: 1.458 Vali Loss: 1.385 Vali Acc: 0.237 Test Loss: 1.385 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.6661081314086914
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.327 Vali Acc: 0.316 Test Loss: 1.327 Test Acc: 0.316
Validation loss decreased (-0.236828 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.5840487480163574
Epoch: 3, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.250 Vali Acc: 0.474 Test Loss: 1.250 Test Acc: 0.474
Validation loss decreased (-0.315776 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 1.7417504787445068
Epoch: 4, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.158 Vali Acc: 0.546 Test Loss: 1.158 Test Acc: 0.546
Validation loss decreased (-0.473672 --> -0.546041).  Saving model ...
Epoch: 5 cost time: 1.2940669059753418
Epoch: 5, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.058 Vali Acc: 0.664 Test Loss: 1.058 Test Acc: 0.664
Validation loss decreased (-0.546041 --> -0.664463).  Saving model ...
Epoch: 6 cost time: 1.6066699028015137
Epoch: 6, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.943 Vali Acc: 0.671 Test Loss: 0.943 Test Acc: 0.671
Validation loss decreased (-0.664463 --> -0.671043).  Saving model ...
Epoch: 7 cost time: 1.4474401473999023
Epoch: 7, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.836 Vali Acc: 0.684 Test Loss: 0.836 Test Acc: 0.684
Validation loss decreased (-0.671043 --> -0.684202).  Saving model ...
Epoch: 8 cost time: 1.6097333431243896
Epoch: 8, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.779 Vali Acc: 0.684 Test Loss: 0.779 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684203).  Saving model ...
Epoch: 9 cost time: 1.5044665336608887
Epoch: 9, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.677 Vali Acc: 0.717 Test Loss: 0.677 Test Acc: 0.717
Validation loss decreased (-0.684203 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 1.471125602722168
Epoch: 10, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.614 Vali Acc: 0.783 Test Loss: 0.614 Test Acc: 0.783
Validation loss decreased (-0.717098 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 2.3364171981811523
Epoch: 11, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5545532703399658
Epoch: 12, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8189666271209717
Epoch: 13, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 14 cost time: 1.7023141384124756
Epoch: 14, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.619 Vali Acc: 0.796 Test Loss: 0.619 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 15 cost time: 1.6774609088897705
Epoch: 15, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.5973420143127441
Epoch: 16, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.608 Vali Acc: 0.789 Test Loss: 0.608 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0066657066345215
Epoch: 17, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.576 Vali Acc: 0.796 Test Loss: 0.576 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1542465686798096
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.593 Vali Acc: 0.789 Test Loss: 0.593 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4240179061889648
Epoch: 19, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.584 Vali Acc: 0.783 Test Loss: 0.584 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0283570289611816
Epoch: 20, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.644 Vali Acc: 0.809 Test Loss: 0.644 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 21 cost time: 1.9668662548065186
Epoch: 21, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.668 Vali Acc: 0.809 Test Loss: 0.668 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7666091918945312
Epoch: 22, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.701 Vali Acc: 0.809 Test Loss: 0.701 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5575146675109863
Epoch: 23, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.749 Vali Acc: 0.803 Test Loss: 0.749 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2207353115081787
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.760 Vali Acc: 0.783 Test Loss: 0.760 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6660244464874268
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.767 Vali Acc: 0.803 Test Loss: 0.767 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4506752490997314
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.778 Vali Acc: 0.796 Test Loss: 0.778 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.6939167976379395
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.794 Vali Acc: 0.796 Test Loss: 0.794 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4742872714996338
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.821 Vali Acc: 0.803 Test Loss: 0.821 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.2063183784484863
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.838 Vali Acc: 0.803 Test Loss: 0.838 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8433711528778076
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.846 Vali Acc: 0.796 Test Loss: 0.846 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1675048
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.764115333557129
Epoch: 1, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.386 Vali Acc: 0.303 Test Loss: 1.386 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.7219738960266113
Epoch: 2, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.326 Vali Acc: 0.414 Test Loss: 1.326 Test Acc: 0.414
Validation loss decreased (-0.302618 --> -0.414460).  Saving model ...
Epoch: 3 cost time: 2.1402664184570312
Epoch: 3, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.251 Vali Acc: 0.428 Test Loss: 1.251 Test Acc: 0.428
Validation loss decreased (-0.414460 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 1.8868646621704102
Epoch: 4, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.184 Vali Acc: 0.572 Test Loss: 1.184 Test Acc: 0.572
Validation loss decreased (-0.427619 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 1.8543345928192139
Epoch: 5, Steps: 10 | Train Loss: 1.066 Vali Loss: 1.085 Vali Acc: 0.454 Test Loss: 1.085 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2228329181671143
Epoch: 6, Steps: 10 | Train Loss: 0.977 Vali Loss: 0.948 Vali Acc: 0.645 Test Loss: 0.948 Test Acc: 0.645
Validation loss decreased (-0.572357 --> -0.644727).  Saving model ...
Epoch: 7 cost time: 1.834251880645752
Epoch: 7, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.845 Vali Acc: 0.651 Test Loss: 0.845 Test Acc: 0.651
Validation loss decreased (-0.644727 --> -0.651307).  Saving model ...
Epoch: 8 cost time: 1.6518325805664062
Epoch: 8, Steps: 10 | Train Loss: 0.596 Vali Loss: 0.767 Vali Acc: 0.664 Test Loss: 0.767 Test Acc: 0.664
Validation loss decreased (-0.651307 --> -0.664466).  Saving model ...
Epoch: 9 cost time: 1.637554407119751
Epoch: 9, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.675 Vali Acc: 0.691 Test Loss: 0.675 Test Acc: 0.691
Validation loss decreased (-0.664466 --> -0.690783).  Saving model ...
Epoch: 10 cost time: 1.783308744430542
Epoch: 10, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.691 Vali Acc: 0.697 Test Loss: 0.691 Test Acc: 0.697
Validation loss decreased (-0.690783 --> -0.697362).  Saving model ...
Epoch: 11 cost time: 1.901364803314209
Epoch: 11, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.542 Vali Acc: 0.763 Test Loss: 0.542 Test Acc: 0.763
Validation loss decreased (-0.697362 --> -0.763152).  Saving model ...
Epoch: 12 cost time: 1.8200385570526123
Epoch: 12, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.558 Vali Acc: 0.783 Test Loss: 0.558 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.600316047668457
Epoch: 13, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.550 Vali Acc: 0.763 Test Loss: 0.550 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.0665342807769775
Epoch: 14, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.576 Vali Acc: 0.757 Test Loss: 0.576 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.778339147567749
Epoch: 15, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.316011905670166
Epoch: 16, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.656 Vali Acc: 0.776 Test Loss: 0.656 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9624648094177246
Epoch: 17, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.616 Vali Acc: 0.803 Test Loss: 0.616 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802625).  Saving model ...
Epoch: 18 cost time: 1.8092458248138428
Epoch: 18, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.637 Vali Acc: 0.763 Test Loss: 0.637 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9399027824401855
Epoch: 19, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.652 Vali Acc: 0.783 Test Loss: 0.652 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.866234540939331
Epoch: 20, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.631 Vali Acc: 0.796 Test Loss: 0.631 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5414910316467285
Epoch: 21, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.722 Vali Acc: 0.796 Test Loss: 0.722 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.422431230545044
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.749 Vali Acc: 0.789 Test Loss: 0.749 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1874914169311523
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.808 Vali Acc: 0.803 Test Loss: 0.808 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.622067928314209
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809203).  Saving model ...
Epoch: 25 cost time: 1.6580586433410645
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.747 Vali Acc: 0.809 Test Loss: 0.747 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.811861515045166
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.776 Vali Acc: 0.803 Test Loss: 0.776 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.3387625217437744
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.786 Vali Acc: 0.796 Test Loss: 0.786 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.8411970138549805
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.804 Vali Acc: 0.816 Test Loss: 0.804 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815781).  Saving model ...
Epoch: 29 cost time: 2.1824259757995605
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.814 Vali Acc: 0.796 Test Loss: 0.814 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.9610624313354492
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.834 Vali Acc: 0.803 Test Loss: 0.834 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7863850593566895
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.842 Vali Acc: 0.796 Test Loss: 0.842 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.6905992031097412
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.854 Vali Acc: 0.816 Test Loss: 0.854 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5779767036437988
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.863 Vali Acc: 0.809 Test Loss: 0.863 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.5508370399475098
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.803 Test Loss: 0.878 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.7173221111297607
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.895 Vali Acc: 0.803 Test Loss: 0.895 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.779616355895996
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.902 Vali Acc: 0.796 Test Loss: 0.902 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4639346599578857
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.910 Vali Acc: 0.803 Test Loss: 0.910 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2608437538146973
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.921 Vali Acc: 0.796 Test Loss: 0.921 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1674408
model size : 8.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5542781352996826
Epoch: 1, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.377 Vali Acc: 0.355 Test Loss: 1.377 Test Acc: 0.355
Validation loss decreased (inf --> -0.355249).  Saving model ...
Epoch: 2 cost time: 1.4239017963409424
Epoch: 2, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.341 Vali Acc: 0.414 Test Loss: 1.341 Test Acc: 0.414
Validation loss decreased (-0.355249 --> -0.414460).  Saving model ...
Epoch: 3 cost time: 1.3885371685028076
Epoch: 3, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.254 Vali Acc: 0.428 Test Loss: 1.254 Test Acc: 0.428
Validation loss decreased (-0.414460 --> -0.427619).  Saving model ...
Epoch: 4 cost time: 1.8206748962402344
Epoch: 4, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.168 Vali Acc: 0.599 Test Loss: 1.168 Test Acc: 0.599
Validation loss decreased (-0.427619 --> -0.598673).  Saving model ...
Epoch: 5 cost time: 1.2905282974243164
Epoch: 5, Steps: 10 | Train Loss: 1.021 Vali Loss: 1.078 Vali Acc: 0.559 Test Loss: 1.078 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4698748588562012
Epoch: 6, Steps: 10 | Train Loss: 0.912 Vali Loss: 0.957 Vali Acc: 0.658 Test Loss: 0.957 Test Acc: 0.658
Validation loss decreased (-0.598673 --> -0.657885).  Saving model ...
Epoch: 7 cost time: 1.5271084308624268
Epoch: 7, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.879 Vali Acc: 0.632 Test Loss: 0.879 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5714657306671143
Epoch: 8, Steps: 10 | Train Loss: 0.665 Vali Loss: 0.792 Vali Acc: 0.678 Test Loss: 0.792 Test Acc: 0.678
Validation loss decreased (-0.657885 --> -0.677624).  Saving model ...
Epoch: 9 cost time: 1.4033277034759521
Epoch: 9, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.731 Vali Acc: 0.678 Test Loss: 0.731 Test Acc: 0.678
Validation loss decreased (-0.677624 --> -0.677624).  Saving model ...
Epoch: 10 cost time: 1.6352875232696533
Epoch: 10, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.742 Vali Acc: 0.691 Test Loss: 0.742 Test Acc: 0.691
Validation loss decreased (-0.677624 --> -0.690782).  Saving model ...
Epoch: 11 cost time: 1.3932793140411377
Epoch: 11, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.656 Vali Acc: 0.724 Test Loss: 0.656 Test Acc: 0.724
Validation loss decreased (-0.690782 --> -0.723678).  Saving model ...
Epoch: 12 cost time: 1.5427346229553223
Epoch: 12, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.615 Vali Acc: 0.757 Test Loss: 0.615 Test Acc: 0.757
Validation loss decreased (-0.723678 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.1616709232330322
Epoch: 13, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5739021301269531
Epoch: 14, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.539 Vali Acc: 0.757 Test Loss: 0.539 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 15 cost time: 1.5752975940704346
Epoch: 15, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.565 Vali Acc: 0.757 Test Loss: 0.565 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.26664400100708
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
Validation loss decreased (-0.756574 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.4231889247894287
Epoch: 17, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.6135945320129395
Epoch: 18, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.649 Vali Acc: 0.796 Test Loss: 0.649 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 19 cost time: 1.3760135173797607
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.449361801147461
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.704 Vali Acc: 0.783 Test Loss: 0.704 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3987452983856201
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.719 Vali Acc: 0.796 Test Loss: 0.719 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4741785526275635
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.768 Vali Acc: 0.789 Test Loss: 0.768 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5946121215820312
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.785 Vali Acc: 0.809 Test Loss: 0.785 Test Acc: 0.809
Validation loss decreased (-0.796046 --> -0.809203).  Saving model ...
Epoch: 24 cost time: 1.5269842147827148
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.829 Vali Acc: 0.789 Test Loss: 0.829 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3339965343475342
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.883 Vali Acc: 0.803 Test Loss: 0.883 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2609376907348633
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.914 Vali Acc: 0.776 Test Loss: 0.914 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.363114356994629
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.878 Vali Acc: 0.789 Test Loss: 0.878 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.324190378189087
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.845 Vali Acc: 0.783 Test Loss: 0.845 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8505401611328125
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.846 Vali Acc: 0.816 Test Loss: 0.846 Test Acc: 0.816
Validation loss decreased (-0.809203 --> -0.815781).  Saving model ...
Epoch: 30 cost time: 1.1656560897827148
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.874 Vali Acc: 0.803 Test Loss: 0.874 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3918898105621338
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.922 Vali Acc: 0.789 Test Loss: 0.922 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2440342903137207
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.959 Vali Acc: 0.789 Test Loss: 0.959 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2244906425476074
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.965 Vali Acc: 0.789 Test Loss: 0.965 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3981804847717285
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.980 Vali Acc: 0.789 Test Loss: 0.980 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.176647663116455
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.077 Vali Acc: 0.783 Test Loss: 1.077 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3392133712768555
Epoch: 36, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.038 Vali Acc: 0.803 Test Loss: 1.038 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.4090147018432617
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.049 Vali Acc: 0.789 Test Loss: 1.049 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.3855788707733154
Epoch: 38, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.898 Vali Acc: 0.776 Test Loss: 0.898 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.5202140808105469
Epoch: 39, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.590 Vali Acc: 0.724 Test Loss: 1.590 Test Acc: 0.724
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1673768
model size : 8.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7166125774383545
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.416 Vali Acc: 0.309 Test Loss: 1.416 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 1.3933062553405762
Epoch: 2, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.354 Vali Acc: 0.355 Test Loss: 1.354 Test Acc: 0.355
Validation loss decreased (-0.309196 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.1886169910430908
Epoch: 3, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.296 Vali Acc: 0.461 Test Loss: 1.296 Test Acc: 0.461
Validation loss decreased (-0.355250 --> -0.460513).  Saving model ...
Epoch: 4 cost time: 1.6082489490509033
Epoch: 4, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.213 Vali Acc: 0.454 Test Loss: 1.213 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2053096294403076
Epoch: 5, Steps: 10 | Train Loss: 1.092 Vali Loss: 1.112 Vali Acc: 0.658 Test Loss: 1.112 Test Acc: 0.658
Validation loss decreased (-0.460513 --> -0.657884).  Saving model ...
Epoch: 6 cost time: 1.442166805267334
Epoch: 6, Steps: 10 | Train Loss: 0.930 Vali Loss: 1.029 Vali Acc: 0.605 Test Loss: 1.029 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2455050945281982
Epoch: 7, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.919 Vali Acc: 0.638 Test Loss: 0.919 Test Acc: 0.638
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.331693410873413
Epoch: 8, Steps: 10 | Train Loss: 0.650 Vali Loss: 0.833 Vali Acc: 0.671 Test Loss: 0.833 Test Acc: 0.671
Validation loss decreased (-0.657884 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 1.5665838718414307
Epoch: 9, Steps: 10 | Train Loss: 0.517 Vali Loss: 0.803 Vali Acc: 0.684 Test Loss: 0.803 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684202).  Saving model ...
Epoch: 10 cost time: 1.567626714706421
Epoch: 10, Steps: 10 | Train Loss: 0.467 Vali Loss: 0.703 Vali Acc: 0.711 Test Loss: 0.703 Test Acc: 0.711
Validation loss decreased (-0.684202 --> -0.710519).  Saving model ...
Epoch: 11 cost time: 1.6196386814117432
Epoch: 11, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.631 Vali Acc: 0.724 Test Loss: 0.631 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723678).  Saving model ...
Epoch: 12 cost time: 1.6814439296722412
Epoch: 12, Steps: 10 | Train Loss: 0.238 Vali Loss: 0.604 Vali Acc: 0.737 Test Loss: 0.604 Test Acc: 0.737
Validation loss decreased (-0.723678 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 1.5667753219604492
Epoch: 13, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.632 Vali Acc: 0.770 Test Loss: 0.632 Test Acc: 0.770
Validation loss decreased (-0.736836 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.4502766132354736
Epoch: 14, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3164520263671875
Epoch: 15, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.590 Vali Acc: 0.730 Test Loss: 0.590 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4742331504821777
Epoch: 16, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 2.0894968509674072
Epoch: 17, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.580 Vali Acc: 0.776 Test Loss: 0.580 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9121525287628174
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.622 Vali Acc: 0.770 Test Loss: 0.622 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9964337348937988
Epoch: 19, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.631 Vali Acc: 0.776 Test Loss: 0.631 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.856368064880371
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.643 Vali Acc: 0.757 Test Loss: 0.643 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3756251335144043
Epoch: 21, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 22 cost time: 1.40165376663208
Epoch: 22, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.762 Vali Acc: 0.789 Test Loss: 0.762 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789466).  Saving model ...
Epoch: 23 cost time: 1.3810508251190186
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.797 Vali Acc: 0.783 Test Loss: 0.797 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.429098129272461
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.803 Vali Acc: 0.783 Test Loss: 0.803 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.3603191375732422
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.792 Vali Acc: 0.776 Test Loss: 0.792 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.4501209259033203
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.843 Vali Acc: 0.770 Test Loss: 0.843 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.417348861694336
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.832 Vali Acc: 0.783 Test Loss: 0.832 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7117679119110107
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.848 Vali Acc: 0.783 Test Loss: 0.848 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6836295127868652
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.878 Vali Acc: 0.783 Test Loss: 0.878 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7516603469848633
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.895 Vali Acc: 0.789 Test Loss: 0.895 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.5766346454620361
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.910 Vali Acc: 0.796 Test Loss: 0.910 Test Acc: 0.796
Validation loss decreased (-0.789466 --> -0.796044).  Saving model ...
Epoch: 32 cost time: 1.3406825065612793
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.921 Vali Acc: 0.796 Test Loss: 0.921 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.773414134979248
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.934 Vali Acc: 0.796 Test Loss: 0.934 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.8409061431884766
Epoch: 34, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.942 Vali Acc: 0.796 Test Loss: 0.942 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.4108169078826904
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.952 Vali Acc: 0.796 Test Loss: 0.952 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4916431903839111
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.956 Vali Acc: 0.803 Test Loss: 0.956 Test Acc: 0.803
Validation loss decreased (-0.796044 --> -0.802622).  Saving model ...
Epoch: 37 cost time: 1.8570141792297363
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.990 Vali Acc: 0.796 Test Loss: 0.990 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.5035667419433594
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.997 Vali Acc: 0.796 Test Loss: 0.997 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.573209524154663
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.803 Test Loss: 0.995 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4259178638458252
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.796 Test Loss: 1.011 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.4391064643859863
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.803 Test Loss: 1.007 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.6558372974395752
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.013 Vali Acc: 0.796 Test Loss: 1.013 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.9882407188415527
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.023 Vali Acc: 0.796 Test Loss: 1.023 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.8709604740142822
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.036 Vali Acc: 0.796 Test Loss: 1.036 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.673626184463501
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.045 Vali Acc: 0.796 Test Loss: 1.045 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.7541861534118652
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.046 Vali Acc: 0.796 Test Loss: 1.046 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1511208
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.386078834533691
Epoch: 1, Steps: 10 | Train Loss: 1.497 Vali Loss: 1.384 Vali Acc: 0.270 Test Loss: 1.384 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.5613903999328613
Epoch: 2, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.351 Vali Acc: 0.303 Test Loss: 1.351 Test Acc: 0.303
Validation loss decreased (-0.269723 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.4269368648529053
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.271 Vali Acc: 0.447 Test Loss: 1.271 Test Acc: 0.447
Validation loss decreased (-0.302618 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.6691253185272217
Epoch: 4, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.197 Vali Acc: 0.533 Test Loss: 1.197 Test Acc: 0.533
Validation loss decreased (-0.447356 --> -0.532883).  Saving model ...
Epoch: 5 cost time: 1.821892499923706
Epoch: 5, Steps: 10 | Train Loss: 1.099 Vali Loss: 1.094 Vali Acc: 0.592 Test Loss: 1.094 Test Acc: 0.592
Validation loss decreased (-0.532883 --> -0.592094).  Saving model ...
Epoch: 6 cost time: 1.6983013153076172
Epoch: 6, Steps: 10 | Train Loss: 0.956 Vali Loss: 0.999 Vali Acc: 0.645 Test Loss: 0.999 Test Acc: 0.645
Validation loss decreased (-0.592094 --> -0.644727).  Saving model ...
Epoch: 7 cost time: 1.4614684581756592
Epoch: 7, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.874 Vali Acc: 0.697 Test Loss: 0.874 Test Acc: 0.697
Validation loss decreased (-0.644727 --> -0.697360).  Saving model ...
Epoch: 8 cost time: 2.149005889892578
Epoch: 8, Steps: 10 | Train Loss: 0.667 Vali Loss: 0.798 Vali Acc: 0.671 Test Loss: 0.798 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.842843770980835
Epoch: 9, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.690 Vali Acc: 0.743 Test Loss: 0.690 Test Acc: 0.743
Validation loss decreased (-0.697360 --> -0.743414).  Saving model ...
Epoch: 10 cost time: 1.9033048152923584
Epoch: 10, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.642 Vali Acc: 0.730 Test Loss: 0.642 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.815972089767456
Epoch: 11, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.601 Vali Acc: 0.770 Test Loss: 0.601 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.552546739578247
Epoch: 12, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.071010112762451
Epoch: 13, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.660 Vali Acc: 0.717 Test Loss: 0.660 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.745366096496582
Epoch: 14, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.533398151397705
Epoch: 15, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.526 Vali Acc: 0.757 Test Loss: 0.526 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6210544109344482
Epoch: 16, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.629 Vali Acc: 0.776 Test Loss: 0.629 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 17 cost time: 1.7770881652832031
Epoch: 17, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7526299953460693
Epoch: 18, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 1.664893627166748
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.638 Vali Acc: 0.816 Test Loss: 0.638 Test Acc: 0.816
Validation loss decreased (-0.782889 --> -0.815783).  Saving model ...
Epoch: 20 cost time: 1.7621169090270996
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.609 Vali Acc: 0.783 Test Loss: 0.609 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.842627763748169
Epoch: 21, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.588 Vali Acc: 0.796 Test Loss: 0.588 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7959976196289062
Epoch: 22, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7745416164398193
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.669 Vali Acc: 0.789 Test Loss: 0.669 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9826934337615967
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.699 Vali Acc: 0.789 Test Loss: 0.699 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7481601238250732
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.740 Vali Acc: 0.783 Test Loss: 0.740 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.0875022411346436
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.752 Vali Acc: 0.789 Test Loss: 0.752 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6215236186981201
Epoch: 27, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.758 Vali Acc: 0.796 Test Loss: 0.758 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.506502628326416
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.824 Vali Acc: 0.789 Test Loss: 0.824 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.0124711990356445
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.801 Vali Acc: 0.809 Test Loss: 0.801 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1510568
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4187912940979004
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.381 Vali Acc: 0.276 Test Loss: 1.381 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.317659616470337
Epoch: 2, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.323 Vali Acc: 0.362 Test Loss: 1.323 Test Acc: 0.362
Validation loss decreased (-0.276302 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.364976406097412
Epoch: 3, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.260 Vali Acc: 0.434 Test Loss: 1.260 Test Acc: 0.434
Validation loss decreased (-0.361829 --> -0.434198).  Saving model ...
Epoch: 4 cost time: 1.2255442142486572
Epoch: 4, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.181 Vali Acc: 0.586 Test Loss: 1.181 Test Acc: 0.586
Validation loss decreased (-0.434198 --> -0.585515).  Saving model ...
Epoch: 5 cost time: 1.5230774879455566
Epoch: 5, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.100 Vali Acc: 0.612 Test Loss: 1.100 Test Acc: 0.612
Validation loss decreased (-0.585515 --> -0.611831).  Saving model ...
Epoch: 6 cost time: 1.4352259635925293
Epoch: 6, Steps: 10 | Train Loss: 0.970 Vali Loss: 1.008 Vali Acc: 0.651 Test Loss: 1.008 Test Acc: 0.651
Validation loss decreased (-0.611831 --> -0.651306).  Saving model ...
Epoch: 7 cost time: 1.2233562469482422
Epoch: 7, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.955 Vali Acc: 0.645 Test Loss: 0.955 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.603806734085083
Epoch: 8, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.825 Vali Acc: 0.691 Test Loss: 0.825 Test Acc: 0.691
Validation loss decreased (-0.651306 --> -0.690781).  Saving model ...
Epoch: 9 cost time: 1.524630069732666
Epoch: 9, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.724 Vali Acc: 0.750 Test Loss: 0.724 Test Acc: 0.750
Validation loss decreased (-0.690781 --> -0.749993).  Saving model ...
Epoch: 10 cost time: 1.5615308284759521
Epoch: 10, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.638 Vali Acc: 0.724 Test Loss: 0.638 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5305097103118896
Epoch: 11, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.2084910869598389
Epoch: 12, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 13 cost time: 1.7437982559204102
Epoch: 13, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.510 Vali Acc: 0.763 Test Loss: 0.510 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.600046157836914
Epoch: 14, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.513 Vali Acc: 0.770 Test Loss: 0.513 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4496052265167236
Epoch: 15, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4207816123962402
Epoch: 16, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.558 Vali Acc: 0.757 Test Loss: 0.558 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.330078363418579
Epoch: 17, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.561 Vali Acc: 0.789 Test Loss: 0.561 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.362060308456421
Epoch: 18, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.657 Vali Acc: 0.770 Test Loss: 0.657 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5164549350738525
Epoch: 19, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.589 Vali Acc: 0.789 Test Loss: 0.589 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3755919933319092
Epoch: 20, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.657 Vali Acc: 0.816 Test Loss: 0.657 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815783).  Saving model ...
Epoch: 21 cost time: 1.4254567623138428
Epoch: 21, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.648 Vali Acc: 0.796 Test Loss: 0.648 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5155513286590576
Epoch: 22, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.695 Vali Acc: 0.796 Test Loss: 0.695 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4795482158660889
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.747 Vali Acc: 0.796 Test Loss: 0.747 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7222223281860352
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.760 Vali Acc: 0.789 Test Loss: 0.760 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7718911170959473
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.788 Vali Acc: 0.789 Test Loss: 0.788 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.468388557434082
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.806 Vali Acc: 0.803 Test Loss: 0.806 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5962157249450684
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.820 Vali Acc: 0.789 Test Loss: 0.820 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.604431390762329
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.840 Vali Acc: 0.796 Test Loss: 0.840 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7579245567321777
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.868 Vali Acc: 0.796 Test Loss: 0.868 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6669704914093018
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.877 Vali Acc: 0.803 Test Loss: 0.877 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1509928
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2654905319213867
Epoch: 1, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.369 Vali Acc: 0.283 Test Loss: 1.369 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.3892831802368164
Epoch: 2, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.324 Vali Acc: 0.434 Test Loss: 1.324 Test Acc: 0.434
Validation loss decreased (-0.282881 --> -0.434197).  Saving model ...
Epoch: 3 cost time: 1.139721393585205
Epoch: 3, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.254 Vali Acc: 0.408 Test Loss: 1.254 Test Acc: 0.408
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2190227508544922
Epoch: 4, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.162 Vali Acc: 0.579 Test Loss: 1.162 Test Acc: 0.579
Validation loss decreased (-0.434197 --> -0.578936).  Saving model ...
Epoch: 5 cost time: 1.3389325141906738
Epoch: 5, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.068 Vali Acc: 0.592 Test Loss: 1.068 Test Acc: 0.592
Validation loss decreased (-0.578936 --> -0.592095).  Saving model ...
Epoch: 6 cost time: 1.1845970153808594
Epoch: 6, Steps: 10 | Train Loss: 0.943 Vali Loss: 0.993 Vali Acc: 0.592 Test Loss: 0.993 Test Acc: 0.592
Validation loss decreased (-0.592095 --> -0.592095).  Saving model ...
Epoch: 7 cost time: 1.5849871635437012
Epoch: 7, Steps: 10 | Train Loss: 0.827 Vali Loss: 0.936 Vali Acc: 0.592 Test Loss: 0.936 Test Acc: 0.592
Validation loss decreased (-0.592095 --> -0.592096).  Saving model ...
Epoch: 8 cost time: 1.340226650238037
Epoch: 8, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.787 Vali Acc: 0.691 Test Loss: 0.787 Test Acc: 0.691
Validation loss decreased (-0.592096 --> -0.690782).  Saving model ...
Epoch: 9 cost time: 1.2571909427642822
Epoch: 9, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.721 Vali Acc: 0.691 Test Loss: 0.721 Test Acc: 0.691
Validation loss decreased (-0.690782 --> -0.690782).  Saving model ...
Epoch: 10 cost time: 1.7033772468566895
Epoch: 10, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.601 Vali Acc: 0.743 Test Loss: 0.601 Test Acc: 0.743
Validation loss decreased (-0.690782 --> -0.743415).  Saving model ...
Epoch: 11 cost time: 1.691728115081787
Epoch: 11, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.581 Vali Acc: 0.724 Test Loss: 0.581 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7067458629608154
Epoch: 12, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.524 Vali Acc: 0.770 Test Loss: 0.524 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769732).  Saving model ...
Epoch: 13 cost time: 1.2966241836547852
Epoch: 13, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.495 Vali Acc: 0.763 Test Loss: 0.495 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3992466926574707
Epoch: 14, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.499 Vali Acc: 0.770 Test Loss: 0.499 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 15 cost time: 1.2636518478393555
Epoch: 15, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4761888980865479
Epoch: 16, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.543 Vali Acc: 0.763 Test Loss: 0.543 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6148970127105713
Epoch: 17, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.596 Vali Acc: 0.789 Test Loss: 0.596 Test Acc: 0.789
Validation loss decreased (-0.769732 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.302793264389038
Epoch: 18, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.633 Vali Acc: 0.789 Test Loss: 0.633 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3553593158721924
Epoch: 19, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.652 Vali Acc: 0.776 Test Loss: 0.652 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.947831392288208
Epoch: 20, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.716 Vali Acc: 0.763 Test Loss: 0.716 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1673619747161865
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.995 Vali Acc: 0.783 Test Loss: 0.995 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.391434907913208
Epoch: 22, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.739 Vali Acc: 0.783 Test Loss: 0.739 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.378774881362915
Epoch: 23, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.740 Vali Acc: 0.796 Test Loss: 0.740 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796045).  Saving model ...
Epoch: 24 cost time: 1.458813190460205
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.813 Vali Acc: 0.776 Test Loss: 0.813 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4379024505615234
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.843 Vali Acc: 0.789 Test Loss: 0.843 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.4460914134979248
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.892 Vali Acc: 0.809 Test Loss: 0.892 Test Acc: 0.809
Validation loss decreased (-0.796045 --> -0.809202).  Saving model ...
Epoch: 27 cost time: 1.5925965309143066
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.871 Vali Acc: 0.776 Test Loss: 0.871 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6360065937042236
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.934 Vali Acc: 0.783 Test Loss: 0.934 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3676238059997559
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.916 Vali Acc: 0.770 Test Loss: 0.916 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2431097030639648
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.950 Vali Acc: 0.770 Test Loss: 0.950 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.59907865524292
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.990 Vali Acc: 0.776 Test Loss: 0.990 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3720760345458984
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.992 Vali Acc: 0.770 Test Loss: 0.992 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.271052598953247
Epoch: 33, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.000 Vali Acc: 0.770 Test Loss: 1.000 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.579193115234375
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.030 Vali Acc: 0.789 Test Loss: 1.030 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6057264804840088
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.052 Vali Acc: 0.789 Test Loss: 1.052 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3692498207092285
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.046 Vali Acc: 0.783 Test Loss: 1.046 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1509288
model size : 8.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.190215349197388
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.371 Vali Acc: 0.309 Test Loss: 1.371 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.7995362281799316
Epoch: 2, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.356 Vali Acc: 0.303 Test Loss: 1.356 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.733865737915039
Epoch: 3, Steps: 10 | Train Loss: 1.334 Vali Loss: 1.296 Vali Acc: 0.434 Test Loss: 1.296 Test Acc: 0.434
Validation loss decreased (-0.309197 --> -0.434198).  Saving model ...
Epoch: 4 cost time: 1.7269597053527832
Epoch: 4, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.227 Vali Acc: 0.592 Test Loss: 1.227 Test Acc: 0.592
Validation loss decreased (-0.434198 --> -0.592093).  Saving model ...
Epoch: 5 cost time: 1.8785984516143799
Epoch: 5, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.157 Vali Acc: 0.572 Test Loss: 1.157 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.689974069595337
Epoch: 6, Steps: 10 | Train Loss: 1.086 Vali Loss: 1.071 Vali Acc: 0.658 Test Loss: 1.071 Test Acc: 0.658
Validation loss decreased (-0.592093 --> -0.657884).  Saving model ...
Epoch: 7 cost time: 1.63517165184021
Epoch: 7, Steps: 10 | Train Loss: 0.910 Vali Loss: 0.952 Vali Acc: 0.658 Test Loss: 0.952 Test Acc: 0.658
Validation loss decreased (-0.657884 --> -0.657885).  Saving model ...
Epoch: 8 cost time: 1.4732470512390137
Epoch: 8, Steps: 10 | Train Loss: 0.799 Vali Loss: 0.881 Vali Acc: 0.638 Test Loss: 0.881 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.843473196029663
Epoch: 9, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.766 Vali Acc: 0.717 Test Loss: 0.766 Test Acc: 0.717
Validation loss decreased (-0.657885 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 1.7517518997192383
Epoch: 10, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.667 Vali Acc: 0.737 Test Loss: 0.667 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 1.3447682857513428
Epoch: 11, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.627 Vali Acc: 0.757 Test Loss: 0.627 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 1.7931938171386719
Epoch: 12, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.575 Vali Acc: 0.783 Test Loss: 0.575 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.3197836875915527
Epoch: 13, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6760458946228027
Epoch: 14, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6061780452728271
Epoch: 15, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 16 cost time: 1.4565722942352295
Epoch: 16, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.496 Vali Acc: 0.776 Test Loss: 0.496 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9253017902374268
Epoch: 17, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.475 Vali Acc: 0.783 Test Loss: 0.475 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.535651445388794
Epoch: 18, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.488 Vali Acc: 0.776 Test Loss: 0.488 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.601881980895996
Epoch: 19, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 20 cost time: 1.5607936382293701
Epoch: 20, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.473 Vali Acc: 0.796 Test Loss: 0.473 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4506919384002686
Epoch: 21, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.493 Vali Acc: 0.796 Test Loss: 0.493 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7723815441131592
Epoch: 22, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.504 Vali Acc: 0.809 Test Loss: 0.504 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4208850860595703
Epoch: 23, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0381340980529785
Epoch: 24, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.508 Vali Acc: 0.809 Test Loss: 0.508 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7702627182006836
Epoch: 25, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8371059894561768
Epoch: 26, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.576 Vali Acc: 0.789 Test Loss: 0.576 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.4969885349273682
Epoch: 27, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.528 Vali Acc: 0.789 Test Loss: 0.528 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4252266883850098
Epoch: 28, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.592 Vali Acc: 0.796 Test Loss: 0.592 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4716017246246338
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1006184
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2533888816833496
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.390 Vali Acc: 0.316 Test Loss: 1.390 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.6188499927520752
Epoch: 2, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.330 Vali Acc: 0.368 Test Loss: 1.330 Test Acc: 0.368
Validation loss decreased (-0.315776 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.5362873077392578
Epoch: 3, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.271 Vali Acc: 0.461 Test Loss: 1.271 Test Acc: 0.461
Validation loss decreased (-0.368408 --> -0.460514).  Saving model ...
Epoch: 4 cost time: 1.688180923461914
Epoch: 4, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.186 Vali Acc: 0.546 Test Loss: 1.186 Test Acc: 0.546
Validation loss decreased (-0.460514 --> -0.546041).  Saving model ...
Epoch: 5 cost time: 1.502577304840088
Epoch: 5, Steps: 10 | Train Loss: 1.077 Vali Loss: 1.093 Vali Acc: 0.572 Test Loss: 1.093 Test Acc: 0.572
Validation loss decreased (-0.546041 --> -0.572357).  Saving model ...
Epoch: 6 cost time: 1.4775774478912354
Epoch: 6, Steps: 10 | Train Loss: 0.946 Vali Loss: 0.991 Vali Acc: 0.638 Test Loss: 0.991 Test Acc: 0.638
Validation loss decreased (-0.572357 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 2.0183746814727783
Epoch: 7, Steps: 10 | Train Loss: 0.821 Vali Loss: 0.909 Vali Acc: 0.645 Test Loss: 0.909 Test Acc: 0.645
Validation loss decreased (-0.638148 --> -0.644728).  Saving model ...
Epoch: 8 cost time: 1.564178705215454
Epoch: 8, Steps: 10 | Train Loss: 0.683 Vali Loss: 0.787 Vali Acc: 0.717 Test Loss: 0.787 Test Acc: 0.717
Validation loss decreased (-0.644728 --> -0.717097).  Saving model ...
Epoch: 9 cost time: 1.6448185443878174
Epoch: 9, Steps: 10 | Train Loss: 0.578 Vali Loss: 0.722 Vali Acc: 0.691 Test Loss: 0.722 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7818944454193115
Epoch: 10, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.653 Vali Acc: 0.737 Test Loss: 0.653 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736836).  Saving model ...
Epoch: 11 cost time: 1.6671991348266602
Epoch: 11, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.584 Vali Acc: 0.743 Test Loss: 0.584 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.4951727390289307
Epoch: 12, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.5702540874481201
Epoch: 13, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.3930013179779053
Epoch: 14, Steps: 10 | Train Loss: 0.253 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.072171449661255
Epoch: 15, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.543 Vali Acc: 0.770 Test Loss: 0.543 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.571065902709961
Epoch: 16, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802627).  Saving model ...
Epoch: 17 cost time: 1.595426082611084
Epoch: 17, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6221809387207031
Epoch: 18, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.521 Vali Acc: 0.770 Test Loss: 0.521 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6967964172363281
Epoch: 19, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6071021556854248
Epoch: 20, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.512 Vali Acc: 0.816 Test Loss: 0.512 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815784).  Saving model ...
Epoch: 21 cost time: 2.1700260639190674
Epoch: 21, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5310719013214111
Epoch: 22, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.642885684967041
Epoch: 23, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.636 Vali Acc: 0.770 Test Loss: 0.636 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6602022647857666
Epoch: 24, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9354701042175293
Epoch: 25, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.534 Vali Acc: 0.816 Test Loss: 0.534 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8749427795410156
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.543 Vali Acc: 0.822 Test Loss: 0.543 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 27 cost time: 1.7332243919372559
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.062324285507202
Epoch: 28, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.563 Vali Acc: 0.809 Test Loss: 0.563 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.775202751159668
Epoch: 29, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.570 Vali Acc: 0.803 Test Loss: 0.570 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.179018259048462
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.581 Vali Acc: 0.822 Test Loss: 0.581 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.1665821075439453
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.603 Vali Acc: 0.809 Test Loss: 0.603 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.9592351913452148
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.626 Vali Acc: 0.803 Test Loss: 0.626 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6138267517089844
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.659 Vali Acc: 0.803 Test Loss: 0.659 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.8630828857421875
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.637 Vali Acc: 0.803 Test Loss: 0.637 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.0226521492004395
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.649 Vali Acc: 0.829 Test Loss: 0.649 Test Acc: 0.829
Validation loss decreased (-0.822363 --> -0.828941).  Saving model ...
Epoch: 36 cost time: 1.449786901473999
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.653 Vali Acc: 0.816 Test Loss: 0.653 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6322340965270996
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.664 Vali Acc: 0.822 Test Loss: 0.664 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.6604290008544922
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.671 Vali Acc: 0.822 Test Loss: 0.671 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.9561643600463867
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.684 Vali Acc: 0.822 Test Loss: 0.684 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.9725067615509033
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.702 Vali Acc: 0.816 Test Loss: 0.702 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.8791022300720215
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.716 Vali Acc: 0.822 Test Loss: 0.716 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.838435173034668
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.726 Vali Acc: 0.809 Test Loss: 0.726 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.8793301582336426
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.735 Vali Acc: 0.816 Test Loss: 0.735 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.7730162143707275
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.741 Vali Acc: 0.809 Test Loss: 0.741 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 2.082315444946289
Epoch: 45, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.761 Vali Acc: 0.809 Test Loss: 0.761 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1005864
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.1020896434783936
Epoch: 1, Steps: 10 | Train Loss: 1.424 Vali Loss: 1.361 Vali Acc: 0.303 Test Loss: 1.361 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.6999826431274414
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.321 Vali Acc: 0.395 Test Loss: 1.321 Test Acc: 0.395
Validation loss decreased (-0.302618 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 1.7117316722869873
Epoch: 3, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.269 Vali Acc: 0.441 Test Loss: 1.269 Test Acc: 0.441
Validation loss decreased (-0.394724 --> -0.440777).  Saving model ...
Epoch: 4 cost time: 1.6029291152954102
Epoch: 4, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.184 Vali Acc: 0.618 Test Loss: 1.184 Test Acc: 0.618
Validation loss decreased (-0.440777 --> -0.618409).  Saving model ...
Epoch: 5 cost time: 1.5671443939208984
Epoch: 5, Steps: 10 | Train Loss: 1.122 Vali Loss: 1.101 Vali Acc: 0.638 Test Loss: 1.101 Test Acc: 0.638
Validation loss decreased (-0.618409 --> -0.638147).  Saving model ...
Epoch: 6 cost time: 1.2668259143829346
Epoch: 6, Steps: 10 | Train Loss: 0.991 Vali Loss: 0.986 Vali Acc: 0.612 Test Loss: 0.986 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3121821880340576
Epoch: 7, Steps: 10 | Train Loss: 0.876 Vali Loss: 0.884 Vali Acc: 0.711 Test Loss: 0.884 Test Acc: 0.711
Validation loss decreased (-0.638147 --> -0.710517).  Saving model ...
Epoch: 8 cost time: 2.2326853275299072
Epoch: 8, Steps: 10 | Train Loss: 0.717 Vali Loss: 0.787 Vali Acc: 0.704 Test Loss: 0.787 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.429257869720459
Epoch: 9, Steps: 10 | Train Loss: 0.610 Vali Loss: 0.720 Vali Acc: 0.737 Test Loss: 0.720 Test Acc: 0.737
Validation loss decreased (-0.710517 --> -0.736835).  Saving model ...
Epoch: 10 cost time: 1.3713123798370361
Epoch: 10, Steps: 10 | Train Loss: 0.509 Vali Loss: 0.640 Vali Acc: 0.743 Test Loss: 0.640 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 11 cost time: 1.5267586708068848
Epoch: 11, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 1.5209252834320068
Epoch: 12, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.691091537475586
Epoch: 13, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.541 Vali Acc: 0.796 Test Loss: 0.541 Test Acc: 0.796
Validation loss decreased (-0.756573 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.4997262954711914
Epoch: 14, Steps: 10 | Train Loss: 0.270 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3706989288330078
Epoch: 15, Steps: 10 | Train Loss: 0.226 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7483654022216797
Epoch: 16, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.482 Vali Acc: 0.776 Test Loss: 0.482 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2526326179504395
Epoch: 17, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.479 Vali Acc: 0.783 Test Loss: 0.479 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5313162803649902
Epoch: 18, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.480 Vali Acc: 0.789 Test Loss: 0.480 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2483875751495361
Epoch: 19, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.500 Vali Acc: 0.803 Test Loss: 0.500 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802627).  Saving model ...
Epoch: 20 cost time: 1.4127628803253174
Epoch: 20, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.472 Vali Acc: 0.776 Test Loss: 0.472 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6215691566467285
Epoch: 21, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.470 Vali Acc: 0.776 Test Loss: 0.470 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5051157474517822
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.310276985168457
Epoch: 23, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 24 cost time: 1.222217082977295
Epoch: 24, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.503 Vali Acc: 0.789 Test Loss: 0.503 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4838225841522217
Epoch: 25, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.524 Vali Acc: 0.809 Test Loss: 0.524 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3459062576293945
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.517 Vali Acc: 0.783 Test Loss: 0.517 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.314063310623169
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.546 Vali Acc: 0.809 Test Loss: 0.546 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.532219409942627
Epoch: 28, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.537 Vali Acc: 0.783 Test Loss: 0.537 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.558631181716919
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.559 Vali Acc: 0.816 Test Loss: 0.559 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815784).  Saving model ...
Epoch: 30 cost time: 1.4020543098449707
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3680663108825684
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3719477653503418
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.589 Vali Acc: 0.809 Test Loss: 0.589 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1860418319702148
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.588 Vali Acc: 0.803 Test Loss: 0.588 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.3192033767700195
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.630 Vali Acc: 0.816 Test Loss: 0.630 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.3337180614471436
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.613 Vali Acc: 0.816 Test Loss: 0.613 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.3151814937591553
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.622 Vali Acc: 0.816 Test Loss: 0.622 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.7007055282592773
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.637 Vali Acc: 0.803 Test Loss: 0.637 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.7028944492340088
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.659 Vali Acc: 0.809 Test Loss: 0.659 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.6516733169555664
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.651 Vali Acc: 0.796 Test Loss: 0.651 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1005544
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.381470203399658
Epoch: 1, Steps: 10 | Train Loss: 1.447 Vali Loss: 1.396 Vali Acc: 0.250 Test Loss: 1.396 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.397665023803711
Epoch: 2, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.368 Vali Acc: 0.322 Test Loss: 1.368 Test Acc: 0.322
Validation loss decreased (-0.249986 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.5549120903015137
Epoch: 3, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.333 Vali Acc: 0.309 Test Loss: 1.333 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4706916809082031
Epoch: 4, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.258 Vali Acc: 0.421 Test Loss: 1.258 Test Acc: 0.421
Validation loss decreased (-0.322355 --> -0.421040).  Saving model ...
Epoch: 5 cost time: 1.59041166305542
Epoch: 5, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.156 Vali Acc: 0.539 Test Loss: 1.156 Test Acc: 0.539
Validation loss decreased (-0.421040 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 1.2721381187438965
Epoch: 6, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.057 Vali Acc: 0.632 Test Loss: 1.057 Test Acc: 0.632
Validation loss decreased (-0.539462 --> -0.631568).  Saving model ...
Epoch: 7 cost time: 1.5896756649017334
Epoch: 7, Steps: 10 | Train Loss: 0.869 Vali Loss: 0.956 Vali Acc: 0.664 Test Loss: 0.956 Test Acc: 0.664
Validation loss decreased (-0.631568 --> -0.664464).  Saving model ...
Epoch: 8 cost time: 1.2950680255889893
Epoch: 8, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.867 Vali Acc: 0.638 Test Loss: 0.867 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6657946109771729
Epoch: 9, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.831 Vali Acc: 0.664 Test Loss: 0.831 Test Acc: 0.664
Validation loss decreased (-0.664464 --> -0.664465).  Saving model ...
Epoch: 10 cost time: 1.8159191608428955
Epoch: 10, Steps: 10 | Train Loss: 0.519 Vali Loss: 0.760 Vali Acc: 0.671 Test Loss: 0.760 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671045).  Saving model ...
Epoch: 11 cost time: 1.4621691703796387
Epoch: 11, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.676 Vali Acc: 0.737 Test Loss: 0.676 Test Acc: 0.737
Validation loss decreased (-0.671045 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 1.6379728317260742
Epoch: 12, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.610 Vali Acc: 0.757 Test Loss: 0.610 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.4617786407470703
Epoch: 13, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.272843599319458
Epoch: 14, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.620 Vali Acc: 0.757 Test Loss: 0.620 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3656835556030273
Epoch: 15, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.583 Vali Acc: 0.763 Test Loss: 0.583 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.2240169048309326
Epoch: 16, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.556 Vali Acc: 0.763 Test Loss: 0.556 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 1.5729880332946777
Epoch: 17, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 1.5790326595306396
Epoch: 18, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.526 Vali Acc: 0.796 Test Loss: 0.526 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 1.5295679569244385
Epoch: 19, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.544 Vali Acc: 0.770 Test Loss: 0.544 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4129047393798828
Epoch: 20, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.534 Vali Acc: 0.763 Test Loss: 0.534 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4696276187896729
Epoch: 21, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.648 Vali Acc: 0.770 Test Loss: 0.648 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3990390300750732
Epoch: 22, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.556 Vali Acc: 0.763 Test Loss: 0.556 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.350905418395996
Epoch: 23, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.569 Vali Acc: 0.770 Test Loss: 0.569 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3686401844024658
Epoch: 24, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.604 Vali Acc: 0.757 Test Loss: 0.604 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.64115309715271
Epoch: 25, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.609 Vali Acc: 0.770 Test Loss: 0.609 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.485837697982788
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.609 Vali Acc: 0.770 Test Loss: 0.609 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.65065336227417
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.619 Vali Acc: 0.789 Test Loss: 0.619 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.709214210510254
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.638 Vali Acc: 0.770 Test Loss: 0.638 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 1005224
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.3246026039123535
Epoch: 1, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.418 Vali Acc: 0.336 Test Loss: 1.418 Test Acc: 0.336
Validation loss decreased (inf --> -0.335512).  Saving model ...
Epoch: 2 cost time: 1.6392607688903809
Epoch: 2, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.399 Vali Acc: 0.171 Test Loss: 1.399 Test Acc: 0.171
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.790553331375122
Epoch: 3, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.356 Vali Acc: 0.309 Test Loss: 1.356 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6815598011016846
Epoch: 4, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.285 Vali Acc: 0.414 Test Loss: 1.285 Test Acc: 0.414
Validation loss decreased (-0.335512 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 1.6190483570098877
Epoch: 5, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.241 Vali Acc: 0.493 Test Loss: 1.241 Test Acc: 0.493
Validation loss decreased (-0.414461 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 1.5046846866607666
Epoch: 6, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.160 Vali Acc: 0.493 Test Loss: 1.160 Test Acc: 0.493
Validation loss decreased (-0.493409 --> -0.493409).  Saving model ...
Epoch: 7 cost time: 1.9476377964019775
Epoch: 7, Steps: 10 | Train Loss: 0.951 Vali Loss: 1.095 Vali Acc: 0.513 Test Loss: 1.095 Test Acc: 0.513
Validation loss decreased (-0.493409 --> -0.513147).  Saving model ...
Epoch: 8 cost time: 1.6945159435272217
Epoch: 8, Steps: 10 | Train Loss: 0.871 Vali Loss: 1.007 Vali Acc: 0.612 Test Loss: 1.007 Test Acc: 0.612
Validation loss decreased (-0.513147 --> -0.611832).  Saving model ...
Epoch: 9 cost time: 1.5884816646575928
Epoch: 9, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.920 Vali Acc: 0.618 Test Loss: 0.920 Test Acc: 0.618
Validation loss decreased (-0.611832 --> -0.618412).  Saving model ...
Epoch: 10 cost time: 1.55092191696167
Epoch: 10, Steps: 10 | Train Loss: 0.670 Vali Loss: 0.838 Vali Acc: 0.671 Test Loss: 0.838 Test Acc: 0.671
Validation loss decreased (-0.618412 --> -0.671044).  Saving model ...
Epoch: 11 cost time: 1.7644548416137695
Epoch: 11, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.765 Vali Acc: 0.691 Test Loss: 0.765 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690782).  Saving model ...
Epoch: 12 cost time: 1.3811390399932861
Epoch: 12, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.683 Vali Acc: 0.743 Test Loss: 0.683 Test Acc: 0.743
Validation loss decreased (-0.690782 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 1.4387836456298828
Epoch: 13, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.635 Vali Acc: 0.757 Test Loss: 0.635 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.7510249614715576
Epoch: 14, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.624 Vali Acc: 0.743 Test Loss: 0.624 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6795425415039062
Epoch: 15, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.578 Vali Acc: 0.763 Test Loss: 0.578 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 2.043076992034912
Epoch: 16, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.558 Vali Acc: 0.757 Test Loss: 0.558 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.562267780303955
Epoch: 17, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.558 Vali Acc: 0.763 Test Loss: 0.558 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 18 cost time: 1.9861838817596436
Epoch: 18, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.556 Vali Acc: 0.743 Test Loss: 0.556 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7822833061218262
Epoch: 19, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.546 Vali Acc: 0.770 Test Loss: 0.546 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 20 cost time: 1.362034559249878
Epoch: 20, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 21 cost time: 1.8628342151641846
Epoch: 21, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0093085765838623
Epoch: 22, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.541 Vali Acc: 0.763 Test Loss: 0.541 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8896501064300537
Epoch: 23, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.562 Vali Acc: 0.776 Test Loss: 0.562 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.540724754333496
Epoch: 24, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.563 Vali Acc: 0.757 Test Loss: 0.563 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6504998207092285
Epoch: 25, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9218111038208008
Epoch: 26, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789467).  Saving model ...
Epoch: 27 cost time: 1.5326876640319824
Epoch: 27, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.617 Vali Acc: 0.750 Test Loss: 0.617 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.663855791091919
Epoch: 28, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.618 Vali Acc: 0.763 Test Loss: 0.618 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.7936699390411377
Epoch: 29, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.654 Vali Acc: 0.796 Test Loss: 0.654 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 30 cost time: 1.5634796619415283
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.622 Vali Acc: 0.763 Test Loss: 0.622 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4207634925842285
Epoch: 31, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.6837964057922363
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.673 Vali Acc: 0.803 Test Loss: 0.673 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802625).  Saving model ...
Epoch: 33 cost time: 1.647705078125
Epoch: 33, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.662 Vali Acc: 0.809 Test Loss: 0.662 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809204).  Saving model ...
Epoch: 34 cost time: 1.6665847301483154
Epoch: 34, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.650 Vali Acc: 0.789 Test Loss: 0.650 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.6705985069274902
Epoch: 35, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.672 Vali Acc: 0.789 Test Loss: 0.672 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6223320960998535
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.686 Vali Acc: 0.770 Test Loss: 0.686 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.839689016342163
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.708 Vali Acc: 0.796 Test Loss: 0.708 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.0536880493164062
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.729 Vali Acc: 0.770 Test Loss: 0.729 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.700606346130371
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.731 Vali Acc: 0.803 Test Loss: 0.731 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.828261137008667
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.730 Vali Acc: 0.803 Test Loss: 0.730 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.040862560272217
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.736 Vali Acc: 0.796 Test Loss: 0.736 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.7320351600646973
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.745 Vali Acc: 0.796 Test Loss: 0.745 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.9225513935089111
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.750 Vali Acc: 0.803 Test Loss: 0.750 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 675944
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4191925525665283
Epoch: 1, Steps: 10 | Train Loss: 1.514 Vali Loss: 1.391 Vali Acc: 0.250 Test Loss: 1.391 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.7228491306304932
Epoch: 2, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.327 Vali Acc: 0.421 Test Loss: 1.327 Test Acc: 0.421
Validation loss decreased (-0.249986 --> -0.421039).  Saving model ...
Epoch: 3 cost time: 1.4469375610351562
Epoch: 3, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.297 Vali Acc: 0.395 Test Loss: 1.297 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.46490478515625
Epoch: 4, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.256 Vali Acc: 0.513 Test Loss: 1.256 Test Acc: 0.513
Validation loss decreased (-0.421039 --> -0.513145).  Saving model ...
Epoch: 5 cost time: 1.3800287246704102
Epoch: 5, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.194 Vali Acc: 0.546 Test Loss: 1.194 Test Acc: 0.546
Validation loss decreased (-0.513145 --> -0.546041).  Saving model ...
Epoch: 6 cost time: 1.3713040351867676
Epoch: 6, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.124 Vali Acc: 0.566 Test Loss: 1.124 Test Acc: 0.566
Validation loss decreased (-0.546041 --> -0.565778).  Saving model ...
Epoch: 7 cost time: 1.4956092834472656
Epoch: 7, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.077 Vali Acc: 0.572 Test Loss: 1.077 Test Acc: 0.572
Validation loss decreased (-0.565778 --> -0.572358).  Saving model ...
Epoch: 8 cost time: 1.5098085403442383
Epoch: 8, Steps: 10 | Train Loss: 0.884 Vali Loss: 0.950 Vali Acc: 0.586 Test Loss: 0.950 Test Acc: 0.586
Validation loss decreased (-0.572358 --> -0.585517).  Saving model ...
Epoch: 9 cost time: 1.6442182064056396
Epoch: 9, Steps: 10 | Train Loss: 0.841 Vali Loss: 0.886 Vali Acc: 0.632 Test Loss: 0.886 Test Acc: 0.632
Validation loss decreased (-0.585517 --> -0.631570).  Saving model ...
Epoch: 10 cost time: 1.5143704414367676
Epoch: 10, Steps: 10 | Train Loss: 0.691 Vali Loss: 0.797 Vali Acc: 0.664 Test Loss: 0.797 Test Acc: 0.664
Validation loss decreased (-0.631570 --> -0.664466).  Saving model ...
Epoch: 11 cost time: 1.6120104789733887
Epoch: 11, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.732 Vali Acc: 0.697 Test Loss: 0.732 Test Acc: 0.697
Validation loss decreased (-0.664466 --> -0.697361).  Saving model ...
Epoch: 12 cost time: 1.3771414756774902
Epoch: 12, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.660 Vali Acc: 0.757 Test Loss: 0.660 Test Acc: 0.757
Validation loss decreased (-0.697361 --> -0.756572).  Saving model ...
Epoch: 13 cost time: 1.6942970752716064
Epoch: 13, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.624 Vali Acc: 0.763 Test Loss: 0.624 Test Acc: 0.763
Validation loss decreased (-0.756572 --> -0.763152).  Saving model ...
Epoch: 14 cost time: 1.608011245727539
Epoch: 14, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.582 Vali Acc: 0.763 Test Loss: 0.582 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 15 cost time: 1.7634148597717285
Epoch: 15, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.2870593070983887
Epoch: 16, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.528 Vali Acc: 0.783 Test Loss: 0.528 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 17 cost time: 1.895777940750122
Epoch: 17, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.558 Vali Acc: 0.770 Test Loss: 0.558 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.981125831604004
Epoch: 18, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4579591751098633
Epoch: 19, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.533 Vali Acc: 0.757 Test Loss: 0.533 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7746787071228027
Epoch: 20, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 21 cost time: 1.8576200008392334
Epoch: 21, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 1.61751389503479
Epoch: 22, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.579 Vali Acc: 0.783 Test Loss: 0.579 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.721125841140747
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.564589262008667
Epoch: 24, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.589 Vali Acc: 0.776 Test Loss: 0.589 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7359161376953125
Epoch: 25, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.552 Vali Acc: 0.796 Test Loss: 0.552 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6526470184326172
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3397417068481445
Epoch: 27, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.599 Vali Acc: 0.783 Test Loss: 0.599 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3037669658660889
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5890393257141113
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.637 Vali Acc: 0.776 Test Loss: 0.637 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4678547382354736
Epoch: 30, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.647 Vali Acc: 0.783 Test Loss: 0.647 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3989007472991943
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.681 Vali Acc: 0.783 Test Loss: 0.681 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 675624
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.221041917800903
Epoch: 1, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.390 Vali Acc: 0.296 Test Loss: 1.390 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.391378402709961
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.378 Vali Acc: 0.342 Test Loss: 1.378 Test Acc: 0.342
Validation loss decreased (-0.296039 --> -0.342091).  Saving model ...
Epoch: 3 cost time: 1.3174691200256348
Epoch: 3, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.312 Vali Acc: 0.388 Test Loss: 1.312 Test Acc: 0.388
Validation loss decreased (-0.342091 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 1.6319622993469238
Epoch: 4, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.271 Vali Acc: 0.454 Test Loss: 1.271 Test Acc: 0.454
Validation loss decreased (-0.388145 --> -0.453935).  Saving model ...
Epoch: 5 cost time: 1.138331651687622
Epoch: 5, Steps: 10 | Train Loss: 1.183 Vali Loss: 1.231 Vali Acc: 0.467 Test Loss: 1.231 Test Acc: 0.467
Validation loss decreased (-0.453935 --> -0.467093).  Saving model ...
Epoch: 6 cost time: 1.4695329666137695
Epoch: 6, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.158 Vali Acc: 0.566 Test Loss: 1.158 Test Acc: 0.566
Validation loss decreased (-0.467093 --> -0.565778).  Saving model ...
Epoch: 7 cost time: 1.4420669078826904
Epoch: 7, Steps: 10 | Train Loss: 1.031 Vali Loss: 1.077 Vali Acc: 0.559 Test Loss: 1.077 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4309072494506836
Epoch: 8, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.004 Vali Acc: 0.625 Test Loss: 1.004 Test Acc: 0.625
Validation loss decreased (-0.565778 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 1.3487374782562256
Epoch: 9, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.887 Vali Acc: 0.678 Test Loss: 0.887 Test Acc: 0.678
Validation loss decreased (-0.624990 --> -0.677623).  Saving model ...
Epoch: 10 cost time: 1.3077068328857422
Epoch: 10, Steps: 10 | Train Loss: 0.643 Vali Loss: 0.799 Vali Acc: 0.684 Test Loss: 0.799 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684203).  Saving model ...
Epoch: 11 cost time: 1.3133413791656494
Epoch: 11, Steps: 10 | Train Loss: 0.582 Vali Loss: 0.753 Vali Acc: 0.711 Test Loss: 0.753 Test Acc: 0.711
Validation loss decreased (-0.684203 --> -0.710519).  Saving model ...
Epoch: 12 cost time: 1.310248613357544
Epoch: 12, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.656 Vali Acc: 0.730 Test Loss: 0.656 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730257).  Saving model ...
Epoch: 13 cost time: 1.3067495822906494
Epoch: 13, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.614 Vali Acc: 0.750 Test Loss: 0.614 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.3132238388061523
Epoch: 14, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.573 Vali Acc: 0.750 Test Loss: 0.573 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 15 cost time: 1.6466870307922363
Epoch: 15, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.543 Vali Acc: 0.770 Test Loss: 0.543 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 1.4950556755065918
Epoch: 16, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.527 Vali Acc: 0.750 Test Loss: 0.527 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3818941116333008
Epoch: 17, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.515 Vali Acc: 0.763 Test Loss: 0.515 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.539069414138794
Epoch: 18, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 19 cost time: 1.4149205684661865
Epoch: 19, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.576 Vali Acc: 0.783 Test Loss: 0.576 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 20 cost time: 1.4849803447723389
Epoch: 20, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.536 Vali Acc: 0.763 Test Loss: 0.536 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4769208431243896
Epoch: 21, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.563 Vali Acc: 0.776 Test Loss: 0.563 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.301377773284912
Epoch: 22, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3762292861938477
Epoch: 23, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5629832744598389
Epoch: 24, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3364982604980469
Epoch: 25, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.548 Vali Acc: 0.783 Test Loss: 0.548 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 1.1243150234222412
Epoch: 26, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.532 Vali Acc: 0.770 Test Loss: 0.532 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2040743827819824
Epoch: 27, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.287844181060791
Epoch: 28, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.590 Vali Acc: 0.789 Test Loss: 0.590 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 1.4079301357269287
Epoch: 29, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6775057315826416
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.600 Vali Acc: 0.783 Test Loss: 0.600 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3832066059112549
Epoch: 31, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.601 Vali Acc: 0.776 Test Loss: 0.601 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.4255244731903076
Epoch: 32, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 33 cost time: 1.2271440029144287
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.627 Vali Acc: 0.763 Test Loss: 0.627 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2952466011047363
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.655 Vali Acc: 0.796 Test Loss: 0.655 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.3125011920928955
Epoch: 35, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.653 Vali Acc: 0.763 Test Loss: 0.653 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2376174926757812
Epoch: 36, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.674 Vali Acc: 0.796 Test Loss: 0.674 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4872467517852783
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.673 Vali Acc: 0.770 Test Loss: 0.673 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2513420581817627
Epoch: 38, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.702 Vali Acc: 0.796 Test Loss: 0.702 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.2240757942199707
Epoch: 39, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.711 Vali Acc: 0.783 Test Loss: 0.711 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6823792457580566
Epoch: 40, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.714 Vali Acc: 0.789 Test Loss: 0.714 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.353736400604248
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.724 Vali Acc: 0.776 Test Loss: 0.724 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.4477779865264893
Epoch: 42, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.723 Vali Acc: 0.770 Test Loss: 0.723 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 675304
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.644155740737915
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.417 Vali Acc: 0.270 Test Loss: 1.417 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.2507143020629883
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.371 Vali Acc: 0.263 Test Loss: 1.371 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4501128196716309
Epoch: 3, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.331 Vali Acc: 0.309 Test Loss: 1.331 Test Acc: 0.309
Validation loss decreased (-0.269723 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 1.296226978302002
Epoch: 4, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.300 Vali Acc: 0.342 Test Loss: 1.300 Test Acc: 0.342
Validation loss decreased (-0.309197 --> -0.342092).  Saving model ...
Epoch: 5 cost time: 1.368699312210083
Epoch: 5, Steps: 10 | Train Loss: 1.199 Vali Loss: 1.207 Vali Acc: 0.513 Test Loss: 1.207 Test Acc: 0.513
Validation loss decreased (-0.342092 --> -0.513146).  Saving model ...
Epoch: 6 cost time: 1.3848907947540283
Epoch: 6, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.142 Vali Acc: 0.579 Test Loss: 1.142 Test Acc: 0.579
Validation loss decreased (-0.513146 --> -0.578936).  Saving model ...
Epoch: 7 cost time: 1.2329862117767334
Epoch: 7, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.074 Vali Acc: 0.553 Test Loss: 1.074 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7252967357635498
Epoch: 8, Steps: 10 | Train Loss: 0.883 Vali Loss: 0.969 Vali Acc: 0.625 Test Loss: 0.969 Test Acc: 0.625
Validation loss decreased (-0.578936 --> -0.624990).  Saving model ...
Epoch: 9 cost time: 1.8435213565826416
Epoch: 9, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.880 Vali Acc: 0.684 Test Loss: 0.880 Test Acc: 0.684
Validation loss decreased (-0.624990 --> -0.684202).  Saving model ...
Epoch: 10 cost time: 1.6106772422790527
Epoch: 10, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.805 Vali Acc: 0.704 Test Loss: 0.805 Test Acc: 0.704
Validation loss decreased (-0.684202 --> -0.703939).  Saving model ...
Epoch: 11 cost time: 1.493565320968628
Epoch: 11, Steps: 10 | Train Loss: 0.570 Vali Loss: 0.727 Vali Acc: 0.704 Test Loss: 0.727 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703940).  Saving model ...
Epoch: 12 cost time: 1.4612679481506348
Epoch: 12, Steps: 10 | Train Loss: 0.497 Vali Loss: 0.717 Vali Acc: 0.730 Test Loss: 0.717 Test Acc: 0.730
Validation loss decreased (-0.703940 --> -0.730256).  Saving model ...
Epoch: 13 cost time: 1.654381513595581
Epoch: 13, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.621 Vali Acc: 0.724 Test Loss: 0.621 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1720170974731445
Epoch: 14, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.590 Vali Acc: 0.776 Test Loss: 0.590 Test Acc: 0.776
Validation loss decreased (-0.730256 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.2844130992889404
Epoch: 15, Steps: 10 | Train Loss: 0.297 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 1.729137659072876
Epoch: 16, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782890).  Saving model ...
Epoch: 17 cost time: 1.4442226886749268
Epoch: 17, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.5241050720214844
Epoch: 18, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2705566883087158
Epoch: 19, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.544 Vali Acc: 0.776 Test Loss: 0.544 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2431244850158691
Epoch: 20, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.515 Vali Acc: 0.796 Test Loss: 0.515 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 1.3179197311401367
Epoch: 21, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.512 Vali Acc: 0.783 Test Loss: 0.512 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2042784690856934
Epoch: 22, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1861298084259033
Epoch: 23, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.511 Vali Acc: 0.803 Test Loss: 0.511 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 24 cost time: 1.1868305206298828
Epoch: 24, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.377622127532959
Epoch: 25, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.534 Vali Acc: 0.796 Test Loss: 0.534 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.5083181858062744
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.542 Vali Acc: 0.796 Test Loss: 0.542 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.494157075881958
Epoch: 27, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.565 Vali Acc: 0.796 Test Loss: 0.565 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.4821269512176514
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.578 Vali Acc: 0.783 Test Loss: 0.578 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3836414813995361
Epoch: 29, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.595 Vali Acc: 0.796 Test Loss: 0.595 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6396825313568115
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809204).  Saving model ...
Epoch: 31 cost time: 1.5525331497192383
Epoch: 31, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.667 Vali Acc: 0.809 Test Loss: 0.667 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5704622268676758
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.651 Vali Acc: 0.803 Test Loss: 0.651 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4510650634765625
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.688 Vali Acc: 0.803 Test Loss: 0.688 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3300018310546875
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.695 Vali Acc: 0.809 Test Loss: 0.695 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6847460269927979
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.715 Vali Acc: 0.796 Test Loss: 0.715 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2251884937286377
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.332716703414917
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.741 Vali Acc: 0.803 Test Loss: 0.741 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.208923101425171
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.759 Vali Acc: 0.809 Test Loss: 0.759 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.4394989013671875
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.779 Vali Acc: 0.803 Test Loss: 0.779 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.5672473907470703
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.796 Vali Acc: 0.809 Test Loss: 0.796 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 674984
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7538630962371826
Epoch: 1, Steps: 10 | Train Loss: 1.525 Vali Loss: 1.426 Vali Acc: 0.276 Test Loss: 1.426 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.344792366027832
Epoch: 2, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5334994792938232
Epoch: 3, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.348 Vali Acc: 0.342 Test Loss: 1.348 Test Acc: 0.342
Validation loss decreased (-0.276302 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.424630880355835
Epoch: 4, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.286 Vali Acc: 0.395 Test Loss: 1.286 Test Acc: 0.395
Validation loss decreased (-0.342092 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 1.5599071979522705
Epoch: 5, Steps: 10 | Train Loss: 1.213 Vali Loss: 1.240 Vali Acc: 0.493 Test Loss: 1.240 Test Acc: 0.493
Validation loss decreased (-0.394724 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 1.168734073638916
Epoch: 6, Steps: 10 | Train Loss: 1.138 Vali Loss: 1.164 Vali Acc: 0.559 Test Loss: 1.164 Test Acc: 0.559
Validation loss decreased (-0.493409 --> -0.559199).  Saving model ...
Epoch: 7 cost time: 1.481767177581787
Epoch: 7, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.111 Vali Acc: 0.480 Test Loss: 1.111 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6123359203338623
Epoch: 8, Steps: 10 | Train Loss: 0.946 Vali Loss: 1.024 Vali Acc: 0.612 Test Loss: 1.024 Test Acc: 0.612
Validation loss decreased (-0.559199 --> -0.611832).  Saving model ...
Epoch: 9 cost time: 1.1698968410491943
Epoch: 9, Steps: 10 | Train Loss: 0.822 Vali Loss: 0.924 Vali Acc: 0.651 Test Loss: 0.924 Test Acc: 0.651
Validation loss decreased (-0.611832 --> -0.651307).  Saving model ...
Epoch: 10 cost time: 1.3166074752807617
Epoch: 10, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.853 Vali Acc: 0.671 Test Loss: 0.853 Test Acc: 0.671
Validation loss decreased (-0.651307 --> -0.671044).  Saving model ...
Epoch: 11 cost time: 1.3919241428375244
Epoch: 11, Steps: 10 | Train Loss: 0.692 Vali Loss: 0.776 Vali Acc: 0.724 Test Loss: 0.776 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723676).  Saving model ...
Epoch: 12 cost time: 1.4183902740478516
Epoch: 12, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.710 Vali Acc: 0.697 Test Loss: 0.710 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5344843864440918
Epoch: 13, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.645 Vali Acc: 0.737 Test Loss: 0.645 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736836).  Saving model ...
Epoch: 14 cost time: 1.290670394897461
Epoch: 14, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.595 Vali Acc: 0.776 Test Loss: 0.595 Test Acc: 0.776
Validation loss decreased (-0.736836 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.322110891342163
Epoch: 15, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.583 Vali Acc: 0.757 Test Loss: 0.583 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5503051280975342
Epoch: 16, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.3048789501190186
Epoch: 17, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.538 Vali Acc: 0.757 Test Loss: 0.538 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3390326499938965
Epoch: 18, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.522 Vali Acc: 0.776 Test Loss: 0.522 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 19 cost time: 1.2889795303344727
Epoch: 19, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.515 Vali Acc: 0.750 Test Loss: 0.515 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.325369119644165
Epoch: 20, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 21 cost time: 1.3553197383880615
Epoch: 21, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.492 Vali Acc: 0.750 Test Loss: 0.492 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.316253662109375
Epoch: 22, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.498 Vali Acc: 0.763 Test Loss: 0.498 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9685518741607666
Epoch: 23, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.500 Vali Acc: 0.757 Test Loss: 0.500 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2431323528289795
Epoch: 24, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4328944683074951
Epoch: 25, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3063099384307861
Epoch: 26, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.512 Vali Acc: 0.763 Test Loss: 0.512 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5362820625305176
Epoch: 27, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.525 Vali Acc: 0.763 Test Loss: 0.525 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5466504096984863
Epoch: 28, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.579 Vali Acc: 0.796 Test Loss: 0.579 Test Acc: 0.796
Validation loss decreased (-0.782890 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 1.3419697284698486
Epoch: 29, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.510 Vali Acc: 0.770 Test Loss: 0.510 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2720096111297607
Epoch: 30, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.550 Vali Acc: 0.783 Test Loss: 0.550 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.527052879333496
Epoch: 31, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5236001014709473
Epoch: 32, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4046168327331543
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.604 Vali Acc: 0.789 Test Loss: 0.604 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1708321571350098
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.612 Vali Acc: 0.783 Test Loss: 0.612 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.260406494140625
Epoch: 35, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.648 Vali Acc: 0.796 Test Loss: 0.648 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.559067964553833
Epoch: 36, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.680 Vali Acc: 0.763 Test Loss: 0.680 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.2599480152130127
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.711 Vali Acc: 0.803 Test Loss: 0.711 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802624).  Saving model ...
Epoch: 38 cost time: 1.366943597793579
Epoch: 38, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.729 Vali Acc: 0.783 Test Loss: 0.729 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.441516637802124
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.753 Vali Acc: 0.796 Test Loss: 0.753 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.182647943496704
Epoch: 40, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.771 Vali Acc: 0.783 Test Loss: 0.771 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.6013567447662354
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.761 Vali Acc: 0.796 Test Loss: 0.761 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.4479687213897705
Epoch: 42, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.777 Vali Acc: 0.803 Test Loss: 0.777 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.3968720436096191
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.789 Vali Acc: 0.796 Test Loss: 0.789 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.3716087341308594
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.819 Vali Acc: 0.796 Test Loss: 0.819 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.4154822826385498
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.824 Vali Acc: 0.783 Test Loss: 0.824 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.4345147609710693
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.872 Vali Acc: 0.796 Test Loss: 0.872 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.4067575931549072
Epoch: 47, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.870 Vali Acc: 0.770 Test Loss: 0.870 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 510824
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.21704626083374
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.354 Vali Acc: 0.395 Test Loss: 1.354 Test Acc: 0.395
Validation loss decreased (inf --> -0.394723).  Saving model ...
Epoch: 2 cost time: 1.4662303924560547
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.304 Vali Acc: 0.382 Test Loss: 1.304 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.740128755569458
Epoch: 3, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.262 Vali Acc: 0.447 Test Loss: 1.262 Test Acc: 0.447
Validation loss decreased (-0.394723 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 1.6592977046966553
Epoch: 4, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.215 Vali Acc: 0.553 Test Loss: 1.215 Test Acc: 0.553
Validation loss decreased (-0.447356 --> -0.552619).  Saving model ...
Epoch: 5 cost time: 1.4254019260406494
Epoch: 5, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.170 Vali Acc: 0.553 Test Loss: 1.170 Test Acc: 0.553
Validation loss decreased (-0.552619 --> -0.552620).  Saving model ...
Epoch: 6 cost time: 1.6126868724822998
Epoch: 6, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.109 Vali Acc: 0.592 Test Loss: 1.109 Test Acc: 0.592
Validation loss decreased (-0.552620 --> -0.592094).  Saving model ...
Epoch: 7 cost time: 2.06901216506958
Epoch: 7, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.035 Vali Acc: 0.632 Test Loss: 1.035 Test Acc: 0.632
Validation loss decreased (-0.592094 --> -0.631569).  Saving model ...
Epoch: 8 cost time: 1.1648151874542236
Epoch: 8, Steps: 10 | Train Loss: 0.912 Vali Loss: 0.959 Vali Acc: 0.697 Test Loss: 0.959 Test Acc: 0.697
Validation loss decreased (-0.631569 --> -0.697359).  Saving model ...
Epoch: 9 cost time: 1.7181355953216553
Epoch: 9, Steps: 10 | Train Loss: 0.820 Vali Loss: 0.881 Vali Acc: 0.671 Test Loss: 0.881 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4187257289886475
Epoch: 10, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.786 Vali Acc: 0.730 Test Loss: 0.786 Test Acc: 0.730
Validation loss decreased (-0.697359 --> -0.730255).  Saving model ...
Epoch: 11 cost time: 1.355140209197998
Epoch: 11, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.717 Vali Acc: 0.743 Test Loss: 0.717 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743414).  Saving model ...
Epoch: 12 cost time: 1.641451358795166
Epoch: 12, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.673 Vali Acc: 0.730 Test Loss: 0.673 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4430046081542969
Epoch: 13, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.625 Vali Acc: 0.757 Test Loss: 0.625 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.432159185409546
Epoch: 14, Steps: 10 | Train Loss: 0.406 Vali Loss: 0.652 Vali Acc: 0.730 Test Loss: 0.652 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4311437606811523
Epoch: 15, Steps: 10 | Train Loss: 0.367 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.6963648796081543
Epoch: 16, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.575 Vali Acc: 0.757 Test Loss: 0.575 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9759001731872559
Epoch: 17, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.823930025100708
Epoch: 18, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.590 Vali Acc: 0.757 Test Loss: 0.590 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4407169818878174
Epoch: 19, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.527 Vali Acc: 0.789 Test Loss: 0.527 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 20 cost time: 2.031080722808838
Epoch: 20, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4770259857177734
Epoch: 21, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802627).  Saving model ...
Epoch: 22 cost time: 1.2985985279083252
Epoch: 22, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5671679973602295
Epoch: 23, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8632748126983643
Epoch: 24, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.503 Vali Acc: 0.789 Test Loss: 0.503 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5105524063110352
Epoch: 25, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.513 Vali Acc: 0.796 Test Loss: 0.513 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5994791984558105
Epoch: 26, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.835047960281372
Epoch: 27, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2727041244506836
Epoch: 28, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0958423614501953
Epoch: 29, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.530 Vali Acc: 0.783 Test Loss: 0.530 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4756898880004883
Epoch: 30, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.552 Vali Acc: 0.816 Test Loss: 0.552 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815784).  Saving model ...
Epoch: 31 cost time: 1.4539449214935303
Epoch: 31, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.4294812679290771
Epoch: 32, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.586 Vali Acc: 0.816 Test Loss: 0.586 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.9262733459472656
Epoch: 33, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.579 Vali Acc: 0.836 Test Loss: 0.579 Test Acc: 0.836
Validation loss decreased (-0.815784 --> -0.835521).  Saving model ...
Epoch: 34 cost time: 1.7182199954986572
Epoch: 34, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.579 Vali Acc: 0.816 Test Loss: 0.579 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4947352409362793
Epoch: 35, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5519239902496338
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4152326583862305
Epoch: 37, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.643 Vali Acc: 0.822 Test Loss: 0.643 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.540494680404663
Epoch: 38, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.608 Vali Acc: 0.803 Test Loss: 0.608 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.8403937816619873
Epoch: 39, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.624 Vali Acc: 0.829 Test Loss: 0.624 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.008615255355835
Epoch: 40, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.622 Vali Acc: 0.809 Test Loss: 0.622 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.7091352939605713
Epoch: 41, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.687 Vali Acc: 0.803 Test Loss: 0.687 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.834341287612915
Epoch: 42, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.681 Vali Acc: 0.809 Test Loss: 0.681 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.5208978652954102
Epoch: 43, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.725 Vali Acc: 0.783 Test Loss: 0.725 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 510504
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7358527183532715
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.432 Vali Acc: 0.257 Test Loss: 1.432 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.3195559978485107
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.381 Vali Acc: 0.296 Test Loss: 1.381 Test Acc: 0.296
Validation loss decreased (-0.256565 --> -0.296039).  Saving model ...
Epoch: 3 cost time: 1.6990606784820557
Epoch: 3, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.338 Vali Acc: 0.349 Test Loss: 1.338 Test Acc: 0.349
Validation loss decreased (-0.296039 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 1.278477430343628
Epoch: 4, Steps: 10 | Train Loss: 1.254 Vali Loss: 1.304 Vali Acc: 0.349 Test Loss: 1.304 Test Acc: 0.349
Validation loss decreased (-0.348671 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 1.4966776371002197
Epoch: 5, Steps: 10 | Train Loss: 1.272 Vali Loss: 1.266 Vali Acc: 0.441 Test Loss: 1.266 Test Acc: 0.441
Validation loss decreased (-0.348671 --> -0.440777).  Saving model ...
Epoch: 6 cost time: 1.3326060771942139
Epoch: 6, Steps: 10 | Train Loss: 1.136 Vali Loss: 1.181 Vali Acc: 0.559 Test Loss: 1.181 Test Acc: 0.559
Validation loss decreased (-0.440777 --> -0.559199).  Saving model ...
Epoch: 7 cost time: 1.4943211078643799
Epoch: 7, Steps: 10 | Train Loss: 1.123 Vali Loss: 1.112 Vali Acc: 0.645 Test Loss: 1.112 Test Acc: 0.645
Validation loss decreased (-0.559199 --> -0.644726).  Saving model ...
Epoch: 8 cost time: 1.496119499206543
Epoch: 8, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.072 Vali Acc: 0.592 Test Loss: 1.072 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7200191020965576
Epoch: 9, Steps: 10 | Train Loss: 0.913 Vali Loss: 0.944 Vali Acc: 0.691 Test Loss: 0.944 Test Acc: 0.691
Validation loss decreased (-0.644726 --> -0.690780).  Saving model ...
Epoch: 10 cost time: 1.5786006450653076
Epoch: 10, Steps: 10 | Train Loss: 0.811 Vali Loss: 0.863 Vali Acc: 0.730 Test Loss: 0.863 Test Acc: 0.730
Validation loss decreased (-0.690780 --> -0.730255).  Saving model ...
Epoch: 11 cost time: 1.277512788772583
Epoch: 11, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.789 Vali Acc: 0.730 Test Loss: 0.789 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730255).  Saving model ...
Epoch: 12 cost time: 1.5478618144989014
Epoch: 12, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.694 Vali Acc: 0.750 Test Loss: 0.694 Test Acc: 0.750
Validation loss decreased (-0.730255 --> -0.749993).  Saving model ...
Epoch: 13 cost time: 1.6639153957366943
Epoch: 13, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.629 Vali Acc: 0.743 Test Loss: 0.629 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3260722160339355
Epoch: 14, Steps: 10 | Train Loss: 0.410 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
Validation loss decreased (-0.749993 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.207050085067749
Epoch: 15, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.578 Vali Acc: 0.743 Test Loss: 0.578 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0953547954559326
Epoch: 16, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.512 Vali Acc: 0.776 Test Loss: 0.512 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 17 cost time: 1.4202711582183838
Epoch: 17, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.513 Vali Acc: 0.757 Test Loss: 0.513 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2042410373687744
Epoch: 18, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.485 Vali Acc: 0.776 Test Loss: 0.485 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 19 cost time: 1.247319221496582
Epoch: 19, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.465 Vali Acc: 0.770 Test Loss: 0.465 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2652757167816162
Epoch: 20, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.455 Vali Acc: 0.789 Test Loss: 0.455 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789469).  Saving model ...
Epoch: 21 cost time: 1.3897426128387451
Epoch: 21, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.475 Vali Acc: 0.789 Test Loss: 0.475 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2117760181427002
Epoch: 22, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.477 Vali Acc: 0.776 Test Loss: 0.477 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2382614612579346
Epoch: 23, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6269145011901855
Epoch: 24, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.450 Vali Acc: 0.783 Test Loss: 0.450 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.320892333984375
Epoch: 25, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.471 Vali Acc: 0.796 Test Loss: 0.471 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 26 cost time: 1.2480881214141846
Epoch: 26, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.473 Vali Acc: 0.803 Test Loss: 0.473 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 27 cost time: 1.316195011138916
Epoch: 27, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.483 Vali Acc: 0.809 Test Loss: 0.483 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 28 cost time: 1.318939447402954
Epoch: 28, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2868297100067139
Epoch: 29, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.522 Vali Acc: 0.803 Test Loss: 0.522 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.618844985961914
Epoch: 30, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.519 Vali Acc: 0.803 Test Loss: 0.519 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.287715196609497
Epoch: 31, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4089524745941162
Epoch: 32, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5590813159942627
Epoch: 33, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.545 Vali Acc: 0.809 Test Loss: 0.545 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4033944606781006
Epoch: 34, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2317421436309814
Epoch: 35, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.571 Vali Acc: 0.796 Test Loss: 0.571 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2496161460876465
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.579 Vali Acc: 0.803 Test Loss: 0.579 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.5831432342529297
Epoch: 37, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.593 Vali Acc: 0.796 Test Loss: 0.593 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 510184
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5844242572784424
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.365 Vali Acc: 0.329 Test Loss: 1.365 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.3952467441558838
Epoch: 2, Steps: 10 | Train Loss: 1.361 Vali Loss: 1.354 Vali Acc: 0.296 Test Loss: 1.354 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.418727159500122
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.294 Vali Acc: 0.395 Test Loss: 1.294 Test Acc: 0.395
Validation loss decreased (-0.328934 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 1.4617359638214111
Epoch: 4, Steps: 10 | Train Loss: 1.283 Vali Loss: 1.251 Vali Acc: 0.526 Test Loss: 1.251 Test Acc: 0.526
Validation loss decreased (-0.394724 --> -0.526303).  Saving model ...
Epoch: 5 cost time: 1.277864933013916
Epoch: 5, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.185 Vali Acc: 0.507 Test Loss: 1.185 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3554611206054688
Epoch: 6, Steps: 10 | Train Loss: 1.125 Vali Loss: 1.120 Vali Acc: 0.651 Test Loss: 1.120 Test Acc: 0.651
Validation loss decreased (-0.526303 --> -0.651305).  Saving model ...
Epoch: 7 cost time: 1.292050838470459
Epoch: 7, Steps: 10 | Train Loss: 1.076 Vali Loss: 1.035 Vali Acc: 0.625 Test Loss: 1.035 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.125213384628296
Epoch: 8, Steps: 10 | Train Loss: 0.948 Vali Loss: 0.972 Vali Acc: 0.678 Test Loss: 0.972 Test Acc: 0.678
Validation loss decreased (-0.651305 --> -0.677622).  Saving model ...
Epoch: 9 cost time: 1.6248764991760254
Epoch: 9, Steps: 10 | Train Loss: 0.808 Vali Loss: 0.873 Vali Acc: 0.684 Test Loss: 0.873 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684202).  Saving model ...
Epoch: 10 cost time: 1.3518893718719482
Epoch: 10, Steps: 10 | Train Loss: 0.713 Vali Loss: 0.805 Vali Acc: 0.717 Test Loss: 0.805 Test Acc: 0.717
Validation loss decreased (-0.684202 --> -0.717097).  Saving model ...
Epoch: 11 cost time: 1.3384218215942383
Epoch: 11, Steps: 10 | Train Loss: 0.599 Vali Loss: 0.699 Vali Acc: 0.737 Test Loss: 0.699 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736835).  Saving model ...
Epoch: 12 cost time: 1.31187105178833
Epoch: 12, Steps: 10 | Train Loss: 0.521 Vali Loss: 0.627 Vali Acc: 0.763 Test Loss: 0.627 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.2162723541259766
Epoch: 13, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.569 Vali Acc: 0.776 Test Loss: 0.569 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.313474178314209
Epoch: 14, Steps: 10 | Train Loss: 0.383 Vali Loss: 0.523 Vali Acc: 0.770 Test Loss: 0.523 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5433614253997803
Epoch: 15, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.499 Vali Acc: 0.796 Test Loss: 0.499 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796048).  Saving model ...
Epoch: 16 cost time: 1.308894395828247
Epoch: 16, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.494 Vali Acc: 0.809 Test Loss: 0.494 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 17 cost time: 1.2663524150848389
Epoch: 17, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.457 Vali Acc: 0.783 Test Loss: 0.457 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2604248523712158
Epoch: 18, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.452 Vali Acc: 0.809 Test Loss: 0.452 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 19 cost time: 1.2124342918395996
Epoch: 19, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.461 Vali Acc: 0.796 Test Loss: 0.461 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4377574920654297
Epoch: 20, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.432 Vali Acc: 0.816 Test Loss: 0.432 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 21 cost time: 1.3019435405731201
Epoch: 21, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.437 Vali Acc: 0.816 Test Loss: 0.437 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.345043659210205
Epoch: 22, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.431 Vali Acc: 0.822 Test Loss: 0.431 Test Acc: 0.822
Validation loss decreased (-0.815785 --> -0.822364).  Saving model ...
Epoch: 23 cost time: 1.2335364818572998
Epoch: 23, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.432 Vali Acc: 0.836 Test Loss: 0.432 Test Acc: 0.836
Validation loss decreased (-0.822364 --> -0.835522).  Saving model ...
Epoch: 24 cost time: 1.2446792125701904
Epoch: 24, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4183833599090576
Epoch: 25, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.460 Vali Acc: 0.809 Test Loss: 0.460 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1691713333129883
Epoch: 26, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.495 Vali Acc: 0.816 Test Loss: 0.495 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.4164388179779053
Epoch: 27, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.472 Vali Acc: 0.816 Test Loss: 0.472 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5229756832122803
Epoch: 28, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.482 Vali Acc: 0.829 Test Loss: 0.482 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.3765509128570557
Epoch: 29, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.507 Vali Acc: 0.809 Test Loss: 0.507 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9176831245422363
Epoch: 30, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.498 Vali Acc: 0.822 Test Loss: 0.498 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2284159660339355
Epoch: 31, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1348111629486084
Epoch: 32, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.500 Vali Acc: 0.796 Test Loss: 0.500 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5454509258270264
Epoch: 33, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.514 Vali Acc: 0.796 Test Loss: 0.514 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 509864
model size : 3.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7816765308380127
Epoch: 1, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.357 Vali Acc: 0.296 Test Loss: 1.357 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.3219637870788574
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.322 Vali Acc: 0.362 Test Loss: 1.322 Test Acc: 0.362
Validation loss decreased (-0.296039 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.3538885116577148
Epoch: 3, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.298 Vali Acc: 0.349 Test Loss: 1.298 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4588079452514648
Epoch: 4, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.252 Vali Acc: 0.461 Test Loss: 1.252 Test Acc: 0.461
Validation loss decreased (-0.361829 --> -0.460514).  Saving model ...
Epoch: 5 cost time: 1.433716058731079
Epoch: 5, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.209 Vali Acc: 0.533 Test Loss: 1.209 Test Acc: 0.533
Validation loss decreased (-0.460514 --> -0.532883).  Saving model ...
Epoch: 6 cost time: 1.4320766925811768
Epoch: 6, Steps: 10 | Train Loss: 1.158 Vali Loss: 1.164 Vali Acc: 0.599 Test Loss: 1.164 Test Acc: 0.599
Validation loss decreased (-0.532883 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 1.5294535160064697
Epoch: 7, Steps: 10 | Train Loss: 1.081 Vali Loss: 1.098 Vali Acc: 0.645 Test Loss: 1.098 Test Acc: 0.645
Validation loss decreased (-0.598673 --> -0.644726).  Saving model ...
Epoch: 8 cost time: 1.3819551467895508
Epoch: 8, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.047 Vali Acc: 0.625 Test Loss: 1.047 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2809197902679443
Epoch: 9, Steps: 10 | Train Loss: 0.958 Vali Loss: 0.994 Vali Acc: 0.651 Test Loss: 0.994 Test Acc: 0.651
Validation loss decreased (-0.644726 --> -0.651306).  Saving model ...
Epoch: 10 cost time: 1.488515853881836
Epoch: 10, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.915 Vali Acc: 0.678 Test Loss: 0.915 Test Acc: 0.678
Validation loss decreased (-0.651306 --> -0.677622).  Saving model ...
Epoch: 11 cost time: 1.5723800659179688
Epoch: 11, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.840 Vali Acc: 0.717 Test Loss: 0.840 Test Acc: 0.717
Validation loss decreased (-0.677622 --> -0.717097).  Saving model ...
Epoch: 12 cost time: 1.37369966506958
Epoch: 12, Steps: 10 | Train Loss: 0.619 Vali Loss: 0.762 Vali Acc: 0.724 Test Loss: 0.762 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723677).  Saving model ...
Epoch: 13 cost time: 1.380964994430542
Epoch: 13, Steps: 10 | Train Loss: 0.507 Vali Loss: 0.717 Vali Acc: 0.724 Test Loss: 0.717 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 14 cost time: 1.3423798084259033
Epoch: 14, Steps: 10 | Train Loss: 0.477 Vali Loss: 0.666 Vali Acc: 0.737 Test Loss: 0.666 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736835).  Saving model ...
Epoch: 15 cost time: 1.3474955558776855
Epoch: 15, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.632 Vali Acc: 0.743 Test Loss: 0.632 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 16 cost time: 1.105234146118164
Epoch: 16, Steps: 10 | Train Loss: 0.341 Vali Loss: 0.568 Vali Acc: 0.757 Test Loss: 0.568 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 1.3823316097259521
Epoch: 17, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769732).  Saving model ...
Epoch: 18 cost time: 1.526029348373413
Epoch: 18, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.513 Vali Acc: 0.789 Test Loss: 0.513 Test Acc: 0.789
Validation loss decreased (-0.769732 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 1.389427661895752
Epoch: 19, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.505 Vali Acc: 0.776 Test Loss: 0.505 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7972240447998047
Epoch: 20, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.492 Vali Acc: 0.776 Test Loss: 0.492 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4013869762420654
Epoch: 21, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4059937000274658
Epoch: 22, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.490 Vali Acc: 0.789 Test Loss: 0.490 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 23 cost time: 1.29423189163208
Epoch: 23, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.496 Vali Acc: 0.763 Test Loss: 0.496 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.319317102432251
Epoch: 24, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1282134056091309
Epoch: 25, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.511 Vali Acc: 0.776 Test Loss: 0.511 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.271139144897461
Epoch: 26, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2048163414001465
Epoch: 27, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 28 cost time: 1.0920095443725586
Epoch: 28, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4703595638275146
Epoch: 29, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.554 Vali Acc: 0.796 Test Loss: 0.554 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4572343826293945
Epoch: 30, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4172735214233398
Epoch: 31, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.426210880279541
Epoch: 32, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.597 Vali Acc: 0.776 Test Loss: 0.597 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.4428250789642334
Epoch: 33, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.629 Vali Acc: 0.796 Test Loss: 0.629 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4545679092407227
Epoch: 34, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.645 Vali Acc: 0.757 Test Loss: 0.645 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3936042785644531
Epoch: 35, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.742 Vali Acc: 0.789 Test Loss: 0.742 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4644577503204346
Epoch: 36, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.714 Vali Acc: 0.789 Test Loss: 0.714 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.4324467182159424
Epoch: 37, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.720 Vali Acc: 0.770 Test Loss: 0.720 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 428264
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4135916233062744
Epoch: 1, Steps: 10 | Train Loss: 1.445 Vali Loss: 1.388 Vali Acc: 0.283 Test Loss: 1.388 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.200819969177246
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.352 Vali Acc: 0.342 Test Loss: 1.352 Test Acc: 0.342
Validation loss decreased (-0.282881 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.6030035018920898
Epoch: 3, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.318 Vali Acc: 0.329 Test Loss: 1.318 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4345767498016357
Epoch: 4, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.281 Vali Acc: 0.388 Test Loss: 1.281 Test Acc: 0.388
Validation loss decreased (-0.342092 --> -0.388145).  Saving model ...
Epoch: 5 cost time: 1.2250545024871826
Epoch: 5, Steps: 10 | Train Loss: 1.228 Vali Loss: 1.232 Vali Acc: 0.533 Test Loss: 1.232 Test Acc: 0.533
Validation loss decreased (-0.388145 --> -0.532882).  Saving model ...
Epoch: 6 cost time: 1.3702890872955322
Epoch: 6, Steps: 10 | Train Loss: 1.170 Vali Loss: 1.191 Vali Acc: 0.480 Test Loss: 1.191 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3232994079589844
Epoch: 7, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.133 Vali Acc: 0.618 Test Loss: 1.133 Test Acc: 0.618
Validation loss decreased (-0.532882 --> -0.618410).  Saving model ...
Epoch: 8 cost time: 1.1275980472564697
Epoch: 8, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.064 Vali Acc: 0.599 Test Loss: 1.064 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2604827880859375
Epoch: 9, Steps: 10 | Train Loss: 0.908 Vali Loss: 0.994 Vali Acc: 0.625 Test Loss: 0.994 Test Acc: 0.625
Validation loss decreased (-0.618410 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 1.2861075401306152
Epoch: 10, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.902 Vali Acc: 0.638 Test Loss: 0.902 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638149).  Saving model ...
Epoch: 11 cost time: 0.9624903202056885
Epoch: 11, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.819 Vali Acc: 0.678 Test Loss: 0.819 Test Acc: 0.678
Validation loss decreased (-0.638149 --> -0.677623).  Saving model ...
Epoch: 12 cost time: 1.436333417892456
Epoch: 12, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.756 Vali Acc: 0.697 Test Loss: 0.756 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 13 cost time: 1.1063387393951416
Epoch: 13, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.703 Vali Acc: 0.704 Test Loss: 0.703 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 14 cost time: 1.2617897987365723
Epoch: 14, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.662 Vali Acc: 0.737 Test Loss: 0.662 Test Acc: 0.737
Validation loss decreased (-0.703940 --> -0.736835).  Saving model ...
Epoch: 15 cost time: 1.050821304321289
Epoch: 15, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.600 Vali Acc: 0.750 Test Loss: 0.600 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 16 cost time: 1.4797184467315674
Epoch: 16, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.567 Vali Acc: 0.757 Test Loss: 0.567 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 17 cost time: 1.4611387252807617
Epoch: 17, Steps: 10 | Train Loss: 0.303 Vali Loss: 0.566 Vali Acc: 0.743 Test Loss: 0.566 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3326694965362549
Epoch: 18, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.549 Vali Acc: 0.763 Test Loss: 0.549 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 1.538240671157837
Epoch: 19, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.529 Vali Acc: 0.757 Test Loss: 0.529 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.529738187789917
Epoch: 20, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.524 Vali Acc: 0.770 Test Loss: 0.524 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769732).  Saving model ...
Epoch: 21 cost time: 1.2531578540802002
Epoch: 21, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 22 cost time: 1.1404597759246826
Epoch: 22, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 23 cost time: 1.1807019710540771
Epoch: 23, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5173282623291016
Epoch: 24, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.497 Vali Acc: 0.803 Test Loss: 0.497 Test Acc: 0.803
Validation loss decreased (-0.782890 --> -0.802627).  Saving model ...
Epoch: 25 cost time: 1.056713581085205
Epoch: 25, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2380139827728271
Epoch: 26, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.516 Vali Acc: 0.757 Test Loss: 0.516 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4211509227752686
Epoch: 27, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.574 Vali Acc: 0.776 Test Loss: 0.574 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.435476541519165
Epoch: 28, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.503 Vali Acc: 0.822 Test Loss: 0.503 Test Acc: 0.822
Validation loss decreased (-0.802627 --> -0.822363).  Saving model ...
Epoch: 29 cost time: 1.3185498714447021
Epoch: 29, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3129873275756836
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4545884132385254
Epoch: 31, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.533 Vali Acc: 0.816 Test Loss: 0.533 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2877507209777832
Epoch: 32, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.587 Vali Acc: 0.803 Test Loss: 0.587 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3692500591278076
Epoch: 33, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.568 Vali Acc: 0.776 Test Loss: 0.568 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.4131357669830322
Epoch: 34, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.637 Vali Acc: 0.789 Test Loss: 0.637 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.3655695915222168
Epoch: 35, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.2768230438232422
Epoch: 36, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1964540481567383
Epoch: 37, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.634 Vali Acc: 0.796 Test Loss: 0.634 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2500805854797363
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.659 Vali Acc: 0.796 Test Loss: 0.659 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 427944
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.8187694549560547
Epoch: 1, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.384 Vali Acc: 0.270 Test Loss: 1.384 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.357069969177246
Epoch: 2, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.363 Vali Acc: 0.362 Test Loss: 1.363 Test Acc: 0.362
Validation loss decreased (-0.269723 --> -0.361828).  Saving model ...
Epoch: 3 cost time: 1.1999108791351318
Epoch: 3, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.324 Vali Acc: 0.454 Test Loss: 1.324 Test Acc: 0.454
Validation loss decreased (-0.361828 --> -0.453934).  Saving model ...
Epoch: 4 cost time: 1.3320982456207275
Epoch: 4, Steps: 10 | Train Loss: 1.288 Vali Loss: 1.286 Vali Acc: 0.480 Test Loss: 1.286 Test Acc: 0.480
Validation loss decreased (-0.453934 --> -0.480250).  Saving model ...
Epoch: 5 cost time: 1.1149787902832031
Epoch: 5, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.233 Vali Acc: 0.559 Test Loss: 1.233 Test Acc: 0.559
Validation loss decreased (-0.480250 --> -0.559198).  Saving model ...
Epoch: 6 cost time: 1.7218048572540283
Epoch: 6, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.187 Vali Acc: 0.605 Test Loss: 1.187 Test Acc: 0.605
Validation loss decreased (-0.559198 --> -0.605251).  Saving model ...
Epoch: 7 cost time: 1.7622156143188477
Epoch: 7, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.126 Vali Acc: 0.651 Test Loss: 1.126 Test Acc: 0.651
Validation loss decreased (-0.605251 --> -0.651305).  Saving model ...
Epoch: 8 cost time: 1.3583056926727295
Epoch: 8, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.068 Vali Acc: 0.645 Test Loss: 1.068 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3172492980957031
Epoch: 9, Steps: 10 | Train Loss: 0.882 Vali Loss: 0.993 Vali Acc: 0.664 Test Loss: 0.993 Test Acc: 0.664
Validation loss decreased (-0.651305 --> -0.664464).  Saving model ...
Epoch: 10 cost time: 1.2147719860076904
Epoch: 10, Steps: 10 | Train Loss: 0.817 Vali Loss: 0.923 Vali Acc: 0.678 Test Loss: 0.923 Test Acc: 0.678
Validation loss decreased (-0.664464 --> -0.677622).  Saving model ...
Epoch: 11 cost time: 1.4883716106414795
Epoch: 11, Steps: 10 | Train Loss: 0.712 Vali Loss: 0.847 Vali Acc: 0.691 Test Loss: 0.847 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690781).  Saving model ...
Epoch: 12 cost time: 1.0888171195983887
Epoch: 12, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.777 Vali Acc: 0.697 Test Loss: 0.777 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697361).  Saving model ...
Epoch: 13 cost time: 1.3656096458435059
Epoch: 13, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.729 Vali Acc: 0.704 Test Loss: 0.729 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 14 cost time: 1.4499220848083496
Epoch: 14, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.684 Vali Acc: 0.724 Test Loss: 0.684 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 15 cost time: 1.1318926811218262
Epoch: 15, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.644 Vali Acc: 0.757 Test Loss: 0.644 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756573).  Saving model ...
Epoch: 16 cost time: 1.1722228527069092
Epoch: 16, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.596 Vali Acc: 0.770 Test Loss: 0.596 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 17 cost time: 1.3002033233642578
Epoch: 17, Steps: 10 | Train Loss: 0.310 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5870983600616455
Epoch: 18, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.466141939163208
Epoch: 19, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.528 Vali Acc: 0.776 Test Loss: 0.528 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4276623725891113
Epoch: 20, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.534 Vali Acc: 0.783 Test Loss: 0.534 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2353355884552002
Epoch: 21, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.516 Vali Acc: 0.770 Test Loss: 0.516 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1835825443267822
Epoch: 22, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.540 Vali Acc: 0.757 Test Loss: 0.540 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3371388912200928
Epoch: 23, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.515 Vali Acc: 0.776 Test Loss: 0.515 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.62009596824646
Epoch: 24, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.548 Vali Acc: 0.763 Test Loss: 0.548 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4364013671875
Epoch: 25, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.561 Vali Acc: 0.789 Test Loss: 0.561 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 26 cost time: 1.2260563373565674
Epoch: 26, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.611 Vali Acc: 0.763 Test Loss: 0.611 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.595294713973999
Epoch: 27, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2706303596496582
Epoch: 28, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6108500957489014
Epoch: 29, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1698687076568604
Epoch: 30, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.598 Vali Acc: 0.789 Test Loss: 0.598 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2356715202331543
Epoch: 31, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.622 Vali Acc: 0.763 Test Loss: 0.622 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3338525295257568
Epoch: 32, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.627 Vali Acc: 0.783 Test Loss: 0.627 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.4292471408843994
Epoch: 33, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4485821723937988
Epoch: 34, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.690 Vali Acc: 0.770 Test Loss: 0.690 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3612494468688965
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.704 Vali Acc: 0.770 Test Loss: 0.704 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 427624
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.317005157470703
Epoch: 1, Steps: 10 | Train Loss: 1.448 Vali Loss: 1.395 Vali Acc: 0.283 Test Loss: 1.395 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.5047006607055664
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.358 Vali Acc: 0.329 Test Loss: 1.358 Test Acc: 0.329
Validation loss decreased (-0.282881 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.2369084358215332
Epoch: 3, Steps: 10 | Train Loss: 1.363 Vali Loss: 1.325 Vali Acc: 0.395 Test Loss: 1.325 Test Acc: 0.395
Validation loss decreased (-0.328934 --> -0.394724).  Saving model ...
Epoch: 4 cost time: 1.1457490921020508
Epoch: 4, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.276 Vali Acc: 0.447 Test Loss: 1.276 Test Acc: 0.447
Validation loss decreased (-0.394724 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 1.5929465293884277
Epoch: 5, Steps: 10 | Train Loss: 1.203 Vali Loss: 1.230 Vali Acc: 0.513 Test Loss: 1.230 Test Acc: 0.513
Validation loss decreased (-0.447356 --> -0.513146).  Saving model ...
Epoch: 6 cost time: 1.4483866691589355
Epoch: 6, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.176 Vali Acc: 0.520 Test Loss: 1.176 Test Acc: 0.520
Validation loss decreased (-0.513146 --> -0.519725).  Saving model ...
Epoch: 7 cost time: 1.2056171894073486
Epoch: 7, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.105 Vali Acc: 0.599 Test Loss: 1.105 Test Acc: 0.599
Validation loss decreased (-0.519725 --> -0.598673).  Saving model ...
Epoch: 8 cost time: 1.4708061218261719
Epoch: 8, Steps: 10 | Train Loss: 0.965 Vali Loss: 1.048 Vali Acc: 0.586 Test Loss: 1.048 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.405968427658081
Epoch: 9, Steps: 10 | Train Loss: 0.917 Vali Loss: 0.964 Vali Acc: 0.625 Test Loss: 0.964 Test Acc: 0.625
Validation loss decreased (-0.598673 --> -0.624990).  Saving model ...
Epoch: 10 cost time: 1.0718035697937012
Epoch: 10, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.892 Vali Acc: 0.632 Test Loss: 0.892 Test Acc: 0.632
Validation loss decreased (-0.624990 --> -0.631570).  Saving model ...
Epoch: 11 cost time: 1.139819860458374
Epoch: 11, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.828 Vali Acc: 0.645 Test Loss: 0.828 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644729).  Saving model ...
Epoch: 12 cost time: 1.5499589443206787
Epoch: 12, Steps: 10 | Train Loss: 0.618 Vali Loss: 0.760 Vali Acc: 0.717 Test Loss: 0.760 Test Acc: 0.717
Validation loss decreased (-0.644729 --> -0.717098).  Saving model ...
Epoch: 13 cost time: 1.191575527191162
Epoch: 13, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.699 Vali Acc: 0.724 Test Loss: 0.699 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 14 cost time: 1.2796261310577393
Epoch: 14, Steps: 10 | Train Loss: 0.464 Vali Loss: 0.669 Vali Acc: 0.711 Test Loss: 0.669 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3506035804748535
Epoch: 15, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.613 Vali Acc: 0.730 Test Loss: 0.613 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730257).  Saving model ...
Epoch: 16 cost time: 1.396195650100708
Epoch: 16, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.583 Vali Acc: 0.750 Test Loss: 0.583 Test Acc: 0.750
Validation loss decreased (-0.730257 --> -0.749994).  Saving model ...
Epoch: 17 cost time: 1.3300468921661377
Epoch: 17, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.580 Vali Acc: 0.730 Test Loss: 0.580 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.333845853805542
Epoch: 18, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.547 Vali Acc: 0.750 Test Loss: 0.547 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749995).  Saving model ...
Epoch: 19 cost time: 1.3383080959320068
Epoch: 19, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.539 Vali Acc: 0.750 Test Loss: 0.539 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 20 cost time: 1.1587848663330078
Epoch: 20, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.749995 --> -0.782889).  Saving model ...
Epoch: 21 cost time: 1.4456682205200195
Epoch: 21, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.526 Vali Acc: 0.757 Test Loss: 0.526 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3486135005950928
Epoch: 22, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.519 Vali Acc: 0.770 Test Loss: 0.519 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3150670528411865
Epoch: 23, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.508 Vali Acc: 0.743 Test Loss: 0.508 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.216944932937622
Epoch: 24, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.503 Vali Acc: 0.770 Test Loss: 0.503 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.623889684677124
Epoch: 25, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.524 Vali Acc: 0.770 Test Loss: 0.524 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3587079048156738
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.537 Vali Acc: 0.750 Test Loss: 0.537 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5281856060028076
Epoch: 27, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.527 Vali Acc: 0.770 Test Loss: 0.527 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3735315799713135
Epoch: 28, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.543 Vali Acc: 0.757 Test Loss: 0.543 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.172609806060791
Epoch: 29, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.577 Vali Acc: 0.770 Test Loss: 0.577 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3105626106262207
Epoch: 30, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.598 Vali Acc: 0.770 Test Loss: 0.598 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 427304
model size : 2.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.794423818588257
Epoch: 1, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.417 Vali Acc: 0.204 Test Loss: 1.417 Test Acc: 0.204
Validation loss decreased (inf --> -0.203933).  Saving model ...
Epoch: 2 cost time: 1.4719891548156738
Epoch: 2, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.390 Vali Acc: 0.250 Test Loss: 1.390 Test Acc: 0.250
Validation loss decreased (-0.203933 --> -0.249986).  Saving model ...
Epoch: 3 cost time: 1.4274601936340332
Epoch: 3, Steps: 10 | Train Loss: 1.335 Vali Loss: 1.356 Vali Acc: 0.336 Test Loss: 1.356 Test Acc: 0.336
Validation loss decreased (-0.249986 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 1.3927974700927734
Epoch: 4, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.323 Vali Acc: 0.355 Test Loss: 1.323 Test Acc: 0.355
Validation loss decreased (-0.335513 --> -0.355250).  Saving model ...
Epoch: 5 cost time: 1.4717724323272705
Epoch: 5, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.275 Vali Acc: 0.454 Test Loss: 1.275 Test Acc: 0.454
Validation loss decreased (-0.355250 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 1.3007965087890625
Epoch: 6, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.235 Vali Acc: 0.526 Test Loss: 1.235 Test Acc: 0.526
Validation loss decreased (-0.453935 --> -0.526303).  Saving model ...
Epoch: 7 cost time: 1.1921136379241943
Epoch: 7, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.174 Vali Acc: 0.586 Test Loss: 1.174 Test Acc: 0.586
Validation loss decreased (-0.526303 --> -0.585515).  Saving model ...
Epoch: 8 cost time: 2.078986644744873
Epoch: 8, Steps: 10 | Train Loss: 1.020 Vali Loss: 1.115 Vali Acc: 0.566 Test Loss: 1.115 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3908653259277344
Epoch: 9, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.061 Vali Acc: 0.599 Test Loss: 1.061 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598674).  Saving model ...
Epoch: 10 cost time: 1.5139195919036865
Epoch: 10, Steps: 10 | Train Loss: 0.889 Vali Loss: 0.995 Vali Acc: 0.625 Test Loss: 0.995 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 1.444817304611206
Epoch: 11, Steps: 10 | Train Loss: 0.771 Vali Loss: 0.931 Vali Acc: 0.664 Test Loss: 0.931 Test Acc: 0.664
Validation loss decreased (-0.624990 --> -0.664464).  Saving model ...
Epoch: 12 cost time: 1.5590219497680664
Epoch: 12, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.879 Vali Acc: 0.691 Test Loss: 0.879 Test Acc: 0.691
Validation loss decreased (-0.664464 --> -0.690781).  Saving model ...
Epoch: 13 cost time: 1.6945598125457764
Epoch: 13, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.817 Vali Acc: 0.711 Test Loss: 0.817 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710518).  Saving model ...
Epoch: 14 cost time: 1.580003261566162
Epoch: 14, Steps: 10 | Train Loss: 0.562 Vali Loss: 0.800 Vali Acc: 0.717 Test Loss: 0.800 Test Acc: 0.717
Validation loss decreased (-0.710518 --> -0.717097).  Saving model ...
Epoch: 15 cost time: 1.6945667266845703
Epoch: 15, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.758 Vali Acc: 0.724 Test Loss: 0.758 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723677).  Saving model ...
Epoch: 16 cost time: 1.1945178508758545
Epoch: 16, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.745 Vali Acc: 0.697 Test Loss: 0.745 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3474433422088623
Epoch: 17, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.705 Vali Acc: 0.730 Test Loss: 0.705 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 18 cost time: 1.441185474395752
Epoch: 18, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.661 Vali Acc: 0.763 Test Loss: 0.661 Test Acc: 0.763
Validation loss decreased (-0.730256 --> -0.763151).  Saving model ...
Epoch: 19 cost time: 1.4842658042907715
Epoch: 19, Steps: 10 | Train Loss: 0.337 Vali Loss: 0.653 Vali Acc: 0.724 Test Loss: 0.653 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5158958435058594
Epoch: 20, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.642 Vali Acc: 0.724 Test Loss: 0.642 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5802092552185059
Epoch: 21, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.640 Vali Acc: 0.743 Test Loss: 0.640 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5522451400756836
Epoch: 22, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.646 Vali Acc: 0.730 Test Loss: 0.646 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.248683214187622
Epoch: 23, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 24 cost time: 1.1931209564208984
Epoch: 24, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2887992858886719
Epoch: 25, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6901860237121582
Epoch: 26, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.616 Vali Acc: 0.783 Test Loss: 0.616 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 27 cost time: 1.4039349555969238
Epoch: 27, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.655 Vali Acc: 0.743 Test Loss: 0.655 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.515880823135376
Epoch: 28, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.632 Vali Acc: 0.789 Test Loss: 0.632 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 29 cost time: 1.3135714530944824
Epoch: 29, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.624 Vali Acc: 0.750 Test Loss: 0.624 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.591200590133667
Epoch: 30, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.611 Vali Acc: 0.770 Test Loss: 0.611 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1965053081512451
Epoch: 31, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.641 Vali Acc: 0.776 Test Loss: 0.641 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5016436576843262
Epoch: 32, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5541000366210938
Epoch: 33, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.632 Vali Acc: 0.770 Test Loss: 0.632 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.686042070388794
Epoch: 34, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.650 Vali Acc: 0.750 Test Loss: 0.650 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.715287685394287
Epoch: 35, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.631 Vali Acc: 0.757 Test Loss: 0.631 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.4384770393371582
Epoch: 36, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.615 Vali Acc: 0.776 Test Loss: 0.615 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.4756202697753906
Epoch: 37, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.621 Vali Acc: 0.763 Test Loss: 0.621 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.417356014251709
Epoch: 38, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.634 Vali Acc: 0.763 Test Loss: 0.634 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 423752
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4508869647979736
Epoch: 1, Steps: 10 | Train Loss: 1.486 Vali Loss: 1.421 Vali Acc: 0.257 Test Loss: 1.421 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.327181100845337
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.379 Vali Acc: 0.270 Test Loss: 1.379 Test Acc: 0.270
Validation loss decreased (-0.256565 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.3434078693389893
Epoch: 3, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.341 Vali Acc: 0.349 Test Loss: 1.341 Test Acc: 0.349
Validation loss decreased (-0.269723 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 1.2834398746490479
Epoch: 4, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.314 Vali Acc: 0.401 Test Loss: 1.314 Test Acc: 0.401
Validation loss decreased (-0.348671 --> -0.401303).  Saving model ...
Epoch: 5 cost time: 1.2453076839447021
Epoch: 5, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.272 Vali Acc: 0.447 Test Loss: 1.272 Test Acc: 0.447
Validation loss decreased (-0.401303 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 1.3754820823669434
Epoch: 6, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.234 Vali Acc: 0.454 Test Loss: 1.234 Test Acc: 0.454
Validation loss decreased (-0.447356 --> -0.453935).  Saving model ...
Epoch: 7 cost time: 1.2098050117492676
Epoch: 7, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.176 Vali Acc: 0.533 Test Loss: 1.176 Test Acc: 0.533
Validation loss decreased (-0.453935 --> -0.532883).  Saving model ...
Epoch: 8 cost time: 1.1778061389923096
Epoch: 8, Steps: 10 | Train Loss: 1.059 Vali Loss: 1.140 Vali Acc: 0.493 Test Loss: 1.140 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3303353786468506
Epoch: 9, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.066 Vali Acc: 0.546 Test Loss: 1.066 Test Acc: 0.546
Validation loss decreased (-0.532883 --> -0.546042).  Saving model ...
Epoch: 10 cost time: 1.281114101409912
Epoch: 10, Steps: 10 | Train Loss: 0.889 Vali Loss: 1.001 Vali Acc: 0.559 Test Loss: 1.001 Test Acc: 0.559
Validation loss decreased (-0.546042 --> -0.559201).  Saving model ...
Epoch: 11 cost time: 1.1190364360809326
Epoch: 11, Steps: 10 | Train Loss: 0.831 Vali Loss: 0.948 Vali Acc: 0.559 Test Loss: 0.948 Test Acc: 0.559
Validation loss decreased (-0.559201 --> -0.559201).  Saving model ...
Epoch: 12 cost time: 1.1716701984405518
Epoch: 12, Steps: 10 | Train Loss: 0.724 Vali Loss: 0.892 Vali Acc: 0.632 Test Loss: 0.892 Test Acc: 0.632
Validation loss decreased (-0.559201 --> -0.631570).  Saving model ...
Epoch: 13 cost time: 1.2761592864990234
Epoch: 13, Steps: 10 | Train Loss: 0.710 Vali Loss: 0.834 Vali Acc: 0.632 Test Loss: 0.834 Test Acc: 0.632
Validation loss decreased (-0.631570 --> -0.631571).  Saving model ...
Epoch: 14 cost time: 1.148871898651123
Epoch: 14, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.785 Vali Acc: 0.691 Test Loss: 0.785 Test Acc: 0.691
Validation loss decreased (-0.631571 --> -0.690782).  Saving model ...
Epoch: 15 cost time: 1.188887119293213
Epoch: 15, Steps: 10 | Train Loss: 0.563 Vali Loss: 0.745 Vali Acc: 0.704 Test Loss: 0.745 Test Acc: 0.704
Validation loss decreased (-0.690782 --> -0.703940).  Saving model ...
Epoch: 16 cost time: 1.3194301128387451
Epoch: 16, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.710 Vali Acc: 0.711 Test Loss: 0.710 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 17 cost time: 1.2858476638793945
Epoch: 17, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.678 Vali Acc: 0.730 Test Loss: 0.678 Test Acc: 0.730
Validation loss decreased (-0.710519 --> -0.730256).  Saving model ...
Epoch: 18 cost time: 1.4792981147766113
Epoch: 18, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.659 Vali Acc: 0.691 Test Loss: 0.659 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7126519680023193
Epoch: 19, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.643 Vali Acc: 0.717 Test Loss: 0.643 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3367602825164795
Epoch: 20, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.615 Vali Acc: 0.717 Test Loss: 0.615 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2147643566131592
Epoch: 21, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.606 Vali Acc: 0.724 Test Loss: 0.606 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1799933910369873
Epoch: 22, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.660 Vali Acc: 0.704 Test Loss: 0.660 Test Acc: 0.704
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.202937126159668
Epoch: 23, Steps: 10 | Train Loss: 0.260 Vali Loss: 0.586 Vali Acc: 0.743 Test Loss: 0.586 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 24 cost time: 1.2044501304626465
Epoch: 24, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.576 Vali Acc: 0.750 Test Loss: 0.576 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 25 cost time: 1.1880602836608887
Epoch: 25, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.537 Vali Acc: 0.737 Test Loss: 0.537 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.3335652351379395
Epoch: 26, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.533 Vali Acc: 0.750 Test Loss: 0.533 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749995).  Saving model ...
Epoch: 27 cost time: 1.5556561946868896
Epoch: 27, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
Validation loss decreased (-0.749995 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.5529072284698486
Epoch: 28, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.523 Vali Acc: 0.770 Test Loss: 0.523 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.498981237411499
Epoch: 29, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.521 Vali Acc: 0.770 Test Loss: 0.521 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4293038845062256
Epoch: 30, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4351842403411865
Epoch: 31, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.577 Vali Acc: 0.796 Test Loss: 0.577 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 32 cost time: 1.5253331661224365
Epoch: 32, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.534 Vali Acc: 0.770 Test Loss: 0.534 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4475252628326416
Epoch: 33, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3323540687561035
Epoch: 34, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.535 Vali Acc: 0.757 Test Loss: 0.535 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3586926460266113
Epoch: 35, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4975299835205078
Epoch: 36, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.541 Vali Acc: 0.763 Test Loss: 0.541 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.552513837814331
Epoch: 37, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4433152675628662
Epoch: 38, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.6217429637908936
Epoch: 39, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.3699815273284912
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.577 Vali Acc: 0.796 Test Loss: 0.577 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.5613653659820557
Epoch: 41, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.550 Vali Acc: 0.763 Test Loss: 0.550 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 423592
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.561244010925293
Epoch: 1, Steps: 10 | Train Loss: 1.452 Vali Loss: 1.431 Vali Acc: 0.322 Test Loss: 1.431 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 1.4348547458648682
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.351 Vali Acc: 0.414 Test Loss: 1.351 Test Acc: 0.414
Validation loss decreased (-0.322354 --> -0.414460).  Saving model ...
Epoch: 3 cost time: 1.3275446891784668
Epoch: 3, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.317 Vali Acc: 0.434 Test Loss: 1.317 Test Acc: 0.434
Validation loss decreased (-0.414460 --> -0.434197).  Saving model ...
Epoch: 4 cost time: 1.6757657527923584
Epoch: 4, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.285 Vali Acc: 0.480 Test Loss: 1.285 Test Acc: 0.480
Validation loss decreased (-0.434197 --> -0.480250).  Saving model ...
Epoch: 5 cost time: 1.3215458393096924
Epoch: 5, Steps: 10 | Train Loss: 1.236 Vali Loss: 1.239 Vali Acc: 0.493 Test Loss: 1.239 Test Acc: 0.493
Validation loss decreased (-0.480250 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 1.5260403156280518
Epoch: 6, Steps: 10 | Train Loss: 1.126 Vali Loss: 1.191 Vali Acc: 0.559 Test Loss: 1.191 Test Acc: 0.559
Validation loss decreased (-0.493409 --> -0.559199).  Saving model ...
Epoch: 7 cost time: 1.2507038116455078
Epoch: 7, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.127 Vali Acc: 0.559 Test Loss: 1.127 Test Acc: 0.559
Validation loss decreased (-0.559199 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 1.5089130401611328
Epoch: 8, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.068 Vali Acc: 0.599 Test Loss: 1.068 Test Acc: 0.599
Validation loss decreased (-0.559199 --> -0.598674).  Saving model ...
Epoch: 9 cost time: 1.4542977809906006
Epoch: 9, Steps: 10 | Train Loss: 0.888 Vali Loss: 1.006 Vali Acc: 0.638 Test Loss: 1.006 Test Acc: 0.638
Validation loss decreased (-0.598674 --> -0.638148).  Saving model ...
Epoch: 10 cost time: 1.2630865573883057
Epoch: 10, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.946 Vali Acc: 0.599 Test Loss: 0.946 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4305596351623535
Epoch: 11, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.880 Vali Acc: 0.678 Test Loss: 0.880 Test Acc: 0.678
Validation loss decreased (-0.638148 --> -0.677623).  Saving model ...
Epoch: 12 cost time: 1.5279459953308105
Epoch: 12, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.824 Vali Acc: 0.664 Test Loss: 0.824 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3595430850982666
Epoch: 13, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.766 Vali Acc: 0.697 Test Loss: 0.766 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 14 cost time: 1.3379578590393066
Epoch: 14, Steps: 10 | Train Loss: 0.515 Vali Loss: 0.712 Vali Acc: 0.678 Test Loss: 0.712 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5335140228271484
Epoch: 15, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.701 Vali Acc: 0.730 Test Loss: 0.701 Test Acc: 0.730
Validation loss decreased (-0.697361 --> -0.730256).  Saving model ...
Epoch: 16 cost time: 1.379000186920166
Epoch: 16, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.624 Vali Acc: 0.737 Test Loss: 0.624 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 17 cost time: 1.511936902999878
Epoch: 17, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.612 Vali Acc: 0.743 Test Loss: 0.612 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 18 cost time: 1.5041043758392334
Epoch: 18, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.583 Vali Acc: 0.743 Test Loss: 0.583 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 19 cost time: 1.5080819129943848
Epoch: 19, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
Validation loss decreased (-0.743415 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 1.4439377784729004
Epoch: 20, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.557 Vali Acc: 0.757 Test Loss: 0.557 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5895593166351318
Epoch: 21, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5857758522033691
Epoch: 22, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.553 Vali Acc: 0.730 Test Loss: 0.553 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6429598331451416
Epoch: 23, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.573 Vali Acc: 0.750 Test Loss: 0.573 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5458400249481201
Epoch: 24, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.491 Vali Acc: 0.789 Test Loss: 0.491 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789469).  Saving model ...
Epoch: 25 cost time: 1.4941911697387695
Epoch: 25, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4832382202148438
Epoch: 26, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.499 Vali Acc: 0.783 Test Loss: 0.499 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.453869104385376
Epoch: 27, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.503 Vali Acc: 0.763 Test Loss: 0.503 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.4816346168518066
Epoch: 28, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5527300834655762
Epoch: 29, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.502 Vali Acc: 0.776 Test Loss: 0.502 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3388381004333496
Epoch: 30, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.4694187641143799
Epoch: 31, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.520 Vali Acc: 0.789 Test Loss: 0.520 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.930929183959961
Epoch: 32, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.2583844661712646
Epoch: 33, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.525 Vali Acc: 0.803 Test Loss: 0.525 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802626).  Saving model ...
Epoch: 34 cost time: 1.5914692878723145
Epoch: 34, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5229594707489014
Epoch: 35, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.553 Vali Acc: 0.763 Test Loss: 0.553 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.554783582687378
Epoch: 36, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.578916311264038
Epoch: 37, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.809675693511963
Epoch: 38, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.564 Vali Acc: 0.776 Test Loss: 0.564 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.2536187171936035
Epoch: 39, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802626).  Saving model ...
Epoch: 40 cost time: 1.5517761707305908
Epoch: 40, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4768915176391602
Epoch: 41, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.556 Vali Acc: 0.809 Test Loss: 0.556 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809205).  Saving model ...
Epoch: 42 cost time: 1.513836145401001
Epoch: 42, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.580 Vali Acc: 0.789 Test Loss: 0.580 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5305578708648682
Epoch: 43, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.590 Vali Acc: 0.776 Test Loss: 0.590 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.5465445518493652
Epoch: 44, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.573 Vali Acc: 0.796 Test Loss: 0.573 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.597564458847046
Epoch: 45, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.4673104286193848
Epoch: 46, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.597 Vali Acc: 0.783 Test Loss: 0.597 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.21132493019104
Epoch: 47, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.567 Vali Acc: 0.796 Test Loss: 0.567 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.3662757873535156
Epoch: 48, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.576 Vali Acc: 0.803 Test Loss: 0.576 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.4303064346313477
Epoch: 49, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.415649652481079
Epoch: 50, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.277622938156128
Epoch: 51, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.650 Vali Acc: 0.796 Test Loss: 0.650 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 423432
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2117905616760254
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.409 Vali Acc: 0.250 Test Loss: 1.409 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.5456995964050293
Epoch: 2, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.401 Vali Acc: 0.303 Test Loss: 1.401 Test Acc: 0.303
Validation loss decreased (-0.249986 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 1.3187973499298096
Epoch: 3, Steps: 10 | Train Loss: 1.391 Vali Loss: 1.385 Vali Acc: 0.375 Test Loss: 1.385 Test Acc: 0.375
Validation loss decreased (-0.302618 --> -0.374986).  Saving model ...
Epoch: 4 cost time: 1.2687420845031738
Epoch: 4, Steps: 10 | Train Loss: 1.351 Vali Loss: 1.324 Vali Acc: 0.421 Test Loss: 1.324 Test Acc: 0.421
Validation loss decreased (-0.374986 --> -0.421039).  Saving model ...
Epoch: 5 cost time: 1.3689656257629395
Epoch: 5, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.291 Vali Acc: 0.395 Test Loss: 1.291 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5154802799224854
Epoch: 6, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.238 Vali Acc: 0.520 Test Loss: 1.238 Test Acc: 0.520
Validation loss decreased (-0.421039 --> -0.519724).  Saving model ...
Epoch: 7 cost time: 1.5847346782684326
Epoch: 7, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.191 Vali Acc: 0.572 Test Loss: 1.191 Test Acc: 0.572
Validation loss decreased (-0.519724 --> -0.572357).  Saving model ...
Epoch: 8 cost time: 1.4476909637451172
Epoch: 8, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.126 Vali Acc: 0.579 Test Loss: 1.126 Test Acc: 0.579
Validation loss decreased (-0.572357 --> -0.578936).  Saving model ...
Epoch: 9 cost time: 1.2878780364990234
Epoch: 9, Steps: 10 | Train Loss: 0.987 Vali Loss: 1.066 Vali Acc: 0.599 Test Loss: 1.066 Test Acc: 0.599
Validation loss decreased (-0.578936 --> -0.598674).  Saving model ...
Epoch: 10 cost time: 1.4730286598205566
Epoch: 10, Steps: 10 | Train Loss: 0.922 Vali Loss: 1.003 Vali Acc: 0.592 Test Loss: 1.003 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4715898036956787
Epoch: 11, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.943 Vali Acc: 0.638 Test Loss: 0.943 Test Acc: 0.638
Validation loss decreased (-0.598674 --> -0.638148).  Saving model ...
Epoch: 12 cost time: 1.3899683952331543
Epoch: 12, Steps: 10 | Train Loss: 0.731 Vali Loss: 0.878 Vali Acc: 0.632 Test Loss: 0.878 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3104734420776367
Epoch: 13, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.827 Vali Acc: 0.664 Test Loss: 0.827 Test Acc: 0.664
Validation loss decreased (-0.638148 --> -0.664465).  Saving model ...
Epoch: 14 cost time: 1.2622449398040771
Epoch: 14, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.774 Vali Acc: 0.664 Test Loss: 0.774 Test Acc: 0.664
Validation loss decreased (-0.664465 --> -0.664466).  Saving model ...
Epoch: 15 cost time: 1.5503802299499512
Epoch: 15, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.732 Vali Acc: 0.717 Test Loss: 0.732 Test Acc: 0.717
Validation loss decreased (-0.664466 --> -0.717098).  Saving model ...
Epoch: 16 cost time: 1.2755248546600342
Epoch: 16, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.679 Vali Acc: 0.743 Test Loss: 0.679 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 17 cost time: 1.5587732791900635
Epoch: 17, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.657 Vali Acc: 0.704 Test Loss: 0.657 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8061909675598145
Epoch: 18, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.614 Vali Acc: 0.724 Test Loss: 0.614 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.005303144454956
Epoch: 19, Steps: 10 | Train Loss: 0.340 Vali Loss: 0.582 Vali Acc: 0.783 Test Loss: 0.582 Test Acc: 0.783
Validation loss decreased (-0.743414 --> -0.782889).  Saving model ...
Epoch: 20 cost time: 1.6650643348693848
Epoch: 20, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.77463960647583
Epoch: 21, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.556 Vali Acc: 0.743 Test Loss: 0.556 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8868751525878906
Epoch: 22, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 1.5295627117156982
Epoch: 23, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.551 Vali Acc: 0.743 Test Loss: 0.551 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.387495994567871
Epoch: 24, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.563939094543457
Epoch: 25, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.516 Vali Acc: 0.757 Test Loss: 0.516 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.758768081665039
Epoch: 26, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.529 Vali Acc: 0.770 Test Loss: 0.529 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7436466217041016
Epoch: 27, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.510 Vali Acc: 0.770 Test Loss: 0.510 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6900651454925537
Epoch: 28, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.554 Vali Acc: 0.757 Test Loss: 0.554 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.2308404445648193
Epoch: 29, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.299433708190918
Epoch: 30, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.538 Vali Acc: 0.750 Test Loss: 0.538 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.299577236175537
Epoch: 31, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.550 Vali Acc: 0.750 Test Loss: 0.550 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.1488001346588135
Epoch: 32, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.539 Vali Acc: 0.763 Test Loss: 0.539 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 423272
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.595611810684204
Epoch: 1, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.375 Vali Acc: 0.250 Test Loss: 1.375 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.4464244842529297
Epoch: 2, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.356 Vali Acc: 0.362 Test Loss: 1.356 Test Acc: 0.362
Validation loss decreased (-0.249986 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.868138074874878
Epoch: 3, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.337 Vali Acc: 0.368 Test Loss: 1.337 Test Acc: 0.368
Validation loss decreased (-0.361829 --> -0.368408).  Saving model ...
Epoch: 4 cost time: 1.2797362804412842
Epoch: 4, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.310 Vali Acc: 0.447 Test Loss: 1.310 Test Acc: 0.447
Validation loss decreased (-0.368408 --> -0.447355).  Saving model ...
Epoch: 5 cost time: 1.6016592979431152
Epoch: 5, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.287 Vali Acc: 0.520 Test Loss: 1.287 Test Acc: 0.520
Validation loss decreased (-0.447355 --> -0.519724).  Saving model ...
Epoch: 6 cost time: 1.2449500560760498
Epoch: 6, Steps: 10 | Train Loss: 1.251 Vali Loss: 1.245 Vali Acc: 0.520 Test Loss: 1.245 Test Acc: 0.520
Validation loss decreased (-0.519724 --> -0.519724).  Saving model ...
Epoch: 7 cost time: 1.5260863304138184
Epoch: 7, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.197 Vali Acc: 0.572 Test Loss: 1.197 Test Acc: 0.572
Validation loss decreased (-0.519724 --> -0.572356).  Saving model ...
Epoch: 8 cost time: 1.5671913623809814
Epoch: 8, Steps: 10 | Train Loss: 1.130 Vali Loss: 1.153 Vali Acc: 0.592 Test Loss: 1.153 Test Acc: 0.592
Validation loss decreased (-0.572356 --> -0.592094).  Saving model ...
Epoch: 9 cost time: 1.268862247467041
Epoch: 9, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.093 Vali Acc: 0.612 Test Loss: 1.093 Test Acc: 0.612
Validation loss decreased (-0.592094 --> -0.611831).  Saving model ...
Epoch: 10 cost time: 1.3520994186401367
Epoch: 10, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.040 Vali Acc: 0.625 Test Loss: 1.040 Test Acc: 0.625
Validation loss decreased (-0.611831 --> -0.624990).  Saving model ...
Epoch: 11 cost time: 1.618476152420044
Epoch: 11, Steps: 10 | Train Loss: 0.883 Vali Loss: 0.979 Vali Acc: 0.638 Test Loss: 0.979 Test Acc: 0.638
Validation loss decreased (-0.624990 --> -0.638148).  Saving model ...
Epoch: 12 cost time: 1.6333093643188477
Epoch: 12, Steps: 10 | Train Loss: 0.833 Vali Loss: 0.917 Vali Acc: 0.638 Test Loss: 0.917 Test Acc: 0.638
Validation loss decreased (-0.638148 --> -0.638149).  Saving model ...
Epoch: 13 cost time: 1.4665513038635254
Epoch: 13, Steps: 10 | Train Loss: 0.772 Vali Loss: 0.857 Vali Acc: 0.664 Test Loss: 0.857 Test Acc: 0.664
Validation loss decreased (-0.638149 --> -0.664465).  Saving model ...
Epoch: 14 cost time: 1.8667259216308594
Epoch: 14, Steps: 10 | Train Loss: 0.686 Vali Loss: 0.823 Vali Acc: 0.691 Test Loss: 0.823 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690781).  Saving model ...
Epoch: 15 cost time: 1.3598442077636719
Epoch: 15, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.764 Vali Acc: 0.671 Test Loss: 0.764 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4185206890106201
Epoch: 16, Steps: 10 | Train Loss: 0.525 Vali Loss: 0.725 Vali Acc: 0.684 Test Loss: 0.725 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.479013442993164
Epoch: 17, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.683 Vali Acc: 0.711 Test Loss: 0.683 Test Acc: 0.711
Validation loss decreased (-0.690781 --> -0.710519).  Saving model ...
Epoch: 18 cost time: 1.4185285568237305
Epoch: 18, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.655 Vali Acc: 0.717 Test Loss: 0.655 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717099).  Saving model ...
Epoch: 19 cost time: 1.619889497756958
Epoch: 19, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.634 Vali Acc: 0.724 Test Loss: 0.634 Test Acc: 0.724
Validation loss decreased (-0.717099 --> -0.723678).  Saving model ...
Epoch: 20 cost time: 1.273488998413086
Epoch: 20, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.617 Vali Acc: 0.730 Test Loss: 0.617 Test Acc: 0.730
Validation loss decreased (-0.723678 --> -0.730257).  Saving model ...
Epoch: 21 cost time: 1.7140846252441406
Epoch: 21, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.595 Vali Acc: 0.724 Test Loss: 0.595 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.289320945739746
Epoch: 22, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.582 Vali Acc: 0.724 Test Loss: 0.582 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7207589149475098
Epoch: 23, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.600 Vali Acc: 0.737 Test Loss: 0.600 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 24 cost time: 1.3887598514556885
Epoch: 24, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.566 Vali Acc: 0.743 Test Loss: 0.566 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 25 cost time: 1.4181599617004395
Epoch: 25, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 26 cost time: 1.4738500118255615
Epoch: 26, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.562 Vali Acc: 0.743 Test Loss: 0.562 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3930940628051758
Epoch: 27, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.610 Vali Acc: 0.743 Test Loss: 0.610 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2921960353851318
Epoch: 28, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.557 Vali Acc: 0.757 Test Loss: 0.557 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 29 cost time: 1.210463285446167
Epoch: 29, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.566 Vali Acc: 0.737 Test Loss: 0.566 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.575456142425537
Epoch: 30, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.555 Vali Acc: 0.763 Test Loss: 0.555 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 31 cost time: 1.0620293617248535
Epoch: 31, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.544 Vali Acc: 0.743 Test Loss: 0.544 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1948652267456055
Epoch: 32, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.2930548191070557
Epoch: 33, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.562 Vali Acc: 0.750 Test Loss: 0.562 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.3221795558929443
Epoch: 34, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.570 Vali Acc: 0.743 Test Loss: 0.570 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.281904935836792
Epoch: 35, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.562 Vali Acc: 0.757 Test Loss: 0.562 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.4454307556152344
Epoch: 36, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3499140739440918
Epoch: 37, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.573 Vali Acc: 0.776 Test Loss: 0.573 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 38 cost time: 1.2219429016113281
Epoch: 38, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.593 Vali Acc: 0.737 Test Loss: 0.593 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2490484714508057
Epoch: 39, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.586 Vali Acc: 0.737 Test Loss: 0.586 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1506562232971191
Epoch: 40, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.567 Vali Acc: 0.763 Test Loss: 0.567 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.422084093093872
Epoch: 41, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.567 Vali Acc: 0.743 Test Loss: 0.567 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.3207423686981201
Epoch: 42, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.583 Vali Acc: 0.757 Test Loss: 0.583 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.4918243885040283
Epoch: 43, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.605 Vali Acc: 0.750 Test Loss: 0.605 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.484513521194458
Epoch: 44, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.610 Vali Acc: 0.743 Test Loss: 0.610 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.7486066818237305
Epoch: 45, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.620 Vali Acc: 0.757 Test Loss: 0.620 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.5867125988006592
Epoch: 46, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.640 Vali Acc: 0.730 Test Loss: 0.640 Test Acc: 0.730
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.5466291904449463
Epoch: 47, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.648 Vali Acc: 0.750 Test Loss: 0.648 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 257352
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5008392333984375
Epoch: 1, Steps: 10 | Train Loss: 1.479 Vali Loss: 1.417 Vali Acc: 0.250 Test Loss: 1.417 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.5584080219268799
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.397 Vali Acc: 0.309 Test Loss: 1.397 Test Acc: 0.309
Validation loss decreased (-0.249986 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 1.3544576168060303
Epoch: 3, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.380 Vali Acc: 0.329 Test Loss: 1.380 Test Acc: 0.329
Validation loss decreased (-0.309197 --> -0.328934).  Saving model ...
Epoch: 4 cost time: 1.6216461658477783
Epoch: 4, Steps: 10 | Train Loss: 1.341 Vali Loss: 1.343 Vali Acc: 0.388 Test Loss: 1.343 Test Acc: 0.388
Validation loss decreased (-0.328934 --> -0.388144).  Saving model ...
Epoch: 5 cost time: 1.3801910877227783
Epoch: 5, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.323 Vali Acc: 0.421 Test Loss: 1.323 Test Acc: 0.421
Validation loss decreased (-0.388144 --> -0.421039).  Saving model ...
Epoch: 6 cost time: 1.599156379699707
Epoch: 6, Steps: 10 | Train Loss: 1.281 Vali Loss: 1.309 Vali Acc: 0.382 Test Loss: 1.309 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6975688934326172
Epoch: 7, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.269 Vali Acc: 0.454 Test Loss: 1.269 Test Acc: 0.454
Validation loss decreased (-0.421039 --> -0.453935).  Saving model ...
Epoch: 8 cost time: 2.018298625946045
Epoch: 8, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.217 Vali Acc: 0.520 Test Loss: 1.217 Test Acc: 0.520
Validation loss decreased (-0.453935 --> -0.519725).  Saving model ...
Epoch: 9 cost time: 1.8021235466003418
Epoch: 9, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.173 Vali Acc: 0.493 Test Loss: 1.173 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0871143341064453
Epoch: 10, Steps: 10 | Train Loss: 1.017 Vali Loss: 1.122 Vali Acc: 0.553 Test Loss: 1.122 Test Acc: 0.553
Validation loss decreased (-0.519725 --> -0.552620).  Saving model ...
Epoch: 11 cost time: 1.655580759048462
Epoch: 11, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.058 Vali Acc: 0.553 Test Loss: 1.058 Test Acc: 0.553
Validation loss decreased (-0.552620 --> -0.552621).  Saving model ...
Epoch: 12 cost time: 1.5092048645019531
Epoch: 12, Steps: 10 | Train Loss: 0.872 Vali Loss: 1.004 Vali Acc: 0.599 Test Loss: 1.004 Test Acc: 0.599
Validation loss decreased (-0.552621 --> -0.598674).  Saving model ...
Epoch: 13 cost time: 1.6352055072784424
Epoch: 13, Steps: 10 | Train Loss: 0.773 Vali Loss: 0.940 Vali Acc: 0.625 Test Loss: 0.940 Test Acc: 0.625
Validation loss decreased (-0.598674 --> -0.624991).  Saving model ...
Epoch: 14 cost time: 1.4300510883331299
Epoch: 14, Steps: 10 | Train Loss: 0.722 Vali Loss: 0.871 Vali Acc: 0.632 Test Loss: 0.871 Test Acc: 0.632
Validation loss decreased (-0.624991 --> -0.631570).  Saving model ...
Epoch: 15 cost time: 1.3318419456481934
Epoch: 15, Steps: 10 | Train Loss: 0.639 Vali Loss: 0.824 Vali Acc: 0.678 Test Loss: 0.824 Test Acc: 0.678
Validation loss decreased (-0.631570 --> -0.677623).  Saving model ...
Epoch: 16 cost time: 1.3840129375457764
Epoch: 16, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.769 Vali Acc: 0.671 Test Loss: 0.769 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4604530334472656
Epoch: 17, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.723 Vali Acc: 0.684 Test Loss: 0.723 Test Acc: 0.684
Validation loss decreased (-0.677623 --> -0.684203).  Saving model ...
Epoch: 18 cost time: 1.5131289958953857
Epoch: 18, Steps: 10 | Train Loss: 0.483 Vali Loss: 0.691 Vali Acc: 0.697 Test Loss: 0.691 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697362).  Saving model ...
Epoch: 19 cost time: 1.3421683311462402
Epoch: 19, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.673 Vali Acc: 0.704 Test Loss: 0.673 Test Acc: 0.704
Validation loss decreased (-0.697362 --> -0.703941).  Saving model ...
Epoch: 20 cost time: 1.6189212799072266
Epoch: 20, Steps: 10 | Train Loss: 0.387 Vali Loss: 0.641 Vali Acc: 0.717 Test Loss: 0.641 Test Acc: 0.717
Validation loss decreased (-0.703941 --> -0.717099).  Saving model ...
Epoch: 21 cost time: 1.0636539459228516
Epoch: 21, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.626 Vali Acc: 0.730 Test Loss: 0.626 Test Acc: 0.730
Validation loss decreased (-0.717099 --> -0.730257).  Saving model ...
Epoch: 22 cost time: 1.1645121574401855
Epoch: 22, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.607 Vali Acc: 0.730 Test Loss: 0.607 Test Acc: 0.730
Validation loss decreased (-0.730257 --> -0.730257).  Saving model ...
Epoch: 23 cost time: 1.1177537441253662
Epoch: 23, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.609 Vali Acc: 0.717 Test Loss: 0.609 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.4515447616577148
Epoch: 24, Steps: 10 | Train Loss: 0.262 Vali Loss: 0.581 Vali Acc: 0.737 Test Loss: 0.581 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 25 cost time: 1.492926836013794
Epoch: 25, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.563 Vali Acc: 0.737 Test Loss: 0.563 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 26 cost time: 1.4221811294555664
Epoch: 26, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.561 Vali Acc: 0.717 Test Loss: 0.561 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2623679637908936
Epoch: 27, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.557 Vali Acc: 0.730 Test Loss: 0.557 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.453874111175537
Epoch: 28, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.546 Vali Acc: 0.743 Test Loss: 0.546 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743416).  Saving model ...
Epoch: 29 cost time: 1.4173171520233154
Epoch: 29, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.542 Vali Acc: 0.750 Test Loss: 0.542 Test Acc: 0.750
Validation loss decreased (-0.743416 --> -0.749995).  Saving model ...
Epoch: 30 cost time: 1.8754937648773193
Epoch: 30, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.4009149074554443
Epoch: 31, Steps: 10 | Train Loss: 0.147 Vali Loss: 0.547 Vali Acc: 0.750 Test Loss: 0.547 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9719626903533936
Epoch: 32, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.585 Vali Acc: 0.724 Test Loss: 0.585 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3556275367736816
Epoch: 33, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.538 Vali Acc: 0.750 Test Loss: 0.538 Test Acc: 0.750
Validation loss decreased (-0.749995 --> -0.749995).  Saving model ...
Epoch: 34 cost time: 1.4483561515808105
Epoch: 34, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.465446949005127
Epoch: 35, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.541 Vali Acc: 0.757 Test Loss: 0.541 Test Acc: 0.757
Validation loss decreased (-0.749995 --> -0.756574).  Saving model ...
Epoch: 36 cost time: 1.4474091529846191
Epoch: 36, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.547 Vali Acc: 0.750 Test Loss: 0.547 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.3374333381652832
Epoch: 37, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.544 Vali Acc: 0.750 Test Loss: 0.544 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.21164608001709
Epoch: 38, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.552 Vali Acc: 0.757 Test Loss: 0.552 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.4538559913635254
Epoch: 39, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.570 Vali Acc: 0.750 Test Loss: 0.570 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.801295280456543
Epoch: 40, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.546 Vali Acc: 0.757 Test Loss: 0.546 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.6723530292510986
Epoch: 41, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.563 Vali Acc: 0.750 Test Loss: 0.563 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.6215853691101074
Epoch: 42, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.583 Vali Acc: 0.770 Test Loss: 0.583 Test Acc: 0.770
Validation loss decreased (-0.756574 --> -0.769731).  Saving model ...
Epoch: 43 cost time: 1.5542058944702148
Epoch: 43, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.617 Vali Acc: 0.757 Test Loss: 0.617 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.4940295219421387
Epoch: 44, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.578 Vali Acc: 0.770 Test Loss: 0.578 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 45 cost time: 1.7964668273925781
Epoch: 45, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.616 Vali Acc: 0.763 Test Loss: 0.616 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.8435027599334717
Epoch: 46, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.597 Vali Acc: 0.763 Test Loss: 0.597 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.528212547302246
Epoch: 47, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.657 Vali Acc: 0.763 Test Loss: 0.657 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.497361183166504
Epoch: 48, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.628 Vali Acc: 0.776 Test Loss: 0.628 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 49 cost time: 1.6893141269683838
Epoch: 49, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.645 Vali Acc: 0.776 Test Loss: 0.645 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.6439106464385986
Epoch: 50, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.653 Vali Acc: 0.783 Test Loss: 0.653 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782888).  Saving model ...
Epoch: 51 cost time: 1.4188165664672852
Epoch: 51, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.654 Vali Acc: 0.783 Test Loss: 0.654 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.4737904071807861
Epoch: 52, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.2245664596557617
Epoch: 53, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.658 Vali Acc: 0.770 Test Loss: 0.658 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.4490604400634766
Epoch: 54, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.653 Vali Acc: 0.770 Test Loss: 0.653 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.2365028858184814
Epoch: 55, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.638 Vali Acc: 0.789 Test Loss: 0.638 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 56 cost time: 1.2930834293365479
Epoch: 56, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.3891420364379883
Epoch: 57, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.674 Vali Acc: 0.776 Test Loss: 0.674 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.4414844512939453
Epoch: 58, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.727 Vali Acc: 0.776 Test Loss: 0.727 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.243959665298462
Epoch: 59, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.735 Vali Acc: 0.776 Test Loss: 0.735 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.4945952892303467
Epoch: 60, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.684 Vali Acc: 0.776 Test Loss: 0.684 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.8200938701629639
Epoch: 61, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.702 Vali Acc: 0.776 Test Loss: 0.702 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.6786816120147705
Epoch: 62, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.717 Vali Acc: 0.783 Test Loss: 0.717 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.3940956592559814
Epoch: 63, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.716 Vali Acc: 0.770 Test Loss: 0.716 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.4269373416900635
Epoch: 64, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.762 Vali Acc: 0.757 Test Loss: 0.762 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.4057366847991943
Epoch: 65, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.708 Vali Acc: 0.803 Test Loss: 0.708 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802625).  Saving model ...
Epoch: 66 cost time: 1.376166820526123
Epoch: 66, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.739 Vali Acc: 0.770 Test Loss: 0.739 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 1.3442046642303467
Epoch: 67, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.725 Vali Acc: 0.789 Test Loss: 0.725 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 1.7810235023498535
Epoch: 68, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.735 Vali Acc: 0.770 Test Loss: 0.735 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 1.3151423931121826
Epoch: 69, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.745 Vali Acc: 0.770 Test Loss: 0.745 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.5701158046722412
Epoch: 70, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.735 Vali Acc: 0.770 Test Loss: 0.735 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 1.4462449550628662
Epoch: 71, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.735 Vali Acc: 0.789 Test Loss: 0.735 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 1.4517369270324707
Epoch: 72, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.761 Vali Acc: 0.763 Test Loss: 0.761 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 1.3673689365386963
Epoch: 73, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.786 Vali Acc: 0.776 Test Loss: 0.786 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 1.452272653579712
Epoch: 74, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.762 Vali Acc: 0.796 Test Loss: 0.762 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.3306305408477783
Epoch: 75, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.771 Vali Acc: 0.770 Test Loss: 0.771 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 257192
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9450645446777344
Epoch: 1, Steps: 10 | Train Loss: 1.610 Vali Loss: 1.495 Vali Acc: 0.224 Test Loss: 1.495 Test Acc: 0.224
Validation loss decreased (inf --> -0.223669).  Saving model ...
Epoch: 2 cost time: 1.4614942073822021
Epoch: 2, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.413 Vali Acc: 0.243 Test Loss: 1.413 Test Acc: 0.243
Validation loss decreased (-0.223669 --> -0.243407).  Saving model ...
Epoch: 3 cost time: 1.4440233707427979
Epoch: 3, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.400 Vali Acc: 0.316 Test Loss: 1.400 Test Acc: 0.316
Validation loss decreased (-0.243407 --> -0.315775).  Saving model ...
Epoch: 4 cost time: 1.4766080379486084
Epoch: 4, Steps: 10 | Train Loss: 1.367 Vali Loss: 1.373 Vali Acc: 0.309 Test Loss: 1.373 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4013612270355225
Epoch: 5, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.331 Vali Acc: 0.382 Test Loss: 1.331 Test Acc: 0.382
Validation loss decreased (-0.315775 --> -0.381566).  Saving model ...
Epoch: 6 cost time: 1.6029858589172363
Epoch: 6, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.296 Vali Acc: 0.467 Test Loss: 1.296 Test Acc: 0.467
Validation loss decreased (-0.381566 --> -0.467092).  Saving model ...
Epoch: 7 cost time: 1.323610544204712
Epoch: 7, Steps: 10 | Train Loss: 1.238 Vali Loss: 1.252 Vali Acc: 0.487 Test Loss: 1.252 Test Acc: 0.487
Validation loss decreased (-0.467092 --> -0.486830).  Saving model ...
Epoch: 8 cost time: 1.2905218601226807
Epoch: 8, Steps: 10 | Train Loss: 1.194 Vali Loss: 1.221 Vali Acc: 0.493 Test Loss: 1.221 Test Acc: 0.493
Validation loss decreased (-0.486830 --> -0.493409).  Saving model ...
Epoch: 9 cost time: 1.4900693893432617
Epoch: 9, Steps: 10 | Train Loss: 1.093 Vali Loss: 1.162 Vali Acc: 0.553 Test Loss: 1.162 Test Acc: 0.553
Validation loss decreased (-0.493409 --> -0.552620).  Saving model ...
Epoch: 10 cost time: 1.3927865028381348
Epoch: 10, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.114 Vali Acc: 0.539 Test Loss: 1.114 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.476527214050293
Epoch: 11, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.054 Vali Acc: 0.605 Test Loss: 1.054 Test Acc: 0.605
Validation loss decreased (-0.552620 --> -0.605253).  Saving model ...
Epoch: 12 cost time: 1.5806279182434082
Epoch: 12, Steps: 10 | Train Loss: 0.879 Vali Loss: 0.989 Vali Acc: 0.586 Test Loss: 0.989 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4966094493865967
Epoch: 13, Steps: 10 | Train Loss: 0.786 Vali Loss: 0.946 Vali Acc: 0.605 Test Loss: 0.946 Test Acc: 0.605
Validation loss decreased (-0.605253 --> -0.605254).  Saving model ...
Epoch: 14 cost time: 1.758957862854004
Epoch: 14, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.884 Vali Acc: 0.645 Test Loss: 0.884 Test Acc: 0.645
Validation loss decreased (-0.605254 --> -0.644728).  Saving model ...
Epoch: 15 cost time: 1.393474817276001
Epoch: 15, Steps: 10 | Train Loss: 0.691 Vali Loss: 0.844 Vali Acc: 0.638 Test Loss: 0.844 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5479907989501953
Epoch: 16, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.801 Vali Acc: 0.645 Test Loss: 0.801 Test Acc: 0.645
Validation loss decreased (-0.644728 --> -0.644729).  Saving model ...
Epoch: 17 cost time: 1.812021255493164
Epoch: 17, Steps: 10 | Train Loss: 0.576 Vali Loss: 0.775 Vali Acc: 0.678 Test Loss: 0.775 Test Acc: 0.678
Validation loss decreased (-0.644729 --> -0.677624).  Saving model ...
Epoch: 18 cost time: 1.3668005466461182
Epoch: 18, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.722 Vali Acc: 0.671 Test Loss: 0.722 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5654280185699463
Epoch: 19, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.693 Vali Acc: 0.697 Test Loss: 0.693 Test Acc: 0.697
Validation loss decreased (-0.677624 --> -0.697361).  Saving model ...
Epoch: 20 cost time: 1.330268144607544
Epoch: 20, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.685 Vali Acc: 0.678 Test Loss: 0.685 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3345649242401123
Epoch: 21, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.649 Vali Acc: 0.717 Test Loss: 0.649 Test Acc: 0.717
Validation loss decreased (-0.697361 --> -0.717099).  Saving model ...
Epoch: 22 cost time: 1.4349324703216553
Epoch: 22, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.654 Vali Acc: 0.704 Test Loss: 0.654 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5431914329528809
Epoch: 23, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.626 Vali Acc: 0.711 Test Loss: 0.626 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3543689250946045
Epoch: 24, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.638 Vali Acc: 0.724 Test Loss: 0.638 Test Acc: 0.724
Validation loss decreased (-0.717099 --> -0.723678).  Saving model ...
Epoch: 25 cost time: 1.3125014305114746
Epoch: 25, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.606 Vali Acc: 0.743 Test Loss: 0.606 Test Acc: 0.743
Validation loss decreased (-0.723678 --> -0.743415).  Saving model ...
Epoch: 26 cost time: 1.6495778560638428
Epoch: 26, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.602 Vali Acc: 0.743 Test Loss: 0.602 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 27 cost time: 1.3699259757995605
Epoch: 27, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.592 Vali Acc: 0.750 Test Loss: 0.592 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 28 cost time: 1.1388516426086426
Epoch: 28, Steps: 10 | Train Loss: 0.190 Vali Loss: 0.650 Vali Acc: 0.724 Test Loss: 0.650 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.909841537475586
Epoch: 29, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.588 Vali Acc: 0.730 Test Loss: 0.588 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.7292635440826416
Epoch: 30, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.589 Vali Acc: 0.743 Test Loss: 0.589 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7321703433990479
Epoch: 31, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8605468273162842
Epoch: 32, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.578 Vali Acc: 0.737 Test Loss: 0.578 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5044705867767334
Epoch: 33, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.577 Vali Acc: 0.743 Test Loss: 0.577 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.870469570159912
Epoch: 34, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
Validation loss decreased (-0.749994 --> -0.763152).  Saving model ...
Epoch: 35 cost time: 1.3841912746429443
Epoch: 35, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.584 Vali Acc: 0.757 Test Loss: 0.584 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.661071538925171
Epoch: 36, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.582 Vali Acc: 0.757 Test Loss: 0.582 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.6730570793151855
Epoch: 37, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.569 Vali Acc: 0.757 Test Loss: 0.569 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.422424077987671
Epoch: 38, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.581 Vali Acc: 0.763 Test Loss: 0.581 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.5376014709472656
Epoch: 39, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.208899974822998
Epoch: 40, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.606 Vali Acc: 0.743 Test Loss: 0.606 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3093013763427734
Epoch: 41, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.613 Vali Acc: 0.770 Test Loss: 0.613 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 42 cost time: 1.5567567348480225
Epoch: 42, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.622 Vali Acc: 0.750 Test Loss: 0.622 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.6075618267059326
Epoch: 43, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.9298622608184814
Epoch: 44, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.8135530948638916
Epoch: 45, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.634 Vali Acc: 0.743 Test Loss: 0.634 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.5037713050842285
Epoch: 46, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.3303799629211426
Epoch: 47, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.651 Vali Acc: 0.770 Test Loss: 0.651 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.0097579956054688
Epoch: 48, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.671 Vali Acc: 0.763 Test Loss: 0.671 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3823349475860596
Epoch: 49, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.704 Vali Acc: 0.743 Test Loss: 0.704 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.8202886581420898
Epoch: 50, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.707 Vali Acc: 0.750 Test Loss: 0.707 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.355208158493042
Epoch: 51, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.721 Vali Acc: 0.757 Test Loss: 0.721 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 257032
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.358416795730591
Epoch: 1, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.371 Vali Acc: 0.355 Test Loss: 1.371 Test Acc: 0.355
Validation loss decreased (inf --> -0.355249).  Saving model ...
Epoch: 2 cost time: 1.612264633178711
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.353 Vali Acc: 0.316 Test Loss: 1.353 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.234602451324463
Epoch: 3, Steps: 10 | Train Loss: 1.326 Vali Loss: 1.335 Vali Acc: 0.336 Test Loss: 1.335 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6634666919708252
Epoch: 4, Steps: 10 | Train Loss: 1.289 Vali Loss: 1.297 Vali Acc: 0.408 Test Loss: 1.297 Test Acc: 0.408
Validation loss decreased (-0.355249 --> -0.407882).  Saving model ...
Epoch: 5 cost time: 1.506169080734253
Epoch: 5, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.261 Vali Acc: 0.434 Test Loss: 1.261 Test Acc: 0.434
Validation loss decreased (-0.407882 --> -0.434198).  Saving model ...
Epoch: 6 cost time: 1.6423282623291016
Epoch: 6, Steps: 10 | Train Loss: 1.201 Vali Loss: 1.219 Vali Acc: 0.507 Test Loss: 1.219 Test Acc: 0.507
Validation loss decreased (-0.434198 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 1.1364309787750244
Epoch: 7, Steps: 10 | Train Loss: 1.162 Vali Loss: 1.175 Vali Acc: 0.493 Test Loss: 1.175 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.445826530456543
Epoch: 8, Steps: 10 | Train Loss: 1.103 Vali Loss: 1.148 Vali Acc: 0.507 Test Loss: 1.148 Test Acc: 0.507
Validation loss decreased (-0.506567 --> -0.506567).  Saving model ...
Epoch: 9 cost time: 1.4940581321716309
Epoch: 9, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.088 Vali Acc: 0.586 Test Loss: 1.088 Test Acc: 0.586
Validation loss decreased (-0.506567 --> -0.585515).  Saving model ...
Epoch: 10 cost time: 1.6265795230865479
Epoch: 10, Steps: 10 | Train Loss: 0.964 Vali Loss: 1.029 Vali Acc: 0.599 Test Loss: 1.029 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598674).  Saving model ...
Epoch: 11 cost time: 1.5156333446502686
Epoch: 11, Steps: 10 | Train Loss: 0.894 Vali Loss: 1.014 Vali Acc: 0.559 Test Loss: 1.014 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5699548721313477
Epoch: 12, Steps: 10 | Train Loss: 0.829 Vali Loss: 0.950 Vali Acc: 0.678 Test Loss: 0.950 Test Acc: 0.678
Validation loss decreased (-0.598674 --> -0.677622).  Saving model ...
Epoch: 13 cost time: 1.3677668571472168
Epoch: 13, Steps: 10 | Train Loss: 0.750 Vali Loss: 0.889 Vali Acc: 0.671 Test Loss: 0.889 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6419644355773926
Epoch: 14, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.815 Vali Acc: 0.730 Test Loss: 0.815 Test Acc: 0.730
Validation loss decreased (-0.677622 --> -0.730255).  Saving model ...
Epoch: 15 cost time: 1.5892703533172607
Epoch: 15, Steps: 10 | Train Loss: 0.594 Vali Loss: 0.796 Vali Acc: 0.711 Test Loss: 0.796 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9400506019592285
Epoch: 16, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.709 Vali Acc: 0.763 Test Loss: 0.709 Test Acc: 0.763
Validation loss decreased (-0.730255 --> -0.763151).  Saving model ...
Epoch: 17 cost time: 1.4315550327301025
Epoch: 17, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.684 Vali Acc: 0.763 Test Loss: 0.684 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763151).  Saving model ...
Epoch: 18 cost time: 1.6460323333740234
Epoch: 18, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7338571548461914
Epoch: 19, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.603 Vali Acc: 0.770 Test Loss: 0.603 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 20 cost time: 1.42960524559021
Epoch: 20, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.581 Vali Acc: 0.789 Test Loss: 0.581 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 1.7375884056091309
Epoch: 21, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5392158031463623
Epoch: 22, Steps: 10 | Train Loss: 0.299 Vali Loss: 0.546 Vali Acc: 0.796 Test Loss: 0.546 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 23 cost time: 1.434661865234375
Epoch: 23, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.538 Vali Acc: 0.757 Test Loss: 0.538 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7284886837005615
Epoch: 24, Steps: 10 | Train Loss: 0.251 Vali Loss: 0.519 Vali Acc: 0.789 Test Loss: 0.519 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5011391639709473
Epoch: 25, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.517 Vali Acc: 0.789 Test Loss: 0.517 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5457806587219238
Epoch: 26, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 27 cost time: 1.6206042766571045
Epoch: 27, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4956495761871338
Epoch: 28, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 29 cost time: 1.5979466438293457
Epoch: 29, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.6213831901550293
Epoch: 30, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.486 Vali Acc: 0.789 Test Loss: 0.486 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4830431938171387
Epoch: 31, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.482 Vali Acc: 0.803 Test Loss: 0.482 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 32 cost time: 1.5498433113098145
Epoch: 32, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.485 Vali Acc: 0.809 Test Loss: 0.485 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809206).  Saving model ...
Epoch: 33 cost time: 1.5426011085510254
Epoch: 33, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.621795415878296
Epoch: 34, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5308887958526611
Epoch: 35, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.509 Vali Acc: 0.763 Test Loss: 0.509 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.624739408493042
Epoch: 36, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.472 Vali Acc: 0.809 Test Loss: 0.472 Test Acc: 0.809
Validation loss decreased (-0.809206 --> -0.809206).  Saving model ...
Epoch: 37 cost time: 1.4476711750030518
Epoch: 37, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4664201736450195
Epoch: 38, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.487 Vali Acc: 0.809 Test Loss: 0.487 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4804646968841553
Epoch: 39, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2871124744415283
Epoch: 40, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3508200645446777
Epoch: 41, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.505 Vali Acc: 0.776 Test Loss: 0.505 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.4778640270233154
Epoch: 42, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.7003002166748047
Epoch: 43, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.529 Vali Acc: 0.803 Test Loss: 0.529 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.2880940437316895
Epoch: 44, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.3597323894500732
Epoch: 45, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.545 Vali Acc: 0.796 Test Loss: 0.545 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.7212929725646973
Epoch: 46, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.560 Vali Acc: 0.789 Test Loss: 0.560 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 256872
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.615694999694824
Epoch: 1, Steps: 10 | Train Loss: 1.483 Vali Loss: 1.413 Vali Acc: 0.276 Test Loss: 1.413 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.4288480281829834
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.370 Vali Acc: 0.329 Test Loss: 1.370 Test Acc: 0.329
Validation loss decreased (-0.276302 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.2904636859893799
Epoch: 3, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.369 Vali Acc: 0.303 Test Loss: 1.369 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3078887462615967
Epoch: 4, Steps: 10 | Train Loss: 1.327 Vali Loss: 1.334 Vali Acc: 0.342 Test Loss: 1.334 Test Acc: 0.342
Validation loss decreased (-0.328934 --> -0.342092).  Saving model ...
Epoch: 5 cost time: 1.3772883415222168
Epoch: 5, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.301 Vali Acc: 0.428 Test Loss: 1.301 Test Acc: 0.428
Validation loss decreased (-0.342092 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 1.631906509399414
Epoch: 6, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.276 Vali Acc: 0.500 Test Loss: 1.276 Test Acc: 0.500
Validation loss decreased (-0.427619 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.5073974132537842
Epoch: 7, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.253 Vali Acc: 0.487 Test Loss: 1.253 Test Acc: 0.487
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.595384120941162
Epoch: 8, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.213 Vali Acc: 0.500 Test Loss: 1.213 Test Acc: 0.500
Validation loss decreased (-0.499987 --> -0.499988).  Saving model ...
Epoch: 9 cost time: 1.3516666889190674
Epoch: 9, Steps: 10 | Train Loss: 1.104 Vali Loss: 1.171 Vali Acc: 0.546 Test Loss: 1.171 Test Acc: 0.546
Validation loss decreased (-0.499988 --> -0.546041).  Saving model ...
Epoch: 10 cost time: 1.1576831340789795
Epoch: 10, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.128 Vali Acc: 0.566 Test Loss: 1.128 Test Acc: 0.566
Validation loss decreased (-0.546041 --> -0.565778).  Saving model ...
Epoch: 11 cost time: 1.15653395652771
Epoch: 11, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.089 Vali Acc: 0.599 Test Loss: 1.089 Test Acc: 0.599
Validation loss decreased (-0.565778 --> -0.598673).  Saving model ...
Epoch: 12 cost time: 1.1333622932434082
Epoch: 12, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.046 Vali Acc: 0.592 Test Loss: 1.046 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2192623615264893
Epoch: 13, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.001 Vali Acc: 0.645 Test Loss: 1.001 Test Acc: 0.645
Validation loss decreased (-0.598673 --> -0.644727).  Saving model ...
Epoch: 14 cost time: 1.8889153003692627
Epoch: 14, Steps: 10 | Train Loss: 0.787 Vali Loss: 0.956 Vali Acc: 0.638 Test Loss: 0.956 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3228604793548584
Epoch: 15, Steps: 10 | Train Loss: 0.725 Vali Loss: 0.914 Vali Acc: 0.632 Test Loss: 0.914 Test Acc: 0.632
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6134190559387207
Epoch: 16, Steps: 10 | Train Loss: 0.674 Vali Loss: 0.888 Vali Acc: 0.678 Test Loss: 0.888 Test Acc: 0.678
Validation loss decreased (-0.644727 --> -0.677623).  Saving model ...
Epoch: 17 cost time: 1.5939321517944336
Epoch: 17, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.846 Vali Acc: 0.645 Test Loss: 0.846 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2871105670928955
Epoch: 18, Steps: 10 | Train Loss: 0.580 Vali Loss: 0.810 Vali Acc: 0.691 Test Loss: 0.810 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690781).  Saving model ...
Epoch: 19 cost time: 1.2662789821624756
Epoch: 19, Steps: 10 | Train Loss: 0.513 Vali Loss: 0.765 Vali Acc: 0.691 Test Loss: 0.765 Test Acc: 0.691
Validation loss decreased (-0.690781 --> -0.690782).  Saving model ...
Epoch: 20 cost time: 1.7254774570465088
Epoch: 20, Steps: 10 | Train Loss: 0.457 Vali Loss: 0.765 Vali Acc: 0.658 Test Loss: 0.765 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4944772720336914
Epoch: 21, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.727 Vali Acc: 0.737 Test Loss: 0.727 Test Acc: 0.737
Validation loss decreased (-0.690782 --> -0.736835).  Saving model ...
Epoch: 22 cost time: 1.661789894104004
Epoch: 22, Steps: 10 | Train Loss: 0.366 Vali Loss: 0.712 Vali Acc: 0.697 Test Loss: 0.712 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.512765645980835
Epoch: 23, Steps: 10 | Train Loss: 0.370 Vali Loss: 0.694 Vali Acc: 0.704 Test Loss: 0.694 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5782251358032227
Epoch: 24, Steps: 10 | Train Loss: 0.313 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.813171148300171
Epoch: 25, Steps: 10 | Train Loss: 0.286 Vali Loss: 0.664 Vali Acc: 0.697 Test Loss: 0.664 Test Acc: 0.697
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.459181547164917
Epoch: 26, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.648 Vali Acc: 0.724 Test Loss: 0.648 Test Acc: 0.724
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.311180830001831
Epoch: 27, Steps: 10 | Train Loss: 0.247 Vali Loss: 0.636 Vali Acc: 0.724 Test Loss: 0.636 Test Acc: 0.724
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6694550514221191
Epoch: 28, Steps: 10 | Train Loss: 0.220 Vali Loss: 0.628 Vali Acc: 0.711 Test Loss: 0.628 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.3792977333068848
Epoch: 29, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.620 Vali Acc: 0.737 Test Loss: 0.620 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 30 cost time: 1.5791990756988525
Epoch: 30, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.625 Vali Acc: 0.737 Test Loss: 0.625 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.8479771614074707
Epoch: 31, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.626 Vali Acc: 0.730 Test Loss: 0.626 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.95670747756958
Epoch: 32, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.636 Vali Acc: 0.737 Test Loss: 0.636 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.4970829486846924
Epoch: 33, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.639 Vali Acc: 0.743 Test Loss: 0.639 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 34 cost time: 1.2007758617401123
Epoch: 34, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.625 Vali Acc: 0.743 Test Loss: 0.625 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 35 cost time: 1.3351962566375732
Epoch: 35, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.616 Vali Acc: 0.750 Test Loss: 0.616 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 36 cost time: 1.308279037475586
Epoch: 36, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5638747215270996
Epoch: 37, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 2.132721185684204
Epoch: 38, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.624 Vali Acc: 0.737 Test Loss: 0.624 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.9496328830718994
Epoch: 39, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.621 Vali Acc: 0.757 Test Loss: 0.621 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 40 cost time: 1.435119867324829
Epoch: 40, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.634 Vali Acc: 0.750 Test Loss: 0.634 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.4637396335601807
Epoch: 41, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.626 Vali Acc: 0.750 Test Loss: 0.626 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.3851921558380127
Epoch: 42, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.631 Vali Acc: 0.750 Test Loss: 0.631 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.53676176071167
Epoch: 43, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.635 Vali Acc: 0.750 Test Loss: 0.635 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.31951904296875
Epoch: 44, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.644 Vali Acc: 0.763 Test Loss: 0.644 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763151).  Saving model ...
Epoch: 45 cost time: 1.5571322441101074
Epoch: 45, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.697 Vali Acc: 0.776 Test Loss: 0.697 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776309).  Saving model ...
Epoch: 46 cost time: 1.5229418277740479
Epoch: 46, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.663 Vali Acc: 0.763 Test Loss: 0.663 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.4042510986328125
Epoch: 47, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.654 Vali Acc: 0.770 Test Loss: 0.654 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.438884973526001
Epoch: 48, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.670 Vali Acc: 0.770 Test Loss: 0.670 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.3679535388946533
Epoch: 49, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.665 Vali Acc: 0.783 Test Loss: 0.665 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 50 cost time: 1.537829875946045
Epoch: 50, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.673 Vali Acc: 0.776 Test Loss: 0.673 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.5000524520874023
Epoch: 51, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 52 cost time: 1.5616536140441895
Epoch: 52, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.685 Vali Acc: 0.763 Test Loss: 0.685 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.817946434020996
Epoch: 53, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.721 Vali Acc: 0.770 Test Loss: 0.721 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.532651424407959
Epoch: 54, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.687 Vali Acc: 0.763 Test Loss: 0.687 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.83902907371521
Epoch: 55, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.720 Vali Acc: 0.783 Test Loss: 0.720 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.555457592010498
Epoch: 56, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.689 Vali Acc: 0.796 Test Loss: 0.689 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796046).  Saving model ...
Epoch: 57 cost time: 1.3887722492218018
Epoch: 57, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.722 Vali Acc: 0.789 Test Loss: 0.722 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 1.5195338726043701
Epoch: 58, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.726 Vali Acc: 0.783 Test Loss: 0.726 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.5709435939788818
Epoch: 59, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.724 Vali Acc: 0.783 Test Loss: 0.724 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.4333083629608154
Epoch: 60, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.728 Vali Acc: 0.776 Test Loss: 0.728 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.6107380390167236
Epoch: 61, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.768 Vali Acc: 0.776 Test Loss: 0.768 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 1.2417142391204834
Epoch: 62, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.3094875812530518
Epoch: 63, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.756 Vali Acc: 0.776 Test Loss: 0.756 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 1.3146450519561768
Epoch: 64, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.762 Vali Acc: 0.776 Test Loss: 0.762 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 1.4049124717712402
Epoch: 65, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.756 Vali Acc: 0.776 Test Loss: 0.756 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 1.2443199157714844
Epoch: 66, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.754 Vali Acc: 0.789 Test Loss: 0.754 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 174152
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.923208236694336
Epoch: 1, Steps: 10 | Train Loss: 1.545 Vali Loss: 1.527 Vali Acc: 0.230 Test Loss: 1.527 Test Acc: 0.230
Validation loss decreased (inf --> -0.230248).  Saving model ...
Epoch: 2 cost time: 1.3018860816955566
Epoch: 2, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.429 Vali Acc: 0.270 Test Loss: 1.429 Test Acc: 0.270
Validation loss decreased (-0.230248 --> -0.269723).  Saving model ...
Epoch: 3 cost time: 1.2003357410430908
Epoch: 3, Steps: 10 | Train Loss: 1.446 Vali Loss: 1.399 Vali Acc: 0.289 Test Loss: 1.399 Test Acc: 0.289
Validation loss decreased (-0.269723 --> -0.289460).  Saving model ...
Epoch: 4 cost time: 1.2117340564727783
Epoch: 4, Steps: 10 | Train Loss: 1.381 Vali Loss: 1.366 Vali Acc: 0.257 Test Loss: 1.366 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3437743186950684
Epoch: 5, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.342 Vali Acc: 0.355 Test Loss: 1.342 Test Acc: 0.355
Validation loss decreased (-0.289460 --> -0.355250).  Saving model ...
Epoch: 6 cost time: 1.078324794769287
Epoch: 6, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.327 Vali Acc: 0.408 Test Loss: 1.327 Test Acc: 0.408
Validation loss decreased (-0.355250 --> -0.407881).  Saving model ...
Epoch: 7 cost time: 1.0830576419830322
Epoch: 7, Steps: 10 | Train Loss: 1.271 Vali Loss: 1.285 Vali Acc: 0.428 Test Loss: 1.285 Test Acc: 0.428
Validation loss decreased (-0.407881 --> -0.427619).  Saving model ...
Epoch: 8 cost time: 1.251091718673706
Epoch: 8, Steps: 10 | Train Loss: 1.253 Vali Loss: 1.263 Vali Acc: 0.461 Test Loss: 1.263 Test Acc: 0.461
Validation loss decreased (-0.427619 --> -0.460514).  Saving model ...
Epoch: 9 cost time: 1.554429292678833
Epoch: 9, Steps: 10 | Train Loss: 1.179 Vali Loss: 1.226 Vali Acc: 0.546 Test Loss: 1.226 Test Acc: 0.546
Validation loss decreased (-0.460514 --> -0.546040).  Saving model ...
Epoch: 10 cost time: 1.1481449604034424
Epoch: 10, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.182 Vali Acc: 0.546 Test Loss: 1.182 Test Acc: 0.546
Validation loss decreased (-0.546040 --> -0.546041).  Saving model ...
Epoch: 11 cost time: 1.5996522903442383
Epoch: 11, Steps: 10 | Train Loss: 1.054 Vali Loss: 1.142 Vali Acc: 0.586 Test Loss: 1.142 Test Acc: 0.586
Validation loss decreased (-0.546041 --> -0.585515).  Saving model ...
Epoch: 12 cost time: 1.4733638763427734
Epoch: 12, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.094 Vali Acc: 0.592 Test Loss: 1.094 Test Acc: 0.592
Validation loss decreased (-0.585515 --> -0.592094).  Saving model ...
Epoch: 13 cost time: 1.1528639793395996
Epoch: 13, Steps: 10 | Train Loss: 0.936 Vali Loss: 1.061 Vali Acc: 0.559 Test Loss: 1.061 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2243216037750244
Epoch: 14, Steps: 10 | Train Loss: 0.847 Vali Loss: 1.005 Vali Acc: 0.645 Test Loss: 1.005 Test Acc: 0.645
Validation loss decreased (-0.592094 --> -0.644727).  Saving model ...
Epoch: 15 cost time: 1.1134026050567627
Epoch: 15, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.958 Vali Acc: 0.651 Test Loss: 0.958 Test Acc: 0.651
Validation loss decreased (-0.644727 --> -0.651306).  Saving model ...
Epoch: 16 cost time: 1.1466546058654785
Epoch: 16, Steps: 10 | Train Loss: 0.698 Vali Loss: 0.904 Vali Acc: 0.671 Test Loss: 0.904 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671044).  Saving model ...
Epoch: 17 cost time: 1.5049190521240234
Epoch: 17, Steps: 10 | Train Loss: 0.672 Vali Loss: 0.849 Vali Acc: 0.664 Test Loss: 0.849 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3305535316467285
Epoch: 18, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.801 Vali Acc: 0.684 Test Loss: 0.801 Test Acc: 0.684
Validation loss decreased (-0.671044 --> -0.684203).  Saving model ...
Epoch: 19 cost time: 1.426079511642456
Epoch: 19, Steps: 10 | Train Loss: 0.488 Vali Loss: 0.753 Vali Acc: 0.697 Test Loss: 0.753 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 20 cost time: 1.282696008682251
Epoch: 20, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.710 Vali Acc: 0.691 Test Loss: 0.710 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.181835412979126
Epoch: 21, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.683 Vali Acc: 0.724 Test Loss: 0.683 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 22 cost time: 1.1665771007537842
Epoch: 22, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.650 Vali Acc: 0.737 Test Loss: 0.650 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736836).  Saving model ...
Epoch: 23 cost time: 1.1940178871154785
Epoch: 23, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.618 Vali Acc: 0.724 Test Loss: 0.618 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.249354362487793
Epoch: 24, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.598 Vali Acc: 0.717 Test Loss: 0.598 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5948927402496338
Epoch: 25, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.604 Vali Acc: 0.757 Test Loss: 0.604 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 26 cost time: 1.3305919170379639
Epoch: 26, Steps: 10 | Train Loss: 0.283 Vali Loss: 0.584 Vali Acc: 0.730 Test Loss: 0.584 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.6223986148834229
Epoch: 27, Steps: 10 | Train Loss: 0.289 Vali Loss: 0.573 Vali Acc: 0.750 Test Loss: 0.573 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2076003551483154
Epoch: 28, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.555 Vali Acc: 0.737 Test Loss: 0.555 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2424261569976807
Epoch: 29, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.561 Vali Acc: 0.743 Test Loss: 0.561 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1861693859100342
Epoch: 30, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.544 Vali Acc: 0.770 Test Loss: 0.544 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 31 cost time: 1.3382923603057861
Epoch: 31, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.577 Vali Acc: 0.730 Test Loss: 0.577 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.9604830741882324
Epoch: 32, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.538 Vali Acc: 0.737 Test Loss: 0.538 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.598201036453247
Epoch: 33, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.552 Vali Acc: 0.750 Test Loss: 0.552 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.394219160079956
Epoch: 34, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.530 Vali Acc: 0.750 Test Loss: 0.530 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.1615803241729736
Epoch: 35, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.539 Vali Acc: 0.750 Test Loss: 0.539 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.3767309188842773
Epoch: 36, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.540 Vali Acc: 0.737 Test Loss: 0.540 Test Acc: 0.737
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5296416282653809
Epoch: 37, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.551 Vali Acc: 0.737 Test Loss: 0.551 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.1354005336761475
Epoch: 38, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.564 Vali Acc: 0.743 Test Loss: 0.564 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2621345520019531
Epoch: 39, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.559 Vali Acc: 0.750 Test Loss: 0.559 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.5057623386383057
Epoch: 40, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.564 Vali Acc: 0.743 Test Loss: 0.564 Test Acc: 0.743
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 173992
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7616422176361084
Epoch: 1, Steps: 10 | Train Loss: 1.485 Vali Loss: 1.368 Vali Acc: 0.336 Test Loss: 1.368 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.585198163986206
Epoch: 2, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.356 Vali Acc: 0.316 Test Loss: 1.356 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.732060194015503
Epoch: 3, Steps: 10 | Train Loss: 1.418 Vali Loss: 1.345 Vali Acc: 0.349 Test Loss: 1.345 Test Acc: 0.349
Validation loss decreased (-0.335513 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 1.3908264636993408
Epoch: 4, Steps: 10 | Train Loss: 1.389 Vali Loss: 1.315 Vali Acc: 0.375 Test Loss: 1.315 Test Acc: 0.375
Validation loss decreased (-0.348671 --> -0.374987).  Saving model ...
Epoch: 5 cost time: 1.3686459064483643
Epoch: 5, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.289 Vali Acc: 0.434 Test Loss: 1.289 Test Acc: 0.434
Validation loss decreased (-0.374987 --> -0.434198).  Saving model ...
Epoch: 6 cost time: 1.6567740440368652
Epoch: 6, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.260 Vali Acc: 0.500 Test Loss: 1.260 Test Acc: 0.500
Validation loss decreased (-0.434198 --> -0.499987).  Saving model ...
Epoch: 7 cost time: 1.2340800762176514
Epoch: 7, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.234 Vali Acc: 0.454 Test Loss: 1.234 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5064036846160889
Epoch: 8, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.192 Vali Acc: 0.559 Test Loss: 1.192 Test Acc: 0.559
Validation loss decreased (-0.499987 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 1.3915300369262695
Epoch: 9, Steps: 10 | Train Loss: 1.190 Vali Loss: 1.151 Vali Acc: 0.618 Test Loss: 1.151 Test Acc: 0.618
Validation loss decreased (-0.559199 --> -0.618410).  Saving model ...
Epoch: 10 cost time: 1.4736688137054443
Epoch: 10, Steps: 10 | Train Loss: 1.129 Vali Loss: 1.114 Vali Acc: 0.612 Test Loss: 1.114 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.264481544494629
Epoch: 11, Steps: 10 | Train Loss: 1.057 Vali Loss: 1.062 Vali Acc: 0.638 Test Loss: 1.062 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638147).  Saving model ...
Epoch: 12 cost time: 1.2211425304412842
Epoch: 12, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.019 Vali Acc: 0.632 Test Loss: 1.019 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2369070053100586
Epoch: 13, Steps: 10 | Train Loss: 0.952 Vali Loss: 0.958 Vali Acc: 0.658 Test Loss: 0.958 Test Acc: 0.658
Validation loss decreased (-0.638147 --> -0.657885).  Saving model ...
Epoch: 14 cost time: 1.4110159873962402
Epoch: 14, Steps: 10 | Train Loss: 0.906 Vali Loss: 0.937 Vali Acc: 0.658 Test Loss: 0.937 Test Acc: 0.658
Validation loss decreased (-0.657885 --> -0.657885).  Saving model ...
Epoch: 15 cost time: 1.5207688808441162
Epoch: 15, Steps: 10 | Train Loss: 0.772 Vali Loss: 0.858 Vali Acc: 0.697 Test Loss: 0.858 Test Acc: 0.697
Validation loss decreased (-0.657885 --> -0.697360).  Saving model ...
Epoch: 16 cost time: 1.6188759803771973
Epoch: 16, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.825 Vali Acc: 0.678 Test Loss: 0.825 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3229024410247803
Epoch: 17, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.772 Vali Acc: 0.717 Test Loss: 0.772 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717098).  Saving model ...
Epoch: 18 cost time: 1.3520665168762207
Epoch: 18, Steps: 10 | Train Loss: 0.610 Vali Loss: 0.735 Vali Acc: 0.704 Test Loss: 0.735 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.186478614807129
Epoch: 19, Steps: 10 | Train Loss: 0.566 Vali Loss: 0.701 Vali Acc: 0.724 Test Loss: 0.701 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723677).  Saving model ...
Epoch: 20 cost time: 1.297666311264038
Epoch: 20, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.671 Vali Acc: 0.717 Test Loss: 0.671 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4259130954742432
Epoch: 21, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.630 Vali Acc: 0.743 Test Loss: 0.630 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 22 cost time: 1.4926085472106934
Epoch: 22, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.628 Vali Acc: 0.717 Test Loss: 0.628 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3369994163513184
Epoch: 23, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.587 Vali Acc: 0.737 Test Loss: 0.587 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4153921604156494
Epoch: 24, Steps: 10 | Train Loss: 0.311 Vali Loss: 0.593 Vali Acc: 0.724 Test Loss: 0.593 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2780377864837646
Epoch: 25, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.575 Vali Acc: 0.737 Test Loss: 0.575 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.34151029586792
Epoch: 26, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.568 Vali Acc: 0.743 Test Loss: 0.568 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 27 cost time: 1.3027420043945312
Epoch: 27, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.559 Vali Acc: 0.743 Test Loss: 0.559 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 28 cost time: 1.4312520027160645
Epoch: 28, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.574 Vali Acc: 0.737 Test Loss: 0.574 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.3589832782745361
Epoch: 29, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.559 Vali Acc: 0.743 Test Loss: 0.559 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 30 cost time: 1.2839837074279785
Epoch: 30, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.586 Vali Acc: 0.724 Test Loss: 0.586 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7645683288574219
Epoch: 31, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.551 Vali Acc: 0.757 Test Loss: 0.551 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 32 cost time: 1.461425542831421
Epoch: 32, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.579 Vali Acc: 0.750 Test Loss: 0.579 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3386027812957764
Epoch: 33, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.544 Vali Acc: 0.750 Test Loss: 0.544 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2762069702148438
Epoch: 34, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.549 Vali Acc: 0.750 Test Loss: 0.549 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.235689401626587
Epoch: 35, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.555 Vali Acc: 0.763 Test Loss: 0.555 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 36 cost time: 1.3380999565124512
Epoch: 36, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.558 Vali Acc: 0.763 Test Loss: 0.558 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1641960144042969
Epoch: 37, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.587 Vali Acc: 0.763 Test Loss: 0.587 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.3406579494476318
Epoch: 38, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.585 Vali Acc: 0.757 Test Loss: 0.585 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5883822441101074
Epoch: 39, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.603 Vali Acc: 0.763 Test Loss: 0.603 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3984770774841309
Epoch: 40, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.249610424041748
Epoch: 41, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.595 Vali Acc: 0.757 Test Loss: 0.595 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.3206264972686768
Epoch: 42, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 43 cost time: 1.341799020767212
Epoch: 43, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.616 Vali Acc: 0.770 Test Loss: 0.616 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.8712670803070068
Epoch: 44, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.618 Vali Acc: 0.770 Test Loss: 0.618 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.3786287307739258
Epoch: 45, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.645 Vali Acc: 0.757 Test Loss: 0.645 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.306502342224121
Epoch: 46, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.648 Vali Acc: 0.770 Test Loss: 0.648 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.6606860160827637
Epoch: 47, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.643 Vali Acc: 0.763 Test Loss: 0.643 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.398103952407837
Epoch: 48, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.664 Vali Acc: 0.783 Test Loss: 0.664 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782888).  Saving model ...
Epoch: 49 cost time: 1.754465103149414
Epoch: 49, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.666 Vali Acc: 0.776 Test Loss: 0.666 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.505767583847046
Epoch: 50, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.716 Vali Acc: 0.776 Test Loss: 0.716 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.6372060775756836
Epoch: 51, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.737 Vali Acc: 0.783 Test Loss: 0.737 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.170109510421753
Epoch: 52, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.705 Vali Acc: 0.763 Test Loss: 0.705 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.5172092914581299
Epoch: 53, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.726 Vali Acc: 0.750 Test Loss: 0.726 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.2838847637176514
Epoch: 54, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.704 Vali Acc: 0.789 Test Loss: 0.704 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789467).  Saving model ...
Epoch: 55 cost time: 1.385833740234375
Epoch: 55, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.687 Vali Acc: 0.809 Test Loss: 0.687 Test Acc: 0.809
Validation loss decreased (-0.789467 --> -0.809204).  Saving model ...
Epoch: 56 cost time: 1.2850406169891357
Epoch: 56, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.709 Vali Acc: 0.776 Test Loss: 0.709 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.7443547248840332
Epoch: 57, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.720 Vali Acc: 0.803 Test Loss: 0.720 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.3061230182647705
Epoch: 58, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.723 Vali Acc: 0.809 Test Loss: 0.723 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.3571126461029053
Epoch: 59, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.752 Vali Acc: 0.770 Test Loss: 0.752 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.4373438358306885
Epoch: 60, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.723 Vali Acc: 0.809 Test Loss: 0.723 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.3589301109313965
Epoch: 61, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.746 Vali Acc: 0.803 Test Loss: 0.746 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.2447574138641357
Epoch: 62, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.742 Vali Acc: 0.803 Test Loss: 0.742 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.3296105861663818
Epoch: 63, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.726 Vali Acc: 0.796 Test Loss: 0.726 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 1.4368765354156494
Epoch: 64, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.732 Vali Acc: 0.796 Test Loss: 0.732 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 1.371042251586914
Epoch: 65, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.758 Vali Acc: 0.776 Test Loss: 0.758 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 173832
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.256450891494751
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.386 Vali Acc: 0.283 Test Loss: 1.386 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.2547214031219482
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.359 Vali Acc: 0.342 Test Loss: 1.359 Test Acc: 0.342
Validation loss decreased (-0.282881 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.3689160346984863
Epoch: 3, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.350 Vali Acc: 0.329 Test Loss: 1.350 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.430016279220581
Epoch: 4, Steps: 10 | Train Loss: 1.338 Vali Loss: 1.320 Vali Acc: 0.395 Test Loss: 1.320 Test Acc: 0.395
Validation loss decreased (-0.342092 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 1.1033310890197754
Epoch: 5, Steps: 10 | Train Loss: 1.303 Vali Loss: 1.291 Vali Acc: 0.414 Test Loss: 1.291 Test Acc: 0.414
Validation loss decreased (-0.394724 --> -0.414461).  Saving model ...
Epoch: 6 cost time: 1.2069811820983887
Epoch: 6, Steps: 10 | Train Loss: 1.263 Vali Loss: 1.265 Vali Acc: 0.428 Test Loss: 1.265 Test Acc: 0.428
Validation loss decreased (-0.414461 --> -0.427619).  Saving model ...
Epoch: 7 cost time: 1.4696917533874512
Epoch: 7, Steps: 10 | Train Loss: 1.232 Vali Loss: 1.236 Vali Acc: 0.474 Test Loss: 1.236 Test Acc: 0.474
Validation loss decreased (-0.427619 --> -0.473672).  Saving model ...
Epoch: 8 cost time: 1.2077665328979492
Epoch: 8, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.192 Vali Acc: 0.539 Test Loss: 1.192 Test Acc: 0.539
Validation loss decreased (-0.473672 --> -0.539462).  Saving model ...
Epoch: 9 cost time: 1.3209316730499268
Epoch: 9, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.169 Vali Acc: 0.553 Test Loss: 1.169 Test Acc: 0.553
Validation loss decreased (-0.539462 --> -0.552620).  Saving model ...
Epoch: 10 cost time: 1.227832317352295
Epoch: 10, Steps: 10 | Train Loss: 1.050 Vali Loss: 1.110 Vali Acc: 0.605 Test Loss: 1.110 Test Acc: 0.605
Validation loss decreased (-0.552620 --> -0.605252).  Saving model ...
Epoch: 11 cost time: 1.1630053520202637
Epoch: 11, Steps: 10 | Train Loss: 1.007 Vali Loss: 1.068 Vali Acc: 0.605 Test Loss: 1.068 Test Acc: 0.605
Validation loss decreased (-0.605252 --> -0.605252).  Saving model ...
Epoch: 12 cost time: 1.3280987739562988
Epoch: 12, Steps: 10 | Train Loss: 0.914 Vali Loss: 1.023 Vali Acc: 0.618 Test Loss: 1.023 Test Acc: 0.618
Validation loss decreased (-0.605252 --> -0.618411).  Saving model ...
Epoch: 13 cost time: 1.2646849155426025
Epoch: 13, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.973 Vali Acc: 0.632 Test Loss: 0.973 Test Acc: 0.632
Validation loss decreased (-0.618411 --> -0.631569).  Saving model ...
Epoch: 14 cost time: 1.0424063205718994
Epoch: 14, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.919 Vali Acc: 0.632 Test Loss: 0.919 Test Acc: 0.632
Validation loss decreased (-0.631569 --> -0.631570).  Saving model ...
Epoch: 15 cost time: 1.0362532138824463
Epoch: 15, Steps: 10 | Train Loss: 0.696 Vali Loss: 0.871 Vali Acc: 0.645 Test Loss: 0.871 Test Acc: 0.645
Validation loss decreased (-0.631570 --> -0.644728).  Saving model ...
Epoch: 16 cost time: 1.2171931266784668
Epoch: 16, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.831 Vali Acc: 0.664 Test Loss: 0.831 Test Acc: 0.664
Validation loss decreased (-0.644728 --> -0.664465).  Saving model ...
Epoch: 17 cost time: 1.296968698501587
Epoch: 17, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.781 Vali Acc: 0.678 Test Loss: 0.781 Test Acc: 0.678
Validation loss decreased (-0.664465 --> -0.677624).  Saving model ...
Epoch: 18 cost time: 1.1321649551391602
Epoch: 18, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.737 Vali Acc: 0.671 Test Loss: 0.737 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3376379013061523
Epoch: 19, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.699 Vali Acc: 0.678 Test Loss: 0.699 Test Acc: 0.678
Validation loss decreased (-0.677624 --> -0.677625).  Saving model ...
Epoch: 20 cost time: 1.047081708908081
Epoch: 20, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.674 Vali Acc: 0.684 Test Loss: 0.674 Test Acc: 0.684
Validation loss decreased (-0.677625 --> -0.684204).  Saving model ...
Epoch: 21 cost time: 1.0420119762420654
Epoch: 21, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.644 Vali Acc: 0.684 Test Loss: 0.644 Test Acc: 0.684
Validation loss decreased (-0.684204 --> -0.684204).  Saving model ...
Epoch: 22 cost time: 1.3579723834991455
Epoch: 22, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.620 Vali Acc: 0.737 Test Loss: 0.620 Test Acc: 0.737
Validation loss decreased (-0.684204 --> -0.736836).  Saving model ...
Epoch: 23 cost time: 1.3187618255615234
Epoch: 23, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.583 Vali Acc: 0.743 Test Loss: 0.583 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743415).  Saving model ...
Epoch: 24 cost time: 1.0274951457977295
Epoch: 24, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763152).  Saving model ...
Epoch: 25 cost time: 1.2470793724060059
Epoch: 25, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.554 Vali Acc: 0.737 Test Loss: 0.554 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.220015525817871
Epoch: 26, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.559 Vali Acc: 0.737 Test Loss: 0.559 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0032448768615723
Epoch: 27, Steps: 10 | Train Loss: 0.216 Vali Loss: 0.543 Vali Acc: 0.750 Test Loss: 0.543 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2839767932891846
Epoch: 28, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.528 Vali Acc: 0.757 Test Loss: 0.528 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2175188064575195
Epoch: 29, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 30 cost time: 1.1435935497283936
Epoch: 30, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.532 Vali Acc: 0.770 Test Loss: 0.532 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 31 cost time: 1.2554965019226074
Epoch: 31, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.532 Vali Acc: 0.757 Test Loss: 0.532 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3699588775634766
Epoch: 32, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.514 Vali Acc: 0.757 Test Loss: 0.514 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.48258376121521
Epoch: 33, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.529 Vali Acc: 0.757 Test Loss: 0.529 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4296486377716064
Epoch: 34, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.523 Vali Acc: 0.750 Test Loss: 0.523 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2920639514923096
Epoch: 35, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.532 Vali Acc: 0.743 Test Loss: 0.532 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2514517307281494
Epoch: 36, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.532 Vali Acc: 0.763 Test Loss: 0.532 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.2038366794586182
Epoch: 37, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.560 Vali Acc: 0.770 Test Loss: 0.560 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.2093172073364258
Epoch: 38, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.569 Vali Acc: 0.757 Test Loss: 0.569 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.3599162101745605
Epoch: 39, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.588 Vali Acc: 0.750 Test Loss: 0.588 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.1036245822906494
Epoch: 40, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.584 Vali Acc: 0.770 Test Loss: 0.584 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 173672
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7410507202148438
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.421 Vali Acc: 0.276 Test Loss: 1.421 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.5218827724456787
Epoch: 2, Steps: 10 | Train Loss: 1.419 Vali Loss: 1.391 Vali Acc: 0.257 Test Loss: 1.391 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3038558959960938
Epoch: 3, Steps: 10 | Train Loss: 1.416 Vali Loss: 1.379 Vali Acc: 0.322 Test Loss: 1.379 Test Acc: 0.322
Validation loss decreased (-0.276302 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 1.2813794612884521
Epoch: 4, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.363 Vali Acc: 0.316 Test Loss: 1.363 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2254037857055664
Epoch: 5, Steps: 10 | Train Loss: 1.345 Vali Loss: 1.338 Vali Acc: 0.362 Test Loss: 1.338 Test Acc: 0.362
Validation loss decreased (-0.322355 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 1.1919164657592773
Epoch: 6, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.311 Vali Acc: 0.362 Test Loss: 1.311 Test Acc: 0.362
Validation loss decreased (-0.361829 --> -0.361829).  Saving model ...
Epoch: 7 cost time: 1.328413963317871
Epoch: 7, Steps: 10 | Train Loss: 1.290 Vali Loss: 1.292 Vali Acc: 0.368 Test Loss: 1.292 Test Acc: 0.368
Validation loss decreased (-0.361829 --> -0.368408).  Saving model ...
Epoch: 8 cost time: 1.2717268466949463
Epoch: 8, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.259 Vali Acc: 0.454 Test Loss: 1.259 Test Acc: 0.454
Validation loss decreased (-0.368408 --> -0.453935).  Saving model ...
Epoch: 9 cost time: 1.4744791984558105
Epoch: 9, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.227 Vali Acc: 0.461 Test Loss: 1.227 Test Acc: 0.461
Validation loss decreased (-0.453935 --> -0.460514).  Saving model ...
Epoch: 10 cost time: 1.2154500484466553
Epoch: 10, Steps: 10 | Train Loss: 1.149 Vali Loss: 1.194 Vali Acc: 0.520 Test Loss: 1.194 Test Acc: 0.520
Validation loss decreased (-0.460514 --> -0.519725).  Saving model ...
Epoch: 11 cost time: 1.3891451358795166
Epoch: 11, Steps: 10 | Train Loss: 1.102 Vali Loss: 1.153 Vali Acc: 0.533 Test Loss: 1.153 Test Acc: 0.533
Validation loss decreased (-0.519725 --> -0.532883).  Saving model ...
Epoch: 12 cost time: 1.1218397617340088
Epoch: 12, Steps: 10 | Train Loss: 1.028 Vali Loss: 1.109 Vali Acc: 0.546 Test Loss: 1.109 Test Acc: 0.546
Validation loss decreased (-0.532883 --> -0.546042).  Saving model ...
Epoch: 13 cost time: 1.0967035293579102
Epoch: 13, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.061 Vali Acc: 0.526 Test Loss: 1.061 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2043721675872803
Epoch: 14, Steps: 10 | Train Loss: 0.935 Vali Loss: 1.018 Vali Acc: 0.605 Test Loss: 1.018 Test Acc: 0.605
Validation loss decreased (-0.546042 --> -0.605253).  Saving model ...
Epoch: 15 cost time: 1.1930289268493652
Epoch: 15, Steps: 10 | Train Loss: 0.862 Vali Loss: 0.973 Vali Acc: 0.559 Test Loss: 0.973 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4199118614196777
Epoch: 16, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.926 Vali Acc: 0.632 Test Loss: 0.926 Test Acc: 0.632
Validation loss decreased (-0.605253 --> -0.631570).  Saving model ...
Epoch: 17 cost time: 1.3560690879821777
Epoch: 17, Steps: 10 | Train Loss: 0.704 Vali Loss: 0.877 Vali Acc: 0.618 Test Loss: 0.877 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.44077730178833
Epoch: 18, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.831 Vali Acc: 0.625 Test Loss: 0.831 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6776118278503418
Epoch: 19, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.806 Vali Acc: 0.691 Test Loss: 0.806 Test Acc: 0.691
Validation loss decreased (-0.631570 --> -0.690781).  Saving model ...
Epoch: 20 cost time: 1.2835235595703125
Epoch: 20, Steps: 10 | Train Loss: 0.546 Vali Loss: 0.749 Vali Acc: 0.664 Test Loss: 0.749 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4028701782226562
Epoch: 21, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.713 Vali Acc: 0.678 Test Loss: 0.713 Test Acc: 0.678
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.26633882522583
Epoch: 22, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.694 Vali Acc: 0.737 Test Loss: 0.694 Test Acc: 0.737
Validation loss decreased (-0.690781 --> -0.736835).  Saving model ...
Epoch: 23 cost time: 1.2456588745117188
Epoch: 23, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.661 Vali Acc: 0.691 Test Loss: 0.661 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2630388736724854
Epoch: 24, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.634 Vali Acc: 0.704 Test Loss: 0.634 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.783405065536499
Epoch: 25, Steps: 10 | Train Loss: 0.354 Vali Loss: 0.620 Vali Acc: 0.704 Test Loss: 0.620 Test Acc: 0.704
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3317527770996094
Epoch: 26, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.598 Vali Acc: 0.711 Test Loss: 0.598 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.264394998550415
Epoch: 27, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.584 Vali Acc: 0.737 Test Loss: 0.584 Test Acc: 0.737
Validation loss decreased (-0.736835 --> -0.736836).  Saving model ...
Epoch: 28 cost time: 1.301461935043335
Epoch: 28, Steps: 10 | Train Loss: 0.277 Vali Loss: 0.569 Vali Acc: 0.750 Test Loss: 0.569 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 29 cost time: 1.3102142810821533
Epoch: 29, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.562 Vali Acc: 0.743 Test Loss: 0.562 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4115231037139893
Epoch: 30, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.568 Vali Acc: 0.743 Test Loss: 0.568 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.7679595947265625
Epoch: 31, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.5323405265808105
Epoch: 32, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.567 Vali Acc: 0.743 Test Loss: 0.567 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.4676988124847412
Epoch: 33, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.560 Vali Acc: 0.750 Test Loss: 0.560 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 34 cost time: 1.3341004848480225
Epoch: 34, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.560 Vali Acc: 0.743 Test Loss: 0.560 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5262088775634766
Epoch: 35, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.562 Vali Acc: 0.743 Test Loss: 0.562 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1440067291259766
Epoch: 36, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.566 Vali Acc: 0.750 Test Loss: 0.566 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.190596342086792
Epoch: 37, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.572 Vali Acc: 0.750 Test Loss: 0.572 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1914458274841309
Epoch: 38, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.574 Vali Acc: 0.743 Test Loss: 0.574 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.4083640575408936
Epoch: 39, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.567 Vali Acc: 0.757 Test Loss: 0.567 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 40 cost time: 1.4298670291900635
Epoch: 40, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.581 Vali Acc: 0.757 Test Loss: 0.581 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.311988115310669
Epoch: 41, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.599 Vali Acc: 0.743 Test Loss: 0.599 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.279590368270874
Epoch: 42, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.588 Vali Acc: 0.750 Test Loss: 0.588 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.177295446395874
Epoch: 43, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.604 Vali Acc: 0.750 Test Loss: 0.604 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.3806610107421875
Epoch: 44, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.305643081665039
Epoch: 45, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.617 Vali Acc: 0.750 Test Loss: 0.617 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.379586935043335
Epoch: 46, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.627 Vali Acc: 0.737 Test Loss: 0.627 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2877092361450195
Epoch: 47, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.636 Vali Acc: 0.750 Test Loss: 0.636 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.271920919418335
Epoch: 48, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.652 Vali Acc: 0.743 Test Loss: 0.652 Test Acc: 0.743
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.2921409606933594
Epoch: 49, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.663 Vali Acc: 0.776 Test Loss: 0.663 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776309).  Saving model ...
Epoch: 50 cost time: 1.1274187564849854
Epoch: 50, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.634 Vali Acc: 0.757 Test Loss: 0.634 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1727831363677979
Epoch: 51, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.646 Vali Acc: 0.757 Test Loss: 0.646 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.2536137104034424
Epoch: 52, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2150161266326904
Epoch: 53, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.659 Vali Acc: 0.757 Test Loss: 0.659 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.428924798965454
Epoch: 54, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.670 Vali Acc: 0.757 Test Loss: 0.670 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.8776330947875977
Epoch: 55, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.679 Vali Acc: 0.743 Test Loss: 0.679 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.2679829597473145
Epoch: 56, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.689 Vali Acc: 0.757 Test Loss: 0.689 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.205930471420288
Epoch: 57, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.683 Vali Acc: 0.763 Test Loss: 0.683 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.3491036891937256
Epoch: 58, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.701 Vali Acc: 0.763 Test Loss: 0.701 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.3690268993377686
Epoch: 59, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.696 Vali Acc: 0.763 Test Loss: 0.696 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 132552
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.017112970352173
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.411 Vali Acc: 0.322 Test Loss: 1.411 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 1.1688218116760254
Epoch: 2, Steps: 10 | Train Loss: 1.403 Vali Loss: 1.379 Vali Acc: 0.336 Test Loss: 1.379 Test Acc: 0.336
Validation loss decreased (-0.322354 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.4416980743408203
Epoch: 3, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.364 Vali Acc: 0.322 Test Loss: 1.364 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.680931806564331
Epoch: 4, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.352 Vali Acc: 0.349 Test Loss: 1.352 Test Acc: 0.349
Validation loss decreased (-0.335513 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 1.2659595012664795
Epoch: 5, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.327 Vali Acc: 0.401 Test Loss: 1.327 Test Acc: 0.401
Validation loss decreased (-0.348671 --> -0.401303).  Saving model ...
Epoch: 6 cost time: 1.3402960300445557
Epoch: 6, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.293 Vali Acc: 0.474 Test Loss: 1.293 Test Acc: 0.474
Validation loss decreased (-0.401303 --> -0.473671).  Saving model ...
Epoch: 7 cost time: 1.2491252422332764
Epoch: 7, Steps: 10 | Train Loss: 1.262 Vali Loss: 1.268 Vali Acc: 0.467 Test Loss: 1.268 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.297895908355713
Epoch: 8, Steps: 10 | Train Loss: 1.220 Vali Loss: 1.242 Vali Acc: 0.493 Test Loss: 1.242 Test Acc: 0.493
Validation loss decreased (-0.473671 --> -0.493409).  Saving model ...
Epoch: 9 cost time: 1.234860897064209
Epoch: 9, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.204 Vali Acc: 0.539 Test Loss: 1.204 Test Acc: 0.539
Validation loss decreased (-0.493409 --> -0.539462).  Saving model ...
Epoch: 10 cost time: 1.0791802406311035
Epoch: 10, Steps: 10 | Train Loss: 1.101 Vali Loss: 1.166 Vali Acc: 0.586 Test Loss: 1.166 Test Acc: 0.586
Validation loss decreased (-0.539462 --> -0.585515).  Saving model ...
Epoch: 11 cost time: 1.2204318046569824
Epoch: 11, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.127 Vali Acc: 0.586 Test Loss: 1.127 Test Acc: 0.586
Validation loss decreased (-0.585515 --> -0.585515).  Saving model ...
Epoch: 12 cost time: 1.5096313953399658
Epoch: 12, Steps: 10 | Train Loss: 0.992 Vali Loss: 1.071 Vali Acc: 0.618 Test Loss: 1.071 Test Acc: 0.618
Validation loss decreased (-0.585515 --> -0.618410).  Saving model ...
Epoch: 13 cost time: 1.3029820919036865
Epoch: 13, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.024 Vali Acc: 0.605 Test Loss: 1.024 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.231473684310913
Epoch: 14, Steps: 10 | Train Loss: 0.862 Vali Loss: 1.011 Vali Acc: 0.599 Test Loss: 1.011 Test Acc: 0.599
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2340738773345947
Epoch: 15, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.937 Vali Acc: 0.632 Test Loss: 0.937 Test Acc: 0.632
Validation loss decreased (-0.618410 --> -0.631570).  Saving model ...
Epoch: 16 cost time: 1.4875328540802002
Epoch: 16, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.875 Vali Acc: 0.638 Test Loss: 0.875 Test Acc: 0.638
Validation loss decreased (-0.631570 --> -0.638149).  Saving model ...
Epoch: 17 cost time: 1.3092920780181885
Epoch: 17, Steps: 10 | Train Loss: 0.667 Vali Loss: 0.839 Vali Acc: 0.658 Test Loss: 0.839 Test Acc: 0.658
Validation loss decreased (-0.638149 --> -0.657886).  Saving model ...
Epoch: 18 cost time: 1.3364429473876953
Epoch: 18, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.792 Vali Acc: 0.711 Test Loss: 0.792 Test Acc: 0.711
Validation loss decreased (-0.657886 --> -0.710518).  Saving model ...
Epoch: 19 cost time: 1.205474615097046
Epoch: 19, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.735 Vali Acc: 0.724 Test Loss: 0.735 Test Acc: 0.724
Validation loss decreased (-0.710518 --> -0.723677).  Saving model ...
Epoch: 20 cost time: 1.2758760452270508
Epoch: 20, Steps: 10 | Train Loss: 0.518 Vali Loss: 0.699 Vali Acc: 0.730 Test Loss: 0.699 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 21 cost time: 1.1642677783966064
Epoch: 21, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.663 Vali Acc: 0.750 Test Loss: 0.663 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749993).  Saving model ...
Epoch: 22 cost time: 1.1942436695098877
Epoch: 22, Steps: 10 | Train Loss: 0.418 Vali Loss: 0.632 Vali Acc: 0.770 Test Loss: 0.632 Test Acc: 0.770
Validation loss decreased (-0.749993 --> -0.769731).  Saving model ...
Epoch: 23 cost time: 1.0805857181549072
Epoch: 23, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.605 Vali Acc: 0.757 Test Loss: 0.605 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.2946228981018066
Epoch: 24, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.596 Vali Acc: 0.750 Test Loss: 0.596 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1408283710479736
Epoch: 25, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.578 Vali Acc: 0.776 Test Loss: 0.578 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 26 cost time: 1.310209035873413
Epoch: 26, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.501814365386963
Epoch: 27, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 28 cost time: 1.367882251739502
Epoch: 28, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.545 Vali Acc: 0.743 Test Loss: 0.545 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1479573249816895
Epoch: 29, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.538 Vali Acc: 0.743 Test Loss: 0.538 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1550893783569336
Epoch: 30, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.532 Vali Acc: 0.750 Test Loss: 0.532 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2597787380218506
Epoch: 31, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.537 Vali Acc: 0.737 Test Loss: 0.537 Test Acc: 0.737
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.49851393699646
Epoch: 32, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.531 Vali Acc: 0.757 Test Loss: 0.531 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.303095817565918
Epoch: 33, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.2604737281799316
Epoch: 34, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.524 Vali Acc: 0.750 Test Loss: 0.524 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2886667251586914
Epoch: 35, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.525 Vali Acc: 0.750 Test Loss: 0.525 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.227590799331665
Epoch: 36, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.545 Vali Acc: 0.750 Test Loss: 0.545 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2291173934936523
Epoch: 37, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.538 Vali Acc: 0.750 Test Loss: 0.538 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 132392
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9201149940490723
Epoch: 1, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.359 Vali Acc: 0.322 Test Loss: 1.359 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.3151583671569824
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.353 Vali Acc: 0.322 Test Loss: 1.353 Test Acc: 0.322
Validation loss decreased (-0.322355 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.1710855960845947
Epoch: 3, Steps: 10 | Train Loss: 1.383 Vali Loss: 1.342 Vali Acc: 0.342 Test Loss: 1.342 Test Acc: 0.342
Validation loss decreased (-0.322355 --> -0.342092).  Saving model ...
Epoch: 4 cost time: 1.4847097396850586
Epoch: 4, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.311 Vali Acc: 0.395 Test Loss: 1.311 Test Acc: 0.395
Validation loss decreased (-0.342092 --> -0.394724).  Saving model ...
Epoch: 5 cost time: 1.2925288677215576
Epoch: 5, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.284 Vali Acc: 0.454 Test Loss: 1.284 Test Acc: 0.454
Validation loss decreased (-0.394724 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 1.5513789653778076
Epoch: 6, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.259 Vali Acc: 0.513 Test Loss: 1.259 Test Acc: 0.513
Validation loss decreased (-0.453935 --> -0.513145).  Saving model ...
Epoch: 7 cost time: 1.5430893898010254
Epoch: 7, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.232 Vali Acc: 0.566 Test Loss: 1.232 Test Acc: 0.566
Validation loss decreased (-0.513145 --> -0.565777).  Saving model ...
Epoch: 8 cost time: 1.289891004562378
Epoch: 8, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.197 Vali Acc: 0.533 Test Loss: 1.197 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.401782751083374
Epoch: 9, Steps: 10 | Train Loss: 1.131 Vali Loss: 1.163 Vali Acc: 0.559 Test Loss: 1.163 Test Acc: 0.559
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2722079753875732
Epoch: 10, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.121 Vali Acc: 0.612 Test Loss: 1.121 Test Acc: 0.612
Validation loss decreased (-0.565777 --> -0.611831).  Saving model ...
Epoch: 11 cost time: 1.5114266872406006
Epoch: 11, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.079 Vali Acc: 0.612 Test Loss: 1.079 Test Acc: 0.612
Validation loss decreased (-0.611831 --> -0.611831).  Saving model ...
Epoch: 12 cost time: 1.3866665363311768
Epoch: 12, Steps: 10 | Train Loss: 0.994 Vali Loss: 1.034 Vali Acc: 0.605 Test Loss: 1.034 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.306915283203125
Epoch: 13, Steps: 10 | Train Loss: 0.913 Vali Loss: 0.994 Vali Acc: 0.658 Test Loss: 0.994 Test Acc: 0.658
Validation loss decreased (-0.611831 --> -0.657885).  Saving model ...
Epoch: 14 cost time: 1.4059593677520752
Epoch: 14, Steps: 10 | Train Loss: 0.846 Vali Loss: 0.948 Vali Acc: 0.638 Test Loss: 0.948 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5711724758148193
Epoch: 15, Steps: 10 | Train Loss: 0.748 Vali Loss: 0.901 Vali Acc: 0.671 Test Loss: 0.901 Test Acc: 0.671
Validation loss decreased (-0.657885 --> -0.671044).  Saving model ...
Epoch: 16 cost time: 1.407353162765503
Epoch: 16, Steps: 10 | Train Loss: 0.690 Vali Loss: 0.862 Vali Acc: 0.697 Test Loss: 0.862 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697360).  Saving model ...
Epoch: 17 cost time: 1.3591673374176025
Epoch: 17, Steps: 10 | Train Loss: 0.636 Vali Loss: 0.817 Vali Acc: 0.704 Test Loss: 0.817 Test Acc: 0.704
Validation loss decreased (-0.697360 --> -0.703939).  Saving model ...
Epoch: 18 cost time: 1.1673853397369385
Epoch: 18, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.777 Vali Acc: 0.704 Test Loss: 0.777 Test Acc: 0.704
Validation loss decreased (-0.703939 --> -0.703940).  Saving model ...
Epoch: 19 cost time: 1.5091159343719482
Epoch: 19, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.741 Vali Acc: 0.711 Test Loss: 0.741 Test Acc: 0.711
Validation loss decreased (-0.703940 --> -0.710519).  Saving model ...
Epoch: 20 cost time: 1.3993122577667236
Epoch: 20, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.708 Vali Acc: 0.724 Test Loss: 0.708 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 21 cost time: 1.3311491012573242
Epoch: 21, Steps: 10 | Train Loss: 0.421 Vali Loss: 0.680 Vali Acc: 0.724 Test Loss: 0.680 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723677).  Saving model ...
Epoch: 22 cost time: 1.413316249847412
Epoch: 22, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.663 Vali Acc: 0.711 Test Loss: 0.663 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3669180870056152
Epoch: 23, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
Validation loss decreased (-0.723677 --> -0.736836).  Saving model ...
Epoch: 24 cost time: 1.2327241897583008
Epoch: 24, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.630 Vali Acc: 0.750 Test Loss: 0.630 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 25 cost time: 1.2565076351165771
Epoch: 25, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.608 Vali Acc: 0.743 Test Loss: 0.608 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.280125617980957
Epoch: 26, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.594 Vali Acc: 0.730 Test Loss: 0.594 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.4666776657104492
Epoch: 27, Steps: 10 | Train Loss: 0.261 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 28 cost time: 1.4740676879882812
Epoch: 28, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 1.4419116973876953
Epoch: 29, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.577 Vali Acc: 0.743 Test Loss: 0.577 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5326666831970215
Epoch: 30, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.563 Vali Acc: 0.763 Test Loss: 0.563 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3501439094543457
Epoch: 31, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.569 Vali Acc: 0.757 Test Loss: 0.569 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.2839524745941162
Epoch: 32, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 33 cost time: 1.1993134021759033
Epoch: 33, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.561 Vali Acc: 0.757 Test Loss: 0.561 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5844454765319824
Epoch: 34, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.558 Vali Acc: 0.757 Test Loss: 0.558 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.6348860263824463
Epoch: 35, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.397864580154419
Epoch: 36, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.565 Vali Acc: 0.763 Test Loss: 0.565 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.2793495655059814
Epoch: 37, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 38 cost time: 1.199234962463379
Epoch: 38, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1770710945129395
Epoch: 39, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.3452825546264648
Epoch: 40, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 41 cost time: 1.2822794914245605
Epoch: 41, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.585 Vali Acc: 0.770 Test Loss: 0.585 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.7239327430725098
Epoch: 42, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.576 Vali Acc: 0.770 Test Loss: 0.576 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.6031830310821533
Epoch: 43, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3155100345611572
Epoch: 44, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.595 Vali Acc: 0.763 Test Loss: 0.595 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3479833602905273
Epoch: 45, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.579 Vali Acc: 0.763 Test Loss: 0.579 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1116986274719238
Epoch: 46, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.598 Vali Acc: 0.770 Test Loss: 0.598 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.1141910552978516
Epoch: 47, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.589 Vali Acc: 0.776 Test Loss: 0.589 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.269493818283081
Epoch: 48, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.612 Vali Acc: 0.763 Test Loss: 0.612 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.420860767364502
Epoch: 49, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.594 Vali Acc: 0.770 Test Loss: 0.594 Test Acc: 0.770
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.4473717212677002
Epoch: 50, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.607 Vali Acc: 0.783 Test Loss: 0.607 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 132232
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.2646872997283936
Epoch: 1, Steps: 10 | Train Loss: 1.524 Vali Loss: 1.392 Vali Acc: 0.250 Test Loss: 1.392 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.6333494186401367
Epoch: 2, Steps: 10 | Train Loss: 1.428 Vali Loss: 1.348 Vali Acc: 0.342 Test Loss: 1.348 Test Acc: 0.342
Validation loss decreased (-0.249986 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.5110890865325928
Epoch: 3, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.338 Vali Acc: 0.322 Test Loss: 1.338 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4141411781311035
Epoch: 4, Steps: 10 | Train Loss: 1.336 Vali Loss: 1.326 Vali Acc: 0.336 Test Loss: 1.326 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4805657863616943
Epoch: 5, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.297 Vali Acc: 0.421 Test Loss: 1.297 Test Acc: 0.421
Validation loss decreased (-0.342092 --> -0.421040).  Saving model ...
Epoch: 6 cost time: 1.7399938106536865
Epoch: 6, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.270 Vali Acc: 0.493 Test Loss: 1.270 Test Acc: 0.493
Validation loss decreased (-0.421040 --> -0.493408).  Saving model ...
Epoch: 7 cost time: 1.8717505931854248
Epoch: 7, Steps: 10 | Train Loss: 1.242 Vali Loss: 1.240 Vali Acc: 0.526 Test Loss: 1.240 Test Acc: 0.526
Validation loss decreased (-0.493408 --> -0.526303).  Saving model ...
Epoch: 8 cost time: 1.3093180656433105
Epoch: 8, Steps: 10 | Train Loss: 1.247 Vali Loss: 1.214 Vali Acc: 0.559 Test Loss: 1.214 Test Acc: 0.559
Validation loss decreased (-0.526303 --> -0.559198).  Saving model ...
Epoch: 9 cost time: 1.5795495510101318
Epoch: 9, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.183 Vali Acc: 0.559 Test Loss: 1.183 Test Acc: 0.559
Validation loss decreased (-0.559198 --> -0.559199).  Saving model ...
Epoch: 10 cost time: 1.8022634983062744
Epoch: 10, Steps: 10 | Train Loss: 1.155 Vali Loss: 1.145 Vali Acc: 0.566 Test Loss: 1.145 Test Acc: 0.566
Validation loss decreased (-0.559199 --> -0.565778).  Saving model ...
Epoch: 11 cost time: 1.3505263328552246
Epoch: 11, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.105 Vali Acc: 0.572 Test Loss: 1.105 Test Acc: 0.572
Validation loss decreased (-0.565778 --> -0.572357).  Saving model ...
Epoch: 12 cost time: 1.6036577224731445
Epoch: 12, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.073 Vali Acc: 0.599 Test Loss: 1.073 Test Acc: 0.599
Validation loss decreased (-0.572357 --> -0.598673).  Saving model ...
Epoch: 13 cost time: 1.368854284286499
Epoch: 13, Steps: 10 | Train Loss: 0.989 Vali Loss: 1.024 Vali Acc: 0.618 Test Loss: 1.024 Test Acc: 0.618
Validation loss decreased (-0.598673 --> -0.618411).  Saving model ...
Epoch: 14 cost time: 1.5882611274719238
Epoch: 14, Steps: 10 | Train Loss: 0.937 Vali Loss: 0.978 Vali Acc: 0.625 Test Loss: 0.978 Test Acc: 0.625
Validation loss decreased (-0.618411 --> -0.624990).  Saving model ...
Epoch: 15 cost time: 1.7593400478363037
Epoch: 15, Steps: 10 | Train Loss: 0.890 Vali Loss: 0.929 Vali Acc: 0.651 Test Loss: 0.929 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651306).  Saving model ...
Epoch: 16 cost time: 1.4127771854400635
Epoch: 16, Steps: 10 | Train Loss: 0.799 Vali Loss: 0.879 Vali Acc: 0.645 Test Loss: 0.879 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.395388126373291
Epoch: 17, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.831 Vali Acc: 0.671 Test Loss: 0.831 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671044).  Saving model ...
Epoch: 18 cost time: 1.2711372375488281
Epoch: 18, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.785 Vali Acc: 0.664 Test Loss: 0.785 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5035741329193115
Epoch: 19, Steps: 10 | Train Loss: 0.627 Vali Loss: 0.743 Vali Acc: 0.697 Test Loss: 0.743 Test Acc: 0.697
Validation loss decreased (-0.671044 --> -0.697361).  Saving model ...
Epoch: 20 cost time: 1.5992488861083984
Epoch: 20, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.709 Vali Acc: 0.711 Test Loss: 0.709 Test Acc: 0.711
Validation loss decreased (-0.697361 --> -0.710519).  Saving model ...
Epoch: 21 cost time: 1.3197112083435059
Epoch: 21, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.674 Vali Acc: 0.724 Test Loss: 0.674 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 22 cost time: 1.600006341934204
Epoch: 22, Steps: 10 | Train Loss: 0.468 Vali Loss: 0.644 Vali Acc: 0.711 Test Loss: 0.644 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.639812707901001
Epoch: 23, Steps: 10 | Train Loss: 0.427 Vali Loss: 0.613 Vali Acc: 0.743 Test Loss: 0.613 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 24 cost time: 1.3036012649536133
Epoch: 24, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.593 Vali Acc: 0.743 Test Loss: 0.593 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 25 cost time: 1.5880217552185059
Epoch: 25, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 26 cost time: 2.0331320762634277
Epoch: 26, Steps: 10 | Train Loss: 0.307 Vali Loss: 0.558 Vali Acc: 0.776 Test Loss: 0.558 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 27 cost time: 1.4321694374084473
Epoch: 27, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.544 Vali Acc: 0.763 Test Loss: 0.544 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4693613052368164
Epoch: 28, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.531 Vali Acc: 0.763 Test Loss: 0.531 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.342461109161377
Epoch: 29, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.539 Vali Acc: 0.757 Test Loss: 0.539 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.9145698547363281
Epoch: 30, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 31 cost time: 1.5620296001434326
Epoch: 31, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.555 Vali Acc: 0.730 Test Loss: 0.555 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.0669262409210205
Epoch: 32, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.7053148746490479
Epoch: 33, Steps: 10 | Train Loss: 0.184 Vali Loss: 0.530 Vali Acc: 0.757 Test Loss: 0.530 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4664061069488525
Epoch: 34, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.516 Vali Acc: 0.776 Test Loss: 0.516 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.4985177516937256
Epoch: 35, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.513 Vali Acc: 0.770 Test Loss: 0.513 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.8587250709533691
Epoch: 36, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.4162793159484863
Epoch: 37, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.506 Vali Acc: 0.776 Test Loss: 0.506 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.5550663471221924
Epoch: 38, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.510 Vali Acc: 0.783 Test Loss: 0.510 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.960991382598877
Epoch: 39, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.7875163555145264
Epoch: 40, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.539 Vali Acc: 0.770 Test Loss: 0.539 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 132072
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.799240827560425
Epoch: 1, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.309 Vali Acc: 0.395 Test Loss: 1.309 Test Acc: 0.395
Validation loss decreased (inf --> -0.394724).  Saving model ...
Epoch: 2 cost time: 0.9321165084838867
Epoch: 2, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.201 Vali Acc: 0.559 Test Loss: 1.201 Test Acc: 0.559
Validation loss decreased (-0.394724 --> -0.559199).  Saving model ...
Epoch: 3 cost time: 1.0395777225494385
Epoch: 3, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.096 Vali Acc: 0.612 Test Loss: 1.096 Test Acc: 0.612
Validation loss decreased (-0.559199 --> -0.611831).  Saving model ...
Epoch: 4 cost time: 1.362159013748169
Epoch: 4, Steps: 10 | Train Loss: 0.917 Vali Loss: 0.953 Vali Acc: 0.684 Test Loss: 0.953 Test Acc: 0.684
Validation loss decreased (-0.611831 --> -0.684201).  Saving model ...
Epoch: 5 cost time: 1.0502195358276367
Epoch: 5, Steps: 10 | Train Loss: 0.728 Vali Loss: 0.899 Vali Acc: 0.638 Test Loss: 0.899 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2632479667663574
Epoch: 6, Steps: 10 | Train Loss: 0.581 Vali Loss: 0.762 Vali Acc: 0.704 Test Loss: 0.762 Test Acc: 0.704
Validation loss decreased (-0.684201 --> -0.703940).  Saving model ...
Epoch: 7 cost time: 1.207139015197754
Epoch: 7, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.744 Vali Acc: 0.697 Test Loss: 0.744 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0051655769348145
Epoch: 8, Steps: 10 | Train Loss: 0.376 Vali Loss: 0.593 Vali Acc: 0.796 Test Loss: 0.593 Test Acc: 0.796
Validation loss decreased (-0.703940 --> -0.796047).  Saving model ...
Epoch: 9 cost time: 1.4065303802490234
Epoch: 9, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.514 Vali Acc: 0.757 Test Loss: 0.514 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9130139350891113
Epoch: 10, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.504 Vali Acc: 0.770 Test Loss: 0.504 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.101320743560791
Epoch: 11, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.643 Vali Acc: 0.809 Test Loss: 0.643 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 12 cost time: 1.1960971355438232
Epoch: 12, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.690 Vali Acc: 0.789 Test Loss: 0.690 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.025726079940796
Epoch: 13, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.658 Vali Acc: 0.803 Test Loss: 0.658 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2697539329528809
Epoch: 14, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.537 Vali Acc: 0.809 Test Loss: 0.537 Test Acc: 0.809
Validation loss decreased (-0.809204 --> -0.809205).  Saving model ...
Epoch: 15 cost time: 0.9706382751464844
Epoch: 15, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.662 Vali Acc: 0.816 Test Loss: 0.662 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815783).  Saving model ...
Epoch: 16 cost time: 0.9573888778686523
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.639 Vali Acc: 0.816 Test Loss: 0.639 Test Acc: 0.816
Validation loss decreased (-0.815783 --> -0.815783).  Saving model ...
Epoch: 17 cost time: 0.9697549343109131
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.834 Vali Acc: 0.796 Test Loss: 0.834 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0148019790649414
Epoch: 18, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.768 Vali Acc: 0.809 Test Loss: 0.768 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.008866548538208
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.824 Vali Acc: 0.796 Test Loss: 0.824 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9229996204376221
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.811 Vali Acc: 0.809 Test Loss: 0.811 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.4002101421356201
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.795 Vali Acc: 0.803 Test Loss: 0.795 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0710992813110352
Epoch: 22, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.808 Vali Acc: 0.816 Test Loss: 0.808 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1369798183441162
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.870 Vali Acc: 0.809 Test Loss: 0.870 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9320061206817627
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.926 Vali Acc: 0.803 Test Loss: 0.926 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8995945453643799
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.899 Vali Acc: 0.803 Test Loss: 0.899 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1929547786712646
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.867 Vali Acc: 0.803 Test Loss: 0.867 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 4779548
model size : 23.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.35298490524292
Epoch: 1, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.340 Vali Acc: 0.336 Test Loss: 1.340 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.4172699451446533
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.260 Vali Acc: 0.395 Test Loss: 1.260 Test Acc: 0.395
Validation loss decreased (-0.335513 --> -0.394724).  Saving model ...
Epoch: 3 cost time: 1.4327993392944336
Epoch: 3, Steps: 10 | Train Loss: 1.186 Vali Loss: 1.118 Vali Acc: 0.592 Test Loss: 1.118 Test Acc: 0.592
Validation loss decreased (-0.394724 --> -0.592094).  Saving model ...
Epoch: 4 cost time: 1.1132612228393555
Epoch: 4, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.027 Vali Acc: 0.572 Test Loss: 1.027 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.322251796722412
Epoch: 5, Steps: 10 | Train Loss: 0.813 Vali Loss: 0.869 Vali Acc: 0.691 Test Loss: 0.869 Test Acc: 0.691
Validation loss decreased (-0.592094 --> -0.690781).  Saving model ...
Epoch: 6 cost time: 1.257256269454956
Epoch: 6, Steps: 10 | Train Loss: 0.629 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717098).  Saving model ...
Epoch: 7 cost time: 1.3786611557006836
Epoch: 7, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.668 Vali Acc: 0.711 Test Loss: 0.668 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1690826416015625
Epoch: 8, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.587 Vali Acc: 0.743 Test Loss: 0.587 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.441938877105713
Epoch: 9, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
Validation loss decreased (-0.743415 --> -0.763153).  Saving model ...
Epoch: 10 cost time: 1.056706428527832
Epoch: 10, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.512 Vali Acc: 0.776 Test Loss: 0.512 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 11 cost time: 1.3944573402404785
Epoch: 11, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.556 Vali Acc: 0.776 Test Loss: 0.556 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2515981197357178
Epoch: 12, Steps: 10 | Train Loss: 0.135 Vali Loss: 0.660 Vali Acc: 0.803 Test Loss: 0.660 Test Acc: 0.803
Validation loss decreased (-0.776311 --> -0.802625).  Saving model ...
Epoch: 13 cost time: 1.3547258377075195
Epoch: 13, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.613 Vali Acc: 0.803 Test Loss: 0.613 Test Acc: 0.803
Validation loss decreased (-0.802625 --> -0.802625).  Saving model ...
Epoch: 14 cost time: 1.258406639099121
Epoch: 14, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.646 Vali Acc: 0.783 Test Loss: 0.646 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.078115463256836
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0882320404052734
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.657 Vali Acc: 0.816 Test Loss: 0.657 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815783).  Saving model ...
Epoch: 17 cost time: 1.1685023307800293
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.763 Vali Acc: 0.803 Test Loss: 0.763 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1934568881988525
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.821 Vali Acc: 0.809 Test Loss: 0.821 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1167898178100586
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.807 Vali Acc: 0.803 Test Loss: 0.807 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1330296993255615
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.833 Vali Acc: 0.822 Test Loss: 0.833 Test Acc: 0.822
Validation loss decreased (-0.815783 --> -0.822360).  Saving model ...
Epoch: 21 cost time: 1.2290716171264648
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.844 Vali Acc: 0.803 Test Loss: 0.844 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1351561546325684
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.857 Vali Acc: 0.822 Test Loss: 0.857 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1811141967773438
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.883 Vali Acc: 0.816 Test Loss: 0.883 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3540031909942627
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.906 Vali Acc: 0.816 Test Loss: 0.906 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3681721687316895
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.926 Vali Acc: 0.829 Test Loss: 0.926 Test Acc: 0.829
Validation loss decreased (-0.822360 --> -0.828938).  Saving model ...
Epoch: 26 cost time: 1.098677396774292
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.931 Vali Acc: 0.816 Test Loss: 0.931 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5463321208953857
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.938 Vali Acc: 0.816 Test Loss: 0.938 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3016140460968018
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.947 Vali Acc: 0.809 Test Loss: 0.947 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.402989387512207
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.957 Vali Acc: 0.809 Test Loss: 0.957 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.206921100616455
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.829 Test Loss: 0.974 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2368078231811523
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.989 Vali Acc: 0.829 Test Loss: 0.989 Test Acc: 0.829
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3274121284484863
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.822 Test Loss: 0.995 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2640490531921387
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.998 Vali Acc: 0.816 Test Loss: 0.998 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0135302543640137
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.816 Test Loss: 1.012 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2196836471557617
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.027 Vali Acc: 0.829 Test Loss: 1.027 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 4778780
model size : 23.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2701804637908936
Epoch: 1, Steps: 10 | Train Loss: 1.515 Vali Loss: 1.446 Vali Acc: 0.250 Test Loss: 1.446 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.0649454593658447
Epoch: 2, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.288 Vali Acc: 0.428 Test Loss: 1.288 Test Acc: 0.428
Validation loss decreased (-0.249986 --> -0.427619).  Saving model ...
Epoch: 3 cost time: 1.1478784084320068
Epoch: 3, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.151 Vali Acc: 0.579 Test Loss: 1.151 Test Acc: 0.579
Validation loss decreased (-0.427619 --> -0.578936).  Saving model ...
Epoch: 4 cost time: 1.0056567192077637
Epoch: 4, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.083 Vali Acc: 0.579 Test Loss: 1.083 Test Acc: 0.579
Validation loss decreased (-0.578936 --> -0.578937).  Saving model ...
Epoch: 5 cost time: 1.2240405082702637
Epoch: 5, Steps: 10 | Train Loss: 0.881 Vali Loss: 0.939 Vali Acc: 0.625 Test Loss: 0.939 Test Acc: 0.625
Validation loss decreased (-0.578937 --> -0.624991).  Saving model ...
Epoch: 6 cost time: 1.153308629989624
Epoch: 6, Steps: 10 | Train Loss: 0.650 Vali Loss: 0.806 Vali Acc: 0.704 Test Loss: 0.806 Test Acc: 0.704
Validation loss decreased (-0.624991 --> -0.703939).  Saving model ...
Epoch: 7 cost time: 1.6056125164031982
Epoch: 7, Steps: 10 | Train Loss: 0.501 Vali Loss: 0.674 Vali Acc: 0.717 Test Loss: 0.674 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717099).  Saving model ...
Epoch: 8 cost time: 1.393730878829956
Epoch: 8, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.588 Vali Acc: 0.770 Test Loss: 0.588 Test Acc: 0.770
Validation loss decreased (-0.717099 --> -0.769731).  Saving model ...
Epoch: 9 cost time: 1.0956192016601562
Epoch: 9, Steps: 10 | Train Loss: 0.335 Vali Loss: 0.583 Vali Acc: 0.763 Test Loss: 0.583 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5177950859069824
Epoch: 10, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.639 Vali Acc: 0.757 Test Loss: 0.639 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.480778694152832
Epoch: 11, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.551 Vali Acc: 0.789 Test Loss: 0.551 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.274949073791504
Epoch: 12, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.489607334136963
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.628 Vali Acc: 0.789 Test Loss: 0.628 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0505857467651367
Epoch: 14, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.697 Vali Acc: 0.809 Test Loss: 0.697 Test Acc: 0.809
Validation loss decreased (-0.789468 --> -0.809204).  Saving model ...
Epoch: 15 cost time: 1.0661115646362305
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.728 Vali Acc: 0.783 Test Loss: 0.728 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.06791353225708
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.726 Vali Acc: 0.803 Test Loss: 0.726 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2255215644836426
Epoch: 17, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.781 Vali Acc: 0.829 Test Loss: 0.781 Test Acc: 0.829
Validation loss decreased (-0.809204 --> -0.828940).  Saving model ...
Epoch: 18 cost time: 1.1345264911651611
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.848 Vali Acc: 0.809 Test Loss: 0.848 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2284307479858398
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.927 Vali Acc: 0.836 Test Loss: 0.927 Test Acc: 0.836
Validation loss decreased (-0.828940 --> -0.835517).  Saving model ...
Epoch: 20 cost time: 1.0552926063537598
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.980 Vali Acc: 0.803 Test Loss: 0.980 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2560288906097412
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.899 Vali Acc: 0.829 Test Loss: 0.899 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2045845985412598
Epoch: 22, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.886 Vali Acc: 0.809 Test Loss: 0.886 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4481866359710693
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 1.332 Vali Acc: 0.796 Test Loss: 1.332 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2336318492889404
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 1.105 Vali Acc: 0.809 Test Loss: 1.105 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5885066986083984
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.030 Vali Acc: 0.783 Test Loss: 1.030 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.434539556503296
Epoch: 26, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.994 Vali Acc: 0.816 Test Loss: 0.994 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.5688469409942627
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.161 Vali Acc: 0.783 Test Loss: 1.161 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.2889275550842285
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.233 Vali Acc: 0.789 Test Loss: 1.233 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.4854955673217773
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.266 Vali Acc: 0.789 Test Loss: 1.266 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 4778012
model size : 23.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.829401969909668
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.370 Vali Acc: 0.296 Test Loss: 1.370 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.552314043045044
Epoch: 2, Steps: 10 | Train Loss: 1.332 Vali Loss: 1.270 Vali Acc: 0.474 Test Loss: 1.270 Test Acc: 0.474
Validation loss decreased (-0.296039 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 1.119143009185791
Epoch: 3, Steps: 10 | Train Loss: 1.196 Vali Loss: 1.153 Vali Acc: 0.480 Test Loss: 1.153 Test Acc: 0.480
Validation loss decreased (-0.473672 --> -0.480252).  Saving model ...
Epoch: 4 cost time: 1.156745433807373
Epoch: 4, Steps: 10 | Train Loss: 0.985 Vali Loss: 0.985 Vali Acc: 0.618 Test Loss: 0.985 Test Acc: 0.618
Validation loss decreased (-0.480252 --> -0.618411).  Saving model ...
Epoch: 5 cost time: 1.0392076969146729
Epoch: 5, Steps: 10 | Train Loss: 0.802 Vali Loss: 0.924 Vali Acc: 0.678 Test Loss: 0.924 Test Acc: 0.678
Validation loss decreased (-0.618411 --> -0.677622).  Saving model ...
Epoch: 6 cost time: 1.0983781814575195
Epoch: 6, Steps: 10 | Train Loss: 0.662 Vali Loss: 0.790 Vali Acc: 0.645 Test Loss: 0.790 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3443470001220703
Epoch: 7, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.745 Vali Acc: 0.691 Test Loss: 0.745 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690782).  Saving model ...
Epoch: 8 cost time: 1.2710096836090088
Epoch: 8, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
Validation loss decreased (-0.690782 --> -0.789468).  Saving model ...
Epoch: 9 cost time: 1.1420576572418213
Epoch: 9, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3722898960113525
Epoch: 10, Steps: 10 | Train Loss: 0.187 Vali Loss: 0.494 Vali Acc: 0.789 Test Loss: 0.494 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 11 cost time: 1.518646001815796
Epoch: 11, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3492395877838135
Epoch: 12, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4053230285644531
Epoch: 13, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.611 Vali Acc: 0.809 Test Loss: 0.611 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809204).  Saving model ...
Epoch: 14 cost time: 1.0374860763549805
Epoch: 14, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.791 Vali Acc: 0.803 Test Loss: 0.791 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4468801021575928
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.645 Vali Acc: 0.796 Test Loss: 0.645 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2260096073150635
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 0.826 Vali Acc: 0.816 Test Loss: 0.826 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815781).  Saving model ...
Epoch: 17 cost time: 1.2631773948669434
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.827 Vali Acc: 0.809 Test Loss: 0.827 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.281137466430664
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.746 Vali Acc: 0.822 Test Loss: 0.746 Test Acc: 0.822
Validation loss decreased (-0.815781 --> -0.822361).  Saving model ...
Epoch: 19 cost time: 1.384462833404541
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.799 Vali Acc: 0.836 Test Loss: 0.799 Test Acc: 0.836
Validation loss decreased (-0.822361 --> -0.835518).  Saving model ...
Epoch: 20 cost time: 1.7010324001312256
Epoch: 20, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.806 Vali Acc: 0.822 Test Loss: 0.806 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3797709941864014
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.937 Vali Acc: 0.816 Test Loss: 0.937 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5661282539367676
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.876 Vali Acc: 0.822 Test Loss: 0.876 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.322030782699585
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.031 Vali Acc: 0.809 Test Loss: 1.031 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4611053466796875
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.922 Vali Acc: 0.796 Test Loss: 0.922 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.240938663482666
Epoch: 25, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.000 Vali Acc: 0.822 Test Loss: 1.000 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.473374843597412
Epoch: 26, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.111 Vali Acc: 0.822 Test Loss: 1.111 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1968491077423096
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 1.026 Vali Acc: 0.816 Test Loss: 1.026 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3590378761291504
Epoch: 28, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.997 Vali Acc: 0.809 Test Loss: 0.997 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3077692985534668
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.097 Vali Acc: 0.796 Test Loss: 1.097 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 4777244
model size : 23.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.0385196208953857
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.332 Vali Acc: 0.349 Test Loss: 1.332 Test Acc: 0.349
Validation loss decreased (inf --> -0.348671).  Saving model ...
Epoch: 2 cost time: 1.1806087493896484
Epoch: 2, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.253 Vali Acc: 0.434 Test Loss: 1.253 Test Acc: 0.434
Validation loss decreased (-0.348671 --> -0.434198).  Saving model ...
Epoch: 3 cost time: 0.9755198955535889
Epoch: 3, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.127 Vali Acc: 0.586 Test Loss: 1.127 Test Acc: 0.586
Validation loss decreased (-0.434198 --> -0.585515).  Saving model ...
Epoch: 4 cost time: 1.2535133361816406
Epoch: 4, Steps: 10 | Train Loss: 1.014 Vali Loss: 1.062 Vali Acc: 0.625 Test Loss: 1.062 Test Acc: 0.625
Validation loss decreased (-0.585515 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 1.2018990516662598
Epoch: 5, Steps: 10 | Train Loss: 0.850 Vali Loss: 0.894 Vali Acc: 0.664 Test Loss: 0.894 Test Acc: 0.664
Validation loss decreased (-0.624989 --> -0.664465).  Saving model ...
Epoch: 6 cost time: 1.2388129234313965
Epoch: 6, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.803 Vali Acc: 0.671 Test Loss: 0.803 Test Acc: 0.671
Validation loss decreased (-0.664465 --> -0.671045).  Saving model ...
Epoch: 7 cost time: 1.0852537155151367
Epoch: 7, Steps: 10 | Train Loss: 0.500 Vali Loss: 0.709 Vali Acc: 0.763 Test Loss: 0.709 Test Acc: 0.763
Validation loss decreased (-0.671045 --> -0.763151).  Saving model ...
Epoch: 8 cost time: 1.0529024600982666
Epoch: 8, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.633 Vali Acc: 0.750 Test Loss: 0.633 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1661033630371094
Epoch: 9, Steps: 10 | Train Loss: 0.306 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
Validation loss decreased (-0.763151 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 0.9986093044281006
Epoch: 10, Steps: 10 | Train Loss: 0.215 Vali Loss: 0.574 Vali Acc: 0.789 Test Loss: 0.574 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 0.9108912944793701
Epoch: 11, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.644 Vali Acc: 0.776 Test Loss: 0.644 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2363111972808838
Epoch: 12, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.541 Vali Acc: 0.789 Test Loss: 0.541 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 0.9613330364227295
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3419592380523682
Epoch: 14, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.682 Vali Acc: 0.816 Test Loss: 0.682 Test Acc: 0.816
Validation loss decreased (-0.789468 --> -0.815783).  Saving model ...
Epoch: 15 cost time: 1.2189435958862305
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.702 Vali Acc: 0.816 Test Loss: 0.702 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2073516845703125
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.832 Vali Acc: 0.803 Test Loss: 0.832 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1679856777191162
Epoch: 17, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.858 Vali Acc: 0.816 Test Loss: 0.858 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1104905605316162
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.920 Vali Acc: 0.816 Test Loss: 0.920 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0098299980163574
Epoch: 19, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.076 Vali Acc: 0.789 Test Loss: 1.076 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.153520107269287
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 1.033 Vali Acc: 0.789 Test Loss: 1.033 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2477731704711914
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.091 Vali Acc: 0.809 Test Loss: 1.091 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1306095123291016
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.152 Vali Acc: 0.803 Test Loss: 1.152 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.2319233417510986
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.159 Vali Acc: 0.789 Test Loss: 1.159 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4053974151611328
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.168 Vali Acc: 0.809 Test Loss: 1.168 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 3991580
model size : 20.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.895620346069336
Epoch: 1, Steps: 10 | Train Loss: 1.527 Vali Loss: 1.421 Vali Acc: 0.270 Test Loss: 1.421 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.1292386054992676
Epoch: 2, Steps: 10 | Train Loss: 1.396 Vali Loss: 1.317 Vali Acc: 0.421 Test Loss: 1.317 Test Acc: 0.421
Validation loss decreased (-0.269723 --> -0.421039).  Saving model ...
Epoch: 3 cost time: 1.0544235706329346
Epoch: 3, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.192 Vali Acc: 0.441 Test Loss: 1.192 Test Acc: 0.441
Validation loss decreased (-0.421039 --> -0.440778).  Saving model ...
Epoch: 4 cost time: 1.1134312152862549
Epoch: 4, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.043 Vali Acc: 0.612 Test Loss: 1.043 Test Acc: 0.612
Validation loss decreased (-0.440778 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 1.5431859493255615
Epoch: 5, Steps: 10 | Train Loss: 0.884 Vali Loss: 0.920 Vali Acc: 0.704 Test Loss: 0.920 Test Acc: 0.704
Validation loss decreased (-0.611832 --> -0.703938).  Saving model ...
Epoch: 6 cost time: 0.9551732540130615
Epoch: 6, Steps: 10 | Train Loss: 0.736 Vali Loss: 0.811 Vali Acc: 0.711 Test Loss: 0.811 Test Acc: 0.711
Validation loss decreased (-0.703938 --> -0.710518).  Saving model ...
Epoch: 7 cost time: 1.04998779296875
Epoch: 7, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.727 Vali Acc: 0.737 Test Loss: 0.727 Test Acc: 0.737
Validation loss decreased (-0.710518 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 1.1281983852386475
Epoch: 8, Steps: 10 | Train Loss: 0.461 Vali Loss: 0.773 Vali Acc: 0.684 Test Loss: 0.773 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.235835313796997
Epoch: 9, Steps: 10 | Train Loss: 0.430 Vali Loss: 0.873 Vali Acc: 0.684 Test Loss: 0.873 Test Acc: 0.684
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.188481330871582
Epoch: 10, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.676 Vali Acc: 0.724 Test Loss: 0.676 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0348458290100098
Epoch: 11, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.545 Vali Acc: 0.776 Test Loss: 0.545 Test Acc: 0.776
Validation loss decreased (-0.736835 --> -0.776310).  Saving model ...
Epoch: 12 cost time: 1.2561163902282715
Epoch: 12, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.489 Vali Acc: 0.789 Test Loss: 0.489 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789469).  Saving model ...
Epoch: 13 cost time: 1.130174160003662
Epoch: 13, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.652 Vali Acc: 0.789 Test Loss: 0.652 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0783538818359375
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.1659815311431885
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.567 Vali Acc: 0.816 Test Loss: 0.567 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 16 cost time: 1.3117594718933105
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.633 Vali Acc: 0.809 Test Loss: 0.633 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1653172969818115
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.713 Vali Acc: 0.803 Test Loss: 0.713 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.059553623199463
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.778 Vali Acc: 0.816 Test Loss: 0.778 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3346900939941406
Epoch: 19, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.831 Vali Acc: 0.803 Test Loss: 0.831 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.198472261428833
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.895 Vali Acc: 0.783 Test Loss: 0.895 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0169167518615723
Epoch: 21, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.032 Vali Acc: 0.757 Test Loss: 1.032 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9948124885559082
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.928 Vali Acc: 0.796 Test Loss: 0.928 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9306211471557617
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.942 Vali Acc: 0.822 Test Loss: 0.942 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822359).  Saving model ...
Epoch: 24 cost time: 0.96578049659729
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.984 Vali Acc: 0.816 Test Loss: 0.984 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1152994632720947
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.010 Vali Acc: 0.816 Test Loss: 1.010 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.294327735900879
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.037 Vali Acc: 0.822 Test Loss: 1.037 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0372745990753174
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.059 Vali Acc: 0.822 Test Loss: 1.059 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1437556743621826
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.076 Vali Acc: 0.822 Test Loss: 1.076 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.935230016708374
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.095 Vali Acc: 0.822 Test Loss: 1.095 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.033520221710205
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.101 Vali Acc: 0.822 Test Loss: 1.101 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.007277011871338
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.108 Vali Acc: 0.816 Test Loss: 1.108 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8241314888000488
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.112 Vali Acc: 0.816 Test Loss: 1.112 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.2762207984924316
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.119 Vali Acc: 0.816 Test Loss: 1.119 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 3990812
model size : 20.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3804638385772705
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.353 Vali Acc: 0.316 Test Loss: 1.353 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.262460708618164
Epoch: 2, Steps: 10 | Train Loss: 1.276 Vali Loss: 1.249 Vali Acc: 0.526 Test Loss: 1.249 Test Acc: 0.526
Validation loss decreased (-0.315776 --> -0.526303).  Saving model ...
Epoch: 3 cost time: 1.6848623752593994
Epoch: 3, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.139 Vali Acc: 0.559 Test Loss: 1.139 Test Acc: 0.559
Validation loss decreased (-0.526303 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.0428504943847656
Epoch: 4, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.015 Vali Acc: 0.651 Test Loss: 1.015 Test Acc: 0.651
Validation loss decreased (-0.559199 --> -0.651306).  Saving model ...
Epoch: 5 cost time: 1.0947043895721436
Epoch: 5, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.885 Vali Acc: 0.704 Test Loss: 0.885 Test Acc: 0.704
Validation loss decreased (-0.651306 --> -0.703939).  Saving model ...
Epoch: 6 cost time: 1.2506837844848633
Epoch: 6, Steps: 10 | Train Loss: 0.700 Vali Loss: 0.843 Vali Acc: 0.632 Test Loss: 0.843 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2130024433135986
Epoch: 7, Steps: 10 | Train Loss: 0.551 Vali Loss: 0.722 Vali Acc: 0.737 Test Loss: 0.722 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 1.1598742008209229
Epoch: 8, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.667 Vali Acc: 0.724 Test Loss: 0.667 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0136985778808594
Epoch: 9, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.524 Vali Acc: 0.776 Test Loss: 0.524 Test Acc: 0.776
Validation loss decreased (-0.736835 --> -0.776311).  Saving model ...
Epoch: 10 cost time: 1.4705395698547363
Epoch: 10, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.509 Vali Acc: 0.770 Test Loss: 0.509 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.47003173828125
Epoch: 11, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 12 cost time: 1.1206974983215332
Epoch: 12, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.588 Vali Acc: 0.816 Test Loss: 0.588 Test Acc: 0.816
Validation loss decreased (-0.782889 --> -0.815784).  Saving model ...
Epoch: 13 cost time: 1.2285120487213135
Epoch: 13, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.747 Vali Acc: 0.803 Test Loss: 0.747 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3036763668060303
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.794 Vali Acc: 0.803 Test Loss: 0.794 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2538354396820068
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.763 Vali Acc: 0.809 Test Loss: 0.763 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2004213333129883
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.817 Vali Acc: 0.789 Test Loss: 0.817 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3383593559265137
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.920 Vali Acc: 0.809 Test Loss: 0.920 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.092705488204956
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.001 Vali Acc: 0.796 Test Loss: 1.001 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3308472633361816
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.009 Vali Acc: 0.809 Test Loss: 1.009 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2690670490264893
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.038 Vali Acc: 0.809 Test Loss: 1.038 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4742746353149414
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.066 Vali Acc: 0.809 Test Loss: 1.066 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4810304641723633
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.076 Vali Acc: 0.803 Test Loss: 1.076 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 3990044
model size : 20.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.118683099746704
Epoch: 1, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.345 Vali Acc: 0.336 Test Loss: 1.345 Test Acc: 0.336
Validation loss decreased (inf --> -0.335513).  Saving model ...
Epoch: 2 cost time: 1.0769109725952148
Epoch: 2, Steps: 10 | Train Loss: 1.322 Vali Loss: 1.235 Vali Acc: 0.513 Test Loss: 1.235 Test Acc: 0.513
Validation loss decreased (-0.335513 --> -0.513146).  Saving model ...
Epoch: 3 cost time: 0.9502828121185303
Epoch: 3, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.137 Vali Acc: 0.599 Test Loss: 1.137 Test Acc: 0.599
Validation loss decreased (-0.513146 --> -0.598673).  Saving model ...
Epoch: 4 cost time: 0.780123233795166
Epoch: 4, Steps: 10 | Train Loss: 0.962 Vali Loss: 1.009 Vali Acc: 0.612 Test Loss: 1.009 Test Acc: 0.612
Validation loss decreased (-0.598673 --> -0.611832).  Saving model ...
Epoch: 5 cost time: 0.9828464984893799
Epoch: 5, Steps: 10 | Train Loss: 0.824 Vali Loss: 0.888 Vali Acc: 0.658 Test Loss: 0.888 Test Acc: 0.658
Validation loss decreased (-0.611832 --> -0.657886).  Saving model ...
Epoch: 6 cost time: 1.3169505596160889
Epoch: 6, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.830 Vali Acc: 0.671 Test Loss: 0.830 Test Acc: 0.671
Validation loss decreased (-0.657886 --> -0.671044).  Saving model ...
Epoch: 7 cost time: 1.1999220848083496
Epoch: 7, Steps: 10 | Train Loss: 0.557 Vali Loss: 0.809 Vali Acc: 0.638 Test Loss: 0.809 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5193476676940918
Epoch: 8, Steps: 10 | Train Loss: 0.437 Vali Loss: 0.664 Vali Acc: 0.704 Test Loss: 0.664 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703941).  Saving model ...
Epoch: 9 cost time: 1.064464807510376
Epoch: 9, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.533 Vali Acc: 0.770 Test Loss: 0.533 Test Acc: 0.770
Validation loss decreased (-0.703941 --> -0.769732).  Saving model ...
Epoch: 10 cost time: 0.9902019500732422
Epoch: 10, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.526 Vali Acc: 0.770 Test Loss: 0.526 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 11 cost time: 0.9140520095825195
Epoch: 11, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.582 Vali Acc: 0.750 Test Loss: 0.582 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.351790428161621
Epoch: 12, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.551 Vali Acc: 0.757 Test Loss: 0.551 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.275991678237915
Epoch: 13, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.701 Vali Acc: 0.743 Test Loss: 0.701 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1532433032989502
Epoch: 14, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.648 Vali Acc: 0.789 Test Loss: 0.648 Test Acc: 0.789
Validation loss decreased (-0.769732 --> -0.789467).  Saving model ...
Epoch: 15 cost time: 1.0607507228851318
Epoch: 15, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.716 Vali Acc: 0.783 Test Loss: 0.716 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.249450922012329
Epoch: 16, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.777 Vali Acc: 0.803 Test Loss: 0.777 Test Acc: 0.803
Validation loss decreased (-0.789467 --> -0.802624).  Saving model ...
Epoch: 17 cost time: 1.0561208724975586
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.808 Vali Acc: 0.796 Test Loss: 0.808 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1314294338226318
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.861 Vali Acc: 0.783 Test Loss: 0.861 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9296984672546387
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.851 Vali Acc: 0.789 Test Loss: 0.851 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9703915119171143
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.880 Vali Acc: 0.789 Test Loss: 0.880 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8526031970977783
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.919 Vali Acc: 0.789 Test Loss: 0.919 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1660645008087158
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.999 Vali Acc: 0.776 Test Loss: 0.999 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.9993932247161865
Epoch: 23, Steps: 10 | Train Loss: 0.014 Vali Loss: 1.228 Vali Acc: 0.809 Test Loss: 1.228 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809198).  Saving model ...
Epoch: 24 cost time: 1.0557029247283936
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 1.058 Vali Acc: 0.796 Test Loss: 1.058 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9478819370269775
Epoch: 25, Steps: 10 | Train Loss: 0.066 Vali Loss: 1.237 Vali Acc: 0.796 Test Loss: 1.237 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0472478866577148
Epoch: 26, Steps: 10 | Train Loss: 0.039 Vali Loss: 1.014 Vali Acc: 0.783 Test Loss: 1.014 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9394080638885498
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.055 Vali Acc: 0.783 Test Loss: 1.055 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0330452919006348
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 1.037 Vali Acc: 0.763 Test Loss: 1.037 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9190628528594971
Epoch: 29, Steps: 10 | Train Loss: 0.013 Vali Loss: 1.038 Vali Acc: 0.789 Test Loss: 1.038 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1503558158874512
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.126 Vali Acc: 0.783 Test Loss: 1.126 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9068224430084229
Epoch: 31, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.128 Vali Acc: 0.776 Test Loss: 1.128 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.951979398727417
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 1.318 Vali Acc: 0.783 Test Loss: 1.318 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0552091598510742
Epoch: 33, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.256 Vali Acc: 0.743 Test Loss: 1.256 Test Acc: 0.743
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 3989276
model size : 20.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.5297183990478516
Epoch: 1, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.404 Vali Acc: 0.243 Test Loss: 1.404 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.9799776077270508
Epoch: 2, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.318 Vali Acc: 0.368 Test Loss: 1.318 Test Acc: 0.368
Validation loss decreased (-0.243407 --> -0.368408).  Saving model ...
Epoch: 3 cost time: 1.0901412963867188
Epoch: 3, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.190 Vali Acc: 0.586 Test Loss: 1.190 Test Acc: 0.586
Validation loss decreased (-0.368408 --> -0.585514).  Saving model ...
Epoch: 4 cost time: 1.129824161529541
Epoch: 4, Steps: 10 | Train Loss: 1.080 Vali Loss: 1.059 Vali Acc: 0.651 Test Loss: 1.059 Test Acc: 0.651
Validation loss decreased (-0.585514 --> -0.651305).  Saving model ...
Epoch: 5 cost time: 1.1082675457000732
Epoch: 5, Steps: 10 | Train Loss: 0.899 Vali Loss: 0.996 Vali Acc: 0.638 Test Loss: 0.996 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9551568031311035
Epoch: 6, Steps: 10 | Train Loss: 0.742 Vali Loss: 0.912 Vali Acc: 0.625 Test Loss: 0.912 Test Acc: 0.625
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9330594539642334
Epoch: 7, Steps: 10 | Train Loss: 0.635 Vali Loss: 0.804 Vali Acc: 0.697 Test Loss: 0.804 Test Acc: 0.697
Validation loss decreased (-0.651305 --> -0.697360).  Saving model ...
Epoch: 8 cost time: 0.8684267997741699
Epoch: 8, Steps: 10 | Train Loss: 0.494 Vali Loss: 0.653 Vali Acc: 0.717 Test Loss: 0.653 Test Acc: 0.717
Validation loss decreased (-0.697360 --> -0.717099).  Saving model ...
Epoch: 9 cost time: 0.9168796539306641
Epoch: 9, Steps: 10 | Train Loss: 0.364 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
Validation loss decreased (-0.717099 --> -0.789468).  Saving model ...
Epoch: 10 cost time: 1.1015310287475586
Epoch: 10, Steps: 10 | Train Loss: 0.273 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 11 cost time: 0.9453291893005371
Epoch: 11, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.575 Vali Acc: 0.776 Test Loss: 0.575 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1062047481536865
Epoch: 12, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9975569248199463
Epoch: 13, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.526 Vali Acc: 0.783 Test Loss: 0.526 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8568868637084961
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.780 Vali Acc: 0.789 Test Loss: 0.780 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1389532089233398
Epoch: 15, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.595 Vali Acc: 0.803 Test Loss: 0.595 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.0853397846221924
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.684 Vali Acc: 0.796 Test Loss: 0.684 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2903828620910645
Epoch: 17, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.725 Vali Acc: 0.789 Test Loss: 0.725 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0136561393737793
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.805 Vali Acc: 0.789 Test Loss: 0.805 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.22715163230896
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.834 Vali Acc: 0.796 Test Loss: 0.834 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8949544429779053
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.937 Vali Acc: 0.803 Test Loss: 0.937 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2694716453552246
Epoch: 21, Steps: 10 | Train Loss: 0.006 Vali Loss: 1.003 Vali Acc: 0.803 Test Loss: 1.003 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9907758235931396
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.015 Vali Acc: 0.796 Test Loss: 1.015 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1680796146392822
Epoch: 23, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.024 Vali Acc: 0.796 Test Loss: 1.024 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0700047016143799
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.037 Vali Acc: 0.783 Test Loss: 1.037 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8587338924407959
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.044 Vali Acc: 0.783 Test Loss: 1.044 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 3597596
model size : 18.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5998260974884033
Epoch: 1, Steps: 10 | Train Loss: 1.421 Vali Loss: 1.364 Vali Acc: 0.329 Test Loss: 1.364 Test Acc: 0.329
Validation loss decreased (inf --> -0.328934).  Saving model ...
Epoch: 2 cost time: 1.1985211372375488
Epoch: 2, Steps: 10 | Train Loss: 1.329 Vali Loss: 1.267 Vali Acc: 0.474 Test Loss: 1.267 Test Acc: 0.474
Validation loss decreased (-0.328934 --> -0.473672).  Saving model ...
Epoch: 3 cost time: 1.2608897686004639
Epoch: 3, Steps: 10 | Train Loss: 1.189 Vali Loss: 1.156 Vali Acc: 0.559 Test Loss: 1.156 Test Acc: 0.559
Validation loss decreased (-0.473672 --> -0.559199).  Saving model ...
Epoch: 4 cost time: 1.0312657356262207
Epoch: 4, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.057 Vali Acc: 0.625 Test Loss: 1.057 Test Acc: 0.625
Validation loss decreased (-0.559199 --> -0.624989).  Saving model ...
Epoch: 5 cost time: 1.1243741512298584
Epoch: 5, Steps: 10 | Train Loss: 0.888 Vali Loss: 0.958 Vali Acc: 0.671 Test Loss: 0.958 Test Acc: 0.671
Validation loss decreased (-0.624989 --> -0.671043).  Saving model ...
Epoch: 6 cost time: 1.2402653694152832
Epoch: 6, Steps: 10 | Train Loss: 0.780 Vali Loss: 0.874 Vali Acc: 0.697 Test Loss: 0.874 Test Acc: 0.697
Validation loss decreased (-0.671043 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 1.1959092617034912
Epoch: 7, Steps: 10 | Train Loss: 0.610 Vali Loss: 0.741 Vali Acc: 0.711 Test Loss: 0.741 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710519).  Saving model ...
Epoch: 8 cost time: 0.9787824153900146
Epoch: 8, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.655 Vali Acc: 0.743 Test Loss: 0.655 Test Acc: 0.743
Validation loss decreased (-0.710519 --> -0.743415).  Saving model ...
Epoch: 9 cost time: 1.1781563758850098
Epoch: 9, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.585 Vali Acc: 0.770 Test Loss: 0.585 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 10 cost time: 0.9745967388153076
Epoch: 10, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.584 Vali Acc: 0.803 Test Loss: 0.584 Test Acc: 0.803
Validation loss decreased (-0.769731 --> -0.802626).  Saving model ...
Epoch: 11 cost time: 1.1641530990600586
Epoch: 11, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.492 Vali Acc: 0.763 Test Loss: 0.492 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.312424898147583
Epoch: 12, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.538 Vali Acc: 0.757 Test Loss: 0.538 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2884070873260498
Epoch: 13, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.552 Vali Acc: 0.776 Test Loss: 0.552 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2187395095825195
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.613 Vali Acc: 0.789 Test Loss: 0.613 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.973928689956665
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2422702312469482
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.741 Vali Acc: 0.796 Test Loss: 0.741 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.140998363494873
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.879 Vali Acc: 0.803 Test Loss: 0.879 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2619636058807373
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.991 Vali Acc: 0.796 Test Loss: 0.991 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1425693035125732
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 1.001 Vali Acc: 0.809 Test Loss: 1.001 Test Acc: 0.809
Validation loss decreased (-0.802626 --> -0.809201).  Saving model ...
Epoch: 20 cost time: 1.2028121948242188
Epoch: 20, Steps: 10 | Train Loss: 0.023 Vali Loss: 1.066 Vali Acc: 0.783 Test Loss: 1.066 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1803157329559326
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 1.044 Vali Acc: 0.796 Test Loss: 1.044 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1306746006011963
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.099 Vali Acc: 0.789 Test Loss: 1.099 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4913296699523926
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 1.114 Vali Acc: 0.796 Test Loss: 1.114 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.505208969116211
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.139 Vali Acc: 0.796 Test Loss: 1.139 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.4798638820648193
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.155 Vali Acc: 0.789 Test Loss: 1.155 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3502485752105713
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.171 Vali Acc: 0.796 Test Loss: 1.171 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.230098009109497
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.190 Vali Acc: 0.796 Test Loss: 1.190 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.181875467300415
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.204 Vali Acc: 0.796 Test Loss: 1.204 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.256988286972046
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.222 Vali Acc: 0.796 Test Loss: 1.222 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 3596828
model size : 18.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5428805351257324
Epoch: 1, Steps: 10 | Train Loss: 1.462 Vali Loss: 1.409 Vali Acc: 0.309 Test Loss: 1.409 Test Acc: 0.309
Validation loss decreased (inf --> -0.309196).  Saving model ...
Epoch: 2 cost time: 0.9982113838195801
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.336 Vali Acc: 0.395 Test Loss: 1.336 Test Acc: 0.395
Validation loss decreased (-0.309196 --> -0.394723).  Saving model ...
Epoch: 3 cost time: 1.093113899230957
Epoch: 3, Steps: 10 | Train Loss: 1.269 Vali Loss: 1.220 Vali Acc: 0.500 Test Loss: 1.220 Test Acc: 0.500
Validation loss decreased (-0.394723 --> -0.499988).  Saving model ...
Epoch: 4 cost time: 1.1496632099151611
Epoch: 4, Steps: 10 | Train Loss: 1.088 Vali Loss: 1.116 Vali Acc: 0.612 Test Loss: 1.116 Test Acc: 0.612
Validation loss decreased (-0.499988 --> -0.611831).  Saving model ...
Epoch: 5 cost time: 1.2494173049926758
Epoch: 5, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.035 Vali Acc: 0.612 Test Loss: 1.035 Test Acc: 0.612
Validation loss decreased (-0.611831 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 1.3011579513549805
Epoch: 6, Steps: 10 | Train Loss: 0.772 Vali Loss: 0.919 Vali Acc: 0.684 Test Loss: 0.919 Test Acc: 0.684
Validation loss decreased (-0.611832 --> -0.684201).  Saving model ...
Epoch: 7 cost time: 1.1408486366271973
Epoch: 7, Steps: 10 | Train Loss: 0.657 Vali Loss: 0.935 Vali Acc: 0.618 Test Loss: 0.935 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1120097637176514
Epoch: 8, Steps: 10 | Train Loss: 0.556 Vali Loss: 0.729 Vali Acc: 0.730 Test Loss: 0.729 Test Acc: 0.730
Validation loss decreased (-0.684201 --> -0.730256).  Saving model ...
Epoch: 9 cost time: 1.1477086544036865
Epoch: 9, Steps: 10 | Train Loss: 0.409 Vali Loss: 0.596 Vali Acc: 0.757 Test Loss: 0.596 Test Acc: 0.757
Validation loss decreased (-0.730256 --> -0.756573).  Saving model ...
Epoch: 10 cost time: 1.168811559677124
Epoch: 10, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.584 Vali Acc: 0.770 Test Loss: 0.584 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 11 cost time: 1.4796345233917236
Epoch: 11, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.526 Vali Acc: 0.750 Test Loss: 0.526 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.155637502670288
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.518 Vali Acc: 0.770 Test Loss: 0.518 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 13 cost time: 0.8809421062469482
Epoch: 13, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.620 Vali Acc: 0.776 Test Loss: 0.620 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.0152146816253662
Epoch: 14, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.611 Vali Acc: 0.803 Test Loss: 0.611 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802625).  Saving model ...
Epoch: 15 cost time: 0.970043420791626
Epoch: 15, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0137414932250977
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.639 Vali Acc: 0.783 Test Loss: 0.639 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1361310482025146
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.702 Vali Acc: 0.789 Test Loss: 0.702 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.990870475769043
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.761 Vali Acc: 0.783 Test Loss: 0.761 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0125930309295654
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.821 Vali Acc: 0.796 Test Loss: 0.821 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1897125244140625
Epoch: 20, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.822 Vali Acc: 0.809 Test Loss: 0.822 Test Acc: 0.809
Validation loss decreased (-0.802625 --> -0.809202).  Saving model ...
Epoch: 21 cost time: 1.232609748840332
Epoch: 21, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.845 Vali Acc: 0.816 Test Loss: 0.845 Test Acc: 0.816
Validation loss decreased (-0.809202 --> -0.815781).  Saving model ...
Epoch: 22 cost time: 1.0485918521881104
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.876 Vali Acc: 0.816 Test Loss: 0.876 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9879899024963379
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.897 Vali Acc: 0.809 Test Loss: 0.897 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0120422840118408
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.916 Vali Acc: 0.816 Test Loss: 0.916 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0763599872589111
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.929 Vali Acc: 0.809 Test Loss: 0.929 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.213165521621704
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.954 Vali Acc: 0.822 Test Loss: 0.954 Test Acc: 0.822
Validation loss decreased (-0.815781 --> -0.822359).  Saving model ...
Epoch: 27 cost time: 1.0374011993408203
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.967 Vali Acc: 0.809 Test Loss: 0.967 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.05686616897583
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.985 Vali Acc: 0.803 Test Loss: 0.985 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3310778141021729
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.816 Test Loss: 0.995 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9458446502685547
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.003 Vali Acc: 0.829 Test Loss: 1.003 Test Acc: 0.829
Validation loss decreased (-0.822359 --> -0.828937).  Saving model ...
Epoch: 31 cost time: 1.1724352836608887
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.018 Vali Acc: 0.803 Test Loss: 1.018 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.976271390914917
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.037 Vali Acc: 0.803 Test Loss: 1.037 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.080883264541626
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.051 Vali Acc: 0.816 Test Loss: 1.051 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1485097408294678
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.058 Vali Acc: 0.809 Test Loss: 1.058 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.028630256652832
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.068 Vali Acc: 0.803 Test Loss: 1.068 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.35280179977417
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.078 Vali Acc: 0.822 Test Loss: 1.078 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.3246955871582031
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.093 Vali Acc: 0.822 Test Loss: 1.093 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0337958335876465
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.108 Vali Acc: 0.816 Test Loss: 1.108 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0884850025177002
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.123 Vali Acc: 0.822 Test Loss: 1.123 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0704371929168701
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.133 Vali Acc: 0.822 Test Loss: 1.133 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 3596060
model size : 18.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.211529493331909
Epoch: 1, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.441 Vali Acc: 0.184 Test Loss: 1.441 Test Acc: 0.184
Validation loss decreased (inf --> -0.184196).  Saving model ...
Epoch: 2 cost time: 1.058377981185913
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.336 Vali Acc: 0.342 Test Loss: 1.336 Test Acc: 0.342
Validation loss decreased (-0.184196 --> -0.342092).  Saving model ...
Epoch: 3 cost time: 1.1244220733642578
Epoch: 3, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.220 Vali Acc: 0.553 Test Loss: 1.220 Test Acc: 0.553
Validation loss decreased (-0.342092 --> -0.552619).  Saving model ...
Epoch: 4 cost time: 1.1296639442443848
Epoch: 4, Steps: 10 | Train Loss: 1.098 Vali Loss: 1.100 Vali Acc: 0.572 Test Loss: 1.100 Test Acc: 0.572
Validation loss decreased (-0.552619 --> -0.572357).  Saving model ...
Epoch: 5 cost time: 1.41241455078125
Epoch: 5, Steps: 10 | Train Loss: 0.913 Vali Loss: 0.998 Vali Acc: 0.632 Test Loss: 0.998 Test Acc: 0.632
Validation loss decreased (-0.572357 --> -0.631569).  Saving model ...
Epoch: 6 cost time: 1.2784059047698975
Epoch: 6, Steps: 10 | Train Loss: 0.715 Vali Loss: 0.880 Vali Acc: 0.678 Test Loss: 0.880 Test Acc: 0.678
Validation loss decreased (-0.631569 --> -0.677623).  Saving model ...
Epoch: 7 cost time: 1.3069703578948975
Epoch: 7, Steps: 10 | Train Loss: 0.626 Vali Loss: 0.818 Vali Acc: 0.645 Test Loss: 0.818 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1049556732177734
Epoch: 8, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.711 Vali Acc: 0.743 Test Loss: 0.711 Test Acc: 0.743
Validation loss decreased (-0.677623 --> -0.743414).  Saving model ...
Epoch: 9 cost time: 1.486527442932129
Epoch: 9, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.585 Vali Acc: 0.737 Test Loss: 0.585 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7152655124664307
Epoch: 10, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 11 cost time: 1.2078931331634521
Epoch: 11, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.653 Vali Acc: 0.770 Test Loss: 0.653 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 1.235823631286621
Epoch: 12, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.593 Vali Acc: 0.789 Test Loss: 0.593 Test Acc: 0.789
Validation loss decreased (-0.769730 --> -0.789468).  Saving model ...
Epoch: 13 cost time: 1.0209405422210693
Epoch: 13, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2172608375549316
Epoch: 14, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.555 Vali Acc: 0.789 Test Loss: 0.555 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.038041591644287
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 16 cost time: 1.3259623050689697
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.724 Vali Acc: 0.816 Test Loss: 0.724 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815782).  Saving model ...
Epoch: 17 cost time: 1.3594458103179932
Epoch: 17, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.671 Vali Acc: 0.803 Test Loss: 0.671 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3069465160369873
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.787 Vali Acc: 0.803 Test Loss: 0.787 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2738378047943115
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.813 Vali Acc: 0.789 Test Loss: 0.813 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1311185359954834
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.811 Vali Acc: 0.803 Test Loss: 0.811 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0978424549102783
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.883 Vali Acc: 0.789 Test Loss: 0.883 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2152273654937744
Epoch: 22, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.971 Vali Acc: 0.796 Test Loss: 0.971 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3005964756011963
Epoch: 23, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.054 Vali Acc: 0.796 Test Loss: 1.054 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2086963653564453
Epoch: 24, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.974 Vali Acc: 0.803 Test Loss: 0.974 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.20640230178833
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.898 Vali Acc: 0.783 Test Loss: 0.898 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.03955078125
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.878 Vali Acc: 0.789 Test Loss: 0.878 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 3595292
model size : 18.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.051524877548218
Epoch: 1, Steps: 10 | Train Loss: 1.551 Vali Loss: 1.416 Vali Acc: 0.243 Test Loss: 1.416 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.9751994609832764
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.333 Vali Acc: 0.329 Test Loss: 1.333 Test Acc: 0.329
Validation loss decreased (-0.243407 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 1.1675333976745605
Epoch: 3, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.259 Vali Acc: 0.408 Test Loss: 1.259 Test Acc: 0.408
Validation loss decreased (-0.328934 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 0.9677095413208008
Epoch: 4, Steps: 10 | Train Loss: 1.083 Vali Loss: 1.100 Vali Acc: 0.533 Test Loss: 1.100 Test Acc: 0.533
Validation loss decreased (-0.407882 --> -0.532884).  Saving model ...
Epoch: 5 cost time: 1.0247802734375
Epoch: 5, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.015 Vali Acc: 0.599 Test Loss: 1.015 Test Acc: 0.599
Validation loss decreased (-0.532884 --> -0.598674).  Saving model ...
Epoch: 6 cost time: 1.1647112369537354
Epoch: 6, Steps: 10 | Train Loss: 0.772 Vali Loss: 0.843 Vali Acc: 0.697 Test Loss: 0.843 Test Acc: 0.697
Validation loss decreased (-0.598674 --> -0.697360).  Saving model ...
Epoch: 7 cost time: 1.4876198768615723
Epoch: 7, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.744 Vali Acc: 0.737 Test Loss: 0.744 Test Acc: 0.737
Validation loss decreased (-0.697360 --> -0.736835).  Saving model ...
Epoch: 8 cost time: 1.2623035907745361
Epoch: 8, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.625 Vali Acc: 0.763 Test Loss: 0.625 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763152).  Saving model ...
Epoch: 9 cost time: 0.921130895614624
Epoch: 9, Steps: 10 | Train Loss: 0.339 Vali Loss: 0.550 Vali Acc: 0.743 Test Loss: 0.550 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1824345588684082
Epoch: 10, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.519 Vali Acc: 0.783 Test Loss: 0.519 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782890).  Saving model ...
Epoch: 11 cost time: 1.1934595108032227
Epoch: 11, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.037419319152832
Epoch: 12, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.543 Vali Acc: 0.757 Test Loss: 0.543 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2960283756256104
Epoch: 13, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3954432010650635
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.611 Vali Acc: 0.776 Test Loss: 0.611 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1715948581695557
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.640 Vali Acc: 0.796 Test Loss: 0.640 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 16 cost time: 1.3657877445220947
Epoch: 16, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.764 Vali Acc: 0.803 Test Loss: 0.764 Test Acc: 0.803
Validation loss decreased (-0.796046 --> -0.802624).  Saving model ...
Epoch: 17 cost time: 1.1463782787322998
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.955 Vali Acc: 0.776 Test Loss: 0.955 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1518819332122803
Epoch: 18, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.895 Vali Acc: 0.789 Test Loss: 0.895 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.649871826171875
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.897 Vali Acc: 0.763 Test Loss: 0.897 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1426711082458496
Epoch: 20, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.927 Vali Acc: 0.809 Test Loss: 0.927 Test Acc: 0.809
Validation loss decreased (-0.802624 --> -0.809201).  Saving model ...
Epoch: 21 cost time: 1.3168611526489258
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.890 Vali Acc: 0.776 Test Loss: 0.890 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1328883171081543
Epoch: 22, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.930 Vali Acc: 0.796 Test Loss: 0.930 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3982431888580322
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.989 Vali Acc: 0.803 Test Loss: 0.989 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.5028233528137207
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.050 Vali Acc: 0.809 Test Loss: 1.050 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5603241920471191
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.053 Vali Acc: 0.809 Test Loss: 1.053 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3429629802703857
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.060 Vali Acc: 0.803 Test Loss: 1.060 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8971936702728271
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.075 Vali Acc: 0.809 Test Loss: 1.075 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.367630958557129
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.089 Vali Acc: 0.809 Test Loss: 1.089 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.324937105178833
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.089 Vali Acc: 0.803 Test Loss: 1.089 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1805164813995361
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.105 Vali Acc: 0.803 Test Loss: 1.105 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 3400604
model size : 17.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3773181438446045
Epoch: 1, Steps: 10 | Train Loss: 1.468 Vali Loss: 1.376 Vali Acc: 0.322 Test Loss: 1.376 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.1919856071472168
Epoch: 2, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.301 Vali Acc: 0.309 Test Loss: 1.301 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5018799304962158
Epoch: 3, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.175 Vali Acc: 0.651 Test Loss: 1.175 Test Acc: 0.651
Validation loss decreased (-0.322355 --> -0.651304).  Saving model ...
Epoch: 4 cost time: 0.9687273502349854
Epoch: 4, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.060 Vali Acc: 0.730 Test Loss: 1.060 Test Acc: 0.730
Validation loss decreased (-0.651304 --> -0.730253).  Saving model ...
Epoch: 5 cost time: 1.1528418064117432
Epoch: 5, Steps: 10 | Train Loss: 0.923 Vali Loss: 0.962 Vali Acc: 0.691 Test Loss: 0.962 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.299269676208496
Epoch: 6, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.859 Vali Acc: 0.711 Test Loss: 0.859 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1868157386779785
Epoch: 7, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
Validation loss decreased (-0.730253 --> -0.763151).  Saving model ...
Epoch: 8 cost time: 1.2314155101776123
Epoch: 8, Steps: 10 | Train Loss: 0.478 Vali Loss: 0.683 Vali Acc: 0.717 Test Loss: 0.683 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6907958984375
Epoch: 9, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.611 Vali Acc: 0.750 Test Loss: 0.611 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1728949546813965
Epoch: 10, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
Validation loss decreased (-0.763151 --> -0.796047).  Saving model ...
Epoch: 11 cost time: 1.0884981155395508
Epoch: 11, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.473 Vali Acc: 0.789 Test Loss: 0.473 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.228905200958252
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.508 Vali Acc: 0.750 Test Loss: 0.508 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2399907112121582
Epoch: 13, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.535 Vali Acc: 0.783 Test Loss: 0.535 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3122899532318115
Epoch: 14, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 15 cost time: 1.1882591247558594
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.636 Vali Acc: 0.816 Test Loss: 0.636 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 16 cost time: 1.0897390842437744
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.795 Vali Acc: 0.783 Test Loss: 0.795 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3297655582427979
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.836 Vali Acc: 0.796 Test Loss: 0.836 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.31510591506958
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.869 Vali Acc: 0.796 Test Loss: 0.869 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4880955219268799
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.902 Vali Acc: 0.796 Test Loss: 0.902 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2755544185638428
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 1.039 Vali Acc: 0.783 Test Loss: 1.039 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5120584964752197
Epoch: 21, Steps: 10 | Train Loss: 0.005 Vali Loss: 1.056 Vali Acc: 0.783 Test Loss: 1.056 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0762245655059814
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.117 Vali Acc: 0.776 Test Loss: 1.117 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.312833309173584
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 1.011 Vali Acc: 0.789 Test Loss: 1.011 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2036352157592773
Epoch: 24, Steps: 10 | Train Loss: 0.004 Vali Loss: 1.060 Vali Acc: 0.783 Test Loss: 1.060 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5510008335113525
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.066 Vali Acc: 0.803 Test Loss: 1.066 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 3399836
model size : 17.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.9705302715301514
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.429 Vali Acc: 0.243 Test Loss: 1.429 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.1272215843200684
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.331 Vali Acc: 0.336 Test Loss: 1.331 Test Acc: 0.336
Validation loss decreased (-0.243407 --> -0.335513).  Saving model ...
Epoch: 3 cost time: 1.3645706176757812
Epoch: 3, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.223 Vali Acc: 0.474 Test Loss: 1.223 Test Acc: 0.474
Validation loss decreased (-0.335513 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 1.051814317703247
Epoch: 4, Steps: 10 | Train Loss: 1.062 Vali Loss: 1.133 Vali Acc: 0.559 Test Loss: 1.133 Test Acc: 0.559
Validation loss decreased (-0.473672 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.0231988430023193
Epoch: 5, Steps: 10 | Train Loss: 0.858 Vali Loss: 0.990 Vali Acc: 0.612 Test Loss: 0.990 Test Acc: 0.612
Validation loss decreased (-0.559199 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 1.0541982650756836
Epoch: 6, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.945 Vali Acc: 0.632 Test Loss: 0.945 Test Acc: 0.632
Validation loss decreased (-0.611832 --> -0.631569).  Saving model ...
Epoch: 7 cost time: 1.0358796119689941
Epoch: 7, Steps: 10 | Train Loss: 0.606 Vali Loss: 0.725 Vali Acc: 0.743 Test Loss: 0.725 Test Acc: 0.743
Validation loss decreased (-0.631569 --> -0.743414).  Saving model ...
Epoch: 8 cost time: 1.3952231407165527
Epoch: 8, Steps: 10 | Train Loss: 0.453 Vali Loss: 0.649 Vali Acc: 0.757 Test Loss: 0.649 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756572).  Saving model ...
Epoch: 9 cost time: 1.1155445575714111
Epoch: 9, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 10 cost time: 1.1714022159576416
Epoch: 10, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.513 Vali Acc: 0.763 Test Loss: 0.513 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0923247337341309
Epoch: 11, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 12 cost time: 1.0413284301757812
Epoch: 12, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.531 Vali Acc: 0.750 Test Loss: 0.531 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.077063798904419
Epoch: 13, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.574 Vali Acc: 0.783 Test Loss: 0.574 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.004206657409668
Epoch: 14, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.728 Vali Acc: 0.757 Test Loss: 0.728 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.107853889465332
Epoch: 15, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.772 Vali Acc: 0.796 Test Loss: 0.772 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796045).  Saving model ...
Epoch: 16 cost time: 1.1749963760375977
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.727 Vali Acc: 0.783 Test Loss: 0.727 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.105940341949463
Epoch: 17, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.769 Vali Acc: 0.770 Test Loss: 0.769 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6212377548217773
Epoch: 18, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.862 Vali Acc: 0.789 Test Loss: 0.862 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3207857608795166
Epoch: 19, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.893 Vali Acc: 0.783 Test Loss: 0.893 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9867844581604004
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.928 Vali Acc: 0.789 Test Loss: 0.928 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0065853595733643
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.927 Vali Acc: 0.796 Test Loss: 0.927 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2479355335235596
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.974 Vali Acc: 0.796 Test Loss: 0.974 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0397708415985107
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.041 Vali Acc: 0.803 Test Loss: 1.041 Test Acc: 0.803
Validation loss decreased (-0.796045 --> -0.802621).  Saving model ...
Epoch: 24 cost time: 1.1152775287628174
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.030 Vali Acc: 0.789 Test Loss: 1.030 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.173250436782837
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.796 Test Loss: 1.027 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.220592737197876
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.031 Vali Acc: 0.796 Test Loss: 1.031 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.2264747619628906
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.034 Vali Acc: 0.803 Test Loss: 1.034 Test Acc: 0.803
Validation loss decreased (-0.802621 --> -0.802621).  Saving model ...
Epoch: 28 cost time: 1.0195331573486328
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 1.059 Vali Acc: 0.789 Test Loss: 1.059 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0387685298919678
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.059 Vali Acc: 0.789 Test Loss: 1.059 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8970673084259033
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.059 Vali Acc: 0.796 Test Loss: 1.059 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.330916166305542
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.048 Vali Acc: 0.796 Test Loss: 1.048 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1549146175384521
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.044 Vali Acc: 0.789 Test Loss: 1.044 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0061640739440918
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.050 Vali Acc: 0.809 Test Loss: 1.050 Test Acc: 0.809
Validation loss decreased (-0.802621 --> -0.809200).  Saving model ...
Epoch: 34 cost time: 1.1303954124450684
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.092 Vali Acc: 0.803 Test Loss: 1.092 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1859407424926758
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.103 Vali Acc: 0.803 Test Loss: 1.103 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9228487014770508
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.099 Vali Acc: 0.809 Test Loss: 1.099 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.9773168563842773
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.107 Vali Acc: 0.809 Test Loss: 1.107 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9851350784301758
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.122 Vali Acc: 0.803 Test Loss: 1.122 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0809924602508545
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.129 Vali Acc: 0.803 Test Loss: 1.129 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.2172245979309082
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.146 Vali Acc: 0.796 Test Loss: 1.146 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9513704776763916
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.137 Vali Acc: 0.796 Test Loss: 1.137 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0059058666229248
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.144 Vali Acc: 0.796 Test Loss: 1.144 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.0729913711547852
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 1.149 Vali Acc: 0.796 Test Loss: 1.149 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 3399068
model size : 17.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.118040084838867
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.455 Vali Acc: 0.230 Test Loss: 1.455 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.1165592670440674
Epoch: 2, Steps: 10 | Train Loss: 1.386 Vali Loss: 1.356 Vali Acc: 0.329 Test Loss: 1.356 Test Acc: 0.329
Validation loss decreased (-0.230249 --> -0.328934).  Saving model ...
Epoch: 3 cost time: 0.9932422637939453
Epoch: 3, Steps: 10 | Train Loss: 1.226 Vali Loss: 1.263 Vali Acc: 0.441 Test Loss: 1.263 Test Acc: 0.441
Validation loss decreased (-0.328934 --> -0.440777).  Saving model ...
Epoch: 4 cost time: 1.5069448947906494
Epoch: 4, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.124 Vali Acc: 0.533 Test Loss: 1.124 Test Acc: 0.533
Validation loss decreased (-0.440777 --> -0.532883).  Saving model ...
Epoch: 5 cost time: 1.3864085674285889
Epoch: 5, Steps: 10 | Train Loss: 0.935 Vali Loss: 0.996 Vali Acc: 0.612 Test Loss: 0.996 Test Acc: 0.612
Validation loss decreased (-0.532883 --> -0.611832).  Saving model ...
Epoch: 6 cost time: 1.1319355964660645
Epoch: 6, Steps: 10 | Train Loss: 0.738 Vali Loss: 0.858 Vali Acc: 0.711 Test Loss: 0.858 Test Acc: 0.711
Validation loss decreased (-0.611832 --> -0.710518).  Saving model ...
Epoch: 7 cost time: 1.1235404014587402
Epoch: 7, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.734 Vali Acc: 0.730 Test Loss: 0.734 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730256).  Saving model ...
Epoch: 8 cost time: 1.1647469997406006
Epoch: 8, Steps: 10 | Train Loss: 0.454 Vali Loss: 0.641 Vali Acc: 0.750 Test Loss: 0.641 Test Acc: 0.750
Validation loss decreased (-0.730256 --> -0.749994).  Saving model ...
Epoch: 9 cost time: 1.078019142150879
Epoch: 9, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.692 Vali Acc: 0.724 Test Loss: 0.692 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9496369361877441
Epoch: 10, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.531 Vali Acc: 0.783 Test Loss: 0.531 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 11 cost time: 1.0380146503448486
Epoch: 11, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.591 Vali Acc: 0.763 Test Loss: 0.591 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.82460618019104
Epoch: 12, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.496 Vali Acc: 0.776 Test Loss: 0.496 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0210208892822266
Epoch: 13, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8238515853881836
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.654 Vali Acc: 0.789 Test Loss: 0.654 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789467).  Saving model ...
Epoch: 15 cost time: 1.0025386810302734
Epoch: 15, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.802 Vali Acc: 0.789 Test Loss: 0.802 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0634210109710693
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.823 Vali Acc: 0.796 Test Loss: 0.823 Test Acc: 0.796
Validation loss decreased (-0.789467 --> -0.796044).  Saving model ...
Epoch: 17 cost time: 0.9977819919586182
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.851 Vali Acc: 0.803 Test Loss: 0.851 Test Acc: 0.803
Validation loss decreased (-0.796044 --> -0.802623).  Saving model ...
Epoch: 18 cost time: 1.6066412925720215
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.780 Vali Acc: 0.789 Test Loss: 0.780 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9063899517059326
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.886 Vali Acc: 0.809 Test Loss: 0.886 Test Acc: 0.809
Validation loss decreased (-0.802623 --> -0.809202).  Saving model ...
Epoch: 20 cost time: 0.9173290729522705
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.959 Vali Acc: 0.809 Test Loss: 0.959 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9389529228210449
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 1.045 Vali Acc: 0.796 Test Loss: 1.045 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.035762071609497
Epoch: 22, Steps: 10 | Train Loss: 0.043 Vali Loss: 1.007 Vali Acc: 0.783 Test Loss: 1.007 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.077545166015625
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.953 Vali Acc: 0.789 Test Loss: 0.953 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.2699179649353027
Epoch: 24, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.945 Vali Acc: 0.796 Test Loss: 0.945 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1988482475280762
Epoch: 25, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.914 Vali Acc: 0.803 Test Loss: 0.914 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1716628074645996
Epoch: 26, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.901 Vali Acc: 0.803 Test Loss: 0.901 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2996907234191895
Epoch: 27, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.890 Vali Acc: 0.789 Test Loss: 0.890 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3685219287872314
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.905 Vali Acc: 0.776 Test Loss: 0.905 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3278443813323975
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.902 Vali Acc: 0.783 Test Loss: 0.902 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 3398300
model size : 17.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.693317174911499
Epoch: 1, Steps: 10 | Train Loss: 1.556 Vali Loss: 1.466 Vali Acc: 0.243 Test Loss: 1.466 Test Acc: 0.243
Validation loss decreased (inf --> -0.243406).  Saving model ...
Epoch: 2 cost time: 0.9668705463409424
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.392 Vali Acc: 0.263 Test Loss: 1.392 Test Acc: 0.263
Validation loss decreased (-0.243406 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 0.8091287612915039
Epoch: 3, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.318 Vali Acc: 0.336 Test Loss: 1.318 Test Acc: 0.336
Validation loss decreased (-0.263144 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 1.2342529296875
Epoch: 4, Steps: 10 | Train Loss: 1.184 Vali Loss: 1.205 Vali Acc: 0.566 Test Loss: 1.205 Test Acc: 0.566
Validation loss decreased (-0.335513 --> -0.565777).  Saving model ...
Epoch: 5 cost time: 1.2462542057037354
Epoch: 5, Steps: 10 | Train Loss: 1.044 Vali Loss: 1.110 Vali Acc: 0.605 Test Loss: 1.110 Test Acc: 0.605
Validation loss decreased (-0.565777 --> -0.605252).  Saving model ...
Epoch: 6 cost time: 0.928436279296875
Epoch: 6, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.006 Vali Acc: 0.671 Test Loss: 1.006 Test Acc: 0.671
Validation loss decreased (-0.605252 --> -0.671043).  Saving model ...
Epoch: 7 cost time: 1.0770418643951416
Epoch: 7, Steps: 10 | Train Loss: 0.799 Vali Loss: 0.916 Vali Acc: 0.678 Test Loss: 0.916 Test Acc: 0.678
Validation loss decreased (-0.671043 --> -0.677622).  Saving model ...
Epoch: 8 cost time: 1.023705244064331
Epoch: 8, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.845 Vali Acc: 0.697 Test Loss: 0.845 Test Acc: 0.697
Validation loss decreased (-0.677622 --> -0.697360).  Saving model ...
Epoch: 9 cost time: 1.0285508632659912
Epoch: 9, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.772 Vali Acc: 0.730 Test Loss: 0.772 Test Acc: 0.730
Validation loss decreased (-0.697360 --> -0.730255).  Saving model ...
Epoch: 10 cost time: 0.8387460708618164
Epoch: 10, Steps: 10 | Train Loss: 0.439 Vali Loss: 0.676 Vali Acc: 0.730 Test Loss: 0.676 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.0445096492767334
Epoch: 11, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.609 Vali Acc: 0.743 Test Loss: 0.609 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 12 cost time: 1.1699306964874268
Epoch: 12, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.575 Vali Acc: 0.750 Test Loss: 0.575 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 0.9162454605102539
Epoch: 13, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.553 Vali Acc: 0.757 Test Loss: 0.553 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 0.945162296295166
Epoch: 14, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.577 Vali Acc: 0.783 Test Loss: 0.577 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 15 cost time: 1.0608158111572266
Epoch: 15, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.2310495376586914
Epoch: 16, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.523 Vali Acc: 0.776 Test Loss: 0.523 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8380823135375977
Epoch: 17, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.556 Vali Acc: 0.803 Test Loss: 0.556 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 18 cost time: 1.0860316753387451
Epoch: 18, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.543 Vali Acc: 0.783 Test Loss: 0.543 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3329932689666748
Epoch: 19, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.608 Vali Acc: 0.816 Test Loss: 0.608 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815783).  Saving model ...
Epoch: 20 cost time: 1.1826331615447998
Epoch: 20, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.563 Vali Acc: 0.789 Test Loss: 0.563 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3354320526123047
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.693 Vali Acc: 0.789 Test Loss: 0.693 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2530627250671387
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.615 Vali Acc: 0.809 Test Loss: 0.615 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9043087959289551
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.612 Vali Acc: 0.789 Test Loss: 0.612 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9831914901733398
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.639 Vali Acc: 0.796 Test Loss: 0.639 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8979396820068359
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.666 Vali Acc: 0.789 Test Loss: 0.666 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9951090812683105
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.695 Vali Acc: 0.789 Test Loss: 0.695 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8195092678070068
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.718 Vali Acc: 0.796 Test Loss: 0.718 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1778082847595215
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.734 Vali Acc: 0.796 Test Loss: 0.734 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0604665279388428
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.751 Vali Acc: 0.809 Test Loss: 0.751 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1604892
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1126484870910645
Epoch: 1, Steps: 10 | Train Loss: 1.443 Vali Loss: 1.411 Vali Acc: 0.243 Test Loss: 1.411 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 0.9167807102203369
Epoch: 2, Steps: 10 | Train Loss: 1.409 Vali Loss: 1.390 Vali Acc: 0.342 Test Loss: 1.390 Test Acc: 0.342
Validation loss decreased (-0.243407 --> -0.342091).  Saving model ...
Epoch: 3 cost time: 0.9917538166046143
Epoch: 3, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.258 Vali Acc: 0.441 Test Loss: 1.258 Test Acc: 0.441
Validation loss decreased (-0.342091 --> -0.440777).  Saving model ...
Epoch: 4 cost time: 1.0133380889892578
Epoch: 4, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.191 Vali Acc: 0.559 Test Loss: 1.191 Test Acc: 0.559
Validation loss decreased (-0.440777 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 0.8806390762329102
Epoch: 5, Steps: 10 | Train Loss: 1.024 Vali Loss: 1.063 Vali Acc: 0.553 Test Loss: 1.063 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0926833152770996
Epoch: 6, Steps: 10 | Train Loss: 0.854 Vali Loss: 0.965 Vali Acc: 0.605 Test Loss: 0.965 Test Acc: 0.605
Validation loss decreased (-0.559199 --> -0.605254).  Saving model ...
Epoch: 7 cost time: 1.531473159790039
Epoch: 7, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.859 Vali Acc: 0.645 Test Loss: 0.859 Test Acc: 0.645
Validation loss decreased (-0.605254 --> -0.644728).  Saving model ...
Epoch: 8 cost time: 1.2179932594299316
Epoch: 8, Steps: 10 | Train Loss: 0.605 Vali Loss: 0.771 Vali Acc: 0.678 Test Loss: 0.771 Test Acc: 0.678
Validation loss decreased (-0.644728 --> -0.677624).  Saving model ...
Epoch: 9 cost time: 0.9621982574462891
Epoch: 9, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.682 Vali Acc: 0.717 Test Loss: 0.682 Test Acc: 0.717
Validation loss decreased (-0.677624 --> -0.717098).  Saving model ...
Epoch: 10 cost time: 1.2373621463775635
Epoch: 10, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.646 Vali Acc: 0.770 Test Loss: 0.646 Test Acc: 0.770
Validation loss decreased (-0.717098 --> -0.769730).  Saving model ...
Epoch: 11 cost time: 0.9373743534088135
Epoch: 11, Steps: 10 | Train Loss: 0.336 Vali Loss: 0.593 Vali Acc: 0.757 Test Loss: 0.593 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9385745525360107
Epoch: 12, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.555 Vali Acc: 0.783 Test Loss: 0.555 Test Acc: 0.783
Validation loss decreased (-0.769730 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 0.805656909942627
Epoch: 13, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.533 Vali Acc: 0.763 Test Loss: 0.533 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8865020275115967
Epoch: 14, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.494 Vali Acc: 0.763 Test Loss: 0.494 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0055603981018066
Epoch: 15, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.481 Vali Acc: 0.757 Test Loss: 0.481 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.881019115447998
Epoch: 16, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.491 Vali Acc: 0.776 Test Loss: 0.491 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9023106098175049
Epoch: 17, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.504 Vali Acc: 0.796 Test Loss: 0.504 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796048).  Saving model ...
Epoch: 18 cost time: 0.910759449005127
Epoch: 18, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.512 Vali Acc: 0.796 Test Loss: 0.512 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9438052177429199
Epoch: 19, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0324628353118896
Epoch: 20, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.533 Vali Acc: 0.809 Test Loss: 0.533 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 21 cost time: 0.9583299160003662
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8694276809692383
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.559 Vali Acc: 0.796 Test Loss: 0.559 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9573757648468018
Epoch: 23, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.605 Vali Acc: 0.803 Test Loss: 0.605 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0162596702575684
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.641 Vali Acc: 0.803 Test Loss: 0.641 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2031733989715576
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.605 Vali Acc: 0.789 Test Loss: 0.605 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9736320972442627
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.596 Vali Acc: 0.809 Test Loss: 0.596 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9262120723724365
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.606 Vali Acc: 0.789 Test Loss: 0.606 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.543330192565918
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.631 Vali Acc: 0.803 Test Loss: 0.631 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0393879413604736
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1013462543487549
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1604508
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.5553975105285645
Epoch: 1, Steps: 10 | Train Loss: 1.439 Vali Loss: 1.382 Vali Acc: 0.237 Test Loss: 1.382 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.092099666595459
Epoch: 2, Steps: 10 | Train Loss: 1.431 Vali Loss: 1.358 Vali Acc: 0.263 Test Loss: 1.358 Test Acc: 0.263
Validation loss decreased (-0.236828 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 0.8852605819702148
Epoch: 3, Steps: 10 | Train Loss: 1.296 Vali Loss: 1.254 Vali Acc: 0.421 Test Loss: 1.254 Test Acc: 0.421
Validation loss decreased (-0.263144 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 0.9429795742034912
Epoch: 4, Steps: 10 | Train Loss: 1.150 Vali Loss: 1.174 Vali Acc: 0.526 Test Loss: 1.174 Test Acc: 0.526
Validation loss decreased (-0.421040 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 0.9783518314361572
Epoch: 5, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.069 Vali Acc: 0.625 Test Loss: 1.069 Test Acc: 0.625
Validation loss decreased (-0.526304 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.0411112308502197
Epoch: 6, Steps: 10 | Train Loss: 0.891 Vali Loss: 0.967 Vali Acc: 0.638 Test Loss: 0.967 Test Acc: 0.638
Validation loss decreased (-0.624989 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 1.0004804134368896
Epoch: 7, Steps: 10 | Train Loss: 0.735 Vali Loss: 0.860 Vali Acc: 0.671 Test Loss: 0.860 Test Acc: 0.671
Validation loss decreased (-0.638148 --> -0.671044).  Saving model ...
Epoch: 8 cost time: 1.164762020111084
Epoch: 8, Steps: 10 | Train Loss: 0.595 Vali Loss: 0.770 Vali Acc: 0.691 Test Loss: 0.770 Test Acc: 0.691
Validation loss decreased (-0.671044 --> -0.690782).  Saving model ...
Epoch: 9 cost time: 1.0627591609954834
Epoch: 9, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.690 Vali Acc: 0.730 Test Loss: 0.690 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730256).  Saving model ...
Epoch: 10 cost time: 1.0557658672332764
Epoch: 10, Steps: 10 | Train Loss: 0.386 Vali Loss: 0.655 Vali Acc: 0.743 Test Loss: 0.655 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 11 cost time: 1.1766207218170166
Epoch: 11, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 12 cost time: 0.9987180233001709
Epoch: 12, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.1180932521820068
Epoch: 13, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.514 Vali Acc: 0.743 Test Loss: 0.514 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0745558738708496
Epoch: 14, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.008683204650879
Epoch: 15, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.1158638000488281
Epoch: 16, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.467 Vali Acc: 0.789 Test Loss: 0.467 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 17 cost time: 1.163271427154541
Epoch: 17, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.487 Vali Acc: 0.796 Test Loss: 0.487 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 18 cost time: 1.1153361797332764
Epoch: 18, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.315657615661621
Epoch: 19, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.510 Vali Acc: 0.796 Test Loss: 0.510 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2477428913116455
Epoch: 20, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 1.2383418083190918
Epoch: 21, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0945026874542236
Epoch: 22, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.577 Vali Acc: 0.796 Test Loss: 0.577 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3493316173553467
Epoch: 23, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.608 Vali Acc: 0.803 Test Loss: 0.608 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2720191478729248
Epoch: 24, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9655852317810059
Epoch: 25, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.660 Vali Acc: 0.783 Test Loss: 0.660 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.272275686264038
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.667 Vali Acc: 0.803 Test Loss: 0.667 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1992413997650146
Epoch: 27, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.690 Vali Acc: 0.796 Test Loss: 0.690 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.203047275543213
Epoch: 28, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.708 Vali Acc: 0.803 Test Loss: 0.708 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1162919998168945
Epoch: 29, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.734 Vali Acc: 0.803 Test Loss: 0.734 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.3471722602844238
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.740 Vali Acc: 0.796 Test Loss: 0.740 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 1604124
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6200053691864014
Epoch: 1, Steps: 10 | Train Loss: 1.534 Vali Loss: 1.440 Vali Acc: 0.184 Test Loss: 1.440 Test Acc: 0.184
Validation loss decreased (inf --> -0.184196).  Saving model ...
Epoch: 2 cost time: 1.2861394882202148
Epoch: 2, Steps: 10 | Train Loss: 1.402 Vali Loss: 1.399 Vali Acc: 0.316 Test Loss: 1.399 Test Acc: 0.316
Validation loss decreased (-0.184196 --> -0.315775).  Saving model ...
Epoch: 3 cost time: 1.0668363571166992
Epoch: 3, Steps: 10 | Train Loss: 1.323 Vali Loss: 1.294 Vali Acc: 0.421 Test Loss: 1.294 Test Acc: 0.421
Validation loss decreased (-0.315775 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.4312248229980469
Epoch: 4, Steps: 10 | Train Loss: 1.185 Vali Loss: 1.201 Vali Acc: 0.513 Test Loss: 1.201 Test Acc: 0.513
Validation loss decreased (-0.421040 --> -0.513146).  Saving model ...
Epoch: 5 cost time: 1.3343541622161865
Epoch: 5, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.097 Vali Acc: 0.632 Test Loss: 1.097 Test Acc: 0.632
Validation loss decreased (-0.513146 --> -0.631568).  Saving model ...
Epoch: 6 cost time: 1.609926462173462
Epoch: 6, Steps: 10 | Train Loss: 0.904 Vali Loss: 0.999 Vali Acc: 0.618 Test Loss: 0.999 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2498552799224854
Epoch: 7, Steps: 10 | Train Loss: 0.790 Vali Loss: 0.938 Vali Acc: 0.638 Test Loss: 0.938 Test Acc: 0.638
Validation loss decreased (-0.631568 --> -0.638149).  Saving model ...
Epoch: 8 cost time: 1.3305249214172363
Epoch: 8, Steps: 10 | Train Loss: 0.681 Vali Loss: 0.825 Vali Acc: 0.678 Test Loss: 0.825 Test Acc: 0.678
Validation loss decreased (-0.638149 --> -0.677623).  Saving model ...
Epoch: 9 cost time: 1.3820290565490723
Epoch: 9, Steps: 10 | Train Loss: 0.541 Vali Loss: 0.735 Vali Acc: 0.711 Test Loss: 0.735 Test Acc: 0.711
Validation loss decreased (-0.677623 --> -0.710519).  Saving model ...
Epoch: 10 cost time: 1.0366897583007812
Epoch: 10, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.667 Vali Acc: 0.757 Test Loss: 0.667 Test Acc: 0.757
Validation loss decreased (-0.710519 --> -0.756572).  Saving model ...
Epoch: 11 cost time: 1.1097793579101562
Epoch: 11, Steps: 10 | Train Loss: 0.363 Vali Loss: 0.617 Vali Acc: 0.750 Test Loss: 0.617 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5427711009979248
Epoch: 12, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.571 Vali Acc: 0.776 Test Loss: 0.571 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.2899901866912842
Epoch: 13, Steps: 10 | Train Loss: 0.218 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.161531686782837
Epoch: 14, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 15 cost time: 1.205315113067627
Epoch: 15, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.658 Vali Acc: 0.783 Test Loss: 0.658 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.08390474319458
Epoch: 16, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.544 Vali Acc: 0.796 Test Loss: 0.544 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796047).  Saving model ...
Epoch: 17 cost time: 1.091233253479004
Epoch: 17, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.583 Vali Acc: 0.796 Test Loss: 0.583 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1973154544830322
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.550 Vali Acc: 0.796 Test Loss: 0.550 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0833444595336914
Epoch: 19, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809205).  Saving model ...
Epoch: 20 cost time: 1.2809484004974365
Epoch: 20, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.592 Vali Acc: 0.796 Test Loss: 0.592 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2384021282196045
Epoch: 21, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.612 Vali Acc: 0.829 Test Loss: 0.612 Test Acc: 0.829
Validation loss decreased (-0.809205 --> -0.828941).  Saving model ...
Epoch: 22 cost time: 0.9615731239318848
Epoch: 22, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.643 Vali Acc: 0.796 Test Loss: 0.643 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1990714073181152
Epoch: 23, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.681 Vali Acc: 0.809 Test Loss: 0.681 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2408761978149414
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.681 Vali Acc: 0.809 Test Loss: 0.681 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2463312149047852
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.726 Vali Acc: 0.796 Test Loss: 0.726 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0921452045440674
Epoch: 26, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.750 Vali Acc: 0.822 Test Loss: 0.750 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9855473041534424
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.843 Vali Acc: 0.796 Test Loss: 0.843 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2153065204620361
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.768 Vali Acc: 0.822 Test Loss: 0.768 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9765894412994385
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.805 Vali Acc: 0.803 Test Loss: 0.805 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9558157920837402
Epoch: 30, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.775 Vali Acc: 0.822 Test Loss: 0.775 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2513985633850098
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.799 Vali Acc: 0.796 Test Loss: 0.799 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1603740
model size : 8.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.552367925643921
Epoch: 1, Steps: 10 | Train Loss: 1.503 Vali Loss: 1.443 Vali Acc: 0.178 Test Loss: 1.443 Test Acc: 0.178
Validation loss decreased (inf --> -0.177617).  Saving model ...
Epoch: 2 cost time: 1.2227416038513184
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.429 Vali Acc: 0.289 Test Loss: 1.429 Test Acc: 0.289
Validation loss decreased (-0.177617 --> -0.289459).  Saving model ...
Epoch: 3 cost time: 0.9225940704345703
Epoch: 3, Steps: 10 | Train Loss: 1.309 Vali Loss: 1.314 Vali Acc: 0.388 Test Loss: 1.314 Test Acc: 0.388
Validation loss decreased (-0.289459 --> -0.388145).  Saving model ...
Epoch: 4 cost time: 0.8948755264282227
Epoch: 4, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.235 Vali Acc: 0.526 Test Loss: 1.235 Test Acc: 0.526
Validation loss decreased (-0.388145 --> -0.526303).  Saving model ...
Epoch: 5 cost time: 0.8748314380645752
Epoch: 5, Steps: 10 | Train Loss: 1.115 Vali Loss: 1.193 Vali Acc: 0.480 Test Loss: 1.193 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1760532855987549
Epoch: 6, Steps: 10 | Train Loss: 0.952 Vali Loss: 1.061 Vali Acc: 0.592 Test Loss: 1.061 Test Acc: 0.592
Validation loss decreased (-0.526303 --> -0.592095).  Saving model ...
Epoch: 7 cost time: 0.9318697452545166
Epoch: 7, Steps: 10 | Train Loss: 0.845 Vali Loss: 0.964 Vali Acc: 0.651 Test Loss: 0.964 Test Acc: 0.651
Validation loss decreased (-0.592095 --> -0.651306).  Saving model ...
Epoch: 8 cost time: 1.043816089630127
Epoch: 8, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.879 Vali Acc: 0.664 Test Loss: 0.879 Test Acc: 0.664
Validation loss decreased (-0.651306 --> -0.664465).  Saving model ...
Epoch: 9 cost time: 0.7668838500976562
Epoch: 9, Steps: 10 | Train Loss: 0.622 Vali Loss: 0.793 Vali Acc: 0.704 Test Loss: 0.793 Test Acc: 0.704
Validation loss decreased (-0.664465 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 1.1815693378448486
Epoch: 10, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.736 Vali Acc: 0.691 Test Loss: 0.736 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1155505180358887
Epoch: 11, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.658 Vali Acc: 0.750 Test Loss: 0.658 Test Acc: 0.750
Validation loss decreased (-0.703939 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.190370798110962
Epoch: 12, Steps: 10 | Train Loss: 0.343 Vali Loss: 0.625 Vali Acc: 0.757 Test Loss: 0.625 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 13 cost time: 1.0969057083129883
Epoch: 13, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.579 Vali Acc: 0.776 Test Loss: 0.579 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 14 cost time: 1.2617604732513428
Epoch: 14, Steps: 10 | Train Loss: 0.234 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.144547700881958
Epoch: 15, Steps: 10 | Train Loss: 0.188 Vali Loss: 0.558 Vali Acc: 0.770 Test Loss: 0.558 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3396234512329102
Epoch: 16, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 17 cost time: 1.1178436279296875
Epoch: 17, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.529 Vali Acc: 0.763 Test Loss: 0.529 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2643280029296875
Epoch: 18, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.562 Vali Acc: 0.789 Test Loss: 0.562 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1715006828308105
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.554 Vali Acc: 0.776 Test Loss: 0.554 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.630614995956421
Epoch: 20, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.590 Vali Acc: 0.776 Test Loss: 0.590 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6076064109802246
Epoch: 21, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.590 Vali Acc: 0.803 Test Loss: 0.590 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 1.1583664417266846
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.629 Vali Acc: 0.803 Test Loss: 0.629 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5283374786376953
Epoch: 23, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.674 Vali Acc: 0.796 Test Loss: 0.674 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.103689432144165
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.698 Vali Acc: 0.796 Test Loss: 0.698 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.148010015487671
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.735 Vali Acc: 0.803 Test Loss: 0.735 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.100616216659546
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.782 Vali Acc: 0.796 Test Loss: 0.782 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9941346645355225
Epoch: 27, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.788 Vali Acc: 0.803 Test Loss: 0.788 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1964030265808105
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.785 Vali Acc: 0.822 Test Loss: 0.785 Test Acc: 0.822
Validation loss decreased (-0.802626 --> -0.822361).  Saving model ...
Epoch: 29 cost time: 0.9623801708221436
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.809 Vali Acc: 0.816 Test Loss: 0.809 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.009174108505249
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.838 Vali Acc: 0.803 Test Loss: 0.838 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.07958984375
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.845 Vali Acc: 0.816 Test Loss: 0.845 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1002871990203857
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.865 Vali Acc: 0.803 Test Loss: 0.865 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2594807147979736
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.884 Vali Acc: 0.809 Test Loss: 0.884 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8840937614440918
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.924 Vali Acc: 0.803 Test Loss: 0.924 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1438868045806885
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.937 Vali Acc: 0.803 Test Loss: 0.937 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1011085510253906
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.945 Vali Acc: 0.816 Test Loss: 0.945 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0213520526885986
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.956 Vali Acc: 0.796 Test Loss: 0.956 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.031280517578125
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.959 Vali Acc: 0.796 Test Loss: 0.959 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 1210140
model size : 7.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.063202381134033
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.431 Vali Acc: 0.270 Test Loss: 1.431 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 1.512777328491211
Epoch: 2, Steps: 10 | Train Loss: 1.441 Vali Loss: 1.382 Vali Acc: 0.309 Test Loss: 1.382 Test Acc: 0.309
Validation loss decreased (-0.269723 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 1.1860179901123047
Epoch: 3, Steps: 10 | Train Loss: 1.368 Vali Loss: 1.311 Vali Acc: 0.375 Test Loss: 1.311 Test Acc: 0.375
Validation loss decreased (-0.309197 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.9904065132141113
Epoch: 4, Steps: 10 | Train Loss: 1.225 Vali Loss: 1.230 Vali Acc: 0.467 Test Loss: 1.230 Test Acc: 0.467
Validation loss decreased (-0.374987 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 1.6648762226104736
Epoch: 5, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.134 Vali Acc: 0.618 Test Loss: 1.134 Test Acc: 0.618
Validation loss decreased (-0.467093 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 1.2247977256774902
Epoch: 6, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.041 Vali Acc: 0.678 Test Loss: 1.041 Test Acc: 0.678
Validation loss decreased (-0.618410 --> -0.677621).  Saving model ...
Epoch: 7 cost time: 1.083906650543213
Epoch: 7, Steps: 10 | Train Loss: 0.919 Vali Loss: 0.952 Vali Acc: 0.691 Test Loss: 0.952 Test Acc: 0.691
Validation loss decreased (-0.677621 --> -0.690780).  Saving model ...
Epoch: 8 cost time: 1.4119675159454346
Epoch: 8, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.886 Vali Acc: 0.691 Test Loss: 0.886 Test Acc: 0.691
Validation loss decreased (-0.690780 --> -0.690781).  Saving model ...
Epoch: 9 cost time: 1.335834264755249
Epoch: 9, Steps: 10 | Train Loss: 0.688 Vali Loss: 0.819 Vali Acc: 0.697 Test Loss: 0.819 Test Acc: 0.697
Validation loss decreased (-0.690781 --> -0.697360).  Saving model ...
Epoch: 10 cost time: 1.3083124160766602
Epoch: 10, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.780 Vali Acc: 0.730 Test Loss: 0.780 Test Acc: 0.730
Validation loss decreased (-0.697360 --> -0.730255).  Saving model ...
Epoch: 11 cost time: 0.9593245983123779
Epoch: 11, Steps: 10 | Train Loss: 0.529 Vali Loss: 0.689 Vali Acc: 0.717 Test Loss: 0.689 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0504066944122314
Epoch: 12, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.630 Vali Acc: 0.743 Test Loss: 0.630 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743415).  Saving model ...
Epoch: 13 cost time: 1.1681370735168457
Epoch: 13, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.610 Vali Acc: 0.743 Test Loss: 0.610 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 14 cost time: 1.04728364944458
Epoch: 14, Steps: 10 | Train Loss: 0.314 Vali Loss: 0.549 Vali Acc: 0.770 Test Loss: 0.549 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.0432024002075195
Epoch: 15, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.530 Vali Acc: 0.763 Test Loss: 0.530 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0112204551696777
Epoch: 16, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.495 Vali Acc: 0.776 Test Loss: 0.495 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 17 cost time: 1.1807217597961426
Epoch: 17, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789469).  Saving model ...
Epoch: 18 cost time: 0.9417345523834229
Epoch: 18, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.500 Vali Acc: 0.783 Test Loss: 0.500 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.182053565979004
Epoch: 19, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.606 Vali Acc: 0.776 Test Loss: 0.606 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.131319522857666
Epoch: 20, Steps: 10 | Train Loss: 0.098 Vali Loss: 0.512 Vali Acc: 0.809 Test Loss: 0.512 Test Acc: 0.809
Validation loss decreased (-0.789469 --> -0.809205).  Saving model ...
Epoch: 21 cost time: 1.1456291675567627
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.544 Vali Acc: 0.783 Test Loss: 0.544 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.137817621231079
Epoch: 22, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.547 Vali Acc: 0.803 Test Loss: 0.547 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3836421966552734
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.566 Vali Acc: 0.809 Test Loss: 0.566 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2900567054748535
Epoch: 24, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.603 Vali Acc: 0.803 Test Loss: 0.603 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.1404616832733154
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.610 Vali Acc: 0.809 Test Loss: 0.610 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.14951491355896
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1302258968353271
Epoch: 27, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.660 Vali Acc: 0.803 Test Loss: 0.660 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9355266094207764
Epoch: 28, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.685 Vali Acc: 0.803 Test Loss: 0.685 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0902371406555176
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.715 Vali Acc: 0.796 Test Loss: 0.715 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1306672096252441
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.742 Vali Acc: 0.796 Test Loss: 0.742 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 1209756
model size : 7.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7041966915130615
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.372 Vali Acc: 0.289 Test Loss: 1.372 Test Acc: 0.289
Validation loss decreased (inf --> -0.289460).  Saving model ...
Epoch: 2 cost time: 1.0716607570648193
Epoch: 2, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.366 Vali Acc: 0.309 Test Loss: 1.366 Test Acc: 0.309
Validation loss decreased (-0.289460 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 0.9989707469940186
Epoch: 3, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.253 Vali Acc: 0.408 Test Loss: 1.253 Test Acc: 0.408
Validation loss decreased (-0.309197 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 0.9885191917419434
Epoch: 4, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.177 Vali Acc: 0.507 Test Loss: 1.177 Test Acc: 0.507
Validation loss decreased (-0.407882 --> -0.506567).  Saving model ...
Epoch: 5 cost time: 1.0366911888122559
Epoch: 5, Steps: 10 | Train Loss: 1.065 Vali Loss: 1.092 Vali Acc: 0.651 Test Loss: 1.092 Test Acc: 0.651
Validation loss decreased (-0.506567 --> -0.651305).  Saving model ...
Epoch: 6 cost time: 1.155637264251709
Epoch: 6, Steps: 10 | Train Loss: 0.918 Vali Loss: 1.026 Vali Acc: 0.645 Test Loss: 1.026 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2887427806854248
Epoch: 7, Steps: 10 | Train Loss: 0.850 Vali Loss: 0.933 Vali Acc: 0.704 Test Loss: 0.933 Test Acc: 0.704
Validation loss decreased (-0.651305 --> -0.703938).  Saving model ...
Epoch: 8 cost time: 1.1200695037841797
Epoch: 8, Steps: 10 | Train Loss: 0.716 Vali Loss: 0.861 Vali Acc: 0.664 Test Loss: 0.861 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0311424732208252
Epoch: 9, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.769 Vali Acc: 0.730 Test Loss: 0.769 Test Acc: 0.730
Validation loss decreased (-0.703938 --> -0.730255).  Saving model ...
Epoch: 10 cost time: 0.9468815326690674
Epoch: 10, Steps: 10 | Train Loss: 0.480 Vali Loss: 0.710 Vali Acc: 0.724 Test Loss: 0.710 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.227046251296997
Epoch: 11, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.638 Vali Acc: 0.770 Test Loss: 0.638 Test Acc: 0.770
Validation loss decreased (-0.730255 --> -0.769730).  Saving model ...
Epoch: 12 cost time: 1.0253713130950928
Epoch: 12, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.617 Vali Acc: 0.743 Test Loss: 0.617 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0799403190612793
Epoch: 13, Steps: 10 | Train Loss: 0.295 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
Validation loss decreased (-0.769730 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.0422852039337158
Epoch: 14, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.576 Vali Acc: 0.789 Test Loss: 0.576 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 1.4441757202148438
Epoch: 15, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.549 Vali Acc: 0.789 Test Loss: 0.549 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.0298399925231934
Epoch: 16, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2377729415893555
Epoch: 17, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.217674970626831
Epoch: 18, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.669 Vali Acc: 0.776 Test Loss: 0.669 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4361579418182373
Epoch: 19, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.631 Vali Acc: 0.803 Test Loss: 0.631 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802625).  Saving model ...
Epoch: 20 cost time: 1.1613576412200928
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.557 Vali Acc: 0.770 Test Loss: 0.557 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1207802295684814
Epoch: 21, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.977625846862793
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.593 Vali Acc: 0.783 Test Loss: 0.593 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2809462547302246
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.592 Vali Acc: 0.789 Test Loss: 0.592 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1414058208465576
Epoch: 24, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.636 Vali Acc: 0.796 Test Loss: 0.636 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2483434677124023
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.677 Vali Acc: 0.789 Test Loss: 0.677 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.264753818511963
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.710 Vali Acc: 0.796 Test Loss: 0.710 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0228922367095947
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.801 Vali Acc: 0.763 Test Loss: 0.801 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.177849531173706
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.810 Vali Acc: 0.796 Test Loss: 0.810 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0832972526550293
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.738 Vali Acc: 0.816 Test Loss: 0.738 Test Acc: 0.816
Validation loss decreased (-0.802625 --> -0.815782).  Saving model ...
Epoch: 30 cost time: 0.9622600078582764
Epoch: 30, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1169037818908691
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.781 Vali Acc: 0.789 Test Loss: 0.781 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3032710552215576
Epoch: 32, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.807 Vali Acc: 0.803 Test Loss: 0.807 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.247058629989624
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.818 Vali Acc: 0.796 Test Loss: 0.818 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4666078090667725
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.825 Vali Acc: 0.796 Test Loss: 0.825 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1331384181976318
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.834 Vali Acc: 0.789 Test Loss: 0.834 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.171363115310669
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.845 Vali Acc: 0.796 Test Loss: 0.845 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.2414650917053223
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.863 Vali Acc: 0.796 Test Loss: 0.863 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.1928822994232178
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.886 Vali Acc: 0.796 Test Loss: 0.886 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.212742567062378
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.898 Vali Acc: 0.796 Test Loss: 0.898 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 1209372
model size : 7.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1030969619750977
Epoch: 1, Steps: 10 | Train Loss: 1.463 Vali Loss: 1.356 Vali Acc: 0.342 Test Loss: 1.356 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.0235800743103027
Epoch: 2, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.309 Vali Acc: 0.375 Test Loss: 1.309 Test Acc: 0.375
Validation loss decreased (-0.342092 --> -0.374987).  Saving model ...
Epoch: 3 cost time: 1.1410458087921143
Epoch: 3, Steps: 10 | Train Loss: 1.219 Vali Loss: 1.220 Vali Acc: 0.559 Test Loss: 1.220 Test Acc: 0.559
Validation loss decreased (-0.374987 --> -0.559198).  Saving model ...
Epoch: 4 cost time: 1.0505757331848145
Epoch: 4, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.152 Vali Acc: 0.553 Test Loss: 1.152 Test Acc: 0.553
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2123801708221436
Epoch: 5, Steps: 10 | Train Loss: 1.042 Vali Loss: 1.059 Vali Acc: 0.625 Test Loss: 1.059 Test Acc: 0.625
Validation loss decreased (-0.559198 --> -0.624989).  Saving model ...
Epoch: 6 cost time: 1.2469422817230225
Epoch: 6, Steps: 10 | Train Loss: 0.929 Vali Loss: 0.961 Vali Acc: 0.711 Test Loss: 0.961 Test Acc: 0.711
Validation loss decreased (-0.624989 --> -0.710517).  Saving model ...
Epoch: 7 cost time: 1.030693531036377
Epoch: 7, Steps: 10 | Train Loss: 0.789 Vali Loss: 0.878 Vali Acc: 0.678 Test Loss: 0.878 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9218940734863281
Epoch: 8, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.781 Vali Acc: 0.724 Test Loss: 0.781 Test Acc: 0.724
Validation loss decreased (-0.710517 --> -0.723676).  Saving model ...
Epoch: 9 cost time: 0.9045300483703613
Epoch: 9, Steps: 10 | Train Loss: 0.542 Vali Loss: 0.703 Vali Acc: 0.724 Test Loss: 0.703 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723677).  Saving model ...
Epoch: 10 cost time: 0.9911606311798096
Epoch: 10, Steps: 10 | Train Loss: 0.442 Vali Loss: 0.658 Vali Acc: 0.763 Test Loss: 0.658 Test Acc: 0.763
Validation loss decreased (-0.723677 --> -0.763151).  Saving model ...
Epoch: 11 cost time: 1.2129497528076172
Epoch: 11, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.598 Vali Acc: 0.770 Test Loss: 0.598 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 12 cost time: 1.0771665573120117
Epoch: 12, Steps: 10 | Train Loss: 0.305 Vali Loss: 0.572 Vali Acc: 0.783 Test Loss: 0.572 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 13 cost time: 1.2638449668884277
Epoch: 13, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 14 cost time: 1.1884832382202148
Epoch: 14, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.180126428604126
Epoch: 15, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.498 Vali Acc: 0.796 Test Loss: 0.498 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 16 cost time: 1.2445900440216064
Epoch: 16, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3302831649780273
Epoch: 17, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.514 Vali Acc: 0.789 Test Loss: 0.514 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2021138668060303
Epoch: 18, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.6576805114746094
Epoch: 19, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.597 Vali Acc: 0.816 Test Loss: 0.597 Test Acc: 0.816
Validation loss decreased (-0.796048 --> -0.815784).  Saving model ...
Epoch: 20 cost time: 1.2099499702453613
Epoch: 20, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.593 Vali Acc: 0.796 Test Loss: 0.593 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2553486824035645
Epoch: 21, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.634 Vali Acc: 0.803 Test Loss: 0.634 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2465782165527344
Epoch: 22, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.649 Vali Acc: 0.816 Test Loss: 0.649 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9821720123291016
Epoch: 23, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.662 Vali Acc: 0.796 Test Loss: 0.662 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.08245849609375
Epoch: 24, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.720 Vali Acc: 0.829 Test Loss: 0.720 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828940).  Saving model ...
Epoch: 25 cost time: 1.024953842163086
Epoch: 25, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.744 Vali Acc: 0.796 Test Loss: 0.744 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2169349193572998
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.756 Vali Acc: 0.809 Test Loss: 0.756 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0865142345428467
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.763 Vali Acc: 0.816 Test Loss: 0.763 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.2890355587005615
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.774 Vali Acc: 0.816 Test Loss: 0.774 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1526072025299072
Epoch: 29, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.789 Vali Acc: 0.822 Test Loss: 0.789 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2798268795013428
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.774 Vali Acc: 0.796 Test Loss: 0.774 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0037975311279297
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.798 Vali Acc: 0.796 Test Loss: 0.798 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9406914710998535
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.831 Vali Acc: 0.796 Test Loss: 0.831 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1494452953338623
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.857 Vali Acc: 0.796 Test Loss: 0.857 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0723133087158203
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.883 Vali Acc: 0.796 Test Loss: 0.883 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 1208988
model size : 7.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1679720878601074
Epoch: 1, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.351 Vali Acc: 0.322 Test Loss: 1.351 Test Acc: 0.322
Validation loss decreased (inf --> -0.322355).  Saving model ...
Epoch: 2 cost time: 1.2580270767211914
Epoch: 2, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.306 Vali Acc: 0.408 Test Loss: 1.306 Test Acc: 0.408
Validation loss decreased (-0.322355 --> -0.407882).  Saving model ...
Epoch: 3 cost time: 0.9224827289581299
Epoch: 3, Steps: 10 | Train Loss: 1.257 Vali Loss: 1.251 Vali Acc: 0.480 Test Loss: 1.251 Test Acc: 0.480
Validation loss decreased (-0.407882 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 1.0074715614318848
Epoch: 4, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.182 Vali Acc: 0.526 Test Loss: 1.182 Test Acc: 0.526
Validation loss decreased (-0.480251 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 0.9881293773651123
Epoch: 5, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.130 Vali Acc: 0.566 Test Loss: 1.130 Test Acc: 0.566
Validation loss decreased (-0.526304 --> -0.565778).  Saving model ...
Epoch: 6 cost time: 1.1130874156951904
Epoch: 6, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.028 Vali Acc: 0.658 Test Loss: 1.028 Test Acc: 0.658
Validation loss decreased (-0.565778 --> -0.657884).  Saving model ...
Epoch: 7 cost time: 1.0292317867279053
Epoch: 7, Steps: 10 | Train Loss: 0.868 Vali Loss: 0.963 Vali Acc: 0.651 Test Loss: 0.963 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1934771537780762
Epoch: 8, Steps: 10 | Train Loss: 0.774 Vali Loss: 0.879 Vali Acc: 0.671 Test Loss: 0.879 Test Acc: 0.671
Validation loss decreased (-0.657884 --> -0.671044).  Saving model ...
Epoch: 9 cost time: 1.212726354598999
Epoch: 9, Steps: 10 | Train Loss: 0.671 Vali Loss: 0.808 Vali Acc: 0.704 Test Loss: 0.808 Test Acc: 0.704
Validation loss decreased (-0.671044 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 1.0683369636535645
Epoch: 10, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.744 Vali Acc: 0.711 Test Loss: 0.744 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710519).  Saving model ...
Epoch: 11 cost time: 0.9962682723999023
Epoch: 11, Steps: 10 | Train Loss: 0.527 Vali Loss: 0.700 Vali Acc: 0.711 Test Loss: 0.700 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 12 cost time: 1.2060589790344238
Epoch: 12, Steps: 10 | Train Loss: 0.433 Vali Loss: 0.639 Vali Acc: 0.737 Test Loss: 0.639 Test Acc: 0.737
Validation loss decreased (-0.710519 --> -0.736836).  Saving model ...
Epoch: 13 cost time: 1.0640738010406494
Epoch: 13, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
Validation loss decreased (-0.736836 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 1.1455624103546143
Epoch: 14, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.561 Vali Acc: 0.757 Test Loss: 0.561 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 1.11592435836792
Epoch: 15, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.536 Vali Acc: 0.789 Test Loss: 0.536 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.0728342533111572
Epoch: 16, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.517 Vali Acc: 0.757 Test Loss: 0.517 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.152108907699585
Epoch: 17, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.504 Vali Acc: 0.776 Test Loss: 0.504 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2023608684539795
Epoch: 18, Steps: 10 | Train Loss: 0.124 Vali Loss: 0.518 Vali Acc: 0.783 Test Loss: 0.518 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2196393013000488
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3522400856018066
Epoch: 20, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.531 Vali Acc: 0.796 Test Loss: 0.531 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 1.1848771572113037
Epoch: 21, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.551 Vali Acc: 0.796 Test Loss: 0.551 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8930892944335938
Epoch: 22, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.574 Vali Acc: 0.816 Test Loss: 0.574 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 23 cost time: 0.9626872539520264
Epoch: 23, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.605 Vali Acc: 0.809 Test Loss: 0.605 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6319081783294678
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.641 Vali Acc: 0.803 Test Loss: 0.641 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4444847106933594
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.664 Vali Acc: 0.822 Test Loss: 0.664 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822362).  Saving model ...
Epoch: 26 cost time: 1.1619820594787598
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.696 Vali Acc: 0.822 Test Loss: 0.696 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0241422653198242
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.727 Vali Acc: 0.809 Test Loss: 0.727 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.238435983657837
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.786 Vali Acc: 0.816 Test Loss: 0.786 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.6655478477478027
Epoch: 29, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.773 Vali Acc: 0.816 Test Loss: 0.773 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.03165864944458
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.809 Vali Acc: 0.816 Test Loss: 0.809 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3281831741333008
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.825 Vali Acc: 0.822 Test Loss: 0.825 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1720380783081055
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.832 Vali Acc: 0.816 Test Loss: 0.832 Test Acc: 0.816
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1323130130767822
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.846 Vali Acc: 0.822 Test Loss: 0.846 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3478705883026123
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.884 Vali Acc: 0.816 Test Loss: 0.884 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.2636945247650146
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.878 Vali Acc: 0.829 Test Loss: 0.878 Test Acc: 0.829
Validation loss decreased (-0.822362 --> -0.828939).  Saving model ...
Epoch: 36 cost time: 1.0797326564788818
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.873 Vali Acc: 0.816 Test Loss: 0.873 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9579324722290039
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.882 Vali Acc: 0.829 Test Loss: 0.882 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1571950912475586
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.877 Vali Acc: 0.822 Test Loss: 0.877 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0435404777526855
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.896 Vali Acc: 0.822 Test Loss: 0.896 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.3129503726959229
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.865 Vali Acc: 0.816 Test Loss: 0.865 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3664021492004395
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.910 Vali Acc: 0.822 Test Loss: 0.910 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.31154203414917
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.902 Vali Acc: 0.822 Test Loss: 0.902 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.0904951095581055
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.964 Vali Acc: 0.816 Test Loss: 0.964 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0440716743469238
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.912 Vali Acc: 0.829 Test Loss: 0.912 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0631730556488037
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.919 Vali Acc: 0.836 Test Loss: 0.919 Test Acc: 0.836
Validation loss decreased (-0.828939 --> -0.835517).  Saving model ...
Epoch: 46 cost time: 1.0313091278076172
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.950 Vali Acc: 0.836 Test Loss: 0.950 Test Acc: 0.836
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9708127975463867
Epoch: 47, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.938 Vali Acc: 0.829 Test Loss: 0.938 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1125693321228027
Epoch: 48, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.931 Vali Acc: 0.842 Test Loss: 0.931 Test Acc: 0.842
Validation loss decreased (-0.835517 --> -0.842096).  Saving model ...
Epoch: 49 cost time: 0.963109016418457
Epoch: 49, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.953 Vali Acc: 0.829 Test Loss: 0.953 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0530540943145752
Epoch: 50, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.967 Vali Acc: 0.829 Test Loss: 0.967 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1881194114685059
Epoch: 51, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.971 Vali Acc: 0.822 Test Loss: 0.971 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.151536464691162
Epoch: 52, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.975 Vali Acc: 0.816 Test Loss: 0.975 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.3066627979278564
Epoch: 53, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.987 Vali Acc: 0.829 Test Loss: 0.987 Test Acc: 0.829
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.5196952819824219
Epoch: 54, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.836 Test Loss: 0.995 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.087101936340332
Epoch: 55, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.008 Vali Acc: 0.836 Test Loss: 1.008 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 1.1306586265563965
Epoch: 56, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.004 Vali Acc: 0.829 Test Loss: 1.004 Test Acc: 0.829
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.1306118965148926
Epoch: 57, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.012 Vali Acc: 0.822 Test Loss: 1.012 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.9641962051391602
Epoch: 58, Steps: 10 | Train Loss: 0.001 Vali Loss: 1.015 Vali Acc: 0.816 Test Loss: 1.015 Test Acc: 0.816
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8421052631578947
model parameter : 1012764
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.036884307861328
Epoch: 1, Steps: 10 | Train Loss: 1.491 Vali Loss: 1.392 Vali Acc: 0.329 Test Loss: 1.392 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 1.1112377643585205
Epoch: 2, Steps: 10 | Train Loss: 1.426 Vali Loss: 1.343 Vali Acc: 0.349 Test Loss: 1.343 Test Acc: 0.349
Validation loss decreased (-0.328933 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 0.9287481307983398
Epoch: 3, Steps: 10 | Train Loss: 1.343 Vali Loss: 1.287 Vali Acc: 0.401 Test Loss: 1.287 Test Acc: 0.401
Validation loss decreased (-0.348671 --> -0.401303).  Saving model ...
Epoch: 4 cost time: 1.024540662765503
Epoch: 4, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.203 Vali Acc: 0.533 Test Loss: 1.203 Test Acc: 0.533
Validation loss decreased (-0.401303 --> -0.532883).  Saving model ...
Epoch: 5 cost time: 0.8853964805603027
Epoch: 5, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.129 Vali Acc: 0.559 Test Loss: 1.129 Test Acc: 0.559
Validation loss decreased (-0.532883 --> -0.559199).  Saving model ...
Epoch: 6 cost time: 0.9613363742828369
Epoch: 6, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.057 Vali Acc: 0.638 Test Loss: 1.057 Test Acc: 0.638
Validation loss decreased (-0.559199 --> -0.638147).  Saving model ...
Epoch: 7 cost time: 0.8561568260192871
Epoch: 7, Steps: 10 | Train Loss: 0.894 Vali Loss: 0.964 Vali Acc: 0.651 Test Loss: 0.964 Test Acc: 0.651
Validation loss decreased (-0.638147 --> -0.651306).  Saving model ...
Epoch: 8 cost time: 0.9580645561218262
Epoch: 8, Steps: 10 | Train Loss: 0.812 Vali Loss: 0.904 Vali Acc: 0.684 Test Loss: 0.904 Test Acc: 0.684
Validation loss decreased (-0.651306 --> -0.684201).  Saving model ...
Epoch: 9 cost time: 1.0915722846984863
Epoch: 9, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.825 Vali Acc: 0.711 Test Loss: 0.825 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710518).  Saving model ...
Epoch: 10 cost time: 1.0704498291015625
Epoch: 10, Steps: 10 | Train Loss: 0.589 Vali Loss: 0.744 Vali Acc: 0.750 Test Loss: 0.744 Test Acc: 0.750
Validation loss decreased (-0.710518 --> -0.749993).  Saving model ...
Epoch: 11 cost time: 0.9523277282714844
Epoch: 11, Steps: 10 | Train Loss: 0.490 Vali Loss: 0.687 Vali Acc: 0.737 Test Loss: 0.687 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1205744743347168
Epoch: 12, Steps: 10 | Train Loss: 0.431 Vali Loss: 0.650 Vali Acc: 0.763 Test Loss: 0.650 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 13 cost time: 1.0406382083892822
Epoch: 13, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.3157482147216797
Epoch: 14, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.582 Vali Acc: 0.757 Test Loss: 0.582 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1415059566497803
Epoch: 15, Steps: 10 | Train Loss: 0.240 Vali Loss: 0.556 Vali Acc: 0.763 Test Loss: 0.556 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9081568717956543
Epoch: 16, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.539 Vali Acc: 0.776 Test Loss: 0.539 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 17 cost time: 1.0354266166687012
Epoch: 17, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.568 Vali Acc: 0.796 Test Loss: 0.568 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.1125624179840088
Epoch: 18, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.578 Vali Acc: 0.789 Test Loss: 0.578 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9746644496917725
Epoch: 19, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.570 Vali Acc: 0.783 Test Loss: 0.570 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1544904708862305
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0397133827209473
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.712 Vali Acc: 0.816 Test Loss: 0.712 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815782).  Saving model ...
Epoch: 22 cost time: 1.0498685836791992
Epoch: 22, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.627 Vali Acc: 0.796 Test Loss: 0.627 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9713680744171143
Epoch: 23, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.663 Vali Acc: 0.789 Test Loss: 0.663 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0637025833129883
Epoch: 24, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.706 Vali Acc: 0.822 Test Loss: 0.706 Test Acc: 0.822
Validation loss decreased (-0.815782 --> -0.822361).  Saving model ...
Epoch: 25 cost time: 1.2004215717315674
Epoch: 25, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.727 Vali Acc: 0.803 Test Loss: 0.727 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1439850330352783
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.774 Vali Acc: 0.816 Test Loss: 0.774 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.148348331451416
Epoch: 27, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.782 Vali Acc: 0.809 Test Loss: 0.782 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.230635404586792
Epoch: 28, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.793 Vali Acc: 0.816 Test Loss: 0.793 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.3616502285003662
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.828 Vali Acc: 0.816 Test Loss: 0.828 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.1461830139160156
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.833 Vali Acc: 0.829 Test Loss: 0.833 Test Acc: 0.829
Validation loss decreased (-0.822361 --> -0.828939).  Saving model ...
Epoch: 31 cost time: 0.8806025981903076
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.849 Vali Acc: 0.829 Test Loss: 0.849 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0311532020568848
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.871 Vali Acc: 0.829 Test Loss: 0.871 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0782406330108643
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.883 Vali Acc: 0.822 Test Loss: 0.883 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.161815881729126
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.888 Vali Acc: 0.836 Test Loss: 0.888 Test Acc: 0.836
Validation loss decreased (-0.828939 --> -0.835517).  Saving model ...
Epoch: 35 cost time: 1.1233422756195068
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.902 Vali Acc: 0.829 Test Loss: 0.902 Test Acc: 0.829
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1053154468536377
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.914 Vali Acc: 0.829 Test Loss: 0.914 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.334437370300293
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.928 Vali Acc: 0.822 Test Loss: 0.928 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1658964157104492
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.936 Vali Acc: 0.822 Test Loss: 0.936 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.185544729232788
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.950 Vali Acc: 0.822 Test Loss: 0.950 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1102268695831299
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.953 Vali Acc: 0.822 Test Loss: 0.953 Test Acc: 0.822
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9886653423309326
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.957 Vali Acc: 0.836 Test Loss: 0.957 Test Acc: 0.836
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9479234218597412
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.970 Vali Acc: 0.822 Test Loss: 0.970 Test Acc: 0.822
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4489455223083496
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.986 Vali Acc: 0.822 Test Loss: 0.986 Test Acc: 0.822
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.4183416366577148
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.991 Vali Acc: 0.822 Test Loss: 0.991 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 1012380
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.51029109954834
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.367 Vali Acc: 0.296 Test Loss: 1.367 Test Acc: 0.296
Validation loss decreased (inf --> -0.296039).  Saving model ...
Epoch: 2 cost time: 1.2027220726013184
Epoch: 2, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.345 Vali Acc: 0.362 Test Loss: 1.345 Test Acc: 0.362
Validation loss decreased (-0.296039 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.0863256454467773
Epoch: 3, Steps: 10 | Train Loss: 1.279 Vali Loss: 1.255 Vali Acc: 0.474 Test Loss: 1.255 Test Acc: 0.474
Validation loss decreased (-0.361829 --> -0.473672).  Saving model ...
Epoch: 4 cost time: 0.999577522277832
Epoch: 4, Steps: 10 | Train Loss: 1.210 Vali Loss: 1.184 Vali Acc: 0.526 Test Loss: 1.184 Test Acc: 0.526
Validation loss decreased (-0.473672 --> -0.526304).  Saving model ...
Epoch: 5 cost time: 1.0064465999603271
Epoch: 5, Steps: 10 | Train Loss: 1.082 Vali Loss: 1.100 Vali Acc: 0.605 Test Loss: 1.100 Test Acc: 0.605
Validation loss decreased (-0.526304 --> -0.605252).  Saving model ...
Epoch: 6 cost time: 1.2015516757965088
Epoch: 6, Steps: 10 | Train Loss: 0.960 Vali Loss: 1.033 Vali Acc: 0.638 Test Loss: 1.033 Test Acc: 0.638
Validation loss decreased (-0.605252 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 1.0930473804473877
Epoch: 7, Steps: 10 | Train Loss: 0.856 Vali Loss: 0.928 Vali Acc: 0.691 Test Loss: 0.928 Test Acc: 0.691
Validation loss decreased (-0.638148 --> -0.690780).  Saving model ...
Epoch: 8 cost time: 1.1625950336456299
Epoch: 8, Steps: 10 | Train Loss: 0.727 Vali Loss: 0.834 Vali Acc: 0.704 Test Loss: 0.834 Test Acc: 0.704
Validation loss decreased (-0.690780 --> -0.703939).  Saving model ...
Epoch: 9 cost time: 1.027515172958374
Epoch: 9, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.767 Vali Acc: 0.730 Test Loss: 0.767 Test Acc: 0.730
Validation loss decreased (-0.703939 --> -0.730255).  Saving model ...
Epoch: 10 cost time: 1.0802080631256104
Epoch: 10, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.686 Vali Acc: 0.743 Test Loss: 0.686 Test Acc: 0.743
Validation loss decreased (-0.730255 --> -0.743414).  Saving model ...
Epoch: 11 cost time: 1.078439474105835
Epoch: 11, Steps: 10 | Train Loss: 0.436 Vali Loss: 0.628 Vali Acc: 0.750 Test Loss: 0.628 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 12 cost time: 1.0740582942962646
Epoch: 12, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.590 Vali Acc: 0.770 Test Loss: 0.590 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 13 cost time: 1.0737638473510742
Epoch: 13, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.560 Vali Acc: 0.783 Test Loss: 0.560 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.1355175971984863
Epoch: 14, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9487028121948242
Epoch: 15, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.522 Vali Acc: 0.789 Test Loss: 0.522 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 16 cost time: 1.0049340724945068
Epoch: 16, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.492 Vali Acc: 0.763 Test Loss: 0.492 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1725246906280518
Epoch: 17, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.469 Vali Acc: 0.770 Test Loss: 0.469 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8985729217529297
Epoch: 18, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.489 Vali Acc: 0.796 Test Loss: 0.489 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 19 cost time: 1.0632665157318115
Epoch: 19, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.501 Vali Acc: 0.750 Test Loss: 0.501 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9785141944885254
Epoch: 20, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.523 Vali Acc: 0.803 Test Loss: 0.523 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 1.3076701164245605
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.543 Vali Acc: 0.796 Test Loss: 0.543 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3124761581420898
Epoch: 22, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.542 Vali Acc: 0.816 Test Loss: 0.542 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815784).  Saving model ...
Epoch: 23 cost time: 0.9500730037689209
Epoch: 23, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.571 Vali Acc: 0.816 Test Loss: 0.571 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9588768482208252
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.616 Vali Acc: 0.816 Test Loss: 0.616 Test Acc: 0.816
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0792114734649658
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.670 Vali Acc: 0.816 Test Loss: 0.670 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9403471946716309
Epoch: 26, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.705 Vali Acc: 0.816 Test Loss: 0.705 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1717662811279297
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.705 Vali Acc: 0.809 Test Loss: 0.705 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8849227428436279
Epoch: 28, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.812 Vali Acc: 0.796 Test Loss: 0.812 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1285958290100098
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.755 Vali Acc: 0.829 Test Loss: 0.755 Test Acc: 0.829
Validation loss decreased (-0.815784 --> -0.828940).  Saving model ...
Epoch: 30 cost time: 1.0464134216308594
Epoch: 30, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.747 Vali Acc: 0.822 Test Loss: 0.747 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.035266399383545
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.766 Vali Acc: 0.836 Test Loss: 0.766 Test Acc: 0.836
Validation loss decreased (-0.828940 --> -0.835519).  Saving model ...
Epoch: 32 cost time: 1.039259910583496
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.783 Vali Acc: 0.842 Test Loss: 0.783 Test Acc: 0.842
Validation loss decreased (-0.835519 --> -0.842097).  Saving model ...
Epoch: 33 cost time: 1.0420446395874023
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.798 Vali Acc: 0.842 Test Loss: 0.798 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2186353206634521
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.833 Vali Acc: 0.836 Test Loss: 0.833 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1861965656280518
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.874 Vali Acc: 0.836 Test Loss: 0.874 Test Acc: 0.836
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.2037780284881592
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.849 Vali Acc: 0.849 Test Loss: 0.849 Test Acc: 0.849
Validation loss decreased (-0.842097 --> -0.848676).  Saving model ...
Epoch: 37 cost time: 1.3209295272827148
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.868 Vali Acc: 0.842 Test Loss: 0.868 Test Acc: 0.842
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.4029810428619385
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.884 Vali Acc: 0.836 Test Loss: 0.884 Test Acc: 0.836
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.749288558959961
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.871 Vali Acc: 0.842 Test Loss: 0.871 Test Acc: 0.842
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2469425201416016
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.878 Vali Acc: 0.836 Test Loss: 0.878 Test Acc: 0.836
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.1338462829589844
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.896 Vali Acc: 0.822 Test Loss: 0.896 Test Acc: 0.822
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.2113425731658936
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.921 Vali Acc: 0.836 Test Loss: 0.921 Test Acc: 0.836
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1690173149108887
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.926 Vali Acc: 0.842 Test Loss: 0.926 Test Acc: 0.842
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.981116771697998
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.941 Vali Acc: 0.836 Test Loss: 0.941 Test Acc: 0.836
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.2020721435546875
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 0.937 Vali Acc: 0.829 Test Loss: 0.937 Test Acc: 0.829
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7564330101013184
Epoch: 46, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.977 Vali Acc: 0.829 Test Loss: 0.977 Test Acc: 0.829
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8486842105263158
model parameter : 1011996
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.4344582557678223
Epoch: 1, Steps: 10 | Train Loss: 1.433 Vali Loss: 1.437 Vali Acc: 0.257 Test Loss: 1.437 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.1243948936462402
Epoch: 2, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.386 Vali Acc: 0.250 Test Loss: 1.386 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.245063066482544
Epoch: 3, Steps: 10 | Train Loss: 1.312 Vali Loss: 1.308 Vali Acc: 0.421 Test Loss: 1.308 Test Acc: 0.421
Validation loss decreased (-0.256565 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.2000255584716797
Epoch: 4, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.224 Vali Acc: 0.546 Test Loss: 1.224 Test Acc: 0.546
Validation loss decreased (-0.421040 --> -0.546040).  Saving model ...
Epoch: 5 cost time: 1.2547235488891602
Epoch: 5, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.149 Vali Acc: 0.592 Test Loss: 1.149 Test Acc: 0.592
Validation loss decreased (-0.546040 --> -0.592094).  Saving model ...
Epoch: 6 cost time: 1.134122371673584
Epoch: 6, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.045 Vali Acc: 0.658 Test Loss: 1.045 Test Acc: 0.658
Validation loss decreased (-0.592094 --> -0.657884).  Saving model ...
Epoch: 7 cost time: 1.4169301986694336
Epoch: 7, Steps: 10 | Train Loss: 0.880 Vali Loss: 0.971 Vali Acc: 0.691 Test Loss: 0.971 Test Acc: 0.691
Validation loss decreased (-0.657884 --> -0.690780).  Saving model ...
Epoch: 8 cost time: 1.022336483001709
Epoch: 8, Steps: 10 | Train Loss: 0.781 Vali Loss: 0.869 Vali Acc: 0.711 Test Loss: 0.869 Test Acc: 0.711
Validation loss decreased (-0.690780 --> -0.710518).  Saving model ...
Epoch: 9 cost time: 1.0661170482635498
Epoch: 9, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.788 Vali Acc: 0.730 Test Loss: 0.788 Test Acc: 0.730
Validation loss decreased (-0.710518 --> -0.730255).  Saving model ...
Epoch: 10 cost time: 0.9526667594909668
Epoch: 10, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.704 Vali Acc: 0.737 Test Loss: 0.704 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736835).  Saving model ...
Epoch: 11 cost time: 1.1925725936889648
Epoch: 11, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.669 Vali Acc: 0.730 Test Loss: 0.669 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9247100353240967
Epoch: 12, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.601 Vali Acc: 0.750 Test Loss: 0.601 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749994).  Saving model ...
Epoch: 13 cost time: 1.2013380527496338
Epoch: 13, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.574 Vali Acc: 0.757 Test Loss: 0.574 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 14 cost time: 1.1873083114624023
Epoch: 14, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.556 Vali Acc: 0.789 Test Loss: 0.556 Test Acc: 0.789
Validation loss decreased (-0.756573 --> -0.789468).  Saving model ...
Epoch: 15 cost time: 0.9403371810913086
Epoch: 15, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0702509880065918
Epoch: 16, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.611 Vali Acc: 0.776 Test Loss: 0.611 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9853389263153076
Epoch: 17, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.551 Vali Acc: 0.796 Test Loss: 0.551 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 18 cost time: 1.0573296546936035
Epoch: 18, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.566 Vali Acc: 0.796 Test Loss: 0.566 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0589935779571533
Epoch: 19, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.681 Vali Acc: 0.763 Test Loss: 0.681 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2101736068725586
Epoch: 20, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.629 Vali Acc: 0.783 Test Loss: 0.629 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2034554481506348
Epoch: 21, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.646 Vali Acc: 0.796 Test Loss: 0.646 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1270861625671387
Epoch: 22, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 23 cost time: 1.0391209125518799
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.741 Vali Acc: 0.796 Test Loss: 0.741 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1823649406433105
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.742 Vali Acc: 0.809 Test Loss: 0.742 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1814284324645996
Epoch: 25, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.792 Vali Acc: 0.816 Test Loss: 0.792 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815782).  Saving model ...
Epoch: 26 cost time: 1.208395004272461
Epoch: 26, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.794 Vali Acc: 0.816 Test Loss: 0.794 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3087449073791504
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.822 Vali Acc: 0.822 Test Loss: 0.822 Test Acc: 0.822
Validation loss decreased (-0.815782 --> -0.822360).  Saving model ...
Epoch: 28 cost time: 1.0642859935760498
Epoch: 28, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.844 Vali Acc: 0.836 Test Loss: 0.844 Test Acc: 0.836
Validation loss decreased (-0.822360 --> -0.835518).  Saving model ...
Epoch: 29 cost time: 1.178760051727295
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.837 Vali Acc: 0.822 Test Loss: 0.837 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0591957569122314
Epoch: 30, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.837 Vali Acc: 0.822 Test Loss: 0.837 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2076430320739746
Epoch: 31, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.863 Vali Acc: 0.822 Test Loss: 0.863 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1814942359924316
Epoch: 32, Steps: 10 | Train Loss: 0.008 Vali Loss: 0.887 Vali Acc: 0.829 Test Loss: 0.887 Test Acc: 0.829
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.1986510753631592
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.941 Vali Acc: 0.816 Test Loss: 0.941 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1122641563415527
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.918 Vali Acc: 0.816 Test Loss: 0.918 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9344675540924072
Epoch: 35, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.919 Vali Acc: 0.809 Test Loss: 0.919 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9467310905456543
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.999 Vali Acc: 0.809 Test Loss: 0.999 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.1764979362487793
Epoch: 37, Steps: 10 | Train Loss: 0.004 Vali Loss: 0.984 Vali Acc: 0.816 Test Loss: 0.984 Test Acc: 0.816
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.130115270614624
Epoch: 38, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.966 Vali Acc: 0.822 Test Loss: 0.966 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8355263157894737
model parameter : 1011612
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2668418884277344
Epoch: 1, Steps: 10 | Train Loss: 1.456 Vali Loss: 1.365 Vali Acc: 0.303 Test Loss: 1.365 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.0314886569976807
Epoch: 2, Steps: 10 | Train Loss: 1.378 Vali Loss: 1.353 Vali Acc: 0.309 Test Loss: 1.353 Test Acc: 0.309
Validation loss decreased (-0.302618 --> -0.309197).  Saving model ...
Epoch: 3 cost time: 1.1548027992248535
Epoch: 3, Steps: 10 | Train Loss: 1.292 Vali Loss: 1.247 Vali Acc: 0.447 Test Loss: 1.247 Test Acc: 0.447
Validation loss decreased (-0.309197 --> -0.447356).  Saving model ...
Epoch: 4 cost time: 0.854302167892456
Epoch: 4, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.180 Vali Acc: 0.586 Test Loss: 1.180 Test Acc: 0.586
Validation loss decreased (-0.447356 --> -0.585515).  Saving model ...
Epoch: 5 cost time: 1.004518985748291
Epoch: 5, Steps: 10 | Train Loss: 1.094 Vali Loss: 1.113 Vali Acc: 0.599 Test Loss: 1.113 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598673).  Saving model ...
Epoch: 6 cost time: 1.105487585067749
Epoch: 6, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.030 Vali Acc: 0.605 Test Loss: 1.030 Test Acc: 0.605
Validation loss decreased (-0.598673 --> -0.605253).  Saving model ...
Epoch: 7 cost time: 1.1074581146240234
Epoch: 7, Steps: 10 | Train Loss: 0.869 Vali Loss: 0.987 Vali Acc: 0.618 Test Loss: 0.987 Test Acc: 0.618
Validation loss decreased (-0.605253 --> -0.618411).  Saving model ...
Epoch: 8 cost time: 1.0764131546020508
Epoch: 8, Steps: 10 | Train Loss: 0.803 Vali Loss: 0.896 Vali Acc: 0.625 Test Loss: 0.896 Test Acc: 0.625
Validation loss decreased (-0.618411 --> -0.624991).  Saving model ...
Epoch: 9 cost time: 0.9930386543273926
Epoch: 9, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.819 Vali Acc: 0.704 Test Loss: 0.819 Test Acc: 0.704
Validation loss decreased (-0.624991 --> -0.703939).  Saving model ...
Epoch: 10 cost time: 0.844520092010498
Epoch: 10, Steps: 10 | Train Loss: 0.593 Vali Loss: 0.747 Vali Acc: 0.711 Test Loss: 0.747 Test Acc: 0.711
Validation loss decreased (-0.703939 --> -0.710519).  Saving model ...
Epoch: 11 cost time: 1.0604963302612305
Epoch: 11, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.693 Vali Acc: 0.757 Test Loss: 0.693 Test Acc: 0.757
Validation loss decreased (-0.710519 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 1.2359519004821777
Epoch: 12, Steps: 10 | Train Loss: 0.414 Vali Loss: 0.648 Vali Acc: 0.757 Test Loss: 0.648 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756572).  Saving model ...
Epoch: 13 cost time: 1.2917735576629639
Epoch: 13, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.606 Vali Acc: 0.770 Test Loss: 0.606 Test Acc: 0.770
Validation loss decreased (-0.756572 --> -0.769731).  Saving model ...
Epoch: 14 cost time: 1.1773829460144043
Epoch: 14, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.564 Vali Acc: 0.776 Test Loss: 0.564 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.1665492057800293
Epoch: 15, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.4440553188323975
Epoch: 16, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0755608081817627
Epoch: 17, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.492 Vali Acc: 0.770 Test Loss: 0.492 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2458655834197998
Epoch: 18, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.521 Vali Acc: 0.796 Test Loss: 0.521 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 19 cost time: 1.0244877338409424
Epoch: 19, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.531 Vali Acc: 0.789 Test Loss: 0.531 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1360244750976562
Epoch: 20, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.607 Vali Acc: 0.809 Test Loss: 0.607 Test Acc: 0.809
Validation loss decreased (-0.796047 --> -0.809204).  Saving model ...
Epoch: 21 cost time: 0.9611954689025879
Epoch: 21, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.587 Vali Acc: 0.816 Test Loss: 0.587 Test Acc: 0.816
Validation loss decreased (-0.809204 --> -0.815784).  Saving model ...
Epoch: 22 cost time: 1.3053851127624512
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.641 Vali Acc: 0.803 Test Loss: 0.641 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.135831356048584
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.649 Vali Acc: 0.783 Test Loss: 0.649 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3222386837005615
Epoch: 24, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.699 Vali Acc: 0.803 Test Loss: 0.699 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3823704719543457
Epoch: 25, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.753 Vali Acc: 0.809 Test Loss: 0.753 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.3876256942749023
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.789 Vali Acc: 0.803 Test Loss: 0.789 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1298441886901855
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.821 Vali Acc: 0.783 Test Loss: 0.821 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2615880966186523
Epoch: 28, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.861 Vali Acc: 0.803 Test Loss: 0.861 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9757890701293945
Epoch: 29, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.860 Vali Acc: 0.783 Test Loss: 0.860 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.107464075088501
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.913 Vali Acc: 0.796 Test Loss: 0.913 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2681927680969238
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.924 Vali Acc: 0.783 Test Loss: 0.924 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 914076
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.774528741836548
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.389 Vali Acc: 0.276 Test Loss: 1.389 Test Acc: 0.276
Validation loss decreased (inf --> -0.276302).  Saving model ...
Epoch: 2 cost time: 1.1049227714538574
Epoch: 2, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.381 Vali Acc: 0.316 Test Loss: 1.381 Test Acc: 0.316
Validation loss decreased (-0.276302 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 1.0882015228271484
Epoch: 3, Steps: 10 | Train Loss: 1.302 Vali Loss: 1.287 Vali Acc: 0.421 Test Loss: 1.287 Test Acc: 0.421
Validation loss decreased (-0.315776 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 0.9744815826416016
Epoch: 4, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.212 Vali Acc: 0.566 Test Loss: 1.212 Test Acc: 0.566
Validation loss decreased (-0.421040 --> -0.565777).  Saving model ...
Epoch: 5 cost time: 1.971435308456421
Epoch: 5, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.147 Vali Acc: 0.579 Test Loss: 1.147 Test Acc: 0.579
Validation loss decreased (-0.565777 --> -0.578936).  Saving model ...
Epoch: 6 cost time: 1.1278109550476074
Epoch: 6, Steps: 10 | Train Loss: 1.005 Vali Loss: 1.067 Vali Acc: 0.632 Test Loss: 1.067 Test Acc: 0.632
Validation loss decreased (-0.578936 --> -0.631568).  Saving model ...
Epoch: 7 cost time: 1.0515623092651367
Epoch: 7, Steps: 10 | Train Loss: 0.877 Vali Loss: 0.993 Vali Acc: 0.625 Test Loss: 0.993 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9519481658935547
Epoch: 8, Steps: 10 | Train Loss: 0.793 Vali Loss: 0.927 Vali Acc: 0.678 Test Loss: 0.927 Test Acc: 0.678
Validation loss decreased (-0.631568 --> -0.677622).  Saving model ...
Epoch: 9 cost time: 1.117640733718872
Epoch: 9, Steps: 10 | Train Loss: 0.676 Vali Loss: 0.849 Vali Acc: 0.658 Test Loss: 0.849 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1227900981903076
Epoch: 10, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.772 Vali Acc: 0.717 Test Loss: 0.772 Test Acc: 0.717
Validation loss decreased (-0.677622 --> -0.717098).  Saving model ...
Epoch: 11 cost time: 1.103020191192627
Epoch: 11, Steps: 10 | Train Loss: 0.502 Vali Loss: 0.731 Vali Acc: 0.750 Test Loss: 0.731 Test Acc: 0.750
Validation loss decreased (-0.717098 --> -0.749993).  Saving model ...
Epoch: 12 cost time: 1.0471491813659668
Epoch: 12, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.716 Vali Acc: 0.743 Test Loss: 0.716 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.301830768585205
Epoch: 13, Steps: 10 | Train Loss: 0.405 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763151).  Saving model ...
Epoch: 14 cost time: 1.280282735824585
Epoch: 14, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.601 Vali Acc: 0.743 Test Loss: 0.601 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5134820938110352
Epoch: 15, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
Validation loss decreased (-0.763151 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 1.3197495937347412
Epoch: 16, Steps: 10 | Train Loss: 0.197 Vali Loss: 0.571 Vali Acc: 0.763 Test Loss: 0.571 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2895913124084473
Epoch: 17, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.539 Vali Acc: 0.809 Test Loss: 0.539 Test Acc: 0.809
Validation loss decreased (-0.769731 --> -0.809205).  Saving model ...
Epoch: 18 cost time: 1.199991226196289
Epoch: 18, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.597 Vali Acc: 0.789 Test Loss: 0.597 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1028990745544434
Epoch: 19, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.570 Vali Acc: 0.796 Test Loss: 0.570 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.421168565750122
Epoch: 20, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.612 Vali Acc: 0.796 Test Loss: 0.612 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2879600524902344
Epoch: 21, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.606 Vali Acc: 0.796 Test Loss: 0.606 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.144965410232544
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.620 Vali Acc: 0.796 Test Loss: 0.620 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2808048725128174
Epoch: 23, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.682 Vali Acc: 0.809 Test Loss: 0.682 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2879722118377686
Epoch: 24, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.720 Vali Acc: 0.789 Test Loss: 0.720 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9303200244903564
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.766 Vali Acc: 0.796 Test Loss: 0.766 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.212092399597168
Epoch: 26, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.782 Vali Acc: 0.789 Test Loss: 0.782 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.2043232917785645
Epoch: 27, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.809 Vali Acc: 0.796 Test Loss: 0.809 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 913692
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.936331272125244
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.349 Vali Acc: 0.362 Test Loss: 1.349 Test Acc: 0.362
Validation loss decreased (inf --> -0.361829).  Saving model ...
Epoch: 2 cost time: 0.9287045001983643
Epoch: 2, Steps: 10 | Train Loss: 1.347 Vali Loss: 1.351 Vali Acc: 0.375 Test Loss: 1.351 Test Acc: 0.375
Validation loss decreased (-0.361829 --> -0.374986).  Saving model ...
Epoch: 3 cost time: 1.25001859664917
Epoch: 3, Steps: 10 | Train Loss: 1.316 Vali Loss: 1.261 Vali Acc: 0.500 Test Loss: 1.261 Test Acc: 0.500
Validation loss decreased (-0.374986 --> -0.499987).  Saving model ...
Epoch: 4 cost time: 0.9932482242584229
Epoch: 4, Steps: 10 | Train Loss: 1.197 Vali Loss: 1.180 Vali Acc: 0.566 Test Loss: 1.180 Test Acc: 0.566
Validation loss decreased (-0.499987 --> -0.565778).  Saving model ...
Epoch: 5 cost time: 1.0332615375518799
Epoch: 5, Steps: 10 | Train Loss: 1.089 Vali Loss: 1.105 Vali Acc: 0.618 Test Loss: 1.105 Test Acc: 0.618
Validation loss decreased (-0.565778 --> -0.618410).  Saving model ...
Epoch: 6 cost time: 1.24949312210083
Epoch: 6, Steps: 10 | Train Loss: 0.990 Vali Loss: 1.029 Vali Acc: 0.638 Test Loss: 1.029 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638148).  Saving model ...
Epoch: 7 cost time: 0.980731725692749
Epoch: 7, Steps: 10 | Train Loss: 0.871 Vali Loss: 0.945 Vali Acc: 0.684 Test Loss: 0.945 Test Acc: 0.684
Validation loss decreased (-0.638148 --> -0.684201).  Saving model ...
Epoch: 8 cost time: 1.1930532455444336
Epoch: 8, Steps: 10 | Train Loss: 0.778 Vali Loss: 0.867 Vali Acc: 0.678 Test Loss: 0.867 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1384027004241943
Epoch: 9, Steps: 10 | Train Loss: 0.673 Vali Loss: 0.794 Vali Acc: 0.697 Test Loss: 0.794 Test Acc: 0.697
Validation loss decreased (-0.684201 --> -0.697360).  Saving model ...
Epoch: 10 cost time: 1.1210966110229492
Epoch: 10, Steps: 10 | Train Loss: 0.572 Vali Loss: 0.714 Vali Acc: 0.730 Test Loss: 0.714 Test Acc: 0.730
Validation loss decreased (-0.697360 --> -0.730256).  Saving model ...
Epoch: 11 cost time: 1.2125630378723145
Epoch: 11, Steps: 10 | Train Loss: 0.465 Vali Loss: 0.657 Vali Acc: 0.730 Test Loss: 0.657 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 12 cost time: 1.0605180263519287
Epoch: 12, Steps: 10 | Train Loss: 0.360 Vali Loss: 0.609 Vali Acc: 0.763 Test Loss: 0.609 Test Acc: 0.763
Validation loss decreased (-0.730257 --> -0.763152).  Saving model ...
Epoch: 13 cost time: 1.2282586097717285
Epoch: 13, Steps: 10 | Train Loss: 0.317 Vali Loss: 0.566 Vali Acc: 0.783 Test Loss: 0.566 Test Acc: 0.783
Validation loss decreased (-0.763152 --> -0.782889).  Saving model ...
Epoch: 14 cost time: 1.0628726482391357
Epoch: 14, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.548 Vali Acc: 0.757 Test Loss: 0.548 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4590566158294678
Epoch: 15, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.548 Vali Acc: 0.796 Test Loss: 0.548 Test Acc: 0.796
Validation loss decreased (-0.782889 --> -0.796047).  Saving model ...
Epoch: 16 cost time: 0.8764369487762451
Epoch: 16, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.510 Vali Acc: 0.763 Test Loss: 0.510 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9316041469573975
Epoch: 17, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.510 Vali Acc: 0.789 Test Loss: 0.510 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9270086288452148
Epoch: 18, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.565 Vali Acc: 0.783 Test Loss: 0.565 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1592016220092773
Epoch: 19, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.603 Vali Acc: 0.789 Test Loss: 0.603 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3030166625976562
Epoch: 20, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.600 Vali Acc: 0.803 Test Loss: 0.600 Test Acc: 0.803
Validation loss decreased (-0.796047 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 1.0963959693908691
Epoch: 21, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.636 Vali Acc: 0.803 Test Loss: 0.636 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2360596656799316
Epoch: 22, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.644 Vali Acc: 0.789 Test Loss: 0.644 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2392244338989258
Epoch: 23, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.675 Vali Acc: 0.783 Test Loss: 0.675 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1970000267028809
Epoch: 24, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.724 Vali Acc: 0.796 Test Loss: 0.724 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9508211612701416
Epoch: 25, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.750 Vali Acc: 0.776 Test Loss: 0.750 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9175140857696533
Epoch: 26, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.801 Vali Acc: 0.776 Test Loss: 0.801 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.100963830947876
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.863 Vali Acc: 0.816 Test Loss: 0.863 Test Acc: 0.816
Validation loss decreased (-0.802626 --> -0.815781).  Saving model ...
Epoch: 28 cost time: 1.162687063217163
Epoch: 28, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.815 Vali Acc: 0.776 Test Loss: 0.815 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1066794395446777
Epoch: 29, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.826 Vali Acc: 0.796 Test Loss: 0.826 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.912651538848877
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.832 Vali Acc: 0.789 Test Loss: 0.832 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2362003326416016
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 0.863 Vali Acc: 0.803 Test Loss: 0.863 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8353662490844727
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 0.885 Vali Acc: 0.783 Test Loss: 0.885 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9772536754608154
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.906 Vali Acc: 0.789 Test Loss: 0.906 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.0701532363891602
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.919 Vali Acc: 0.783 Test Loss: 0.919 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8850059509277344
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.935 Vali Acc: 0.796 Test Loss: 0.935 Test Acc: 0.796
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9006280899047852
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 0.951 Vali Acc: 0.809 Test Loss: 0.951 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.1345539093017578
Epoch: 37, Steps: 10 | Train Loss: 0.002 Vali Loss: 0.960 Vali Acc: 0.803 Test Loss: 0.960 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 913308
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.148885488510132
Epoch: 1, Steps: 10 | Train Loss: 1.470 Vali Loss: 1.358 Vali Acc: 0.283 Test Loss: 1.358 Test Acc: 0.283
Validation loss decreased (inf --> -0.282881).  Saving model ...
Epoch: 2 cost time: 1.340275526046753
Epoch: 2, Steps: 10 | Train Loss: 1.342 Vali Loss: 1.327 Vali Acc: 0.362 Test Loss: 1.327 Test Acc: 0.362
Validation loss decreased (-0.282881 --> -0.361829).  Saving model ...
Epoch: 3 cost time: 1.1986725330352783
Epoch: 3, Steps: 10 | Train Loss: 1.284 Vali Loss: 1.254 Vali Acc: 0.480 Test Loss: 1.254 Test Acc: 0.480
Validation loss decreased (-0.361829 --> -0.480251).  Saving model ...
Epoch: 4 cost time: 1.2818336486816406
Epoch: 4, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.186 Vali Acc: 0.559 Test Loss: 1.186 Test Acc: 0.559
Validation loss decreased (-0.480251 --> -0.559199).  Saving model ...
Epoch: 5 cost time: 1.2299940586090088
Epoch: 5, Steps: 10 | Train Loss: 1.100 Vali Loss: 1.112 Vali Acc: 0.664 Test Loss: 1.112 Test Acc: 0.664
Validation loss decreased (-0.559199 --> -0.664463).  Saving model ...
Epoch: 6 cost time: 1.0465259552001953
Epoch: 6, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.040 Vali Acc: 0.618 Test Loss: 1.040 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2454214096069336
Epoch: 7, Steps: 10 | Train Loss: 0.908 Vali Loss: 0.971 Vali Acc: 0.678 Test Loss: 0.971 Test Acc: 0.678
Validation loss decreased (-0.664463 --> -0.677622).  Saving model ...
Epoch: 8 cost time: 1.1068894863128662
Epoch: 8, Steps: 10 | Train Loss: 0.755 Vali Loss: 0.881 Vali Acc: 0.684 Test Loss: 0.881 Test Acc: 0.684
Validation loss decreased (-0.677622 --> -0.684202).  Saving model ...
Epoch: 9 cost time: 1.0116071701049805
Epoch: 9, Steps: 10 | Train Loss: 0.678 Vali Loss: 0.798 Vali Acc: 0.724 Test Loss: 0.798 Test Acc: 0.724
Validation loss decreased (-0.684202 --> -0.723676).  Saving model ...
Epoch: 10 cost time: 1.1174888610839844
Epoch: 10, Steps: 10 | Train Loss: 0.547 Vali Loss: 0.735 Vali Acc: 0.724 Test Loss: 0.735 Test Acc: 0.724
Validation loss decreased (-0.723676 --> -0.723677).  Saving model ...
Epoch: 11 cost time: 1.1196556091308594
Epoch: 11, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.659 Vali Acc: 0.757 Test Loss: 0.659 Test Acc: 0.757
Validation loss decreased (-0.723677 --> -0.756572).  Saving model ...
Epoch: 12 cost time: 1.1274440288543701
Epoch: 12, Steps: 10 | Train Loss: 0.368 Vali Loss: 0.606 Vali Acc: 0.776 Test Loss: 0.606 Test Acc: 0.776
Validation loss decreased (-0.756572 --> -0.776310).  Saving model ...
Epoch: 13 cost time: 1.0079677104949951
Epoch: 13, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.538 Vali Acc: 0.770 Test Loss: 0.538 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.137862205505371
Epoch: 14, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796048).  Saving model ...
Epoch: 15 cost time: 1.0916857719421387
Epoch: 15, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.492 Vali Acc: 0.796 Test Loss: 0.492 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 16 cost time: 1.2612123489379883
Epoch: 16, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.582 Vali Acc: 0.789 Test Loss: 0.582 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1986567974090576
Epoch: 17, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.530 Vali Acc: 0.796 Test Loss: 0.530 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3196115493774414
Epoch: 18, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 19 cost time: 1.3148775100708008
Epoch: 19, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.505 Vali Acc: 0.829 Test Loss: 0.505 Test Acc: 0.829
Validation loss decreased (-0.802626 --> -0.828942).  Saving model ...
Epoch: 20 cost time: 1.3032245635986328
Epoch: 20, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.552 Vali Acc: 0.809 Test Loss: 0.552 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.436319351196289
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.615 Vali Acc: 0.829 Test Loss: 0.615 Test Acc: 0.829
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2100651264190674
Epoch: 22, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.652 Vali Acc: 0.809 Test Loss: 0.652 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.20169997215271
Epoch: 23, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.662 Vali Acc: 0.816 Test Loss: 0.662 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6808762550354004
Epoch: 24, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.735 Vali Acc: 0.796 Test Loss: 0.735 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1156792640686035
Epoch: 25, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.738 Vali Acc: 0.816 Test Loss: 0.738 Test Acc: 0.816
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2247130870819092
Epoch: 26, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.779 Vali Acc: 0.803 Test Loss: 0.779 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3074421882629395
Epoch: 27, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.806 Vali Acc: 0.809 Test Loss: 0.806 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.1425840854644775
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.832 Vali Acc: 0.809 Test Loss: 0.832 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1971075534820557
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.849 Vali Acc: 0.809 Test Loss: 0.849 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 912924
model size : 5.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.4215452671051025
Epoch: 1, Steps: 10 | Train Loss: 1.548 Vali Loss: 1.447 Vali Acc: 0.164 Test Loss: 1.447 Test Acc: 0.164
Validation loss decreased (inf --> -0.164459).  Saving model ...
Epoch: 2 cost time: 1.097745656967163
Epoch: 2, Steps: 10 | Train Loss: 1.457 Vali Loss: 1.412 Vali Acc: 0.263 Test Loss: 1.412 Test Acc: 0.263
Validation loss decreased (-0.164459 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 1.0796427726745605
Epoch: 3, Steps: 10 | Train Loss: 1.423 Vali Loss: 1.372 Vali Acc: 0.296 Test Loss: 1.372 Test Acc: 0.296
Validation loss decreased (-0.263144 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 0.9553556442260742
Epoch: 4, Steps: 10 | Train Loss: 1.297 Vali Loss: 1.300 Vali Acc: 0.434 Test Loss: 1.300 Test Acc: 0.434
Validation loss decreased (-0.296039 --> -0.434198).  Saving model ...
Epoch: 5 cost time: 0.8943979740142822
Epoch: 5, Steps: 10 | Train Loss: 1.230 Vali Loss: 1.249 Vali Acc: 0.520 Test Loss: 1.249 Test Acc: 0.520
Validation loss decreased (-0.434198 --> -0.519724).  Saving model ...
Epoch: 6 cost time: 0.8010001182556152
Epoch: 6, Steps: 10 | Train Loss: 1.151 Vali Loss: 1.164 Vali Acc: 0.559 Test Loss: 1.164 Test Acc: 0.559
Validation loss decreased (-0.519724 --> -0.559199).  Saving model ...
Epoch: 7 cost time: 1.0433416366577148
Epoch: 7, Steps: 10 | Train Loss: 1.034 Vali Loss: 1.098 Vali Acc: 0.612 Test Loss: 1.098 Test Acc: 0.612
Validation loss decreased (-0.559199 --> -0.611831).  Saving model ...
Epoch: 8 cost time: 1.2331604957580566
Epoch: 8, Steps: 10 | Train Loss: 0.938 Vali Loss: 1.018 Vali Acc: 0.645 Test Loss: 1.018 Test Acc: 0.645
Validation loss decreased (-0.611831 --> -0.644727).  Saving model ...
Epoch: 9 cost time: 1.0759737491607666
Epoch: 9, Steps: 10 | Train Loss: 0.815 Vali Loss: 0.930 Vali Acc: 0.697 Test Loss: 0.930 Test Acc: 0.697
Validation loss decreased (-0.644727 --> -0.697359).  Saving model ...
Epoch: 10 cost time: 1.2662878036499023
Epoch: 10, Steps: 10 | Train Loss: 0.729 Vali Loss: 0.849 Vali Acc: 0.697 Test Loss: 0.849 Test Acc: 0.697
Validation loss decreased (-0.697359 --> -0.697360).  Saving model ...
Epoch: 11 cost time: 1.2759289741516113
Epoch: 11, Steps: 10 | Train Loss: 0.631 Vali Loss: 0.779 Vali Acc: 0.737 Test Loss: 0.779 Test Acc: 0.737
Validation loss decreased (-0.697360 --> -0.736834).  Saving model ...
Epoch: 12 cost time: 1.357191801071167
Epoch: 12, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.703 Vali Acc: 0.743 Test Loss: 0.703 Test Acc: 0.743
Validation loss decreased (-0.736834 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 1.1869230270385742
Epoch: 13, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.639 Vali Acc: 0.750 Test Loss: 0.639 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 14 cost time: 0.9860117435455322
Epoch: 14, Steps: 10 | Train Loss: 0.374 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 0.9495460987091064
Epoch: 15, Steps: 10 | Train Loss: 0.316 Vali Loss: 0.559 Vali Acc: 0.757 Test Loss: 0.559 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3573400974273682
Epoch: 16, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 17 cost time: 1.1466360092163086
Epoch: 17, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.0380644798278809
Epoch: 18, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.471 Vali Acc: 0.776 Test Loss: 0.471 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5726854801177979
Epoch: 19, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.454 Vali Acc: 0.770 Test Loss: 0.454 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4236218929290771
Epoch: 20, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.449 Vali Acc: 0.776 Test Loss: 0.449 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0275473594665527
Epoch: 21, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.441 Vali Acc: 0.770 Test Loss: 0.441 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1030068397521973
Epoch: 22, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.442 Vali Acc: 0.776 Test Loss: 0.442 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8931303024291992
Epoch: 23, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.450 Vali Acc: 0.776 Test Loss: 0.450 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.284639835357666
Epoch: 24, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.453 Vali Acc: 0.783 Test Loss: 0.453 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8611161708831787
Epoch: 25, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.453 Vali Acc: 0.783 Test Loss: 0.453 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1166775226593018
Epoch: 26, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.465 Vali Acc: 0.783 Test Loss: 0.465 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0120418071746826
Epoch: 27, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.466 Vali Acc: 0.783 Test Loss: 0.466 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 607388
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.7896652221679688
Epoch: 1, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.420 Vali Acc: 0.224 Test Loss: 1.420 Test Acc: 0.224
Validation loss decreased (inf --> -0.223670).  Saving model ...
Epoch: 2 cost time: 1.2700834274291992
Epoch: 2, Steps: 10 | Train Loss: 1.388 Vali Loss: 1.387 Vali Acc: 0.289 Test Loss: 1.387 Test Acc: 0.289
Validation loss decreased (-0.223670 --> -0.289460).  Saving model ...
Epoch: 3 cost time: 1.1280019283294678
Epoch: 3, Steps: 10 | Train Loss: 1.315 Vali Loss: 1.341 Vali Acc: 0.336 Test Loss: 1.341 Test Acc: 0.336
Validation loss decreased (-0.289460 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 1.0492689609527588
Epoch: 4, Steps: 10 | Train Loss: 1.280 Vali Loss: 1.276 Vali Acc: 0.447 Test Loss: 1.276 Test Acc: 0.447
Validation loss decreased (-0.335513 --> -0.447356).  Saving model ...
Epoch: 5 cost time: 0.9724292755126953
Epoch: 5, Steps: 10 | Train Loss: 1.145 Vali Loss: 1.224 Vali Acc: 0.493 Test Loss: 1.224 Test Acc: 0.493
Validation loss decreased (-0.447356 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 1.14274263381958
Epoch: 6, Steps: 10 | Train Loss: 1.078 Vali Loss: 1.153 Vali Acc: 0.533 Test Loss: 1.153 Test Acc: 0.533
Validation loss decreased (-0.493409 --> -0.532883).  Saving model ...
Epoch: 7 cost time: 1.0938177108764648
Epoch: 7, Steps: 10 | Train Loss: 0.980 Vali Loss: 1.081 Vali Acc: 0.605 Test Loss: 1.081 Test Acc: 0.605
Validation loss decreased (-0.532883 --> -0.605252).  Saving model ...
Epoch: 8 cost time: 1.144484519958496
Epoch: 8, Steps: 10 | Train Loss: 0.881 Vali Loss: 1.002 Vali Acc: 0.572 Test Loss: 1.002 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3317675590515137
Epoch: 9, Steps: 10 | Train Loss: 0.769 Vali Loss: 0.927 Vali Acc: 0.592 Test Loss: 0.927 Test Acc: 0.592
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3898050785064697
Epoch: 10, Steps: 10 | Train Loss: 0.674 Vali Loss: 0.842 Vali Acc: 0.658 Test Loss: 0.842 Test Acc: 0.658
Validation loss decreased (-0.605252 --> -0.657886).  Saving model ...
Epoch: 11 cost time: 1.0515797138214111
Epoch: 11, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.775 Vali Acc: 0.711 Test Loss: 0.775 Test Acc: 0.711
Validation loss decreased (-0.657886 --> -0.710519).  Saving model ...
Epoch: 12 cost time: 1.1105599403381348
Epoch: 12, Steps: 10 | Train Loss: 0.505 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
Validation loss decreased (-0.710519 --> -0.717098).  Saving model ...
Epoch: 13 cost time: 1.3401317596435547
Epoch: 13, Steps: 10 | Train Loss: 0.441 Vali Loss: 0.653 Vali Acc: 0.743 Test Loss: 0.653 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743415).  Saving model ...
Epoch: 14 cost time: 1.0733270645141602
Epoch: 14, Steps: 10 | Train Loss: 0.380 Vali Loss: 0.600 Vali Acc: 0.757 Test Loss: 0.600 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 1.2523956298828125
Epoch: 15, Steps: 10 | Train Loss: 0.330 Vali Loss: 0.567 Vali Acc: 0.776 Test Loss: 0.567 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 0.9568016529083252
Epoch: 16, Steps: 10 | Train Loss: 0.279 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.149587631225586
Epoch: 17, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 18 cost time: 1.2887599468231201
Epoch: 18, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.520 Vali Acc: 0.757 Test Loss: 0.520 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.251462697982788
Epoch: 19, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.511 Vali Acc: 0.796 Test Loss: 0.511 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 20 cost time: 1.185957908630371
Epoch: 20, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.506 Vali Acc: 0.750 Test Loss: 0.506 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2951791286468506
Epoch: 21, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.513 Vali Acc: 0.803 Test Loss: 0.513 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802626).  Saving model ...
Epoch: 22 cost time: 1.250058889389038
Epoch: 22, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.515 Vali Acc: 0.783 Test Loss: 0.515 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0582284927368164
Epoch: 23, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
Validation loss decreased (-0.802626 --> -0.802627).  Saving model ...
Epoch: 24 cost time: 1.1168022155761719
Epoch: 24, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9793124198913574
Epoch: 25, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.513 Vali Acc: 0.763 Test Loss: 0.513 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0006861686706543
Epoch: 26, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.087893009185791
Epoch: 27, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.535 Vali Acc: 0.770 Test Loss: 0.535 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0868504047393799
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.541 Vali Acc: 0.783 Test Loss: 0.541 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1233265399932861
Epoch: 29, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.558 Vali Acc: 0.789 Test Loss: 0.558 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.3109204769134521
Epoch: 30, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.551 Vali Acc: 0.783 Test Loss: 0.551 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.3252265453338623
Epoch: 31, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.2485363483428955
Epoch: 32, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.3196604251861572
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.608 Vali Acc: 0.783 Test Loss: 0.608 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 607196
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9557204246520996
Epoch: 1, Steps: 10 | Train Loss: 1.585 Vali Loss: 1.445 Vali Acc: 0.276 Test Loss: 1.445 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 0.8093752861022949
Epoch: 2, Steps: 10 | Train Loss: 1.492 Vali Loss: 1.418 Vali Acc: 0.309 Test Loss: 1.418 Test Acc: 0.309
Validation loss decreased (-0.276301 --> -0.309196).  Saving model ...
Epoch: 3 cost time: 0.7927987575531006
Epoch: 3, Steps: 10 | Train Loss: 1.430 Vali Loss: 1.349 Vali Acc: 0.322 Test Loss: 1.349 Test Acc: 0.322
Validation loss decreased (-0.309196 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 0.988584041595459
Epoch: 4, Steps: 10 | Train Loss: 1.339 Vali Loss: 1.296 Vali Acc: 0.428 Test Loss: 1.296 Test Acc: 0.428
Validation loss decreased (-0.322355 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 0.9884541034698486
Epoch: 5, Steps: 10 | Train Loss: 1.261 Vali Loss: 1.225 Vali Acc: 0.526 Test Loss: 1.225 Test Acc: 0.526
Validation loss decreased (-0.427619 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 0.7815656661987305
Epoch: 6, Steps: 10 | Train Loss: 1.160 Vali Loss: 1.163 Vali Acc: 0.553 Test Loss: 1.163 Test Acc: 0.553
Validation loss decreased (-0.526304 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 1.1950511932373047
Epoch: 7, Steps: 10 | Train Loss: 1.068 Vali Loss: 1.091 Vali Acc: 0.618 Test Loss: 1.091 Test Acc: 0.618
Validation loss decreased (-0.552620 --> -0.618410).  Saving model ...
Epoch: 8 cost time: 0.9094071388244629
Epoch: 8, Steps: 10 | Train Loss: 0.959 Vali Loss: 1.041 Vali Acc: 0.664 Test Loss: 1.041 Test Acc: 0.664
Validation loss decreased (-0.618410 --> -0.664463).  Saving model ...
Epoch: 9 cost time: 0.9495429992675781
Epoch: 9, Steps: 10 | Train Loss: 0.897 Vali Loss: 0.950 Vali Acc: 0.684 Test Loss: 0.950 Test Acc: 0.684
Validation loss decreased (-0.664463 --> -0.684201).  Saving model ...
Epoch: 10 cost time: 0.8974368572235107
Epoch: 10, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.887 Vali Acc: 0.664 Test Loss: 0.887 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9502315521240234
Epoch: 11, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.807 Vali Acc: 0.711 Test Loss: 0.807 Test Acc: 0.711
Validation loss decreased (-0.684201 --> -0.710518).  Saving model ...
Epoch: 12 cost time: 0.9327127933502197
Epoch: 12, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.736 Vali Acc: 0.704 Test Loss: 0.736 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0815541744232178
Epoch: 13, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.687 Vali Acc: 0.757 Test Loss: 0.687 Test Acc: 0.757
Validation loss decreased (-0.710518 --> -0.756572).  Saving model ...
Epoch: 14 cost time: 1.0968363285064697
Epoch: 14, Steps: 10 | Train Loss: 0.482 Vali Loss: 0.612 Vali Acc: 0.757 Test Loss: 0.612 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 0.9282152652740479
Epoch: 15, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
Validation loss decreased (-0.756573 --> -0.782889).  Saving model ...
Epoch: 16 cost time: 1.0106420516967773
Epoch: 16, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1178035736083984
Epoch: 17, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.506 Vali Acc: 0.763 Test Loss: 0.506 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1389424800872803
Epoch: 18, Steps: 10 | Train Loss: 0.228 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 0.9670348167419434
Epoch: 19, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.478 Vali Acc: 0.789 Test Loss: 0.478 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 20 cost time: 0.9702379703521729
Epoch: 20, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.473 Vali Acc: 0.783 Test Loss: 0.473 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9716830253601074
Epoch: 21, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.475 Vali Acc: 0.770 Test Loss: 0.475 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0548558235168457
Epoch: 22, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.469 Vali Acc: 0.789 Test Loss: 0.469 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 23 cost time: 1.1047148704528809
Epoch: 23, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.462 Vali Acc: 0.783 Test Loss: 0.462 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9486181735992432
Epoch: 24, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.492 Vali Acc: 0.822 Test Loss: 0.492 Test Acc: 0.822
Validation loss decreased (-0.789469 --> -0.822364).  Saving model ...
Epoch: 25 cost time: 1.096381664276123
Epoch: 25, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2890441417694092
Epoch: 26, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.471 Vali Acc: 0.796 Test Loss: 0.471 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.060248851776123
Epoch: 27, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.480 Vali Acc: 0.796 Test Loss: 0.480 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0801787376403809
Epoch: 28, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0472381114959717
Epoch: 29, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.501 Vali Acc: 0.796 Test Loss: 0.501 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8242030143737793
Epoch: 30, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.507 Vali Acc: 0.789 Test Loss: 0.507 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.0212554931640625
Epoch: 31, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2221672534942627
Epoch: 32, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.527 Vali Acc: 0.809 Test Loss: 0.527 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8092236518859863
Epoch: 33, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.0157766342163086
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 607004
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.6779625415802
Epoch: 1, Steps: 10 | Train Loss: 1.471 Vali Loss: 1.386 Vali Acc: 0.303 Test Loss: 1.386 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 1.1780545711517334
Epoch: 2, Steps: 10 | Train Loss: 1.353 Vali Loss: 1.362 Vali Acc: 0.296 Test Loss: 1.362 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0802016258239746
Epoch: 3, Steps: 10 | Train Loss: 1.318 Vali Loss: 1.297 Vali Acc: 0.421 Test Loss: 1.297 Test Acc: 0.421
Validation loss decreased (-0.302618 --> -0.421040).  Saving model ...
Epoch: 4 cost time: 1.015716314315796
Epoch: 4, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.244 Vali Acc: 0.493 Test Loss: 1.244 Test Acc: 0.493
Validation loss decreased (-0.421040 --> -0.493409).  Saving model ...
Epoch: 5 cost time: 1.0965745449066162
Epoch: 5, Steps: 10 | Train Loss: 1.177 Vali Loss: 1.184 Vali Acc: 0.566 Test Loss: 1.184 Test Acc: 0.566
Validation loss decreased (-0.493409 --> -0.565778).  Saving model ...
Epoch: 6 cost time: 0.9723052978515625
Epoch: 6, Steps: 10 | Train Loss: 1.048 Vali Loss: 1.116 Vali Acc: 0.599 Test Loss: 1.116 Test Acc: 0.599
Validation loss decreased (-0.565778 --> -0.598673).  Saving model ...
Epoch: 7 cost time: 1.11128830909729
Epoch: 7, Steps: 10 | Train Loss: 0.972 Vali Loss: 1.039 Vali Acc: 0.625 Test Loss: 1.039 Test Acc: 0.625
Validation loss decreased (-0.598673 --> -0.624990).  Saving model ...
Epoch: 8 cost time: 1.0999584197998047
Epoch: 8, Steps: 10 | Train Loss: 0.889 Vali Loss: 0.981 Vali Acc: 0.612 Test Loss: 0.981 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.158320426940918
Epoch: 9, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.883 Vali Acc: 0.678 Test Loss: 0.883 Test Acc: 0.678
Validation loss decreased (-0.624990 --> -0.677623).  Saving model ...
Epoch: 10 cost time: 1.1300914287567139
Epoch: 10, Steps: 10 | Train Loss: 0.669 Vali Loss: 0.808 Vali Acc: 0.704 Test Loss: 0.808 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703939).  Saving model ...
Epoch: 11 cost time: 1.063215732574463
Epoch: 11, Steps: 10 | Train Loss: 0.608 Vali Loss: 0.746 Vali Acc: 0.717 Test Loss: 0.746 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717098).  Saving model ...
Epoch: 12 cost time: 0.9941861629486084
Epoch: 12, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.678 Vali Acc: 0.743 Test Loss: 0.678 Test Acc: 0.743
Validation loss decreased (-0.717098 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 0.9782507419586182
Epoch: 13, Steps: 10 | Train Loss: 0.450 Vali Loss: 0.649 Vali Acc: 0.724 Test Loss: 0.649 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9525985717773438
Epoch: 14, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.602 Vali Acc: 0.770 Test Loss: 0.602 Test Acc: 0.770
Validation loss decreased (-0.743414 --> -0.769731).  Saving model ...
Epoch: 15 cost time: 1.2020833492279053
Epoch: 15, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 16 cost time: 0.9617774486541748
Epoch: 16, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782890).  Saving model ...
Epoch: 17 cost time: 0.9316158294677734
Epoch: 17, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.489 Vali Acc: 0.770 Test Loss: 0.489 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1848878860473633
Epoch: 18, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.467 Vali Acc: 0.776 Test Loss: 0.467 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.237900972366333
Epoch: 19, Steps: 10 | Train Loss: 0.185 Vali Loss: 0.453 Vali Acc: 0.783 Test Loss: 0.453 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 20 cost time: 1.0867319107055664
Epoch: 20, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.444 Vali Acc: 0.789 Test Loss: 0.444 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 21 cost time: 0.9762120246887207
Epoch: 21, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.445 Vali Acc: 0.796 Test Loss: 0.445 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 1.0887646675109863
Epoch: 22, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.434 Vali Acc: 0.783 Test Loss: 0.434 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9186766147613525
Epoch: 23, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.436 Vali Acc: 0.796 Test Loss: 0.436 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 24 cost time: 1.3724279403686523
Epoch: 24, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.452 Vali Acc: 0.796 Test Loss: 0.452 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0108752250671387
Epoch: 25, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.445 Vali Acc: 0.783 Test Loss: 0.445 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1025545597076416
Epoch: 26, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.445 Vali Acc: 0.789 Test Loss: 0.445 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.225114107131958
Epoch: 27, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.448 Vali Acc: 0.803 Test Loss: 0.448 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 28 cost time: 1.0368194580078125
Epoch: 28, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.464 Vali Acc: 0.796 Test Loss: 0.464 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0535857677459717
Epoch: 29, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.468 Vali Acc: 0.789 Test Loss: 0.468 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1850144863128662
Epoch: 30, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.515 Vali Acc: 0.816 Test Loss: 0.515 Test Acc: 0.816
Validation loss decreased (-0.802627 --> -0.815784).  Saving model ...
Epoch: 31 cost time: 1.074582815170288
Epoch: 31, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.533 Vali Acc: 0.796 Test Loss: 0.533 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0383224487304688
Epoch: 32, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.538 Vali Acc: 0.803 Test Loss: 0.538 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0732121467590332
Epoch: 33, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.516 Vali Acc: 0.796 Test Loss: 0.516 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0484330654144287
Epoch: 34, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.531 Vali Acc: 0.809 Test Loss: 0.531 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.0222077369689941
Epoch: 35, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.528 Vali Acc: 0.796 Test Loss: 0.528 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0889568328857422
Epoch: 36, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.556 Vali Acc: 0.796 Test Loss: 0.556 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0445775985717773
Epoch: 37, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.553 Vali Acc: 0.789 Test Loss: 0.553 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.093264102935791
Epoch: 38, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.569 Vali Acc: 0.803 Test Loss: 0.569 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.9149796962738037
Epoch: 39, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.569 Vali Acc: 0.796 Test Loss: 0.569 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.089113712310791
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.581 Vali Acc: 0.809 Test Loss: 0.581 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 606812
model size : 3.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3489158153533936
Epoch: 1, Steps: 10 | Train Loss: 1.437 Vali Loss: 1.368 Vali Acc: 0.303 Test Loss: 1.368 Test Acc: 0.303
Validation loss decreased (inf --> -0.302618).  Saving model ...
Epoch: 2 cost time: 0.8230423927307129
Epoch: 2, Steps: 10 | Train Loss: 1.390 Vali Loss: 1.334 Vali Acc: 0.355 Test Loss: 1.334 Test Acc: 0.355
Validation loss decreased (-0.302618 --> -0.355250).  Saving model ...
Epoch: 3 cost time: 1.2211253643035889
Epoch: 3, Steps: 10 | Train Loss: 1.349 Vali Loss: 1.289 Vali Acc: 0.474 Test Loss: 1.289 Test Acc: 0.474
Validation loss decreased (-0.355250 --> -0.473671).  Saving model ...
Epoch: 4 cost time: 0.9134676456451416
Epoch: 4, Steps: 10 | Train Loss: 1.295 Vali Loss: 1.265 Vali Acc: 0.454 Test Loss: 1.265 Test Acc: 0.454
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8837761878967285
Epoch: 5, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.204 Vali Acc: 0.493 Test Loss: 1.204 Test Acc: 0.493
Validation loss decreased (-0.473671 --> -0.493409).  Saving model ...
Epoch: 6 cost time: 0.900407075881958
Epoch: 6, Steps: 10 | Train Loss: 1.169 Vali Loss: 1.141 Vali Acc: 0.632 Test Loss: 1.141 Test Acc: 0.632
Validation loss decreased (-0.493409 --> -0.631568).  Saving model ...
Epoch: 7 cost time: 0.9275598526000977
Epoch: 7, Steps: 10 | Train Loss: 1.075 Vali Loss: 1.089 Vali Acc: 0.645 Test Loss: 1.089 Test Acc: 0.645
Validation loss decreased (-0.631568 --> -0.644726).  Saving model ...
Epoch: 8 cost time: 1.1129226684570312
Epoch: 8, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.023 Vali Acc: 0.691 Test Loss: 1.023 Test Acc: 0.691
Validation loss decreased (-0.644726 --> -0.690779).  Saving model ...
Epoch: 9 cost time: 0.9625246524810791
Epoch: 9, Steps: 10 | Train Loss: 0.913 Vali Loss: 0.968 Vali Acc: 0.711 Test Loss: 0.968 Test Acc: 0.711
Validation loss decreased (-0.690779 --> -0.710517).  Saving model ...
Epoch: 10 cost time: 1.01430344581604
Epoch: 10, Steps: 10 | Train Loss: 0.849 Vali Loss: 0.910 Vali Acc: 0.671 Test Loss: 0.910 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.07991623878479
Epoch: 11, Steps: 10 | Train Loss: 0.703 Vali Loss: 0.814 Vali Acc: 0.743 Test Loss: 0.814 Test Acc: 0.743
Validation loss decreased (-0.710517 --> -0.743413).  Saving model ...
Epoch: 12 cost time: 1.1779038906097412
Epoch: 12, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.736 Vali Acc: 0.743 Test Loss: 0.736 Test Acc: 0.743
Validation loss decreased (-0.743413 --> -0.743414).  Saving model ...
Epoch: 13 cost time: 1.085054874420166
Epoch: 13, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.666 Vali Acc: 0.750 Test Loss: 0.666 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749993).  Saving model ...
Epoch: 14 cost time: 0.999028205871582
Epoch: 14, Steps: 10 | Train Loss: 0.470 Vali Loss: 0.613 Vali Acc: 0.757 Test Loss: 0.613 Test Acc: 0.757
Validation loss decreased (-0.749993 --> -0.756573).  Saving model ...
Epoch: 15 cost time: 1.342191457748413
Epoch: 15, Steps: 10 | Train Loss: 0.415 Vali Loss: 0.566 Vali Acc: 0.763 Test Loss: 0.566 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 16 cost time: 1.0816690921783447
Epoch: 16, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.532 Vali Acc: 0.803 Test Loss: 0.532 Test Acc: 0.803
Validation loss decreased (-0.763152 --> -0.802626).  Saving model ...
Epoch: 17 cost time: 1.0416789054870605
Epoch: 17, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.505 Vali Acc: 0.796 Test Loss: 0.505 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.131883144378662
Epoch: 18, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.488 Vali Acc: 0.770 Test Loss: 0.488 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1834197044372559
Epoch: 19, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.472 Vali Acc: 0.776 Test Loss: 0.472 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1568210124969482
Epoch: 20, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.464 Vali Acc: 0.770 Test Loss: 0.464 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.019953966140747
Epoch: 21, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.462 Vali Acc: 0.776 Test Loss: 0.462 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9697060585021973
Epoch: 22, Steps: 10 | Train Loss: 0.141 Vali Loss: 0.457 Vali Acc: 0.796 Test Loss: 0.457 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8953437805175781
Epoch: 23, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.450 Vali Acc: 0.789 Test Loss: 0.450 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9695107936859131
Epoch: 24, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.463 Vali Acc: 0.789 Test Loss: 0.463 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8581559658050537
Epoch: 25, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.460 Vali Acc: 0.796 Test Loss: 0.460 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9920146465301514
Epoch: 26, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.458 Vali Acc: 0.789 Test Loss: 0.458 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 409244
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.436461925506592
Epoch: 1, Steps: 10 | Train Loss: 1.561 Vali Loss: 1.363 Vali Acc: 0.316 Test Loss: 1.363 Test Acc: 0.316
Validation loss decreased (inf --> -0.315776).  Saving model ...
Epoch: 2 cost time: 1.1652729511260986
Epoch: 2, Steps: 10 | Train Loss: 1.377 Vali Loss: 1.326 Vali Acc: 0.316 Test Loss: 1.326 Test Acc: 0.316
Validation loss decreased (-0.315776 --> -0.315776).  Saving model ...
Epoch: 3 cost time: 0.9693193435668945
Epoch: 3, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.324 Vali Acc: 0.316 Test Loss: 1.324 Test Acc: 0.316
Validation loss decreased (-0.315776 --> -0.315776).  Saving model ...
Epoch: 4 cost time: 1.0196175575256348
Epoch: 4, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.237 Vali Acc: 0.428 Test Loss: 1.237 Test Acc: 0.428
Validation loss decreased (-0.315776 --> -0.427619).  Saving model ...
Epoch: 5 cost time: 1.0576226711273193
Epoch: 5, Steps: 10 | Train Loss: 1.224 Vali Loss: 1.182 Vali Acc: 0.526 Test Loss: 1.182 Test Acc: 0.526
Validation loss decreased (-0.427619 --> -0.526304).  Saving model ...
Epoch: 6 cost time: 0.7629232406616211
Epoch: 6, Steps: 10 | Train Loss: 1.142 Vali Loss: 1.140 Vali Acc: 0.586 Test Loss: 1.140 Test Acc: 0.586
Validation loss decreased (-0.526304 --> -0.585515).  Saving model ...
Epoch: 7 cost time: 0.8385336399078369
Epoch: 7, Steps: 10 | Train Loss: 1.063 Vali Loss: 1.074 Vali Acc: 0.645 Test Loss: 1.074 Test Acc: 0.645
Validation loss decreased (-0.585515 --> -0.644726).  Saving model ...
Epoch: 8 cost time: 0.9855692386627197
Epoch: 8, Steps: 10 | Train Loss: 0.986 Vali Loss: 1.001 Vali Acc: 0.678 Test Loss: 1.001 Test Acc: 0.678
Validation loss decreased (-0.644726 --> -0.677622).  Saving model ...
Epoch: 9 cost time: 0.915168285369873
Epoch: 9, Steps: 10 | Train Loss: 0.872 Vali Loss: 0.938 Vali Acc: 0.671 Test Loss: 0.938 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9252197742462158
Epoch: 10, Steps: 10 | Train Loss: 0.763 Vali Loss: 0.876 Vali Acc: 0.658 Test Loss: 0.876 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.096480369567871
Epoch: 11, Steps: 10 | Train Loss: 0.707 Vali Loss: 0.807 Vali Acc: 0.691 Test Loss: 0.807 Test Acc: 0.691
Validation loss decreased (-0.677622 --> -0.690781).  Saving model ...
Epoch: 12 cost time: 1.0609045028686523
Epoch: 12, Steps: 10 | Train Loss: 0.609 Vali Loss: 0.744 Vali Acc: 0.730 Test Loss: 0.744 Test Acc: 0.730
Validation loss decreased (-0.690781 --> -0.730256).  Saving model ...
Epoch: 13 cost time: 1.2465476989746094
Epoch: 13, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.686 Vali Acc: 0.770 Test Loss: 0.686 Test Acc: 0.770
Validation loss decreased (-0.730256 --> -0.769730).  Saving model ...
Epoch: 14 cost time: 0.9608774185180664
Epoch: 14, Steps: 10 | Train Loss: 0.440 Vali Loss: 0.629 Vali Acc: 0.776 Test Loss: 0.629 Test Acc: 0.776
Validation loss decreased (-0.769730 --> -0.776310).  Saving model ...
Epoch: 15 cost time: 1.344303846359253
Epoch: 15, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.592 Vali Acc: 0.770 Test Loss: 0.592 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1218361854553223
Epoch: 16, Steps: 10 | Train Loss: 0.331 Vali Loss: 0.562 Vali Acc: 0.770 Test Loss: 0.562 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9201831817626953
Epoch: 17, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
Validation loss decreased (-0.776310 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 0.9010269641876221
Epoch: 18, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789469).  Saving model ...
Epoch: 19 cost time: 0.9172670841217041
Epoch: 19, Steps: 10 | Train Loss: 0.223 Vali Loss: 0.484 Vali Acc: 0.776 Test Loss: 0.484 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0360772609710693
Epoch: 20, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.473 Vali Acc: 0.783 Test Loss: 0.473 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9072558879852295
Epoch: 21, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.463 Vali Acc: 0.776 Test Loss: 0.463 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1800706386566162
Epoch: 22, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.460 Vali Acc: 0.776 Test Loss: 0.460 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.129481315612793
Epoch: 23, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.464 Vali Acc: 0.783 Test Loss: 0.464 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.051957368850708
Epoch: 24, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.461 Vali Acc: 0.783 Test Loss: 0.461 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.967836856842041
Epoch: 25, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.465 Vali Acc: 0.796 Test Loss: 0.465 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 26 cost time: 0.8998100757598877
Epoch: 26, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.465 Vali Acc: 0.776 Test Loss: 0.465 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9509599208831787
Epoch: 27, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.480 Vali Acc: 0.803 Test Loss: 0.480 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 28 cost time: 0.8328216075897217
Epoch: 28, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.496 Vali Acc: 0.776 Test Loss: 0.496 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8274683952331543
Epoch: 29, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8557984828948975
Epoch: 30, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.483 Vali Acc: 0.803 Test Loss: 0.483 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8279106616973877
Epoch: 31, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.495 Vali Acc: 0.796 Test Loss: 0.495 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1288642883300781
Epoch: 32, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.515 Vali Acc: 0.789 Test Loss: 0.515 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.0813038349151611
Epoch: 33, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4819459915161133
Epoch: 34, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.525 Vali Acc: 0.796 Test Loss: 0.525 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.2545790672302246
Epoch: 35, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.528 Vali Acc: 0.809 Test Loss: 0.528 Test Acc: 0.809
Validation loss decreased (-0.802627 --> -0.809205).  Saving model ...
Epoch: 36 cost time: 1.4161005020141602
Epoch: 36, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.534 Vali Acc: 0.809 Test Loss: 0.534 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0871708393096924
Epoch: 37, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.543 Vali Acc: 0.809 Test Loss: 0.543 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.9851319789886475
Epoch: 38, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.548 Vali Acc: 0.809 Test Loss: 0.548 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.037975549697876
Epoch: 39, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.561 Vali Acc: 0.809 Test Loss: 0.561 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9931700229644775
Epoch: 40, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9736800193786621
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.570 Vali Acc: 0.809 Test Loss: 0.570 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9474573135375977
Epoch: 42, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.579 Vali Acc: 0.809 Test Loss: 0.579 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9921383857727051
Epoch: 43, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9667391777038574
Epoch: 44, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.606 Vali Acc: 0.809 Test Loss: 0.606 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.996835470199585
Epoch: 45, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.654 Vali Acc: 0.789 Test Loss: 0.654 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8092105263157895
model parameter : 409052
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2167718410491943
Epoch: 1, Steps: 10 | Train Loss: 1.544 Vali Loss: 1.517 Vali Acc: 0.164 Test Loss: 1.517 Test Acc: 0.164
Validation loss decreased (inf --> -0.164459).  Saving model ...
Epoch: 2 cost time: 1.1800827980041504
Epoch: 2, Steps: 10 | Train Loss: 1.507 Vali Loss: 1.472 Vali Acc: 0.164 Test Loss: 1.472 Test Acc: 0.164
Validation loss decreased (-0.164459 --> -0.164459).  Saving model ...
Epoch: 3 cost time: 1.0066475868225098
Epoch: 3, Steps: 10 | Train Loss: 1.410 Vali Loss: 1.431 Vali Acc: 0.243 Test Loss: 1.431 Test Acc: 0.243
Validation loss decreased (-0.164459 --> -0.243407).  Saving model ...
Epoch: 4 cost time: 1.6192693710327148
Epoch: 4, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.386 Vali Acc: 0.276 Test Loss: 1.386 Test Acc: 0.276
Validation loss decreased (-0.243407 --> -0.276302).  Saving model ...
Epoch: 5 cost time: 1.0260286331176758
Epoch: 5, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.335 Vali Acc: 0.375 Test Loss: 1.335 Test Acc: 0.375
Validation loss decreased (-0.276302 --> -0.374987).  Saving model ...
Epoch: 6 cost time: 0.9970235824584961
Epoch: 6, Steps: 10 | Train Loss: 1.200 Vali Loss: 1.263 Vali Acc: 0.480 Test Loss: 1.263 Test Acc: 0.480
Validation loss decreased (-0.374987 --> -0.480251).  Saving model ...
Epoch: 7 cost time: 1.2687807083129883
Epoch: 7, Steps: 10 | Train Loss: 1.128 Vali Loss: 1.210 Vali Acc: 0.480 Test Loss: 1.210 Test Acc: 0.480
Validation loss decreased (-0.480251 --> -0.480251).  Saving model ...
Epoch: 8 cost time: 1.3745687007904053
Epoch: 8, Steps: 10 | Train Loss: 1.047 Vali Loss: 1.153 Vali Acc: 0.559 Test Loss: 1.153 Test Acc: 0.559
Validation loss decreased (-0.480251 --> -0.559199).  Saving model ...
Epoch: 9 cost time: 0.9407541751861572
Epoch: 9, Steps: 10 | Train Loss: 0.932 Vali Loss: 1.065 Vali Acc: 0.586 Test Loss: 1.065 Test Acc: 0.586
Validation loss decreased (-0.559199 --> -0.585516).  Saving model ...
Epoch: 10 cost time: 1.0242652893066406
Epoch: 10, Steps: 10 | Train Loss: 0.867 Vali Loss: 1.002 Vali Acc: 0.572 Test Loss: 1.002 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2604022026062012
Epoch: 11, Steps: 10 | Train Loss: 0.762 Vali Loss: 0.927 Vali Acc: 0.691 Test Loss: 0.927 Test Acc: 0.691
Validation loss decreased (-0.585516 --> -0.690780).  Saving model ...
Epoch: 12 cost time: 1.1201038360595703
Epoch: 12, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.852 Vali Acc: 0.678 Test Loss: 0.852 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0291519165039062
Epoch: 13, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.773 Vali Acc: 0.730 Test Loss: 0.773 Test Acc: 0.730
Validation loss decreased (-0.690780 --> -0.730255).  Saving model ...
Epoch: 14 cost time: 1.3322803974151611
Epoch: 14, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.720 Vali Acc: 0.737 Test Loss: 0.720 Test Acc: 0.737
Validation loss decreased (-0.730255 --> -0.736835).  Saving model ...
Epoch: 15 cost time: 1.1333303451538086
Epoch: 15, Steps: 10 | Train Loss: 0.475 Vali Loss: 0.658 Vali Acc: 0.757 Test Loss: 0.658 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 16 cost time: 1.3209376335144043
Epoch: 16, Steps: 10 | Train Loss: 0.382 Vali Loss: 0.625 Vali Acc: 0.750 Test Loss: 0.625 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0387446880340576
Epoch: 17, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
Validation loss decreased (-0.756572 --> -0.782889).  Saving model ...
Epoch: 18 cost time: 1.1640076637268066
Epoch: 18, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.544 Vali Acc: 0.789 Test Loss: 0.544 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.1442570686340332
Epoch: 19, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.525 Vali Acc: 0.770 Test Loss: 0.525 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3355391025543213
Epoch: 20, Steps: 10 | Train Loss: 0.212 Vali Loss: 0.504 Vali Acc: 0.770 Test Loss: 0.504 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2874565124511719
Epoch: 21, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.509 Vali Acc: 0.763 Test Loss: 0.509 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4346797466278076
Epoch: 22, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.487506628036499
Epoch: 23, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.496 Vali Acc: 0.770 Test Loss: 0.496 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1906461715698242
Epoch: 24, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.479 Vali Acc: 0.789 Test Loss: 0.479 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 25 cost time: 1.0625510215759277
Epoch: 25, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.474 Vali Acc: 0.783 Test Loss: 0.474 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2807064056396484
Epoch: 26, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.470 Vali Acc: 0.776 Test Loss: 0.470 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1207401752471924
Epoch: 27, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.487 Vali Acc: 0.776 Test Loss: 0.487 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0069351196289062
Epoch: 28, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.472 Vali Acc: 0.776 Test Loss: 0.472 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2246694564819336
Epoch: 29, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.481 Vali Acc: 0.776 Test Loss: 0.481 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.3207895755767822
Epoch: 30, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.501 Vali Acc: 0.770 Test Loss: 0.501 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.490182638168335
Epoch: 31, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.210557460784912
Epoch: 32, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.502 Vali Acc: 0.783 Test Loss: 0.502 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0714869499206543
Epoch: 33, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.524 Vali Acc: 0.783 Test Loss: 0.524 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.2483515739440918
Epoch: 34, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.531 Vali Acc: 0.776 Test Loss: 0.531 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 408860
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1507842540740967
Epoch: 1, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.438 Vali Acc: 0.230 Test Loss: 1.438 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.051605224609375
Epoch: 2, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.403 Vali Acc: 0.263 Test Loss: 1.403 Test Acc: 0.263
Validation loss decreased (-0.230249 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 1.1701867580413818
Epoch: 3, Steps: 10 | Train Loss: 1.379 Vali Loss: 1.364 Vali Acc: 0.309 Test Loss: 1.364 Test Acc: 0.309
Validation loss decreased (-0.263144 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 0.9972023963928223
Epoch: 4, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.316 Vali Acc: 0.414 Test Loss: 1.316 Test Acc: 0.414
Validation loss decreased (-0.309197 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 1.0268714427947998
Epoch: 5, Steps: 10 | Train Loss: 1.217 Vali Loss: 1.255 Vali Acc: 0.474 Test Loss: 1.255 Test Acc: 0.474
Validation loss decreased (-0.414461 --> -0.473672).  Saving model ...
Epoch: 6 cost time: 1.0071828365325928
Epoch: 6, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.192 Vali Acc: 0.553 Test Loss: 1.192 Test Acc: 0.553
Validation loss decreased (-0.473672 --> -0.552620).  Saving model ...
Epoch: 7 cost time: 1.3156607151031494
Epoch: 7, Steps: 10 | Train Loss: 1.085 Vali Loss: 1.150 Vali Acc: 0.592 Test Loss: 1.150 Test Acc: 0.592
Validation loss decreased (-0.552620 --> -0.592094).  Saving model ...
Epoch: 8 cost time: 0.8590455055236816
Epoch: 8, Steps: 10 | Train Loss: 0.995 Vali Loss: 1.072 Vali Acc: 0.645 Test Loss: 1.072 Test Acc: 0.645
Validation loss decreased (-0.592094 --> -0.644726).  Saving model ...
Epoch: 9 cost time: 1.0073776245117188
Epoch: 9, Steps: 10 | Train Loss: 0.915 Vali Loss: 1.010 Vali Acc: 0.651 Test Loss: 1.010 Test Acc: 0.651
Validation loss decreased (-0.644726 --> -0.651306).  Saving model ...
Epoch: 10 cost time: 1.2623441219329834
Epoch: 10, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.934 Vali Acc: 0.671 Test Loss: 0.934 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671043).  Saving model ...
Epoch: 11 cost time: 1.119373083114624
Epoch: 11, Steps: 10 | Train Loss: 0.724 Vali Loss: 0.862 Vali Acc: 0.658 Test Loss: 0.862 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0668179988861084
Epoch: 12, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.799 Vali Acc: 0.684 Test Loss: 0.799 Test Acc: 0.684
Validation loss decreased (-0.671043 --> -0.684203).  Saving model ...
Epoch: 13 cost time: 0.9909844398498535
Epoch: 13, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.725 Vali Acc: 0.704 Test Loss: 0.725 Test Acc: 0.704
Validation loss decreased (-0.684203 --> -0.703940).  Saving model ...
Epoch: 14 cost time: 1.1429474353790283
Epoch: 14, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.673 Vali Acc: 0.730 Test Loss: 0.673 Test Acc: 0.730
Validation loss decreased (-0.703940 --> -0.730256).  Saving model ...
Epoch: 15 cost time: 0.9485571384429932
Epoch: 15, Steps: 10 | Train Loss: 0.392 Vali Loss: 0.626 Vali Acc: 0.776 Test Loss: 0.626 Test Acc: 0.776
Validation loss decreased (-0.730256 --> -0.776310).  Saving model ...
Epoch: 16 cost time: 0.8046650886535645
Epoch: 16, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.582 Vali Acc: 0.770 Test Loss: 0.582 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2501699924468994
Epoch: 17, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.555 Vali Acc: 0.770 Test Loss: 0.555 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.449310302734375
Epoch: 18, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.525 Vali Acc: 0.789 Test Loss: 0.525 Test Acc: 0.789
Validation loss decreased (-0.776310 --> -0.789468).  Saving model ...
Epoch: 19 cost time: 1.1184613704681396
Epoch: 19, Steps: 10 | Train Loss: 0.249 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2368760108947754
Epoch: 20, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1449897289276123
Epoch: 21, Steps: 10 | Train Loss: 0.162 Vali Loss: 0.489 Vali Acc: 0.783 Test Loss: 0.489 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2914047241210938
Epoch: 22, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.486 Vali Acc: 0.796 Test Loss: 0.486 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 23 cost time: 1.115574836730957
Epoch: 23, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.487 Vali Acc: 0.783 Test Loss: 0.487 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9635136127471924
Epoch: 24, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.489 Vali Acc: 0.783 Test Loss: 0.489 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2055766582489014
Epoch: 25, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.487 Vali Acc: 0.796 Test Loss: 0.487 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1099467277526855
Epoch: 26, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.503 Vali Acc: 0.803 Test Loss: 0.503 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 27 cost time: 1.4860548973083496
Epoch: 27, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.490 Vali Acc: 0.783 Test Loss: 0.490 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2994029521942139
Epoch: 28, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1327674388885498
Epoch: 29, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.504 Vali Acc: 0.789 Test Loss: 0.504 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9271087646484375
Epoch: 30, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1151466369628906
Epoch: 31, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.542 Vali Acc: 0.803 Test Loss: 0.542 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9531633853912354
Epoch: 32, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.551 Vali Acc: 0.776 Test Loss: 0.551 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.061692237854004
Epoch: 33, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.570 Vali Acc: 0.789 Test Loss: 0.570 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.3559682369232178
Epoch: 34, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.581 Vali Acc: 0.776 Test Loss: 0.581 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1351184844970703
Epoch: 35, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.591 Vali Acc: 0.789 Test Loss: 0.591 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1047446727752686
Epoch: 36, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.601 Vali Acc: 0.789 Test Loss: 0.601 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 408668
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.049379348754883
Epoch: 1, Steps: 10 | Train Loss: 1.480 Vali Loss: 1.416 Vali Acc: 0.270 Test Loss: 1.416 Test Acc: 0.270
Validation loss decreased (inf --> -0.269723).  Saving model ...
Epoch: 2 cost time: 0.9390637874603271
Epoch: 2, Steps: 10 | Train Loss: 1.417 Vali Loss: 1.381 Vali Acc: 0.257 Test Loss: 1.381 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9581038951873779
Epoch: 3, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.354 Vali Acc: 0.349 Test Loss: 1.354 Test Acc: 0.349
Validation loss decreased (-0.269723 --> -0.348671).  Saving model ...
Epoch: 4 cost time: 0.8819942474365234
Epoch: 4, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.309 Vali Acc: 0.362 Test Loss: 1.309 Test Acc: 0.362
Validation loss decreased (-0.348671 --> -0.361829).  Saving model ...
Epoch: 5 cost time: 0.9827134609222412
Epoch: 5, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.272 Vali Acc: 0.487 Test Loss: 1.272 Test Acc: 0.487
Validation loss decreased (-0.361829 --> -0.486829).  Saving model ...
Epoch: 6 cost time: 0.9442102909088135
Epoch: 6, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.223 Vali Acc: 0.474 Test Loss: 1.223 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.139948844909668
Epoch: 7, Steps: 10 | Train Loss: 1.113 Vali Loss: 1.168 Vali Acc: 0.513 Test Loss: 1.168 Test Acc: 0.513
Validation loss decreased (-0.486829 --> -0.513146).  Saving model ...
Epoch: 8 cost time: 1.0953857898712158
Epoch: 8, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.118 Vali Acc: 0.572 Test Loss: 1.118 Test Acc: 0.572
Validation loss decreased (-0.513146 --> -0.572357).  Saving model ...
Epoch: 9 cost time: 0.9676668643951416
Epoch: 9, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.076 Vali Acc: 0.618 Test Loss: 1.076 Test Acc: 0.618
Validation loss decreased (-0.572357 --> -0.618410).  Saving model ...
Epoch: 10 cost time: 0.8837018013000488
Epoch: 10, Steps: 10 | Train Loss: 0.901 Vali Loss: 1.013 Vali Acc: 0.651 Test Loss: 1.013 Test Acc: 0.651
Validation loss decreased (-0.618410 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 0.8689494132995605
Epoch: 11, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.955 Vali Acc: 0.671 Test Loss: 0.955 Test Acc: 0.671
Validation loss decreased (-0.651306 --> -0.671043).  Saving model ...
Epoch: 12 cost time: 1.0552423000335693
Epoch: 12, Steps: 10 | Train Loss: 0.730 Vali Loss: 0.892 Vali Acc: 0.671 Test Loss: 0.892 Test Acc: 0.671
Validation loss decreased (-0.671043 --> -0.671044).  Saving model ...
Epoch: 13 cost time: 1.1360194683074951
Epoch: 13, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.829 Vali Acc: 0.724 Test Loss: 0.829 Test Acc: 0.724
Validation loss decreased (-0.671044 --> -0.723676).  Saving model ...
Epoch: 14 cost time: 1.020810604095459
Epoch: 14, Steps: 10 | Train Loss: 0.602 Vali Loss: 0.779 Vali Acc: 0.678 Test Loss: 0.779 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1842682361602783
Epoch: 15, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.724 Vali Acc: 0.730 Test Loss: 0.724 Test Acc: 0.730
Validation loss decreased (-0.723676 --> -0.730256).  Saving model ...
Epoch: 16 cost time: 1.0468919277191162
Epoch: 16, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.683 Vali Acc: 0.704 Test Loss: 0.683 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.265305995941162
Epoch: 17, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.646 Vali Acc: 0.743 Test Loss: 0.646 Test Acc: 0.743
Validation loss decreased (-0.730256 --> -0.743415).  Saving model ...
Epoch: 18 cost time: 0.9654440879821777
Epoch: 18, Steps: 10 | Train Loss: 0.352 Vali Loss: 0.599 Vali Acc: 0.750 Test Loss: 0.599 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 19 cost time: 0.9855403900146484
Epoch: 19, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.564 Vali Acc: 0.783 Test Loss: 0.564 Test Acc: 0.783
Validation loss decreased (-0.749994 --> -0.782889).  Saving model ...
Epoch: 20 cost time: 0.8143496513366699
Epoch: 20, Steps: 10 | Train Loss: 0.278 Vali Loss: 0.562 Vali Acc: 0.737 Test Loss: 0.562 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0613555908203125
Epoch: 21, Steps: 10 | Train Loss: 0.243 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0200636386871338
Epoch: 22, Steps: 10 | Train Loss: 0.232 Vali Loss: 0.532 Vali Acc: 0.763 Test Loss: 0.532 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9729321002960205
Epoch: 23, Steps: 10 | Train Loss: 0.202 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 24 cost time: 1.2456996440887451
Epoch: 24, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0969657897949219
Epoch: 25, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.499 Vali Acc: 0.776 Test Loss: 0.499 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.1977753639221191
Epoch: 26, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.491 Vali Acc: 0.789 Test Loss: 0.491 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 27 cost time: 1.2785780429840088
Epoch: 27, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.507 Vali Acc: 0.763 Test Loss: 0.507 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2209622859954834
Epoch: 28, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 29 cost time: 1.147603988647461
Epoch: 29, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.524 Vali Acc: 0.763 Test Loss: 0.524 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.019352674484253
Epoch: 30, Steps: 10 | Train Loss: 0.084 Vali Loss: 0.496 Vali Acc: 0.803 Test Loss: 0.496 Test Acc: 0.803
Validation loss decreased (-0.789469 --> -0.802627).  Saving model ...
Epoch: 31 cost time: 1.2786707878112793
Epoch: 31, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3285462856292725
Epoch: 32, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.170377254486084
Epoch: 33, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.536 Vali Acc: 0.776 Test Loss: 0.536 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.2959721088409424
Epoch: 34, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.529 Vali Acc: 0.789 Test Loss: 0.529 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.2033357620239258
Epoch: 35, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.2055549621582031
Epoch: 36, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.547 Vali Acc: 0.783 Test Loss: 0.547 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9886908531188965
Epoch: 37, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.3056683540344238
Epoch: 38, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.587 Vali Acc: 0.783 Test Loss: 0.587 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.2965266704559326
Epoch: 39, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.611 Vali Acc: 0.789 Test Loss: 0.611 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.3719232082366943
Epoch: 40, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.610 Vali Acc: 0.789 Test Loss: 0.610 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 310172
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.901376724243164
Epoch: 1, Steps: 10 | Train Loss: 1.453 Vali Loss: 1.363 Vali Acc: 0.309 Test Loss: 1.363 Test Acc: 0.309
Validation loss decreased (inf --> -0.309197).  Saving model ...
Epoch: 2 cost time: 1.1566078662872314
Epoch: 2, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.327 Vali Acc: 0.349 Test Loss: 1.327 Test Acc: 0.349
Validation loss decreased (-0.309197 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 1.115889072418213
Epoch: 3, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.301 Vali Acc: 0.375 Test Loss: 1.301 Test Acc: 0.375
Validation loss decreased (-0.348671 --> -0.374987).  Saving model ...
Epoch: 4 cost time: 0.9699184894561768
Epoch: 4, Steps: 10 | Train Loss: 1.273 Vali Loss: 1.254 Vali Acc: 0.467 Test Loss: 1.254 Test Acc: 0.467
Validation loss decreased (-0.374987 --> -0.467093).  Saving model ...
Epoch: 5 cost time: 0.9850196838378906
Epoch: 5, Steps: 10 | Train Loss: 1.211 Vali Loss: 1.213 Vali Acc: 0.539 Test Loss: 1.213 Test Acc: 0.539
Validation loss decreased (-0.467093 --> -0.539462).  Saving model ...
Epoch: 6 cost time: 0.9757375717163086
Epoch: 6, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.173 Vali Acc: 0.500 Test Loss: 1.173 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0194199085235596
Epoch: 7, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.118 Vali Acc: 0.566 Test Loss: 1.118 Test Acc: 0.566
Validation loss decreased (-0.539462 --> -0.565778).  Saving model ...
Epoch: 8 cost time: 1.0937080383300781
Epoch: 8, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.068 Vali Acc: 0.612 Test Loss: 1.068 Test Acc: 0.612
Validation loss decreased (-0.565778 --> -0.611831).  Saving model ...
Epoch: 9 cost time: 0.9731776714324951
Epoch: 9, Steps: 10 | Train Loss: 0.939 Vali Loss: 1.018 Vali Acc: 0.599 Test Loss: 1.018 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2095832824707031
Epoch: 10, Steps: 10 | Train Loss: 0.855 Vali Loss: 0.964 Vali Acc: 0.632 Test Loss: 0.964 Test Acc: 0.632
Validation loss decreased (-0.611831 --> -0.631569).  Saving model ...
Epoch: 11 cost time: 1.2232666015625
Epoch: 11, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.914 Vali Acc: 0.625 Test Loss: 0.914 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9696240425109863
Epoch: 12, Steps: 10 | Train Loss: 0.687 Vali Loss: 0.854 Vali Acc: 0.651 Test Loss: 0.854 Test Acc: 0.651
Validation loss decreased (-0.631569 --> -0.651307).  Saving model ...
Epoch: 13 cost time: 1.1144788265228271
Epoch: 13, Steps: 10 | Train Loss: 0.615 Vali Loss: 0.793 Vali Acc: 0.697 Test Loss: 0.793 Test Acc: 0.697
Validation loss decreased (-0.651307 --> -0.697360).  Saving model ...
Epoch: 14 cost time: 1.2485482692718506
Epoch: 14, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.757 Vali Acc: 0.711 Test Loss: 0.757 Test Acc: 0.711
Validation loss decreased (-0.697360 --> -0.710519).  Saving model ...
Epoch: 15 cost time: 1.235767126083374
Epoch: 15, Steps: 10 | Train Loss: 0.487 Vali Loss: 0.705 Vali Acc: 0.711 Test Loss: 0.705 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 16 cost time: 1.3773062229156494
Epoch: 16, Steps: 10 | Train Loss: 0.432 Vali Loss: 0.662 Vali Acc: 0.724 Test Loss: 0.662 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723678).  Saving model ...
Epoch: 17 cost time: 1.089796543121338
Epoch: 17, Steps: 10 | Train Loss: 0.358 Vali Loss: 0.623 Vali Acc: 0.750 Test Loss: 0.623 Test Acc: 0.750
Validation loss decreased (-0.723678 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 1.220052719116211
Epoch: 18, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.586 Vali Acc: 0.770 Test Loss: 0.586 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 19 cost time: 1.0351030826568604
Epoch: 19, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.562 Vali Acc: 0.783 Test Loss: 0.562 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 20 cost time: 1.063063144683838
Epoch: 20, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.547 Vali Acc: 0.789 Test Loss: 0.547 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 0.9164223670959473
Epoch: 21, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.525 Vali Acc: 0.783 Test Loss: 0.525 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0890653133392334
Epoch: 22, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3504879474639893
Epoch: 23, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.506 Vali Acc: 0.776 Test Loss: 0.506 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2287330627441406
Epoch: 24, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.111654281616211
Epoch: 25, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0931024551391602
Epoch: 26, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789468).  Saving model ...
Epoch: 27 cost time: 1.0712480545043945
Epoch: 27, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.514 Vali Acc: 0.789 Test Loss: 0.514 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 28 cost time: 1.1920719146728516
Epoch: 28, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.527 Vali Acc: 0.796 Test Loss: 0.527 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796047).  Saving model ...
Epoch: 29 cost time: 1.0631728172302246
Epoch: 29, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.535 Vali Acc: 0.796 Test Loss: 0.535 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.2276098728179932
Epoch: 30, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.555 Vali Acc: 0.816 Test Loss: 0.555 Test Acc: 0.816
Validation loss decreased (-0.796047 --> -0.815784).  Saving model ...
Epoch: 31 cost time: 1.0649960041046143
Epoch: 31, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.569 Vali Acc: 0.796 Test Loss: 0.569 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.3087213039398193
Epoch: 32, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.579 Vali Acc: 0.822 Test Loss: 0.579 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 33 cost time: 1.165543794631958
Epoch: 33, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8795950412750244
Epoch: 34, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.615 Vali Acc: 0.809 Test Loss: 0.615 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1500623226165771
Epoch: 35, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.637 Vali Acc: 0.796 Test Loss: 0.637 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0671277046203613
Epoch: 36, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.644 Vali Acc: 0.796 Test Loss: 0.644 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1068172454833984
Epoch: 37, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.2920150756835938
Epoch: 38, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.656 Vali Acc: 0.796 Test Loss: 0.656 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.1860015392303467
Epoch: 39, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.675 Vali Acc: 0.796 Test Loss: 0.675 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1552813053131104
Epoch: 40, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.700 Vali Acc: 0.789 Test Loss: 0.700 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.3628551959991455
Epoch: 41, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.707 Vali Acc: 0.783 Test Loss: 0.707 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1070830821990967
Epoch: 42, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.726 Vali Acc: 0.789 Test Loss: 0.726 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 309980
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.6385140419006348
Epoch: 1, Steps: 10 | Train Loss: 1.444 Vali Loss: 1.412 Vali Acc: 0.171 Test Loss: 1.412 Test Acc: 0.171
Validation loss decreased (inf --> -0.171039).  Saving model ...
Epoch: 2 cost time: 0.9816629886627197
Epoch: 2, Steps: 10 | Train Loss: 1.398 Vali Loss: 1.394 Vali Acc: 0.303 Test Loss: 1.394 Test Acc: 0.303
Validation loss decreased (-0.171039 --> -0.302618).  Saving model ...
Epoch: 3 cost time: 0.8771297931671143
Epoch: 3, Steps: 10 | Train Loss: 1.365 Vali Loss: 1.353 Vali Acc: 0.355 Test Loss: 1.353 Test Acc: 0.355
Validation loss decreased (-0.302618 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 1.1668906211853027
Epoch: 4, Steps: 10 | Train Loss: 1.320 Vali Loss: 1.310 Vali Acc: 0.414 Test Loss: 1.310 Test Acc: 0.414
Validation loss decreased (-0.355250 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 1.2170846462249756
Epoch: 5, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.266 Vali Acc: 0.454 Test Loss: 1.266 Test Acc: 0.454
Validation loss decreased (-0.414461 --> -0.453935).  Saving model ...
Epoch: 6 cost time: 0.9641246795654297
Epoch: 6, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.204 Vali Acc: 0.539 Test Loss: 1.204 Test Acc: 0.539
Validation loss decreased (-0.453935 --> -0.539462).  Saving model ...
Epoch: 7 cost time: 1.0763325691223145
Epoch: 7, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.147 Vali Acc: 0.599 Test Loss: 1.147 Test Acc: 0.599
Validation loss decreased (-0.539462 --> -0.598673).  Saving model ...
Epoch: 8 cost time: 1.2075457572937012
Epoch: 8, Steps: 10 | Train Loss: 1.016 Vali Loss: 1.090 Vali Acc: 0.632 Test Loss: 1.090 Test Acc: 0.632
Validation loss decreased (-0.598673 --> -0.631568).  Saving model ...
Epoch: 9 cost time: 0.9599683284759521
Epoch: 9, Steps: 10 | Train Loss: 0.937 Vali Loss: 1.030 Vali Acc: 0.625 Test Loss: 1.030 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1365783214569092
Epoch: 10, Steps: 10 | Train Loss: 0.864 Vali Loss: 0.975 Vali Acc: 0.664 Test Loss: 0.975 Test Acc: 0.664
Validation loss decreased (-0.631568 --> -0.664464).  Saving model ...
Epoch: 11 cost time: 1.0367729663848877
Epoch: 11, Steps: 10 | Train Loss: 0.779 Vali Loss: 0.917 Vali Acc: 0.658 Test Loss: 0.917 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.269963264465332
Epoch: 12, Steps: 10 | Train Loss: 0.719 Vali Loss: 0.855 Vali Acc: 0.704 Test Loss: 0.855 Test Acc: 0.704
Validation loss decreased (-0.664464 --> -0.703939).  Saving model ...
Epoch: 13 cost time: 1.091742753982544
Epoch: 13, Steps: 10 | Train Loss: 0.607 Vali Loss: 0.796 Vali Acc: 0.717 Test Loss: 0.796 Test Acc: 0.717
Validation loss decreased (-0.703939 --> -0.717097).  Saving model ...
Epoch: 14 cost time: 1.033071756362915
Epoch: 14, Steps: 10 | Train Loss: 0.530 Vali Loss: 0.730 Vali Acc: 0.737 Test Loss: 0.730 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736835).  Saving model ...
Epoch: 15 cost time: 1.1673173904418945
Epoch: 15, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.687 Vali Acc: 0.763 Test Loss: 0.687 Test Acc: 0.763
Validation loss decreased (-0.736835 --> -0.763151).  Saving model ...
Epoch: 16 cost time: 0.8966240882873535
Epoch: 16, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.630 Vali Acc: 0.763 Test Loss: 0.630 Test Acc: 0.763
Validation loss decreased (-0.763151 --> -0.763152).  Saving model ...
Epoch: 17 cost time: 0.9709122180938721
Epoch: 17, Steps: 10 | Train Loss: 0.369 Vali Loss: 0.592 Vali Acc: 0.776 Test Loss: 0.592 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 18 cost time: 0.9200749397277832
Epoch: 18, Steps: 10 | Train Loss: 0.318 Vali Loss: 0.559 Vali Acc: 0.776 Test Loss: 0.559 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 19 cost time: 1.0942301750183105
Epoch: 19, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.532 Vali Acc: 0.776 Test Loss: 0.532 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 1.0661981105804443
Epoch: 20, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
Validation loss decreased (-0.776310 --> -0.802626).  Saving model ...
Epoch: 21 cost time: 1.0498180389404297
Epoch: 21, Steps: 10 | Train Loss: 0.193 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1591289043426514
Epoch: 22, Steps: 10 | Train Loss: 0.176 Vali Loss: 0.490 Vali Acc: 0.776 Test Loss: 0.490 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0604500770568848
Epoch: 23, Steps: 10 | Train Loss: 0.171 Vali Loss: 0.483 Vali Acc: 0.757 Test Loss: 0.483 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.2118041515350342
Epoch: 24, Steps: 10 | Train Loss: 0.139 Vali Loss: 0.492 Vali Acc: 0.789 Test Loss: 0.492 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.056441307067871
Epoch: 25, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.487 Vali Acc: 0.770 Test Loss: 0.487 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1642494201660156
Epoch: 26, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1397411823272705
Epoch: 27, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.487 Vali Acc: 0.770 Test Loss: 0.487 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.309617042541504
Epoch: 28, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.499 Vali Acc: 0.789 Test Loss: 0.499 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.158402681350708
Epoch: 29, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.493 Vali Acc: 0.776 Test Loss: 0.493 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.0780303478240967
Epoch: 30, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.501 Vali Acc: 0.789 Test Loss: 0.501 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 309788
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.223358154296875
Epoch: 1, Steps: 10 | Train Loss: 1.434 Vali Loss: 1.388 Vali Acc: 0.329 Test Loss: 1.388 Test Acc: 0.329
Validation loss decreased (inf --> -0.328933).  Saving model ...
Epoch: 2 cost time: 1.1837284564971924
Epoch: 2, Steps: 10 | Train Loss: 1.397 Vali Loss: 1.357 Vali Acc: 0.296 Test Loss: 1.357 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1735079288482666
Epoch: 3, Steps: 10 | Train Loss: 1.360 Vali Loss: 1.324 Vali Acc: 0.336 Test Loss: 1.324 Test Acc: 0.336
Validation loss decreased (-0.328933 --> -0.335513).  Saving model ...
Epoch: 4 cost time: 0.9652214050292969
Epoch: 4, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.284 Vali Acc: 0.414 Test Loss: 1.284 Test Acc: 0.414
Validation loss decreased (-0.335513 --> -0.414461).  Saving model ...
Epoch: 5 cost time: 0.9155685901641846
Epoch: 5, Steps: 10 | Train Loss: 1.245 Vali Loss: 1.242 Vali Acc: 0.487 Test Loss: 1.242 Test Acc: 0.487
Validation loss decreased (-0.414461 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 1.0893607139587402
Epoch: 6, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.197 Vali Acc: 0.533 Test Loss: 1.197 Test Acc: 0.533
Validation loss decreased (-0.486830 --> -0.532883).  Saving model ...
Epoch: 7 cost time: 1.1844494342803955
Epoch: 7, Steps: 10 | Train Loss: 1.152 Vali Loss: 1.153 Vali Acc: 0.592 Test Loss: 1.153 Test Acc: 0.592
Validation loss decreased (-0.532883 --> -0.592094).  Saving model ...
Epoch: 8 cost time: 1.1505749225616455
Epoch: 8, Steps: 10 | Train Loss: 1.032 Vali Loss: 1.094 Vali Acc: 0.625 Test Loss: 1.094 Test Acc: 0.625
Validation loss decreased (-0.592094 --> -0.624989).  Saving model ...
Epoch: 9 cost time: 1.0888779163360596
Epoch: 9, Steps: 10 | Train Loss: 0.965 Vali Loss: 1.041 Vali Acc: 0.632 Test Loss: 1.041 Test Acc: 0.632
Validation loss decreased (-0.624989 --> -0.631569).  Saving model ...
Epoch: 10 cost time: 1.1172356605529785
Epoch: 10, Steps: 10 | Train Loss: 0.875 Vali Loss: 0.991 Vali Acc: 0.664 Test Loss: 0.991 Test Acc: 0.664
Validation loss decreased (-0.631569 --> -0.664464).  Saving model ...
Epoch: 11 cost time: 1.048755168914795
Epoch: 11, Steps: 10 | Train Loss: 0.825 Vali Loss: 0.923 Vali Acc: 0.664 Test Loss: 0.923 Test Acc: 0.664
Validation loss decreased (-0.664464 --> -0.664464).  Saving model ...
Epoch: 12 cost time: 1.145942211151123
Epoch: 12, Steps: 10 | Train Loss: 0.739 Vali Loss: 0.864 Vali Acc: 0.678 Test Loss: 0.864 Test Acc: 0.678
Validation loss decreased (-0.664464 --> -0.677623).  Saving model ...
Epoch: 13 cost time: 0.9965357780456543
Epoch: 13, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.803 Vali Acc: 0.704 Test Loss: 0.803 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703939).  Saving model ...
Epoch: 14 cost time: 0.9438591003417969
Epoch: 14, Steps: 10 | Train Loss: 0.577 Vali Loss: 0.748 Vali Acc: 0.737 Test Loss: 0.748 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 15 cost time: 1.035158395767212
Epoch: 15, Steps: 10 | Train Loss: 0.533 Vali Loss: 0.690 Vali Acc: 0.750 Test Loss: 0.690 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 1.4196245670318604
Epoch: 16, Steps: 10 | Train Loss: 0.485 Vali Loss: 0.652 Vali Acc: 0.743 Test Loss: 0.652 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0424723625183105
Epoch: 17, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.611 Vali Acc: 0.730 Test Loss: 0.611 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1407737731933594
Epoch: 18, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.575 Vali Acc: 0.763 Test Loss: 0.575 Test Acc: 0.763
Validation loss decreased (-0.749993 --> -0.763152).  Saving model ...
Epoch: 19 cost time: 0.9200327396392822
Epoch: 19, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 20 cost time: 1.2521028518676758
Epoch: 20, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.524 Vali Acc: 0.757 Test Loss: 0.524 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1755447387695312
Epoch: 21, Steps: 10 | Train Loss: 0.236 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
Validation loss decreased (-0.776310 --> -0.796048).  Saving model ...
Epoch: 22 cost time: 1.0481767654418945
Epoch: 22, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.486 Vali Acc: 0.770 Test Loss: 0.486 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2613580226898193
Epoch: 23, Steps: 10 | Train Loss: 0.174 Vali Loss: 0.481 Vali Acc: 0.809 Test Loss: 0.481 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809206).  Saving model ...
Epoch: 24 cost time: 1.2216558456420898
Epoch: 24, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.468 Vali Acc: 0.776 Test Loss: 0.468 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4798707962036133
Epoch: 25, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.473 Vali Acc: 0.816 Test Loss: 0.473 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 26 cost time: 1.6060540676116943
Epoch: 26, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.467 Vali Acc: 0.776 Test Loss: 0.467 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.20540189743042
Epoch: 27, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.463 Vali Acc: 0.796 Test Loss: 0.463 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1051311492919922
Epoch: 28, Steps: 10 | Train Loss: 0.087 Vali Loss: 0.475 Vali Acc: 0.796 Test Loss: 0.475 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.176645040512085
Epoch: 29, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.480 Vali Acc: 0.783 Test Loss: 0.480 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1527235507965088
Epoch: 30, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.488 Vali Acc: 0.816 Test Loss: 0.488 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.173943042755127
Epoch: 31, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.493 Vali Acc: 0.803 Test Loss: 0.493 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.386904001235962
Epoch: 32, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.516 Vali Acc: 0.809 Test Loss: 0.516 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2868976593017578
Epoch: 33, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.508 Vali Acc: 0.803 Test Loss: 0.508 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4499096870422363
Epoch: 34, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1127560138702393
Epoch: 35, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.523 Vali Acc: 0.796 Test Loss: 0.523 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8157894736842105
model parameter : 309596
model size : 2.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 4.10625958442688
Epoch: 1, Steps: 10 | Train Loss: 1.505 Vali Loss: 1.437 Vali Acc: 0.270 Test Loss: 1.437 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 1.2837913036346436
Epoch: 2, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.394 Vali Acc: 0.283 Test Loss: 1.394 Test Acc: 0.283
Validation loss decreased (-0.269722 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.05747389793396
Epoch: 3, Steps: 10 | Train Loss: 1.357 Vali Loss: 1.365 Vali Acc: 0.355 Test Loss: 1.365 Test Acc: 0.355
Validation loss decreased (-0.282881 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 1.0670809745788574
Epoch: 4, Steps: 10 | Train Loss: 1.364 Vali Loss: 1.324 Vali Acc: 0.428 Test Loss: 1.324 Test Acc: 0.428
Validation loss decreased (-0.355250 --> -0.427618).  Saving model ...
Epoch: 5 cost time: 1.0824334621429443
Epoch: 5, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.282 Vali Acc: 0.474 Test Loss: 1.282 Test Acc: 0.474
Validation loss decreased (-0.427618 --> -0.473671).  Saving model ...
Epoch: 6 cost time: 1.0465583801269531
Epoch: 6, Steps: 10 | Train Loss: 1.222 Vali Loss: 1.254 Vali Acc: 0.467 Test Loss: 1.254 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9879388809204102
Epoch: 7, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.185 Vali Acc: 0.579 Test Loss: 1.185 Test Acc: 0.579
Validation loss decreased (-0.473671 --> -0.578936).  Saving model ...
Epoch: 8 cost time: 0.9908084869384766
Epoch: 8, Steps: 10 | Train Loss: 1.095 Vali Loss: 1.149 Vali Acc: 0.586 Test Loss: 1.149 Test Acc: 0.586
Validation loss decreased (-0.578936 --> -0.585515).  Saving model ...
Epoch: 9 cost time: 1.158463478088379
Epoch: 9, Steps: 10 | Train Loss: 0.997 Vali Loss: 1.096 Vali Acc: 0.599 Test Loss: 1.096 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598673).  Saving model ...
Epoch: 10 cost time: 1.0600652694702148
Epoch: 10, Steps: 10 | Train Loss: 0.929 Vali Loss: 1.032 Vali Acc: 0.658 Test Loss: 1.032 Test Acc: 0.658
Validation loss decreased (-0.598673 --> -0.657884).  Saving model ...
Epoch: 11 cost time: 1.082956314086914
Epoch: 11, Steps: 10 | Train Loss: 0.862 Vali Loss: 0.986 Vali Acc: 0.599 Test Loss: 0.986 Test Acc: 0.599
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1596283912658691
Epoch: 12, Steps: 10 | Train Loss: 0.765 Vali Loss: 0.931 Vali Acc: 0.671 Test Loss: 0.931 Test Acc: 0.671
Validation loss decreased (-0.657884 --> -0.671043).  Saving model ...
Epoch: 13 cost time: 1.0035903453826904
Epoch: 13, Steps: 10 | Train Loss: 0.732 Vali Loss: 0.871 Vali Acc: 0.645 Test Loss: 0.871 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.088085412979126
Epoch: 14, Steps: 10 | Train Loss: 0.661 Vali Loss: 0.826 Vali Acc: 0.711 Test Loss: 0.826 Test Acc: 0.711
Validation loss decreased (-0.671043 --> -0.710518).  Saving model ...
Epoch: 15 cost time: 0.8860399723052979
Epoch: 15, Steps: 10 | Train Loss: 0.608 Vali Loss: 0.773 Vali Acc: 0.711 Test Loss: 0.773 Test Acc: 0.711
Validation loss decreased (-0.710518 --> -0.710519).  Saving model ...
Epoch: 16 cost time: 0.9350519180297852
Epoch: 16, Steps: 10 | Train Loss: 0.512 Vali Loss: 0.719 Vali Acc: 0.711 Test Loss: 0.719 Test Acc: 0.711
Validation loss decreased (-0.710519 --> -0.710519).  Saving model ...
Epoch: 17 cost time: 1.1486356258392334
Epoch: 17, Steps: 10 | Train Loss: 0.419 Vali Loss: 0.674 Vali Acc: 0.724 Test Loss: 0.674 Test Acc: 0.724
Validation loss decreased (-0.710519 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 1.247321367263794
Epoch: 18, Steps: 10 | Train Loss: 0.390 Vali Loss: 0.631 Vali Acc: 0.711 Test Loss: 0.631 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0690040588378906
Epoch: 19, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.594 Vali Acc: 0.743 Test Loss: 0.594 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743415).  Saving model ...
Epoch: 20 cost time: 0.9551107883453369
Epoch: 20, Steps: 10 | Train Loss: 0.319 Vali Loss: 0.567 Vali Acc: 0.770 Test Loss: 0.567 Test Acc: 0.770
Validation loss decreased (-0.743415 --> -0.769731).  Saving model ...
Epoch: 21 cost time: 1.0026733875274658
Epoch: 21, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.543 Vali Acc: 0.757 Test Loss: 0.543 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1644253730773926
Epoch: 22, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.524 Vali Acc: 0.789 Test Loss: 0.524 Test Acc: 0.789
Validation loss decreased (-0.769731 --> -0.789468).  Saving model ...
Epoch: 23 cost time: 0.9861776828765869
Epoch: 23, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.512 Vali Acc: 0.776 Test Loss: 0.512 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9872350692749023
Epoch: 24, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.511 Vali Acc: 0.770 Test Loss: 0.511 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2397291660308838
Epoch: 25, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.515 Vali Acc: 0.763 Test Loss: 0.515 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0761823654174805
Epoch: 26, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.495 Vali Acc: 0.783 Test Loss: 0.495 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9431829452514648
Epoch: 27, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.498 Vali Acc: 0.776 Test Loss: 0.498 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.1779344081878662
Epoch: 28, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.500 Vali Acc: 0.776 Test Loss: 0.500 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0820896625518799
Epoch: 29, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.492 Vali Acc: 0.776 Test Loss: 0.492 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0685229301452637
Epoch: 30, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1265394687652588
Epoch: 31, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.510 Vali Acc: 0.763 Test Loss: 0.510 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0728132724761963
Epoch: 32, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.528 Vali Acc: 0.763 Test Loss: 0.528 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 260636
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1729917526245117
Epoch: 1, Steps: 10 | Train Loss: 1.435 Vali Loss: 1.430 Vali Acc: 0.250 Test Loss: 1.430 Test Acc: 0.250
Validation loss decreased (inf --> -0.249986).  Saving model ...
Epoch: 2 cost time: 1.1473493576049805
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.405 Vali Acc: 0.230 Test Loss: 1.405 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4032447338104248
Epoch: 3, Steps: 10 | Train Loss: 1.346 Vali Loss: 1.370 Vali Acc: 0.263 Test Loss: 1.370 Test Acc: 0.263
Validation loss decreased (-0.249986 --> -0.263144).  Saving model ...
Epoch: 4 cost time: 1.2128734588623047
Epoch: 4, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.325 Vali Acc: 0.336 Test Loss: 1.325 Test Acc: 0.336
Validation loss decreased (-0.263144 --> -0.335513).  Saving model ...
Epoch: 5 cost time: 1.4070329666137695
Epoch: 5, Steps: 10 | Train Loss: 1.270 Vali Loss: 1.286 Vali Acc: 0.447 Test Loss: 1.286 Test Acc: 0.447
Validation loss decreased (-0.335513 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 0.8967394828796387
Epoch: 6, Steps: 10 | Train Loss: 1.164 Vali Loss: 1.231 Vali Acc: 0.553 Test Loss: 1.231 Test Acc: 0.553
Validation loss decreased (-0.447356 --> -0.552619).  Saving model ...
Epoch: 7 cost time: 1.3967278003692627
Epoch: 7, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.184 Vali Acc: 0.546 Test Loss: 1.184 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2477681636810303
Epoch: 8, Steps: 10 | Train Loss: 1.043 Vali Loss: 1.125 Vali Acc: 0.638 Test Loss: 1.125 Test Acc: 0.638
Validation loss decreased (-0.552619 --> -0.638147).  Saving model ...
Epoch: 9 cost time: 1.1869375705718994
Epoch: 9, Steps: 10 | Train Loss: 0.976 Vali Loss: 1.065 Vali Acc: 0.671 Test Loss: 1.065 Test Acc: 0.671
Validation loss decreased (-0.638147 --> -0.671042).  Saving model ...
Epoch: 10 cost time: 1.2298550605773926
Epoch: 10, Steps: 10 | Train Loss: 0.909 Vali Loss: 1.020 Vali Acc: 0.671 Test Loss: 1.020 Test Acc: 0.671
Validation loss decreased (-0.671042 --> -0.671042).  Saving model ...
Epoch: 11 cost time: 0.912255048751831
Epoch: 11, Steps: 10 | Train Loss: 0.819 Vali Loss: 0.947 Vali Acc: 0.678 Test Loss: 0.947 Test Acc: 0.678
Validation loss decreased (-0.671042 --> -0.677622).  Saving model ...
Epoch: 12 cost time: 0.9648137092590332
Epoch: 12, Steps: 10 | Train Loss: 0.745 Vali Loss: 0.897 Vali Acc: 0.671 Test Loss: 0.897 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.194697618484497
Epoch: 13, Steps: 10 | Train Loss: 0.689 Vali Loss: 0.820 Vali Acc: 0.717 Test Loss: 0.820 Test Acc: 0.717
Validation loss decreased (-0.677622 --> -0.717097).  Saving model ...
Epoch: 14 cost time: 0.8857073783874512
Epoch: 14, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.764 Vali Acc: 0.737 Test Loss: 0.764 Test Acc: 0.737
Validation loss decreased (-0.717097 --> -0.736834).  Saving model ...
Epoch: 15 cost time: 1.1404063701629639
Epoch: 15, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.716 Vali Acc: 0.750 Test Loss: 0.716 Test Acc: 0.750
Validation loss decreased (-0.736834 --> -0.749993).  Saving model ...
Epoch: 16 cost time: 1.0086026191711426
Epoch: 16, Steps: 10 | Train Loss: 0.458 Vali Loss: 0.659 Vali Acc: 0.776 Test Loss: 0.659 Test Acc: 0.776
Validation loss decreased (-0.749993 --> -0.776309).  Saving model ...
Epoch: 17 cost time: 0.96183180809021
Epoch: 17, Steps: 10 | Train Loss: 0.411 Vali Loss: 0.624 Vali Acc: 0.757 Test Loss: 0.624 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1299223899841309
Epoch: 18, Steps: 10 | Train Loss: 0.385 Vali Loss: 0.588 Vali Acc: 0.783 Test Loss: 0.588 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782889).  Saving model ...
Epoch: 19 cost time: 0.9739203453063965
Epoch: 19, Steps: 10 | Train Loss: 0.308 Vali Loss: 0.564 Vali Acc: 0.763 Test Loss: 0.564 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4761738777160645
Epoch: 20, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.539 Vali Acc: 0.789 Test Loss: 0.539 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 1.097872018814087
Epoch: 21, Steps: 10 | Train Loss: 0.268 Vali Loss: 0.519 Vali Acc: 0.770 Test Loss: 0.519 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2563109397888184
Epoch: 22, Steps: 10 | Train Loss: 0.237 Vali Loss: 0.509 Vali Acc: 0.783 Test Loss: 0.509 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1612412929534912
Epoch: 23, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.492 Vali Acc: 0.776 Test Loss: 0.492 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3712258338928223
Epoch: 24, Steps: 10 | Train Loss: 0.182 Vali Loss: 0.499 Vali Acc: 0.770 Test Loss: 0.499 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0990872383117676
Epoch: 25, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.479 Vali Acc: 0.783 Test Loss: 0.479 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1932590007781982
Epoch: 26, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.492 Vali Acc: 0.776 Test Loss: 0.492 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2448530197143555
Epoch: 27, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.467 Vali Acc: 0.796 Test Loss: 0.467 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 28 cost time: 1.0199944972991943
Epoch: 28, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.476 Vali Acc: 0.789 Test Loss: 0.476 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9908468723297119
Epoch: 29, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9979336261749268
Epoch: 30, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.490 Vali Acc: 0.796 Test Loss: 0.490 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0127356052398682
Epoch: 31, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.483 Vali Acc: 0.796 Test Loss: 0.483 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.2110116481781006
Epoch: 32, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.484 Vali Acc: 0.783 Test Loss: 0.484 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.468780279159546
Epoch: 33, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.1076719760894775
Epoch: 34, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.506 Vali Acc: 0.783 Test Loss: 0.506 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0523598194122314
Epoch: 35, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.043097734451294
Epoch: 36, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.532 Vali Acc: 0.789 Test Loss: 0.532 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9922323226928711
Epoch: 37, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.526 Vali Acc: 0.789 Test Loss: 0.526 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 260444
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2888975143432617
Epoch: 1, Steps: 10 | Train Loss: 1.487 Vali Loss: 1.452 Vali Acc: 0.217 Test Loss: 1.452 Test Acc: 0.217
Validation loss decreased (inf --> -0.217091).  Saving model ...
Epoch: 2 cost time: 1.0172162055969238
Epoch: 2, Steps: 10 | Train Loss: 1.449 Vali Loss: 1.427 Vali Acc: 0.204 Test Loss: 1.427 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1151506900787354
Epoch: 3, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.392 Vali Acc: 0.237 Test Loss: 1.392 Test Acc: 0.237
Validation loss decreased (-0.217091 --> -0.236828).  Saving model ...
Epoch: 4 cost time: 0.9640142917633057
Epoch: 4, Steps: 10 | Train Loss: 1.366 Vali Loss: 1.349 Vali Acc: 0.329 Test Loss: 1.349 Test Acc: 0.329
Validation loss decreased (-0.236828 --> -0.328934).  Saving model ...
Epoch: 5 cost time: 0.9969527721405029
Epoch: 5, Steps: 10 | Train Loss: 1.301 Vali Loss: 1.315 Vali Acc: 0.362 Test Loss: 1.315 Test Acc: 0.362
Validation loss decreased (-0.328934 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 1.3847410678863525
Epoch: 6, Steps: 10 | Train Loss: 1.258 Vali Loss: 1.274 Vali Acc: 0.461 Test Loss: 1.274 Test Acc: 0.461
Validation loss decreased (-0.361829 --> -0.460514).  Saving model ...
Epoch: 7 cost time: 0.8820044994354248
Epoch: 7, Steps: 10 | Train Loss: 1.163 Vali Loss: 1.210 Vali Acc: 0.533 Test Loss: 1.210 Test Acc: 0.533
Validation loss decreased (-0.460514 --> -0.532883).  Saving model ...
Epoch: 8 cost time: 1.039546251296997
Epoch: 8, Steps: 10 | Train Loss: 1.120 Vali Loss: 1.146 Vali Acc: 0.612 Test Loss: 1.146 Test Acc: 0.612
Validation loss decreased (-0.532883 --> -0.611831).  Saving model ...
Epoch: 9 cost time: 1.1422195434570312
Epoch: 9, Steps: 10 | Train Loss: 1.009 Vali Loss: 1.101 Vali Acc: 0.592 Test Loss: 1.101 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4740145206451416
Epoch: 10, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.042 Vali Acc: 0.651 Test Loss: 1.042 Test Acc: 0.651
Validation loss decreased (-0.611831 --> -0.651305).  Saving model ...
Epoch: 11 cost time: 1.0096373558044434
Epoch: 11, Steps: 10 | Train Loss: 0.881 Vali Loss: 0.973 Vali Acc: 0.658 Test Loss: 0.973 Test Acc: 0.658
Validation loss decreased (-0.651305 --> -0.657885).  Saving model ...
Epoch: 12 cost time: 1.106584072113037
Epoch: 12, Steps: 10 | Train Loss: 0.792 Vali Loss: 0.917 Vali Acc: 0.704 Test Loss: 0.917 Test Acc: 0.704
Validation loss decreased (-0.657885 --> -0.703938).  Saving model ...
Epoch: 13 cost time: 1.1596534252166748
Epoch: 13, Steps: 10 | Train Loss: 0.693 Vali Loss: 0.856 Vali Acc: 0.691 Test Loss: 0.856 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.154463768005371
Epoch: 14, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.793 Vali Acc: 0.724 Test Loss: 0.793 Test Acc: 0.724
Validation loss decreased (-0.703938 --> -0.723676).  Saving model ...
Epoch: 15 cost time: 1.0979187488555908
Epoch: 15, Steps: 10 | Train Loss: 0.537 Vali Loss: 0.726 Vali Acc: 0.737 Test Loss: 0.726 Test Acc: 0.737
Validation loss decreased (-0.723676 --> -0.736835).  Saving model ...
Epoch: 16 cost time: 1.4874749183654785
Epoch: 16, Steps: 10 | Train Loss: 0.506 Vali Loss: 0.686 Vali Acc: 0.750 Test Loss: 0.686 Test Acc: 0.750
Validation loss decreased (-0.736835 --> -0.749993).  Saving model ...
Epoch: 17 cost time: 1.0722832679748535
Epoch: 17, Steps: 10 | Train Loss: 0.417 Vali Loss: 0.641 Vali Acc: 0.783 Test Loss: 0.641 Test Acc: 0.783
Validation loss decreased (-0.749993 --> -0.782888).  Saving model ...
Epoch: 18 cost time: 1.1154882907867432
Epoch: 18, Steps: 10 | Train Loss: 0.359 Vali Loss: 0.600 Vali Acc: 0.763 Test Loss: 0.600 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2400696277618408
Epoch: 19, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.568 Vali Acc: 0.770 Test Loss: 0.568 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3003032207489014
Epoch: 20, Steps: 10 | Train Loss: 0.269 Vali Loss: 0.540 Vali Acc: 0.789 Test Loss: 0.540 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789468).  Saving model ...
Epoch: 21 cost time: 1.3156452178955078
Epoch: 21, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.518 Vali Acc: 0.789 Test Loss: 0.518 Test Acc: 0.789
Validation loss decreased (-0.789468 --> -0.789469).  Saving model ...
Epoch: 22 cost time: 1.411168098449707
Epoch: 22, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.507 Vali Acc: 0.776 Test Loss: 0.507 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1936132907867432
Epoch: 23, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.505 Vali Acc: 0.770 Test Loss: 0.505 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.250459909439087
Epoch: 24, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.504 Vali Acc: 0.770 Test Loss: 0.504 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.235112190246582
Epoch: 25, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 26 cost time: 1.0616793632507324
Epoch: 26, Steps: 10 | Train Loss: 0.148 Vali Loss: 0.511 Vali Acc: 0.776 Test Loss: 0.511 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0757074356079102
Epoch: 27, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.489 Vali Acc: 0.783 Test Loss: 0.489 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2035634517669678
Epoch: 28, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.492 Vali Acc: 0.783 Test Loss: 0.492 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1220180988311768
Epoch: 29, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.497 Vali Acc: 0.783 Test Loss: 0.497 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.319267988204956
Epoch: 30, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.511 Vali Acc: 0.770 Test Loss: 0.511 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.4512889385223389
Epoch: 31, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.507 Vali Acc: 0.783 Test Loss: 0.507 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.261059045791626
Epoch: 32, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.521 Vali Acc: 0.770 Test Loss: 0.521 Test Acc: 0.770
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1972191333770752
Epoch: 33, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.521 Vali Acc: 0.789 Test Loss: 0.521 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.3362176418304443
Epoch: 34, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.542 Vali Acc: 0.783 Test Loss: 0.542 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.155881404876709
Epoch: 35, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.549 Vali Acc: 0.783 Test Loss: 0.549 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 260252
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.315713882446289
Epoch: 1, Steps: 10 | Train Loss: 1.472 Vali Loss: 1.426 Vali Acc: 0.296 Test Loss: 1.426 Test Acc: 0.296
Validation loss decreased (inf --> -0.296038).  Saving model ...
Epoch: 2 cost time: 1.3359382152557373
Epoch: 2, Steps: 10 | Train Loss: 1.384 Vali Loss: 1.370 Vali Acc: 0.349 Test Loss: 1.370 Test Acc: 0.349
Validation loss decreased (-0.296038 --> -0.348671).  Saving model ...
Epoch: 3 cost time: 1.0515077114105225
Epoch: 3, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.349 Vali Acc: 0.355 Test Loss: 1.349 Test Acc: 0.355
Validation loss decreased (-0.348671 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 1.0050957202911377
Epoch: 4, Steps: 10 | Train Loss: 1.287 Vali Loss: 1.302 Vali Acc: 0.382 Test Loss: 1.302 Test Acc: 0.382
Validation loss decreased (-0.355250 --> -0.381566).  Saving model ...
Epoch: 5 cost time: 0.9468748569488525
Epoch: 5, Steps: 10 | Train Loss: 1.231 Vali Loss: 1.266 Vali Acc: 0.428 Test Loss: 1.266 Test Acc: 0.428
Validation loss decreased (-0.381566 --> -0.427619).  Saving model ...
Epoch: 6 cost time: 1.0624825954437256
Epoch: 6, Steps: 10 | Train Loss: 1.172 Vali Loss: 1.217 Vali Acc: 0.507 Test Loss: 1.217 Test Acc: 0.507
Validation loss decreased (-0.427619 --> -0.506567).  Saving model ...
Epoch: 7 cost time: 0.9922680854797363
Epoch: 7, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.177 Vali Acc: 0.559 Test Loss: 1.177 Test Acc: 0.559
Validation loss decreased (-0.506567 --> -0.559199).  Saving model ...
Epoch: 8 cost time: 0.908393383026123
Epoch: 8, Steps: 10 | Train Loss: 1.070 Vali Loss: 1.132 Vali Acc: 0.572 Test Loss: 1.132 Test Acc: 0.572
Validation loss decreased (-0.559199 --> -0.572357).  Saving model ...
Epoch: 9 cost time: 1.129507064819336
Epoch: 9, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.078 Vali Acc: 0.605 Test Loss: 1.078 Test Acc: 0.605
Validation loss decreased (-0.572357 --> -0.605252).  Saving model ...
Epoch: 10 cost time: 1.0166661739349365
Epoch: 10, Steps: 10 | Train Loss: 0.904 Vali Loss: 1.024 Vali Acc: 0.651 Test Loss: 1.024 Test Acc: 0.651
Validation loss decreased (-0.605252 --> -0.651306).  Saving model ...
Epoch: 11 cost time: 1.0347461700439453
Epoch: 11, Steps: 10 | Train Loss: 0.828 Vali Loss: 0.960 Vali Acc: 0.691 Test Loss: 0.960 Test Acc: 0.691
Validation loss decreased (-0.651306 --> -0.690780).  Saving model ...
Epoch: 12 cost time: 1.0926566123962402
Epoch: 12, Steps: 10 | Train Loss: 0.737 Vali Loss: 0.906 Vali Acc: 0.691 Test Loss: 0.906 Test Acc: 0.691
Validation loss decreased (-0.690780 --> -0.690780).  Saving model ...
Epoch: 13 cost time: 0.9263296127319336
Epoch: 13, Steps: 10 | Train Loss: 0.658 Vali Loss: 0.846 Vali Acc: 0.717 Test Loss: 0.846 Test Acc: 0.717
Validation loss decreased (-0.690780 --> -0.717097).  Saving model ...
Epoch: 14 cost time: 1.1870529651641846
Epoch: 14, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.792 Vali Acc: 0.711 Test Loss: 0.792 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8545064926147461
Epoch: 15, Steps: 10 | Train Loss: 0.550 Vali Loss: 0.737 Vali Acc: 0.724 Test Loss: 0.737 Test Acc: 0.724
Validation loss decreased (-0.717097 --> -0.723677).  Saving model ...
Epoch: 16 cost time: 1.03924560546875
Epoch: 16, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.695 Vali Acc: 0.743 Test Loss: 0.695 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 17 cost time: 1.0033140182495117
Epoch: 17, Steps: 10 | Train Loss: 0.413 Vali Loss: 0.649 Vali Acc: 0.750 Test Loss: 0.649 Test Acc: 0.750
Validation loss decreased (-0.743414 --> -0.749994).  Saving model ...
Epoch: 18 cost time: 0.9158830642700195
Epoch: 18, Steps: 10 | Train Loss: 0.384 Vali Loss: 0.633 Vali Acc: 0.737 Test Loss: 0.633 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9579300880432129
Epoch: 19, Steps: 10 | Train Loss: 0.315 Vali Loss: 0.595 Vali Acc: 0.770 Test Loss: 0.595 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 20 cost time: 1.088477373123169
Epoch: 20, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
Validation loss decreased (-0.769731 --> -0.796047).  Saving model ...
Epoch: 21 cost time: 0.9714217185974121
Epoch: 21, Steps: 10 | Train Loss: 0.257 Vali Loss: 0.533 Vali Acc: 0.789 Test Loss: 0.533 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0848889350891113
Epoch: 22, Steps: 10 | Train Loss: 0.235 Vali Loss: 0.514 Vali Acc: 0.783 Test Loss: 0.514 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0017809867858887
Epoch: 23, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.508 Vali Acc: 0.789 Test Loss: 0.508 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9835910797119141
Epoch: 24, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9420955181121826
Epoch: 25, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.487 Vali Acc: 0.783 Test Loss: 0.487 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9248752593994141
Epoch: 26, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.485 Vali Acc: 0.796 Test Loss: 0.485 Test Acc: 0.796
Validation loss decreased (-0.796047 --> -0.796048).  Saving model ...
Epoch: 27 cost time: 1.0114948749542236
Epoch: 27, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.478 Vali Acc: 0.803 Test Loss: 0.478 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 28 cost time: 0.9119374752044678
Epoch: 28, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.487 Vali Acc: 0.789 Test Loss: 0.487 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.931800365447998
Epoch: 29, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.485 Vali Acc: 0.803 Test Loss: 0.485 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9393284320831299
Epoch: 30, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0758178234100342
Epoch: 31, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.491 Vali Acc: 0.796 Test Loss: 0.491 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1151912212371826
Epoch: 32, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9744150638580322
Epoch: 33, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.510 Vali Acc: 0.803 Test Loss: 0.510 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9050438404083252
Epoch: 34, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.532 Vali Acc: 0.796 Test Loss: 0.532 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.067018985748291
Epoch: 35, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.546 Vali Acc: 0.803 Test Loss: 0.546 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.071281909942627
Epoch: 36, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.589 Vali Acc: 0.796 Test Loss: 0.589 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9562375545501709
Epoch: 37, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.598 Vali Acc: 0.796 Test Loss: 0.598 Test Acc: 0.796
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 260060
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7169735431671143
Epoch: 1, Steps: 10 | Train Loss: 1.500 Vali Loss: 1.417 Vali Acc: 0.237 Test Loss: 1.417 Test Acc: 0.237
Validation loss decreased (inf --> -0.236828).  Saving model ...
Epoch: 2 cost time: 1.1577081680297852
Epoch: 2, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.376 Vali Acc: 0.322 Test Loss: 1.376 Test Acc: 0.322
Validation loss decreased (-0.236828 --> -0.322355).  Saving model ...
Epoch: 3 cost time: 1.0096895694732666
Epoch: 3, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.359 Vali Acc: 0.303 Test Loss: 1.359 Test Acc: 0.303
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0999302864074707
Epoch: 4, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.326 Vali Acc: 0.329 Test Loss: 1.326 Test Acc: 0.329
Validation loss decreased (-0.322355 --> -0.328934).  Saving model ...
Epoch: 5 cost time: 0.7868187427520752
Epoch: 5, Steps: 10 | Train Loss: 1.291 Vali Loss: 1.282 Vali Acc: 0.434 Test Loss: 1.282 Test Acc: 0.434
Validation loss decreased (-0.328934 --> -0.434198).  Saving model ...
Epoch: 6 cost time: 0.8750185966491699
Epoch: 6, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.243 Vali Acc: 0.500 Test Loss: 1.243 Test Acc: 0.500
Validation loss decreased (-0.434198 --> -0.499988).  Saving model ...
Epoch: 7 cost time: 1.2236714363098145
Epoch: 7, Steps: 10 | Train Loss: 1.204 Vali Loss: 1.199 Vali Acc: 0.546 Test Loss: 1.199 Test Acc: 0.546
Validation loss decreased (-0.499988 --> -0.546041).  Saving model ...
Epoch: 8 cost time: 1.128303050994873
Epoch: 8, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.148 Vali Acc: 0.533 Test Loss: 1.148 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8897538185119629
Epoch: 9, Steps: 10 | Train Loss: 1.018 Vali Loss: 1.109 Vali Acc: 0.586 Test Loss: 1.109 Test Acc: 0.586
Validation loss decreased (-0.546041 --> -0.585515).  Saving model ...
Epoch: 10 cost time: 1.3365788459777832
Epoch: 10, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.063 Vali Acc: 0.572 Test Loss: 1.063 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1746039390563965
Epoch: 11, Steps: 10 | Train Loss: 0.906 Vali Loss: 1.011 Vali Acc: 0.592 Test Loss: 1.011 Test Acc: 0.592
Validation loss decreased (-0.585515 --> -0.592095).  Saving model ...
Epoch: 12 cost time: 1.1077077388763428
Epoch: 12, Steps: 10 | Train Loss: 0.866 Vali Loss: 0.963 Vali Acc: 0.592 Test Loss: 0.963 Test Acc: 0.592
Validation loss decreased (-0.592095 --> -0.592096).  Saving model ...
Epoch: 13 cost time: 0.9626684188842773
Epoch: 13, Steps: 10 | Train Loss: 0.758 Vali Loss: 0.919 Vali Acc: 0.651 Test Loss: 0.919 Test Acc: 0.651
Validation loss decreased (-0.592096 --> -0.651307).  Saving model ...
Epoch: 14 cost time: 0.8279590606689453
Epoch: 14, Steps: 10 | Train Loss: 0.711 Vali Loss: 0.867 Vali Acc: 0.651 Test Loss: 0.867 Test Acc: 0.651
Validation loss decreased (-0.651307 --> -0.651307).  Saving model ...
Epoch: 15 cost time: 1.0270326137542725
Epoch: 15, Steps: 10 | Train Loss: 0.641 Vali Loss: 0.819 Vali Acc: 0.658 Test Loss: 0.819 Test Acc: 0.658
Validation loss decreased (-0.651307 --> -0.657887).  Saving model ...
Epoch: 16 cost time: 1.0796875953674316
Epoch: 16, Steps: 10 | Train Loss: 0.598 Vali Loss: 0.771 Vali Acc: 0.684 Test Loss: 0.771 Test Acc: 0.684
Validation loss decreased (-0.657887 --> -0.684203).  Saving model ...
Epoch: 17 cost time: 0.9849998950958252
Epoch: 17, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.724 Vali Acc: 0.691 Test Loss: 0.724 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 18 cost time: 0.943443775177002
Epoch: 18, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.686 Vali Acc: 0.717 Test Loss: 0.686 Test Acc: 0.717
Validation loss decreased (-0.690782 --> -0.717098).  Saving model ...
Epoch: 19 cost time: 1.0521512031555176
Epoch: 19, Steps: 10 | Train Loss: 0.438 Vali Loss: 0.644 Vali Acc: 0.730 Test Loss: 0.644 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730257).  Saving model ...
Epoch: 20 cost time: 1.0394794940948486
Epoch: 20, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.610 Vali Acc: 0.770 Test Loss: 0.610 Test Acc: 0.770
Validation loss decreased (-0.730257 --> -0.769731).  Saving model ...
Epoch: 21 cost time: 0.8819992542266846
Epoch: 21, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9318892955780029
Epoch: 22, Steps: 10 | Train Loss: 0.326 Vali Loss: 0.566 Vali Acc: 0.730 Test Loss: 0.566 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.41544508934021
Epoch: 23, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.545 Vali Acc: 0.757 Test Loss: 0.545 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.050797462463379
Epoch: 24, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.531 Vali Acc: 0.750 Test Loss: 0.531 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.236140251159668
Epoch: 25, Steps: 10 | Train Loss: 0.259 Vali Loss: 0.513 Vali Acc: 0.770 Test Loss: 0.513 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 26 cost time: 1.0781314373016357
Epoch: 26, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.516 Vali Acc: 0.750 Test Loss: 0.516 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8231813907623291
Epoch: 27, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.498 Vali Acc: 0.770 Test Loss: 0.498 Test Acc: 0.770
Validation loss decreased (-0.769732 --> -0.769732).  Saving model ...
Epoch: 28 cost time: 0.8685064315795898
Epoch: 28, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.494 Vali Acc: 0.783 Test Loss: 0.494 Test Acc: 0.783
Validation loss decreased (-0.769732 --> -0.782890).  Saving model ...
Epoch: 29 cost time: 0.8898050785064697
Epoch: 29, Steps: 10 | Train Loss: 0.161 Vali Loss: 0.487 Vali Acc: 0.770 Test Loss: 0.487 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0906944274902344
Epoch: 30, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.486 Vali Acc: 0.776 Test Loss: 0.486 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9626460075378418
Epoch: 31, Steps: 10 | Train Loss: 0.144 Vali Loss: 0.479 Vali Acc: 0.783 Test Loss: 0.479 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 32 cost time: 0.9401357173919678
Epoch: 32, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.479 Vali Acc: 0.776 Test Loss: 0.479 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8517088890075684
Epoch: 33, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.484 Vali Acc: 0.770 Test Loss: 0.484 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9541993141174316
Epoch: 34, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.489 Vali Acc: 0.763 Test Loss: 0.489 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0321910381317139
Epoch: 35, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.488 Vali Acc: 0.763 Test Loss: 0.488 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9482259750366211
Epoch: 36, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.132805585861206
Epoch: 37, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.483 Vali Acc: 0.776 Test Loss: 0.483 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.090301275253296
Epoch: 38, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.498 Vali Acc: 0.757 Test Loss: 0.498 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9971394538879395
Epoch: 39, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.502 Vali Acc: 0.776 Test Loss: 0.502 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.974174976348877
Epoch: 40, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.497 Vali Acc: 0.763 Test Loss: 0.497 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8986523151397705
Epoch: 41, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 256092
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.3552956581115723
Epoch: 1, Steps: 10 | Train Loss: 1.568 Vali Loss: 1.484 Vali Acc: 0.217 Test Loss: 1.484 Test Acc: 0.217
Validation loss decreased (inf --> -0.217090).  Saving model ...
Epoch: 2 cost time: 1.093839168548584
Epoch: 2, Steps: 10 | Train Loss: 1.464 Vali Loss: 1.439 Vali Acc: 0.224 Test Loss: 1.439 Test Acc: 0.224
Validation loss decreased (-0.217090 --> -0.223670).  Saving model ...
Epoch: 3 cost time: 1.0545012950897217
Epoch: 3, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.424 Vali Acc: 0.276 Test Loss: 1.424 Test Acc: 0.276
Validation loss decreased (-0.223670 --> -0.276302).  Saving model ...
Epoch: 4 cost time: 0.8675684928894043
Epoch: 4, Steps: 10 | Train Loss: 1.385 Vali Loss: 1.377 Vali Acc: 0.283 Test Loss: 1.377 Test Acc: 0.283
Validation loss decreased (-0.276302 --> -0.282881).  Saving model ...
Epoch: 5 cost time: 0.9799821376800537
Epoch: 5, Steps: 10 | Train Loss: 1.310 Vali Loss: 1.337 Vali Acc: 0.336 Test Loss: 1.337 Test Acc: 0.336
Validation loss decreased (-0.282881 --> -0.335513).  Saving model ...
Epoch: 6 cost time: 1.0810928344726562
Epoch: 6, Steps: 10 | Train Loss: 1.239 Vali Loss: 1.293 Vali Acc: 0.375 Test Loss: 1.293 Test Acc: 0.375
Validation loss decreased (-0.335513 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.1782782077789307
Epoch: 7, Steps: 10 | Train Loss: 1.188 Vali Loss: 1.247 Vali Acc: 0.533 Test Loss: 1.247 Test Acc: 0.533
Validation loss decreased (-0.374987 --> -0.532882).  Saving model ...
Epoch: 8 cost time: 1.2071216106414795
Epoch: 8, Steps: 10 | Train Loss: 1.133 Vali Loss: 1.199 Vali Acc: 0.546 Test Loss: 1.199 Test Acc: 0.546
Validation loss decreased (-0.532882 --> -0.546041).  Saving model ...
Epoch: 9 cost time: 1.1775944232940674
Epoch: 9, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.151 Vali Acc: 0.559 Test Loss: 1.151 Test Acc: 0.559
Validation loss decreased (-0.546041 --> -0.559199).  Saving model ...
Epoch: 10 cost time: 1.224165678024292
Epoch: 10, Steps: 10 | Train Loss: 1.002 Vali Loss: 1.104 Vali Acc: 0.572 Test Loss: 1.104 Test Acc: 0.572
Validation loss decreased (-0.559199 --> -0.572357).  Saving model ...
Epoch: 11 cost time: 0.9587483406066895
Epoch: 11, Steps: 10 | Train Loss: 0.903 Vali Loss: 1.038 Vali Acc: 0.632 Test Loss: 1.038 Test Acc: 0.632
Validation loss decreased (-0.572357 --> -0.631569).  Saving model ...
Epoch: 12 cost time: 1.2106270790100098
Epoch: 12, Steps: 10 | Train Loss: 0.844 Vali Loss: 0.977 Vali Acc: 0.625 Test Loss: 0.977 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0749940872192383
Epoch: 13, Steps: 10 | Train Loss: 0.759 Vali Loss: 0.918 Vali Acc: 0.664 Test Loss: 0.918 Test Acc: 0.664
Validation loss decreased (-0.631569 --> -0.664465).  Saving model ...
Epoch: 14 cost time: 0.9400804042816162
Epoch: 14, Steps: 10 | Train Loss: 0.693 Vali Loss: 0.856 Vali Acc: 0.658 Test Loss: 0.856 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.040797472000122
Epoch: 15, Steps: 10 | Train Loss: 0.614 Vali Loss: 0.805 Vali Acc: 0.691 Test Loss: 0.805 Test Acc: 0.691
Validation loss decreased (-0.664465 --> -0.690781).  Saving model ...
Epoch: 16 cost time: 1.1888933181762695
Epoch: 16, Steps: 10 | Train Loss: 0.554 Vali Loss: 0.751 Vali Acc: 0.704 Test Loss: 0.751 Test Acc: 0.704
Validation loss decreased (-0.690781 --> -0.703940).  Saving model ...
Epoch: 17 cost time: 1.2014093399047852
Epoch: 17, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.709 Vali Acc: 0.724 Test Loss: 0.709 Test Acc: 0.724
Validation loss decreased (-0.703940 --> -0.723677).  Saving model ...
Epoch: 18 cost time: 1.0303068161010742
Epoch: 18, Steps: 10 | Train Loss: 0.423 Vali Loss: 0.669 Vali Acc: 0.743 Test Loss: 0.669 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 19 cost time: 1.089587688446045
Epoch: 19, Steps: 10 | Train Loss: 0.388 Vali Loss: 0.636 Vali Acc: 0.757 Test Loss: 0.636 Test Acc: 0.757
Validation loss decreased (-0.743414 --> -0.756573).  Saving model ...
Epoch: 20 cost time: 1.0228958129882812
Epoch: 20, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.606 Vali Acc: 0.770 Test Loss: 0.606 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 21 cost time: 1.0676963329315186
Epoch: 21, Steps: 10 | Train Loss: 0.293 Vali Loss: 0.578 Vali Acc: 0.770 Test Loss: 0.578 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 22 cost time: 1.1558623313903809
Epoch: 22, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.563 Vali Acc: 0.763 Test Loss: 0.563 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.335557222366333
Epoch: 23, Steps: 10 | Train Loss: 0.239 Vali Loss: 0.552 Vali Acc: 0.783 Test Loss: 0.552 Test Acc: 0.783
Validation loss decreased (-0.769731 --> -0.782889).  Saving model ...
Epoch: 24 cost time: 1.1534943580627441
Epoch: 24, Steps: 10 | Train Loss: 0.245 Vali Loss: 0.542 Vali Acc: 0.776 Test Loss: 0.542 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9874041080474854
Epoch: 25, Steps: 10 | Train Loss: 0.204 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 26 cost time: 1.0236830711364746
Epoch: 26, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.520 Vali Acc: 0.776 Test Loss: 0.520 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1994833946228027
Epoch: 27, Steps: 10 | Train Loss: 0.164 Vali Loss: 0.508 Vali Acc: 0.783 Test Loss: 0.508 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782890).  Saving model ...
Epoch: 28 cost time: 1.1434903144836426
Epoch: 28, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.513 Vali Acc: 0.770 Test Loss: 0.513 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1589341163635254
Epoch: 29, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.504 Vali Acc: 0.783 Test Loss: 0.504 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 30 cost time: 0.9837093353271484
Epoch: 30, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.500 Vali Acc: 0.770 Test Loss: 0.500 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0469152927398682
Epoch: 31, Steps: 10 | Train Loss: 0.122 Vali Loss: 0.501 Vali Acc: 0.776 Test Loss: 0.501 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.0485115051269531
Epoch: 32, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.499 Vali Acc: 0.776 Test Loss: 0.499 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0792884826660156
Epoch: 33, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.505 Vali Acc: 0.783 Test Loss: 0.505 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9548211097717285
Epoch: 34, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.520 Vali Acc: 0.770 Test Loss: 0.520 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.06394362449646
Epoch: 35, Steps: 10 | Train Loss: 0.109 Vali Loss: 0.514 Vali Acc: 0.776 Test Loss: 0.514 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.2534449100494385
Epoch: 36, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1176679134368896
Epoch: 37, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.510 Vali Acc: 0.776 Test Loss: 0.510 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0972552299499512
Epoch: 38, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.523 Vali Acc: 0.789 Test Loss: 0.523 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 39 cost time: 0.9985594749450684
Epoch: 39, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.528 Vali Acc: 0.770 Test Loss: 0.528 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.205488681793213
Epoch: 40, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.528 Vali Acc: 0.803 Test Loss: 0.528 Test Acc: 0.803
Validation loss decreased (-0.789468 --> -0.802626).  Saving model ...
Epoch: 41 cost time: 0.9416699409484863
Epoch: 41, Steps: 10 | Train Loss: 0.058 Vali Loss: 0.539 Vali Acc: 0.803 Test Loss: 0.539 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.130070686340332
Epoch: 42, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.540 Vali Acc: 0.796 Test Loss: 0.540 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2596549987792969
Epoch: 43, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.537 Vali Acc: 0.796 Test Loss: 0.537 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1470513343811035
Epoch: 44, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.546 Vali Acc: 0.783 Test Loss: 0.546 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.1487040519714355
Epoch: 45, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.569 Vali Acc: 0.783 Test Loss: 0.569 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9445197582244873
Epoch: 46, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.568 Vali Acc: 0.783 Test Loss: 0.568 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.281332015991211
Epoch: 47, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.572 Vali Acc: 0.789 Test Loss: 0.572 Test Acc: 0.789
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.3226797580718994
Epoch: 48, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.585 Vali Acc: 0.789 Test Loss: 0.585 Test Acc: 0.789
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8849685192108154
Epoch: 49, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.585 Vali Acc: 0.776 Test Loss: 0.585 Test Acc: 0.776
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.290710687637329
Epoch: 50, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.598 Vali Acc: 0.776 Test Loss: 0.598 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 255996
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1354963779449463
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.430 Vali Acc: 0.289 Test Loss: 1.430 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 1.2499864101409912
Epoch: 2, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.361 Vali Acc: 0.257 Test Loss: 1.361 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0559203624725342
Epoch: 3, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.325 Vali Acc: 0.355 Test Loss: 1.325 Test Acc: 0.355
Validation loss decreased (-0.289459 --> -0.355250).  Saving model ...
Epoch: 4 cost time: 1.2358765602111816
Epoch: 4, Steps: 10 | Train Loss: 1.275 Vali Loss: 1.297 Vali Acc: 0.362 Test Loss: 1.297 Test Acc: 0.362
Validation loss decreased (-0.355250 --> -0.361829).  Saving model ...
Epoch: 5 cost time: 1.0170340538024902
Epoch: 5, Steps: 10 | Train Loss: 1.241 Vali Loss: 1.260 Vali Acc: 0.395 Test Loss: 1.260 Test Acc: 0.395
Validation loss decreased (-0.361829 --> -0.394724).  Saving model ...
Epoch: 6 cost time: 1.2123889923095703
Epoch: 6, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.222 Vali Acc: 0.539 Test Loss: 1.222 Test Acc: 0.539
Validation loss decreased (-0.394724 --> -0.539461).  Saving model ...
Epoch: 7 cost time: 1.5298006534576416
Epoch: 7, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.201 Vali Acc: 0.500 Test Loss: 1.201 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3349277973175049
Epoch: 8, Steps: 10 | Train Loss: 1.053 Vali Loss: 1.142 Vali Acc: 0.566 Test Loss: 1.142 Test Acc: 0.566
Validation loss decreased (-0.539461 --> -0.565778).  Saving model ...
Epoch: 9 cost time: 1.1913092136383057
Epoch: 9, Steps: 10 | Train Loss: 1.015 Vali Loss: 1.094 Vali Acc: 0.572 Test Loss: 1.094 Test Acc: 0.572
Validation loss decreased (-0.565778 --> -0.572357).  Saving model ...
Epoch: 10 cost time: 1.22735595703125
Epoch: 10, Steps: 10 | Train Loss: 0.927 Vali Loss: 1.067 Vali Acc: 0.599 Test Loss: 1.067 Test Acc: 0.599
Validation loss decreased (-0.572357 --> -0.598674).  Saving model ...
Epoch: 11 cost time: 1.3345282077789307
Epoch: 11, Steps: 10 | Train Loss: 0.864 Vali Loss: 0.999 Vali Acc: 0.592 Test Loss: 0.999 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1889193058013916
Epoch: 12, Steps: 10 | Train Loss: 0.814 Vali Loss: 0.951 Vali Acc: 0.618 Test Loss: 0.951 Test Acc: 0.618
Validation loss decreased (-0.598674 --> -0.618412).  Saving model ...
Epoch: 13 cost time: 1.0419323444366455
Epoch: 13, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.906 Vali Acc: 0.605 Test Loss: 0.906 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1211702823638916
Epoch: 14, Steps: 10 | Train Loss: 0.659 Vali Loss: 0.852 Vali Acc: 0.625 Test Loss: 0.852 Test Acc: 0.625
Validation loss decreased (-0.618412 --> -0.624991).  Saving model ...
Epoch: 15 cost time: 1.1164424419403076
Epoch: 15, Steps: 10 | Train Loss: 0.604 Vali Loss: 0.796 Vali Acc: 0.651 Test Loss: 0.796 Test Acc: 0.651
Validation loss decreased (-0.624991 --> -0.651308).  Saving model ...
Epoch: 16 cost time: 1.1126725673675537
Epoch: 16, Steps: 10 | Train Loss: 0.532 Vali Loss: 0.748 Vali Acc: 0.645 Test Loss: 0.748 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2656478881835938
Epoch: 17, Steps: 10 | Train Loss: 0.481 Vali Loss: 0.701 Vali Acc: 0.658 Test Loss: 0.701 Test Acc: 0.658
Validation loss decreased (-0.651308 --> -0.657888).  Saving model ...
Epoch: 18 cost time: 1.1036148071289062
Epoch: 18, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.658 Vali Acc: 0.711 Test Loss: 0.658 Test Acc: 0.711
Validation loss decreased (-0.657888 --> -0.710520).  Saving model ...
Epoch: 19 cost time: 1.0911359786987305
Epoch: 19, Steps: 10 | Train Loss: 0.349 Vali Loss: 0.634 Vali Acc: 0.697 Test Loss: 0.634 Test Acc: 0.697
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9755537509918213
Epoch: 20, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.592 Vali Acc: 0.743 Test Loss: 0.592 Test Acc: 0.743
Validation loss decreased (-0.710520 --> -0.743415).  Saving model ...
Epoch: 21 cost time: 1.0686969757080078
Epoch: 21, Steps: 10 | Train Loss: 0.304 Vali Loss: 0.566 Vali Acc: 0.743 Test Loss: 0.566 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 22 cost time: 1.283928632736206
Epoch: 22, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.551 Vali Acc: 0.757 Test Loss: 0.551 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 23 cost time: 1.1669447422027588
Epoch: 23, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.533 Vali Acc: 0.730 Test Loss: 0.533 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0802509784698486
Epoch: 24, Steps: 10 | Train Loss: 0.221 Vali Loss: 0.509 Vali Acc: 0.750 Test Loss: 0.509 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2562670707702637
Epoch: 25, Steps: 10 | Train Loss: 0.203 Vali Loss: 0.501 Vali Acc: 0.757 Test Loss: 0.501 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 26 cost time: 1.1040711402893066
Epoch: 26, Steps: 10 | Train Loss: 0.194 Vali Loss: 0.495 Vali Acc: 0.750 Test Loss: 0.495 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1913838386535645
Epoch: 27, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.485 Vali Acc: 0.776 Test Loss: 0.485 Test Acc: 0.776
Validation loss decreased (-0.756574 --> -0.776311).  Saving model ...
Epoch: 28 cost time: 1.0543861389160156
Epoch: 28, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.475 Vali Acc: 0.776 Test Loss: 0.475 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 29 cost time: 1.0714871883392334
Epoch: 29, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.472 Vali Acc: 0.770 Test Loss: 0.472 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1749818325042725
Epoch: 30, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.468 Vali Acc: 0.776 Test Loss: 0.468 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 31 cost time: 1.044363260269165
Epoch: 31, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.461 Vali Acc: 0.770 Test Loss: 0.461 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.076033115386963
Epoch: 32, Steps: 10 | Train Loss: 0.114 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 33 cost time: 1.1792974472045898
Epoch: 33, Steps: 10 | Train Loss: 0.107 Vali Loss: 0.450 Vali Acc: 0.776 Test Loss: 0.450 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3975989818572998
Epoch: 34, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.450 Vali Acc: 0.783 Test Loss: 0.450 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 35 cost time: 1.034477710723877
Epoch: 35, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.455 Vali Acc: 0.783 Test Loss: 0.455 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3975553512573242
Epoch: 36, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.452 Vali Acc: 0.783 Test Loss: 0.452 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.2450947761535645
Epoch: 37, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.462 Vali Acc: 0.783 Test Loss: 0.462 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2033891677856445
Epoch: 38, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.459 Vali Acc: 0.783 Test Loss: 0.459 Test Acc: 0.783
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3286237716674805
Epoch: 39, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.456 Vali Acc: 0.776 Test Loss: 0.456 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.3701539039611816
Epoch: 40, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.472 Vali Acc: 0.789 Test Loss: 0.472 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 41 cost time: 1.123624324798584
Epoch: 41, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.461 Vali Acc: 0.776 Test Loss: 0.461 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0656838417053223
Epoch: 42, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.463 Vali Acc: 0.776 Test Loss: 0.463 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.2237811088562012
Epoch: 43, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.470 Vali Acc: 0.789 Test Loss: 0.470 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 44 cost time: 0.9409451484680176
Epoch: 44, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.470 Vali Acc: 0.789 Test Loss: 0.470 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.1892263889312744
Epoch: 45, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.484 Vali Acc: 0.783 Test Loss: 0.484 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.1452264785766602
Epoch: 46, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.471 Vali Acc: 0.783 Test Loss: 0.471 Test Acc: 0.783
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9968080520629883
Epoch: 47, Steps: 10 | Train Loss: 0.066 Vali Loss: 0.471 Vali Acc: 0.796 Test Loss: 0.471 Test Acc: 0.796
Validation loss decreased (-0.789469 --> -0.796048).  Saving model ...
Epoch: 48 cost time: 1.2765305042266846
Epoch: 48, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.461 Vali Acc: 0.789 Test Loss: 0.461 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.080132007598877
Epoch: 49, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.469 Vali Acc: 0.796 Test Loss: 0.469 Test Acc: 0.796
Validation loss decreased (-0.796048 --> -0.796048).  Saving model ...
Epoch: 50 cost time: 1.289600133895874
Epoch: 50, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.484 Vali Acc: 0.789 Test Loss: 0.484 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9835715293884277
Epoch: 51, Steps: 10 | Train Loss: 0.033 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9541563987731934
Epoch: 52, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.502 Vali Acc: 0.796 Test Loss: 0.502 Test Acc: 0.796
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.1252202987670898
Epoch: 53, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.520 Vali Acc: 0.796 Test Loss: 0.520 Test Acc: 0.796
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.0968642234802246
Epoch: 54, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.517 Vali Acc: 0.796 Test Loss: 0.517 Test Acc: 0.796
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.316192626953125
Epoch: 55, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.520 Vali Acc: 0.809 Test Loss: 0.520 Test Acc: 0.809
Validation loss decreased (-0.796048 --> -0.809205).  Saving model ...
Epoch: 56 cost time: 1.2719950675964355
Epoch: 56, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.514 Vali Acc: 0.803 Test Loss: 0.514 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.5086936950683594
Epoch: 57, Steps: 10 | Train Loss: 0.023 Vali Loss: 0.519 Vali Acc: 0.809 Test Loss: 0.519 Test Acc: 0.809
Validation loss decreased (-0.809205 --> -0.809205).  Saving model ...
Epoch: 58 cost time: 0.9420919418334961
Epoch: 58, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.521 Vali Acc: 0.809 Test Loss: 0.521 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.2376198768615723
Epoch: 59, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.527 Vali Acc: 0.803 Test Loss: 0.527 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9755995273590088
Epoch: 60, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.538 Vali Acc: 0.809 Test Loss: 0.538 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.2476649284362793
Epoch: 61, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.541 Vali Acc: 0.803 Test Loss: 0.541 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.06758451461792
Epoch: 62, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.544 Vali Acc: 0.816 Test Loss: 0.544 Test Acc: 0.816
Validation loss decreased (-0.809205 --> -0.815784).  Saving model ...
Epoch: 63 cost time: 1.1695806980133057
Epoch: 63, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.546 Vali Acc: 0.816 Test Loss: 0.546 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.1871306896209717
Epoch: 64, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.555 Vali Acc: 0.809 Test Loss: 0.555 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.8904657363891602
Epoch: 65, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.553 Vali Acc: 0.816 Test Loss: 0.553 Test Acc: 0.816
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.1414945125579834
Epoch: 66, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.560 Vali Acc: 0.803 Test Loss: 0.560 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.1533401012420654
Epoch: 67, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.564 Vali Acc: 0.809 Test Loss: 0.564 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.1702260971069336
Epoch: 68, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.562 Vali Acc: 0.822 Test Loss: 0.562 Test Acc: 0.822
Validation loss decreased (-0.815784 --> -0.822363).  Saving model ...
Epoch: 69 cost time: 0.9095089435577393
Epoch: 69, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.9985971450805664
Epoch: 70, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.590 Vali Acc: 0.822 Test Loss: 0.590 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 1.0466747283935547
Epoch: 71, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.581 Vali Acc: 0.809 Test Loss: 0.581 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 1.094709873199463
Epoch: 72, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.582 Vali Acc: 0.816 Test Loss: 0.582 Test Acc: 0.816
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 1.0905990600585938
Epoch: 73, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.581 Vali Acc: 0.816 Test Loss: 0.581 Test Acc: 0.816
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 1.0565500259399414
Epoch: 74, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.609 Vali Acc: 0.796 Test Loss: 0.609 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 1.0220799446105957
Epoch: 75, Steps: 10 | Train Loss: 0.012 Vali Loss: 0.613 Vali Acc: 0.809 Test Loss: 0.613 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 1.0476787090301514
Epoch: 76, Steps: 10 | Train Loss: 0.009 Vali Loss: 0.617 Vali Acc: 0.816 Test Loss: 0.617 Test Acc: 0.816
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 1.1171298027038574
Epoch: 77, Steps: 10 | Train Loss: 0.007 Vali Loss: 0.637 Vali Acc: 0.809 Test Loss: 0.637 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.113356351852417
Epoch: 78, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.631 Vali Acc: 0.822 Test Loss: 0.631 Test Acc: 0.822
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8223684210526315
model parameter : 255900
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.277684450149536
Epoch: 1, Steps: 10 | Train Loss: 1.493 Vali Loss: 1.438 Vali Acc: 0.270 Test Loss: 1.438 Test Acc: 0.270
Validation loss decreased (inf --> -0.269722).  Saving model ...
Epoch: 2 cost time: 1.0662059783935547
Epoch: 2, Steps: 10 | Train Loss: 1.404 Vali Loss: 1.377 Vali Acc: 0.283 Test Loss: 1.377 Test Acc: 0.283
Validation loss decreased (-0.269722 --> -0.282881).  Saving model ...
Epoch: 3 cost time: 1.1158370971679688
Epoch: 3, Steps: 10 | Train Loss: 1.371 Vali Loss: 1.359 Vali Acc: 0.303 Test Loss: 1.359 Test Acc: 0.303
Validation loss decreased (-0.282881 --> -0.302618).  Saving model ...
Epoch: 4 cost time: 0.9271054267883301
Epoch: 4, Steps: 10 | Train Loss: 1.354 Vali Loss: 1.316 Vali Acc: 0.349 Test Loss: 1.316 Test Acc: 0.349
Validation loss decreased (-0.302618 --> -0.348671).  Saving model ...
Epoch: 5 cost time: 0.8979549407958984
Epoch: 5, Steps: 10 | Train Loss: 1.277 Vali Loss: 1.283 Vali Acc: 0.447 Test Loss: 1.283 Test Acc: 0.447
Validation loss decreased (-0.348671 --> -0.447356).  Saving model ...
Epoch: 6 cost time: 0.9147472381591797
Epoch: 6, Steps: 10 | Train Loss: 1.244 Vali Loss: 1.248 Vali Acc: 0.454 Test Loss: 1.248 Test Acc: 0.454
Validation loss decreased (-0.447356 --> -0.453935).  Saving model ...
Epoch: 7 cost time: 0.8872535228729248
Epoch: 7, Steps: 10 | Train Loss: 1.147 Vali Loss: 1.190 Vali Acc: 0.507 Test Loss: 1.190 Test Acc: 0.507
Validation loss decreased (-0.453935 --> -0.506567).  Saving model ...
Epoch: 8 cost time: 1.0016062259674072
Epoch: 8, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.144 Vali Acc: 0.513 Test Loss: 1.144 Test Acc: 0.513
Validation loss decreased (-0.506567 --> -0.513146).  Saving model ...
Epoch: 9 cost time: 0.9113280773162842
Epoch: 9, Steps: 10 | Train Loss: 1.039 Vali Loss: 1.108 Vali Acc: 0.553 Test Loss: 1.108 Test Acc: 0.553
Validation loss decreased (-0.513146 --> -0.552620).  Saving model ...
Epoch: 10 cost time: 1.1389472484588623
Epoch: 10, Steps: 10 | Train Loss: 0.963 Vali Loss: 1.036 Vali Acc: 0.586 Test Loss: 1.036 Test Acc: 0.586
Validation loss decreased (-0.552620 --> -0.585516).  Saving model ...
Epoch: 11 cost time: 0.9977948665618896
Epoch: 11, Steps: 10 | Train Loss: 0.906 Vali Loss: 0.992 Vali Acc: 0.592 Test Loss: 0.992 Test Acc: 0.592
Validation loss decreased (-0.585516 --> -0.592095).  Saving model ...
Epoch: 12 cost time: 0.9343504905700684
Epoch: 12, Steps: 10 | Train Loss: 0.826 Vali Loss: 0.934 Vali Acc: 0.592 Test Loss: 0.934 Test Acc: 0.592
Validation loss decreased (-0.592095 --> -0.592096).  Saving model ...
Epoch: 13 cost time: 1.117224931716919
Epoch: 13, Steps: 10 | Train Loss: 0.744 Vali Loss: 0.873 Vali Acc: 0.645 Test Loss: 0.873 Test Acc: 0.645
Validation loss decreased (-0.592096 --> -0.644728).  Saving model ...
Epoch: 14 cost time: 0.9917938709259033
Epoch: 14, Steps: 10 | Train Loss: 0.682 Vali Loss: 0.811 Vali Acc: 0.632 Test Loss: 0.811 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0175490379333496
Epoch: 15, Steps: 10 | Train Loss: 0.624 Vali Loss: 0.761 Vali Acc: 0.724 Test Loss: 0.761 Test Acc: 0.724
Validation loss decreased (-0.644728 --> -0.723677).  Saving model ...
Epoch: 16 cost time: 0.9591217041015625
Epoch: 16, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.705 Vali Acc: 0.691 Test Loss: 0.705 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1410205364227295
Epoch: 17, Steps: 10 | Train Loss: 0.466 Vali Loss: 0.663 Vali Acc: 0.743 Test Loss: 0.663 Test Acc: 0.743
Validation loss decreased (-0.723677 --> -0.743414).  Saving model ...
Epoch: 18 cost time: 0.8705744743347168
Epoch: 18, Steps: 10 | Train Loss: 0.448 Vali Loss: 0.629 Vali Acc: 0.737 Test Loss: 0.629 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.92403244972229
Epoch: 19, Steps: 10 | Train Loss: 0.393 Vali Loss: 0.599 Vali Acc: 0.763 Test Loss: 0.599 Test Acc: 0.763
Validation loss decreased (-0.743414 --> -0.763152).  Saving model ...
Epoch: 20 cost time: 0.8975653648376465
Epoch: 20, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.568 Vali Acc: 0.770 Test Loss: 0.568 Test Acc: 0.770
Validation loss decreased (-0.763152 --> -0.769731).  Saving model ...
Epoch: 21 cost time: 1.0140211582183838
Epoch: 21, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2749552726745605
Epoch: 22, Steps: 10 | Train Loss: 0.302 Vali Loss: 0.535 Vali Acc: 0.763 Test Loss: 0.535 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0403320789337158
Epoch: 23, Steps: 10 | Train Loss: 0.248 Vali Loss: 0.517 Vali Acc: 0.763 Test Loss: 0.517 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.161316156387329
Epoch: 24, Steps: 10 | Train Loss: 0.266 Vali Loss: 0.508 Vali Acc: 0.763 Test Loss: 0.508 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0355141162872314
Epoch: 25, Steps: 10 | Train Loss: 0.227 Vali Loss: 0.491 Vali Acc: 0.776 Test Loss: 0.491 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776311).  Saving model ...
Epoch: 26 cost time: 0.80130934715271
Epoch: 26, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.482 Vali Acc: 0.763 Test Loss: 0.482 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9750587940216064
Epoch: 27, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.475 Vali Acc: 0.776 Test Loss: 0.475 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 28 cost time: 1.1231060028076172
Epoch: 28, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.470 Vali Acc: 0.776 Test Loss: 0.470 Test Acc: 0.776
Validation loss decreased (-0.776311 --> -0.776311).  Saving model ...
Epoch: 29 cost time: 1.0254640579223633
Epoch: 29, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.472 Vali Acc: 0.770 Test Loss: 0.472 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.136305809020996
Epoch: 30, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.465 Vali Acc: 0.770 Test Loss: 0.465 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8806157112121582
Epoch: 31, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.460 Vali Acc: 0.809 Test Loss: 0.460 Test Acc: 0.809
Validation loss decreased (-0.776311 --> -0.809206).  Saving model ...
Epoch: 32 cost time: 1.3699707984924316
Epoch: 32, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.463 Vali Acc: 0.809 Test Loss: 0.463 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1603035926818848
Epoch: 33, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.467 Vali Acc: 0.783 Test Loss: 0.467 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0875184535980225
Epoch: 34, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.479 Vali Acc: 0.776 Test Loss: 0.479 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8973760604858398
Epoch: 35, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.473 Vali Acc: 0.803 Test Loss: 0.473 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0219378471374512
Epoch: 36, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.465 Vali Acc: 0.809 Test Loss: 0.465 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.028907299041748
Epoch: 37, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.477 Vali Acc: 0.776 Test Loss: 0.477 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.985832691192627
Epoch: 38, Steps: 10 | Train Loss: 0.081 Vali Loss: 0.482 Vali Acc: 0.796 Test Loss: 0.482 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.2164943218231201
Epoch: 39, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.487 Vali Acc: 0.803 Test Loss: 0.487 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0933895111083984
Epoch: 40, Steps: 10 | Train Loss: 0.059 Vali Loss: 0.494 Vali Acc: 0.816 Test Loss: 0.494 Test Acc: 0.816
Validation loss decreased (-0.809206 --> -0.815785).  Saving model ...
Epoch: 41 cost time: 1.0055465698242188
Epoch: 41, Steps: 10 | Train Loss: 0.067 Vali Loss: 0.497 Vali Acc: 0.789 Test Loss: 0.497 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1907780170440674
Epoch: 42, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.489 Vali Acc: 0.816 Test Loss: 0.489 Test Acc: 0.816
Validation loss decreased (-0.815785 --> -0.815785).  Saving model ...
Epoch: 43 cost time: 0.9786746501922607
Epoch: 43, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.501 Vali Acc: 0.783 Test Loss: 0.501 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.873159646987915
Epoch: 44, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.491 Vali Acc: 0.829 Test Loss: 0.491 Test Acc: 0.829
Validation loss decreased (-0.815785 --> -0.828942).  Saving model ...
Epoch: 45 cost time: 1.0553438663482666
Epoch: 45, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.486 Vali Acc: 0.816 Test Loss: 0.486 Test Acc: 0.816
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.2382471561431885
Epoch: 46, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.494 Vali Acc: 0.803 Test Loss: 0.494 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0460376739501953
Epoch: 47, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.502 Vali Acc: 0.803 Test Loss: 0.502 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.14003586769104
Epoch: 48, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.508 Vali Acc: 0.822 Test Loss: 0.508 Test Acc: 0.822
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.0585460662841797
Epoch: 49, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.510 Vali Acc: 0.809 Test Loss: 0.510 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1399040222167969
Epoch: 50, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.512 Vali Acc: 0.803 Test Loss: 0.512 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.0686259269714355
Epoch: 51, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.527 Vali Acc: 0.822 Test Loss: 0.527 Test Acc: 0.822
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.159776210784912
Epoch: 52, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.537 Vali Acc: 0.776 Test Loss: 0.537 Test Acc: 0.776
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.102855920791626
Epoch: 53, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.545 Vali Acc: 0.789 Test Loss: 0.545 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.0800142288208008
Epoch: 54, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.549 Vali Acc: 0.809 Test Loss: 0.549 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8289473684210527
model parameter : 255804
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.8081305027008057
Epoch: 1, Steps: 10 | Train Loss: 1.543 Vali Loss: 1.494 Vali Acc: 0.250 Test Loss: 1.494 Test Acc: 0.250
Validation loss decreased (inf --> -0.249985).  Saving model ...
Epoch: 2 cost time: 0.8768253326416016
Epoch: 2, Steps: 10 | Train Loss: 1.465 Vali Loss: 1.450 Vali Acc: 0.243 Test Loss: 1.450 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9301025867462158
Epoch: 3, Steps: 10 | Train Loss: 1.422 Vali Loss: 1.421 Vali Acc: 0.276 Test Loss: 1.421 Test Acc: 0.276
Validation loss decreased (-0.249985 --> -0.276302).  Saving model ...
Epoch: 4 cost time: 0.8463528156280518
Epoch: 4, Steps: 10 | Train Loss: 1.406 Vali Loss: 1.392 Vali Acc: 0.309 Test Loss: 1.392 Test Acc: 0.309
Validation loss decreased (-0.276302 --> -0.309197).  Saving model ...
Epoch: 5 cost time: 0.9888722896575928
Epoch: 5, Steps: 10 | Train Loss: 1.356 Vali Loss: 1.362 Vali Acc: 0.329 Test Loss: 1.362 Test Acc: 0.329
Validation loss decreased (-0.309197 --> -0.328934).  Saving model ...
Epoch: 6 cost time: 1.109166145324707
Epoch: 6, Steps: 10 | Train Loss: 1.331 Vali Loss: 1.330 Vali Acc: 0.388 Test Loss: 1.330 Test Acc: 0.388
Validation loss decreased (-0.328934 --> -0.388145).  Saving model ...
Epoch: 7 cost time: 0.8461039066314697
Epoch: 7, Steps: 10 | Train Loss: 1.260 Vali Loss: 1.289 Vali Acc: 0.467 Test Loss: 1.289 Test Acc: 0.467
Validation loss decreased (-0.388145 --> -0.467092).  Saving model ...
Epoch: 8 cost time: 0.9741940498352051
Epoch: 8, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.258 Vali Acc: 0.474 Test Loss: 1.258 Test Acc: 0.474
Validation loss decreased (-0.467092 --> -0.473672).  Saving model ...
Epoch: 9 cost time: 0.7846794128417969
Epoch: 9, Steps: 10 | Train Loss: 1.141 Vali Loss: 1.216 Vali Acc: 0.566 Test Loss: 1.216 Test Acc: 0.566
Validation loss decreased (-0.473672 --> -0.565777).  Saving model ...
Epoch: 10 cost time: 0.7829179763793945
Epoch: 10, Steps: 10 | Train Loss: 1.127 Vali Loss: 1.174 Vali Acc: 0.599 Test Loss: 1.174 Test Acc: 0.599
Validation loss decreased (-0.565777 --> -0.598672).  Saving model ...
Epoch: 11 cost time: 0.9947290420532227
Epoch: 11, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.137 Vali Acc: 0.559 Test Loss: 1.137 Test Acc: 0.559
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1729776859283447
Epoch: 12, Steps: 10 | Train Loss: 0.982 Vali Loss: 1.095 Vali Acc: 0.599 Test Loss: 1.095 Test Acc: 0.599
Validation loss decreased (-0.598672 --> -0.598673).  Saving model ...
Epoch: 13 cost time: 0.8697824478149414
Epoch: 13, Steps: 10 | Train Loss: 0.917 Vali Loss: 1.052 Vali Acc: 0.592 Test Loss: 1.052 Test Acc: 0.592
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2756831645965576
Epoch: 14, Steps: 10 | Train Loss: 0.842 Vali Loss: 1.009 Vali Acc: 0.618 Test Loss: 1.009 Test Acc: 0.618
Validation loss decreased (-0.598673 --> -0.618411).  Saving model ...
Epoch: 15 cost time: 1.0106663703918457
Epoch: 15, Steps: 10 | Train Loss: 0.802 Vali Loss: 0.965 Vali Acc: 0.625 Test Loss: 0.965 Test Acc: 0.625
Validation loss decreased (-0.618411 --> -0.624990).  Saving model ...
Epoch: 16 cost time: 1.0969083309173584
Epoch: 16, Steps: 10 | Train Loss: 0.735 Vali Loss: 0.921 Vali Acc: 0.651 Test Loss: 0.921 Test Acc: 0.651
Validation loss decreased (-0.624990 --> -0.651307).  Saving model ...
Epoch: 17 cost time: 1.0860934257507324
Epoch: 17, Steps: 10 | Train Loss: 0.680 Vali Loss: 0.885 Vali Acc: 0.625 Test Loss: 0.885 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9869816303253174
Epoch: 18, Steps: 10 | Train Loss: 0.654 Vali Loss: 0.841 Vali Acc: 0.651 Test Loss: 0.841 Test Acc: 0.651
Validation loss decreased (-0.651307 --> -0.651307).  Saving model ...
Epoch: 19 cost time: 0.8063983917236328
Epoch: 19, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.811 Vali Acc: 0.645 Test Loss: 0.811 Test Acc: 0.645
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8900060653686523
Epoch: 20, Steps: 10 | Train Loss: 0.524 Vali Loss: 0.769 Vali Acc: 0.678 Test Loss: 0.769 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677624).  Saving model ...
Epoch: 21 cost time: 0.8442144393920898
Epoch: 21, Steps: 10 | Train Loss: 0.498 Vali Loss: 0.738 Vali Acc: 0.684 Test Loss: 0.738 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 22 cost time: 0.8746757507324219
Epoch: 22, Steps: 10 | Train Loss: 0.449 Vali Loss: 0.710 Vali Acc: 0.691 Test Loss: 0.710 Test Acc: 0.691
Validation loss decreased (-0.684203 --> -0.690782).  Saving model ...
Epoch: 23 cost time: 0.8863315582275391
Epoch: 23, Steps: 10 | Train Loss: 0.396 Vali Loss: 0.678 Vali Acc: 0.730 Test Loss: 0.678 Test Acc: 0.730
Validation loss decreased (-0.690782 --> -0.730256).  Saving model ...
Epoch: 24 cost time: 1.035804033279419
Epoch: 24, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.656 Vali Acc: 0.717 Test Loss: 0.656 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9843614101409912
Epoch: 25, Steps: 10 | Train Loss: 0.309 Vali Loss: 0.637 Vali Acc: 0.711 Test Loss: 0.637 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9425404071807861
Epoch: 26, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.612 Vali Acc: 0.763 Test Loss: 0.612 Test Acc: 0.763
Validation loss decreased (-0.730256 --> -0.763152).  Saving model ...
Epoch: 27 cost time: 0.9913773536682129
Epoch: 27, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.597 Vali Acc: 0.730 Test Loss: 0.597 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9485507011413574
Epoch: 28, Steps: 10 | Train Loss: 0.255 Vali Loss: 0.586 Vali Acc: 0.743 Test Loss: 0.586 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8790667057037354
Epoch: 29, Steps: 10 | Train Loss: 0.244 Vali Loss: 0.562 Vali Acc: 0.750 Test Loss: 0.562 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.015209436416626
Epoch: 30, Steps: 10 | Train Loss: 0.209 Vali Loss: 0.562 Vali Acc: 0.763 Test Loss: 0.562 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 31 cost time: 0.8972928524017334
Epoch: 31, Steps: 10 | Train Loss: 0.205 Vali Loss: 0.549 Vali Acc: 0.750 Test Loss: 0.549 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0338408946990967
Epoch: 32, Steps: 10 | Train Loss: 0.177 Vali Loss: 0.545 Vali Acc: 0.750 Test Loss: 0.545 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8918275833129883
Epoch: 33, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.543 Vali Acc: 0.757 Test Loss: 0.543 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9917762279510498
Epoch: 34, Steps: 10 | Train Loss: 0.145 Vali Loss: 0.530 Vali Acc: 0.776 Test Loss: 0.530 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776310).  Saving model ...
Epoch: 35 cost time: 0.8389551639556885
Epoch: 35, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.522 Vali Acc: 0.763 Test Loss: 0.522 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9473950862884521
Epoch: 36, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 37 cost time: 0.9612727165222168
Epoch: 37, Steps: 10 | Train Loss: 0.123 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3043196201324463
Epoch: 38, Steps: 10 | Train Loss: 0.106 Vali Loss: 0.527 Vali Acc: 0.776 Test Loss: 0.527 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0040538311004639
Epoch: 39, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.2752573490142822
Epoch: 40, Steps: 10 | Train Loss: 0.105 Vali Loss: 0.526 Vali Acc: 0.757 Test Loss: 0.526 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.071441650390625
Epoch: 41, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.521 Vali Acc: 0.783 Test Loss: 0.521 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 42 cost time: 1.0819284915924072
Epoch: 42, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.522 Vali Acc: 0.763 Test Loss: 0.522 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1173360347747803
Epoch: 43, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.531 Vali Acc: 0.763 Test Loss: 0.531 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0763967037200928
Epoch: 44, Steps: 10 | Train Loss: 0.082 Vali Loss: 0.542 Vali Acc: 0.789 Test Loss: 0.542 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789468).  Saving model ...
Epoch: 45 cost time: 1.0311698913574219
Epoch: 45, Steps: 10 | Train Loss: 0.068 Vali Loss: 0.546 Vali Acc: 0.776 Test Loss: 0.546 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9520978927612305
Epoch: 46, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.546 Vali Acc: 0.757 Test Loss: 0.546 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0089497566223145
Epoch: 47, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.548 Vali Acc: 0.757 Test Loss: 0.548 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.891735315322876
Epoch: 48, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.545 Vali Acc: 0.763 Test Loss: 0.545 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.1515281200408936
Epoch: 49, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.543 Vali Acc: 0.770 Test Loss: 0.543 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.104473352432251
Epoch: 50, Steps: 10 | Train Loss: 0.057 Vali Loss: 0.546 Vali Acc: 0.763 Test Loss: 0.546 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9997220039367676
Epoch: 51, Steps: 10 | Train Loss: 0.055 Vali Loss: 0.551 Vali Acc: 0.757 Test Loss: 0.551 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.1755363941192627
Epoch: 52, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.2749290466308594
Epoch: 53, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.567 Vali Acc: 0.783 Test Loss: 0.567 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 1.1166863441467285
Epoch: 54, Steps: 10 | Train Loss: 0.047 Vali Loss: 0.572 Vali Acc: 0.770 Test Loss: 0.572 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 156252
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.2124316692352295
Epoch: 1, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.349 Vali Acc: 0.375 Test Loss: 1.349 Test Acc: 0.375
Validation loss decreased (inf --> -0.374987).  Saving model ...
Epoch: 2 cost time: 1.2506353855133057
Epoch: 2, Steps: 10 | Train Loss: 1.399 Vali Loss: 1.337 Vali Acc: 0.316 Test Loss: 1.337 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1160597801208496
Epoch: 3, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.323 Vali Acc: 0.270 Test Loss: 1.323 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9728050231933594
Epoch: 4, Steps: 10 | Train Loss: 1.317 Vali Loss: 1.298 Vali Acc: 0.362 Test Loss: 1.298 Test Acc: 0.362
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3253843784332275
Epoch: 5, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.264 Vali Acc: 0.480 Test Loss: 1.264 Test Acc: 0.480
Validation loss decreased (-0.374987 --> -0.480251).  Saving model ...
Epoch: 6 cost time: 0.9826266765594482
Epoch: 6, Steps: 10 | Train Loss: 1.202 Vali Loss: 1.229 Vali Acc: 0.553 Test Loss: 1.229 Test Acc: 0.553
Validation loss decreased (-0.480251 --> -0.552619).  Saving model ...
Epoch: 7 cost time: 1.2575812339782715
Epoch: 7, Steps: 10 | Train Loss: 1.198 Vali Loss: 1.200 Vali Acc: 0.539 Test Loss: 1.200 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0141444206237793
Epoch: 8, Steps: 10 | Train Loss: 1.157 Vali Loss: 1.161 Vali Acc: 0.539 Test Loss: 1.161 Test Acc: 0.539
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2679152488708496
Epoch: 9, Steps: 10 | Train Loss: 1.090 Vali Loss: 1.134 Vali Acc: 0.572 Test Loss: 1.134 Test Acc: 0.572
Validation loss decreased (-0.552619 --> -0.572357).  Saving model ...
Epoch: 10 cost time: 1.002002477645874
Epoch: 10, Steps: 10 | Train Loss: 1.030 Vali Loss: 1.097 Vali Acc: 0.572 Test Loss: 1.097 Test Acc: 0.572
Validation loss decreased (-0.572357 --> -0.572357).  Saving model ...
Epoch: 11 cost time: 1.2491300106048584
Epoch: 11, Steps: 10 | Train Loss: 0.983 Vali Loss: 1.055 Vali Acc: 0.586 Test Loss: 1.055 Test Acc: 0.586
Validation loss decreased (-0.572357 --> -0.585516).  Saving model ...
Epoch: 12 cost time: 1.2208569049835205
Epoch: 12, Steps: 10 | Train Loss: 0.923 Vali Loss: 1.020 Vali Acc: 0.592 Test Loss: 1.020 Test Acc: 0.592
Validation loss decreased (-0.585516 --> -0.592095).  Saving model ...
Epoch: 13 cost time: 1.2778286933898926
Epoch: 13, Steps: 10 | Train Loss: 0.855 Vali Loss: 0.980 Vali Acc: 0.592 Test Loss: 0.980 Test Acc: 0.592
Validation loss decreased (-0.592095 --> -0.592095).  Saving model ...
Epoch: 14 cost time: 1.2808988094329834
Epoch: 14, Steps: 10 | Train Loss: 0.804 Vali Loss: 0.937 Vali Acc: 0.612 Test Loss: 0.937 Test Acc: 0.612
Validation loss decreased (-0.592095 --> -0.611833).  Saving model ...
Epoch: 15 cost time: 0.9597866535186768
Epoch: 15, Steps: 10 | Train Loss: 0.709 Vali Loss: 0.892 Vali Acc: 0.618 Test Loss: 0.892 Test Acc: 0.618
Validation loss decreased (-0.611833 --> -0.618412).  Saving model ...
Epoch: 16 cost time: 1.244678020477295
Epoch: 16, Steps: 10 | Train Loss: 0.708 Vali Loss: 0.852 Vali Acc: 0.632 Test Loss: 0.852 Test Acc: 0.632
Validation loss decreased (-0.618412 --> -0.631570).  Saving model ...
Epoch: 17 cost time: 1.292525053024292
Epoch: 17, Steps: 10 | Train Loss: 0.641 Vali Loss: 0.809 Vali Acc: 0.684 Test Loss: 0.809 Test Acc: 0.684
Validation loss decreased (-0.631570 --> -0.684202).  Saving model ...
Epoch: 18 cost time: 1.0765080451965332
Epoch: 18, Steps: 10 | Train Loss: 0.612 Vali Loss: 0.769 Vali Acc: 0.651 Test Loss: 0.769 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0646202564239502
Epoch: 19, Steps: 10 | Train Loss: 0.534 Vali Loss: 0.732 Vali Acc: 0.697 Test Loss: 0.732 Test Acc: 0.697
Validation loss decreased (-0.684202 --> -0.697361).  Saving model ...
Epoch: 20 cost time: 0.9857943058013916
Epoch: 20, Steps: 10 | Train Loss: 0.489 Vali Loss: 0.699 Vali Acc: 0.704 Test Loss: 0.699 Test Acc: 0.704
Validation loss decreased (-0.697361 --> -0.703940).  Saving model ...
Epoch: 21 cost time: 1.0597290992736816
Epoch: 21, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.663 Vali Acc: 0.737 Test Loss: 0.663 Test Acc: 0.737
Validation loss decreased (-0.703940 --> -0.736835).  Saving model ...
Epoch: 22 cost time: 1.1392831802368164
Epoch: 22, Steps: 10 | Train Loss: 0.398 Vali Loss: 0.637 Vali Acc: 0.711 Test Loss: 0.637 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0370564460754395
Epoch: 23, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.613 Vali Acc: 0.757 Test Loss: 0.613 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756573).  Saving model ...
Epoch: 24 cost time: 0.9923281669616699
Epoch: 24, Steps: 10 | Train Loss: 0.334 Vali Loss: 0.593 Vali Acc: 0.750 Test Loss: 0.593 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.2361865043640137
Epoch: 25, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.568 Vali Acc: 0.763 Test Loss: 0.568 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 26 cost time: 1.2524182796478271
Epoch: 26, Steps: 10 | Train Loss: 0.264 Vali Loss: 0.554 Vali Acc: 0.763 Test Loss: 0.554 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763152).  Saving model ...
Epoch: 27 cost time: 1.1939432621002197
Epoch: 27, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.537 Vali Acc: 0.750 Test Loss: 0.537 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.3422188758850098
Epoch: 28, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.525 Vali Acc: 0.763 Test Loss: 0.525 Test Acc: 0.763
Validation loss decreased (-0.763152 --> -0.763153).  Saving model ...
Epoch: 29 cost time: 1.1025035381317139
Epoch: 29, Steps: 10 | Train Loss: 0.189 Vali Loss: 0.520 Vali Acc: 0.770 Test Loss: 0.520 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 30 cost time: 1.2915661334991455
Epoch: 30, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.524 Vali Acc: 0.763 Test Loss: 0.524 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.226405382156372
Epoch: 31, Steps: 10 | Train Loss: 0.172 Vali Loss: 0.504 Vali Acc: 0.776 Test Loss: 0.504 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 32 cost time: 1.2574005126953125
Epoch: 32, Steps: 10 | Train Loss: 0.155 Vali Loss: 0.498 Vali Acc: 0.783 Test Loss: 0.498 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 33 cost time: 1.2416601181030273
Epoch: 33, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.503 Vali Acc: 0.770 Test Loss: 0.503 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.3283796310424805
Epoch: 34, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.496 Vali Acc: 0.783 Test Loss: 0.496 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 35 cost time: 1.1002295017242432
Epoch: 35, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.494 Vali Acc: 0.776 Test Loss: 0.494 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.895780086517334
Epoch: 36, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.492 Vali Acc: 0.776 Test Loss: 0.492 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9981615543365479
Epoch: 37, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.499 Vali Acc: 0.776 Test Loss: 0.499 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.171227216720581
Epoch: 38, Steps: 10 | Train Loss: 0.101 Vali Loss: 0.503 Vali Acc: 0.776 Test Loss: 0.503 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0697853565216064
Epoch: 39, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.503 Vali Acc: 0.783 Test Loss: 0.503 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0319411754608154
Epoch: 40, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.509 Vali Acc: 0.770 Test Loss: 0.509 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.1403837203979492
Epoch: 41, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.511 Vali Acc: 0.783 Test Loss: 0.511 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.1219556331634521
Epoch: 42, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.508 Vali Acc: 0.757 Test Loss: 0.508 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.4940290451049805
Epoch: 43, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.517 Vali Acc: 0.763 Test Loss: 0.517 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.0704007148742676
Epoch: 44, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.525 Vali Acc: 0.776 Test Loss: 0.525 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7828947368421053
model parameter : 156156
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.309004545211792
Epoch: 1, Steps: 10 | Train Loss: 1.454 Vali Loss: 1.436 Vali Acc: 0.243 Test Loss: 1.436 Test Acc: 0.243
Validation loss decreased (inf --> -0.243407).  Saving model ...
Epoch: 2 cost time: 1.0787417888641357
Epoch: 2, Steps: 10 | Train Loss: 1.414 Vali Loss: 1.413 Vali Acc: 0.263 Test Loss: 1.413 Test Acc: 0.263
Validation loss decreased (-0.243407 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 0.7895817756652832
Epoch: 3, Steps: 10 | Train Loss: 1.340 Vali Loss: 1.390 Vali Acc: 0.322 Test Loss: 1.390 Test Acc: 0.322
Validation loss decreased (-0.263144 --> -0.322355).  Saving model ...
Epoch: 4 cost time: 0.8683147430419922
Epoch: 4, Steps: 10 | Train Loss: 1.314 Vali Loss: 1.371 Vali Acc: 0.296 Test Loss: 1.371 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9406082630157471
Epoch: 5, Steps: 10 | Train Loss: 1.319 Vali Loss: 1.336 Vali Acc: 0.362 Test Loss: 1.336 Test Acc: 0.362
Validation loss decreased (-0.322355 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 1.0446703433990479
Epoch: 6, Steps: 10 | Train Loss: 1.237 Vali Loss: 1.303 Vali Acc: 0.382 Test Loss: 1.303 Test Acc: 0.382
Validation loss decreased (-0.361829 --> -0.381566).  Saving model ...
Epoch: 7 cost time: 0.8911335468292236
Epoch: 7, Steps: 10 | Train Loss: 1.214 Vali Loss: 1.272 Vali Acc: 0.467 Test Loss: 1.272 Test Acc: 0.467
Validation loss decreased (-0.381566 --> -0.467093).  Saving model ...
Epoch: 8 cost time: 1.0914158821105957
Epoch: 8, Steps: 10 | Train Loss: 1.135 Vali Loss: 1.236 Vali Acc: 0.513 Test Loss: 1.236 Test Acc: 0.513
Validation loss decreased (-0.467093 --> -0.513146).  Saving model ...
Epoch: 9 cost time: 0.8329465389251709
Epoch: 9, Steps: 10 | Train Loss: 1.119 Vali Loss: 1.201 Vali Acc: 0.493 Test Loss: 1.201 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0820813179016113
Epoch: 10, Steps: 10 | Train Loss: 1.033 Vali Loss: 1.160 Vali Acc: 0.566 Test Loss: 1.160 Test Acc: 0.566
Validation loss decreased (-0.513146 --> -0.565778).  Saving model ...
Epoch: 11 cost time: 1.0537757873535156
Epoch: 11, Steps: 10 | Train Loss: 0.985 Vali Loss: 1.121 Vali Acc: 0.572 Test Loss: 1.121 Test Acc: 0.572
Validation loss decreased (-0.565778 --> -0.572357).  Saving model ...
Epoch: 12 cost time: 0.9957082271575928
Epoch: 12, Steps: 10 | Train Loss: 0.931 Vali Loss: 1.086 Vali Acc: 0.586 Test Loss: 1.086 Test Acc: 0.586
Validation loss decreased (-0.572357 --> -0.585515).  Saving model ...
Epoch: 13 cost time: 0.9474320411682129
Epoch: 13, Steps: 10 | Train Loss: 0.887 Vali Loss: 1.041 Vali Acc: 0.599 Test Loss: 1.041 Test Acc: 0.599
Validation loss decreased (-0.585515 --> -0.598674).  Saving model ...
Epoch: 14 cost time: 1.1661369800567627
Epoch: 14, Steps: 10 | Train Loss: 0.837 Vali Loss: 0.994 Vali Acc: 0.632 Test Loss: 0.994 Test Acc: 0.632
Validation loss decreased (-0.598674 --> -0.631569).  Saving model ...
Epoch: 15 cost time: 1.0102698802947998
Epoch: 15, Steps: 10 | Train Loss: 0.783 Vali Loss: 0.950 Vali Acc: 0.658 Test Loss: 0.950 Test Acc: 0.658
Validation loss decreased (-0.631569 --> -0.657885).  Saving model ...
Epoch: 16 cost time: 1.027143955230713
Epoch: 16, Steps: 10 | Train Loss: 0.726 Vali Loss: 0.910 Vali Acc: 0.632 Test Loss: 0.910 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0439732074737549
Epoch: 17, Steps: 10 | Train Loss: 0.695 Vali Loss: 0.864 Vali Acc: 0.651 Test Loss: 0.864 Test Acc: 0.651
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0920379161834717
Epoch: 18, Steps: 10 | Train Loss: 0.592 Vali Loss: 0.824 Vali Acc: 0.664 Test Loss: 0.824 Test Acc: 0.664
Validation loss decreased (-0.657885 --> -0.664465).  Saving model ...
Epoch: 19 cost time: 1.064943790435791
Epoch: 19, Steps: 10 | Train Loss: 0.561 Vali Loss: 0.778 Vali Acc: 0.678 Test Loss: 0.778 Test Acc: 0.678
Validation loss decreased (-0.664465 --> -0.677624).  Saving model ...
Epoch: 20 cost time: 1.0314388275146484
Epoch: 20, Steps: 10 | Train Loss: 0.495 Vali Loss: 0.736 Vali Acc: 0.684 Test Loss: 0.736 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 21 cost time: 0.9733927249908447
Epoch: 21, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.704 Vali Acc: 0.697 Test Loss: 0.704 Test Acc: 0.697
Validation loss decreased (-0.684203 --> -0.697361).  Saving model ...
Epoch: 22 cost time: 1.1703393459320068
Epoch: 22, Steps: 10 | Train Loss: 0.412 Vali Loss: 0.673 Vali Acc: 0.684 Test Loss: 0.673 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.279221534729004
Epoch: 23, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.649 Vali Acc: 0.724 Test Loss: 0.649 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723678).  Saving model ...
Epoch: 24 cost time: 0.9277606010437012
Epoch: 24, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.624 Vali Acc: 0.724 Test Loss: 0.624 Test Acc: 0.724
Validation loss decreased (-0.723678 --> -0.723678).  Saving model ...
Epoch: 25 cost time: 0.8297789096832275
Epoch: 25, Steps: 10 | Train Loss: 0.324 Vali Loss: 0.614 Vali Acc: 0.743 Test Loss: 0.614 Test Acc: 0.743
Validation loss decreased (-0.723678 --> -0.743415).  Saving model ...
Epoch: 26 cost time: 0.9078092575073242
Epoch: 26, Steps: 10 | Train Loss: 0.275 Vali Loss: 0.587 Vali Acc: 0.743 Test Loss: 0.587 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 27 cost time: 0.9817793369293213
Epoch: 27, Steps: 10 | Train Loss: 0.281 Vali Loss: 0.572 Vali Acc: 0.743 Test Loss: 0.572 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743415).  Saving model ...
Epoch: 28 cost time: 0.8273353576660156
Epoch: 28, Steps: 10 | Train Loss: 0.250 Vali Loss: 0.561 Vali Acc: 0.737 Test Loss: 0.561 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1484408378601074
Epoch: 29, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.549 Vali Acc: 0.743 Test Loss: 0.549 Test Acc: 0.743
Validation loss decreased (-0.743415 --> -0.743416).  Saving model ...
Epoch: 30 cost time: 0.8878304958343506
Epoch: 30, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.541 Vali Acc: 0.750 Test Loss: 0.541 Test Acc: 0.750
Validation loss decreased (-0.743416 --> -0.749995).  Saving model ...
Epoch: 31 cost time: 1.0489304065704346
Epoch: 31, Steps: 10 | Train Loss: 0.178 Vali Loss: 0.535 Vali Acc: 0.730 Test Loss: 0.535 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0118403434753418
Epoch: 32, Steps: 10 | Train Loss: 0.173 Vali Loss: 0.531 Vali Acc: 0.757 Test Loss: 0.531 Test Acc: 0.757
Validation loss decreased (-0.749995 --> -0.756574).  Saving model ...
Epoch: 33 cost time: 0.9055590629577637
Epoch: 33, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.527 Vali Acc: 0.757 Test Loss: 0.527 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 34 cost time: 1.2074453830718994
Epoch: 34, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.523 Vali Acc: 0.757 Test Loss: 0.523 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 35 cost time: 0.9344594478607178
Epoch: 35, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.520 Vali Acc: 0.757 Test Loss: 0.520 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 36 cost time: 0.9736518859863281
Epoch: 36, Steps: 10 | Train Loss: 0.137 Vali Loss: 0.519 Vali Acc: 0.763 Test Loss: 0.519 Test Acc: 0.763
Validation loss decreased (-0.756574 --> -0.763153).  Saving model ...
Epoch: 37 cost time: 1.0064427852630615
Epoch: 37, Steps: 10 | Train Loss: 0.110 Vali Loss: 0.519 Vali Acc: 0.757 Test Loss: 0.519 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1538841724395752
Epoch: 38, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.517 Vali Acc: 0.763 Test Loss: 0.517 Test Acc: 0.763
Validation loss decreased (-0.763153 --> -0.763153).  Saving model ...
Epoch: 39 cost time: 1.2505335807800293
Epoch: 39, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.514 Vali Acc: 0.770 Test Loss: 0.514 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769732).  Saving model ...
Epoch: 40 cost time: 0.91973876953125
Epoch: 40, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.518 Vali Acc: 0.757 Test Loss: 0.518 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8814904689788818
Epoch: 41, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.519 Vali Acc: 0.776 Test Loss: 0.519 Test Acc: 0.776
Validation loss decreased (-0.769732 --> -0.776311).  Saving model ...
Epoch: 42 cost time: 0.7857308387756348
Epoch: 42, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.521 Vali Acc: 0.770 Test Loss: 0.521 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9381129741668701
Epoch: 43, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.523 Vali Acc: 0.770 Test Loss: 0.523 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.0135486125946045
Epoch: 44, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.541 Vali Acc: 0.757 Test Loss: 0.541 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0098800659179688
Epoch: 45, Steps: 10 | Train Loss: 0.074 Vali Loss: 0.557 Vali Acc: 0.783 Test Loss: 0.557 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 46 cost time: 0.8414151668548584
Epoch: 46, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.551 Vali Acc: 0.770 Test Loss: 0.551 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1195106506347656
Epoch: 47, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.547 Vali Acc: 0.770 Test Loss: 0.547 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8938004970550537
Epoch: 48, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.548 Vali Acc: 0.770 Test Loss: 0.548 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.229792594909668
Epoch: 49, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.556 Vali Acc: 0.783 Test Loss: 0.556 Test Acc: 0.783
Validation loss decreased (-0.782889 --> -0.782889).  Saving model ...
Epoch: 50 cost time: 1.3630075454711914
Epoch: 50, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.556 Vali Acc: 0.763 Test Loss: 0.556 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.2730677127838135
Epoch: 51, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.573 Vali Acc: 0.789 Test Loss: 0.573 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 52 cost time: 1.0628783702850342
Epoch: 52, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.571 Vali Acc: 0.783 Test Loss: 0.571 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.2210290431976318
Epoch: 53, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.577 Vali Acc: 0.789 Test Loss: 0.577 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.3512659072875977
Epoch: 54, Steps: 10 | Train Loss: 0.034 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.2497591972351074
Epoch: 55, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.607 Vali Acc: 0.776 Test Loss: 0.607 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 1.1734576225280762
Epoch: 56, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.622 Vali Acc: 0.783 Test Loss: 0.622 Test Acc: 0.783
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 1.073544979095459
Epoch: 57, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.618 Vali Acc: 0.776 Test Loss: 0.618 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.9436602592468262
Epoch: 58, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.648 Vali Acc: 0.783 Test Loss: 0.648 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.9553368091583252
Epoch: 59, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.631 Vali Acc: 0.770 Test Loss: 0.631 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.0649018287658691
Epoch: 60, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.638 Vali Acc: 0.783 Test Loss: 0.638 Test Acc: 0.783
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.0993006229400635
Epoch: 61, Steps: 10 | Train Loss: 0.016 Vali Loss: 0.637 Vali Acc: 0.776 Test Loss: 0.637 Test Acc: 0.776
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 156060
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7461934089660645
Epoch: 1, Steps: 10 | Train Loss: 1.532 Vali Loss: 1.494 Vali Acc: 0.289 Test Loss: 1.494 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 1.187361478805542
Epoch: 2, Steps: 10 | Train Loss: 1.506 Vali Loss: 1.471 Vali Acc: 0.336 Test Loss: 1.471 Test Acc: 0.336
Validation loss decreased (-0.289459 --> -0.335512).  Saving model ...
Epoch: 3 cost time: 1.0222210884094238
Epoch: 3, Steps: 10 | Train Loss: 1.481 Vali Loss: 1.442 Vali Acc: 0.296 Test Loss: 1.442 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1187360286712646
Epoch: 4, Steps: 10 | Train Loss: 1.451 Vali Loss: 1.412 Vali Acc: 0.336 Test Loss: 1.412 Test Acc: 0.336
Validation loss decreased (-0.335512 --> -0.335512).  Saving model ...
Epoch: 5 cost time: 1.1099989414215088
Epoch: 5, Steps: 10 | Train Loss: 1.393 Vali Loss: 1.383 Vali Acc: 0.368 Test Loss: 1.383 Test Acc: 0.368
Validation loss decreased (-0.335512 --> -0.368407).  Saving model ...
Epoch: 6 cost time: 0.979377269744873
Epoch: 6, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.351 Vali Acc: 0.395 Test Loss: 1.351 Test Acc: 0.395
Validation loss decreased (-0.368407 --> -0.394723).  Saving model ...
Epoch: 7 cost time: 1.2784779071807861
Epoch: 7, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.326 Vali Acc: 0.414 Test Loss: 1.326 Test Acc: 0.414
Validation loss decreased (-0.394723 --> -0.414460).  Saving model ...
Epoch: 8 cost time: 1.194415807723999
Epoch: 8, Steps: 10 | Train Loss: 1.268 Vali Loss: 1.291 Vali Acc: 0.461 Test Loss: 1.291 Test Acc: 0.461
Validation loss decreased (-0.414460 --> -0.460513).  Saving model ...
Epoch: 9 cost time: 1.1359479427337646
Epoch: 9, Steps: 10 | Train Loss: 1.218 Vali Loss: 1.252 Vali Acc: 0.493 Test Loss: 1.252 Test Acc: 0.493
Validation loss decreased (-0.460513 --> -0.493409).  Saving model ...
Epoch: 10 cost time: 1.1361761093139648
Epoch: 10, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.213 Vali Acc: 0.566 Test Loss: 1.213 Test Acc: 0.566
Validation loss decreased (-0.493409 --> -0.565777).  Saving model ...
Epoch: 11 cost time: 1.1419026851654053
Epoch: 11, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.181 Vali Acc: 0.586 Test Loss: 1.181 Test Acc: 0.586
Validation loss decreased (-0.565777 --> -0.585515).  Saving model ...
Epoch: 12 cost time: 1.2141060829162598
Epoch: 12, Steps: 10 | Train Loss: 1.052 Vali Loss: 1.141 Vali Acc: 0.572 Test Loss: 1.141 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2393105030059814
Epoch: 13, Steps: 10 | Train Loss: 0.991 Vali Loss: 1.083 Vali Acc: 0.632 Test Loss: 1.083 Test Acc: 0.632
Validation loss decreased (-0.585515 --> -0.631568).  Saving model ...
Epoch: 14 cost time: 1.4586949348449707
Epoch: 14, Steps: 10 | Train Loss: 0.924 Vali Loss: 1.053 Vali Acc: 0.625 Test Loss: 1.053 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2071304321289062
Epoch: 15, Steps: 10 | Train Loss: 0.847 Vali Loss: 0.999 Vali Acc: 0.612 Test Loss: 0.999 Test Acc: 0.612
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0421299934387207
Epoch: 16, Steps: 10 | Train Loss: 0.796 Vali Loss: 0.952 Vali Acc: 0.651 Test Loss: 0.952 Test Acc: 0.651
Validation loss decreased (-0.631568 --> -0.651306).  Saving model ...
Epoch: 17 cost time: 1.1520347595214844
Epoch: 17, Steps: 10 | Train Loss: 0.740 Vali Loss: 0.895 Vali Acc: 0.664 Test Loss: 0.895 Test Acc: 0.664
Validation loss decreased (-0.651306 --> -0.664465).  Saving model ...
Epoch: 18 cost time: 1.1947619915008545
Epoch: 18, Steps: 10 | Train Loss: 0.666 Vali Loss: 0.848 Vali Acc: 0.678 Test Loss: 0.848 Test Acc: 0.678
Validation loss decreased (-0.664465 --> -0.677623).  Saving model ...
Epoch: 19 cost time: 1.171006441116333
Epoch: 19, Steps: 10 | Train Loss: 0.601 Vali Loss: 0.801 Vali Acc: 0.704 Test Loss: 0.801 Test Acc: 0.704
Validation loss decreased (-0.677623 --> -0.703939).  Saving model ...
Epoch: 20 cost time: 1.3451979160308838
Epoch: 20, Steps: 10 | Train Loss: 0.536 Vali Loss: 0.752 Vali Acc: 0.737 Test Loss: 0.752 Test Acc: 0.737
Validation loss decreased (-0.703939 --> -0.736835).  Saving model ...
Epoch: 21 cost time: 1.0033857822418213
Epoch: 21, Steps: 10 | Train Loss: 0.484 Vali Loss: 0.711 Vali Acc: 0.711 Test Loss: 0.711 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0998375415802002
Epoch: 22, Steps: 10 | Train Loss: 0.443 Vali Loss: 0.674 Vali Acc: 0.783 Test Loss: 0.674 Test Acc: 0.783
Validation loss decreased (-0.736835 --> -0.782888).  Saving model ...
Epoch: 23 cost time: 1.0058114528656006
Epoch: 23, Steps: 10 | Train Loss: 0.402 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.196784496307373
Epoch: 24, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.611 Vali Acc: 0.743 Test Loss: 0.611 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1051955223083496
Epoch: 25, Steps: 10 | Train Loss: 0.296 Vali Loss: 0.587 Vali Acc: 0.770 Test Loss: 0.587 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2080867290496826
Epoch: 26, Steps: 10 | Train Loss: 0.290 Vali Loss: 0.563 Vali Acc: 0.770 Test Loss: 0.563 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.1793816089630127
Epoch: 27, Steps: 10 | Train Loss: 0.285 Vali Loss: 0.550 Vali Acc: 0.776 Test Loss: 0.550 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2095365524291992
Epoch: 28, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.534 Vali Acc: 0.789 Test Loss: 0.534 Test Acc: 0.789
Validation loss decreased (-0.782888 --> -0.789468).  Saving model ...
Epoch: 29 cost time: 1.3458459377288818
Epoch: 29, Steps: 10 | Train Loss: 0.233 Vali Loss: 0.507 Vali Acc: 0.796 Test Loss: 0.507 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796048).  Saving model ...
Epoch: 30 cost time: 1.234182596206665
Epoch: 30, Steps: 10 | Train Loss: 0.208 Vali Loss: 0.511 Vali Acc: 0.763 Test Loss: 0.511 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3699567317962646
Epoch: 31, Steps: 10 | Train Loss: 0.183 Vali Loss: 0.492 Vali Acc: 0.789 Test Loss: 0.492 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.531050443649292
Epoch: 32, Steps: 10 | Train Loss: 0.169 Vali Loss: 0.483 Vali Acc: 0.789 Test Loss: 0.483 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1778278350830078
Epoch: 33, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.481 Vali Acc: 0.789 Test Loss: 0.481 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1081764698028564
Epoch: 34, Steps: 10 | Train Loss: 0.130 Vali Loss: 0.481 Vali Acc: 0.776 Test Loss: 0.481 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1858608722686768
Epoch: 35, Steps: 10 | Train Loss: 0.129 Vali Loss: 0.479 Vali Acc: 0.803 Test Loss: 0.479 Test Acc: 0.803
Validation loss decreased (-0.796048 --> -0.802627).  Saving model ...
Epoch: 36 cost time: 1.4778175354003906
Epoch: 36, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.478 Vali Acc: 0.789 Test Loss: 0.478 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.150932788848877
Epoch: 37, Steps: 10 | Train Loss: 0.112 Vali Loss: 0.475 Vali Acc: 0.789 Test Loss: 0.475 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.1861872673034668
Epoch: 38, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.476 Vali Acc: 0.789 Test Loss: 0.476 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.0452861785888672
Epoch: 39, Steps: 10 | Train Loss: 0.100 Vali Loss: 0.484 Vali Acc: 0.789 Test Loss: 0.484 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.2499547004699707
Epoch: 40, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.485 Vali Acc: 0.789 Test Loss: 0.485 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.0101382732391357
Epoch: 41, Steps: 10 | Train Loss: 0.070 Vali Loss: 0.480 Vali Acc: 0.796 Test Loss: 0.480 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9432222843170166
Epoch: 42, Steps: 10 | Train Loss: 0.069 Vali Loss: 0.482 Vali Acc: 0.796 Test Loss: 0.482 Test Acc: 0.796
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.1117351055145264
Epoch: 43, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.486 Vali Acc: 0.783 Test Loss: 0.486 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.0559463500976562
Epoch: 44, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.494 Vali Acc: 0.796 Test Loss: 0.494 Test Acc: 0.796
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0373280048370361
Epoch: 45, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.501 Vali Acc: 0.803 Test Loss: 0.501 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.8026315789473685
model parameter : 155964
model size : 1.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.9822232723236084
Epoch: 1, Steps: 10 | Train Loss: 1.507 Vali Loss: 1.434 Vali Acc: 0.322 Test Loss: 1.434 Test Acc: 0.322
Validation loss decreased (inf --> -0.322354).  Saving model ...
Epoch: 2 cost time: 1.0188384056091309
Epoch: 2, Steps: 10 | Train Loss: 1.459 Vali Loss: 1.404 Vali Acc: 0.349 Test Loss: 1.404 Test Acc: 0.349
Validation loss decreased (-0.322354 --> -0.348670).  Saving model ...
Epoch: 3 cost time: 1.033567190170288
Epoch: 3, Steps: 10 | Train Loss: 1.401 Vali Loss: 1.379 Vali Acc: 0.322 Test Loss: 1.379 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0211327075958252
Epoch: 4, Steps: 10 | Train Loss: 1.408 Vali Loss: 1.361 Vali Acc: 0.362 Test Loss: 1.361 Test Acc: 0.362
Validation loss decreased (-0.348670 --> -0.361828).  Saving model ...
Epoch: 5 cost time: 1.0657672882080078
Epoch: 5, Steps: 10 | Train Loss: 1.355 Vali Loss: 1.339 Vali Acc: 0.362 Test Loss: 1.339 Test Acc: 0.362
Validation loss decreased (-0.361828 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 0.9610931873321533
Epoch: 6, Steps: 10 | Train Loss: 1.358 Vali Loss: 1.310 Vali Acc: 0.368 Test Loss: 1.310 Test Acc: 0.368
Validation loss decreased (-0.361829 --> -0.368408).  Saving model ...
Epoch: 7 cost time: 1.0762548446655273
Epoch: 7, Steps: 10 | Train Loss: 1.308 Vali Loss: 1.283 Vali Acc: 0.461 Test Loss: 1.283 Test Acc: 0.461
Validation loss decreased (-0.368408 --> -0.460513).  Saving model ...
Epoch: 8 cost time: 1.4097089767456055
Epoch: 8, Steps: 10 | Train Loss: 1.250 Vali Loss: 1.256 Vali Acc: 0.487 Test Loss: 1.256 Test Acc: 0.487
Validation loss decreased (-0.460513 --> -0.486830).  Saving model ...
Epoch: 9 cost time: 1.1253230571746826
Epoch: 9, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.224 Vali Acc: 0.579 Test Loss: 1.224 Test Acc: 0.579
Validation loss decreased (-0.486830 --> -0.578935).  Saving model ...
Epoch: 10 cost time: 1.357079267501831
Epoch: 10, Steps: 10 | Train Loss: 1.180 Vali Loss: 1.188 Vali Acc: 0.645 Test Loss: 1.188 Test Acc: 0.645
Validation loss decreased (-0.578935 --> -0.644725).  Saving model ...
Epoch: 11 cost time: 0.9912238121032715
Epoch: 11, Steps: 10 | Train Loss: 1.106 Vali Loss: 1.153 Vali Acc: 0.684 Test Loss: 1.153 Test Acc: 0.684
Validation loss decreased (-0.644725 --> -0.684199).  Saving model ...
Epoch: 12 cost time: 0.9153141975402832
Epoch: 12, Steps: 10 | Train Loss: 1.073 Vali Loss: 1.118 Vali Acc: 0.586 Test Loss: 1.118 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8579690456390381
Epoch: 13, Steps: 10 | Train Loss: 1.019 Vali Loss: 1.083 Vali Acc: 0.658 Test Loss: 1.083 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1234583854675293
Epoch: 14, Steps: 10 | Train Loss: 0.998 Vali Loss: 1.042 Vali Acc: 0.704 Test Loss: 1.042 Test Acc: 0.704
Validation loss decreased (-0.684199 --> -0.703937).  Saving model ...
Epoch: 15 cost time: 0.9566659927368164
Epoch: 15, Steps: 10 | Train Loss: 0.895 Vali Loss: 0.998 Vali Acc: 0.678 Test Loss: 0.998 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0490293502807617
Epoch: 16, Steps: 10 | Train Loss: 0.833 Vali Loss: 0.947 Vali Acc: 0.691 Test Loss: 0.947 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9725992679595947
Epoch: 17, Steps: 10 | Train Loss: 0.788 Vali Loss: 0.904 Vali Acc: 0.717 Test Loss: 0.904 Test Acc: 0.717
Validation loss decreased (-0.703937 --> -0.717096).  Saving model ...
Epoch: 18 cost time: 0.8887553215026855
Epoch: 18, Steps: 10 | Train Loss: 0.764 Vali Loss: 0.865 Vali Acc: 0.717 Test Loss: 0.865 Test Acc: 0.717
Validation loss decreased (-0.717096 --> -0.717097).  Saving model ...
Epoch: 19 cost time: 0.9369196891784668
Epoch: 19, Steps: 10 | Train Loss: 0.644 Vali Loss: 0.817 Vali Acc: 0.717 Test Loss: 0.817 Test Acc: 0.717
Validation loss decreased (-0.717097 --> -0.717097).  Saving model ...
Epoch: 20 cost time: 0.9015350341796875
Epoch: 20, Steps: 10 | Train Loss: 0.616 Vali Loss: 0.775 Vali Acc: 0.730 Test Loss: 0.775 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730255).  Saving model ...
Epoch: 21 cost time: 0.864417314529419
Epoch: 21, Steps: 10 | Train Loss: 0.544 Vali Loss: 0.733 Vali Acc: 0.730 Test Loss: 0.733 Test Acc: 0.730
Validation loss decreased (-0.730255 --> -0.730256).  Saving model ...
Epoch: 22 cost time: 0.9740588665008545
Epoch: 22, Steps: 10 | Train Loss: 0.491 Vali Loss: 0.696 Vali Acc: 0.737 Test Loss: 0.696 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736835).  Saving model ...
Epoch: 23 cost time: 1.1100835800170898
Epoch: 23, Steps: 10 | Train Loss: 0.434 Vali Loss: 0.663 Vali Acc: 0.757 Test Loss: 0.663 Test Acc: 0.757
Validation loss decreased (-0.736835 --> -0.756572).  Saving model ...
Epoch: 24 cost time: 0.9834790229797363
Epoch: 24, Steps: 10 | Train Loss: 0.416 Vali Loss: 0.633 Vali Acc: 0.743 Test Loss: 0.633 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.27421236038208
Epoch: 25, Steps: 10 | Train Loss: 0.348 Vali Loss: 0.611 Vali Acc: 0.757 Test Loss: 0.611 Test Acc: 0.757
Validation loss decreased (-0.756572 --> -0.756573).  Saving model ...
Epoch: 26 cost time: 1.0850975513458252
Epoch: 26, Steps: 10 | Train Loss: 0.333 Vali Loss: 0.590 Vali Acc: 0.750 Test Loss: 0.590 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.053727626800537
Epoch: 27, Steps: 10 | Train Loss: 0.332 Vali Loss: 0.574 Vali Acc: 0.750 Test Loss: 0.574 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.2586095333099365
Epoch: 28, Steps: 10 | Train Loss: 0.274 Vali Loss: 0.552 Vali Acc: 0.763 Test Loss: 0.552 Test Acc: 0.763
Validation loss decreased (-0.756573 --> -0.763152).  Saving model ...
Epoch: 29 cost time: 1.0977129936218262
Epoch: 29, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.540 Vali Acc: 0.757 Test Loss: 0.540 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0007243156433105
Epoch: 30, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.529 Vali Acc: 0.776 Test Loss: 0.529 Test Acc: 0.776
Validation loss decreased (-0.763152 --> -0.776311).  Saving model ...
Epoch: 31 cost time: 1.0027344226837158
Epoch: 31, Steps: 10 | Train Loss: 0.229 Vali Loss: 0.516 Vali Acc: 0.783 Test Loss: 0.516 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782890).  Saving model ...
Epoch: 32 cost time: 1.091609239578247
Epoch: 32, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.514 Vali Acc: 0.770 Test Loss: 0.514 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9414069652557373
Epoch: 33, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.499 Vali Acc: 0.783 Test Loss: 0.499 Test Acc: 0.783
Validation loss decreased (-0.782890 --> -0.782890).  Saving model ...
Epoch: 34 cost time: 0.9465563297271729
Epoch: 34, Steps: 10 | Train Loss: 0.181 Vali Loss: 0.496 Vali Acc: 0.789 Test Loss: 0.496 Test Acc: 0.789
Validation loss decreased (-0.782890 --> -0.789469).  Saving model ...
Epoch: 35 cost time: 0.8752706050872803
Epoch: 35, Steps: 10 | Train Loss: 0.170 Vali Loss: 0.492 Vali Acc: 0.776 Test Loss: 0.492 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0460951328277588
Epoch: 36, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.487 Vali Acc: 0.763 Test Loss: 0.487 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.157562017440796
Epoch: 37, Steps: 10 | Train Loss: 0.163 Vali Loss: 0.490 Vali Acc: 0.789 Test Loss: 0.490 Test Acc: 0.789
Validation loss decreased (-0.789469 --> -0.789469).  Saving model ...
Epoch: 38 cost time: 1.0029921531677246
Epoch: 38, Steps: 10 | Train Loss: 0.133 Vali Loss: 0.489 Vali Acc: 0.763 Test Loss: 0.489 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.2031614780426025
Epoch: 39, Steps: 10 | Train Loss: 0.134 Vali Loss: 0.477 Vali Acc: 0.783 Test Loss: 0.477 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0673491954803467
Epoch: 40, Steps: 10 | Train Loss: 0.102 Vali Loss: 0.491 Vali Acc: 0.776 Test Loss: 0.491 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9647877216339111
Epoch: 41, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.484 Vali Acc: 0.757 Test Loss: 0.484 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8949968814849854
Epoch: 42, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.480 Vali Acc: 0.776 Test Loss: 0.480 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8108859062194824
Epoch: 43, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.481 Vali Acc: 0.776 Test Loss: 0.481 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0205457210540771
Epoch: 44, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.478 Vali Acc: 0.776 Test Loss: 0.478 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0583646297454834
Epoch: 45, Steps: 10 | Train Loss: 0.080 Vali Loss: 0.476 Vali Acc: 0.770 Test Loss: 0.476 Test Acc: 0.770
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.1075255870819092
Epoch: 46, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.487 Vali Acc: 0.763 Test Loss: 0.487 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9790563583374023
Epoch: 47, Steps: 10 | Train Loss: 0.076 Vali Loss: 0.496 Vali Acc: 0.770 Test Loss: 0.496 Test Acc: 0.770
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7894736842105263
model parameter : 106332
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.389021396636963
Epoch: 1, Steps: 10 | Train Loss: 1.442 Vali Loss: 1.440 Vali Acc: 0.230 Test Loss: 1.440 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 1.097320318222046
Epoch: 2, Steps: 10 | Train Loss: 1.427 Vali Loss: 1.420 Vali Acc: 0.204 Test Loss: 1.420 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.332118034362793
Epoch: 3, Steps: 10 | Train Loss: 1.387 Vali Loss: 1.406 Vali Acc: 0.224 Test Loss: 1.406 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9187583923339844
Epoch: 4, Steps: 10 | Train Loss: 1.395 Vali Loss: 1.383 Vali Acc: 0.263 Test Loss: 1.383 Test Acc: 0.263
Validation loss decreased (-0.230249 --> -0.263144).  Saving model ...
Epoch: 5 cost time: 1.045527458190918
Epoch: 5, Steps: 10 | Train Loss: 1.330 Vali Loss: 1.352 Vali Acc: 0.375 Test Loss: 1.352 Test Acc: 0.375
Validation loss decreased (-0.263144 --> -0.374986).  Saving model ...
Epoch: 6 cost time: 0.9805850982666016
Epoch: 6, Steps: 10 | Train Loss: 1.285 Vali Loss: 1.325 Vali Acc: 0.375 Test Loss: 1.325 Test Acc: 0.375
Validation loss decreased (-0.374986 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.03999924659729
Epoch: 7, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.301 Vali Acc: 0.395 Test Loss: 1.301 Test Acc: 0.395
Validation loss decreased (-0.374987 --> -0.394724).  Saving model ...
Epoch: 8 cost time: 1.1578621864318848
Epoch: 8, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.264 Vali Acc: 0.441 Test Loss: 1.264 Test Acc: 0.441
Validation loss decreased (-0.394724 --> -0.440777).  Saving model ...
Epoch: 9 cost time: 0.8758361339569092
Epoch: 9, Steps: 10 | Train Loss: 1.148 Vali Loss: 1.228 Vali Acc: 0.474 Test Loss: 1.228 Test Acc: 0.474
Validation loss decreased (-0.440777 --> -0.473672).  Saving model ...
Epoch: 10 cost time: 0.9512522220611572
Epoch: 10, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.195 Vali Acc: 0.487 Test Loss: 1.195 Test Acc: 0.487
Validation loss decreased (-0.473672 --> -0.486830).  Saving model ...
Epoch: 11 cost time: 1.2577028274536133
Epoch: 11, Steps: 10 | Train Loss: 1.097 Vali Loss: 1.172 Vali Acc: 0.507 Test Loss: 1.172 Test Acc: 0.507
Validation loss decreased (-0.486830 --> -0.506567).  Saving model ...
Epoch: 12 cost time: 0.8863296508789062
Epoch: 12, Steps: 10 | Train Loss: 1.010 Vali Loss: 1.122 Vali Acc: 0.526 Test Loss: 1.122 Test Acc: 0.526
Validation loss decreased (-0.506567 --> -0.526305).  Saving model ...
Epoch: 13 cost time: 1.0569164752960205
Epoch: 13, Steps: 10 | Train Loss: 0.953 Vali Loss: 1.087 Vali Acc: 0.559 Test Loss: 1.087 Test Acc: 0.559
Validation loss decreased (-0.526305 --> -0.559200).  Saving model ...
Epoch: 14 cost time: 1.2469873428344727
Epoch: 14, Steps: 10 | Train Loss: 0.920 Vali Loss: 1.052 Vali Acc: 0.546 Test Loss: 1.052 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0228803157806396
Epoch: 15, Steps: 10 | Train Loss: 0.865 Vali Loss: 1.010 Vali Acc: 0.586 Test Loss: 1.010 Test Acc: 0.586
Validation loss decreased (-0.559200 --> -0.585516).  Saving model ...
Epoch: 16 cost time: 0.9389469623565674
Epoch: 16, Steps: 10 | Train Loss: 0.836 Vali Loss: 0.976 Vali Acc: 0.592 Test Loss: 0.976 Test Acc: 0.592
Validation loss decreased (-0.585516 --> -0.592096).  Saving model ...
Epoch: 17 cost time: 0.9763469696044922
Epoch: 17, Steps: 10 | Train Loss: 0.735 Vali Loss: 0.949 Vali Acc: 0.612 Test Loss: 0.949 Test Acc: 0.612
Validation loss decreased (-0.592096 --> -0.611833).  Saving model ...
Epoch: 18 cost time: 1.1268439292907715
Epoch: 18, Steps: 10 | Train Loss: 0.694 Vali Loss: 0.895 Vali Acc: 0.625 Test Loss: 0.895 Test Acc: 0.625
Validation loss decreased (-0.611833 --> -0.624991).  Saving model ...
Epoch: 19 cost time: 1.190995216369629
Epoch: 19, Steps: 10 | Train Loss: 0.641 Vali Loss: 0.861 Vali Acc: 0.664 Test Loss: 0.861 Test Acc: 0.664
Validation loss decreased (-0.624991 --> -0.664465).  Saving model ...
Epoch: 20 cost time: 0.9809608459472656
Epoch: 20, Steps: 10 | Train Loss: 0.574 Vali Loss: 0.826 Vali Acc: 0.638 Test Loss: 0.826 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9824841022491455
Epoch: 21, Steps: 10 | Train Loss: 0.540 Vali Loss: 0.785 Vali Acc: 0.664 Test Loss: 0.785 Test Acc: 0.664
Validation loss decreased (-0.664465 --> -0.664466).  Saving model ...
Epoch: 22 cost time: 0.9589798450469971
Epoch: 22, Steps: 10 | Train Loss: 0.493 Vali Loss: 0.753 Vali Acc: 0.678 Test Loss: 0.753 Test Acc: 0.678
Validation loss decreased (-0.664466 --> -0.677624).  Saving model ...
Epoch: 23 cost time: 1.0595252513885498
Epoch: 23, Steps: 10 | Train Loss: 0.451 Vali Loss: 0.728 Vali Acc: 0.684 Test Loss: 0.728 Test Acc: 0.684
Validation loss decreased (-0.677624 --> -0.684203).  Saving model ...
Epoch: 24 cost time: 1.1098463535308838
Epoch: 24, Steps: 10 | Train Loss: 0.391 Vali Loss: 0.686 Vali Acc: 0.717 Test Loss: 0.686 Test Acc: 0.717
Validation loss decreased (-0.684203 --> -0.717098).  Saving model ...
Epoch: 25 cost time: 0.8339886665344238
Epoch: 25, Steps: 10 | Train Loss: 0.362 Vali Loss: 0.671 Vali Acc: 0.730 Test Loss: 0.671 Test Acc: 0.730
Validation loss decreased (-0.717098 --> -0.730256).  Saving model ...
Epoch: 26 cost time: 0.9839253425598145
Epoch: 26, Steps: 10 | Train Loss: 0.346 Vali Loss: 0.635 Vali Acc: 0.724 Test Loss: 0.635 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.050591230392456
Epoch: 27, Steps: 10 | Train Loss: 0.323 Vali Loss: 0.625 Vali Acc: 0.737 Test Loss: 0.625 Test Acc: 0.737
Validation loss decreased (-0.730256 --> -0.736836).  Saving model ...
Epoch: 28 cost time: 0.8688015937805176
Epoch: 28, Steps: 10 | Train Loss: 0.284 Vali Loss: 0.607 Vali Acc: 0.724 Test Loss: 0.607 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2320630550384521
Epoch: 29, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.591 Vali Acc: 0.724 Test Loss: 0.591 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0795681476593018
Epoch: 30, Steps: 10 | Train Loss: 0.241 Vali Loss: 0.578 Vali Acc: 0.730 Test Loss: 0.578 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.232360601425171
Epoch: 31, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.572 Vali Acc: 0.737 Test Loss: 0.572 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 32 cost time: 1.0737800598144531
Epoch: 32, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.566 Vali Acc: 0.717 Test Loss: 0.566 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.1460585594177246
Epoch: 33, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.559 Vali Acc: 0.730 Test Loss: 0.559 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0530567169189453
Epoch: 34, Steps: 10 | Train Loss: 0.175 Vali Loss: 0.548 Vali Acc: 0.743 Test Loss: 0.548 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743416).  Saving model ...
Epoch: 35 cost time: 1.018550157546997
Epoch: 35, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.547 Vali Acc: 0.730 Test Loss: 0.547 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.034226655960083
Epoch: 36, Steps: 10 | Train Loss: 0.167 Vali Loss: 0.542 Vali Acc: 0.737 Test Loss: 0.542 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9333882331848145
Epoch: 37, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.543 Vali Acc: 0.717 Test Loss: 0.543 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9365108013153076
Epoch: 38, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.541 Vali Acc: 0.724 Test Loss: 0.541 Test Acc: 0.724
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0138912200927734
Epoch: 39, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.540 Vali Acc: 0.743 Test Loss: 0.540 Test Acc: 0.743
Validation loss decreased (-0.743416 --> -0.743416).  Saving model ...
Epoch: 40 cost time: 0.9781975746154785
Epoch: 40, Steps: 10 | Train Loss: 0.115 Vali Loss: 0.538 Vali Acc: 0.750 Test Loss: 0.538 Test Acc: 0.750
Validation loss decreased (-0.743416 --> -0.749995).  Saving model ...
Epoch: 41 cost time: 1.0027024745941162
Epoch: 41, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.532 Vali Acc: 0.737 Test Loss: 0.532 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9591360092163086
Epoch: 42, Steps: 10 | Train Loss: 0.096 Vali Loss: 0.533 Vali Acc: 0.737 Test Loss: 0.533 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1239688396453857
Epoch: 43, Steps: 10 | Train Loss: 0.088 Vali Loss: 0.542 Vali Acc: 0.750 Test Loss: 0.542 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9806854724884033
Epoch: 44, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.543 Vali Acc: 0.757 Test Loss: 0.543 Test Acc: 0.757
Validation loss decreased (-0.749995 --> -0.756574).  Saving model ...
Epoch: 45 cost time: 0.9954752922058105
Epoch: 45, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.538 Vali Acc: 0.763 Test Loss: 0.538 Test Acc: 0.763
Validation loss decreased (-0.756574 --> -0.763153).  Saving model ...
Epoch: 46 cost time: 0.9614546298980713
Epoch: 46, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.543 Vali Acc: 0.750 Test Loss: 0.543 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9870138168334961
Epoch: 47, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.535 Vali Acc: 0.757 Test Loss: 0.535 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0661735534667969
Epoch: 48, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.536 Vali Acc: 0.770 Test Loss: 0.536 Test Acc: 0.770
Validation loss decreased (-0.763153 --> -0.769731).  Saving model ...
Epoch: 49 cost time: 1.0142579078674316
Epoch: 49, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.551 Vali Acc: 0.757 Test Loss: 0.551 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.175058126449585
Epoch: 50, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9150857925415039
Epoch: 51, Steps: 10 | Train Loss: 0.072 Vali Loss: 0.553 Vali Acc: 0.770 Test Loss: 0.553 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.3296232223510742
Epoch: 52, Steps: 10 | Train Loss: 0.051 Vali Loss: 0.580 Vali Acc: 0.757 Test Loss: 0.580 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.1448438167572021
Epoch: 53, Steps: 10 | Train Loss: 0.048 Vali Loss: 0.570 Vali Acc: 0.770 Test Loss: 0.570 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.0315258502960205
Epoch: 54, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.572 Vali Acc: 0.757 Test Loss: 0.572 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.8985939025878906
Epoch: 55, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.577 Vali Acc: 0.763 Test Loss: 0.577 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.9192755222320557
Epoch: 56, Steps: 10 | Train Loss: 0.045 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.9955496788024902
Epoch: 57, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.579 Vali Acc: 0.757 Test Loss: 0.579 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.8640034198760986
Epoch: 58, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.574 Vali Acc: 0.757 Test Loss: 0.574 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 106236
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.7964587211608887
Epoch: 1, Steps: 10 | Train Loss: 1.499 Vali Loss: 1.445 Vali Acc: 0.257 Test Loss: 1.445 Test Acc: 0.257
Validation loss decreased (inf --> -0.256565).  Saving model ...
Epoch: 2 cost time: 1.1040124893188477
Epoch: 2, Steps: 10 | Train Loss: 1.455 Vali Loss: 1.418 Vali Acc: 0.257 Test Loss: 1.418 Test Acc: 0.257
Validation loss decreased (-0.256565 --> -0.256565).  Saving model ...
Epoch: 3 cost time: 0.784048318862915
Epoch: 3, Steps: 10 | Train Loss: 1.432 Vali Loss: 1.401 Vali Acc: 0.296 Test Loss: 1.401 Test Acc: 0.296
Validation loss decreased (-0.256565 --> -0.296039).  Saving model ...
Epoch: 4 cost time: 0.9379043579101562
Epoch: 4, Steps: 10 | Train Loss: 1.374 Vali Loss: 1.377 Vali Acc: 0.303 Test Loss: 1.377 Test Acc: 0.303
Validation loss decreased (-0.296039 --> -0.302618).  Saving model ...
Epoch: 5 cost time: 0.9514000415802002
Epoch: 5, Steps: 10 | Train Loss: 1.350 Vali Loss: 1.353 Vali Acc: 0.322 Test Loss: 1.353 Test Acc: 0.322
Validation loss decreased (-0.302618 --> -0.322355).  Saving model ...
Epoch: 6 cost time: 0.8490035533905029
Epoch: 6, Steps: 10 | Train Loss: 1.337 Vali Loss: 1.331 Vali Acc: 0.349 Test Loss: 1.331 Test Acc: 0.349
Validation loss decreased (-0.322355 --> -0.348671).  Saving model ...
Epoch: 7 cost time: 1.1249072551727295
Epoch: 7, Steps: 10 | Train Loss: 1.300 Vali Loss: 1.295 Vali Acc: 0.428 Test Loss: 1.295 Test Acc: 0.428
Validation loss decreased (-0.348671 --> -0.427619).  Saving model ...
Epoch: 8 cost time: 1.173992395401001
Epoch: 8, Steps: 10 | Train Loss: 1.223 Vali Loss: 1.263 Vali Acc: 0.493 Test Loss: 1.263 Test Acc: 0.493
Validation loss decreased (-0.427619 --> -0.493408).  Saving model ...
Epoch: 9 cost time: 1.1763229370117188
Epoch: 9, Steps: 10 | Train Loss: 1.176 Vali Loss: 1.230 Vali Acc: 0.566 Test Loss: 1.230 Test Acc: 0.566
Validation loss decreased (-0.493408 --> -0.565777).  Saving model ...
Epoch: 10 cost time: 0.9405660629272461
Epoch: 10, Steps: 10 | Train Loss: 1.144 Vali Loss: 1.192 Vali Acc: 0.572 Test Loss: 1.192 Test Acc: 0.572
Validation loss decreased (-0.565777 --> -0.572357).  Saving model ...
Epoch: 11 cost time: 0.8487274646759033
Epoch: 11, Steps: 10 | Train Loss: 1.112 Vali Loss: 1.162 Vali Acc: 0.566 Test Loss: 1.162 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9779407978057861
Epoch: 12, Steps: 10 | Train Loss: 1.056 Vali Loss: 1.118 Vali Acc: 0.625 Test Loss: 1.118 Test Acc: 0.625
Validation loss decreased (-0.572357 --> -0.624989).  Saving model ...
Epoch: 13 cost time: 1.072624921798706
Epoch: 13, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.079 Vali Acc: 0.645 Test Loss: 1.079 Test Acc: 0.645
Validation loss decreased (-0.624989 --> -0.644726).  Saving model ...
Epoch: 14 cost time: 1.0204169750213623
Epoch: 14, Steps: 10 | Train Loss: 0.928 Vali Loss: 1.036 Vali Acc: 0.625 Test Loss: 1.036 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0205214023590088
Epoch: 15, Steps: 10 | Train Loss: 0.892 Vali Loss: 0.997 Vali Acc: 0.664 Test Loss: 0.997 Test Acc: 0.664
Validation loss decreased (-0.644726 --> -0.664464).  Saving model ...
Epoch: 16 cost time: 0.9642758369445801
Epoch: 16, Steps: 10 | Train Loss: 0.818 Vali Loss: 0.950 Vali Acc: 0.671 Test Loss: 0.950 Test Acc: 0.671
Validation loss decreased (-0.664464 --> -0.671043).  Saving model ...
Epoch: 17 cost time: 0.9054582118988037
Epoch: 17, Steps: 10 | Train Loss: 0.770 Vali Loss: 0.905 Vali Acc: 0.658 Test Loss: 0.905 Test Acc: 0.658
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9303643703460693
Epoch: 18, Steps: 10 | Train Loss: 0.663 Vali Loss: 0.853 Vali Acc: 0.664 Test Loss: 0.853 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9464917182922363
Epoch: 19, Steps: 10 | Train Loss: 0.637 Vali Loss: 0.819 Vali Acc: 0.684 Test Loss: 0.819 Test Acc: 0.684
Validation loss decreased (-0.671043 --> -0.684202).  Saving model ...
Epoch: 20 cost time: 0.9281308650970459
Epoch: 20, Steps: 10 | Train Loss: 0.575 Vali Loss: 0.769 Vali Acc: 0.684 Test Loss: 0.769 Test Acc: 0.684
Validation loss decreased (-0.684202 --> -0.684203).  Saving model ...
Epoch: 21 cost time: 1.0092058181762695
Epoch: 21, Steps: 10 | Train Loss: 0.522 Vali Loss: 0.724 Vali Acc: 0.717 Test Loss: 0.724 Test Acc: 0.717
Validation loss decreased (-0.684203 --> -0.717098).  Saving model ...
Epoch: 22 cost time: 0.9138448238372803
Epoch: 22, Steps: 10 | Train Loss: 0.476 Vali Loss: 0.691 Vali Acc: 0.704 Test Loss: 0.691 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9361543655395508
Epoch: 23, Steps: 10 | Train Loss: 0.435 Vali Loss: 0.663 Vali Acc: 0.724 Test Loss: 0.663 Test Acc: 0.724
Validation loss decreased (-0.717098 --> -0.723678).  Saving model ...
Epoch: 24 cost time: 0.8757085800170898
Epoch: 24, Steps: 10 | Train Loss: 0.389 Vali Loss: 0.637 Vali Acc: 0.750 Test Loss: 0.637 Test Acc: 0.750
Validation loss decreased (-0.723678 --> -0.749994).  Saving model ...
Epoch: 25 cost time: 1.0019707679748535
Epoch: 25, Steps: 10 | Train Loss: 0.365 Vali Loss: 0.604 Vali Acc: 0.743 Test Loss: 0.604 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.04557466506958
Epoch: 26, Steps: 10 | Train Loss: 0.312 Vali Loss: 0.583 Vali Acc: 0.743 Test Loss: 0.583 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0248591899871826
Epoch: 27, Steps: 10 | Train Loss: 0.291 Vali Loss: 0.564 Vali Acc: 0.750 Test Loss: 0.564 Test Acc: 0.750
Validation loss decreased (-0.749994 --> -0.749994).  Saving model ...
Epoch: 28 cost time: 0.9893655776977539
Epoch: 28, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.549 Vali Acc: 0.743 Test Loss: 0.549 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0556058883666992
Epoch: 29, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.537 Vali Acc: 0.757 Test Loss: 0.537 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756574).  Saving model ...
Epoch: 30 cost time: 0.8826053142547607
Epoch: 30, Steps: 10 | Train Loss: 0.225 Vali Loss: 0.525 Vali Acc: 0.763 Test Loss: 0.525 Test Acc: 0.763
Validation loss decreased (-0.756574 --> -0.763153).  Saving model ...
Epoch: 31 cost time: 0.9347608089447021
Epoch: 31, Steps: 10 | Train Loss: 0.211 Vali Loss: 0.517 Vali Acc: 0.750 Test Loss: 0.517 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1647799015045166
Epoch: 32, Steps: 10 | Train Loss: 0.217 Vali Loss: 0.513 Vali Acc: 0.737 Test Loss: 0.513 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.096930980682373
Epoch: 33, Steps: 10 | Train Loss: 0.191 Vali Loss: 0.505 Vali Acc: 0.750 Test Loss: 0.505 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.1400659084320068
Epoch: 34, Steps: 10 | Train Loss: 0.166 Vali Loss: 0.507 Vali Acc: 0.757 Test Loss: 0.507 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9193007946014404
Epoch: 35, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.506 Vali Acc: 0.743 Test Loss: 0.506 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.0781452655792236
Epoch: 36, Steps: 10 | Train Loss: 0.150 Vali Loss: 0.507 Vali Acc: 0.763 Test Loss: 0.507 Test Acc: 0.763
Validation loss decreased (-0.763153 --> -0.763153).  Saving model ...
Epoch: 37 cost time: 1.0336580276489258
Epoch: 37, Steps: 10 | Train Loss: 0.140 Vali Loss: 0.507 Vali Acc: 0.763 Test Loss: 0.507 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9191274642944336
Epoch: 38, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.507 Vali Acc: 0.750 Test Loss: 0.507 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.135369062423706
Epoch: 39, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.518 Vali Acc: 0.776 Test Loss: 0.518 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 40 cost time: 0.8658549785614014
Epoch: 40, Steps: 10 | Train Loss: 0.125 Vali Loss: 0.505 Vali Acc: 0.750 Test Loss: 0.505 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0039341449737549
Epoch: 41, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.510 Vali Acc: 0.750 Test Loss: 0.510 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9723289012908936
Epoch: 42, Steps: 10 | Train Loss: 0.104 Vali Loss: 0.511 Vali Acc: 0.757 Test Loss: 0.511 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.0579652786254883
Epoch: 43, Steps: 10 | Train Loss: 0.083 Vali Loss: 0.523 Vali Acc: 0.757 Test Loss: 0.523 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0210275650024414
Epoch: 44, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.515 Vali Acc: 0.757 Test Loss: 0.515 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7919809818267822
Epoch: 45, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.521 Vali Acc: 0.757 Test Loss: 0.521 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.929767370223999
Epoch: 46, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.524 Vali Acc: 0.750 Test Loss: 0.524 Test Acc: 0.750
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.112675428390503
Epoch: 47, Steps: 10 | Train Loss: 0.078 Vali Loss: 0.524 Vali Acc: 0.757 Test Loss: 0.524 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.1002919673919678
Epoch: 48, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.519 Vali Acc: 0.757 Test Loss: 0.519 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8829994201660156
Epoch: 49, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.524 Vali Acc: 0.750 Test Loss: 0.524 Test Acc: 0.750
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7763157894736842
model parameter : 106140
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.99967885017395
Epoch: 1, Steps: 10 | Train Loss: 1.392 Vali Loss: 1.452 Vali Acc: 0.276 Test Loss: 1.452 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 0.8809971809387207
Epoch: 2, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.420 Vali Acc: 0.296 Test Loss: 1.420 Test Acc: 0.296
Validation loss decreased (-0.276301 --> -0.296038).  Saving model ...
Epoch: 3 cost time: 0.8510210514068604
Epoch: 3, Steps: 10 | Train Loss: 1.306 Vali Loss: 1.395 Vali Acc: 0.283 Test Loss: 1.395 Test Acc: 0.283
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9131836891174316
Epoch: 4, Steps: 10 | Train Loss: 1.293 Vali Loss: 1.375 Vali Acc: 0.349 Test Loss: 1.375 Test Acc: 0.349
Validation loss decreased (-0.296038 --> -0.348670).  Saving model ...
Epoch: 5 cost time: 1.1546077728271484
Epoch: 5, Steps: 10 | Train Loss: 1.259 Vali Loss: 1.360 Vali Acc: 0.349 Test Loss: 1.360 Test Acc: 0.349
Validation loss decreased (-0.348670 --> -0.348671).  Saving model ...
Epoch: 6 cost time: 1.2751367092132568
Epoch: 6, Steps: 10 | Train Loss: 1.256 Vali Loss: 1.332 Vali Acc: 0.375 Test Loss: 1.332 Test Acc: 0.375
Validation loss decreased (-0.348671 --> -0.374987).  Saving model ...
Epoch: 7 cost time: 1.0740432739257812
Epoch: 7, Steps: 10 | Train Loss: 1.215 Vali Loss: 1.299 Vali Acc: 0.441 Test Loss: 1.299 Test Acc: 0.441
Validation loss decreased (-0.374987 --> -0.440776).  Saving model ...
Epoch: 8 cost time: 1.2311820983886719
Epoch: 8, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.273 Vali Acc: 0.447 Test Loss: 1.273 Test Acc: 0.447
Validation loss decreased (-0.440776 --> -0.447356).  Saving model ...
Epoch: 9 cost time: 1.1630527973175049
Epoch: 9, Steps: 10 | Train Loss: 1.117 Vali Loss: 1.241 Vali Acc: 0.461 Test Loss: 1.241 Test Acc: 0.461
Validation loss decreased (-0.447356 --> -0.460514).  Saving model ...
Epoch: 10 cost time: 1.087045669555664
Epoch: 10, Steps: 10 | Train Loss: 1.045 Vali Loss: 1.205 Vali Acc: 0.546 Test Loss: 1.205 Test Acc: 0.546
Validation loss decreased (-0.460514 --> -0.546041).  Saving model ...
Epoch: 11 cost time: 1.2386822700500488
Epoch: 11, Steps: 10 | Train Loss: 1.041 Vali Loss: 1.175 Vali Acc: 0.539 Test Loss: 1.175 Test Acc: 0.539
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0687129497528076
Epoch: 12, Steps: 10 | Train Loss: 0.973 Vali Loss: 1.135 Vali Acc: 0.559 Test Loss: 1.135 Test Acc: 0.559
Validation loss decreased (-0.546041 --> -0.559199).  Saving model ...
Epoch: 13 cost time: 1.0001251697540283
Epoch: 13, Steps: 10 | Train Loss: 0.925 Vali Loss: 1.100 Vali Acc: 0.559 Test Loss: 1.100 Test Acc: 0.559
Validation loss decreased (-0.559199 --> -0.559200).  Saving model ...
Epoch: 14 cost time: 1.0964970588684082
Epoch: 14, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.057 Vali Acc: 0.579 Test Loss: 1.057 Test Acc: 0.579
Validation loss decreased (-0.559200 --> -0.578937).  Saving model ...
Epoch: 15 cost time: 0.7855486869812012
Epoch: 15, Steps: 10 | Train Loss: 0.837 Vali Loss: 1.022 Vali Acc: 0.599 Test Loss: 1.022 Test Acc: 0.599
Validation loss decreased (-0.578937 --> -0.598674).  Saving model ...
Epoch: 16 cost time: 1.0129835605621338
Epoch: 16, Steps: 10 | Train Loss: 0.779 Vali Loss: 0.974 Vali Acc: 0.599 Test Loss: 0.974 Test Acc: 0.599
Validation loss decreased (-0.598674 --> -0.598674).  Saving model ...
Epoch: 17 cost time: 0.905592679977417
Epoch: 17, Steps: 10 | Train Loss: 0.721 Vali Loss: 0.938 Vali Acc: 0.599 Test Loss: 0.938 Test Acc: 0.599
Validation loss decreased (-0.598674 --> -0.598675).  Saving model ...
Epoch: 18 cost time: 1.1958680152893066
Epoch: 18, Steps: 10 | Train Loss: 0.668 Vali Loss: 0.900 Vali Acc: 0.612 Test Loss: 0.900 Test Acc: 0.612
Validation loss decreased (-0.598675 --> -0.611833).  Saving model ...
Epoch: 19 cost time: 1.2306947708129883
Epoch: 19, Steps: 10 | Train Loss: 0.587 Vali Loss: 0.851 Vali Acc: 0.618 Test Loss: 0.851 Test Acc: 0.618
Validation loss decreased (-0.611833 --> -0.618413).  Saving model ...
Epoch: 20 cost time: 1.0931599140167236
Epoch: 20, Steps: 10 | Train Loss: 0.558 Vali Loss: 0.810 Vali Acc: 0.618 Test Loss: 0.810 Test Acc: 0.618
Validation loss decreased (-0.618413 --> -0.618413).  Saving model ...
Epoch: 21 cost time: 1.0386075973510742
Epoch: 21, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.775 Vali Acc: 0.658 Test Loss: 0.775 Test Acc: 0.658
Validation loss decreased (-0.618413 --> -0.657887).  Saving model ...
Epoch: 22 cost time: 0.8902018070220947
Epoch: 22, Steps: 10 | Train Loss: 0.462 Vali Loss: 0.729 Vali Acc: 0.658 Test Loss: 0.729 Test Acc: 0.658
Validation loss decreased (-0.657887 --> -0.657887).  Saving model ...
Epoch: 23 cost time: 0.8091516494750977
Epoch: 23, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.690 Vali Acc: 0.691 Test Loss: 0.690 Test Acc: 0.691
Validation loss decreased (-0.657887 --> -0.690783).  Saving model ...
Epoch: 24 cost time: 0.9076123237609863
Epoch: 24, Steps: 10 | Train Loss: 0.371 Vali Loss: 0.657 Vali Acc: 0.697 Test Loss: 0.657 Test Acc: 0.697
Validation loss decreased (-0.690783 --> -0.697362).  Saving model ...
Epoch: 25 cost time: 0.9314467906951904
Epoch: 25, Steps: 10 | Train Loss: 0.345 Vali Loss: 0.628 Vali Acc: 0.717 Test Loss: 0.628 Test Acc: 0.717
Validation loss decreased (-0.697362 --> -0.717099).  Saving model ...
Epoch: 26 cost time: 1.062873363494873
Epoch: 26, Steps: 10 | Train Loss: 0.321 Vali Loss: 0.603 Vali Acc: 0.730 Test Loss: 0.603 Test Acc: 0.730
Validation loss decreased (-0.717099 --> -0.730257).  Saving model ...
Epoch: 27 cost time: 0.9137303829193115
Epoch: 27, Steps: 10 | Train Loss: 0.294 Vali Loss: 0.587 Vali Acc: 0.743 Test Loss: 0.587 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 28 cost time: 1.0497443675994873
Epoch: 28, Steps: 10 | Train Loss: 0.258 Vali Loss: 0.566 Vali Acc: 0.757 Test Loss: 0.566 Test Acc: 0.757
Validation loss decreased (-0.743415 --> -0.756573).  Saving model ...
Epoch: 29 cost time: 1.0335173606872559
Epoch: 29, Steps: 10 | Train Loss: 0.222 Vali Loss: 0.554 Vali Acc: 0.743 Test Loss: 0.554 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1676511764526367
Epoch: 30, Steps: 10 | Train Loss: 0.206 Vali Loss: 0.546 Vali Acc: 0.743 Test Loss: 0.546 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.3600530624389648
Epoch: 31, Steps: 10 | Train Loss: 0.199 Vali Loss: 0.530 Vali Acc: 0.757 Test Loss: 0.530 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756574).  Saving model ...
Epoch: 32 cost time: 1.1296508312225342
Epoch: 32, Steps: 10 | Train Loss: 0.186 Vali Loss: 0.522 Vali Acc: 0.737 Test Loss: 0.522 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0565292835235596
Epoch: 33, Steps: 10 | Train Loss: 0.165 Vali Loss: 0.516 Vali Acc: 0.737 Test Loss: 0.516 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9859352111816406
Epoch: 34, Steps: 10 | Train Loss: 0.153 Vali Loss: 0.515 Vali Acc: 0.730 Test Loss: 0.515 Test Acc: 0.730
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8570139408111572
Epoch: 35, Steps: 10 | Train Loss: 0.138 Vali Loss: 0.519 Vali Acc: 0.743 Test Loss: 0.519 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.990652322769165
Epoch: 36, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.521 Vali Acc: 0.730 Test Loss: 0.521 Test Acc: 0.730
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8397212028503418
Epoch: 37, Steps: 10 | Train Loss: 0.143 Vali Loss: 0.527 Vali Acc: 0.750 Test Loss: 0.527 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9247796535491943
Epoch: 38, Steps: 10 | Train Loss: 0.117 Vali Loss: 0.509 Vali Acc: 0.743 Test Loss: 0.509 Test Acc: 0.743
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.881777286529541
Epoch: 39, Steps: 10 | Train Loss: 0.093 Vali Loss: 0.505 Vali Acc: 0.750 Test Loss: 0.505 Test Acc: 0.750
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9765141010284424
Epoch: 40, Steps: 10 | Train Loss: 0.089 Vali Loss: 0.502 Vali Acc: 0.757 Test Loss: 0.502 Test Acc: 0.757
Validation loss decreased (-0.756574 --> -0.756574).  Saving model ...
Epoch: 41 cost time: 0.884756326675415
Epoch: 41, Steps: 10 | Train Loss: 0.085 Vali Loss: 0.500 Vali Acc: 0.763 Test Loss: 0.500 Test Acc: 0.763
Validation loss decreased (-0.756574 --> -0.763153).  Saving model ...
Epoch: 42 cost time: 0.8285937309265137
Epoch: 42, Steps: 10 | Train Loss: 0.077 Vali Loss: 0.507 Vali Acc: 0.750 Test Loss: 0.507 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8064343929290771
Epoch: 43, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.505 Vali Acc: 0.763 Test Loss: 0.505 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9184219837188721
Epoch: 44, Steps: 10 | Train Loss: 0.063 Vali Loss: 0.501 Vali Acc: 0.776 Test Loss: 0.501 Test Acc: 0.776
Validation loss decreased (-0.763153 --> -0.776311).  Saving model ...
Epoch: 45 cost time: 0.8759417533874512
Epoch: 45, Steps: 10 | Train Loss: 0.071 Vali Loss: 0.507 Vali Acc: 0.763 Test Loss: 0.507 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8190958499908447
Epoch: 46, Steps: 10 | Train Loss: 0.064 Vali Loss: 0.521 Vali Acc: 0.776 Test Loss: 0.521 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0248034000396729
Epoch: 47, Steps: 10 | Train Loss: 0.054 Vali Loss: 0.523 Vali Acc: 0.757 Test Loss: 0.523 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9255063533782959
Epoch: 48, Steps: 10 | Train Loss: 0.049 Vali Loss: 0.525 Vali Acc: 0.770 Test Loss: 0.525 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.988837718963623
Epoch: 49, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.530 Vali Acc: 0.789 Test Loss: 0.530 Test Acc: 0.789
Validation loss decreased (-0.776311 --> -0.789468).  Saving model ...
Epoch: 50 cost time: 1.1540024280548096
Epoch: 50, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.533 Vali Acc: 0.783 Test Loss: 0.533 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.1708860397338867
Epoch: 51, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.538 Vali Acc: 0.776 Test Loss: 0.538 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0002546310424805
Epoch: 52, Steps: 10 | Train Loss: 0.037 Vali Loss: 0.547 Vali Acc: 0.770 Test Loss: 0.547 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.252540111541748
Epoch: 53, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.561 Vali Acc: 0.796 Test Loss: 0.561 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796047).  Saving model ...
Epoch: 54 cost time: 1.0983080863952637
Epoch: 54, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.559 Vali Acc: 0.783 Test Loss: 0.559 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.0893213748931885
Epoch: 55, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.570 Vali Acc: 0.776 Test Loss: 0.570 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8504178524017334
Epoch: 56, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.577 Vali Acc: 0.750 Test Loss: 0.577 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.0300722122192383
Epoch: 57, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.593 Vali Acc: 0.776 Test Loss: 0.593 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.2159438133239746
Epoch: 58, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.589 Vali Acc: 0.770 Test Loss: 0.589 Test Acc: 0.770
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 1.037900447845459
Epoch: 59, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.596 Vali Acc: 0.776 Test Loss: 0.596 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.7553315162658691
Epoch: 60, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.604 Vali Acc: 0.783 Test Loss: 0.604 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.9123961925506592
Epoch: 61, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.606 Vali Acc: 0.757 Test Loss: 0.606 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.935483455657959
Epoch: 62, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.614 Vali Acc: 0.750 Test Loss: 0.614 Test Acc: 0.750
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.9798624515533447
Epoch: 63, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.627 Vali Acc: 0.763 Test Loss: 0.627 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 106044
model size : 1.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.1586220264434814
Epoch: 1, Steps: 10 | Train Loss: 1.372 Vali Loss: 1.342 Vali Acc: 0.342 Test Loss: 1.342 Test Acc: 0.342
Validation loss decreased (inf --> -0.342092).  Saving model ...
Epoch: 2 cost time: 1.1163897514343262
Epoch: 2, Steps: 10 | Train Loss: 1.380 Vali Loss: 1.315 Vali Acc: 0.382 Test Loss: 1.315 Test Acc: 0.382
Validation loss decreased (-0.342092 --> -0.381566).  Saving model ...
Epoch: 3 cost time: 1.1027848720550537
Epoch: 3, Steps: 10 | Train Loss: 1.333 Vali Loss: 1.296 Vali Acc: 0.408 Test Loss: 1.296 Test Acc: 0.408
Validation loss decreased (-0.381566 --> -0.407882).  Saving model ...
Epoch: 4 cost time: 0.9451248645782471
Epoch: 4, Steps: 10 | Train Loss: 1.305 Vali Loss: 1.277 Vali Acc: 0.434 Test Loss: 1.277 Test Acc: 0.434
Validation loss decreased (-0.407882 --> -0.434198).  Saving model ...
Epoch: 5 cost time: 0.8237078189849854
Epoch: 5, Steps: 10 | Train Loss: 1.278 Vali Loss: 1.259 Vali Acc: 0.487 Test Loss: 1.259 Test Acc: 0.487
Validation loss decreased (-0.434198 --> -0.486830).  Saving model ...
Epoch: 6 cost time: 0.8539443016052246
Epoch: 6, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.235 Vali Acc: 0.526 Test Loss: 1.235 Test Acc: 0.526
Validation loss decreased (-0.486830 --> -0.526303).  Saving model ...
Epoch: 7 cost time: 0.908876895904541
Epoch: 7, Steps: 10 | Train Loss: 1.233 Vali Loss: 1.215 Vali Acc: 0.559 Test Loss: 1.215 Test Acc: 0.559
Validation loss decreased (-0.526303 --> -0.559198).  Saving model ...
Epoch: 8 cost time: 0.7410027980804443
Epoch: 8, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.182 Vali Acc: 0.546 Test Loss: 1.182 Test Acc: 0.546
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0002284049987793
Epoch: 9, Steps: 10 | Train Loss: 1.165 Vali Loss: 1.160 Vali Acc: 0.612 Test Loss: 1.160 Test Acc: 0.612
Validation loss decreased (-0.559198 --> -0.611831).  Saving model ...
Epoch: 10 cost time: 1.1512155532836914
Epoch: 10, Steps: 10 | Train Loss: 1.110 Vali Loss: 1.135 Vali Acc: 0.605 Test Loss: 1.135 Test Acc: 0.605
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1155030727386475
Epoch: 11, Steps: 10 | Train Loss: 1.051 Vali Loss: 1.100 Vali Acc: 0.579 Test Loss: 1.100 Test Acc: 0.579
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.020155906677246
Epoch: 12, Steps: 10 | Train Loss: 0.999 Vali Loss: 1.066 Vali Acc: 0.632 Test Loss: 1.066 Test Acc: 0.632
Validation loss decreased (-0.611831 --> -0.631568).  Saving model ...
Epoch: 13 cost time: 0.8923079967498779
Epoch: 13, Steps: 10 | Train Loss: 0.956 Vali Loss: 1.028 Vali Acc: 0.638 Test Loss: 1.028 Test Acc: 0.638
Validation loss decreased (-0.631568 --> -0.638148).  Saving model ...
Epoch: 14 cost time: 0.9575531482696533
Epoch: 14, Steps: 10 | Train Loss: 0.924 Vali Loss: 0.990 Vali Acc: 0.651 Test Loss: 0.990 Test Acc: 0.651
Validation loss decreased (-0.638148 --> -0.651306).  Saving model ...
Epoch: 15 cost time: 0.9446296691894531
Epoch: 15, Steps: 10 | Train Loss: 0.852 Vali Loss: 0.961 Vali Acc: 0.638 Test Loss: 0.961 Test Acc: 0.638
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9317913055419922
Epoch: 16, Steps: 10 | Train Loss: 0.800 Vali Loss: 0.925 Vali Acc: 0.651 Test Loss: 0.925 Test Acc: 0.651
Validation loss decreased (-0.651306 --> -0.651307).  Saving model ...
Epoch: 17 cost time: 0.7808523178100586
Epoch: 17, Steps: 10 | Train Loss: 0.760 Vali Loss: 0.881 Vali Acc: 0.678 Test Loss: 0.881 Test Acc: 0.678
Validation loss decreased (-0.651307 --> -0.677623).  Saving model ...
Epoch: 18 cost time: 1.0886552333831787
Epoch: 18, Steps: 10 | Train Loss: 0.685 Vali Loss: 0.848 Vali Acc: 0.664 Test Loss: 0.848 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7381386756896973
Epoch: 19, Steps: 10 | Train Loss: 0.632 Vali Loss: 0.810 Vali Acc: 0.664 Test Loss: 0.810 Test Acc: 0.664
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7390923500061035
Epoch: 20, Steps: 10 | Train Loss: 0.584 Vali Loss: 0.774 Vali Acc: 0.697 Test Loss: 0.774 Test Acc: 0.697
Validation loss decreased (-0.677623 --> -0.697361).  Saving model ...
Epoch: 21 cost time: 1.0175788402557373
Epoch: 21, Steps: 10 | Train Loss: 0.546 Vali Loss: 0.753 Vali Acc: 0.684 Test Loss: 0.753 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0266177654266357
Epoch: 22, Steps: 10 | Train Loss: 0.508 Vali Loss: 0.721 Vali Acc: 0.671 Test Loss: 0.721 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0863633155822754
Epoch: 23, Steps: 10 | Train Loss: 0.472 Vali Loss: 0.693 Vali Acc: 0.724 Test Loss: 0.693 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 24 cost time: 1.0164475440979004
Epoch: 24, Steps: 10 | Train Loss: 0.456 Vali Loss: 0.668 Vali Acc: 0.730 Test Loss: 0.668 Test Acc: 0.730
Validation loss decreased (-0.723677 --> -0.730256).  Saving model ...
Epoch: 25 cost time: 1.0453293323516846
Epoch: 25, Steps: 10 | Train Loss: 0.395 Vali Loss: 0.644 Vali Acc: 0.730 Test Loss: 0.644 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 26 cost time: 0.8977468013763428
Epoch: 26, Steps: 10 | Train Loss: 0.355 Vali Loss: 0.625 Vali Acc: 0.737 Test Loss: 0.625 Test Acc: 0.737
Validation loss decreased (-0.730257 --> -0.736836).  Saving model ...
Epoch: 27 cost time: 1.071178913116455
Epoch: 27, Steps: 10 | Train Loss: 0.344 Vali Loss: 0.609 Vali Acc: 0.757 Test Loss: 0.609 Test Acc: 0.757
Validation loss decreased (-0.736836 --> -0.756573).  Saving model ...
Epoch: 28 cost time: 0.8486740589141846
Epoch: 28, Steps: 10 | Train Loss: 0.301 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9020893573760986
Epoch: 29, Steps: 10 | Train Loss: 0.280 Vali Loss: 0.575 Vali Acc: 0.730 Test Loss: 0.575 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0414011478424072
Epoch: 30, Steps: 10 | Train Loss: 0.276 Vali Loss: 0.564 Vali Acc: 0.750 Test Loss: 0.564 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9312326908111572
Epoch: 31, Steps: 10 | Train Loss: 0.246 Vali Loss: 0.561 Vali Acc: 0.757 Test Loss: 0.561 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 32 cost time: 0.9308955669403076
Epoch: 32, Steps: 10 | Train Loss: 0.214 Vali Loss: 0.550 Vali Acc: 0.757 Test Loss: 0.550 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 33 cost time: 0.9030554294586182
Epoch: 33, Steps: 10 | Train Loss: 0.219 Vali Loss: 0.545 Vali Acc: 0.743 Test Loss: 0.545 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9993791580200195
Epoch: 34, Steps: 10 | Train Loss: 0.196 Vali Loss: 0.545 Vali Acc: 0.757 Test Loss: 0.545 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 35 cost time: 1.0244262218475342
Epoch: 35, Steps: 10 | Train Loss: 0.179 Vali Loss: 0.538 Vali Acc: 0.750 Test Loss: 0.538 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9648215770721436
Epoch: 36, Steps: 10 | Train Loss: 0.168 Vali Loss: 0.538 Vali Acc: 0.743 Test Loss: 0.538 Test Acc: 0.743
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8797202110290527
Epoch: 37, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.537 Vali Acc: 0.743 Test Loss: 0.537 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9262640476226807
Epoch: 38, Steps: 10 | Train Loss: 0.149 Vali Loss: 0.544 Vali Acc: 0.750 Test Loss: 0.544 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9957163333892822
Epoch: 39, Steps: 10 | Train Loss: 0.136 Vali Loss: 0.537 Vali Acc: 0.737 Test Loss: 0.537 Test Acc: 0.737
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8397400379180908
Epoch: 40, Steps: 10 | Train Loss: 0.132 Vali Loss: 0.541 Vali Acc: 0.750 Test Loss: 0.541 Test Acc: 0.750
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0531959533691406
Epoch: 41, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.541 Vali Acc: 0.737 Test Loss: 0.541 Test Acc: 0.737
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3848459720611572
Epoch: 42, Steps: 10 | Train Loss: 0.121 Vali Loss: 0.542 Vali Acc: 0.737 Test Loss: 0.542 Test Acc: 0.737
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.0371739864349365
Epoch: 43, Steps: 10 | Train Loss: 0.116 Vali Loss: 0.549 Vali Acc: 0.737 Test Loss: 0.549 Test Acc: 0.737
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8054568767547607
Epoch: 44, Steps: 10 | Train Loss: 0.092 Vali Loss: 0.548 Vali Acc: 0.743 Test Loss: 0.548 Test Acc: 0.743
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.756578947368421
model parameter : 81372
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.474191427230835
Epoch: 1, Steps: 10 | Train Loss: 1.461 Vali Loss: 1.436 Vali Acc: 0.230 Test Loss: 1.436 Test Acc: 0.230
Validation loss decreased (inf --> -0.230249).  Saving model ...
Epoch: 2 cost time: 0.9783051013946533
Epoch: 2, Steps: 10 | Train Loss: 1.411 Vali Loss: 1.401 Vali Acc: 0.263 Test Loss: 1.401 Test Acc: 0.263
Validation loss decreased (-0.230249 --> -0.263144).  Saving model ...
Epoch: 3 cost time: 1.5112292766571045
Epoch: 3, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.379 Vali Acc: 0.257 Test Loss: 1.379 Test Acc: 0.257
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.143035650253296
Epoch: 4, Steps: 10 | Train Loss: 1.359 Vali Loss: 1.361 Vali Acc: 0.289 Test Loss: 1.361 Test Acc: 0.289
Validation loss decreased (-0.263144 --> -0.289460).  Saving model ...
Epoch: 5 cost time: 1.3563458919525146
Epoch: 5, Steps: 10 | Train Loss: 1.348 Vali Loss: 1.332 Vali Acc: 0.362 Test Loss: 1.332 Test Acc: 0.362
Validation loss decreased (-0.289460 --> -0.361829).  Saving model ...
Epoch: 6 cost time: 1.0120947360992432
Epoch: 6, Steps: 10 | Train Loss: 1.311 Vali Loss: 1.309 Vali Acc: 0.382 Test Loss: 1.309 Test Acc: 0.382
Validation loss decreased (-0.361829 --> -0.381566).  Saving model ...
Epoch: 7 cost time: 1.1017487049102783
Epoch: 7, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.281 Vali Acc: 0.434 Test Loss: 1.281 Test Acc: 0.434
Validation loss decreased (-0.381566 --> -0.434198).  Saving model ...
Epoch: 8 cost time: 0.9069507122039795
Epoch: 8, Steps: 10 | Train Loss: 1.174 Vali Loss: 1.249 Vali Acc: 0.507 Test Loss: 1.249 Test Acc: 0.507
Validation loss decreased (-0.434198 --> -0.506566).  Saving model ...
Epoch: 9 cost time: 1.3298733234405518
Epoch: 9, Steps: 10 | Train Loss: 1.195 Vali Loss: 1.229 Vali Acc: 0.546 Test Loss: 1.229 Test Acc: 0.546
Validation loss decreased (-0.506566 --> -0.546040).  Saving model ...
Epoch: 10 cost time: 1.1949462890625
Epoch: 10, Steps: 10 | Train Loss: 1.154 Vali Loss: 1.185 Vali Acc: 0.566 Test Loss: 1.185 Test Acc: 0.566
Validation loss decreased (-0.546040 --> -0.565778).  Saving model ...
Epoch: 11 cost time: 1.1722705364227295
Epoch: 11, Steps: 10 | Train Loss: 1.084 Vali Loss: 1.151 Vali Acc: 0.566 Test Loss: 1.151 Test Acc: 0.566
Validation loss decreased (-0.565778 --> -0.565778).  Saving model ...
Epoch: 12 cost time: 1.0170774459838867
Epoch: 12, Steps: 10 | Train Loss: 1.040 Vali Loss: 1.123 Vali Acc: 0.566 Test Loss: 1.123 Test Acc: 0.566
Validation loss decreased (-0.565778 --> -0.565778).  Saving model ...
Epoch: 13 cost time: 1.1260809898376465
Epoch: 13, Steps: 10 | Train Loss: 0.984 Vali Loss: 1.079 Vali Acc: 0.579 Test Loss: 1.079 Test Acc: 0.579
Validation loss decreased (-0.565778 --> -0.578937).  Saving model ...
Epoch: 14 cost time: 1.4073834419250488
Epoch: 14, Steps: 10 | Train Loss: 0.967 Vali Loss: 1.039 Vali Acc: 0.586 Test Loss: 1.039 Test Acc: 0.586
Validation loss decreased (-0.578937 --> -0.585516).  Saving model ...
Epoch: 15 cost time: 1.268019199371338
Epoch: 15, Steps: 10 | Train Loss: 0.866 Vali Loss: 1.004 Vali Acc: 0.592 Test Loss: 1.004 Test Acc: 0.592
Validation loss decreased (-0.585516 --> -0.592095).  Saving model ...
Epoch: 16 cost time: 1.2797281742095947
Epoch: 16, Steps: 10 | Train Loss: 0.844 Vali Loss: 0.967 Vali Acc: 0.612 Test Loss: 0.967 Test Acc: 0.612
Validation loss decreased (-0.592095 --> -0.611832).  Saving model ...
Epoch: 17 cost time: 1.4089875221252441
Epoch: 17, Steps: 10 | Train Loss: 0.787 Vali Loss: 0.929 Vali Acc: 0.638 Test Loss: 0.929 Test Acc: 0.638
Validation loss decreased (-0.611832 --> -0.638149).  Saving model ...
Epoch: 18 cost time: 1.131500482559204
Epoch: 18, Steps: 10 | Train Loss: 0.723 Vali Loss: 0.888 Vali Acc: 0.658 Test Loss: 0.888 Test Acc: 0.658
Validation loss decreased (-0.638149 --> -0.657886).  Saving model ...
Epoch: 19 cost time: 1.0494647026062012
Epoch: 19, Steps: 10 | Train Loss: 0.697 Vali Loss: 0.858 Vali Acc: 0.651 Test Loss: 0.858 Test Acc: 0.651
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2679405212402344
Epoch: 20, Steps: 10 | Train Loss: 0.633 Vali Loss: 0.830 Vali Acc: 0.658 Test Loss: 0.830 Test Acc: 0.658
Validation loss decreased (-0.657886 --> -0.657886).  Saving model ...
Epoch: 21 cost time: 1.0947120189666748
Epoch: 21, Steps: 10 | Train Loss: 0.586 Vali Loss: 0.790 Vali Acc: 0.678 Test Loss: 0.790 Test Acc: 0.678
Validation loss decreased (-0.657886 --> -0.677624).  Saving model ...
Epoch: 22 cost time: 1.2839770317077637
Epoch: 22, Steps: 10 | Train Loss: 0.559 Vali Loss: 0.759 Vali Acc: 0.671 Test Loss: 0.759 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4405159950256348
Epoch: 23, Steps: 10 | Train Loss: 0.499 Vali Loss: 0.729 Vali Acc: 0.717 Test Loss: 0.729 Test Acc: 0.717
Validation loss decreased (-0.677624 --> -0.717098).  Saving model ...
Epoch: 24 cost time: 1.1065349578857422
Epoch: 24, Steps: 10 | Train Loss: 0.471 Vali Loss: 0.695 Vali Acc: 0.684 Test Loss: 0.695 Test Acc: 0.684
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4548194408416748
Epoch: 25, Steps: 10 | Train Loss: 0.422 Vali Loss: 0.661 Vali Acc: 0.737 Test Loss: 0.661 Test Acc: 0.737
Validation loss decreased (-0.717098 --> -0.736835).  Saving model ...
Epoch: 26 cost time: 1.1688868999481201
Epoch: 26, Steps: 10 | Train Loss: 0.401 Vali Loss: 0.633 Vali Acc: 0.743 Test Loss: 0.633 Test Acc: 0.743
Validation loss decreased (-0.736835 --> -0.743415).  Saving model ...
Epoch: 27 cost time: 1.2437169551849365
Epoch: 27, Steps: 10 | Train Loss: 0.357 Vali Loss: 0.612 Vali Acc: 0.750 Test Loss: 0.612 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 28 cost time: 1.0923030376434326
Epoch: 28, Steps: 10 | Train Loss: 0.328 Vali Loss: 0.593 Vali Acc: 0.770 Test Loss: 0.593 Test Acc: 0.770
Validation loss decreased (-0.749994 --> -0.769731).  Saving model ...
Epoch: 29 cost time: 1.2282688617706299
Epoch: 29, Steps: 10 | Train Loss: 0.292 Vali Loss: 0.573 Vali Acc: 0.763 Test Loss: 0.573 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.118405818939209
Epoch: 30, Steps: 10 | Train Loss: 0.263 Vali Loss: 0.557 Vali Acc: 0.757 Test Loss: 0.557 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2958617210388184
Epoch: 31, Steps: 10 | Train Loss: 0.252 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769731).  Saving model ...
Epoch: 32 cost time: 1.0849347114562988
Epoch: 32, Steps: 10 | Train Loss: 0.231 Vali Loss: 0.538 Vali Acc: 0.743 Test Loss: 0.538 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2233610153198242
Epoch: 33, Steps: 10 | Train Loss: 0.210 Vali Loss: 0.534 Vali Acc: 0.757 Test Loss: 0.534 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.2603354454040527
Epoch: 34, Steps: 10 | Train Loss: 0.195 Vali Loss: 0.521 Vali Acc: 0.763 Test Loss: 0.521 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.8409044742584229
Epoch: 35, Steps: 10 | Train Loss: 0.192 Vali Loss: 0.515 Vali Acc: 0.750 Test Loss: 0.515 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0932509899139404
Epoch: 36, Steps: 10 | Train Loss: 0.201 Vali Loss: 0.514 Vali Acc: 0.770 Test Loss: 0.514 Test Acc: 0.770
Validation loss decreased (-0.769731 --> -0.769732).  Saving model ...
Epoch: 37 cost time: 0.966611385345459
Epoch: 37, Steps: 10 | Train Loss: 0.160 Vali Loss: 0.510 Vali Acc: 0.763 Test Loss: 0.510 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1731278896331787
Epoch: 38, Steps: 10 | Train Loss: 0.142 Vali Loss: 0.509 Vali Acc: 0.757 Test Loss: 0.509 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3152358531951904
Epoch: 39, Steps: 10 | Train Loss: 0.159 Vali Loss: 0.509 Vali Acc: 0.743 Test Loss: 0.509 Test Acc: 0.743
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.1757309436798096
Epoch: 40, Steps: 10 | Train Loss: 0.131 Vali Loss: 0.497 Vali Acc: 0.757 Test Loss: 0.497 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2743091583251953
Epoch: 41, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.493 Vali Acc: 0.743 Test Loss: 0.493 Test Acc: 0.743
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.1630265712738037
Epoch: 42, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.489 Vali Acc: 0.743 Test Loss: 0.489 Test Acc: 0.743
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.2284424304962158
Epoch: 43, Steps: 10 | Train Loss: 0.120 Vali Loss: 0.496 Vali Acc: 0.757 Test Loss: 0.496 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0387465953826904
Epoch: 44, Steps: 10 | Train Loss: 0.113 Vali Loss: 0.489 Vali Acc: 0.763 Test Loss: 0.489 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.147646188735962
Epoch: 45, Steps: 10 | Train Loss: 0.091 Vali Loss: 0.494 Vali Acc: 0.757 Test Loss: 0.494 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.276440143585205
Epoch: 46, Steps: 10 | Train Loss: 0.090 Vali Loss: 0.495 Vali Acc: 0.763 Test Loss: 0.495 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7697368421052632
model parameter : 81276
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 2.994447708129883
Epoch: 1, Steps: 10 | Train Loss: 1.547 Vali Loss: 1.488 Vali Acc: 0.276 Test Loss: 1.488 Test Acc: 0.276
Validation loss decreased (inf --> -0.276301).  Saving model ...
Epoch: 2 cost time: 1.2841627597808838
Epoch: 2, Steps: 10 | Train Loss: 1.484 Vali Loss: 1.426 Vali Acc: 0.283 Test Loss: 1.426 Test Acc: 0.283
Validation loss decreased (-0.276301 --> -0.282880).  Saving model ...
Epoch: 3 cost time: 1.2401771545410156
Epoch: 3, Steps: 10 | Train Loss: 1.425 Vali Loss: 1.394 Vali Acc: 0.250 Test Loss: 1.394 Test Acc: 0.250
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.961801290512085
Epoch: 4, Steps: 10 | Train Loss: 1.429 Vali Loss: 1.374 Vali Acc: 0.303 Test Loss: 1.374 Test Acc: 0.303
Validation loss decreased (-0.282880 --> -0.302618).  Saving model ...
Epoch: 5 cost time: 0.9038128852844238
Epoch: 5, Steps: 10 | Train Loss: 1.382 Vali Loss: 1.352 Vali Acc: 0.316 Test Loss: 1.352 Test Acc: 0.316
Validation loss decreased (-0.302618 --> -0.315776).  Saving model ...
Epoch: 6 cost time: 1.113262414932251
Epoch: 6, Steps: 10 | Train Loss: 1.369 Vali Loss: 1.333 Vali Acc: 0.349 Test Loss: 1.333 Test Acc: 0.349
Validation loss decreased (-0.315776 --> -0.348671).  Saving model ...
Epoch: 7 cost time: 1.0799832344055176
Epoch: 7, Steps: 10 | Train Loss: 1.324 Vali Loss: 1.307 Vali Acc: 0.362 Test Loss: 1.307 Test Acc: 0.362
Validation loss decreased (-0.348671 --> -0.361829).  Saving model ...
Epoch: 8 cost time: 0.9895472526550293
Epoch: 8, Steps: 10 | Train Loss: 1.274 Vali Loss: 1.274 Vali Acc: 0.395 Test Loss: 1.274 Test Acc: 0.395
Validation loss decreased (-0.361829 --> -0.394724).  Saving model ...
Epoch: 9 cost time: 1.241769790649414
Epoch: 9, Steps: 10 | Train Loss: 1.248 Vali Loss: 1.251 Vali Acc: 0.441 Test Loss: 1.251 Test Acc: 0.441
Validation loss decreased (-0.394724 --> -0.440777).  Saving model ...
Epoch: 10 cost time: 1.0768756866455078
Epoch: 10, Steps: 10 | Train Loss: 1.193 Vali Loss: 1.218 Vali Acc: 0.513 Test Loss: 1.218 Test Acc: 0.513
Validation loss decreased (-0.440777 --> -0.513146).  Saving model ...
Epoch: 11 cost time: 1.4424967765808105
Epoch: 11, Steps: 10 | Train Loss: 1.171 Vali Loss: 1.190 Vali Acc: 0.599 Test Loss: 1.190 Test Acc: 0.599
Validation loss decreased (-0.513146 --> -0.598672).  Saving model ...
Epoch: 12 cost time: 1.0164990425109863
Epoch: 12, Steps: 10 | Train Loss: 1.074 Vali Loss: 1.152 Vali Acc: 0.586 Test Loss: 1.152 Test Acc: 0.586
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.113487958908081
Epoch: 13, Steps: 10 | Train Loss: 1.071 Vali Loss: 1.127 Vali Acc: 0.618 Test Loss: 1.127 Test Acc: 0.618
Validation loss decreased (-0.598672 --> -0.618410).  Saving model ...
Epoch: 14 cost time: 1.1297640800476074
Epoch: 14, Steps: 10 | Train Loss: 0.965 Vali Loss: 1.081 Vali Acc: 0.618 Test Loss: 1.081 Test Acc: 0.618
Validation loss decreased (-0.618410 --> -0.618410).  Saving model ...
Epoch: 15 cost time: 1.045060157775879
Epoch: 15, Steps: 10 | Train Loss: 0.940 Vali Loss: 1.042 Vali Acc: 0.612 Test Loss: 1.042 Test Acc: 0.612
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1468019485473633
Epoch: 16, Steps: 10 | Train Loss: 0.890 Vali Loss: 1.002 Vali Acc: 0.638 Test Loss: 1.002 Test Acc: 0.638
Validation loss decreased (-0.618410 --> -0.638148).  Saving model ...
Epoch: 17 cost time: 1.1034722328186035
Epoch: 17, Steps: 10 | Train Loss: 0.863 Vali Loss: 0.966 Vali Acc: 0.645 Test Loss: 0.966 Test Acc: 0.645
Validation loss decreased (-0.638148 --> -0.644727).  Saving model ...
Epoch: 18 cost time: 1.2594244480133057
Epoch: 18, Steps: 10 | Train Loss: 0.807 Vali Loss: 0.932 Vali Acc: 0.625 Test Loss: 0.932 Test Acc: 0.625
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.153898000717163
Epoch: 19, Steps: 10 | Train Loss: 0.754 Vali Loss: 0.893 Vali Acc: 0.645 Test Loss: 0.893 Test Acc: 0.645
Validation loss decreased (-0.644727 --> -0.644728).  Saving model ...
Epoch: 20 cost time: 1.2672607898712158
Epoch: 20, Steps: 10 | Train Loss: 0.677 Vali Loss: 0.852 Vali Acc: 0.691 Test Loss: 0.852 Test Acc: 0.691
Validation loss decreased (-0.644728 --> -0.690781).  Saving model ...
Epoch: 21 cost time: 1.2537610530853271
Epoch: 21, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.822 Vali Acc: 0.717 Test Loss: 0.822 Test Acc: 0.717
Validation loss decreased (-0.690781 --> -0.717097).  Saving model ...
Epoch: 22 cost time: 1.5189003944396973
Epoch: 22, Steps: 10 | Train Loss: 0.583 Vali Loss: 0.786 Vali Acc: 0.691 Test Loss: 0.786 Test Acc: 0.691
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9597373008728027
Epoch: 23, Steps: 10 | Train Loss: 0.531 Vali Loss: 0.748 Vali Acc: 0.691 Test Loss: 0.748 Test Acc: 0.691
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1132090091705322
Epoch: 24, Steps: 10 | Train Loss: 0.528 Vali Loss: 0.721 Vali Acc: 0.730 Test Loss: 0.721 Test Acc: 0.730
Validation loss decreased (-0.717097 --> -0.730256).  Saving model ...
Epoch: 25 cost time: 1.003727912902832
Epoch: 25, Steps: 10 | Train Loss: 0.455 Vali Loss: 0.687 Vali Acc: 0.724 Test Loss: 0.687 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1845784187316895
Epoch: 26, Steps: 10 | Train Loss: 0.420 Vali Loss: 0.663 Vali Acc: 0.724 Test Loss: 0.663 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0329878330230713
Epoch: 27, Steps: 10 | Train Loss: 0.379 Vali Loss: 0.646 Vali Acc: 0.730 Test Loss: 0.646 Test Acc: 0.730
Validation loss decreased (-0.730256 --> -0.730257).  Saving model ...
Epoch: 28 cost time: 1.0878114700317383
Epoch: 28, Steps: 10 | Train Loss: 0.347 Vali Loss: 0.621 Vali Acc: 0.743 Test Loss: 0.621 Test Acc: 0.743
Validation loss decreased (-0.730257 --> -0.743415).  Saving model ...
Epoch: 29 cost time: 1.0908663272857666
Epoch: 29, Steps: 10 | Train Loss: 0.327 Vali Loss: 0.611 Vali Acc: 0.724 Test Loss: 0.611 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.114548921585083
Epoch: 30, Steps: 10 | Train Loss: 0.298 Vali Loss: 0.591 Vali Acc: 0.750 Test Loss: 0.591 Test Acc: 0.750
Validation loss decreased (-0.743415 --> -0.749994).  Saving model ...
Epoch: 31 cost time: 1.3428642749786377
Epoch: 31, Steps: 10 | Train Loss: 0.282 Vali Loss: 0.589 Vali Acc: 0.757 Test Loss: 0.589 Test Acc: 0.757
Validation loss decreased (-0.749994 --> -0.756573).  Saving model ...
Epoch: 32 cost time: 1.2015972137451172
Epoch: 32, Steps: 10 | Train Loss: 0.256 Vali Loss: 0.566 Vali Acc: 0.743 Test Loss: 0.566 Test Acc: 0.743
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.207446813583374
Epoch: 33, Steps: 10 | Train Loss: 0.254 Vali Loss: 0.559 Vali Acc: 0.750 Test Loss: 0.559 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.0846219062805176
Epoch: 34, Steps: 10 | Train Loss: 0.224 Vali Loss: 0.548 Vali Acc: 0.750 Test Loss: 0.548 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.089895248413086
Epoch: 35, Steps: 10 | Train Loss: 0.200 Vali Loss: 0.539 Vali Acc: 0.750 Test Loss: 0.539 Test Acc: 0.750
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0839316844940186
Epoch: 36, Steps: 10 | Train Loss: 0.198 Vali Loss: 0.533 Vali Acc: 0.776 Test Loss: 0.533 Test Acc: 0.776
Validation loss decreased (-0.756573 --> -0.776310).  Saving model ...
Epoch: 37 cost time: 1.032597303390503
Epoch: 37, Steps: 10 | Train Loss: 0.152 Vali Loss: 0.529 Vali Acc: 0.750 Test Loss: 0.529 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0452513694763184
Epoch: 38, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.524 Vali Acc: 0.750 Test Loss: 0.524 Test Acc: 0.750
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.4585559368133545
Epoch: 39, Steps: 10 | Train Loss: 0.151 Vali Loss: 0.516 Vali Acc: 0.770 Test Loss: 0.516 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.3806872367858887
Epoch: 40, Steps: 10 | Train Loss: 0.128 Vali Loss: 0.521 Vali Acc: 0.757 Test Loss: 0.521 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.127638339996338
Epoch: 41, Steps: 10 | Train Loss: 0.126 Vali Loss: 0.527 Vali Acc: 0.757 Test Loss: 0.527 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.121938943862915
Epoch: 42, Steps: 10 | Train Loss: 0.118 Vali Loss: 0.531 Vali Acc: 0.757 Test Loss: 0.531 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.1469676494598389
Epoch: 43, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.529 Vali Acc: 0.757 Test Loss: 0.529 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0230891704559326
Epoch: 44, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.531 Vali Acc: 0.757 Test Loss: 0.531 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.0306413173675537
Epoch: 45, Steps: 10 | Train Loss: 0.099 Vali Loss: 0.535 Vali Acc: 0.763 Test Loss: 0.535 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.2783432006835938
Epoch: 46, Steps: 10 | Train Loss: 0.094 Vali Loss: 0.526 Vali Acc: 0.776 Test Loss: 0.526 Test Acc: 0.776
Validation loss decreased (-0.776310 --> -0.776311).  Saving model ...
Epoch: 47 cost time: 1.2036325931549072
Epoch: 47, Steps: 10 | Train Loss: 0.097 Vali Loss: 0.531 Vali Acc: 0.757 Test Loss: 0.531 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.2415831089019775
Epoch: 48, Steps: 10 | Train Loss: 0.075 Vali Loss: 0.540 Vali Acc: 0.770 Test Loss: 0.540 Test Acc: 0.770
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.260141372680664
Epoch: 49, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.545 Vali Acc: 0.770 Test Loss: 0.545 Test Acc: 0.770
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.5144972801208496
Epoch: 50, Steps: 10 | Train Loss: 0.060 Vali Loss: 0.554 Vali Acc: 0.763 Test Loss: 0.554 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0513699054718018
Epoch: 51, Steps: 10 | Train Loss: 0.050 Vali Loss: 0.560 Vali Acc: 0.763 Test Loss: 0.560 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9964280128479004
Epoch: 52, Steps: 10 | Train Loss: 0.052 Vali Loss: 0.571 Vali Acc: 0.770 Test Loss: 0.571 Test Acc: 0.770
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.0729808807373047
Epoch: 53, Steps: 10 | Train Loss: 0.056 Vali Loss: 0.573 Vali Acc: 0.783 Test Loss: 0.573 Test Acc: 0.783
Validation loss decreased (-0.776311 --> -0.782889).  Saving model ...
Epoch: 54 cost time: 1.0174076557159424
Epoch: 54, Steps: 10 | Train Loss: 0.044 Vali Loss: 0.581 Vali Acc: 0.783 Test Loss: 0.581 Test Acc: 0.783
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1057345867156982
Epoch: 55, Steps: 10 | Train Loss: 0.039 Vali Loss: 0.599 Vali Acc: 0.789 Test Loss: 0.599 Test Acc: 0.789
Validation loss decreased (-0.782889 --> -0.789468).  Saving model ...
Epoch: 56 cost time: 1.0864546298980713
Epoch: 56, Steps: 10 | Train Loss: 0.036 Vali Loss: 0.619 Vali Acc: 0.770 Test Loss: 0.619 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1059563159942627
Epoch: 57, Steps: 10 | Train Loss: 0.038 Vali Loss: 0.634 Vali Acc: 0.783 Test Loss: 0.634 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 1.7572448253631592
Epoch: 58, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.631 Vali Acc: 0.776 Test Loss: 0.631 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.0046672821044922
Epoch: 59, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.651 Vali Acc: 0.770 Test Loss: 0.651 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.0724847316741943
Epoch: 60, Steps: 10 | Train Loss: 0.031 Vali Loss: 0.652 Vali Acc: 0.776 Test Loss: 0.652 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.124962329864502
Epoch: 61, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.652 Vali Acc: 0.776 Test Loss: 0.652 Test Acc: 0.776
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.0616962909698486
Epoch: 62, Steps: 10 | Train Loss: 0.025 Vali Loss: 0.663 Vali Acc: 0.796 Test Loss: 0.663 Test Acc: 0.796
Validation loss decreased (-0.789468 --> -0.796046).  Saving model ...
Epoch: 63 cost time: 1.2034800052642822
Epoch: 63, Steps: 10 | Train Loss: 0.021 Vali Loss: 0.666 Vali Acc: 0.770 Test Loss: 0.666 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.2062735557556152
Epoch: 64, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.676 Vali Acc: 0.776 Test Loss: 0.676 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.0816996097564697
Epoch: 65, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.693 Vali Acc: 0.776 Test Loss: 0.693 Test Acc: 0.776
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 1.09488844871521
Epoch: 66, Steps: 10 | Train Loss: 0.017 Vali Loss: 0.703 Vali Acc: 0.770 Test Loss: 0.703 Test Acc: 0.770
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.9185380935668945
Epoch: 67, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.707 Vali Acc: 0.776 Test Loss: 0.707 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.1550052165985107
Epoch: 68, Steps: 10 | Train Loss: 0.019 Vali Loss: 0.712 Vali Acc: 0.789 Test Loss: 0.712 Test Acc: 0.789
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.1446945667266846
Epoch: 69, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.705 Vali Acc: 0.783 Test Loss: 0.705 Test Acc: 0.783
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 1.2314612865447998
Epoch: 70, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.747 Vali Acc: 0.783 Test Loss: 0.747 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 1.1603453159332275
Epoch: 71, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.747 Vali Acc: 0.789 Test Loss: 0.747 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 1.0795059204101562
Epoch: 72, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 81180
model size : 0.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_RacketSports    Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/RacketSports
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             6                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

151
152
>>>>>>>start training : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
151
152
152
Epoch: 1 cost time: 3.524019479751587
Epoch: 1, Steps: 10 | Train Loss: 1.473 Vali Loss: 1.456 Vali Acc: 0.289 Test Loss: 1.456 Test Acc: 0.289
Validation loss decreased (inf --> -0.289459).  Saving model ...
Epoch: 2 cost time: 1.0942301750183105
Epoch: 2, Steps: 10 | Train Loss: 1.460 Vali Loss: 1.420 Vali Acc: 0.276 Test Loss: 1.420 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0315473079681396
Epoch: 3, Steps: 10 | Train Loss: 1.407 Vali Loss: 1.395 Vali Acc: 0.309 Test Loss: 1.395 Test Acc: 0.309
Validation loss decreased (-0.289459 --> -0.309197).  Saving model ...
Epoch: 4 cost time: 0.9706099033355713
Epoch: 4, Steps: 10 | Train Loss: 1.352 Vali Loss: 1.373 Vali Acc: 0.349 Test Loss: 1.373 Test Acc: 0.349
Validation loss decreased (-0.309197 --> -0.348670).  Saving model ...
Epoch: 5 cost time: 0.921612024307251
Epoch: 5, Steps: 10 | Train Loss: 1.370 Vali Loss: 1.352 Vali Acc: 0.368 Test Loss: 1.352 Test Acc: 0.368
Validation loss decreased (-0.348670 --> -0.368408).  Saving model ...
Epoch: 6 cost time: 0.9658792018890381
Epoch: 6, Steps: 10 | Train Loss: 1.294 Vali Loss: 1.331 Vali Acc: 0.408 Test Loss: 1.331 Test Acc: 0.408
Validation loss decreased (-0.368408 --> -0.407881).  Saving model ...
Epoch: 7 cost time: 1.0674107074737549
Epoch: 7, Steps: 10 | Train Loss: 1.282 Vali Loss: 1.307 Vali Acc: 0.428 Test Loss: 1.307 Test Acc: 0.428
Validation loss decreased (-0.407881 --> -0.427619).  Saving model ...
Epoch: 8 cost time: 1.1482641696929932
Epoch: 8, Steps: 10 | Train Loss: 1.249 Vali Loss: 1.279 Vali Acc: 0.441 Test Loss: 1.279 Test Acc: 0.441
Validation loss decreased (-0.427619 --> -0.440777).  Saving model ...
Epoch: 9 cost time: 1.058612585067749
Epoch: 9, Steps: 10 | Train Loss: 1.191 Vali Loss: 1.256 Vali Acc: 0.454 Test Loss: 1.256 Test Acc: 0.454
Validation loss decreased (-0.440777 --> -0.453935).  Saving model ...
Epoch: 10 cost time: 1.1224305629730225
Epoch: 10, Steps: 10 | Train Loss: 1.143 Vali Loss: 1.215 Vali Acc: 0.441 Test Loss: 1.215 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2413299083709717
Epoch: 11, Steps: 10 | Train Loss: 1.105 Vali Loss: 1.186 Vali Acc: 0.493 Test Loss: 1.186 Test Acc: 0.493
Validation loss decreased (-0.453935 --> -0.493409).  Saving model ...
Epoch: 12 cost time: 1.5004467964172363
Epoch: 12, Steps: 10 | Train Loss: 1.046 Vali Loss: 1.153 Vali Acc: 0.513 Test Loss: 1.153 Test Acc: 0.513
Validation loss decreased (-0.493409 --> -0.513146).  Saving model ...
Epoch: 13 cost time: 1.2706186771392822
Epoch: 13, Steps: 10 | Train Loss: 1.013 Vali Loss: 1.128 Vali Acc: 0.520 Test Loss: 1.128 Test Acc: 0.520
Validation loss decreased (-0.513146 --> -0.519726).  Saving model ...
Epoch: 14 cost time: 1.1096456050872803
Epoch: 14, Steps: 10 | Train Loss: 0.968 Vali Loss: 1.087 Vali Acc: 0.572 Test Loss: 1.087 Test Acc: 0.572
Validation loss decreased (-0.519726 --> -0.572358).  Saving model ...
Epoch: 15 cost time: 1.200671672821045
Epoch: 15, Steps: 10 | Train Loss: 0.891 Vali Loss: 1.050 Vali Acc: 0.605 Test Loss: 1.050 Test Acc: 0.605
Validation loss decreased (-0.572358 --> -0.605253).  Saving model ...
Epoch: 16 cost time: 1.2417054176330566
Epoch: 16, Steps: 10 | Train Loss: 0.855 Vali Loss: 1.010 Vali Acc: 0.618 Test Loss: 1.010 Test Acc: 0.618
Validation loss decreased (-0.605253 --> -0.618411).  Saving model ...
Epoch: 17 cost time: 1.1110544204711914
Epoch: 17, Steps: 10 | Train Loss: 0.823 Vali Loss: 0.977 Vali Acc: 0.645 Test Loss: 0.977 Test Acc: 0.645
Validation loss decreased (-0.618411 --> -0.644727).  Saving model ...
Epoch: 18 cost time: 1.0625064373016357
Epoch: 18, Steps: 10 | Train Loss: 0.747 Vali Loss: 0.940 Vali Acc: 0.632 Test Loss: 0.940 Test Acc: 0.632
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9901487827301025
Epoch: 19, Steps: 10 | Train Loss: 0.701 Vali Loss: 0.906 Vali Acc: 0.599 Test Loss: 0.906 Test Acc: 0.599
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3328945636749268
Epoch: 20, Steps: 10 | Train Loss: 0.649 Vali Loss: 0.869 Vali Acc: 0.678 Test Loss: 0.869 Test Acc: 0.678
Validation loss decreased (-0.644727 --> -0.677623).  Saving model ...
Epoch: 21 cost time: 1.0929853916168213
Epoch: 21, Steps: 10 | Train Loss: 0.613 Vali Loss: 0.839 Vali Acc: 0.664 Test Loss: 0.839 Test Acc: 0.664
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4450712203979492
Epoch: 22, Steps: 10 | Train Loss: 0.549 Vali Loss: 0.803 Vali Acc: 0.658 Test Loss: 0.803 Test Acc: 0.658
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9822092056274414
Epoch: 23, Steps: 10 | Train Loss: 0.516 Vali Loss: 0.766 Vali Acc: 0.691 Test Loss: 0.766 Test Acc: 0.691
Validation loss decreased (-0.677623 --> -0.690782).  Saving model ...
Epoch: 24 cost time: 1.0183765888214111
Epoch: 24, Steps: 10 | Train Loss: 0.473 Vali Loss: 0.733 Vali Acc: 0.691 Test Loss: 0.733 Test Acc: 0.691
Validation loss decreased (-0.690782 --> -0.690782).  Saving model ...
Epoch: 25 cost time: 1.0684716701507568
Epoch: 25, Steps: 10 | Train Loss: 0.446 Vali Loss: 0.705 Vali Acc: 0.697 Test Loss: 0.705 Test Acc: 0.697
Validation loss decreased (-0.690782 --> -0.697361).  Saving model ...
Epoch: 26 cost time: 1.252126693725586
Epoch: 26, Steps: 10 | Train Loss: 0.373 Vali Loss: 0.675 Vali Acc: 0.724 Test Loss: 0.675 Test Acc: 0.724
Validation loss decreased (-0.697361 --> -0.723677).  Saving model ...
Epoch: 27 cost time: 0.9485747814178467
Epoch: 27, Steps: 10 | Train Loss: 0.361 Vali Loss: 0.649 Vali Acc: 0.724 Test Loss: 0.649 Test Acc: 0.724
Validation loss decreased (-0.723677 --> -0.723678).  Saving model ...
Epoch: 28 cost time: 0.9604454040527344
Epoch: 28, Steps: 10 | Train Loss: 0.320 Vali Loss: 0.626 Vali Acc: 0.737 Test Loss: 0.626 Test Acc: 0.737
Validation loss decreased (-0.723678 --> -0.736836).  Saving model ...
Epoch: 29 cost time: 1.0848267078399658
Epoch: 29, Steps: 10 | Train Loss: 0.300 Vali Loss: 0.609 Vali Acc: 0.724 Test Loss: 0.609 Test Acc: 0.724
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1724398136138916
Epoch: 30, Steps: 10 | Train Loss: 0.272 Vali Loss: 0.595 Vali Acc: 0.737 Test Loss: 0.595 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 31 cost time: 0.9953916072845459
Epoch: 31, Steps: 10 | Train Loss: 0.271 Vali Loss: 0.595 Vali Acc: 0.717 Test Loss: 0.595 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1639726161956787
Epoch: 32, Steps: 10 | Train Loss: 0.242 Vali Loss: 0.579 Vali Acc: 0.737 Test Loss: 0.579 Test Acc: 0.737
Validation loss decreased (-0.736836 --> -0.736836).  Saving model ...
Epoch: 33 cost time: 0.9433610439300537
Epoch: 33, Steps: 10 | Train Loss: 0.230 Vali Loss: 0.579 Vali Acc: 0.711 Test Loss: 0.579 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.982499361038208
Epoch: 34, Steps: 10 | Train Loss: 0.207 Vali Loss: 0.557 Vali Acc: 0.724 Test Loss: 0.557 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9524810314178467
Epoch: 35, Steps: 10 | Train Loss: 0.180 Vali Loss: 0.550 Vali Acc: 0.724 Test Loss: 0.550 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.065852403640747
Epoch: 36, Steps: 10 | Train Loss: 0.157 Vali Loss: 0.553 Vali Acc: 0.730 Test Loss: 0.553 Test Acc: 0.730
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9014203548431396
Epoch: 37, Steps: 10 | Train Loss: 0.158 Vali Loss: 0.553 Vali Acc: 0.743 Test Loss: 0.553 Test Acc: 0.743
Validation loss decreased (-0.736836 --> -0.743416).  Saving model ...
Epoch: 38 cost time: 0.9846630096435547
Epoch: 38, Steps: 10 | Train Loss: 0.156 Vali Loss: 0.553 Vali Acc: 0.730 Test Loss: 0.553 Test Acc: 0.730
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8741986751556396
Epoch: 39, Steps: 10 | Train Loss: 0.154 Vali Loss: 0.554 Vali Acc: 0.730 Test Loss: 0.554 Test Acc: 0.730
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.016226053237915
Epoch: 40, Steps: 10 | Train Loss: 0.146 Vali Loss: 0.545 Vali Acc: 0.737 Test Loss: 0.545 Test Acc: 0.737
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8841292858123779
Epoch: 41, Steps: 10 | Train Loss: 0.127 Vali Loss: 0.542 Vali Acc: 0.750 Test Loss: 0.542 Test Acc: 0.750
Validation loss decreased (-0.743416 --> -0.749995).  Saving model ...
Epoch: 42 cost time: 1.1011590957641602
Epoch: 42, Steps: 10 | Train Loss: 0.119 Vali Loss: 0.545 Vali Acc: 0.750 Test Loss: 0.545 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9917266368865967
Epoch: 43, Steps: 10 | Train Loss: 0.108 Vali Loss: 0.564 Vali Acc: 0.757 Test Loss: 0.564 Test Acc: 0.757
Validation loss decreased (-0.749995 --> -0.756573).  Saving model ...
Epoch: 44 cost time: 0.8217296600341797
Epoch: 44, Steps: 10 | Train Loss: 0.095 Vali Loss: 0.549 Vali Acc: 0.750 Test Loss: 0.549 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9200918674468994
Epoch: 45, Steps: 10 | Train Loss: 0.086 Vali Loss: 0.555 Vali Acc: 0.724 Test Loss: 0.555 Test Acc: 0.724
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.9681787490844727
Epoch: 46, Steps: 10 | Train Loss: 0.103 Vali Loss: 0.558 Vali Acc: 0.724 Test Loss: 0.558 Test Acc: 0.724
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.0732882022857666
Epoch: 47, Steps: 10 | Train Loss: 0.079 Vali Loss: 0.555 Vali Acc: 0.743 Test Loss: 0.555 Test Acc: 0.743
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0979647636413574
Epoch: 48, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.558 Vali Acc: 0.757 Test Loss: 0.558 Test Acc: 0.757
Validation loss decreased (-0.756573 --> -0.756573).  Saving model ...
Epoch: 49 cost time: 1.1241700649261475
Epoch: 49, Steps: 10 | Train Loss: 0.065 Vali Loss: 0.567 Vali Acc: 0.757 Test Loss: 0.567 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2279341220855713
Epoch: 50, Steps: 10 | Train Loss: 0.073 Vali Loss: 0.573 Vali Acc: 0.770 Test Loss: 0.573 Test Acc: 0.770
Validation loss decreased (-0.756573 --> -0.769731).  Saving model ...
Epoch: 51 cost time: 1.2364590167999268
Epoch: 51, Steps: 10 | Train Loss: 0.062 Vali Loss: 0.580 Vali Acc: 0.750 Test Loss: 0.580 Test Acc: 0.750
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.254380464553833
Epoch: 52, Steps: 10 | Train Loss: 0.053 Vali Loss: 0.592 Vali Acc: 0.737 Test Loss: 0.592 Test Acc: 0.737
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.3050310611724854
Epoch: 53, Steps: 10 | Train Loss: 0.061 Vali Loss: 0.594 Vali Acc: 0.750 Test Loss: 0.594 Test Acc: 0.750
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.067079782485962
Epoch: 54, Steps: 10 | Train Loss: 0.046 Vali Loss: 0.603 Vali Acc: 0.757 Test Loss: 0.603 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.032181978225708
Epoch: 55, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.605 Vali Acc: 0.763 Test Loss: 0.605 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.9867515563964844
Epoch: 56, Steps: 10 | Train Loss: 0.043 Vali Loss: 0.628 Vali Acc: 0.757 Test Loss: 0.628 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.200963020324707
Epoch: 57, Steps: 10 | Train Loss: 0.042 Vali Loss: 0.623 Vali Acc: 0.757 Test Loss: 0.623 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.9811959266662598
Epoch: 58, Steps: 10 | Train Loss: 0.035 Vali Loss: 0.627 Vali Acc: 0.743 Test Loss: 0.627 Test Acc: 0.743
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.2011890411376953
Epoch: 59, Steps: 10 | Train Loss: 0.030 Vali Loss: 0.646 Vali Acc: 0.776 Test Loss: 0.646 Test Acc: 0.776
Validation loss decreased (-0.769731 --> -0.776309).  Saving model ...
Epoch: 60 cost time: 0.8698515892028809
Epoch: 60, Steps: 10 | Train Loss: 0.040 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.0089094638824463
Epoch: 61, Steps: 10 | Train Loss: 0.032 Vali Loss: 0.658 Vali Acc: 0.776 Test Loss: 0.658 Test Acc: 0.776
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.3565175533294678
Epoch: 62, Steps: 10 | Train Loss: 0.027 Vali Loss: 0.675 Vali Acc: 0.763 Test Loss: 0.675 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.110304832458496
Epoch: 63, Steps: 10 | Train Loss: 0.028 Vali Loss: 0.677 Vali Acc: 0.763 Test Loss: 0.677 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.1085236072540283
Epoch: 64, Steps: 10 | Train Loss: 0.026 Vali Loss: 0.678 Vali Acc: 0.783 Test Loss: 0.678 Test Acc: 0.783
Validation loss decreased (-0.776309 --> -0.782888).  Saving model ...
Epoch: 65 cost time: 0.9182701110839844
Epoch: 65, Steps: 10 | Train Loss: 0.029 Vali Loss: 0.682 Vali Acc: 0.776 Test Loss: 0.682 Test Acc: 0.776
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0157227516174316
Epoch: 66, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.686 Vali Acc: 0.796 Test Loss: 0.686 Test Acc: 0.796
Validation loss decreased (-0.782888 --> -0.796046).  Saving model ...
Epoch: 67 cost time: 1.1055858135223389
Epoch: 67, Steps: 10 | Train Loss: 0.024 Vali Loss: 0.706 Vali Acc: 0.770 Test Loss: 0.706 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.042015552520752
Epoch: 68, Steps: 10 | Train Loss: 0.022 Vali Loss: 0.702 Vali Acc: 0.783 Test Loss: 0.702 Test Acc: 0.783
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.9823482036590576
Epoch: 69, Steps: 10 | Train Loss: 0.020 Vali Loss: 0.739 Vali Acc: 0.757 Test Loss: 0.739 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.006286382675171
Epoch: 70, Steps: 10 | Train Loss: 0.018 Vali Loss: 0.716 Vali Acc: 0.776 Test Loss: 0.716 Test Acc: 0.776
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.1647484302520752
Epoch: 71, Steps: 10 | Train Loss: 0.014 Vali Loss: 0.723 Vali Acc: 0.776 Test Loss: 0.723 Test Acc: 0.776
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.9659590721130371
Epoch: 72, Steps: 10 | Train Loss: 0.015 Vali Loss: 0.750 Vali Acc: 0.783 Test Loss: 0.750 Test Acc: 0.783
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.0017600059509277
Epoch: 73, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.746 Vali Acc: 0.776 Test Loss: 0.746 Test Acc: 0.776
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.1607038974761963
Epoch: 74, Steps: 10 | Train Loss: 0.013 Vali Loss: 0.751 Vali Acc: 0.783 Test Loss: 0.751 Test Acc: 0.783
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.2173542976379395
Epoch: 75, Steps: 10 | Train Loss: 0.011 Vali Loss: 0.745 Vali Acc: 0.789 Test Loss: 0.745 Test Acc: 0.789
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.0249528884887695
Epoch: 76, Steps: 10 | Train Loss: 0.010 Vali Loss: 0.753 Vali Acc: 0.789 Test Loss: 0.753 Test Acc: 0.789
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_RacketSports_Crossformer_UEA_ftM_sl30_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
152
test shape: torch.Size([152, 4]) torch.Size([152, 1])
accuracy:0.7960526315789473
model parameter : 81084
model size : 0.99MB
