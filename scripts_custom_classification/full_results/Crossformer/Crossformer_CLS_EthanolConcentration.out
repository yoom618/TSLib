Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.3656370639801025
Epoch: 1, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.402 Vali Acc: 0.289 Test Loss: 1.402 Test Acc: 0.289
Validation loss decreased (inf --> -0.288959).  Saving model ...
Epoch: 2 cost time: 2.567471981048584
Epoch: 2, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.447 Vali Acc: 0.281 Test Loss: 1.447 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4567863941192627
Epoch: 3, Steps: 17 | Train Loss: 1.550 Vali Loss: 1.755 Vali Acc: 0.251 Test Loss: 1.755 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.6587417125701904
Epoch: 4, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.922 Vali Acc: 0.255 Test Loss: 1.922 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7160024642944336
Epoch: 5, Steps: 17 | Train Loss: 1.784 Vali Loss: 1.500 Vali Acc: 0.255 Test Loss: 1.500 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.1205382347106934
Epoch: 6, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.644 Vali Acc: 0.259 Test Loss: 1.644 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.6073007583618164
Epoch: 7, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.757 Vali Acc: 0.338 Test Loss: 1.757 Test Acc: 0.338
Validation loss decreased (-0.288959 --> -0.338385).  Saving model ...
Epoch: 8 cost time: 2.3706159591674805
Epoch: 8, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.783 Vali Acc: 0.281 Test Loss: 1.783 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0173606872558594
Epoch: 9, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.694 Vali Acc: 0.259 Test Loss: 1.694 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6328463554382324
Epoch: 10, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.590 Vali Acc: 0.323 Test Loss: 1.590 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.747788667678833
Epoch: 11, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.784 Vali Acc: 0.327 Test Loss: 1.784 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2887561321258545
Epoch: 12, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.016 Vali Acc: 0.251 Test Loss: 2.016 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.114659070968628
Epoch: 13, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.794 Vali Acc: 0.350 Test Loss: 1.794 Test Acc: 0.350
Validation loss decreased (-0.338385 --> -0.349792).  Saving model ...
Epoch: 14 cost time: 2.152470588684082
Epoch: 14, Steps: 17 | Train Loss: 1.286 Vali Loss: 2.640 Vali Acc: 0.266 Test Loss: 2.640 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.314283847808838
Epoch: 15, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.827 Vali Acc: 0.331 Test Loss: 1.827 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9159152507781982
Epoch: 16, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.857 Vali Acc: 0.331 Test Loss: 1.857 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.240642786026001
Epoch: 17, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.593 Vali Acc: 0.342 Test Loss: 1.593 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8757810592651367
Epoch: 18, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.975 Vali Acc: 0.350 Test Loss: 1.975 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.4532899856567383
Epoch: 19, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.931 Vali Acc: 0.323 Test Loss: 1.931 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.408381462097168
Epoch: 20, Steps: 17 | Train Loss: 0.874 Vali Loss: 2.140 Vali Acc: 0.285 Test Loss: 2.140 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.631291389465332
Epoch: 21, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.773 Vali Acc: 0.331 Test Loss: 1.773 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.3895390033721924
Epoch: 22, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.836 Vali Acc: 0.342 Test Loss: 1.836 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.0913612842559814
Epoch: 23, Steps: 17 | Train Loss: 0.775 Vali Loss: 1.829 Vali Acc: 0.361 Test Loss: 1.829 Test Acc: 0.361
Validation loss decreased (-0.349792 --> -0.361198).  Saving model ...
Epoch: 24 cost time: 2.830095052719116
Epoch: 24, Steps: 17 | Train Loss: 0.738 Vali Loss: 2.231 Vali Acc: 0.331 Test Loss: 2.231 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.6247942447662354
Epoch: 25, Steps: 17 | Train Loss: 0.768 Vali Loss: 2.030 Vali Acc: 0.308 Test Loss: 2.030 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.465270757675171
Epoch: 26, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.611 Vali Acc: 0.304 Test Loss: 2.611 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.3413822650909424
Epoch: 27, Steps: 17 | Train Loss: 0.994 Vali Loss: 2.626 Vali Acc: 0.274 Test Loss: 2.626 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.450819253921509
Epoch: 28, Steps: 17 | Train Loss: 0.722 Vali Loss: 2.363 Vali Acc: 0.316 Test Loss: 2.363 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.518930673599243
Epoch: 29, Steps: 17 | Train Loss: 0.714 Vali Loss: 2.413 Vali Acc: 0.323 Test Loss: 2.413 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.8469061851501465
Epoch: 30, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.449 Vali Acc: 0.335 Test Loss: 2.449 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.323046922683716
Epoch: 31, Steps: 17 | Train Loss: 0.671 Vali Loss: 2.472 Vali Acc: 0.293 Test Loss: 2.472 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.4370334148406982
Epoch: 32, Steps: 17 | Train Loss: 0.650 Vali Loss: 2.449 Vali Acc: 0.289 Test Loss: 2.449 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.673262596130371
Epoch: 33, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.704 Vali Acc: 0.308 Test Loss: 2.704 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3612167300380228
model parameter : 14703424
model size : 61.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.721728801727295
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.432 Vali Acc: 0.247 Test Loss: 1.432 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 4.206775665283203
Epoch: 2, Steps: 17 | Train Loss: 1.580 Vali Loss: 1.644 Vali Acc: 0.274 Test Loss: 1.644 Test Acc: 0.274
Validation loss decreased (-0.247134 --> -0.273748).  Saving model ...
Epoch: 3 cost time: 3.617358446121216
Epoch: 3, Steps: 17 | Train Loss: 1.611 Vali Loss: 1.649 Vali Acc: 0.259 Test Loss: 1.649 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.317783355712891
Epoch: 4, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.565 Vali Acc: 0.270 Test Loss: 1.565 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.609485149383545
Epoch: 5, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.863 Vali Acc: 0.240 Test Loss: 1.863 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.196470737457275
Epoch: 6, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.522 Vali Acc: 0.308 Test Loss: 1.522 Test Acc: 0.308
Validation loss decreased (-0.273748 --> -0.307970).  Saving model ...
Epoch: 7 cost time: 4.964823961257935
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.675 Vali Acc: 0.270 Test Loss: 1.675 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.499861001968384
Epoch: 8, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.633 Vali Acc: 0.270 Test Loss: 1.633 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.580320358276367
Epoch: 9, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.923 Vali Acc: 0.281 Test Loss: 1.923 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.3801016807556152
Epoch: 10, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.677 Vali Acc: 0.259 Test Loss: 1.677 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.652324914932251
Epoch: 11, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.589 Vali Acc: 0.327 Test Loss: 1.589 Test Acc: 0.327
Validation loss decreased (-0.307970 --> -0.326980).  Saving model ...
Epoch: 12 cost time: 6.5102503299713135
Epoch: 12, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.504 Vali Acc: 0.327 Test Loss: 1.504 Test Acc: 0.327
Validation loss decreased (-0.326980 --> -0.326981).  Saving model ...
Epoch: 13 cost time: 6.713208436965942
Epoch: 13, Steps: 17 | Train Loss: 1.086 Vali Loss: 2.216 Vali Acc: 0.266 Test Loss: 2.216 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.052939176559448
Epoch: 14, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.855 Vali Acc: 0.281 Test Loss: 1.855 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.681567668914795
Epoch: 15, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.813 Vali Acc: 0.278 Test Loss: 1.813 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.1732728481292725
Epoch: 16, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.945 Vali Acc: 0.304 Test Loss: 1.945 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.7382166385650635
Epoch: 17, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.854 Vali Acc: 0.289 Test Loss: 1.854 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.5953264236450195
Epoch: 18, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.762 Vali Acc: 0.365 Test Loss: 1.762 Test Acc: 0.365
Validation loss decreased (-0.326981 --> -0.365001).  Saving model ...
Epoch: 19 cost time: 7.167932987213135
Epoch: 19, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.933 Vali Acc: 0.331 Test Loss: 1.933 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.4749274253845215
Epoch: 20, Steps: 17 | Train Loss: 0.901 Vali Loss: 2.102 Vali Acc: 0.312 Test Loss: 2.102 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.5414745807647705
Epoch: 21, Steps: 17 | Train Loss: 0.866 Vali Loss: 2.548 Vali Acc: 0.312 Test Loss: 2.548 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.4076008796691895
Epoch: 22, Steps: 17 | Train Loss: 0.930 Vali Loss: 2.287 Vali Acc: 0.312 Test Loss: 2.287 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.78503155708313
Epoch: 23, Steps: 17 | Train Loss: 0.962 Vali Loss: 2.084 Vali Acc: 0.335 Test Loss: 2.084 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.311359405517578
Epoch: 24, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.128 Vali Acc: 0.338 Test Loss: 2.128 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 7.99162220954895
Epoch: 25, Steps: 17 | Train Loss: 0.750 Vali Loss: 2.068 Vali Acc: 0.342 Test Loss: 2.068 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.451281785964966
Epoch: 26, Steps: 17 | Train Loss: 0.592 Vali Loss: 2.513 Vali Acc: 0.312 Test Loss: 2.513 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.343732118606567
Epoch: 27, Steps: 17 | Train Loss: 0.611 Vali Loss: 2.362 Vali Acc: 0.357 Test Loss: 2.362 Test Acc: 0.357
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.371243715286255
Epoch: 28, Steps: 17 | Train Loss: 0.770 Vali Loss: 2.184 Vali Acc: 0.365 Test Loss: 2.184 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3650190114068441
model parameter : 14633024
model size : 60.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.538631439208984
Epoch: 1, Steps: 17 | Train Loss: 1.550 Vali Loss: 1.502 Vali Acc: 0.251 Test Loss: 1.502 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 6.40949273109436
Epoch: 2, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.547 Vali Acc: 0.270 Test Loss: 1.547 Test Acc: 0.270
Validation loss decreased (-0.250936 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 6.648021221160889
Epoch: 3, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.478 Vali Acc: 0.270 Test Loss: 1.478 Test Acc: 0.270
Validation loss decreased (-0.269947 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 5.7618019580841064
Epoch: 4, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.471 Vali Acc: 0.285 Test Loss: 1.471 Test Acc: 0.285
Validation loss decreased (-0.269947 --> -0.285156).  Saving model ...
Epoch: 5 cost time: 7.664989948272705
Epoch: 5, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.741 Vali Acc: 0.297 Test Loss: 1.741 Test Acc: 0.297
Validation loss decreased (-0.285156 --> -0.296561).  Saving model ...
Epoch: 6 cost time: 6.495606422424316
Epoch: 6, Steps: 17 | Train Loss: 1.451 Vali Loss: 2.002 Vali Acc: 0.259 Test Loss: 2.002 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.850892066955566
Epoch: 7, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.566 Vali Acc: 0.266 Test Loss: 1.566 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.248403072357178
Epoch: 8, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.647 Vali Acc: 0.293 Test Loss: 1.647 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.741469383239746
Epoch: 9, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.748 Vali Acc: 0.255 Test Loss: 1.748 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.309271335601807
Epoch: 10, Steps: 17 | Train Loss: 1.411 Vali Loss: 2.025 Vali Acc: 0.300 Test Loss: 2.025 Test Acc: 0.300
Validation loss decreased (-0.296561 --> -0.300360).  Saving model ...
Epoch: 11 cost time: 5.6468117237091064
Epoch: 11, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.502 Vali Acc: 0.338 Test Loss: 1.502 Test Acc: 0.338
Validation loss decreased (-0.300360 --> -0.338388).  Saving model ...
Epoch: 12 cost time: 7.522661924362183
Epoch: 12, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.695 Vali Acc: 0.335 Test Loss: 1.695 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.789452314376831
Epoch: 13, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.540 Vali Acc: 0.338 Test Loss: 1.540 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.120098114013672
Epoch: 14, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.757 Vali Acc: 0.338 Test Loss: 1.757 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.575450420379639
Epoch: 15, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.880 Vali Acc: 0.297 Test Loss: 1.880 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.017130374908447
Epoch: 16, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.922 Vali Acc: 0.289 Test Loss: 1.922 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 7.137542724609375
Epoch: 17, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.776 Vali Acc: 0.346 Test Loss: 1.776 Test Acc: 0.346
Validation loss decreased (-0.338388 --> -0.345990).  Saving model ...
Epoch: 18 cost time: 7.434697866439819
Epoch: 18, Steps: 17 | Train Loss: 0.794 Vali Loss: 1.979 Vali Acc: 0.342 Test Loss: 1.979 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.622014760971069
Epoch: 19, Steps: 17 | Train Loss: 0.878 Vali Loss: 2.103 Vali Acc: 0.297 Test Loss: 2.103 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.593230485916138
Epoch: 20, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.961 Vali Acc: 0.319 Test Loss: 1.961 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.616109848022461
Epoch: 21, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.635 Vali Acc: 0.354 Test Loss: 1.635 Test Acc: 0.354
Validation loss decreased (-0.345990 --> -0.353596).  Saving model ...
Epoch: 22 cost time: 6.6961164474487305
Epoch: 22, Steps: 17 | Train Loss: 0.913 Vali Loss: 2.032 Vali Acc: 0.323 Test Loss: 2.032 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.861656427383423
Epoch: 23, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.305 Vali Acc: 0.312 Test Loss: 2.305 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.954765796661377
Epoch: 24, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.953 Vali Acc: 0.350 Test Loss: 1.953 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.5669074058532715
Epoch: 25, Steps: 17 | Train Loss: 0.698 Vali Loss: 2.169 Vali Acc: 0.300 Test Loss: 2.169 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.423719644546509
Epoch: 26, Steps: 17 | Train Loss: 0.776 Vali Loss: 2.925 Vali Acc: 0.270 Test Loss: 2.925 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.434227466583252
Epoch: 27, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.923 Vali Acc: 0.392 Test Loss: 1.923 Test Acc: 0.392
Validation loss decreased (-0.353596 --> -0.391616).  Saving model ...
Epoch: 28 cost time: 7.081908702850342
Epoch: 28, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.191 Vali Acc: 0.300 Test Loss: 2.191 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.21064019203186
Epoch: 29, Steps: 17 | Train Loss: 0.636 Vali Loss: 2.162 Vali Acc: 0.331 Test Loss: 2.162 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.887454271316528
Epoch: 30, Steps: 17 | Train Loss: 0.854 Vali Loss: 2.522 Vali Acc: 0.297 Test Loss: 2.522 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 7.216073274612427
Epoch: 31, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.887 Vali Acc: 0.285 Test Loss: 2.887 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.868714332580566
Epoch: 32, Steps: 17 | Train Loss: 0.880 Vali Loss: 3.718 Vali Acc: 0.304 Test Loss: 3.718 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 6.952725648880005
Epoch: 33, Steps: 17 | Train Loss: 1.108 Vali Loss: 2.250 Vali Acc: 0.335 Test Loss: 2.250 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 7.3665430545806885
Epoch: 34, Steps: 17 | Train Loss: 0.791 Vali Loss: 2.887 Vali Acc: 0.281 Test Loss: 2.887 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 6.882369518280029
Epoch: 35, Steps: 17 | Train Loss: 0.809 Vali Loss: 2.427 Vali Acc: 0.308 Test Loss: 2.427 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 6.97501540184021
Epoch: 36, Steps: 17 | Train Loss: 0.655 Vali Loss: 3.056 Vali Acc: 0.262 Test Loss: 3.056 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 6.166806936264038
Epoch: 37, Steps: 17 | Train Loss: 0.810 Vali Loss: 2.811 Vali Acc: 0.316 Test Loss: 2.811 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3916349809885932
model parameter : 14562624
model size : 60.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.952902317047119
Epoch: 1, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.578 Vali Acc: 0.255 Test Loss: 1.578 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 5.83980131149292
Epoch: 2, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.706 Vali Acc: 0.232 Test Loss: 1.706 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.212389707565308
Epoch: 3, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.562 Vali Acc: 0.278 Test Loss: 1.562 Test Acc: 0.278
Validation loss decreased (-0.254737 --> -0.277551).  Saving model ...
Epoch: 4 cost time: 6.421039581298828
Epoch: 4, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.669 Vali Acc: 0.281 Test Loss: 1.669 Test Acc: 0.281
Validation loss decreased (-0.277551 --> -0.281352).  Saving model ...
Epoch: 5 cost time: 7.135897636413574
Epoch: 5, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.437 Vali Acc: 0.338 Test Loss: 1.437 Test Acc: 0.338
Validation loss decreased (-0.281352 --> -0.338389).  Saving model ...
Epoch: 6 cost time: 6.718257427215576
Epoch: 6, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.456 Vali Acc: 0.274 Test Loss: 1.456 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.48163914680481
Epoch: 7, Steps: 17 | Train Loss: 1.849 Vali Loss: 1.894 Vali Acc: 0.259 Test Loss: 1.894 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.414490699768066
Epoch: 8, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.454 Vali Acc: 0.300 Test Loss: 1.454 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.254525423049927
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.964 Vali Acc: 0.266 Test Loss: 1.964 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.998821258544922
Epoch: 10, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.712 Vali Acc: 0.335 Test Loss: 1.712 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.521948337554932
Epoch: 11, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.533 Vali Acc: 0.342 Test Loss: 1.533 Test Acc: 0.342
Validation loss decreased (-0.338389 --> -0.342190).  Saving model ...
Epoch: 12 cost time: 6.4575111865997314
Epoch: 12, Steps: 17 | Train Loss: 1.164 Vali Loss: 2.156 Vali Acc: 0.300 Test Loss: 2.156 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.424699544906616
Epoch: 13, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.729 Vali Acc: 0.346 Test Loss: 1.729 Test Acc: 0.346
Validation loss decreased (-0.342190 --> -0.345990).  Saving model ...
Epoch: 14 cost time: 4.337144613265991
Epoch: 14, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.926 Vali Acc: 0.266 Test Loss: 1.926 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.058422803878784
Epoch: 15, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.689 Vali Acc: 0.319 Test Loss: 1.689 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.919804334640503
Epoch: 16, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.622 Vali Acc: 0.331 Test Loss: 1.622 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.561035394668579
Epoch: 17, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.690 Vali Acc: 0.297 Test Loss: 1.690 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.470340967178345
Epoch: 18, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.550 Vali Acc: 0.392 Test Loss: 1.550 Test Acc: 0.392
Validation loss decreased (-0.345990 --> -0.391619).  Saving model ...
Epoch: 19 cost time: 6.852904319763184
Epoch: 19, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.776 Vali Acc: 0.357 Test Loss: 1.776 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.240726709365845
Epoch: 20, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.981 Vali Acc: 0.323 Test Loss: 1.981 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.35681939125061
Epoch: 21, Steps: 17 | Train Loss: 0.733 Vali Loss: 2.125 Vali Acc: 0.338 Test Loss: 2.125 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.479447841644287
Epoch: 22, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.977 Vali Acc: 0.323 Test Loss: 1.977 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.257173538208008
Epoch: 23, Steps: 17 | Train Loss: 0.811 Vali Loss: 2.077 Vali Acc: 0.297 Test Loss: 2.077 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.794403553009033
Epoch: 24, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.636 Vali Acc: 0.335 Test Loss: 1.636 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.004267692565918
Epoch: 25, Steps: 17 | Train Loss: 1.080 Vali Loss: 2.277 Vali Acc: 0.331 Test Loss: 2.277 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.532547950744629
Epoch: 26, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.951 Vali Acc: 0.365 Test Loss: 1.951 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.2551109790802
Epoch: 27, Steps: 17 | Train Loss: 0.934 Vali Loss: 2.161 Vali Acc: 0.316 Test Loss: 2.161 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.628962993621826
Epoch: 28, Steps: 17 | Train Loss: 0.913 Vali Loss: 2.076 Vali Acc: 0.354 Test Loss: 2.076 Test Acc: 0.354
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3916349809885932
model parameter : 14492224
model size : 60.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.715052604675293
Epoch: 1, Steps: 17 | Train Loss: 1.592 Vali Loss: 1.498 Vali Acc: 0.262 Test Loss: 1.498 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 5.8296191692352295
Epoch: 2, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.522 Vali Acc: 0.259 Test Loss: 1.522 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.744025468826294
Epoch: 3, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.475 Vali Acc: 0.262 Test Loss: 1.475 Test Acc: 0.262
Validation loss decreased (-0.262342 --> -0.262343).  Saving model ...
Epoch: 4 cost time: 6.33016562461853
Epoch: 4, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.663 Vali Acc: 0.251 Test Loss: 1.663 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.121553897857666
Epoch: 5, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.431 Vali Acc: 0.251 Test Loss: 1.431 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.734174489974976
Epoch: 6, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.514 Vali Acc: 0.293 Test Loss: 1.514 Test Acc: 0.293
Validation loss decreased (-0.262343 --> -0.292761).  Saving model ...
Epoch: 7 cost time: 5.2200610637664795
Epoch: 7, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.503 Vali Acc: 0.251 Test Loss: 1.503 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.174299955368042
Epoch: 8, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.866 Vali Acc: 0.259 Test Loss: 1.866 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.1427435874938965
Epoch: 9, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.844 Vali Acc: 0.293 Test Loss: 1.844 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.642484664916992
Epoch: 10, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.564 Vali Acc: 0.331 Test Loss: 1.564 Test Acc: 0.331
Validation loss decreased (-0.292761 --> -0.330783).  Saving model ...
Epoch: 11 cost time: 6.872994422912598
Epoch: 11, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.520 Vali Acc: 0.357 Test Loss: 1.520 Test Acc: 0.357
Validation loss decreased (-0.330783 --> -0.357399).  Saving model ...
Epoch: 12 cost time: 5.200080394744873
Epoch: 12, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.597 Vali Acc: 0.354 Test Loss: 1.597 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.911977052688599
Epoch: 13, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.539 Vali Acc: 0.373 Test Loss: 1.539 Test Acc: 0.373
Validation loss decreased (-0.357399 --> -0.372608).  Saving model ...
Epoch: 14 cost time: 5.844149112701416
Epoch: 14, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.509 Vali Acc: 0.331 Test Loss: 1.509 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.652533531188965
Epoch: 15, Steps: 17 | Train Loss: 1.124 Vali Loss: 2.054 Vali Acc: 0.327 Test Loss: 2.054 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.409412145614624
Epoch: 16, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.596 Vali Acc: 0.384 Test Loss: 1.596 Test Acc: 0.384
Validation loss decreased (-0.372608 --> -0.384014).  Saving model ...
Epoch: 17 cost time: 5.850935935974121
Epoch: 17, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.498 Vali Acc: 0.392 Test Loss: 1.498 Test Acc: 0.392
Validation loss decreased (-0.384014 --> -0.391620).  Saving model ...
Epoch: 18 cost time: 6.759801149368286
Epoch: 18, Steps: 17 | Train Loss: 0.809 Vali Loss: 2.075 Vali Acc: 0.342 Test Loss: 2.075 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.939891338348389
Epoch: 19, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.952 Vali Acc: 0.297 Test Loss: 1.952 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.384908437728882
Epoch: 20, Steps: 17 | Train Loss: 0.940 Vali Loss: 1.922 Vali Acc: 0.369 Test Loss: 1.922 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.011799097061157
Epoch: 21, Steps: 17 | Train Loss: 0.749 Vali Loss: 2.002 Vali Acc: 0.319 Test Loss: 2.002 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.5406293869018555
Epoch: 22, Steps: 17 | Train Loss: 0.731 Vali Loss: 1.778 Vali Acc: 0.380 Test Loss: 1.778 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.577184677124023
Epoch: 23, Steps: 17 | Train Loss: 0.805 Vali Loss: 2.338 Vali Acc: 0.293 Test Loss: 2.338 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.864664793014526
Epoch: 24, Steps: 17 | Train Loss: 1.051 Vali Loss: 2.110 Vali Acc: 0.338 Test Loss: 2.110 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.442748785018921
Epoch: 25, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.124 Vali Acc: 0.388 Test Loss: 2.124 Test Acc: 0.388
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.581456422805786
Epoch: 26, Steps: 17 | Train Loss: 0.717 Vali Loss: 2.464 Vali Acc: 0.327 Test Loss: 2.464 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.442641019821167
Epoch: 27, Steps: 17 | Train Loss: 0.734 Vali Loss: 3.054 Vali Acc: 0.312 Test Loss: 3.054 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3916349809885932
model parameter : 12339520
model size : 52.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.88043999671936
Epoch: 1, Steps: 17 | Train Loss: 1.587 Vali Loss: 1.690 Vali Acc: 0.251 Test Loss: 1.690 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 6.9934210777282715
Epoch: 2, Steps: 17 | Train Loss: 1.598 Vali Loss: 1.531 Vali Acc: 0.247 Test Loss: 1.531 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.366491079330444
Epoch: 3, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.492 Vali Acc: 0.266 Test Loss: 1.492 Test Acc: 0.266
Validation loss decreased (-0.250934 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 6.926058292388916
Epoch: 4, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.999 Vali Acc: 0.251 Test Loss: 1.999 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.273754119873047
Epoch: 5, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.670 Vali Acc: 0.259 Test Loss: 1.670 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.414158582687378
Epoch: 6, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.448 Vali Acc: 0.278 Test Loss: 1.448 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277552).  Saving model ...
Epoch: 7 cost time: 4.752985954284668
Epoch: 7, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.467 Vali Acc: 0.327 Test Loss: 1.467 Test Acc: 0.327
Validation loss decreased (-0.277552 --> -0.326982).  Saving model ...
Epoch: 8 cost time: 4.497766017913818
Epoch: 8, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.654 Vali Acc: 0.236 Test Loss: 1.654 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.663021087646484
Epoch: 9, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.473 Vali Acc: 0.316 Test Loss: 1.473 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.121906757354736
Epoch: 10, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.782 Vali Acc: 0.297 Test Loss: 1.782 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.881860017776489
Epoch: 11, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.523 Vali Acc: 0.369 Test Loss: 1.523 Test Acc: 0.369
Validation loss decreased (-0.326982 --> -0.368806).  Saving model ...
Epoch: 12 cost time: 6.656438827514648
Epoch: 12, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.944 Vali Acc: 0.266 Test Loss: 1.944 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.199854373931885
Epoch: 13, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.755 Vali Acc: 0.376 Test Loss: 1.755 Test Acc: 0.376
Validation loss decreased (-0.368806 --> -0.376408).  Saving model ...
Epoch: 14 cost time: 5.855677127838135
Epoch: 14, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.618 Vali Acc: 0.346 Test Loss: 1.618 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.904887676239014
Epoch: 15, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.630 Vali Acc: 0.338 Test Loss: 1.630 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.907597541809082
Epoch: 16, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.574 Vali Acc: 0.338 Test Loss: 1.574 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.545345306396484
Epoch: 17, Steps: 17 | Train Loss: 0.933 Vali Loss: 2.117 Vali Acc: 0.274 Test Loss: 2.117 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.133012294769287
Epoch: 18, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.992 Vali Acc: 0.308 Test Loss: 1.992 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.479559421539307
Epoch: 19, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.981 Vali Acc: 0.335 Test Loss: 1.981 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.27810525894165
Epoch: 20, Steps: 17 | Train Loss: 1.054 Vali Loss: 2.391 Vali Acc: 0.289 Test Loss: 2.391 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.915634870529175
Epoch: 21, Steps: 17 | Train Loss: 0.889 Vali Loss: 1.834 Vali Acc: 0.354 Test Loss: 1.834 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.315192461013794
Epoch: 22, Steps: 17 | Train Loss: 0.890 Vali Loss: 2.542 Vali Acc: 0.331 Test Loss: 2.542 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.692752838134766
Epoch: 23, Steps: 17 | Train Loss: 0.865 Vali Loss: 2.092 Vali Acc: 0.335 Test Loss: 2.092 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.376425855513308
model parameter : 12269120
model size : 51.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.736648559570312
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.462 Vali Acc: 0.285 Test Loss: 1.462 Test Acc: 0.285
Validation loss decreased (inf --> -0.285156).  Saving model ...
Epoch: 2 cost time: 6.221869945526123
Epoch: 2, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.580 Vali Acc: 0.312 Test Loss: 1.580 Test Acc: 0.312
Validation loss decreased (-0.285156 --> -0.311771).  Saving model ...
Epoch: 3 cost time: 6.955959796905518
Epoch: 3, Steps: 17 | Train Loss: 1.577 Vali Loss: 1.443 Vali Acc: 0.266 Test Loss: 1.443 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.297154903411865
Epoch: 4, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.448 Vali Acc: 0.308 Test Loss: 1.448 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.361584901809692
Epoch: 5, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.662 Vali Acc: 0.243 Test Loss: 1.662 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.1010353565216064
Epoch: 6, Steps: 17 | Train Loss: 1.570 Vali Loss: 1.810 Vali Acc: 0.232 Test Loss: 1.810 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.9735748767852783
Epoch: 7, Steps: 17 | Train Loss: 1.516 Vali Loss: 1.490 Vali Acc: 0.335 Test Loss: 1.490 Test Acc: 0.335
Validation loss decreased (-0.311771 --> -0.334586).  Saving model ...
Epoch: 8 cost time: 6.019180059432983
Epoch: 8, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.405 Vali Acc: 0.354 Test Loss: 1.405 Test Acc: 0.354
Validation loss decreased (-0.334586 --> -0.353598).  Saving model ...
Epoch: 9 cost time: 6.394138813018799
Epoch: 9, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.522 Vali Acc: 0.289 Test Loss: 1.522 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.942939758300781
Epoch: 10, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.459 Vali Acc: 0.289 Test Loss: 1.459 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.2836973667144775
Epoch: 11, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.537 Vali Acc: 0.350 Test Loss: 1.537 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.843494176864624
Epoch: 12, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.808 Vali Acc: 0.350 Test Loss: 1.808 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.322417259216309
Epoch: 13, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.838 Vali Acc: 0.312 Test Loss: 1.838 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.692660331726074
Epoch: 14, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.448 Vali Acc: 0.354 Test Loss: 1.448 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.123985290527344
Epoch: 15, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.870 Vali Acc: 0.278 Test Loss: 1.870 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.906802177429199
Epoch: 16, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.840 Vali Acc: 0.289 Test Loss: 1.840 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.52234148979187
Epoch: 17, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.640 Vali Acc: 0.380 Test Loss: 1.640 Test Acc: 0.380
Validation loss decreased (-0.353598 --> -0.380212).  Saving model ...
Epoch: 18 cost time: 6.620883941650391
Epoch: 18, Steps: 17 | Train Loss: 0.891 Vali Loss: 2.103 Vali Acc: 0.327 Test Loss: 2.103 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.842300653457642
Epoch: 19, Steps: 17 | Train Loss: 1.014 Vali Loss: 2.111 Vali Acc: 0.293 Test Loss: 2.111 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.7091965675354
Epoch: 20, Steps: 17 | Train Loss: 0.834 Vali Loss: 1.840 Vali Acc: 0.357 Test Loss: 1.840 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.177722692489624
Epoch: 21, Steps: 17 | Train Loss: 0.824 Vali Loss: 1.878 Vali Acc: 0.361 Test Loss: 1.878 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.832539319992065
Epoch: 22, Steps: 17 | Train Loss: 0.792 Vali Loss: 1.890 Vali Acc: 0.323 Test Loss: 1.890 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.334689617156982
Epoch: 23, Steps: 17 | Train Loss: 0.733 Vali Loss: 2.157 Vali Acc: 0.300 Test Loss: 2.157 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.0723090171813965
Epoch: 24, Steps: 17 | Train Loss: 0.985 Vali Loss: 2.017 Vali Acc: 0.300 Test Loss: 2.017 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.157525539398193
Epoch: 25, Steps: 17 | Train Loss: 0.949 Vali Loss: 2.079 Vali Acc: 0.354 Test Loss: 2.079 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.862917900085449
Epoch: 26, Steps: 17 | Train Loss: 0.839 Vali Loss: 1.854 Vali Acc: 0.316 Test Loss: 1.854 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.648141384124756
Epoch: 27, Steps: 17 | Train Loss: 0.799 Vali Loss: 1.989 Vali Acc: 0.350 Test Loss: 1.989 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38022813688212925
model parameter : 12198720
model size : 51.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.943631410598755
Epoch: 1, Steps: 17 | Train Loss: 1.536 Vali Loss: 1.399 Vali Acc: 0.266 Test Loss: 1.399 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 6.564186096191406
Epoch: 2, Steps: 17 | Train Loss: 1.625 Vali Loss: 1.800 Vali Acc: 0.247 Test Loss: 1.800 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.833991289138794
Epoch: 3, Steps: 17 | Train Loss: 1.643 Vali Loss: 1.814 Vali Acc: 0.247 Test Loss: 1.814 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.097887992858887
Epoch: 4, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.539 Vali Acc: 0.289 Test Loss: 1.539 Test Acc: 0.289
Validation loss decreased (-0.266146 --> -0.288958).  Saving model ...
Epoch: 5 cost time: 2.838392734527588
Epoch: 5, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.854 Vali Acc: 0.270 Test Loss: 1.854 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.952486515045166
Epoch: 6, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.473 Vali Acc: 0.281 Test Loss: 1.473 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.050821781158447
Epoch: 7, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.482 Vali Acc: 0.266 Test Loss: 1.482 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.3003830909729
Epoch: 8, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.531 Vali Acc: 0.270 Test Loss: 1.531 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.477802038192749
Epoch: 9, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.801 Vali Acc: 0.278 Test Loss: 1.801 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.477751970291138
Epoch: 10, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.763 Vali Acc: 0.289 Test Loss: 1.763 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.963356256484985
Epoch: 11, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.721 Vali Acc: 0.293 Test Loss: 1.721 Test Acc: 0.293
Validation loss decreased (-0.288958 --> -0.292758).  Saving model ...
Epoch: 12 cost time: 5.868395090103149
Epoch: 12, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.597 Vali Acc: 0.346 Test Loss: 1.597 Test Acc: 0.346
Validation loss decreased (-0.292758 --> -0.345992).  Saving model ...
Epoch: 13 cost time: 6.508557319641113
Epoch: 13, Steps: 17 | Train Loss: 1.009 Vali Loss: 2.328 Vali Acc: 0.392 Test Loss: 2.328 Test Acc: 0.392
Validation loss decreased (-0.345992 --> -0.391612).  Saving model ...
Epoch: 14 cost time: 5.8340373039245605
Epoch: 14, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.745 Vali Acc: 0.350 Test Loss: 1.745 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.978066444396973
Epoch: 15, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.811 Vali Acc: 0.335 Test Loss: 1.811 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.519240617752075
Epoch: 16, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.571 Vali Acc: 0.414 Test Loss: 1.571 Test Acc: 0.414
Validation loss decreased (-0.391612 --> -0.414433).  Saving model ...
Epoch: 17 cost time: 5.441068887710571
Epoch: 17, Steps: 17 | Train Loss: 0.881 Vali Loss: 2.543 Vali Acc: 0.278 Test Loss: 2.543 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.157208442687988
Epoch: 18, Steps: 17 | Train Loss: 1.142 Vali Loss: 2.152 Vali Acc: 0.335 Test Loss: 2.152 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.396745204925537
Epoch: 19, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.899 Vali Acc: 0.350 Test Loss: 1.899 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5660183429718018
Epoch: 20, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.862 Vali Acc: 0.304 Test Loss: 1.862 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.530580759048462
Epoch: 21, Steps: 17 | Train Loss: 0.891 Vali Loss: 2.318 Vali Acc: 0.319 Test Loss: 2.318 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.760762691497803
Epoch: 22, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.806 Vali Acc: 0.365 Test Loss: 1.806 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.492123126983643
Epoch: 23, Steps: 17 | Train Loss: 0.876 Vali Loss: 1.863 Vali Acc: 0.327 Test Loss: 1.863 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.127853870391846
Epoch: 24, Steps: 17 | Train Loss: 0.866 Vali Loss: 2.266 Vali Acc: 0.327 Test Loss: 2.266 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.595332860946655
Epoch: 25, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.969 Vali Acc: 0.338 Test Loss: 1.969 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.779039621353149
Epoch: 26, Steps: 17 | Train Loss: 0.670 Vali Loss: 2.288 Vali Acc: 0.331 Test Loss: 2.288 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 12128320
model size : 51.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 10.110231876373291
Epoch: 1, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.674 Vali Acc: 0.278 Test Loss: 1.674 Test Acc: 0.278
Validation loss decreased (inf --> -0.277550).  Saving model ...
Epoch: 2 cost time: 7.501032829284668
Epoch: 2, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.550 Vali Acc: 0.251 Test Loss: 1.550 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.996744155883789
Epoch: 3, Steps: 17 | Train Loss: 1.528 Vali Loss: 2.294 Vali Acc: 0.240 Test Loss: 2.294 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.665611267089844
Epoch: 4, Steps: 17 | Train Loss: 1.787 Vali Loss: 1.559 Vali Acc: 0.297 Test Loss: 1.559 Test Acc: 0.297
Validation loss decreased (-0.277550 --> -0.296562).  Saving model ...
Epoch: 5 cost time: 7.320836305618286
Epoch: 5, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.556 Vali Acc: 0.240 Test Loss: 1.556 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.141210079193115
Epoch: 6, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.492 Vali Acc: 0.243 Test Loss: 1.492 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.741174221038818
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.508 Vali Acc: 0.281 Test Loss: 1.508 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 7.646505355834961
Epoch: 8, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.672 Vali Acc: 0.236 Test Loss: 1.672 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.940303325653076
Epoch: 9, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.638 Vali Acc: 0.289 Test Loss: 1.638 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 7.019925594329834
Epoch: 10, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.540 Vali Acc: 0.335 Test Loss: 1.540 Test Acc: 0.335
Validation loss decreased (-0.296562 --> -0.334585).  Saving model ...
Epoch: 11 cost time: 6.896146535873413
Epoch: 11, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.660 Vali Acc: 0.300 Test Loss: 1.660 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.005305051803589
Epoch: 12, Steps: 17 | Train Loss: 1.260 Vali Loss: 2.119 Vali Acc: 0.266 Test Loss: 2.119 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.227965354919434
Epoch: 13, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.580 Vali Acc: 0.346 Test Loss: 1.580 Test Acc: 0.346
Validation loss decreased (-0.334585 --> -0.345992).  Saving model ...
Epoch: 14 cost time: 7.9204957485198975
Epoch: 14, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.747 Vali Acc: 0.304 Test Loss: 1.747 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.927351236343384
Epoch: 15, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.779 Vali Acc: 0.365 Test Loss: 1.779 Test Acc: 0.365
Validation loss decreased (-0.345992 --> -0.365001).  Saving model ...
Epoch: 16 cost time: 7.785833835601807
Epoch: 16, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.834 Vali Acc: 0.312 Test Loss: 1.834 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.990328311920166
Epoch: 17, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.601 Vali Acc: 0.365 Test Loss: 1.601 Test Acc: 0.365
Validation loss decreased (-0.365001 --> -0.365003).  Saving model ...
Epoch: 18 cost time: 5.839304208755493
Epoch: 18, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.940 Vali Acc: 0.338 Test Loss: 1.940 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.826062917709351
Epoch: 19, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.670 Vali Acc: 0.335 Test Loss: 1.670 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.583582639694214
Epoch: 20, Steps: 17 | Train Loss: 0.938 Vali Loss: 2.239 Vali Acc: 0.281 Test Loss: 2.239 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.602055549621582
Epoch: 21, Steps: 17 | Train Loss: 1.141 Vali Loss: 2.092 Vali Acc: 0.304 Test Loss: 2.092 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.300534725189209
Epoch: 22, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.997 Vali Acc: 0.308 Test Loss: 1.997 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.2210845947265625
Epoch: 23, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.448 Vali Acc: 0.304 Test Loss: 2.448 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.337273120880127
Epoch: 24, Steps: 17 | Train Loss: 0.972 Vali Loss: 2.248 Vali Acc: 0.319 Test Loss: 2.248 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 8.329511404037476
Epoch: 25, Steps: 17 | Train Loss: 0.729 Vali Loss: 1.857 Vali Acc: 0.319 Test Loss: 1.857 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.168513298034668
Epoch: 26, Steps: 17 | Train Loss: 0.733 Vali Loss: 2.236 Vali Acc: 0.331 Test Loss: 2.236 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.8922529220581055
Epoch: 27, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.362 Vali Acc: 0.350 Test Loss: 2.362 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3650190114068441
model parameter : 11157568
model size : 47.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.795924425125122
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.539 Vali Acc: 0.262 Test Loss: 1.539 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 7.0817742347717285
Epoch: 2, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.534 Vali Acc: 0.274 Test Loss: 1.534 Test Acc: 0.274
Validation loss decreased (-0.262342 --> -0.273749).  Saving model ...
Epoch: 3 cost time: 7.067466735839844
Epoch: 3, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.892 Vali Acc: 0.243 Test Loss: 1.892 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.949226379394531
Epoch: 4, Steps: 17 | Train Loss: 1.692 Vali Loss: 1.501 Vali Acc: 0.251 Test Loss: 1.501 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.566131591796875
Epoch: 5, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.701 Vali Acc: 0.262 Test Loss: 1.701 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.267388582229614
Epoch: 6, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.506 Vali Acc: 0.312 Test Loss: 1.506 Test Acc: 0.312
Validation loss decreased (-0.273749 --> -0.311772).  Saving model ...
Epoch: 7 cost time: 5.718457937240601
Epoch: 7, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.417 Vali Acc: 0.327 Test Loss: 1.417 Test Acc: 0.327
Validation loss decreased (-0.311772 --> -0.326982).  Saving model ...
Epoch: 8 cost time: 5.926952838897705
Epoch: 8, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.757 Vali Acc: 0.255 Test Loss: 1.757 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.650816917419434
Epoch: 9, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.465 Vali Acc: 0.380 Test Loss: 1.465 Test Acc: 0.380
Validation loss decreased (-0.326982 --> -0.380213).  Saving model ...
Epoch: 10 cost time: 7.240799903869629
Epoch: 10, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.598 Vali Acc: 0.300 Test Loss: 1.598 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.3614342212677
Epoch: 11, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.722 Vali Acc: 0.308 Test Loss: 1.722 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 8.069892883300781
Epoch: 12, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.500 Vali Acc: 0.357 Test Loss: 1.500 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.1474175453186035
Epoch: 13, Steps: 17 | Train Loss: 1.124 Vali Loss: 2.050 Vali Acc: 0.319 Test Loss: 2.050 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.319512128829956
Epoch: 14, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.791 Vali Acc: 0.297 Test Loss: 1.791 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 7.092785120010376
Epoch: 15, Steps: 17 | Train Loss: 1.061 Vali Loss: 2.008 Vali Acc: 0.312 Test Loss: 2.008 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 7.007589817047119
Epoch: 16, Steps: 17 | Train Loss: 0.913 Vali Loss: 1.678 Vali Acc: 0.354 Test Loss: 1.678 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 7.238849401473999
Epoch: 17, Steps: 17 | Train Loss: 0.877 Vali Loss: 1.868 Vali Acc: 0.319 Test Loss: 1.868 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.3298118114471436
Epoch: 18, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.791 Vali Acc: 0.369 Test Loss: 1.791 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.637901544570923
Epoch: 19, Steps: 17 | Train Loss: 0.876 Vali Loss: 1.797 Vali Acc: 0.342 Test Loss: 1.797 Test Acc: 0.342
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38022813688212925
model parameter : 11087168
model size : 47.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.66962718963623
Epoch: 1, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.626 Vali Acc: 0.266 Test Loss: 1.626 Test Acc: 0.266
Validation loss decreased (inf --> -0.266143).  Saving model ...
Epoch: 2 cost time: 8.24914813041687
Epoch: 2, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.656 Vali Acc: 0.251 Test Loss: 1.656 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.9961464405059814
Epoch: 3, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.550 Vali Acc: 0.255 Test Loss: 1.550 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.296160936355591
Epoch: 4, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.577 Vali Acc: 0.259 Test Loss: 1.577 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.251981973648071
Epoch: 5, Steps: 17 | Train Loss: 1.549 Vali Loss: 1.438 Vali Acc: 0.346 Test Loss: 1.438 Test Acc: 0.346
Validation loss decreased (-0.266143 --> -0.345993).  Saving model ...
Epoch: 6 cost time: 7.771531105041504
Epoch: 6, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.535 Vali Acc: 0.232 Test Loss: 1.535 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.030869483947754
Epoch: 7, Steps: 17 | Train Loss: 1.519 Vali Loss: 1.461 Vali Acc: 0.300 Test Loss: 1.461 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.1164562702178955
Epoch: 8, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.664 Vali Acc: 0.289 Test Loss: 1.664 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.422665119171143
Epoch: 9, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.560 Vali Acc: 0.327 Test Loss: 1.560 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.145992279052734
Epoch: 10, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.839 Vali Acc: 0.255 Test Loss: 1.839 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.9837486743927
Epoch: 11, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.634 Vali Acc: 0.312 Test Loss: 1.634 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.788726806640625
Epoch: 12, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.973 Vali Acc: 0.255 Test Loss: 1.973 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 7.183483600616455
Epoch: 13, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.576 Vali Acc: 0.346 Test Loss: 1.576 Test Acc: 0.346
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 7.192453384399414
Epoch: 14, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.557 Vali Acc: 0.346 Test Loss: 1.557 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 7.31963586807251
Epoch: 15, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.626 Vali Acc: 0.365 Test Loss: 1.626 Test Acc: 0.365
Validation loss decreased (-0.345993 --> -0.365003).  Saving model ...
Epoch: 16 cost time: 6.630375623703003
Epoch: 16, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.523 Vali Acc: 0.373 Test Loss: 1.523 Test Acc: 0.373
Validation loss decreased (-0.365003 --> -0.372608).  Saving model ...
Epoch: 17 cost time: 7.9225754737854
Epoch: 17, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.535 Vali Acc: 0.357 Test Loss: 1.535 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.385994911193848
Epoch: 18, Steps: 17 | Train Loss: 0.913 Vali Loss: 1.601 Vali Acc: 0.342 Test Loss: 1.601 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.519617319107056
Epoch: 19, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.945 Vali Acc: 0.297 Test Loss: 1.945 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.645877838134766
Epoch: 20, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.737 Vali Acc: 0.407 Test Loss: 1.737 Test Acc: 0.407
Validation loss decreased (-0.372608 --> -0.406827).  Saving model ...
Epoch: 21 cost time: 7.36218786239624
Epoch: 21, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.856 Vali Acc: 0.342 Test Loss: 1.856 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 7.178401708602905
Epoch: 22, Steps: 17 | Train Loss: 0.957 Vali Loss: 1.726 Vali Acc: 0.365 Test Loss: 1.726 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.039746046066284
Epoch: 23, Steps: 17 | Train Loss: 0.766 Vali Loss: 1.823 Vali Acc: 0.388 Test Loss: 1.823 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.494179010391235
Epoch: 24, Steps: 17 | Train Loss: 0.626 Vali Loss: 1.979 Vali Acc: 0.346 Test Loss: 1.979 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.689765930175781
Epoch: 25, Steps: 17 | Train Loss: 0.665 Vali Loss: 2.348 Vali Acc: 0.369 Test Loss: 2.348 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.714112043380737
Epoch: 26, Steps: 17 | Train Loss: 0.731 Vali Loss: 2.047 Vali Acc: 0.376 Test Loss: 2.047 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 7.554924488067627
Epoch: 27, Steps: 17 | Train Loss: 0.725 Vali Loss: 1.996 Vali Acc: 0.350 Test Loss: 1.996 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.662310838699341
Epoch: 28, Steps: 17 | Train Loss: 0.759 Vali Loss: 2.115 Vali Acc: 0.342 Test Loss: 2.115 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.689634561538696
Epoch: 29, Steps: 17 | Train Loss: 0.571 Vali Loss: 2.799 Vali Acc: 0.297 Test Loss: 2.799 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.837047815322876
Epoch: 30, Steps: 17 | Train Loss: 0.622 Vali Loss: 2.787 Vali Acc: 0.285 Test Loss: 2.787 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4068441064638783
model parameter : 11016768
model size : 47.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.206236839294434
Epoch: 1, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.602 Vali Acc: 0.251 Test Loss: 1.602 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 6.625800848007202
Epoch: 2, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.781 Vali Acc: 0.262 Test Loss: 1.781 Test Acc: 0.262
Validation loss decreased (-0.250935 --> -0.262340).  Saving model ...
Epoch: 3 cost time: 6.373090028762817
Epoch: 3, Steps: 17 | Train Loss: 1.589 Vali Loss: 2.195 Vali Acc: 0.251 Test Loss: 2.195 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.560971260070801
Epoch: 4, Steps: 17 | Train Loss: 1.779 Vali Loss: 1.450 Vali Acc: 0.266 Test Loss: 1.450 Test Acc: 0.266
Validation loss decreased (-0.262340 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 6.3752875328063965
Epoch: 5, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.446 Vali Acc: 0.262 Test Loss: 1.446 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.813159704208374
Epoch: 6, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.538 Vali Acc: 0.243 Test Loss: 1.538 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.4535157680511475
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.468 Vali Acc: 0.297 Test Loss: 1.468 Test Acc: 0.297
Validation loss decreased (-0.266145 --> -0.296563).  Saving model ...
Epoch: 8 cost time: 6.266020774841309
Epoch: 8, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.442 Vali Acc: 0.259 Test Loss: 1.442 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.4366559982299805
Epoch: 9, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.678 Vali Acc: 0.304 Test Loss: 1.678 Test Acc: 0.304
Validation loss decreased (-0.296563 --> -0.304166).  Saving model ...
Epoch: 10 cost time: 6.86839747428894
Epoch: 10, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.739 Vali Acc: 0.255 Test Loss: 1.739 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.768154621124268
Epoch: 11, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.599 Vali Acc: 0.304 Test Loss: 1.599 Test Acc: 0.304
Validation loss decreased (-0.304166 --> -0.304167).  Saving model ...
Epoch: 12 cost time: 6.398881196975708
Epoch: 12, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.684 Vali Acc: 0.331 Test Loss: 1.684 Test Acc: 0.331
Validation loss decreased (-0.304167 --> -0.330782).  Saving model ...
Epoch: 13 cost time: 7.042248010635376
Epoch: 13, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.666 Vali Acc: 0.327 Test Loss: 1.666 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.257042407989502
Epoch: 14, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.652 Vali Acc: 0.323 Test Loss: 1.652 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.250436544418335
Epoch: 15, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.454 Vali Acc: 0.411 Test Loss: 1.454 Test Acc: 0.411
Validation loss decreased (-0.330782 --> -0.410632).  Saving model ...
Epoch: 16 cost time: 6.429759502410889
Epoch: 16, Steps: 17 | Train Loss: 0.907 Vali Loss: 1.729 Vali Acc: 0.350 Test Loss: 1.729 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.715174436569214
Epoch: 17, Steps: 17 | Train Loss: 0.968 Vali Loss: 2.337 Vali Acc: 0.308 Test Loss: 2.337 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.616276025772095
Epoch: 18, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.747 Vali Acc: 0.323 Test Loss: 1.747 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.903910398483276
Epoch: 19, Steps: 17 | Train Loss: 0.882 Vali Loss: 2.151 Vali Acc: 0.380 Test Loss: 2.151 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.858825922012329
Epoch: 20, Steps: 17 | Train Loss: 1.218 Vali Loss: 2.080 Vali Acc: 0.373 Test Loss: 2.080 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.040905952453613
Epoch: 21, Steps: 17 | Train Loss: 0.818 Vali Loss: 2.112 Vali Acc: 0.346 Test Loss: 2.112 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.252304315567017
Epoch: 22, Steps: 17 | Train Loss: 0.875 Vali Loss: 2.255 Vali Acc: 0.304 Test Loss: 2.255 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.707580089569092
Epoch: 23, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.152 Vali Acc: 0.335 Test Loss: 2.152 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.297875642776489
Epoch: 24, Steps: 17 | Train Loss: 0.795 Vali Loss: 1.773 Vali Acc: 0.380 Test Loss: 1.773 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.059786081314087
Epoch: 25, Steps: 17 | Train Loss: 0.695 Vali Loss: 2.771 Vali Acc: 0.373 Test Loss: 2.771 Test Acc: 0.373
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 10946368
model size : 46.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.159814834594727
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.414 Vali Acc: 0.255 Test Loss: 1.414 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 7.948239326477051
Epoch: 2, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.639 Vali Acc: 0.281 Test Loss: 1.639 Test Acc: 0.281
Validation loss decreased (-0.254739 --> -0.281352).  Saving model ...
Epoch: 3 cost time: 7.067948579788208
Epoch: 3, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.705 Vali Acc: 0.240 Test Loss: 1.705 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.681549310684204
Epoch: 4, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.593 Vali Acc: 0.289 Test Loss: 1.593 Test Acc: 0.289
Validation loss decreased (-0.281352 --> -0.288957).  Saving model ...
Epoch: 5 cost time: 5.5915141105651855
Epoch: 5, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.414 Vali Acc: 0.293 Test Loss: 1.414 Test Acc: 0.293
Validation loss decreased (-0.288957 --> -0.292762).  Saving model ...
Epoch: 6 cost time: 7.1148154735565186
Epoch: 6, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.583 Vali Acc: 0.308 Test Loss: 1.583 Test Acc: 0.308
Validation loss decreased (-0.292762 --> -0.307969).  Saving model ...
Epoch: 7 cost time: 7.850695848464966
Epoch: 7, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.444 Vali Acc: 0.327 Test Loss: 1.444 Test Acc: 0.327
Validation loss decreased (-0.307969 --> -0.326982).  Saving model ...
Epoch: 8 cost time: 6.7734761238098145
Epoch: 8, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.761 Vali Acc: 0.300 Test Loss: 1.761 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.504061460494995
Epoch: 9, Steps: 17 | Train Loss: 1.301 Vali Loss: 2.152 Vali Acc: 0.266 Test Loss: 2.152 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.938247919082642
Epoch: 10, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.722 Vali Acc: 0.255 Test Loss: 1.722 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.639176607131958
Epoch: 11, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.659 Vali Acc: 0.327 Test Loss: 1.659 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.022921562194824
Epoch: 12, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.566 Vali Acc: 0.335 Test Loss: 1.566 Test Acc: 0.335
Validation loss decreased (-0.326982 --> -0.334585).  Saving model ...
Epoch: 13 cost time: 6.71508264541626
Epoch: 13, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.664 Vali Acc: 0.304 Test Loss: 1.664 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.621466875076294
Epoch: 14, Steps: 17 | Train Loss: 1.080 Vali Loss: 2.041 Vali Acc: 0.312 Test Loss: 2.041 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.879986763000488
Epoch: 15, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.898 Vali Acc: 0.335 Test Loss: 1.898 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 7.209094762802124
Epoch: 16, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.711 Vali Acc: 0.312 Test Loss: 1.711 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.280038118362427
Epoch: 17, Steps: 17 | Train Loss: 0.961 Vali Loss: 2.168 Vali Acc: 0.335 Test Loss: 2.168 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.792693614959717
Epoch: 18, Steps: 17 | Train Loss: 0.823 Vali Loss: 1.959 Vali Acc: 0.354 Test Loss: 1.959 Test Acc: 0.354
Validation loss decreased (-0.334585 --> -0.353593).  Saving model ...
Epoch: 19 cost time: 7.635035991668701
Epoch: 19, Steps: 17 | Train Loss: 1.036 Vali Loss: 2.084 Vali Acc: 0.346 Test Loss: 2.084 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.126837491989136
Epoch: 20, Steps: 17 | Train Loss: 1.094 Vali Loss: 2.014 Vali Acc: 0.335 Test Loss: 2.014 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.068872451782227
Epoch: 21, Steps: 17 | Train Loss: 0.845 Vali Loss: 2.005 Vali Acc: 0.312 Test Loss: 2.005 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 8.020341396331787
Epoch: 22, Steps: 17 | Train Loss: 0.812 Vali Loss: 2.105 Vali Acc: 0.316 Test Loss: 2.105 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 7.300110340118408
Epoch: 23, Steps: 17 | Train Loss: 0.792 Vali Loss: 1.996 Vali Acc: 0.361 Test Loss: 1.996 Test Acc: 0.361
Validation loss decreased (-0.353593 --> -0.361197).  Saving model ...
Epoch: 24 cost time: 7.582253694534302
Epoch: 24, Steps: 17 | Train Loss: 0.806 Vali Loss: 2.183 Vali Acc: 0.376 Test Loss: 2.183 Test Acc: 0.376
Validation loss decreased (-0.361197 --> -0.376404).  Saving model ...
Epoch: 25 cost time: 7.035070419311523
Epoch: 25, Steps: 17 | Train Loss: 0.825 Vali Loss: 2.371 Vali Acc: 0.323 Test Loss: 2.371 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.436788558959961
Epoch: 26, Steps: 17 | Train Loss: 0.732 Vali Loss: 2.565 Vali Acc: 0.316 Test Loss: 2.565 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.69007134437561
Epoch: 27, Steps: 17 | Train Loss: 0.733 Vali Loss: 2.228 Vali Acc: 0.354 Test Loss: 2.228 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.475571393966675
Epoch: 28, Steps: 17 | Train Loss: 0.604 Vali Loss: 2.456 Vali Acc: 0.316 Test Loss: 2.456 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.891639947891235
Epoch: 29, Steps: 17 | Train Loss: 0.633 Vali Loss: 2.531 Vali Acc: 0.361 Test Loss: 2.531 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.920093297958374
Epoch: 30, Steps: 17 | Train Loss: 0.673 Vali Loss: 2.381 Vali Acc: 0.346 Test Loss: 2.381 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 7.0204644203186035
Epoch: 31, Steps: 17 | Train Loss: 0.620 Vali Loss: 2.676 Vali Acc: 0.338 Test Loss: 2.676 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 7.605928897857666
Epoch: 32, Steps: 17 | Train Loss: 0.707 Vali Loss: 2.532 Vali Acc: 0.335 Test Loss: 2.532 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 8.10392713546753
Epoch: 33, Steps: 17 | Train Loss: 0.580 Vali Loss: 2.453 Vali Acc: 0.338 Test Loss: 2.453 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 7.871972322463989
Epoch: 34, Steps: 17 | Train Loss: 0.686 Vali Loss: 3.039 Vali Acc: 0.316 Test Loss: 3.039 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.376425855513308
model parameter : 10566592
model size : 45.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.389530181884766
Epoch: 1, Steps: 17 | Train Loss: 1.583 Vali Loss: 1.622 Vali Acc: 0.266 Test Loss: 1.622 Test Acc: 0.266
Validation loss decreased (inf --> -0.266143).  Saving model ...
Epoch: 2 cost time: 7.29584527015686
Epoch: 2, Steps: 17 | Train Loss: 1.685 Vali Loss: 1.715 Vali Acc: 0.270 Test Loss: 1.715 Test Acc: 0.270
Validation loss decreased (-0.266143 --> -0.269945).  Saving model ...
Epoch: 3 cost time: 7.130447626113892
Epoch: 3, Steps: 17 | Train Loss: 1.625 Vali Loss: 1.805 Vali Acc: 0.266 Test Loss: 1.805 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.731868743896484
Epoch: 4, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.515 Vali Acc: 0.278 Test Loss: 1.515 Test Acc: 0.278
Validation loss decreased (-0.269945 --> -0.277551).  Saving model ...
Epoch: 5 cost time: 6.378341913223267
Epoch: 5, Steps: 17 | Train Loss: 1.604 Vali Loss: 1.469 Vali Acc: 0.300 Test Loss: 1.469 Test Acc: 0.300
Validation loss decreased (-0.277551 --> -0.300366).  Saving model ...
Epoch: 6 cost time: 5.455976486206055
Epoch: 6, Steps: 17 | Train Loss: 1.630 Vali Loss: 2.067 Vali Acc: 0.247 Test Loss: 2.067 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.027093887329102
Epoch: 7, Steps: 17 | Train Loss: 1.628 Vali Loss: 1.665 Vali Acc: 0.342 Test Loss: 1.665 Test Acc: 0.342
Validation loss decreased (-0.300366 --> -0.342189).  Saving model ...
Epoch: 8 cost time: 5.21276068687439
Epoch: 8, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.543 Vali Acc: 0.259 Test Loss: 1.543 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.9227612018585205
Epoch: 9, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.431 Vali Acc: 0.308 Test Loss: 1.431 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.89781928062439
Epoch: 10, Steps: 17 | Train Loss: 1.275 Vali Loss: 2.011 Vali Acc: 0.259 Test Loss: 2.011 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.577031135559082
Epoch: 11, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.750 Vali Acc: 0.293 Test Loss: 1.750 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.931293487548828
Epoch: 12, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.516 Vali Acc: 0.327 Test Loss: 1.516 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.369641304016113
Epoch: 13, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.654 Vali Acc: 0.365 Test Loss: 1.654 Test Acc: 0.365
Validation loss decreased (-0.342189 --> -0.365002).  Saving model ...
Epoch: 14 cost time: 6.701897621154785
Epoch: 14, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.512 Vali Acc: 0.388 Test Loss: 1.512 Test Acc: 0.388
Validation loss decreased (-0.365002 --> -0.387818).  Saving model ...
Epoch: 15 cost time: 7.063048362731934
Epoch: 15, Steps: 17 | Train Loss: 1.106 Vali Loss: 2.011 Vali Acc: 0.289 Test Loss: 2.011 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.837889909744263
Epoch: 16, Steps: 17 | Train Loss: 1.099 Vali Loss: 2.423 Vali Acc: 0.262 Test Loss: 2.423 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.776442289352417
Epoch: 17, Steps: 17 | Train Loss: 1.094 Vali Loss: 2.002 Vali Acc: 0.335 Test Loss: 2.002 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.649221897125244
Epoch: 18, Steps: 17 | Train Loss: 0.906 Vali Loss: 2.201 Vali Acc: 0.255 Test Loss: 2.201 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.128162860870361
Epoch: 19, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.676 Vali Acc: 0.392 Test Loss: 1.676 Test Acc: 0.392
Validation loss decreased (-0.387818 --> -0.391618).  Saving model ...
Epoch: 20 cost time: 6.389371871948242
Epoch: 20, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.918 Vali Acc: 0.304 Test Loss: 1.918 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.868293762207031
Epoch: 21, Steps: 17 | Train Loss: 0.905 Vali Loss: 1.914 Vali Acc: 0.346 Test Loss: 1.914 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.680498361587524
Epoch: 22, Steps: 17 | Train Loss: 0.750 Vali Loss: 2.090 Vali Acc: 0.304 Test Loss: 2.090 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.8491926193237305
Epoch: 23, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.979 Vali Acc: 0.319 Test Loss: 1.979 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.7275354862213135
Epoch: 24, Steps: 17 | Train Loss: 0.781 Vali Loss: 2.066 Vali Acc: 0.354 Test Loss: 2.066 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.779887437820435
Epoch: 25, Steps: 17 | Train Loss: 0.684 Vali Loss: 2.055 Vali Acc: 0.350 Test Loss: 2.055 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.339456796646118
Epoch: 26, Steps: 17 | Train Loss: 0.685 Vali Loss: 1.930 Vali Acc: 0.373 Test Loss: 1.930 Test Acc: 0.373
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.193781137466431
Epoch: 27, Steps: 17 | Train Loss: 0.628 Vali Loss: 2.415 Vali Acc: 0.335 Test Loss: 2.415 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.781359434127808
Epoch: 28, Steps: 17 | Train Loss: 0.803 Vali Loss: 2.550 Vali Acc: 0.293 Test Loss: 2.550 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.2338035106658936
Epoch: 29, Steps: 17 | Train Loss: 0.636 Vali Loss: 3.008 Vali Acc: 0.293 Test Loss: 3.008 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3916349809885932
model parameter : 10496192
model size : 45.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.725518703460693
Epoch: 1, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.573 Vali Acc: 0.247 Test Loss: 1.573 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 7.081427812576294
Epoch: 2, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.454 Vali Acc: 0.270 Test Loss: 1.454 Test Acc: 0.270
Validation loss decreased (-0.247133 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 6.79651951789856
Epoch: 3, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.714 Vali Acc: 0.247 Test Loss: 1.714 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.050989866256714
Epoch: 4, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.493 Vali Acc: 0.240 Test Loss: 1.493 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.95241117477417
Epoch: 5, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.436 Vali Acc: 0.312 Test Loss: 1.436 Test Acc: 0.312
Validation loss decreased (-0.269947 --> -0.311773).  Saving model ...
Epoch: 6 cost time: 6.017699480056763
Epoch: 6, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.587 Vali Acc: 0.281 Test Loss: 1.587 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.494616508483887
Epoch: 7, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.431 Vali Acc: 0.297 Test Loss: 1.431 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.4020214080810547
Epoch: 8, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.520 Vali Acc: 0.354 Test Loss: 1.520 Test Acc: 0.354
Validation loss decreased (-0.311773 --> -0.353597).  Saving model ...
Epoch: 9 cost time: 8.148821115493774
Epoch: 9, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.467 Vali Acc: 0.369 Test Loss: 1.467 Test Acc: 0.369
Validation loss decreased (-0.353597 --> -0.368807).  Saving model ...
Epoch: 10 cost time: 6.40499210357666
Epoch: 10, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.471 Vali Acc: 0.354 Test Loss: 1.471 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.412931442260742
Epoch: 11, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.980 Vali Acc: 0.335 Test Loss: 1.980 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.945683717727661
Epoch: 12, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.535 Vali Acc: 0.338 Test Loss: 1.535 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.20580530166626
Epoch: 13, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.586 Vali Acc: 0.369 Test Loss: 1.586 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.323089599609375
Epoch: 14, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.736 Vali Acc: 0.342 Test Loss: 1.736 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.820921182632446
Epoch: 15, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.671 Vali Acc: 0.350 Test Loss: 1.671 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.84470272064209
Epoch: 16, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.864 Vali Acc: 0.373 Test Loss: 1.864 Test Acc: 0.373
Validation loss decreased (-0.368807 --> -0.372605).  Saving model ...
Epoch: 17 cost time: 7.101170301437378
Epoch: 17, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.694 Vali Acc: 0.373 Test Loss: 1.694 Test Acc: 0.373
Validation loss decreased (-0.372605 --> -0.372607).  Saving model ...
Epoch: 18 cost time: 6.931016683578491
Epoch: 18, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.948 Vali Acc: 0.342 Test Loss: 1.948 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.39808988571167
Epoch: 19, Steps: 17 | Train Loss: 0.985 Vali Loss: 2.145 Vali Acc: 0.297 Test Loss: 2.145 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.8085057735443115
Epoch: 20, Steps: 17 | Train Loss: 0.812 Vali Loss: 2.034 Vali Acc: 0.392 Test Loss: 2.034 Test Acc: 0.392
Validation loss decreased (-0.372607 --> -0.391615).  Saving model ...
Epoch: 21 cost time: 7.09234356880188
Epoch: 21, Steps: 17 | Train Loss: 0.863 Vali Loss: 1.840 Vali Acc: 0.331 Test Loss: 1.840 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.32146692276001
Epoch: 22, Steps: 17 | Train Loss: 0.768 Vali Loss: 2.100 Vali Acc: 0.346 Test Loss: 2.100 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.193250894546509
Epoch: 23, Steps: 17 | Train Loss: 0.741 Vali Loss: 1.994 Vali Acc: 0.392 Test Loss: 1.994 Test Acc: 0.392
Validation loss decreased (-0.391615 --> -0.391615).  Saving model ...
Epoch: 24 cost time: 6.225132465362549
Epoch: 24, Steps: 17 | Train Loss: 0.836 Vali Loss: 2.104 Vali Acc: 0.395 Test Loss: 2.104 Test Acc: 0.395
Validation loss decreased (-0.391615 --> -0.395416).  Saving model ...
Epoch: 25 cost time: 6.6642138957977295
Epoch: 25, Steps: 17 | Train Loss: 0.804 Vali Loss: 2.552 Vali Acc: 0.262 Test Loss: 2.552 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.68695855140686
Epoch: 26, Steps: 17 | Train Loss: 0.721 Vali Loss: 2.412 Vali Acc: 0.293 Test Loss: 2.412 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.58413553237915
Epoch: 27, Steps: 17 | Train Loss: 0.676 Vali Loss: 3.100 Vali Acc: 0.319 Test Loss: 3.100 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.492928743362427
Epoch: 28, Steps: 17 | Train Loss: 0.829 Vali Loss: 2.160 Vali Acc: 0.335 Test Loss: 2.160 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.556640625
Epoch: 29, Steps: 17 | Train Loss: 0.715 Vali Loss: 2.286 Vali Acc: 0.308 Test Loss: 2.286 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.737881183624268
Epoch: 30, Steps: 17 | Train Loss: 0.685 Vali Loss: 2.640 Vali Acc: 0.388 Test Loss: 2.640 Test Acc: 0.388
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.286708831787109
Epoch: 31, Steps: 17 | Train Loss: 0.581 Vali Loss: 2.670 Vali Acc: 0.300 Test Loss: 2.670 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.699368953704834
Epoch: 32, Steps: 17 | Train Loss: 0.814 Vali Loss: 2.676 Vali Acc: 0.300 Test Loss: 2.676 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.36026406288147
Epoch: 33, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.471 Vali Acc: 0.361 Test Loss: 2.471 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 6.09966516494751
Epoch: 34, Steps: 17 | Train Loss: 0.581 Vali Loss: 3.095 Vali Acc: 0.350 Test Loss: 3.095 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.39543726235741444
model parameter : 10425792
model size : 44.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.140849828720093
Epoch: 1, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.548 Vali Acc: 0.255 Test Loss: 1.548 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 6.428556680679321
Epoch: 2, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.696 Vali Acc: 0.251 Test Loss: 1.696 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.82122540473938
Epoch: 3, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.459 Vali Acc: 0.304 Test Loss: 1.459 Test Acc: 0.304
Validation loss decreased (-0.254737 --> -0.304168).  Saving model ...
Epoch: 4 cost time: 6.311727046966553
Epoch: 4, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.490 Vali Acc: 0.289 Test Loss: 1.490 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.0796942710876465
Epoch: 5, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.746 Vali Acc: 0.266 Test Loss: 1.746 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.080622911453247
Epoch: 6, Steps: 17 | Train Loss: 1.711 Vali Loss: 1.839 Vali Acc: 0.262 Test Loss: 1.839 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.206892013549805
Epoch: 7, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.758 Vali Acc: 0.270 Test Loss: 1.758 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.455704927444458
Epoch: 8, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.838 Vali Acc: 0.274 Test Loss: 1.838 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.794694185256958
Epoch: 9, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.663 Vali Acc: 0.300 Test Loss: 1.663 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 5.9979164600372314
Epoch: 10, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.588 Vali Acc: 0.319 Test Loss: 1.588 Test Acc: 0.319
Validation loss decreased (-0.304168 --> -0.319376).  Saving model ...
Epoch: 11 cost time: 6.926630020141602
Epoch: 11, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.695 Vali Acc: 0.297 Test Loss: 1.695 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.798576593399048
Epoch: 12, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.556 Vali Acc: 0.297 Test Loss: 1.556 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.511955261230469
Epoch: 13, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.641 Vali Acc: 0.384 Test Loss: 1.641 Test Acc: 0.384
Validation loss decreased (-0.319376 --> -0.384014).  Saving model ...
Epoch: 14 cost time: 5.096200227737427
Epoch: 14, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.596 Vali Acc: 0.365 Test Loss: 1.596 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.060237407684326
Epoch: 15, Steps: 17 | Train Loss: 0.937 Vali Loss: 1.542 Vali Acc: 0.373 Test Loss: 1.542 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.053552150726318
Epoch: 16, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.581 Vali Acc: 0.403 Test Loss: 1.581 Test Acc: 0.403
Validation loss decreased (-0.384014 --> -0.403026).  Saving model ...
Epoch: 17 cost time: 5.431663751602173
Epoch: 17, Steps: 17 | Train Loss: 0.824 Vali Loss: 1.768 Vali Acc: 0.376 Test Loss: 1.768 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.919139623641968
Epoch: 18, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.752 Vali Acc: 0.319 Test Loss: 1.752 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.361792087554932
Epoch: 19, Steps: 17 | Train Loss: 0.874 Vali Loss: 2.267 Vali Acc: 0.335 Test Loss: 2.267 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.483008146286011
Epoch: 20, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.832 Vali Acc: 0.323 Test Loss: 1.832 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.626840353012085
Epoch: 21, Steps: 17 | Train Loss: 0.957 Vali Loss: 2.093 Vali Acc: 0.338 Test Loss: 2.093 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.555509090423584
Epoch: 22, Steps: 17 | Train Loss: 0.712 Vali Loss: 2.113 Vali Acc: 0.354 Test Loss: 2.113 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.162559747695923
Epoch: 23, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.961 Vali Acc: 0.323 Test Loss: 1.961 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.177721977233887
Epoch: 24, Steps: 17 | Train Loss: 0.772 Vali Loss: 2.332 Vali Acc: 0.289 Test Loss: 2.332 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.399156808853149
Epoch: 25, Steps: 17 | Train Loss: 0.888 Vali Loss: 2.154 Vali Acc: 0.346 Test Loss: 2.154 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.638991832733154
Epoch: 26, Steps: 17 | Train Loss: 0.732 Vali Loss: 2.145 Vali Acc: 0.319 Test Loss: 2.145 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.40304182509505704
model parameter : 10355392
model size : 44.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.052497148513794
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.433 Vali Acc: 0.262 Test Loss: 1.433 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 6.573142051696777
Epoch: 2, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.462 Vali Acc: 0.240 Test Loss: 1.462 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.937048435211182
Epoch: 3, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.616 Vali Acc: 0.274 Test Loss: 1.616 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273748).  Saving model ...
Epoch: 4 cost time: 6.239387512207031
Epoch: 4, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.518 Vali Acc: 0.251 Test Loss: 1.518 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.242926120758057
Epoch: 5, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.611 Vali Acc: 0.255 Test Loss: 1.611 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.554042816162109
Epoch: 6, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.669 Vali Acc: 0.259 Test Loss: 1.669 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.288775682449341
Epoch: 7, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.592 Vali Acc: 0.251 Test Loss: 1.592 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.10607361793518
Epoch: 8, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.446 Vali Acc: 0.308 Test Loss: 1.446 Test Acc: 0.308
Validation loss decreased (-0.273748 --> -0.307970).  Saving model ...
Epoch: 9 cost time: 6.931052207946777
Epoch: 9, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.575 Vali Acc: 0.259 Test Loss: 1.575 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.346646785736084
Epoch: 10, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.465 Vali Acc: 0.297 Test Loss: 1.465 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.5121049880981445
Epoch: 11, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.617 Vali Acc: 0.293 Test Loss: 1.617 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.478505849838257
Epoch: 12, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.461 Vali Acc: 0.312 Test Loss: 1.461 Test Acc: 0.312
Validation loss decreased (-0.307970 --> -0.311772).  Saving model ...
Epoch: 13 cost time: 6.191396474838257
Epoch: 13, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.469 Vali Acc: 0.350 Test Loss: 1.469 Test Acc: 0.350
Validation loss decreased (-0.311772 --> -0.349795).  Saving model ...
Epoch: 14 cost time: 7.273690700531006
Epoch: 14, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.476 Vali Acc: 0.399 Test Loss: 1.476 Test Acc: 0.399
Validation loss decreased (-0.349795 --> -0.399225).  Saving model ...
Epoch: 15 cost time: 6.196450471878052
Epoch: 15, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.727 Vali Acc: 0.316 Test Loss: 1.727 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.3451292514801025
Epoch: 16, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.573 Vali Acc: 0.357 Test Loss: 1.573 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.740394353866577
Epoch: 17, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.553 Vali Acc: 0.407 Test Loss: 1.553 Test Acc: 0.407
Validation loss decreased (-0.399225 --> -0.406829).  Saving model ...
Epoch: 18 cost time: 4.949139833450317
Epoch: 18, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.562 Vali Acc: 0.380 Test Loss: 1.562 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 7.009800672531128
Epoch: 19, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.886 Vali Acc: 0.308 Test Loss: 1.886 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.054707050323486
Epoch: 20, Steps: 17 | Train Loss: 0.793 Vali Loss: 1.631 Vali Acc: 0.449 Test Loss: 1.631 Test Acc: 0.449
Validation loss decreased (-0.406829 --> -0.448653).  Saving model ...
Epoch: 21 cost time: 5.753749847412109
Epoch: 21, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.027 Vali Acc: 0.300 Test Loss: 2.027 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.718475341796875
Epoch: 22, Steps: 17 | Train Loss: 0.907 Vali Loss: 2.144 Vali Acc: 0.335 Test Loss: 2.144 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.352721452713013
Epoch: 23, Steps: 17 | Train Loss: 0.744 Vali Loss: 1.866 Vali Acc: 0.338 Test Loss: 1.866 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.851674556732178
Epoch: 24, Steps: 17 | Train Loss: 0.818 Vali Loss: 1.695 Vali Acc: 0.399 Test Loss: 1.695 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.702067136764526
Epoch: 25, Steps: 17 | Train Loss: 0.650 Vali Loss: 2.260 Vali Acc: 0.350 Test Loss: 2.260 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.430903911590576
Epoch: 26, Steps: 17 | Train Loss: 0.789 Vali Loss: 2.037 Vali Acc: 0.304 Test Loss: 2.037 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.415313482284546
Epoch: 27, Steps: 17 | Train Loss: 0.609 Vali Loss: 2.057 Vali Acc: 0.365 Test Loss: 2.057 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 7.546687126159668
Epoch: 28, Steps: 17 | Train Loss: 0.575 Vali Loss: 2.216 Vali Acc: 0.335 Test Loss: 2.216 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 7.14789342880249
Epoch: 29, Steps: 17 | Train Loss: 0.592 Vali Loss: 2.112 Vali Acc: 0.376 Test Loss: 2.112 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.408846378326416
Epoch: 30, Steps: 17 | Train Loss: 0.510 Vali Loss: 2.272 Vali Acc: 0.327 Test Loss: 2.272 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.44866920152091255
model parameter : 4997056
model size : 21.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.596561431884766
Epoch: 1, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.438 Vali Acc: 0.255 Test Loss: 1.438 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 6.428177118301392
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.475 Vali Acc: 0.274 Test Loss: 1.475 Test Acc: 0.274
Validation loss decreased (-0.254738 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 5.947603940963745
Epoch: 3, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.436 Vali Acc: 0.255 Test Loss: 1.436 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.105208158493042
Epoch: 4, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.403 Vali Acc: 0.308 Test Loss: 1.403 Test Acc: 0.308
Validation loss decreased (-0.273750 --> -0.307971).  Saving model ...
Epoch: 5 cost time: 5.299337863922119
Epoch: 5, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.474 Vali Acc: 0.243 Test Loss: 1.474 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.194820404052734
Epoch: 6, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.470 Vali Acc: 0.251 Test Loss: 1.470 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.571899890899658
Epoch: 7, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.645 Vali Acc: 0.266 Test Loss: 1.645 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.583744287490845
Epoch: 8, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.523 Vali Acc: 0.308 Test Loss: 1.523 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.827436208724976
Epoch: 9, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.425 Vali Acc: 0.270 Test Loss: 1.425 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.907565593719482
Epoch: 10, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.752 Vali Acc: 0.312 Test Loss: 1.752 Test Acc: 0.312
Validation loss decreased (-0.307971 --> -0.311770).  Saving model ...
Epoch: 11 cost time: 6.017448425292969
Epoch: 11, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.490 Vali Acc: 0.376 Test Loss: 1.490 Test Acc: 0.376
Validation loss decreased (-0.311770 --> -0.376411).  Saving model ...
Epoch: 12 cost time: 6.801686763763428
Epoch: 12, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.069 Vali Acc: 0.262 Test Loss: 2.069 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.231082916259766
Epoch: 13, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.467 Vali Acc: 0.335 Test Loss: 1.467 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.200000047683716
Epoch: 14, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.951 Vali Acc: 0.373 Test Loss: 1.951 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.41841197013855
Epoch: 15, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.788 Vali Acc: 0.335 Test Loss: 1.788 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.3274712562561035
Epoch: 16, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.512 Vali Acc: 0.350 Test Loss: 1.512 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.77524995803833
Epoch: 17, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.604 Vali Acc: 0.403 Test Loss: 1.604 Test Acc: 0.403
Validation loss decreased (-0.376411 --> -0.403026).  Saving model ...
Epoch: 18 cost time: 6.376705169677734
Epoch: 18, Steps: 17 | Train Loss: 0.817 Vali Loss: 1.781 Vali Acc: 0.342 Test Loss: 1.781 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.552502393722534
Epoch: 19, Steps: 17 | Train Loss: 0.771 Vali Loss: 1.603 Vali Acc: 0.357 Test Loss: 1.603 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.2207536697387695
Epoch: 20, Steps: 17 | Train Loss: 0.772 Vali Loss: 1.786 Vali Acc: 0.354 Test Loss: 1.786 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.773818492889404
Epoch: 21, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.983 Vali Acc: 0.308 Test Loss: 1.983 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.849164724349976
Epoch: 22, Steps: 17 | Train Loss: 0.748 Vali Loss: 1.775 Vali Acc: 0.380 Test Loss: 1.775 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.508315324783325
Epoch: 23, Steps: 17 | Train Loss: 0.769 Vali Loss: 2.446 Vali Acc: 0.281 Test Loss: 2.446 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.454317092895508
Epoch: 24, Steps: 17 | Train Loss: 1.011 Vali Loss: 2.468 Vali Acc: 0.335 Test Loss: 2.468 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.156355857849121
Epoch: 25, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.720 Vali Acc: 0.357 Test Loss: 1.720 Test Acc: 0.357
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.295481443405151
Epoch: 26, Steps: 17 | Train Loss: 0.701 Vali Loss: 1.732 Vali Acc: 0.414 Test Loss: 1.732 Test Acc: 0.414
Validation loss decreased (-0.403026 --> -0.414431).  Saving model ...
Epoch: 27 cost time: 4.702476978302002
Epoch: 27, Steps: 17 | Train Loss: 0.636 Vali Loss: 1.971 Vali Acc: 0.342 Test Loss: 1.971 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 7.690622806549072
Epoch: 28, Steps: 17 | Train Loss: 0.748 Vali Loss: 2.075 Vali Acc: 0.373 Test Loss: 2.075 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 6.570910930633545
Epoch: 29, Steps: 17 | Train Loss: 0.459 Vali Loss: 2.181 Vali Acc: 0.354 Test Loss: 2.181 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.3994669914245605
Epoch: 30, Steps: 17 | Train Loss: 0.531 Vali Loss: 2.438 Vali Acc: 0.319 Test Loss: 2.438 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.574803352355957
Epoch: 31, Steps: 17 | Train Loss: 0.463 Vali Loss: 2.341 Vali Acc: 0.354 Test Loss: 2.341 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.704419851303101
Epoch: 32, Steps: 17 | Train Loss: 0.522 Vali Loss: 2.230 Vali Acc: 0.395 Test Loss: 2.230 Test Acc: 0.395
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 7.031095743179321
Epoch: 33, Steps: 17 | Train Loss: 0.409 Vali Loss: 2.280 Vali Acc: 0.365 Test Loss: 2.280 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.393970966339111
Epoch: 34, Steps: 17 | Train Loss: 0.398 Vali Loss: 2.399 Vali Acc: 0.346 Test Loss: 2.399 Test Acc: 0.346
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 6.665594816207886
Epoch: 35, Steps: 17 | Train Loss: 0.447 Vali Loss: 2.472 Vali Acc: 0.361 Test Loss: 2.472 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 7.005115985870361
Epoch: 36, Steps: 17 | Train Loss: 0.367 Vali Loss: 2.426 Vali Acc: 0.319 Test Loss: 2.426 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 4961856
model size : 21.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.688599348068237
Epoch: 1, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.477 Vali Acc: 0.247 Test Loss: 1.477 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 6.239397287368774
Epoch: 2, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.768 Vali Acc: 0.251 Test Loss: 1.768 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250933).  Saving model ...
Epoch: 3 cost time: 6.550026178359985
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.631 Vali Acc: 0.270 Test Loss: 1.631 Test Acc: 0.270
Validation loss decreased (-0.250933 --> -0.269946).  Saving model ...
Epoch: 4 cost time: 4.903501033782959
Epoch: 4, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.648 Vali Acc: 0.278 Test Loss: 1.648 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277550).  Saving model ...
Epoch: 5 cost time: 5.018298625946045
Epoch: 5, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.462 Vali Acc: 0.266 Test Loss: 1.462 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.4444897174835205
Epoch: 6, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.491 Vali Acc: 0.255 Test Loss: 1.491 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.117512941360474
Epoch: 7, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.658 Vali Acc: 0.274 Test Loss: 1.658 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.803375959396362
Epoch: 8, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.655 Vali Acc: 0.255 Test Loss: 1.655 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.1300859451293945
Epoch: 9, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.574 Vali Acc: 0.323 Test Loss: 1.574 Test Acc: 0.323
Validation loss decreased (-0.277550 --> -0.323178).  Saving model ...
Epoch: 10 cost time: 6.1136369705200195
Epoch: 10, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.327 Vali Acc: 0.376 Test Loss: 1.327 Test Acc: 0.376
Validation loss decreased (-0.323178 --> -0.376413).  Saving model ...
Epoch: 11 cost time: 5.582931995391846
Epoch: 11, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.438 Vali Acc: 0.388 Test Loss: 1.438 Test Acc: 0.388
Validation loss decreased (-0.376413 --> -0.387818).  Saving model ...
Epoch: 12 cost time: 6.902459383010864
Epoch: 12, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.497 Vali Acc: 0.411 Test Loss: 1.497 Test Acc: 0.411
Validation loss decreased (-0.387818 --> -0.410631).  Saving model ...
Epoch: 13 cost time: 6.478103160858154
Epoch: 13, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.676 Vali Acc: 0.285 Test Loss: 1.676 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.913800954818726
Epoch: 14, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.589 Vali Acc: 0.361 Test Loss: 1.589 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.453291893005371
Epoch: 15, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.636 Vali Acc: 0.380 Test Loss: 1.636 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.739576101303101
Epoch: 16, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.481 Vali Acc: 0.376 Test Loss: 1.481 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.181852579116821
Epoch: 17, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.721 Vali Acc: 0.369 Test Loss: 1.721 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.978005886077881
Epoch: 18, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.627 Vali Acc: 0.384 Test Loss: 1.627 Test Acc: 0.384
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.525261878967285
Epoch: 19, Steps: 17 | Train Loss: 0.693 Vali Loss: 1.787 Vali Acc: 0.384 Test Loss: 1.787 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.1561219692230225
Epoch: 20, Steps: 17 | Train Loss: 0.732 Vali Loss: 2.220 Vali Acc: 0.323 Test Loss: 2.220 Test Acc: 0.323
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 6.518685340881348
Epoch: 21, Steps: 17 | Train Loss: 0.973 Vali Loss: 2.172 Vali Acc: 0.354 Test Loss: 2.172 Test Acc: 0.354
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.639082908630371
Epoch: 22, Steps: 17 | Train Loss: 0.868 Vali Loss: 1.747 Vali Acc: 0.376 Test Loss: 1.747 Test Acc: 0.376
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 4926656
model size : 21.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.139658212661743
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.589 Vali Acc: 0.251 Test Loss: 1.589 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 5.395615816116333
Epoch: 2, Steps: 17 | Train Loss: 1.623 Vali Loss: 1.467 Vali Acc: 0.270 Test Loss: 1.467 Test Acc: 0.270
Validation loss decreased (-0.250935 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 5.721715211868286
Epoch: 3, Steps: 17 | Train Loss: 1.626 Vali Loss: 1.524 Vali Acc: 0.259 Test Loss: 1.524 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.911523103713989
Epoch: 4, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.401 Vali Acc: 0.232 Test Loss: 1.401 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.081884860992432
Epoch: 5, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.594 Vali Acc: 0.255 Test Loss: 1.594 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.273050308227539
Epoch: 6, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.550 Vali Acc: 0.259 Test Loss: 1.550 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 6.919248342514038
Epoch: 7, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.444 Vali Acc: 0.327 Test Loss: 1.444 Test Acc: 0.327
Validation loss decreased (-0.269947 --> -0.326982).  Saving model ...
Epoch: 8 cost time: 6.487125396728516
Epoch: 8, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.509 Vali Acc: 0.274 Test Loss: 1.509 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.583877086639404
Epoch: 9, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.464 Vali Acc: 0.281 Test Loss: 1.464 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.648321866989136
Epoch: 10, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.682 Vali Acc: 0.312 Test Loss: 1.682 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.788863897323608
Epoch: 11, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.589 Vali Acc: 0.327 Test Loss: 1.589 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.298782110214233
Epoch: 12, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.637 Vali Acc: 0.281 Test Loss: 1.637 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 6.156056880950928
Epoch: 13, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.446 Vali Acc: 0.357 Test Loss: 1.446 Test Acc: 0.357
Validation loss decreased (-0.326982 --> -0.357400).  Saving model ...
Epoch: 14 cost time: 6.043080568313599
Epoch: 14, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.884 Vali Acc: 0.312 Test Loss: 1.884 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.700796604156494
Epoch: 15, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.575 Vali Acc: 0.319 Test Loss: 1.575 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.974352598190308
Epoch: 16, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.526 Vali Acc: 0.327 Test Loss: 1.526 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.817105531692505
Epoch: 17, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.734 Vali Acc: 0.297 Test Loss: 1.734 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.205300807952881
Epoch: 18, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.651 Vali Acc: 0.373 Test Loss: 1.651 Test Acc: 0.373
Validation loss decreased (-0.357400 --> -0.372607).  Saving model ...
Epoch: 19 cost time: 5.037487745285034
Epoch: 19, Steps: 17 | Train Loss: 0.897 Vali Loss: 1.650 Vali Acc: 0.323 Test Loss: 1.650 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.798030853271484
Epoch: 20, Steps: 17 | Train Loss: 0.731 Vali Loss: 1.639 Vali Acc: 0.380 Test Loss: 1.639 Test Acc: 0.380
Validation loss decreased (-0.372607 --> -0.380212).  Saving model ...
Epoch: 21 cost time: 5.691980838775635
Epoch: 21, Steps: 17 | Train Loss: 0.839 Vali Loss: 2.032 Vali Acc: 0.323 Test Loss: 2.032 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.498278379440308
Epoch: 22, Steps: 17 | Train Loss: 0.671 Vali Loss: 1.978 Vali Acc: 0.361 Test Loss: 1.978 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.758237600326538
Epoch: 23, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.975 Vali Acc: 0.350 Test Loss: 1.975 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.6944711208343506
Epoch: 24, Steps: 17 | Train Loss: 0.683 Vali Loss: 1.859 Vali Acc: 0.357 Test Loss: 1.859 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.570542335510254
Epoch: 25, Steps: 17 | Train Loss: 0.624 Vali Loss: 1.994 Vali Acc: 0.384 Test Loss: 1.994 Test Acc: 0.384
Validation loss decreased (-0.380212 --> -0.384010).  Saving model ...
Epoch: 26 cost time: 5.394612789154053
Epoch: 26, Steps: 17 | Train Loss: 0.611 Vali Loss: 2.502 Vali Acc: 0.327 Test Loss: 2.502 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 6.430940628051758
Epoch: 27, Steps: 17 | Train Loss: 0.575 Vali Loss: 2.165 Vali Acc: 0.331 Test Loss: 2.165 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.02256965637207
Epoch: 28, Steps: 17 | Train Loss: 0.525 Vali Loss: 2.176 Vali Acc: 0.392 Test Loss: 2.176 Test Acc: 0.392
Validation loss decreased (-0.384010 --> -0.391613).  Saving model ...
Epoch: 29 cost time: 5.622143745422363
Epoch: 29, Steps: 17 | Train Loss: 0.556 Vali Loss: 2.252 Vali Acc: 0.338 Test Loss: 2.252 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 6.271957635879517
Epoch: 30, Steps: 17 | Train Loss: 0.513 Vali Loss: 2.732 Vali Acc: 0.331 Test Loss: 2.732 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 6.8772642612457275
Epoch: 31, Steps: 17 | Train Loss: 0.685 Vali Loss: 2.445 Vali Acc: 0.331 Test Loss: 2.445 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 6.003962278366089
Epoch: 32, Steps: 17 | Train Loss: 0.425 Vali Loss: 2.400 Vali Acc: 0.350 Test Loss: 2.400 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 6.194211483001709
Epoch: 33, Steps: 17 | Train Loss: 0.608 Vali Loss: 2.356 Vali Acc: 0.331 Test Loss: 2.356 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.969588041305542
Epoch: 34, Steps: 17 | Train Loss: 0.458 Vali Loss: 2.491 Vali Acc: 0.327 Test Loss: 2.491 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 6.552232265472412
Epoch: 35, Steps: 17 | Train Loss: 0.385 Vali Loss: 3.021 Vali Acc: 0.297 Test Loss: 3.021 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 6.054779291152954
Epoch: 36, Steps: 17 | Train Loss: 0.408 Vali Loss: 2.854 Vali Acc: 0.323 Test Loss: 2.854 Test Acc: 0.323
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 5.765933275222778
Epoch: 37, Steps: 17 | Train Loss: 0.329 Vali Loss: 2.569 Vali Acc: 0.308 Test Loss: 2.569 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 5.6362128257751465
Epoch: 38, Steps: 17 | Train Loss: 0.345 Vali Loss: 2.767 Vali Acc: 0.323 Test Loss: 2.767 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3916349809885932
model parameter : 4891456
model size : 21.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.984818696975708
Epoch: 1, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.529 Vali Acc: 0.251 Test Loss: 1.529 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 5.1827239990234375
Epoch: 2, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.437 Vali Acc: 0.240 Test Loss: 1.437 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.097253084182739
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.428 Vali Acc: 0.278 Test Loss: 1.428 Test Acc: 0.278
Validation loss decreased (-0.250935 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 5.504802465438843
Epoch: 4, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.447 Vali Acc: 0.278 Test Loss: 1.447 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.351935863494873
Epoch: 5, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.490 Vali Acc: 0.300 Test Loss: 1.490 Test Acc: 0.300
Validation loss decreased (-0.277552 --> -0.300365).  Saving model ...
Epoch: 6 cost time: 7.066769599914551
Epoch: 6, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.402 Vali Acc: 0.293 Test Loss: 1.402 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.569488286972046
Epoch: 7, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.493 Vali Acc: 0.285 Test Loss: 1.493 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.2478413581848145
Epoch: 8, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.485 Vali Acc: 0.274 Test Loss: 1.485 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 7.0272603034973145
Epoch: 9, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.585 Vali Acc: 0.270 Test Loss: 1.585 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.7053892612457275
Epoch: 10, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.541 Vali Acc: 0.304 Test Loss: 1.541 Test Acc: 0.304
Validation loss decreased (-0.300365 --> -0.304167).  Saving model ...
Epoch: 11 cost time: 4.456959247589111
Epoch: 11, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.517 Vali Acc: 0.331 Test Loss: 1.517 Test Acc: 0.331
Validation loss decreased (-0.304167 --> -0.330783).  Saving model ...
Epoch: 12 cost time: 5.350995779037476
Epoch: 12, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.873 Vali Acc: 0.262 Test Loss: 1.873 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.945713758468628
Epoch: 13, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.520 Vali Acc: 0.327 Test Loss: 1.520 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.768956661224365
Epoch: 14, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.482 Vali Acc: 0.361 Test Loss: 1.482 Test Acc: 0.361
Validation loss decreased (-0.330783 --> -0.361202).  Saving model ...
Epoch: 15 cost time: 5.777203559875488
Epoch: 15, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.542 Vali Acc: 0.346 Test Loss: 1.542 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.9176554679870605
Epoch: 16, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.561 Vali Acc: 0.384 Test Loss: 1.561 Test Acc: 0.384
Validation loss decreased (-0.361202 --> -0.384015).  Saving model ...
Epoch: 17 cost time: 6.2377612590789795
Epoch: 17, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.565 Vali Acc: 0.338 Test Loss: 1.565 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.359918832778931
Epoch: 18, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.603 Vali Acc: 0.361 Test Loss: 1.603 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.7528181076049805
Epoch: 19, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.700 Vali Acc: 0.335 Test Loss: 1.700 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.301924228668213
Epoch: 20, Steps: 17 | Train Loss: 0.802 Vali Loss: 1.672 Vali Acc: 0.354 Test Loss: 1.672 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.0633885860443115
Epoch: 21, Steps: 17 | Train Loss: 0.806 Vali Loss: 2.104 Vali Acc: 0.316 Test Loss: 2.104 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.228865623474121
Epoch: 22, Steps: 17 | Train Loss: 0.744 Vali Loss: 1.773 Vali Acc: 0.357 Test Loss: 1.773 Test Acc: 0.357
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.512212038040161
Epoch: 23, Steps: 17 | Train Loss: 0.746 Vali Loss: 1.870 Vali Acc: 0.392 Test Loss: 1.870 Test Acc: 0.392
Validation loss decreased (-0.384015 --> -0.391616).  Saving model ...
Epoch: 24 cost time: 7.21853494644165
Epoch: 24, Steps: 17 | Train Loss: 0.780 Vali Loss: 2.091 Vali Acc: 0.319 Test Loss: 2.091 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 7.15410041809082
Epoch: 25, Steps: 17 | Train Loss: 0.616 Vali Loss: 1.838 Vali Acc: 0.452 Test Loss: 1.838 Test Acc: 0.452
Validation loss decreased (-0.391616 --> -0.452453).  Saving model ...
Epoch: 26 cost time: 6.844988822937012
Epoch: 26, Steps: 17 | Train Loss: 0.552 Vali Loss: 2.088 Vali Acc: 0.350 Test Loss: 2.088 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 7.168185710906982
Epoch: 27, Steps: 17 | Train Loss: 0.632 Vali Loss: 2.044 Vali Acc: 0.350 Test Loss: 2.044 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.196674585342407
Epoch: 28, Steps: 17 | Train Loss: 0.521 Vali Loss: 2.209 Vali Acc: 0.354 Test Loss: 2.209 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.7687413692474365
Epoch: 29, Steps: 17 | Train Loss: 0.527 Vali Loss: 2.288 Vali Acc: 0.342 Test Loss: 2.288 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.53987979888916
Epoch: 30, Steps: 17 | Train Loss: 0.479 Vali Loss: 2.185 Vali Acc: 0.365 Test Loss: 2.185 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.234471321105957
Epoch: 31, Steps: 17 | Train Loss: 0.453 Vali Loss: 2.496 Vali Acc: 0.392 Test Loss: 2.496 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 7.399651288986206
Epoch: 32, Steps: 17 | Train Loss: 0.651 Vali Loss: 2.841 Vali Acc: 0.308 Test Loss: 2.841 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.505903959274292
Epoch: 33, Steps: 17 | Train Loss: 0.596 Vali Loss: 2.389 Vali Acc: 0.395 Test Loss: 2.389 Test Acc: 0.395
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.399068117141724
Epoch: 34, Steps: 17 | Train Loss: 0.440 Vali Loss: 2.499 Vali Acc: 0.357 Test Loss: 2.499 Test Acc: 0.357
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 7.07691216468811
Epoch: 35, Steps: 17 | Train Loss: 0.469 Vali Loss: 3.038 Vali Acc: 0.327 Test Loss: 3.038 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4524714828897338
model parameter : 3812800
model size : 17.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.114800453186035
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.418 Vali Acc: 0.205 Test Loss: 1.418 Test Acc: 0.205
Validation loss decreased (inf --> -0.205309).  Saving model ...
Epoch: 2 cost time: 4.639349460601807
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.436 Vali Acc: 0.266 Test Loss: 1.436 Test Acc: 0.266
Validation loss decreased (-0.205309 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 5.79807710647583
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.463 Vali Acc: 0.240 Test Loss: 1.463 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.059159278869629
Epoch: 4, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.400 Vali Acc: 0.316 Test Loss: 1.400 Test Acc: 0.316
Validation loss decreased (-0.266145 --> -0.315575).  Saving model ...
Epoch: 5 cost time: 5.53983473777771
Epoch: 5, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.469 Vali Acc: 0.308 Test Loss: 1.469 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.893050670623779
Epoch: 6, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.439 Vali Acc: 0.259 Test Loss: 1.439 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.954362869262695
Epoch: 7, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.677 Vali Acc: 0.255 Test Loss: 1.677 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.7183239459991455
Epoch: 8, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.846 Vali Acc: 0.278 Test Loss: 1.846 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 7.1727964878082275
Epoch: 9, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.615 Vali Acc: 0.274 Test Loss: 1.615 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 6.950580835342407
Epoch: 10, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.492 Vali Acc: 0.327 Test Loss: 1.492 Test Acc: 0.327
Validation loss decreased (-0.315575 --> -0.326981).  Saving model ...
Epoch: 11 cost time: 7.333181142807007
Epoch: 11, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.699 Vali Acc: 0.335 Test Loss: 1.699 Test Acc: 0.335
Validation loss decreased (-0.326981 --> -0.334584).  Saving model ...
Epoch: 12 cost time: 6.242828130722046
Epoch: 12, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.976 Vali Acc: 0.281 Test Loss: 1.976 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.627429246902466
Epoch: 13, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.509 Vali Acc: 0.350 Test Loss: 1.509 Test Acc: 0.350
Validation loss decreased (-0.334584 --> -0.349795).  Saving model ...
Epoch: 14 cost time: 6.478835344314575
Epoch: 14, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.516 Vali Acc: 0.350 Test Loss: 1.516 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.533283233642578
Epoch: 15, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.650 Vali Acc: 0.312 Test Loss: 1.650 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.86541748046875
Epoch: 16, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.721 Vali Acc: 0.327 Test Loss: 1.721 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.305288314819336
Epoch: 17, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.669 Vali Acc: 0.361 Test Loss: 1.669 Test Acc: 0.361
Validation loss decreased (-0.349795 --> -0.361200).  Saving model ...
Epoch: 18 cost time: 6.977431774139404
Epoch: 18, Steps: 17 | Train Loss: 0.881 Vali Loss: 1.647 Vali Acc: 0.327 Test Loss: 1.647 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.410561800003052
Epoch: 19, Steps: 17 | Train Loss: 0.899 Vali Loss: 1.592 Vali Acc: 0.411 Test Loss: 1.592 Test Acc: 0.411
Validation loss decreased (-0.361200 --> -0.410630).  Saving model ...
Epoch: 20 cost time: 5.978554010391235
Epoch: 20, Steps: 17 | Train Loss: 0.854 Vali Loss: 1.700 Vali Acc: 0.403 Test Loss: 1.700 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.967740058898926
Epoch: 21, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.809 Vali Acc: 0.335 Test Loss: 1.809 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.245462894439697
Epoch: 22, Steps: 17 | Train Loss: 0.789 Vali Loss: 1.806 Vali Acc: 0.342 Test Loss: 1.806 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.24733829498291
Epoch: 23, Steps: 17 | Train Loss: 0.725 Vali Loss: 2.135 Vali Acc: 0.327 Test Loss: 2.135 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.102310657501221
Epoch: 24, Steps: 17 | Train Loss: 0.679 Vali Loss: 2.144 Vali Acc: 0.384 Test Loss: 2.144 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.073576211929321
Epoch: 25, Steps: 17 | Train Loss: 0.885 Vali Loss: 2.017 Vali Acc: 0.365 Test Loss: 2.017 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.521779775619507
Epoch: 26, Steps: 17 | Train Loss: 0.599 Vali Loss: 2.186 Vali Acc: 0.365 Test Loss: 2.186 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 7.198205232620239
Epoch: 27, Steps: 17 | Train Loss: 0.628 Vali Loss: 1.965 Vali Acc: 0.350 Test Loss: 1.965 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.3595476150512695
Epoch: 28, Steps: 17 | Train Loss: 0.560 Vali Loss: 2.378 Vali Acc: 0.338 Test Loss: 2.378 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.696403503417969
Epoch: 29, Steps: 17 | Train Loss: 0.705 Vali Loss: 2.582 Vali Acc: 0.335 Test Loss: 2.582 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 3777600
model size : 17.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.128145456314087
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.391 Vali Acc: 0.255 Test Loss: 1.391 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 5.974008321762085
Epoch: 2, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.406 Vali Acc: 0.259 Test Loss: 1.406 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258541).  Saving model ...
Epoch: 3 cost time: 5.941442012786865
Epoch: 3, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.662 Vali Acc: 0.262 Test Loss: 1.662 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262341).  Saving model ...
Epoch: 4 cost time: 6.150696516036987
Epoch: 4, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.438 Vali Acc: 0.255 Test Loss: 1.438 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.342153072357178
Epoch: 5, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.772 Vali Acc: 0.247 Test Loss: 1.772 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.180437803268433
Epoch: 6, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.468 Vali Acc: 0.278 Test Loss: 1.468 Test Acc: 0.278
Validation loss decreased (-0.262341 --> -0.277552).  Saving model ...
Epoch: 7 cost time: 4.946392059326172
Epoch: 7, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.734 Vali Acc: 0.251 Test Loss: 1.734 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.281854152679443
Epoch: 8, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.515 Vali Acc: 0.274 Test Loss: 1.515 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.8347532749176025
Epoch: 9, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.613 Vali Acc: 0.270 Test Loss: 1.613 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.560697555541992
Epoch: 10, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.534 Vali Acc: 0.312 Test Loss: 1.534 Test Acc: 0.312
Validation loss decreased (-0.277552 --> -0.311772).  Saving model ...
Epoch: 11 cost time: 5.452756404876709
Epoch: 11, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.544 Vali Acc: 0.331 Test Loss: 1.544 Test Acc: 0.331
Validation loss decreased (-0.311772 --> -0.330783).  Saving model ...
Epoch: 12 cost time: 6.11161732673645
Epoch: 12, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.708 Vali Acc: 0.308 Test Loss: 1.708 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.543351411819458
Epoch: 13, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.145 Vali Acc: 0.293 Test Loss: 2.145 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.753793001174927
Epoch: 14, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.645 Vali Acc: 0.312 Test Loss: 1.645 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.9381797313690186
Epoch: 15, Steps: 17 | Train Loss: 0.875 Vali Loss: 1.840 Vali Acc: 0.323 Test Loss: 1.840 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.670624017715454
Epoch: 16, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.667 Vali Acc: 0.323 Test Loss: 1.667 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.521928548812866
Epoch: 17, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.639 Vali Acc: 0.327 Test Loss: 1.639 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.464046239852905
Epoch: 18, Steps: 17 | Train Loss: 0.772 Vali Loss: 1.910 Vali Acc: 0.342 Test Loss: 1.910 Test Acc: 0.342
Validation loss decreased (-0.330783 --> -0.342186).  Saving model ...
Epoch: 19 cost time: 6.221514701843262
Epoch: 19, Steps: 17 | Train Loss: 0.770 Vali Loss: 1.670 Vali Acc: 0.323 Test Loss: 1.670 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.516651153564453
Epoch: 20, Steps: 17 | Train Loss: 0.641 Vali Loss: 1.723 Vali Acc: 0.411 Test Loss: 1.723 Test Acc: 0.411
Validation loss decreased (-0.342186 --> -0.410629).  Saving model ...
Epoch: 21 cost time: 5.949242830276489
Epoch: 21, Steps: 17 | Train Loss: 0.700 Vali Loss: 1.872 Vali Acc: 0.327 Test Loss: 1.872 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.430475473403931
Epoch: 22, Steps: 17 | Train Loss: 0.785 Vali Loss: 2.110 Vali Acc: 0.304 Test Loss: 2.110 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.6908652782440186
Epoch: 23, Steps: 17 | Train Loss: 0.664 Vali Loss: 2.540 Vali Acc: 0.262 Test Loss: 2.540 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.325286388397217
Epoch: 24, Steps: 17 | Train Loss: 0.730 Vali Loss: 1.867 Vali Acc: 0.380 Test Loss: 1.867 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.338953971862793
Epoch: 25, Steps: 17 | Train Loss: 0.738 Vali Loss: 2.084 Vali Acc: 0.308 Test Loss: 2.084 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.0037455558776855
Epoch: 26, Steps: 17 | Train Loss: 0.595 Vali Loss: 1.944 Vali Acc: 0.365 Test Loss: 1.944 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.975183725357056
Epoch: 27, Steps: 17 | Train Loss: 0.596 Vali Loss: 2.207 Vali Acc: 0.361 Test Loss: 2.207 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.041309118270874
Epoch: 28, Steps: 17 | Train Loss: 0.475 Vali Loss: 2.477 Vali Acc: 0.338 Test Loss: 2.477 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.77074122428894
Epoch: 29, Steps: 17 | Train Loss: 0.474 Vali Loss: 2.168 Vali Acc: 0.384 Test Loss: 2.168 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 6.082119941711426
Epoch: 30, Steps: 17 | Train Loss: 0.474 Vali Loss: 2.191 Vali Acc: 0.350 Test Loss: 2.191 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 3742400
model size : 16.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.853924512863159
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.488 Vali Acc: 0.251 Test Loss: 1.488 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 4.844205141067505
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.448 Vali Acc: 0.247 Test Loss: 1.448 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.064796447753906
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.439 Vali Acc: 0.274 Test Loss: 1.439 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273750).  Saving model ...
Epoch: 4 cost time: 4.871528148651123
Epoch: 4, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.539 Vali Acc: 0.255 Test Loss: 1.539 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.6677446365356445
Epoch: 5, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.580 Vali Acc: 0.255 Test Loss: 1.580 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.783518314361572
Epoch: 6, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.685 Vali Acc: 0.270 Test Loss: 1.685 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.5158045291900635
Epoch: 7, Steps: 17 | Train Loss: 1.365 Vali Loss: 2.201 Vali Acc: 0.251 Test Loss: 2.201 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.933932781219482
Epoch: 8, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.688 Vali Acc: 0.255 Test Loss: 1.688 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.003472089767456
Epoch: 9, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.414 Vali Acc: 0.304 Test Loss: 1.414 Test Acc: 0.304
Validation loss decreased (-0.273750 --> -0.304168).  Saving model ...
Epoch: 10 cost time: 5.592816114425659
Epoch: 10, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.537 Vali Acc: 0.281 Test Loss: 1.537 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.55378532409668
Epoch: 11, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.607 Vali Acc: 0.327 Test Loss: 1.607 Test Acc: 0.327
Validation loss decreased (-0.304168 --> -0.326980).  Saving model ...
Epoch: 12 cost time: 4.871346473693848
Epoch: 12, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.669 Vali Acc: 0.316 Test Loss: 1.669 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.572915554046631
Epoch: 13, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.798 Vali Acc: 0.323 Test Loss: 1.798 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.1189284324646
Epoch: 14, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.506 Vali Acc: 0.342 Test Loss: 1.506 Test Acc: 0.342
Validation loss decreased (-0.326980 --> -0.342190).  Saving model ...
Epoch: 15 cost time: 5.336724042892456
Epoch: 15, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.591 Vali Acc: 0.323 Test Loss: 1.591 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.442116737365723
Epoch: 16, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.438 Vali Acc: 0.392 Test Loss: 1.438 Test Acc: 0.392
Validation loss decreased (-0.342190 --> -0.391621).  Saving model ...
Epoch: 17 cost time: 5.79922080039978
Epoch: 17, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.598 Vali Acc: 0.369 Test Loss: 1.598 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.615900039672852
Epoch: 18, Steps: 17 | Train Loss: 0.857 Vali Loss: 1.791 Vali Acc: 0.331 Test Loss: 1.791 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.520819425582886
Epoch: 19, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.805 Vali Acc: 0.354 Test Loss: 1.805 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.46857762336731
Epoch: 20, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.758 Vali Acc: 0.373 Test Loss: 1.758 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.267320871353149
Epoch: 21, Steps: 17 | Train Loss: 0.805 Vali Loss: 1.789 Vali Acc: 0.373 Test Loss: 1.789 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.587483644485474
Epoch: 22, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.984 Vali Acc: 0.323 Test Loss: 1.984 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.7321577072143555
Epoch: 23, Steps: 17 | Train Loss: 0.836 Vali Loss: 1.744 Vali Acc: 0.384 Test Loss: 1.744 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.440282344818115
Epoch: 24, Steps: 17 | Train Loss: 0.666 Vali Loss: 1.890 Vali Acc: 0.376 Test Loss: 1.890 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.6130595207214355
Epoch: 25, Steps: 17 | Train Loss: 0.591 Vali Loss: 1.899 Vali Acc: 0.384 Test Loss: 1.899 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.920153856277466
Epoch: 26, Steps: 17 | Train Loss: 0.640 Vali Loss: 2.410 Vali Acc: 0.369 Test Loss: 2.410 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3916349809885932
model parameter : 3707200
model size : 16.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 9.07469129562378
Epoch: 1, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.387 Vali Acc: 0.270 Test Loss: 1.387 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 5.720553159713745
Epoch: 2, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.486 Vali Acc: 0.262 Test Loss: 1.486 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.32522988319397
Epoch: 3, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.635 Vali Acc: 0.259 Test Loss: 1.635 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.884157419204712
Epoch: 4, Steps: 17 | Train Loss: 1.544 Vali Loss: 1.639 Vali Acc: 0.243 Test Loss: 1.639 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.107638597488403
Epoch: 5, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.460 Vali Acc: 0.259 Test Loss: 1.460 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.392241477966309
Epoch: 6, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.677 Vali Acc: 0.259 Test Loss: 1.677 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 5.513756275177002
Epoch: 7, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.772 Vali Acc: 0.243 Test Loss: 1.772 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.558068752288818
Epoch: 8, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.598 Vali Acc: 0.251 Test Loss: 1.598 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.9738640785217285
Epoch: 9, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.492 Vali Acc: 0.274 Test Loss: 1.492 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273749).  Saving model ...
Epoch: 10 cost time: 5.355702877044678
Epoch: 10, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.445 Vali Acc: 0.289 Test Loss: 1.445 Test Acc: 0.289
Validation loss decreased (-0.273749 --> -0.288959).  Saving model ...
Epoch: 11 cost time: 4.524629831314087
Epoch: 11, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.434 Vali Acc: 0.300 Test Loss: 1.434 Test Acc: 0.300
Validation loss decreased (-0.288959 --> -0.300366).  Saving model ...
Epoch: 12 cost time: 4.046730995178223
Epoch: 12, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.420 Vali Acc: 0.373 Test Loss: 1.420 Test Acc: 0.373
Validation loss decreased (-0.300366 --> -0.372609).  Saving model ...
Epoch: 13 cost time: 5.171514272689819
Epoch: 13, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.445 Vali Acc: 0.300 Test Loss: 1.445 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.3488945960998535
Epoch: 14, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.490 Vali Acc: 0.357 Test Loss: 1.490 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.285810232162476
Epoch: 15, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.567 Vali Acc: 0.331 Test Loss: 1.567 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.865881443023682
Epoch: 16, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.628 Vali Acc: 0.293 Test Loss: 1.628 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.038487911224365
Epoch: 17, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.673 Vali Acc: 0.338 Test Loss: 1.673 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.600442409515381
Epoch: 18, Steps: 17 | Train Loss: 0.857 Vali Loss: 1.803 Vali Acc: 0.426 Test Loss: 1.803 Test Acc: 0.426
Validation loss decreased (-0.372609 --> -0.425837).  Saving model ...
Epoch: 19 cost time: 6.326149225234985
Epoch: 19, Steps: 17 | Train Loss: 0.906 Vali Loss: 1.980 Vali Acc: 0.289 Test Loss: 1.980 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.47114896774292
Epoch: 20, Steps: 17 | Train Loss: 0.923 Vali Loss: 1.736 Vali Acc: 0.319 Test Loss: 1.736 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.815623998641968
Epoch: 21, Steps: 17 | Train Loss: 0.795 Vali Loss: 1.748 Vali Acc: 0.365 Test Loss: 1.748 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.444035053253174
Epoch: 22, Steps: 17 | Train Loss: 0.689 Vali Loss: 1.883 Vali Acc: 0.399 Test Loss: 1.883 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.846860647201538
Epoch: 23, Steps: 17 | Train Loss: 0.739 Vali Loss: 1.824 Vali Acc: 0.384 Test Loss: 1.824 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.216825485229492
Epoch: 24, Steps: 17 | Train Loss: 0.702 Vali Loss: 2.150 Vali Acc: 0.350 Test Loss: 2.150 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.610198259353638
Epoch: 25, Steps: 17 | Train Loss: 0.646 Vali Loss: 1.765 Vali Acc: 0.407 Test Loss: 1.765 Test Acc: 0.407
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.551548004150391
Epoch: 26, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.100 Vali Acc: 0.338 Test Loss: 2.100 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 6.3657546043396
Epoch: 27, Steps: 17 | Train Loss: 0.655 Vali Loss: 2.019 Vali Acc: 0.361 Test Loss: 2.019 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.020262002944946
Epoch: 28, Steps: 17 | Train Loss: 0.659 Vali Loss: 2.158 Vali Acc: 0.300 Test Loss: 2.158 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.42585551330798477
model parameter : 3220672
model size : 14.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.882987976074219
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.426 Vali Acc: 0.259 Test Loss: 1.426 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 5.7177488803863525
Epoch: 2, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.594 Vali Acc: 0.266 Test Loss: 1.594 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266144).  Saving model ...
Epoch: 3 cost time: 5.176638126373291
Epoch: 3, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.447 Vali Acc: 0.278 Test Loss: 1.447 Test Acc: 0.278
Validation loss decreased (-0.266144 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 6.6184680461883545
Epoch: 4, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.503 Vali Acc: 0.274 Test Loss: 1.503 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.25766134262085
Epoch: 5, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.433 Vali Acc: 0.289 Test Loss: 1.433 Test Acc: 0.289
Validation loss decreased (-0.277552 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 5.647436141967773
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.472 Vali Acc: 0.312 Test Loss: 1.472 Test Acc: 0.312
Validation loss decreased (-0.288959 --> -0.311772).  Saving model ...
Epoch: 7 cost time: 5.176417589187622
Epoch: 7, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.529 Vali Acc: 0.251 Test Loss: 1.529 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.888795375823975
Epoch: 8, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.489 Vali Acc: 0.270 Test Loss: 1.489 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.391893625259399
Epoch: 9, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.569 Vali Acc: 0.308 Test Loss: 1.569 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.582488298416138
Epoch: 10, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.462 Vali Acc: 0.300 Test Loss: 1.462 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.970766067504883
Epoch: 11, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.411 Vali Acc: 0.373 Test Loss: 1.411 Test Acc: 0.373
Validation loss decreased (-0.311772 --> -0.372609).  Saving model ...
Epoch: 12 cost time: 6.225517749786377
Epoch: 12, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.617 Vali Acc: 0.300 Test Loss: 1.617 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.686575889587402
Epoch: 13, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.558 Vali Acc: 0.308 Test Loss: 1.558 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.377917289733887
Epoch: 14, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.549 Vali Acc: 0.316 Test Loss: 1.549 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.859484910964966
Epoch: 15, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.472 Vali Acc: 0.392 Test Loss: 1.472 Test Acc: 0.392
Validation loss decreased (-0.372609 --> -0.391620).  Saving model ...
Epoch: 16 cost time: 4.845332860946655
Epoch: 16, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.438 Vali Acc: 0.449 Test Loss: 1.438 Test Acc: 0.449
Validation loss decreased (-0.391620 --> -0.448655).  Saving model ...
Epoch: 17 cost time: 5.725848913192749
Epoch: 17, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.623 Vali Acc: 0.346 Test Loss: 1.623 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.362253427505493
Epoch: 18, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.942 Vali Acc: 0.312 Test Loss: 1.942 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.452303171157837
Epoch: 19, Steps: 17 | Train Loss: 0.836 Vali Loss: 1.624 Vali Acc: 0.384 Test Loss: 1.624 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.358246803283691
Epoch: 20, Steps: 17 | Train Loss: 0.841 Vali Loss: 2.543 Vali Acc: 0.331 Test Loss: 2.543 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.822670221328735
Epoch: 21, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.926 Vali Acc: 0.354 Test Loss: 1.926 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.095196962356567
Epoch: 22, Steps: 17 | Train Loss: 0.755 Vali Loss: 1.921 Vali Acc: 0.342 Test Loss: 1.921 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.408605098724365
Epoch: 23, Steps: 17 | Train Loss: 0.667 Vali Loss: 1.768 Vali Acc: 0.376 Test Loss: 1.768 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 6.331881284713745
Epoch: 24, Steps: 17 | Train Loss: 0.612 Vali Loss: 1.939 Vali Acc: 0.384 Test Loss: 1.939 Test Acc: 0.384
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.549220561981201
Epoch: 25, Steps: 17 | Train Loss: 0.581 Vali Loss: 1.977 Vali Acc: 0.312 Test Loss: 1.977 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.648143529891968
Epoch: 26, Steps: 17 | Train Loss: 0.575 Vali Loss: 2.183 Vali Acc: 0.327 Test Loss: 2.183 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.44866920152091255
model parameter : 3185472
model size : 14.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.043125629425049
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.410 Vali Acc: 0.251 Test Loss: 1.410 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 5.784633636474609
Epoch: 2, Steps: 17 | Train Loss: 1.521 Vali Loss: 1.775 Vali Acc: 0.255 Test Loss: 1.775 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254735).  Saving model ...
Epoch: 3 cost time: 5.581306219100952
Epoch: 3, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.577 Vali Acc: 0.255 Test Loss: 1.577 Test Acc: 0.255
Validation loss decreased (-0.254735 --> -0.254737).  Saving model ...
Epoch: 4 cost time: 3.8570468425750732
Epoch: 4, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.587 Vali Acc: 0.251 Test Loss: 1.587 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.548913478851318
Epoch: 5, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.406 Vali Acc: 0.259 Test Loss: 1.406 Test Acc: 0.259
Validation loss decreased (-0.254737 --> -0.258541).  Saving model ...
Epoch: 6 cost time: 5.003437757492065
Epoch: 6, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.550 Vali Acc: 0.266 Test Loss: 1.550 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266144).  Saving model ...
Epoch: 7 cost time: 3.660036563873291
Epoch: 7, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.450 Vali Acc: 0.274 Test Loss: 1.450 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273750).  Saving model ...
Epoch: 8 cost time: 4.932756662368774
Epoch: 8, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.437 Vali Acc: 0.243 Test Loss: 1.437 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.672358751296997
Epoch: 9, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.520 Vali Acc: 0.281 Test Loss: 1.520 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281354).  Saving model ...
Epoch: 10 cost time: 3.658844232559204
Epoch: 10, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.410 Vali Acc: 0.365 Test Loss: 1.410 Test Acc: 0.365
Validation loss decreased (-0.281354 --> -0.365005).  Saving model ...
Epoch: 11 cost time: 4.2065863609313965
Epoch: 11, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.486 Vali Acc: 0.323 Test Loss: 1.486 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.9752626419067383
Epoch: 12, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.453 Vali Acc: 0.361 Test Loss: 1.453 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.9084842205047607
Epoch: 13, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.539 Vali Acc: 0.316 Test Loss: 1.539 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.5997633934021
Epoch: 14, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.799 Vali Acc: 0.319 Test Loss: 1.799 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.814778804779053
Epoch: 15, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.652 Vali Acc: 0.338 Test Loss: 1.652 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.18516731262207
Epoch: 16, Steps: 17 | Train Loss: 0.937 Vali Loss: 1.545 Vali Acc: 0.361 Test Loss: 1.545 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.069267272949219
Epoch: 17, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.623 Vali Acc: 0.357 Test Loss: 1.623 Test Acc: 0.357
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.115081071853638
Epoch: 18, Steps: 17 | Train Loss: 0.861 Vali Loss: 1.586 Vali Acc: 0.369 Test Loss: 1.586 Test Acc: 0.369
Validation loss decreased (-0.365005 --> -0.368805).  Saving model ...
Epoch: 19 cost time: 5.269376993179321
Epoch: 19, Steps: 17 | Train Loss: 0.863 Vali Loss: 1.612 Vali Acc: 0.369 Test Loss: 1.612 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.594409465789795
Epoch: 20, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.774 Vali Acc: 0.319 Test Loss: 1.774 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.907219409942627
Epoch: 21, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.646 Vali Acc: 0.380 Test Loss: 1.646 Test Acc: 0.380
Validation loss decreased (-0.368805 --> -0.380212).  Saving model ...
Epoch: 22 cost time: 5.201993465423584
Epoch: 22, Steps: 17 | Train Loss: 0.834 Vali Loss: 2.055 Vali Acc: 0.342 Test Loss: 2.055 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.541860580444336
Epoch: 23, Steps: 17 | Train Loss: 0.676 Vali Loss: 2.034 Vali Acc: 0.312 Test Loss: 2.034 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.842632293701172
Epoch: 24, Steps: 17 | Train Loss: 0.708 Vali Loss: 1.811 Vali Acc: 0.380 Test Loss: 1.811 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.436565399169922
Epoch: 25, Steps: 17 | Train Loss: 0.789 Vali Loss: 2.114 Vali Acc: 0.331 Test Loss: 2.114 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.808182001113892
Epoch: 26, Steps: 17 | Train Loss: 0.550 Vali Loss: 2.068 Vali Acc: 0.388 Test Loss: 2.068 Test Acc: 0.388
Validation loss decreased (-0.380212 --> -0.387812).  Saving model ...
Epoch: 27 cost time: 6.239874362945557
Epoch: 27, Steps: 17 | Train Loss: 0.636 Vali Loss: 1.884 Vali Acc: 0.361 Test Loss: 1.884 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.785414218902588
Epoch: 28, Steps: 17 | Train Loss: 0.639 Vali Loss: 2.129 Vali Acc: 0.376 Test Loss: 2.129 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.007321357727051
Epoch: 29, Steps: 17 | Train Loss: 0.440 Vali Loss: 2.067 Vali Acc: 0.411 Test Loss: 2.067 Test Acc: 0.411
Validation loss decreased (-0.387812 --> -0.410626).  Saving model ...
Epoch: 30 cost time: 4.141316175460815
Epoch: 30, Steps: 17 | Train Loss: 0.522 Vali Loss: 2.484 Vali Acc: 0.323 Test Loss: 2.484 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.961535453796387
Epoch: 31, Steps: 17 | Train Loss: 0.532 Vali Loss: 2.195 Vali Acc: 0.335 Test Loss: 2.195 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.394787549972534
Epoch: 32, Steps: 17 | Train Loss: 0.432 Vali Loss: 3.012 Vali Acc: 0.304 Test Loss: 3.012 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.219230651855469
Epoch: 33, Steps: 17 | Train Loss: 0.391 Vali Loss: 2.507 Vali Acc: 0.384 Test Loss: 2.507 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.4672322273254395
Epoch: 34, Steps: 17 | Train Loss: 0.374 Vali Loss: 2.928 Vali Acc: 0.331 Test Loss: 2.928 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.68560791015625
Epoch: 35, Steps: 17 | Train Loss: 0.425 Vali Loss: 2.537 Vali Acc: 0.346 Test Loss: 2.537 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.318715572357178
Epoch: 36, Steps: 17 | Train Loss: 0.396 Vali Loss: 2.823 Vali Acc: 0.384 Test Loss: 2.823 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.84486198425293
Epoch: 37, Steps: 17 | Train Loss: 0.473 Vali Loss: 2.697 Vali Acc: 0.357 Test Loss: 2.697 Test Acc: 0.357
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.346589088439941
Epoch: 38, Steps: 17 | Train Loss: 0.351 Vali Loss: 2.643 Vali Acc: 0.327 Test Loss: 2.643 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.725561857223511
Epoch: 39, Steps: 17 | Train Loss: 0.323 Vali Loss: 2.658 Vali Acc: 0.392 Test Loss: 2.658 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 3150272
model size : 14.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.90116810798645
Epoch: 1, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.672 Vali Acc: 0.259 Test Loss: 1.672 Test Acc: 0.259
Validation loss decreased (inf --> -0.258538).  Saving model ...
Epoch: 2 cost time: 5.890712738037109
Epoch: 2, Steps: 17 | Train Loss: 1.690 Vali Loss: 1.388 Vali Acc: 0.285 Test Loss: 1.388 Test Acc: 0.285
Validation loss decreased (-0.258538 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 5.6148362159729
Epoch: 3, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.452 Vali Acc: 0.266 Test Loss: 1.452 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.802499532699585
Epoch: 4, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.413 Vali Acc: 0.297 Test Loss: 1.413 Test Acc: 0.297
Validation loss decreased (-0.285157 --> -0.296564).  Saving model ...
Epoch: 5 cost time: 5.228118658065796
Epoch: 5, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.465 Vali Acc: 0.243 Test Loss: 1.465 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.819530963897705
Epoch: 6, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.437 Vali Acc: 0.331 Test Loss: 1.437 Test Acc: 0.331
Validation loss decreased (-0.296564 --> -0.330784).  Saving model ...
Epoch: 7 cost time: 5.872796297073364
Epoch: 7, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.607 Vali Acc: 0.274 Test Loss: 1.607 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.564401865005493
Epoch: 8, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.620 Vali Acc: 0.255 Test Loss: 1.620 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.653278589248657
Epoch: 9, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.600 Vali Acc: 0.293 Test Loss: 1.600 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.332432270050049
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.404 Vali Acc: 0.384 Test Loss: 1.404 Test Acc: 0.384
Validation loss decreased (-0.330784 --> -0.384016).  Saving model ...
Epoch: 11 cost time: 5.234100341796875
Epoch: 11, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.497 Vali Acc: 0.357 Test Loss: 1.497 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.601800918579102
Epoch: 12, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.609 Vali Acc: 0.281 Test Loss: 1.609 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.292448997497559
Epoch: 13, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.481 Vali Acc: 0.354 Test Loss: 1.481 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.499924421310425
Epoch: 14, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.986 Vali Acc: 0.297 Test Loss: 1.986 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.289403676986694
Epoch: 15, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.503 Vali Acc: 0.338 Test Loss: 1.503 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.294307708740234
Epoch: 16, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.534 Vali Acc: 0.376 Test Loss: 1.534 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 5.720426082611084
Epoch: 17, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.582 Vali Acc: 0.388 Test Loss: 1.582 Test Acc: 0.388
Validation loss decreased (-0.384016 --> -0.387817).  Saving model ...
Epoch: 18 cost time: 5.024292469024658
Epoch: 18, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.654 Vali Acc: 0.350 Test Loss: 1.654 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.224420070648193
Epoch: 19, Steps: 17 | Train Loss: 0.736 Vali Loss: 2.011 Vali Acc: 0.316 Test Loss: 2.011 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.748454570770264
Epoch: 20, Steps: 17 | Train Loss: 0.808 Vali Loss: 1.727 Vali Acc: 0.346 Test Loss: 1.727 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.544048547744751
Epoch: 21, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.701 Vali Acc: 0.369 Test Loss: 1.701 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.433432102203369
Epoch: 22, Steps: 17 | Train Loss: 0.761 Vali Loss: 2.056 Vali Acc: 0.304 Test Loss: 2.056 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.8115787506103516
Epoch: 23, Steps: 17 | Train Loss: 0.760 Vali Loss: 2.326 Vali Acc: 0.327 Test Loss: 2.326 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.008535146713257
Epoch: 24, Steps: 17 | Train Loss: 0.796 Vali Loss: 1.833 Vali Acc: 0.403 Test Loss: 1.833 Test Acc: 0.403
Validation loss decreased (-0.387817 --> -0.403023).  Saving model ...
Epoch: 25 cost time: 6.540708065032959
Epoch: 25, Steps: 17 | Train Loss: 0.750 Vali Loss: 2.159 Vali Acc: 0.346 Test Loss: 2.159 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.652019023895264
Epoch: 26, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.225 Vali Acc: 0.346 Test Loss: 2.225 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.329469680786133
Epoch: 27, Steps: 17 | Train Loss: 0.754 Vali Loss: 2.508 Vali Acc: 0.308 Test Loss: 2.508 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.7257184982299805
Epoch: 28, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.044 Vali Acc: 0.422 Test Loss: 2.044 Test Acc: 0.422
Validation loss decreased (-0.403023 --> -0.422033).  Saving model ...
Epoch: 29 cost time: 5.026120662689209
Epoch: 29, Steps: 17 | Train Loss: 0.524 Vali Loss: 2.252 Vali Acc: 0.373 Test Loss: 2.252 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.5178422927856445
Epoch: 30, Steps: 17 | Train Loss: 0.533 Vali Loss: 2.487 Vali Acc: 0.335 Test Loss: 2.487 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.3578996658325195
Epoch: 31, Steps: 17 | Train Loss: 0.470 Vali Loss: 2.647 Vali Acc: 0.354 Test Loss: 2.647 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.9960761070251465
Epoch: 32, Steps: 17 | Train Loss: 0.486 Vali Loss: 2.421 Vali Acc: 0.365 Test Loss: 2.421 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 5.859131097793579
Epoch: 33, Steps: 17 | Train Loss: 0.449 Vali Loss: 2.628 Vali Acc: 0.316 Test Loss: 2.628 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.3769752979278564
Epoch: 34, Steps: 17 | Train Loss: 0.554 Vali Loss: 2.333 Vali Acc: 0.365 Test Loss: 2.333 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.440633058547974
Epoch: 35, Steps: 17 | Train Loss: 0.350 Vali Loss: 2.643 Vali Acc: 0.361 Test Loss: 2.643 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.788844347000122
Epoch: 36, Steps: 17 | Train Loss: 0.355 Vali Loss: 2.744 Vali Acc: 0.361 Test Loss: 2.744 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 3.9882709980010986
Epoch: 37, Steps: 17 | Train Loss: 0.333 Vali Loss: 2.669 Vali Acc: 0.304 Test Loss: 2.669 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.13271951675415
Epoch: 38, Steps: 17 | Train Loss: 0.274 Vali Loss: 2.860 Vali Acc: 0.380 Test Loss: 2.860 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4220532319391635
model parameter : 3115072
model size : 14.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.330060005187988
Epoch: 1, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.546 Vali Acc: 0.259 Test Loss: 1.546 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 5.901971340179443
Epoch: 2, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.458 Vali Acc: 0.262 Test Loss: 1.458 Test Acc: 0.262
Validation loss decreased (-0.258540 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 5.386945486068726
Epoch: 3, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.496 Vali Acc: 0.259 Test Loss: 1.496 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.330515146255493
Epoch: 4, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.464 Vali Acc: 0.243 Test Loss: 1.464 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.36971116065979
Epoch: 5, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.526 Vali Acc: 0.270 Test Loss: 1.526 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269947).  Saving model ...
Epoch: 6 cost time: 6.493533611297607
Epoch: 6, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.451 Vali Acc: 0.274 Test Loss: 1.451 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273750).  Saving model ...
Epoch: 7 cost time: 6.594923257827759
Epoch: 7, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.413 Vali Acc: 0.278 Test Loss: 1.413 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 8 cost time: 5.937276124954224
Epoch: 8, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.496 Vali Acc: 0.247 Test Loss: 1.496 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.875154733657837
Epoch: 9, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.475 Vali Acc: 0.300 Test Loss: 1.475 Test Acc: 0.300
Validation loss decreased (-0.277552 --> -0.300365).  Saving model ...
Epoch: 10 cost time: 5.869170665740967
Epoch: 10, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.730 Vali Acc: 0.266 Test Loss: 1.730 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.146383285522461
Epoch: 11, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.546 Vali Acc: 0.319 Test Loss: 1.546 Test Acc: 0.319
Validation loss decreased (-0.300365 --> -0.319376).  Saving model ...
Epoch: 12 cost time: 5.8287413120269775
Epoch: 12, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.604 Vali Acc: 0.319 Test Loss: 1.604 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.9669389724731445
Epoch: 13, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.664 Vali Acc: 0.331 Test Loss: 1.664 Test Acc: 0.331
Validation loss decreased (-0.319376 --> -0.330782).  Saving model ...
Epoch: 14 cost time: 5.6294779777526855
Epoch: 14, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.565 Vali Acc: 0.361 Test Loss: 1.565 Test Acc: 0.361
Validation loss decreased (-0.330782 --> -0.361201).  Saving model ...
Epoch: 15 cost time: 5.820603370666504
Epoch: 15, Steps: 17 | Train Loss: 1.197 Vali Loss: 1.585 Vali Acc: 0.346 Test Loss: 1.585 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.649799346923828
Epoch: 16, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.597 Vali Acc: 0.357 Test Loss: 1.597 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.60365104675293
Epoch: 17, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.483 Vali Acc: 0.388 Test Loss: 1.483 Test Acc: 0.388
Validation loss decreased (-0.361201 --> -0.387818).  Saving model ...
Epoch: 18 cost time: 5.634363651275635
Epoch: 18, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.588 Vali Acc: 0.373 Test Loss: 1.588 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.558605194091797
Epoch: 19, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.658 Vali Acc: 0.426 Test Loss: 1.658 Test Acc: 0.426
Validation loss decreased (-0.387818 --> -0.425839).  Saving model ...
Epoch: 20 cost time: 5.199068546295166
Epoch: 20, Steps: 17 | Train Loss: 0.790 Vali Loss: 1.868 Vali Acc: 0.316 Test Loss: 1.868 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.634353399276733
Epoch: 21, Steps: 17 | Train Loss: 0.767 Vali Loss: 1.900 Vali Acc: 0.365 Test Loss: 1.900 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.520068883895874
Epoch: 22, Steps: 17 | Train Loss: 0.786 Vali Loss: 1.743 Vali Acc: 0.411 Test Loss: 1.743 Test Acc: 0.411
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.791609764099121
Epoch: 23, Steps: 17 | Train Loss: 0.689 Vali Loss: 2.073 Vali Acc: 0.392 Test Loss: 2.073 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.198286056518555
Epoch: 24, Steps: 17 | Train Loss: 0.682 Vali Loss: 1.842 Vali Acc: 0.346 Test Loss: 1.842 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.514724493026733
Epoch: 25, Steps: 17 | Train Loss: 0.693 Vali Loss: 2.182 Vali Acc: 0.373 Test Loss: 2.182 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 6.5692644119262695
Epoch: 26, Steps: 17 | Train Loss: 0.717 Vali Loss: 2.011 Vali Acc: 0.361 Test Loss: 2.011 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.644795656204224
Epoch: 27, Steps: 17 | Train Loss: 0.640 Vali Loss: 2.073 Vali Acc: 0.380 Test Loss: 2.073 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.081163644790649
Epoch: 28, Steps: 17 | Train Loss: 0.549 Vali Loss: 2.056 Vali Acc: 0.399 Test Loss: 2.056 Test Acc: 0.399
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.028104305267334
Epoch: 29, Steps: 17 | Train Loss: 0.510 Vali Loss: 2.170 Vali Acc: 0.384 Test Loss: 2.170 Test Acc: 0.384
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.42585551330798477
model parameter : 2924608
model size : 13.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.240221738815308
Epoch: 1, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.512 Vali Acc: 0.266 Test Loss: 1.512 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 5.4444310665130615
Epoch: 2, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.670 Vali Acc: 0.251 Test Loss: 1.670 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.4649152755737305
Epoch: 3, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.582 Vali Acc: 0.266 Test Loss: 1.582 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.753064870834351
Epoch: 4, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.493 Vali Acc: 0.259 Test Loss: 1.493 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.493640422821045
Epoch: 5, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.416 Vali Acc: 0.278 Test Loss: 1.416 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 5.1382787227630615
Epoch: 6, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.592 Vali Acc: 0.297 Test Loss: 1.592 Test Acc: 0.297
Validation loss decreased (-0.277552 --> -0.296562).  Saving model ...
Epoch: 7 cost time: 4.420575380325317
Epoch: 7, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.885 Vali Acc: 0.247 Test Loss: 1.885 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.300318241119385
Epoch: 8, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.560 Vali Acc: 0.308 Test Loss: 1.560 Test Acc: 0.308
Validation loss decreased (-0.296562 --> -0.307969).  Saving model ...
Epoch: 9 cost time: 4.758148670196533
Epoch: 9, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.591 Vali Acc: 0.289 Test Loss: 1.591 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.536792039871216
Epoch: 10, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.540 Vali Acc: 0.247 Test Loss: 1.540 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.494462490081787
Epoch: 11, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.599 Vali Acc: 0.304 Test Loss: 1.599 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.536968946456909
Epoch: 12, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.464 Vali Acc: 0.342 Test Loss: 1.464 Test Acc: 0.342
Validation loss decreased (-0.307969 --> -0.342191).  Saving model ...
Epoch: 13 cost time: 6.846555948257446
Epoch: 13, Steps: 17 | Train Loss: 1.153 Vali Loss: 1.394 Vali Acc: 0.384 Test Loss: 1.394 Test Acc: 0.384
Validation loss decreased (-0.342191 --> -0.384016).  Saving model ...
Epoch: 14 cost time: 6.385162115097046
Epoch: 14, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.392 Vali Acc: 0.357 Test Loss: 1.392 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.491702556610107
Epoch: 15, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.490 Vali Acc: 0.335 Test Loss: 1.490 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.956084966659546
Epoch: 16, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.536 Vali Acc: 0.346 Test Loss: 1.536 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.524255990982056
Epoch: 17, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.641 Vali Acc: 0.361 Test Loss: 1.641 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.581094264984131
Epoch: 18, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.576 Vali Acc: 0.357 Test Loss: 1.576 Test Acc: 0.357
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.569380044937134
Epoch: 19, Steps: 17 | Train Loss: 0.907 Vali Loss: 1.667 Vali Acc: 0.365 Test Loss: 1.667 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.349742889404297
Epoch: 20, Steps: 17 | Train Loss: 0.863 Vali Loss: 1.571 Vali Acc: 0.414 Test Loss: 1.571 Test Acc: 0.414
Validation loss decreased (-0.384016 --> -0.414433).  Saving model ...
Epoch: 21 cost time: 5.178399562835693
Epoch: 21, Steps: 17 | Train Loss: 0.744 Vali Loss: 1.709 Vali Acc: 0.331 Test Loss: 1.709 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.19194769859314
Epoch: 22, Steps: 17 | Train Loss: 0.820 Vali Loss: 1.712 Vali Acc: 0.376 Test Loss: 1.712 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.093377590179443
Epoch: 23, Steps: 17 | Train Loss: 0.758 Vali Loss: 1.894 Vali Acc: 0.346 Test Loss: 1.894 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.988020896911621
Epoch: 24, Steps: 17 | Train Loss: 0.811 Vali Loss: 1.769 Vali Acc: 0.388 Test Loss: 1.769 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.719756841659546
Epoch: 25, Steps: 17 | Train Loss: 0.663 Vali Loss: 2.194 Vali Acc: 0.384 Test Loss: 2.194 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.943087816238403
Epoch: 26, Steps: 17 | Train Loss: 0.728 Vali Loss: 1.794 Vali Acc: 0.411 Test Loss: 1.794 Test Acc: 0.411
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.670575380325317
Epoch: 27, Steps: 17 | Train Loss: 0.619 Vali Loss: 1.819 Vali Acc: 0.392 Test Loss: 1.819 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.53036093711853
Epoch: 28, Steps: 17 | Train Loss: 0.569 Vali Loss: 1.828 Vali Acc: 0.392 Test Loss: 1.828 Test Acc: 0.392
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.695815563201904
Epoch: 29, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.951 Vali Acc: 0.399 Test Loss: 1.951 Test Acc: 0.399
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.440636873245239
Epoch: 30, Steps: 17 | Train Loss: 0.631 Vali Loss: 2.184 Vali Acc: 0.369 Test Loss: 2.184 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 2889408
model size : 13.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.152559518814087
Epoch: 1, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.540 Vali Acc: 0.255 Test Loss: 1.540 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 5.3941240310668945
Epoch: 2, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.447 Vali Acc: 0.266 Test Loss: 1.447 Test Acc: 0.266
Validation loss decreased (-0.254737 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 6.05620002746582
Epoch: 3, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.456 Vali Acc: 0.270 Test Loss: 1.456 Test Acc: 0.270
Validation loss decreased (-0.266145 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 6.1447296142578125
Epoch: 4, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.625 Vali Acc: 0.243 Test Loss: 1.625 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.910008192062378
Epoch: 5, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.448 Vali Acc: 0.270 Test Loss: 1.448 Test Acc: 0.270
Validation loss decreased (-0.269947 --> -0.269947).  Saving model ...
Epoch: 6 cost time: 6.092148780822754
Epoch: 6, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.555 Vali Acc: 0.278 Test Loss: 1.555 Test Acc: 0.278
Validation loss decreased (-0.269947 --> -0.277551).  Saving model ...
Epoch: 7 cost time: 5.633891820907593
Epoch: 7, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.505 Vali Acc: 0.278 Test Loss: 1.505 Test Acc: 0.278
Validation loss decreased (-0.277551 --> -0.277551).  Saving model ...
Epoch: 8 cost time: 5.480156183242798
Epoch: 8, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.607 Vali Acc: 0.255 Test Loss: 1.607 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.782883167266846
Epoch: 9, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.461 Vali Acc: 0.312 Test Loss: 1.461 Test Acc: 0.312
Validation loss decreased (-0.277551 --> -0.311772).  Saving model ...
Epoch: 10 cost time: 5.844276428222656
Epoch: 10, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.882 Vali Acc: 0.259 Test Loss: 1.882 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.60593843460083
Epoch: 11, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.417 Vali Acc: 0.369 Test Loss: 1.417 Test Acc: 0.369
Validation loss decreased (-0.311772 --> -0.368807).  Saving model ...
Epoch: 12 cost time: 4.9392006397247314
Epoch: 12, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.669 Vali Acc: 0.373 Test Loss: 1.669 Test Acc: 0.373
Validation loss decreased (-0.368807 --> -0.372607).  Saving model ...
Epoch: 13 cost time: 4.37500524520874
Epoch: 13, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.773 Vali Acc: 0.289 Test Loss: 1.773 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.331675291061401
Epoch: 14, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.740 Vali Acc: 0.357 Test Loss: 1.740 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.099040508270264
Epoch: 15, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.593 Vali Acc: 0.395 Test Loss: 1.593 Test Acc: 0.395
Validation loss decreased (-0.372607 --> -0.395421).  Saving model ...
Epoch: 16 cost time: 4.956947565078735
Epoch: 16, Steps: 17 | Train Loss: 0.881 Vali Loss: 1.662 Vali Acc: 0.403 Test Loss: 1.662 Test Acc: 0.403
Validation loss decreased (-0.395421 --> -0.403025).  Saving model ...
Epoch: 17 cost time: 5.197966575622559
Epoch: 17, Steps: 17 | Train Loss: 0.875 Vali Loss: 1.584 Vali Acc: 0.403 Test Loss: 1.584 Test Acc: 0.403
Validation loss decreased (-0.403025 --> -0.403026).  Saving model ...
Epoch: 18 cost time: 5.8842387199401855
Epoch: 18, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.703 Vali Acc: 0.357 Test Loss: 1.703 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.093935966491699
Epoch: 19, Steps: 17 | Train Loss: 0.820 Vali Loss: 1.684 Vali Acc: 0.399 Test Loss: 1.684 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.013254404067993
Epoch: 20, Steps: 17 | Train Loss: 0.806 Vali Loss: 1.775 Vali Acc: 0.327 Test Loss: 1.775 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.567005634307861
Epoch: 21, Steps: 17 | Train Loss: 0.785 Vali Loss: 1.938 Vali Acc: 0.373 Test Loss: 1.938 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.523705244064331
Epoch: 22, Steps: 17 | Train Loss: 0.744 Vali Loss: 1.900 Vali Acc: 0.357 Test Loss: 1.900 Test Acc: 0.357
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.783553838729858
Epoch: 23, Steps: 17 | Train Loss: 0.641 Vali Loss: 1.895 Vali Acc: 0.361 Test Loss: 1.895 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.063600063323975
Epoch: 24, Steps: 17 | Train Loss: 0.685 Vali Loss: 1.999 Vali Acc: 0.361 Test Loss: 1.999 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.549133777618408
Epoch: 25, Steps: 17 | Train Loss: 0.615 Vali Loss: 2.029 Vali Acc: 0.388 Test Loss: 2.029 Test Acc: 0.388
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.127315998077393
Epoch: 26, Steps: 17 | Train Loss: 0.656 Vali Loss: 2.004 Vali Acc: 0.350 Test Loss: 2.004 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.618050813674927
Epoch: 27, Steps: 17 | Train Loss: 0.604 Vali Loss: 2.239 Vali Acc: 0.319 Test Loss: 2.239 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.40304182509505704
model parameter : 2854208
model size : 13.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.181657075881958
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.413 Vali Acc: 0.243 Test Loss: 1.413 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 5.121379375457764
Epoch: 2, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.501 Vali Acc: 0.247 Test Loss: 1.501 Test Acc: 0.247
Validation loss decreased (-0.243332 --> -0.247133).  Saving model ...
Epoch: 3 cost time: 4.081465005874634
Epoch: 3, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.477 Vali Acc: 0.278 Test Loss: 1.477 Test Acc: 0.278
Validation loss decreased (-0.247133 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 4.665913343429565
Epoch: 4, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.532 Vali Acc: 0.259 Test Loss: 1.532 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.108927488327026
Epoch: 5, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.508 Vali Acc: 0.236 Test Loss: 1.508 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.36698579788208
Epoch: 6, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.462 Vali Acc: 0.274 Test Loss: 1.462 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.3673083782196045
Epoch: 7, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.578 Vali Acc: 0.259 Test Loss: 1.578 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.78563928604126
Epoch: 8, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.496 Vali Acc: 0.293 Test Loss: 1.496 Test Acc: 0.293
Validation loss decreased (-0.277552 --> -0.292761).  Saving model ...
Epoch: 9 cost time: 5.966574430465698
Epoch: 9, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.566 Vali Acc: 0.281 Test Loss: 1.566 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.649840593338013
Epoch: 10, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.822 Vali Acc: 0.259 Test Loss: 1.822 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.305877923965454
Epoch: 11, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.520 Vali Acc: 0.369 Test Loss: 1.520 Test Acc: 0.369
Validation loss decreased (-0.292761 --> -0.368806).  Saving model ...
Epoch: 12 cost time: 5.623227596282959
Epoch: 12, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.483 Vali Acc: 0.297 Test Loss: 1.483 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.315205812454224
Epoch: 13, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.512 Vali Acc: 0.346 Test Loss: 1.512 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.48206353187561
Epoch: 14, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.693 Vali Acc: 0.289 Test Loss: 1.693 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.162503719329834
Epoch: 15, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.726 Vali Acc: 0.369 Test Loss: 1.726 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.72006368637085
Epoch: 16, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.547 Vali Acc: 0.365 Test Loss: 1.547 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.270226001739502
Epoch: 17, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.564 Vali Acc: 0.350 Test Loss: 1.564 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.461453676223755
Epoch: 18, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.596 Vali Acc: 0.384 Test Loss: 1.596 Test Acc: 0.384
Validation loss decreased (-0.368806 --> -0.384014).  Saving model ...
Epoch: 19 cost time: 4.263185024261475
Epoch: 19, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.609 Vali Acc: 0.395 Test Loss: 1.609 Test Acc: 0.395
Validation loss decreased (-0.384014 --> -0.395421).  Saving model ...
Epoch: 20 cost time: 4.673095941543579
Epoch: 20, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.691 Vali Acc: 0.357 Test Loss: 1.691 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.234246492385864
Epoch: 21, Steps: 17 | Train Loss: 0.836 Vali Loss: 1.776 Vali Acc: 0.350 Test Loss: 1.776 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.469276428222656
Epoch: 22, Steps: 17 | Train Loss: 0.804 Vali Loss: 1.779 Vali Acc: 0.376 Test Loss: 1.779 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.176013469696045
Epoch: 23, Steps: 17 | Train Loss: 0.634 Vali Loss: 2.095 Vali Acc: 0.342 Test Loss: 2.095 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.049006462097168
Epoch: 24, Steps: 17 | Train Loss: 0.677 Vali Loss: 2.105 Vali Acc: 0.338 Test Loss: 2.105 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.47747278213501
Epoch: 25, Steps: 17 | Train Loss: 0.718 Vali Loss: 2.061 Vali Acc: 0.361 Test Loss: 2.061 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.033733606338501
Epoch: 26, Steps: 17 | Train Loss: 0.637 Vali Loss: 2.053 Vali Acc: 0.335 Test Loss: 2.053 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.573640823364258
Epoch: 27, Steps: 17 | Train Loss: 0.551 Vali Loss: 2.051 Vali Acc: 0.365 Test Loss: 2.051 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.441080093383789
Epoch: 28, Steps: 17 | Train Loss: 0.497 Vali Loss: 2.081 Vali Acc: 0.380 Test Loss: 2.081 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.9017393589019775
Epoch: 29, Steps: 17 | Train Loss: 0.478 Vali Loss: 2.387 Vali Acc: 0.342 Test Loss: 2.387 Test Acc: 0.342
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.39543726235741444
model parameter : 2819008
model size : 13.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.22804594039917
Epoch: 1, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.459 Vali Acc: 0.251 Test Loss: 1.459 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 3.791285514831543
Epoch: 2, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.494 Vali Acc: 0.255 Test Loss: 1.494 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254738).  Saving model ...
Epoch: 3 cost time: 4.563474416732788
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 4.656444311141968
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.538 Vali Acc: 0.251 Test Loss: 1.538 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.011218786239624
Epoch: 5, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.482 Vali Acc: 0.278 Test Loss: 1.482 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 6.0878307819366455
Epoch: 6, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.611 Vali Acc: 0.255 Test Loss: 1.611 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.596027612686157
Epoch: 7, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.542 Vali Acc: 0.274 Test Loss: 1.542 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.178347587585449
Epoch: 8, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.567 Vali Acc: 0.259 Test Loss: 1.567 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.295980215072632
Epoch: 9, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.446 Vali Acc: 0.335 Test Loss: 1.446 Test Acc: 0.335
Validation loss decreased (-0.277552 --> -0.334586).  Saving model ...
Epoch: 10 cost time: 3.9739482402801514
Epoch: 10, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.652 Vali Acc: 0.266 Test Loss: 1.652 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.6229121685028076
Epoch: 11, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.412 Vali Acc: 0.316 Test Loss: 1.412 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.303609609603882
Epoch: 12, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.411 Vali Acc: 0.365 Test Loss: 1.411 Test Acc: 0.365
Validation loss decreased (-0.334586 --> -0.365005).  Saving model ...
Epoch: 13 cost time: 4.699925184249878
Epoch: 13, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.433 Vali Acc: 0.365 Test Loss: 1.433 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6477956771850586
Epoch: 14, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.517 Vali Acc: 0.369 Test Loss: 1.517 Test Acc: 0.369
Validation loss decreased (-0.365005 --> -0.368806).  Saving model ...
Epoch: 15 cost time: 4.227934122085571
Epoch: 15, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.500 Vali Acc: 0.354 Test Loss: 1.500 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.856868028640747
Epoch: 16, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.658 Vali Acc: 0.304 Test Loss: 1.658 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.90327525138855
Epoch: 17, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.542 Vali Acc: 0.365 Test Loss: 1.542 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.734736442565918
Epoch: 18, Steps: 17 | Train Loss: 0.881 Vali Loss: 1.404 Vali Acc: 0.407 Test Loss: 1.404 Test Acc: 0.407
Validation loss decreased (-0.368806 --> -0.406830).  Saving model ...
Epoch: 19 cost time: 5.451372146606445
Epoch: 19, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.437 Vali Acc: 0.395 Test Loss: 1.437 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.2867162227630615
Epoch: 20, Steps: 17 | Train Loss: 0.758 Vali Loss: 1.468 Vali Acc: 0.437 Test Loss: 1.468 Test Acc: 0.437
Validation loss decreased (-0.406830 --> -0.437248).  Saving model ...
Epoch: 21 cost time: 4.74420690536499
Epoch: 21, Steps: 17 | Train Loss: 0.741 Vali Loss: 1.564 Vali Acc: 0.369 Test Loss: 1.564 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.715169191360474
Epoch: 22, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.683 Vali Acc: 0.403 Test Loss: 1.683 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.611338138580322
Epoch: 23, Steps: 17 | Train Loss: 0.806 Vali Loss: 1.648 Vali Acc: 0.354 Test Loss: 1.648 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.996284246444702
Epoch: 24, Steps: 17 | Train Loss: 0.795 Vali Loss: 1.722 Vali Acc: 0.342 Test Loss: 1.722 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.351730108261108
Epoch: 25, Steps: 17 | Train Loss: 0.782 Vali Loss: 1.767 Vali Acc: 0.327 Test Loss: 1.767 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.897006511688232
Epoch: 26, Steps: 17 | Train Loss: 0.706 Vali Loss: 1.730 Vali Acc: 0.357 Test Loss: 1.730 Test Acc: 0.357
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.5305192470550537
Epoch: 27, Steps: 17 | Train Loss: 0.664 Vali Loss: 1.649 Vali Acc: 0.388 Test Loss: 1.649 Test Acc: 0.388
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.138446092605591
Epoch: 28, Steps: 17 | Train Loss: 0.615 Vali Loss: 1.838 Vali Acc: 0.369 Test Loss: 1.838 Test Acc: 0.369
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.110611200332642
Epoch: 29, Steps: 17 | Train Loss: 0.645 Vali Loss: 1.740 Vali Acc: 0.369 Test Loss: 1.740 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.598399877548218
Epoch: 30, Steps: 17 | Train Loss: 0.573 Vali Loss: 1.990 Vali Acc: 0.323 Test Loss: 1.990 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4372623574144487
model parameter : 1913344
model size : 8.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.832884788513184
Epoch: 1, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.496 Vali Acc: 0.270 Test Loss: 1.496 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 4.950324296951294
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.397 Vali Acc: 0.247 Test Loss: 1.397 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.599279403686523
Epoch: 3, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.521 Vali Acc: 0.243 Test Loss: 1.521 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.649986505508423
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.515 Vali Acc: 0.270 Test Loss: 1.515 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.6432108879089355
Epoch: 5, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.519 Vali Acc: 0.281 Test Loss: 1.519 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 4.910738468170166
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.474 Vali Acc: 0.274 Test Loss: 1.474 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.815619230270386
Epoch: 7, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.596 Vali Acc: 0.289 Test Loss: 1.596 Test Acc: 0.289
Validation loss decreased (-0.281354 --> -0.288957).  Saving model ...
Epoch: 8 cost time: 4.415174245834351
Epoch: 8, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.542 Vali Acc: 0.312 Test Loss: 1.542 Test Acc: 0.312
Validation loss decreased (-0.288957 --> -0.311772).  Saving model ...
Epoch: 9 cost time: 3.717453718185425
Epoch: 9, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.384 Vali Acc: 0.376 Test Loss: 1.384 Test Acc: 0.376
Validation loss decreased (-0.311772 --> -0.376412).  Saving model ...
Epoch: 10 cost time: 4.315985679626465
Epoch: 10, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.394 Vali Acc: 0.335 Test Loss: 1.394 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.100664377212524
Epoch: 11, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.460 Vali Acc: 0.312 Test Loss: 1.460 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.4556825160980225
Epoch: 12, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.369 Vali Acc: 0.373 Test Loss: 1.369 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.527358531951904
Epoch: 13, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.393 Vali Acc: 0.414 Test Loss: 1.393 Test Acc: 0.414
Validation loss decreased (-0.376412 --> -0.414435).  Saving model ...
Epoch: 14 cost time: 5.139272212982178
Epoch: 14, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.489 Vali Acc: 0.357 Test Loss: 1.489 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.9302985668182373
Epoch: 15, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.401 Vali Acc: 0.376 Test Loss: 1.401 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.65991997718811
Epoch: 16, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.484 Vali Acc: 0.392 Test Loss: 1.484 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.839858055114746
Epoch: 17, Steps: 17 | Train Loss: 0.882 Vali Loss: 1.340 Vali Acc: 0.399 Test Loss: 1.340 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.187749624252319
Epoch: 18, Steps: 17 | Train Loss: 0.810 Vali Loss: 1.383 Vali Acc: 0.437 Test Loss: 1.383 Test Acc: 0.437
Validation loss decreased (-0.414435 --> -0.437249).  Saving model ...
Epoch: 19 cost time: 4.8278422355651855
Epoch: 19, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.684 Vali Acc: 0.399 Test Loss: 1.684 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.851515054702759
Epoch: 20, Steps: 17 | Train Loss: 0.817 Vali Loss: 1.800 Vali Acc: 0.357 Test Loss: 1.800 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.533614635467529
Epoch: 21, Steps: 17 | Train Loss: 0.871 Vali Loss: 1.735 Vali Acc: 0.342 Test Loss: 1.735 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.551940441131592
Epoch: 22, Steps: 17 | Train Loss: 0.723 Vali Loss: 1.585 Vali Acc: 0.399 Test Loss: 1.585 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.886348485946655
Epoch: 23, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.704 Vali Acc: 0.380 Test Loss: 1.704 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.523866415023804
Epoch: 24, Steps: 17 | Train Loss: 0.695 Vali Loss: 1.721 Vali Acc: 0.403 Test Loss: 1.721 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.609982967376709
Epoch: 25, Steps: 17 | Train Loss: 0.623 Vali Loss: 1.629 Vali Acc: 0.430 Test Loss: 1.629 Test Acc: 0.430
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.7237231731414795
Epoch: 26, Steps: 17 | Train Loss: 0.634 Vali Loss: 1.653 Vali Acc: 0.403 Test Loss: 1.653 Test Acc: 0.403
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.926565647125244
Epoch: 27, Steps: 17 | Train Loss: 0.618 Vali Loss: 1.738 Vali Acc: 0.357 Test Loss: 1.738 Test Acc: 0.357
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.288868188858032
Epoch: 28, Steps: 17 | Train Loss: 0.500 Vali Loss: 1.612 Vali Acc: 0.433 Test Loss: 1.612 Test Acc: 0.433
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4372623574144487
model parameter : 1895744
model size : 8.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.193626403808594
Epoch: 1, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.436 Vali Acc: 0.262 Test Loss: 1.436 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 4.051090478897095
Epoch: 2, Steps: 17 | Train Loss: 1.553 Vali Loss: 1.482 Vali Acc: 0.247 Test Loss: 1.482 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.740538120269775
Epoch: 3, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.514 Vali Acc: 0.243 Test Loss: 1.514 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.3593432903289795
Epoch: 4, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.487 Vali Acc: 0.255 Test Loss: 1.487 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.889838457107544
Epoch: 5, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.442 Vali Acc: 0.300 Test Loss: 1.442 Test Acc: 0.300
Validation loss decreased (-0.262343 --> -0.300366).  Saving model ...
Epoch: 6 cost time: 4.932410478591919
Epoch: 6, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.643 Vali Acc: 0.251 Test Loss: 1.643 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.94455885887146
Epoch: 7, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.408 Vali Acc: 0.308 Test Loss: 1.408 Test Acc: 0.308
Validation loss decreased (-0.300366 --> -0.307971).  Saving model ...
Epoch: 8 cost time: 4.771693468093872
Epoch: 8, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.453 Vali Acc: 0.300 Test Loss: 1.453 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.023534059524536
Epoch: 9, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.451 Vali Acc: 0.281 Test Loss: 1.451 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.080648899078369
Epoch: 10, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.418 Vali Acc: 0.266 Test Loss: 1.418 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.670001268386841
Epoch: 11, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.414 Vali Acc: 0.331 Test Loss: 1.414 Test Acc: 0.331
Validation loss decreased (-0.307971 --> -0.330784).  Saving model ...
Epoch: 12 cost time: 4.8105010986328125
Epoch: 12, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.384 Vali Acc: 0.357 Test Loss: 1.384 Test Acc: 0.357
Validation loss decreased (-0.330784 --> -0.357401).  Saving model ...
Epoch: 13 cost time: 5.060125112533569
Epoch: 13, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.445 Vali Acc: 0.323 Test Loss: 1.445 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.115064859390259
Epoch: 14, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.469 Vali Acc: 0.304 Test Loss: 1.469 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.275950193405151
Epoch: 15, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.407 Vali Acc: 0.365 Test Loss: 1.407 Test Acc: 0.365
Validation loss decreased (-0.357401 --> -0.365005).  Saving model ...
Epoch: 16 cost time: 4.244108438491821
Epoch: 16, Steps: 17 | Train Loss: 1.106 Vali Loss: 2.317 Vali Acc: 0.262 Test Loss: 2.317 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.591494083404541
Epoch: 17, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.449 Vali Acc: 0.373 Test Loss: 1.449 Test Acc: 0.373
Validation loss decreased (-0.365005 --> -0.372609).  Saving model ...
Epoch: 18 cost time: 5.41229248046875
Epoch: 18, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.550 Vali Acc: 0.331 Test Loss: 1.550 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.316436529159546
Epoch: 19, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.781 Vali Acc: 0.304 Test Loss: 1.781 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.486011743545532
Epoch: 20, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.865 Vali Acc: 0.316 Test Loss: 1.865 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.369050979614258
Epoch: 21, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.421 Vali Acc: 0.403 Test Loss: 1.421 Test Acc: 0.403
Validation loss decreased (-0.372609 --> -0.403028).  Saving model ...
Epoch: 22 cost time: 4.380047798156738
Epoch: 22, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.499 Vali Acc: 0.433 Test Loss: 1.499 Test Acc: 0.433
Validation loss decreased (-0.403028 --> -0.433445).  Saving model ...
Epoch: 23 cost time: 4.665560960769653
Epoch: 23, Steps: 17 | Train Loss: 0.806 Vali Loss: 2.135 Vali Acc: 0.285 Test Loss: 2.135 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.069706678390503
Epoch: 24, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.599 Vali Acc: 0.354 Test Loss: 1.599 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.4568352699279785
Epoch: 25, Steps: 17 | Train Loss: 0.774 Vali Loss: 1.731 Vali Acc: 0.357 Test Loss: 1.731 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.885910511016846
Epoch: 26, Steps: 17 | Train Loss: 0.800 Vali Loss: 1.586 Vali Acc: 0.403 Test Loss: 1.586 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.838056564331055
Epoch: 27, Steps: 17 | Train Loss: 0.738 Vali Loss: 1.907 Vali Acc: 0.316 Test Loss: 1.907 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.794401168823242
Epoch: 28, Steps: 17 | Train Loss: 0.663 Vali Loss: 1.882 Vali Acc: 0.380 Test Loss: 1.882 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.426909923553467
Epoch: 29, Steps: 17 | Train Loss: 0.656 Vali Loss: 1.770 Vali Acc: 0.361 Test Loss: 1.770 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.976433515548706
Epoch: 30, Steps: 17 | Train Loss: 0.612 Vali Loss: 1.692 Vali Acc: 0.388 Test Loss: 1.692 Test Acc: 0.388
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.545525550842285
Epoch: 31, Steps: 17 | Train Loss: 0.585 Vali Loss: 1.954 Vali Acc: 0.395 Test Loss: 1.954 Test Acc: 0.395
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.125268936157227
Epoch: 32, Steps: 17 | Train Loss: 0.495 Vali Loss: 1.830 Vali Acc: 0.365 Test Loss: 1.830 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.43346007604562736
model parameter : 1878144
model size : 8.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.491492509841919
Epoch: 1, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.443 Vali Acc: 0.259 Test Loss: 1.443 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 4.619645357131958
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.463 Vali Acc: 0.255 Test Loss: 1.463 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.395290851593018
Epoch: 3, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.512 Vali Acc: 0.251 Test Loss: 1.512 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.334479570388794
Epoch: 4, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.449 Vali Acc: 0.270 Test Loss: 1.449 Test Acc: 0.270
Validation loss decreased (-0.258541 --> -0.269947).  Saving model ...
Epoch: 5 cost time: 3.9395813941955566
Epoch: 5, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.431 Vali Acc: 0.270 Test Loss: 1.431 Test Acc: 0.270
Validation loss decreased (-0.269947 --> -0.269948).  Saving model ...
Epoch: 6 cost time: 4.203085660934448
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.406 Vali Acc: 0.297 Test Loss: 1.406 Test Acc: 0.297
Validation loss decreased (-0.269948 --> -0.296564).  Saving model ...
Epoch: 7 cost time: 5.108677864074707
Epoch: 7, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.408 Vali Acc: 0.300 Test Loss: 1.408 Test Acc: 0.300
Validation loss decreased (-0.296564 --> -0.300366).  Saving model ...
Epoch: 8 cost time: 4.6496734619140625
Epoch: 8, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.433 Vali Acc: 0.274 Test Loss: 1.433 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.01330041885376
Epoch: 9, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.408 Vali Acc: 0.308 Test Loss: 1.408 Test Acc: 0.308
Validation loss decreased (-0.300366 --> -0.307971).  Saving model ...
Epoch: 10 cost time: 5.223641633987427
Epoch: 10, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.597 Vali Acc: 0.274 Test Loss: 1.597 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.751317262649536
Epoch: 11, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.730 Vali Acc: 0.259 Test Loss: 1.730 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.455056190490723
Epoch: 12, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.465 Vali Acc: 0.369 Test Loss: 1.465 Test Acc: 0.369
Validation loss decreased (-0.307971 --> -0.368807).  Saving model ...
Epoch: 13 cost time: 4.350986957550049
Epoch: 13, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.364 Vali Acc: 0.357 Test Loss: 1.364 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.331077575683594
Epoch: 14, Steps: 17 | Train Loss: 1.136 Vali Loss: 1.542 Vali Acc: 0.319 Test Loss: 1.542 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.8927693367004395
Epoch: 15, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.769 Vali Acc: 0.278 Test Loss: 1.769 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.537225961685181
Epoch: 16, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.470 Vali Acc: 0.350 Test Loss: 1.470 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.40279483795166
Epoch: 17, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.362 Vali Acc: 0.376 Test Loss: 1.362 Test Acc: 0.376
Validation loss decreased (-0.368807 --> -0.376412).  Saving model ...
Epoch: 18 cost time: 4.422686576843262
Epoch: 18, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.605 Vali Acc: 0.373 Test Loss: 1.605 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.511087894439697
Epoch: 19, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.611 Vali Acc: 0.373 Test Loss: 1.611 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.8019044399261475
Epoch: 20, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.542 Vali Acc: 0.399 Test Loss: 1.542 Test Acc: 0.399
Validation loss decreased (-0.376412 --> -0.399224).  Saving model ...
Epoch: 21 cost time: 4.7278218269348145
Epoch: 21, Steps: 17 | Train Loss: 0.810 Vali Loss: 1.638 Vali Acc: 0.369 Test Loss: 1.638 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.793215274810791
Epoch: 22, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.764 Vali Acc: 0.354 Test Loss: 1.764 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.179589509963989
Epoch: 23, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.518 Vali Acc: 0.392 Test Loss: 1.518 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.454529523849487
Epoch: 24, Steps: 17 | Train Loss: 0.699 Vali Loss: 1.574 Vali Acc: 0.426 Test Loss: 1.574 Test Acc: 0.426
Validation loss decreased (-0.399224 --> -0.425840).  Saving model ...
Epoch: 25 cost time: 4.404767274856567
Epoch: 25, Steps: 17 | Train Loss: 0.737 Vali Loss: 1.597 Vali Acc: 0.392 Test Loss: 1.597 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.3459367752075195
Epoch: 26, Steps: 17 | Train Loss: 0.633 Vali Loss: 1.663 Vali Acc: 0.384 Test Loss: 1.663 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.433580636978149
Epoch: 27, Steps: 17 | Train Loss: 0.617 Vali Loss: 1.742 Vali Acc: 0.376 Test Loss: 1.742 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.672448635101318
Epoch: 28, Steps: 17 | Train Loss: 0.591 Vali Loss: 1.808 Vali Acc: 0.388 Test Loss: 1.808 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.467194318771362
Epoch: 29, Steps: 17 | Train Loss: 0.583 Vali Loss: 1.720 Vali Acc: 0.407 Test Loss: 1.720 Test Acc: 0.407
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.755871057510376
Epoch: 30, Steps: 17 | Train Loss: 0.526 Vali Loss: 2.102 Vali Acc: 0.327 Test Loss: 2.102 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.1217124462127686
Epoch: 31, Steps: 17 | Train Loss: 0.513 Vali Loss: 2.015 Vali Acc: 0.399 Test Loss: 2.015 Test Acc: 0.399
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.782275199890137
Epoch: 32, Steps: 17 | Train Loss: 0.475 Vali Loss: 2.060 Vali Acc: 0.373 Test Loss: 2.060 Test Acc: 0.373
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.450453042984009
Epoch: 33, Steps: 17 | Train Loss: 0.624 Vali Loss: 2.360 Vali Acc: 0.346 Test Loss: 2.360 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.461054086685181
Epoch: 34, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.879 Vali Acc: 0.433 Test Loss: 1.879 Test Acc: 0.433
Validation loss decreased (-0.425840 --> -0.433441).  Saving model ...
Epoch: 35 cost time: 4.579718112945557
Epoch: 35, Steps: 17 | Train Loss: 0.355 Vali Loss: 2.202 Vali Acc: 0.388 Test Loss: 2.202 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.814547538757324
Epoch: 36, Steps: 17 | Train Loss: 0.440 Vali Loss: 2.187 Vali Acc: 0.380 Test Loss: 2.187 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.57990574836731
Epoch: 37, Steps: 17 | Train Loss: 0.407 Vali Loss: 2.168 Vali Acc: 0.380 Test Loss: 2.168 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.8061389923095703
Epoch: 38, Steps: 17 | Train Loss: 0.396 Vali Loss: 2.652 Vali Acc: 0.384 Test Loss: 2.652 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.3221209049224854
Epoch: 39, Steps: 17 | Train Loss: 0.450 Vali Loss: 2.089 Vali Acc: 0.399 Test Loss: 2.089 Test Acc: 0.399
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.6875782012939453
Epoch: 40, Steps: 17 | Train Loss: 0.349 Vali Loss: 2.239 Vali Acc: 0.426 Test Loss: 2.239 Test Acc: 0.426
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.199026346206665
Epoch: 41, Steps: 17 | Train Loss: 0.406 Vali Loss: 2.138 Vali Acc: 0.399 Test Loss: 2.138 Test Acc: 0.399
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.984074831008911
Epoch: 42, Steps: 17 | Train Loss: 0.278 Vali Loss: 2.299 Vali Acc: 0.411 Test Loss: 2.299 Test Acc: 0.411
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 4.435273170471191
Epoch: 43, Steps: 17 | Train Loss: 0.305 Vali Loss: 2.361 Vali Acc: 0.369 Test Loss: 2.361 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.068352699279785
Epoch: 44, Steps: 17 | Train Loss: 0.384 Vali Loss: 2.574 Vali Acc: 0.376 Test Loss: 2.574 Test Acc: 0.376
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.43346007604562736
model parameter : 1860544
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.147352933883667
Epoch: 1, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.392 Vali Acc: 0.240 Test Loss: 1.392 Test Acc: 0.240
Validation loss decreased (inf --> -0.239530).  Saving model ...
Epoch: 2 cost time: 6.0362584590911865
Epoch: 2, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.512 Vali Acc: 0.266 Test Loss: 1.512 Test Acc: 0.266
Validation loss decreased (-0.239530 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 5.609283924102783
Epoch: 3, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.427 Vali Acc: 0.262 Test Loss: 1.427 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.806869983673096
Epoch: 4, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.427 Vali Acc: 0.255 Test Loss: 1.427 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.735202074050903
Epoch: 5, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.393 Vali Acc: 0.281 Test Loss: 1.393 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281355).  Saving model ...
Epoch: 6 cost time: 5.4348485469818115
Epoch: 6, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.414 Vali Acc: 0.281 Test Loss: 1.414 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.783270835876465
Epoch: 7, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.418 Vali Acc: 0.304 Test Loss: 1.418 Test Acc: 0.304
Validation loss decreased (-0.281355 --> -0.304168).  Saving model ...
Epoch: 8 cost time: 5.14537239074707
Epoch: 8, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.539 Vali Acc: 0.289 Test Loss: 1.539 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.823571681976318
Epoch: 9, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.419 Vali Acc: 0.255 Test Loss: 1.419 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.685640096664429
Epoch: 10, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.574 Vali Acc: 0.304 Test Loss: 1.574 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.288926839828491
Epoch: 11, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.575 Vali Acc: 0.308 Test Loss: 1.575 Test Acc: 0.308
Validation loss decreased (-0.304168 --> -0.307969).  Saving model ...
Epoch: 12 cost time: 4.238949298858643
Epoch: 12, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.635 Vali Acc: 0.262 Test Loss: 1.635 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.291511058807373
Epoch: 13, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.590 Vali Acc: 0.312 Test Loss: 1.590 Test Acc: 0.312
Validation loss decreased (-0.307969 --> -0.311771).  Saving model ...
Epoch: 14 cost time: 3.8851122856140137
Epoch: 14, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.558 Vali Acc: 0.323 Test Loss: 1.558 Test Acc: 0.323
Validation loss decreased (-0.311771 --> -0.323178).  Saving model ...
Epoch: 15 cost time: 5.004645586013794
Epoch: 15, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.647 Vali Acc: 0.331 Test Loss: 1.647 Test Acc: 0.331
Validation loss decreased (-0.323178 --> -0.330782).  Saving model ...
Epoch: 16 cost time: 4.659806728363037
Epoch: 16, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.675 Vali Acc: 0.304 Test Loss: 1.675 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.832857370376587
Epoch: 17, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.506 Vali Acc: 0.350 Test Loss: 1.506 Test Acc: 0.350
Validation loss decreased (-0.330782 --> -0.349795).  Saving model ...
Epoch: 18 cost time: 5.017319440841675
Epoch: 18, Steps: 17 | Train Loss: 0.936 Vali Loss: 1.531 Vali Acc: 0.376 Test Loss: 1.531 Test Acc: 0.376
Validation loss decreased (-0.349795 --> -0.376411).  Saving model ...
Epoch: 19 cost time: 4.837600231170654
Epoch: 19, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.585 Vali Acc: 0.350 Test Loss: 1.585 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.071750164031982
Epoch: 20, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.544 Vali Acc: 0.369 Test Loss: 1.544 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.021377325057983
Epoch: 21, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.479 Vali Acc: 0.403 Test Loss: 1.479 Test Acc: 0.403
Validation loss decreased (-0.376411 --> -0.403027).  Saving model ...
Epoch: 22 cost time: 4.913506507873535
Epoch: 22, Steps: 17 | Train Loss: 0.760 Vali Loss: 1.476 Vali Acc: 0.395 Test Loss: 1.476 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.459372043609619
Epoch: 23, Steps: 17 | Train Loss: 0.723 Vali Loss: 1.647 Vali Acc: 0.407 Test Loss: 1.647 Test Acc: 0.407
Validation loss decreased (-0.403027 --> -0.406828).  Saving model ...
Epoch: 24 cost time: 6.261460304260254
Epoch: 24, Steps: 17 | Train Loss: 0.759 Vali Loss: 1.704 Vali Acc: 0.369 Test Loss: 1.704 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.340229272842407
Epoch: 25, Steps: 17 | Train Loss: 0.726 Vali Loss: 1.588 Vali Acc: 0.422 Test Loss: 1.588 Test Acc: 0.422
Validation loss decreased (-0.406828 --> -0.422037).  Saving model ...
Epoch: 26 cost time: 5.990094423294067
Epoch: 26, Steps: 17 | Train Loss: 0.631 Vali Loss: 1.967 Vali Acc: 0.342 Test Loss: 1.967 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.508626699447632
Epoch: 27, Steps: 17 | Train Loss: 0.796 Vali Loss: 1.697 Vali Acc: 0.338 Test Loss: 1.697 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.80997371673584
Epoch: 28, Steps: 17 | Train Loss: 0.600 Vali Loss: 1.685 Vali Acc: 0.411 Test Loss: 1.685 Test Acc: 0.411
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.018962860107422
Epoch: 29, Steps: 17 | Train Loss: 0.546 Vali Loss: 1.733 Vali Acc: 0.460 Test Loss: 1.733 Test Acc: 0.460
Validation loss decreased (-0.422037 --> -0.460059).  Saving model ...
Epoch: 30 cost time: 5.23540997505188
Epoch: 30, Steps: 17 | Train Loss: 0.586 Vali Loss: 1.990 Vali Acc: 0.319 Test Loss: 1.990 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.55167555809021
Epoch: 31, Steps: 17 | Train Loss: 0.590 Vali Loss: 1.874 Vali Acc: 0.430 Test Loss: 1.874 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.2094504833221436
Epoch: 32, Steps: 17 | Train Loss: 0.513 Vali Loss: 1.814 Vali Acc: 0.373 Test Loss: 1.814 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.620201587677002
Epoch: 33, Steps: 17 | Train Loss: 0.463 Vali Loss: 1.979 Vali Acc: 0.407 Test Loss: 1.979 Test Acc: 0.407
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.078371524810791
Epoch: 34, Steps: 17 | Train Loss: 0.390 Vali Loss: 1.988 Vali Acc: 0.350 Test Loss: 1.988 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.229924201965332
Epoch: 35, Steps: 17 | Train Loss: 0.412 Vali Loss: 2.208 Vali Acc: 0.380 Test Loss: 2.208 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.035107374191284
Epoch: 36, Steps: 17 | Train Loss: 0.409 Vali Loss: 2.138 Vali Acc: 0.350 Test Loss: 2.138 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.688039779663086
Epoch: 37, Steps: 17 | Train Loss: 0.431 Vali Loss: 2.162 Vali Acc: 0.357 Test Loss: 2.162 Test Acc: 0.357
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.3309645652771
Epoch: 38, Steps: 17 | Train Loss: 0.319 Vali Loss: 2.104 Vali Acc: 0.376 Test Loss: 2.104 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.2333457469940186
Epoch: 39, Steps: 17 | Train Loss: 0.282 Vali Loss: 2.117 Vali Acc: 0.395 Test Loss: 2.117 Test Acc: 0.395
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4600760456273764
model parameter : 1318912
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.944083213806152
Epoch: 1, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.479 Vali Acc: 0.247 Test Loss: 1.479 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 4.939485549926758
Epoch: 2, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.465 Vali Acc: 0.270 Test Loss: 1.465 Test Acc: 0.270
Validation loss decreased (-0.247133 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 4.8849194049835205
Epoch: 3, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.403 Vali Acc: 0.262 Test Loss: 1.403 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.193485736846924
Epoch: 4, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.790 Vali Acc: 0.251 Test Loss: 1.790 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.05578351020813
Epoch: 5, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.542 Vali Acc: 0.266 Test Loss: 1.542 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.955935001373291
Epoch: 6, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.408 Vali Acc: 0.297 Test Loss: 1.408 Test Acc: 0.297
Validation loss decreased (-0.269947 --> -0.296564).  Saving model ...
Epoch: 7 cost time: 5.216938495635986
Epoch: 7, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.450 Vali Acc: 0.308 Test Loss: 1.450 Test Acc: 0.308
Validation loss decreased (-0.296564 --> -0.307970).  Saving model ...
Epoch: 8 cost time: 4.835024833679199
Epoch: 8, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.459 Vali Acc: 0.247 Test Loss: 1.459 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.011312007904053
Epoch: 9, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.565 Vali Acc: 0.293 Test Loss: 1.565 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.180864095687866
Epoch: 10, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.423 Vali Acc: 0.278 Test Loss: 1.423 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.87258243560791
Epoch: 11, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.479 Vali Acc: 0.316 Test Loss: 1.479 Test Acc: 0.316
Validation loss decreased (-0.307970 --> -0.315575).  Saving model ...
Epoch: 12 cost time: 4.8706910610198975
Epoch: 12, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.441 Vali Acc: 0.327 Test Loss: 1.441 Test Acc: 0.327
Validation loss decreased (-0.315575 --> -0.326982).  Saving model ...
Epoch: 13 cost time: 4.912599325180054
Epoch: 13, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.415 Vali Acc: 0.274 Test Loss: 1.415 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.353307008743286
Epoch: 14, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.443 Vali Acc: 0.300 Test Loss: 1.443 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.05208945274353
Epoch: 15, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.382 Vali Acc: 0.373 Test Loss: 1.382 Test Acc: 0.373
Validation loss decreased (-0.326982 --> -0.372610).  Saving model ...
Epoch: 16 cost time: 4.480562925338745
Epoch: 16, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.424 Vali Acc: 0.346 Test Loss: 1.424 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.6656787395477295
Epoch: 17, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.450 Vali Acc: 0.350 Test Loss: 1.450 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.5514140129089355
Epoch: 18, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.714 Vali Acc: 0.308 Test Loss: 1.714 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.866556167602539
Epoch: 19, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.526 Vali Acc: 0.327 Test Loss: 1.526 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.6073992252349854
Epoch: 20, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.478 Vali Acc: 0.357 Test Loss: 1.478 Test Acc: 0.357
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.955833435058594
Epoch: 21, Steps: 17 | Train Loss: 0.899 Vali Loss: 1.505 Vali Acc: 0.346 Test Loss: 1.505 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.434053897857666
Epoch: 22, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.499 Vali Acc: 0.395 Test Loss: 1.499 Test Acc: 0.395
Validation loss decreased (-0.372610 --> -0.395422).  Saving model ...
Epoch: 23 cost time: 4.169216871261597
Epoch: 23, Steps: 17 | Train Loss: 0.795 Vali Loss: 1.837 Vali Acc: 0.346 Test Loss: 1.837 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.139552354812622
Epoch: 24, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.587 Vali Acc: 0.357 Test Loss: 1.587 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.5765249729156494
Epoch: 25, Steps: 17 | Train Loss: 0.756 Vali Loss: 1.682 Vali Acc: 0.369 Test Loss: 1.682 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.522916793823242
Epoch: 26, Steps: 17 | Train Loss: 0.703 Vali Loss: 1.937 Vali Acc: 0.335 Test Loss: 1.937 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.499053955078125
Epoch: 27, Steps: 17 | Train Loss: 0.650 Vali Loss: 1.954 Vali Acc: 0.373 Test Loss: 1.954 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.602601766586304
Epoch: 28, Steps: 17 | Train Loss: 0.653 Vali Loss: 1.812 Vali Acc: 0.388 Test Loss: 1.812 Test Acc: 0.388
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.187772035598755
Epoch: 29, Steps: 17 | Train Loss: 0.631 Vali Loss: 1.763 Vali Acc: 0.369 Test Loss: 1.763 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.417102336883545
Epoch: 30, Steps: 17 | Train Loss: 0.603 Vali Loss: 1.948 Vali Acc: 0.354 Test Loss: 1.948 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.414649724960327
Epoch: 31, Steps: 17 | Train Loss: 0.528 Vali Loss: 1.981 Vali Acc: 0.392 Test Loss: 1.981 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.782064199447632
Epoch: 32, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.779 Vali Acc: 0.380 Test Loss: 1.779 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.39543726235741444
model parameter : 1301312
model size : 6.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.535218954086304
Epoch: 1, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.393 Vali Acc: 0.262 Test Loss: 1.393 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 5.123682022094727
Epoch: 2, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.493 Vali Acc: 0.243 Test Loss: 1.493 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.386834144592285
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.454 Vali Acc: 0.270 Test Loss: 1.454 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 5.116592168807983
Epoch: 4, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.430 Vali Acc: 0.251 Test Loss: 1.430 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.836463212966919
Epoch: 5, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.442 Vali Acc: 0.247 Test Loss: 1.442 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.65826678276062
Epoch: 6, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.546 Vali Acc: 0.262 Test Loss: 1.546 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.995428085327148
Epoch: 7, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.462 Vali Acc: 0.316 Test Loss: 1.462 Test Acc: 0.316
Validation loss decreased (-0.269947 --> -0.315575).  Saving model ...
Epoch: 8 cost time: 5.872567176818848
Epoch: 8, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.435 Vali Acc: 0.304 Test Loss: 1.435 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.370752573013306
Epoch: 9, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.432 Vali Acc: 0.274 Test Loss: 1.432 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.845635175704956
Epoch: 10, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.467 Vali Acc: 0.312 Test Loss: 1.467 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8714756965637207
Epoch: 11, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.481 Vali Acc: 0.335 Test Loss: 1.481 Test Acc: 0.335
Validation loss decreased (-0.315575 --> -0.334586).  Saving model ...
Epoch: 12 cost time: 3.9174578189849854
Epoch: 12, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.553 Vali Acc: 0.308 Test Loss: 1.553 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9068217277526855
Epoch: 13, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.387 Vali Acc: 0.323 Test Loss: 1.387 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.7497782707214355
Epoch: 14, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.356 Vali Acc: 0.384 Test Loss: 1.356 Test Acc: 0.384
Validation loss decreased (-0.334586 --> -0.384017).  Saving model ...
Epoch: 15 cost time: 4.5154993534088135
Epoch: 15, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.554 Vali Acc: 0.327 Test Loss: 1.554 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.639382600784302
Epoch: 16, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.519 Vali Acc: 0.335 Test Loss: 1.519 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.7319746017456055
Epoch: 17, Steps: 17 | Train Loss: 0.968 Vali Loss: 1.393 Vali Acc: 0.392 Test Loss: 1.393 Test Acc: 0.392
Validation loss decreased (-0.384017 --> -0.391621).  Saving model ...
Epoch: 18 cost time: 4.780372619628906
Epoch: 18, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.512 Vali Acc: 0.373 Test Loss: 1.512 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.924384117126465
Epoch: 19, Steps: 17 | Train Loss: 0.835 Vali Loss: 1.469 Vali Acc: 0.399 Test Loss: 1.469 Test Acc: 0.399
Validation loss decreased (-0.391621 --> -0.399225).  Saving model ...
Epoch: 20 cost time: 4.582515716552734
Epoch: 20, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.542 Vali Acc: 0.376 Test Loss: 1.542 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.5401365756988525
Epoch: 21, Steps: 17 | Train Loss: 0.805 Vali Loss: 1.457 Vali Acc: 0.407 Test Loss: 1.457 Test Acc: 0.407
Validation loss decreased (-0.399225 --> -0.406830).  Saving model ...
Epoch: 22 cost time: 3.4730520248413086
Epoch: 22, Steps: 17 | Train Loss: 0.844 Vali Loss: 1.591 Vali Acc: 0.350 Test Loss: 1.591 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.853143930435181
Epoch: 23, Steps: 17 | Train Loss: 0.824 Vali Loss: 1.517 Vali Acc: 0.426 Test Loss: 1.517 Test Acc: 0.426
Validation loss decreased (-0.406830 --> -0.425840).  Saving model ...
Epoch: 24 cost time: 4.572019100189209
Epoch: 24, Steps: 17 | Train Loss: 0.749 Vali Loss: 1.630 Vali Acc: 0.407 Test Loss: 1.630 Test Acc: 0.407
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.365548133850098
Epoch: 25, Steps: 17 | Train Loss: 0.737 Vali Loss: 1.697 Vali Acc: 0.384 Test Loss: 1.697 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.373448133468628
Epoch: 26, Steps: 17 | Train Loss: 0.704 Vali Loss: 1.734 Vali Acc: 0.392 Test Loss: 1.734 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.456363677978516
Epoch: 27, Steps: 17 | Train Loss: 0.633 Vali Loss: 1.799 Vali Acc: 0.369 Test Loss: 1.799 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.257979393005371
Epoch: 28, Steps: 17 | Train Loss: 0.614 Vali Loss: 2.198 Vali Acc: 0.346 Test Loss: 2.198 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.602282524108887
Epoch: 29, Steps: 17 | Train Loss: 0.703 Vali Loss: 1.928 Vali Acc: 0.380 Test Loss: 1.928 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.29864239692688
Epoch: 30, Steps: 17 | Train Loss: 0.599 Vali Loss: 1.808 Vali Acc: 0.418 Test Loss: 1.808 Test Acc: 0.418
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.989312648773193
Epoch: 31, Steps: 17 | Train Loss: 0.535 Vali Loss: 1.805 Vali Acc: 0.365 Test Loss: 1.805 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.8159990310668945
Epoch: 32, Steps: 17 | Train Loss: 0.518 Vali Loss: 1.800 Vali Acc: 0.430 Test Loss: 1.800 Test Acc: 0.430
Validation loss decreased (-0.425840 --> -0.429640).  Saving model ...
Epoch: 33 cost time: 5.196593761444092
Epoch: 33, Steps: 17 | Train Loss: 0.440 Vali Loss: 2.064 Vali Acc: 0.338 Test Loss: 2.064 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.055661678314209
Epoch: 34, Steps: 17 | Train Loss: 0.406 Vali Loss: 2.082 Vali Acc: 0.407 Test Loss: 2.082 Test Acc: 0.407
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.759482383728027
Epoch: 35, Steps: 17 | Train Loss: 0.445 Vali Loss: 2.139 Vali Acc: 0.346 Test Loss: 2.139 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.850446462631226
Epoch: 36, Steps: 17 | Train Loss: 0.292 Vali Loss: 2.168 Vali Acc: 0.414 Test Loss: 2.168 Test Acc: 0.414
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.038826942443848
Epoch: 37, Steps: 17 | Train Loss: 0.317 Vali Loss: 2.219 Vali Acc: 0.422 Test Loss: 2.219 Test Acc: 0.422
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.0135674476623535
Epoch: 38, Steps: 17 | Train Loss: 0.346 Vali Loss: 2.303 Vali Acc: 0.407 Test Loss: 2.303 Test Acc: 0.407
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 4.700253248214722
Epoch: 39, Steps: 17 | Train Loss: 0.354 Vali Loss: 2.260 Vali Acc: 0.365 Test Loss: 2.260 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.945286512374878
Epoch: 40, Steps: 17 | Train Loss: 0.254 Vali Loss: 2.264 Vali Acc: 0.350 Test Loss: 2.264 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.486072063446045
Epoch: 41, Steps: 17 | Train Loss: 0.219 Vali Loss: 2.447 Vali Acc: 0.373 Test Loss: 2.447 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.5465662479400635
Epoch: 42, Steps: 17 | Train Loss: 0.391 Vali Loss: 2.312 Vali Acc: 0.376 Test Loss: 2.312 Test Acc: 0.376
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4296577946768061
model parameter : 1283712
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.35139274597168
Epoch: 1, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.427 Vali Acc: 0.251 Test Loss: 1.427 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 4.339971303939819
Epoch: 2, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.621 Vali Acc: 0.240 Test Loss: 1.621 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8109498023986816
Epoch: 3, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.456 Vali Acc: 0.266 Test Loss: 1.456 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 4.597078561782837
Epoch: 4, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.462 Vali Acc: 0.262 Test Loss: 1.462 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.856577157974243
Epoch: 5, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.503 Vali Acc: 0.259 Test Loss: 1.503 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.328349828720093
Epoch: 6, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.764 Vali Acc: 0.251 Test Loss: 1.764 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.2719948291778564
Epoch: 7, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.657 Vali Acc: 0.262 Test Loss: 1.657 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.326967477798462
Epoch: 8, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.394 Vali Acc: 0.274 Test Loss: 1.394 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273750).  Saving model ...
Epoch: 9 cost time: 3.809980630874634
Epoch: 9, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.397 Vali Acc: 0.278 Test Loss: 1.397 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277553).  Saving model ...
Epoch: 10 cost time: 3.748094320297241
Epoch: 10, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.444 Vali Acc: 0.327 Test Loss: 1.444 Test Acc: 0.327
Validation loss decreased (-0.277553 --> -0.326982).  Saving model ...
Epoch: 11 cost time: 3.813506603240967
Epoch: 11, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.435 Vali Acc: 0.346 Test Loss: 1.435 Test Acc: 0.346
Validation loss decreased (-0.326982 --> -0.345993).  Saving model ...
Epoch: 12 cost time: 3.894152879714966
Epoch: 12, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.603 Vali Acc: 0.274 Test Loss: 1.603 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.195217847824097
Epoch: 13, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.467 Vali Acc: 0.376 Test Loss: 1.467 Test Acc: 0.376
Validation loss decreased (-0.345993 --> -0.376411).  Saving model ...
Epoch: 14 cost time: 4.108612537384033
Epoch: 14, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.392 Vali Acc: 0.388 Test Loss: 1.392 Test Acc: 0.388
Validation loss decreased (-0.376411 --> -0.387819).  Saving model ...
Epoch: 15 cost time: 3.318462371826172
Epoch: 15, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.548 Vali Acc: 0.308 Test Loss: 1.548 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8819420337677
Epoch: 16, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.424 Vali Acc: 0.354 Test Loss: 1.424 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.795215129852295
Epoch: 17, Steps: 17 | Train Loss: 1.058 Vali Loss: 1.527 Vali Acc: 0.365 Test Loss: 1.527 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.339498996734619
Epoch: 18, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.427 Vali Acc: 0.373 Test Loss: 1.427 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.246141672134399
Epoch: 19, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.491 Vali Acc: 0.392 Test Loss: 1.491 Test Acc: 0.392
Validation loss decreased (-0.387819 --> -0.391620).  Saving model ...
Epoch: 20 cost time: 4.182032585144043
Epoch: 20, Steps: 17 | Train Loss: 0.877 Vali Loss: 1.391 Vali Acc: 0.418 Test Loss: 1.391 Test Acc: 0.418
Validation loss decreased (-0.391620 --> -0.418237).  Saving model ...
Epoch: 21 cost time: 4.240670919418335
Epoch: 21, Steps: 17 | Train Loss: 0.811 Vali Loss: 1.763 Vali Acc: 0.361 Test Loss: 1.763 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.564256191253662
Epoch: 22, Steps: 17 | Train Loss: 0.839 Vali Loss: 1.848 Vali Acc: 0.297 Test Loss: 1.848 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.140666484832764
Epoch: 23, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.571 Vali Acc: 0.376 Test Loss: 1.571 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.44197416305542
Epoch: 24, Steps: 17 | Train Loss: 0.769 Vali Loss: 1.594 Vali Acc: 0.357 Test Loss: 1.594 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.416707754135132
Epoch: 25, Steps: 17 | Train Loss: 0.702 Vali Loss: 1.723 Vali Acc: 0.338 Test Loss: 1.723 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.403499364852905
Epoch: 26, Steps: 17 | Train Loss: 0.686 Vali Loss: 1.544 Vali Acc: 0.392 Test Loss: 1.544 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.459068059921265
Epoch: 27, Steps: 17 | Train Loss: 0.575 Vali Loss: 1.592 Vali Acc: 0.430 Test Loss: 1.592 Test Acc: 0.430
Validation loss decreased (-0.418237 --> -0.429642).  Saving model ...
Epoch: 28 cost time: 3.881640911102295
Epoch: 28, Steps: 17 | Train Loss: 0.643 Vali Loss: 1.657 Vali Acc: 0.422 Test Loss: 1.657 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.0205981731414795
Epoch: 29, Steps: 17 | Train Loss: 0.612 Vali Loss: 1.617 Vali Acc: 0.411 Test Loss: 1.617 Test Acc: 0.411
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.6176652908325195
Epoch: 30, Steps: 17 | Train Loss: 0.578 Vali Loss: 1.656 Vali Acc: 0.433 Test Loss: 1.656 Test Acc: 0.433
Validation loss decreased (-0.429642 --> -0.433444).  Saving model ...
Epoch: 31 cost time: 4.276806354522705
Epoch: 31, Steps: 17 | Train Loss: 0.483 Vali Loss: 1.911 Vali Acc: 0.380 Test Loss: 1.911 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.977082252502441
Epoch: 32, Steps: 17 | Train Loss: 0.468 Vali Loss: 1.991 Vali Acc: 0.392 Test Loss: 1.991 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.252144813537598
Epoch: 33, Steps: 17 | Train Loss: 0.452 Vali Loss: 1.850 Vali Acc: 0.414 Test Loss: 1.850 Test Acc: 0.414
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.829080104827881
Epoch: 34, Steps: 17 | Train Loss: 0.422 Vali Loss: 2.020 Vali Acc: 0.392 Test Loss: 2.020 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 4.82908296585083
Epoch: 35, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.932 Vali Acc: 0.384 Test Loss: 1.932 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.084363698959351
Epoch: 36, Steps: 17 | Train Loss: 0.338 Vali Loss: 2.426 Vali Acc: 0.376 Test Loss: 2.426 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 4.540673017501831
Epoch: 37, Steps: 17 | Train Loss: 0.408 Vali Loss: 2.221 Vali Acc: 0.361 Test Loss: 2.221 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 4.561605930328369
Epoch: 38, Steps: 17 | Train Loss: 0.374 Vali Loss: 2.125 Vali Acc: 0.407 Test Loss: 2.125 Test Acc: 0.407
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.7768688201904297
Epoch: 39, Steps: 17 | Train Loss: 0.330 Vali Loss: 2.257 Vali Acc: 0.395 Test Loss: 2.257 Test Acc: 0.395
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 4.527679443359375
Epoch: 40, Steps: 17 | Train Loss: 0.440 Vali Loss: 2.270 Vali Acc: 0.365 Test Loss: 2.270 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.43346007604562736
model parameter : 1266112
model size : 6.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.14435338973999
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.414 Vali Acc: 0.270 Test Loss: 1.414 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 3.3240957260131836
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.434 Vali Acc: 0.232 Test Loss: 1.434 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.4721198081970215
Epoch: 3, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.503 Vali Acc: 0.266 Test Loss: 1.503 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.602459192276001
Epoch: 4, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.390 Vali Acc: 0.247 Test Loss: 1.390 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.2173333168029785
Epoch: 5, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.678 Vali Acc: 0.259 Test Loss: 1.678 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.220576286315918
Epoch: 6, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.578 Vali Acc: 0.240 Test Loss: 1.578 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.462241172790527
Epoch: 7, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.462 Vali Acc: 0.297 Test Loss: 1.462 Test Acc: 0.297
Validation loss decreased (-0.269948 --> -0.296563).  Saving model ...
Epoch: 8 cost time: 4.993788480758667
Epoch: 8, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.525 Vali Acc: 0.255 Test Loss: 1.525 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.419985294342041
Epoch: 9, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.491 Vali Acc: 0.270 Test Loss: 1.491 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.541155815124512
Epoch: 10, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.643 Vali Acc: 0.262 Test Loss: 1.643 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.1009521484375
Epoch: 11, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.445 Vali Acc: 0.266 Test Loss: 1.445 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.688668727874756
Epoch: 12, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.449 Vali Acc: 0.262 Test Loss: 1.449 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.537861108779907
Epoch: 13, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.482 Vali Acc: 0.323 Test Loss: 1.482 Test Acc: 0.323
Validation loss decreased (-0.296563 --> -0.323179).  Saving model ...
Epoch: 14 cost time: 5.008563756942749
Epoch: 14, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.512 Vali Acc: 0.285 Test Loss: 1.512 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.5820698738098145
Epoch: 15, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.510 Vali Acc: 0.312 Test Loss: 1.510 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.34354305267334
Epoch: 16, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.629 Vali Acc: 0.300 Test Loss: 1.629 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.814910173416138
Epoch: 17, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.787 Vali Acc: 0.270 Test Loss: 1.787 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.116850852966309
Epoch: 18, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.466 Vali Acc: 0.392 Test Loss: 1.466 Test Acc: 0.392
Validation loss decreased (-0.323179 --> -0.391620).  Saving model ...
Epoch: 19 cost time: 3.1118505001068115
Epoch: 19, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.497 Vali Acc: 0.384 Test Loss: 1.497 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.5267393589019775
Epoch: 20, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.535 Vali Acc: 0.380 Test Loss: 1.535 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.9985897541046143
Epoch: 21, Steps: 17 | Train Loss: 0.904 Vali Loss: 1.576 Vali Acc: 0.335 Test Loss: 1.576 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.7300124168395996
Epoch: 22, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.528 Vali Acc: 0.384 Test Loss: 1.528 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.445775747299194
Epoch: 23, Steps: 17 | Train Loss: 0.778 Vali Loss: 1.762 Vali Acc: 0.308 Test Loss: 1.762 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.553858518600464
Epoch: 24, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.600 Vali Acc: 0.376 Test Loss: 1.600 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.135462999343872
Epoch: 25, Steps: 17 | Train Loss: 0.786 Vali Loss: 1.648 Vali Acc: 0.354 Test Loss: 1.648 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.525781869888306
Epoch: 26, Steps: 17 | Train Loss: 0.706 Vali Loss: 1.592 Vali Acc: 0.414 Test Loss: 1.592 Test Acc: 0.414
Validation loss decreased (-0.391620 --> -0.414433).  Saving model ...
Epoch: 27 cost time: 4.6350555419921875
Epoch: 27, Steps: 17 | Train Loss: 0.717 Vali Loss: 1.690 Vali Acc: 0.369 Test Loss: 1.690 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.292917728424072
Epoch: 28, Steps: 17 | Train Loss: 0.672 Vali Loss: 1.611 Vali Acc: 0.411 Test Loss: 1.611 Test Acc: 0.411
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.56190824508667
Epoch: 29, Steps: 17 | Train Loss: 0.695 Vali Loss: 1.749 Vali Acc: 0.388 Test Loss: 1.749 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.799726724624634
Epoch: 30, Steps: 17 | Train Loss: 0.589 Vali Loss: 1.653 Vali Acc: 0.411 Test Loss: 1.653 Test Acc: 0.411
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.559272050857544
Epoch: 31, Steps: 17 | Train Loss: 0.578 Vali Loss: 1.879 Vali Acc: 0.369 Test Loss: 1.879 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.747032165527344
Epoch: 32, Steps: 17 | Train Loss: 0.551 Vali Loss: 1.832 Vali Acc: 0.392 Test Loss: 1.832 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.227827787399292
Epoch: 33, Steps: 17 | Train Loss: 0.463 Vali Loss: 1.867 Vali Acc: 0.388 Test Loss: 1.867 Test Acc: 0.388
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.85175633430481
Epoch: 34, Steps: 17 | Train Loss: 0.449 Vali Loss: 1.877 Vali Acc: 0.380 Test Loss: 1.877 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.516930341720581
Epoch: 35, Steps: 17 | Train Loss: 0.428 Vali Loss: 2.025 Vali Acc: 0.354 Test Loss: 2.025 Test Acc: 0.354
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 5.205584526062012
Epoch: 36, Steps: 17 | Train Loss: 0.453 Vali Loss: 1.993 Vali Acc: 0.388 Test Loss: 1.993 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 1021696
model size : 5.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.981275796890259
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.405 Vali Acc: 0.262 Test Loss: 1.405 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 3.7804794311523438
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.397 Vali Acc: 0.266 Test Loss: 1.397 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 4.524264812469482
Epoch: 3, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.449 Vali Acc: 0.270 Test Loss: 1.449 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 4.844806909561157
Epoch: 4, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.460 Vali Acc: 0.285 Test Loss: 1.460 Test Acc: 0.285
Validation loss decreased (-0.269947 --> -0.285157).  Saving model ...
Epoch: 5 cost time: 4.361431121826172
Epoch: 5, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.392 Vali Acc: 0.312 Test Loss: 1.392 Test Acc: 0.312
Validation loss decreased (-0.285157 --> -0.311773).  Saving model ...
Epoch: 6 cost time: 4.89925479888916
Epoch: 6, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.444 Vali Acc: 0.262 Test Loss: 1.444 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.4734766483306885
Epoch: 7, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.395 Vali Acc: 0.293 Test Loss: 1.395 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.057652473449707
Epoch: 8, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.447 Vali Acc: 0.289 Test Loss: 1.447 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.771733522415161
Epoch: 9, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.501 Vali Acc: 0.308 Test Loss: 1.501 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.372288465499878
Epoch: 10, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.450 Vali Acc: 0.251 Test Loss: 1.450 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.683636903762817
Epoch: 11, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.475 Vali Acc: 0.304 Test Loss: 1.475 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.826198577880859
Epoch: 12, Steps: 17 | Train Loss: 1.189 Vali Loss: 1.779 Vali Acc: 0.285 Test Loss: 1.779 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.521008014678955
Epoch: 13, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.430 Vali Acc: 0.331 Test Loss: 1.430 Test Acc: 0.331
Validation loss decreased (-0.311773 --> -0.330784).  Saving model ...
Epoch: 14 cost time: 4.253767251968384
Epoch: 14, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.456 Vali Acc: 0.327 Test Loss: 1.456 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.382850885391235
Epoch: 15, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.472 Vali Acc: 0.331 Test Loss: 1.472 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.01399564743042
Epoch: 16, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.409 Vali Acc: 0.403 Test Loss: 1.409 Test Acc: 0.403
Validation loss decreased (-0.330784 --> -0.403028).  Saving model ...
Epoch: 17 cost time: 4.0483317375183105
Epoch: 17, Steps: 17 | Train Loss: 0.936 Vali Loss: 1.435 Vali Acc: 0.376 Test Loss: 1.435 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.155107021331787
Epoch: 18, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.557 Vali Acc: 0.373 Test Loss: 1.557 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.918431520462036
Epoch: 19, Steps: 17 | Train Loss: 0.887 Vali Loss: 1.388 Vali Acc: 0.430 Test Loss: 1.388 Test Acc: 0.430
Validation loss decreased (-0.403028 --> -0.429644).  Saving model ...
Epoch: 20 cost time: 4.536228656768799
Epoch: 20, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.454 Vali Acc: 0.399 Test Loss: 1.454 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.250920534133911
Epoch: 21, Steps: 17 | Train Loss: 0.870 Vali Loss: 1.489 Vali Acc: 0.414 Test Loss: 1.489 Test Acc: 0.414
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.122648000717163
Epoch: 22, Steps: 17 | Train Loss: 0.812 Vali Loss: 1.528 Vali Acc: 0.392 Test Loss: 1.528 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.642807960510254
Epoch: 23, Steps: 17 | Train Loss: 0.806 Vali Loss: 1.608 Vali Acc: 0.369 Test Loss: 1.608 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.405029296875
Epoch: 24, Steps: 17 | Train Loss: 0.767 Vali Loss: 1.689 Vali Acc: 0.392 Test Loss: 1.689 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.310516119003296
Epoch: 25, Steps: 17 | Train Loss: 0.796 Vali Loss: 1.655 Vali Acc: 0.433 Test Loss: 1.655 Test Acc: 0.433
Validation loss decreased (-0.429644 --> -0.433444).  Saving model ...
Epoch: 26 cost time: 5.46337628364563
Epoch: 26, Steps: 17 | Train Loss: 0.651 Vali Loss: 1.572 Vali Acc: 0.384 Test Loss: 1.572 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.7650370597839355
Epoch: 27, Steps: 17 | Train Loss: 0.730 Vali Loss: 1.672 Vali Acc: 0.433 Test Loss: 1.672 Test Acc: 0.433
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.545494794845581
Epoch: 28, Steps: 17 | Train Loss: 0.608 Vali Loss: 1.703 Vali Acc: 0.403 Test Loss: 1.703 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.840982675552368
Epoch: 29, Steps: 17 | Train Loss: 0.632 Vali Loss: 1.713 Vali Acc: 0.437 Test Loss: 1.713 Test Acc: 0.437
Validation loss decreased (-0.433444 --> -0.437245).  Saving model ...
Epoch: 30 cost time: 4.3290300369262695
Epoch: 30, Steps: 17 | Train Loss: 0.564 Vali Loss: 1.918 Vali Acc: 0.388 Test Loss: 1.918 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.494353771209717
Epoch: 31, Steps: 17 | Train Loss: 0.640 Vali Loss: 1.887 Vali Acc: 0.392 Test Loss: 1.887 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.3881897926330566
Epoch: 32, Steps: 17 | Train Loss: 0.593 Vali Loss: 1.907 Vali Acc: 0.403 Test Loss: 1.907 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.6095619201660156
Epoch: 33, Steps: 17 | Train Loss: 0.474 Vali Loss: 1.787 Vali Acc: 0.403 Test Loss: 1.787 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.8351805210113525
Epoch: 34, Steps: 17 | Train Loss: 0.489 Vali Loss: 1.918 Vali Acc: 0.384 Test Loss: 1.918 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.133178472518921
Epoch: 35, Steps: 17 | Train Loss: 0.476 Vali Loss: 2.125 Vali Acc: 0.350 Test Loss: 2.125 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.688809871673584
Epoch: 36, Steps: 17 | Train Loss: 0.415 Vali Loss: 2.131 Vali Acc: 0.373 Test Loss: 2.131 Test Acc: 0.373
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.809720754623413
Epoch: 37, Steps: 17 | Train Loss: 0.394 Vali Loss: 1.972 Vali Acc: 0.380 Test Loss: 1.972 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.1924684047698975
Epoch: 38, Steps: 17 | Train Loss: 0.425 Vali Loss: 2.523 Vali Acc: 0.365 Test Loss: 2.523 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.34673810005188
Epoch: 39, Steps: 17 | Train Loss: 0.473 Vali Loss: 2.069 Vali Acc: 0.407 Test Loss: 2.069 Test Acc: 0.407
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4372623574144487
model parameter : 1004096
model size : 5.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.1704933643341064
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.484 Vali Acc: 0.259 Test Loss: 1.484 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 5.364642381668091
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.434 Vali Acc: 0.243 Test Loss: 1.434 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.784278154373169
Epoch: 3, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.448 Vali Acc: 0.266 Test Loss: 1.448 Test Acc: 0.266
Validation loss decreased (-0.258540 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 4.297170400619507
Epoch: 4, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.448 Vali Acc: 0.274 Test Loss: 1.448 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273750).  Saving model ...
Epoch: 5 cost time: 5.20270037651062
Epoch: 5, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.440 Vali Acc: 0.266 Test Loss: 1.440 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.602375268936157
Epoch: 6, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.410 Vali Acc: 0.270 Test Loss: 1.410 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.766530990600586
Epoch: 7, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.728 Vali Acc: 0.232 Test Loss: 1.728 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.852161169052124
Epoch: 8, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.439 Vali Acc: 0.232 Test Loss: 1.439 Test Acc: 0.232
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.585057497024536
Epoch: 9, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.478 Vali Acc: 0.274 Test Loss: 1.478 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.182167291641235
Epoch: 10, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.422 Vali Acc: 0.251 Test Loss: 1.422 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.059526443481445
Epoch: 11, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.492 Vali Acc: 0.255 Test Loss: 1.492 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.2351908683776855
Epoch: 12, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.642 Vali Acc: 0.274 Test Loss: 1.642 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 5.287871360778809
Epoch: 13, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.388 Vali Acc: 0.346 Test Loss: 1.388 Test Acc: 0.346
Validation loss decreased (-0.273750 --> -0.345994).  Saving model ...
Epoch: 14 cost time: 4.859310626983643
Epoch: 14, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.537 Vali Acc: 0.304 Test Loss: 1.537 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.027985572814941
Epoch: 15, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.414 Vali Acc: 0.335 Test Loss: 1.414 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6785879135131836
Epoch: 16, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.404 Vali Acc: 0.384 Test Loss: 1.404 Test Acc: 0.384
Validation loss decreased (-0.345994 --> -0.384016).  Saving model ...
Epoch: 17 cost time: 3.547781229019165
Epoch: 17, Steps: 17 | Train Loss: 0.955 Vali Loss: 1.490 Vali Acc: 0.422 Test Loss: 1.490 Test Acc: 0.422
Validation loss decreased (-0.384016 --> -0.422038).  Saving model ...
Epoch: 18 cost time: 3.519218683242798
Epoch: 18, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.414 Vali Acc: 0.399 Test Loss: 1.414 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.948293685913086
Epoch: 19, Steps: 17 | Train Loss: 0.881 Vali Loss: 1.441 Vali Acc: 0.399 Test Loss: 1.441 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.772082567214966
Epoch: 20, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.715 Vali Acc: 0.304 Test Loss: 1.715 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.790315389633179
Epoch: 21, Steps: 17 | Train Loss: 0.893 Vali Loss: 1.541 Vali Acc: 0.373 Test Loss: 1.541 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.265843152999878
Epoch: 22, Steps: 17 | Train Loss: 0.775 Vali Loss: 1.588 Vali Acc: 0.388 Test Loss: 1.588 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.411815404891968
Epoch: 23, Steps: 17 | Train Loss: 0.710 Vali Loss: 1.494 Vali Acc: 0.437 Test Loss: 1.494 Test Acc: 0.437
Validation loss decreased (-0.422038 --> -0.437247).  Saving model ...
Epoch: 24 cost time: 3.968620777130127
Epoch: 24, Steps: 17 | Train Loss: 0.740 Vali Loss: 1.612 Vali Acc: 0.350 Test Loss: 1.612 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.9224565029144287
Epoch: 25, Steps: 17 | Train Loss: 0.700 Vali Loss: 1.634 Vali Acc: 0.433 Test Loss: 1.634 Test Acc: 0.433
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.637248754501343
Epoch: 26, Steps: 17 | Train Loss: 0.767 Vali Loss: 1.578 Vali Acc: 0.392 Test Loss: 1.578 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.363965749740601
Epoch: 27, Steps: 17 | Train Loss: 0.593 Vali Loss: 1.581 Vali Acc: 0.418 Test Loss: 1.581 Test Acc: 0.418
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.596745491027832
Epoch: 28, Steps: 17 | Train Loss: 0.615 Vali Loss: 1.869 Vali Acc: 0.354 Test Loss: 1.869 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.612077713012695
Epoch: 29, Steps: 17 | Train Loss: 0.629 Vali Loss: 1.836 Vali Acc: 0.369 Test Loss: 1.836 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.976833343505859
Epoch: 30, Steps: 17 | Train Loss: 0.492 Vali Loss: 1.665 Vali Acc: 0.411 Test Loss: 1.665 Test Acc: 0.411
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.75814151763916
Epoch: 31, Steps: 17 | Train Loss: 0.458 Vali Loss: 1.937 Vali Acc: 0.361 Test Loss: 1.937 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.7950286865234375
Epoch: 32, Steps: 17 | Train Loss: 0.417 Vali Loss: 1.827 Vali Acc: 0.388 Test Loss: 1.827 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.41770601272583
Epoch: 33, Steps: 17 | Train Loss: 0.419 Vali Loss: 2.021 Vali Acc: 0.426 Test Loss: 2.021 Test Acc: 0.426
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4372623574144487
model parameter : 986496
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.966081619262695
Epoch: 1, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.449 Vali Acc: 0.247 Test Loss: 1.449 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 3.9895758628845215
Epoch: 2, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.594 Vali Acc: 0.251 Test Loss: 1.594 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250935).  Saving model ...
Epoch: 3 cost time: 4.045781135559082
Epoch: 3, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.584 Vali Acc: 0.247 Test Loss: 1.584 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.1770148277282715
Epoch: 4, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.433 Vali Acc: 0.255 Test Loss: 1.433 Test Acc: 0.255
Validation loss decreased (-0.250935 --> -0.254739).  Saving model ...
Epoch: 5 cost time: 3.619335174560547
Epoch: 5, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.400 Vali Acc: 0.274 Test Loss: 1.400 Test Acc: 0.274
Validation loss decreased (-0.254739 --> -0.273750).  Saving model ...
Epoch: 6 cost time: 4.077631711959839
Epoch: 6, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.440 Vali Acc: 0.270 Test Loss: 1.440 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.914360761642456
Epoch: 7, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.388 Vali Acc: 0.297 Test Loss: 1.388 Test Acc: 0.297
Validation loss decreased (-0.273750 --> -0.296564).  Saving model ...
Epoch: 8 cost time: 3.7769105434417725
Epoch: 8, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.583 Vali Acc: 0.285 Test Loss: 1.583 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.273289442062378
Epoch: 9, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.386 Vali Acc: 0.285 Test Loss: 1.386 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.227962017059326
Epoch: 10, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.405 Vali Acc: 0.293 Test Loss: 1.405 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.286287546157837
Epoch: 11, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.636 Vali Acc: 0.274 Test Loss: 1.636 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.484282732009888
Epoch: 12, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.602 Vali Acc: 0.274 Test Loss: 1.602 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.713778495788574
Epoch: 13, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.486 Vali Acc: 0.300 Test Loss: 1.486 Test Acc: 0.300
Validation loss decreased (-0.296564 --> -0.300365).  Saving model ...
Epoch: 14 cost time: 4.630296945571899
Epoch: 14, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.452 Vali Acc: 0.357 Test Loss: 1.452 Test Acc: 0.357
Validation loss decreased (-0.300365 --> -0.357400).  Saving model ...
Epoch: 15 cost time: 4.704138278961182
Epoch: 15, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.394 Vali Acc: 0.380 Test Loss: 1.394 Test Acc: 0.380
Validation loss decreased (-0.357400 --> -0.380214).  Saving model ...
Epoch: 16 cost time: 4.231474161148071
Epoch: 16, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.550 Vali Acc: 0.335 Test Loss: 1.550 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.11236834526062
Epoch: 17, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.511 Vali Acc: 0.319 Test Loss: 1.511 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.026982069015503
Epoch: 18, Steps: 17 | Train Loss: 1.035 Vali Loss: 1.589 Vali Acc: 0.369 Test Loss: 1.589 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.174907922744751
Epoch: 19, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.553 Vali Acc: 0.399 Test Loss: 1.553 Test Acc: 0.399
Validation loss decreased (-0.380214 --> -0.399224).  Saving model ...
Epoch: 20 cost time: 3.99501895904541
Epoch: 20, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.635 Vali Acc: 0.395 Test Loss: 1.635 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.8712852001190186
Epoch: 21, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.513 Vali Acc: 0.380 Test Loss: 1.513 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.066521167755127
Epoch: 22, Steps: 17 | Train Loss: 0.816 Vali Loss: 1.514 Vali Acc: 0.407 Test Loss: 1.514 Test Acc: 0.407
Validation loss decreased (-0.399224 --> -0.406829).  Saving model ...
Epoch: 23 cost time: 3.9006731510162354
Epoch: 23, Steps: 17 | Train Loss: 0.808 Vali Loss: 1.602 Vali Acc: 0.380 Test Loss: 1.602 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.1351158618927
Epoch: 24, Steps: 17 | Train Loss: 0.827 Vali Loss: 1.677 Vali Acc: 0.395 Test Loss: 1.677 Test Acc: 0.395
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.061424255371094
Epoch: 25, Steps: 17 | Train Loss: 0.779 Vali Loss: 1.519 Vali Acc: 0.380 Test Loss: 1.519 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.671145677566528
Epoch: 26, Steps: 17 | Train Loss: 0.660 Vali Loss: 1.656 Vali Acc: 0.403 Test Loss: 1.656 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.7203855514526367
Epoch: 27, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.567 Vali Acc: 0.418 Test Loss: 1.567 Test Acc: 0.418
Validation loss decreased (-0.406829 --> -0.418235).  Saving model ...
Epoch: 28 cost time: 4.068235158920288
Epoch: 28, Steps: 17 | Train Loss: 0.690 Vali Loss: 1.656 Vali Acc: 0.441 Test Loss: 1.656 Test Acc: 0.441
Validation loss decreased (-0.418235 --> -0.441048).  Saving model ...
Epoch: 29 cost time: 4.357746362686157
Epoch: 29, Steps: 17 | Train Loss: 0.614 Vali Loss: 1.696 Vali Acc: 0.395 Test Loss: 1.696 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.501565933227539
Epoch: 30, Steps: 17 | Train Loss: 0.527 Vali Loss: 1.910 Vali Acc: 0.392 Test Loss: 1.910 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.20563530921936
Epoch: 31, Steps: 17 | Train Loss: 0.575 Vali Loss: 1.749 Vali Acc: 0.384 Test Loss: 1.749 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.738651990890503
Epoch: 32, Steps: 17 | Train Loss: 0.536 Vali Loss: 1.842 Vali Acc: 0.426 Test Loss: 1.842 Test Acc: 0.426
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.665668487548828
Epoch: 33, Steps: 17 | Train Loss: 0.514 Vali Loss: 2.206 Vali Acc: 0.361 Test Loss: 2.206 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.299614191055298
Epoch: 34, Steps: 17 | Train Loss: 0.515 Vali Loss: 1.977 Vali Acc: 0.361 Test Loss: 1.977 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.5980448722839355
Epoch: 35, Steps: 17 | Train Loss: 0.512 Vali Loss: 1.926 Vali Acc: 0.380 Test Loss: 1.926 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.3467698097229
Epoch: 36, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.923 Vali Acc: 0.399 Test Loss: 1.923 Test Acc: 0.399
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.270594120025635
Epoch: 37, Steps: 17 | Train Loss: 0.444 Vali Loss: 2.060 Vali Acc: 0.369 Test Loss: 2.060 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.464657545089722
Epoch: 38, Steps: 17 | Train Loss: 0.406 Vali Loss: 2.120 Vali Acc: 0.399 Test Loss: 2.120 Test Acc: 0.399
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.44106463878326996
model parameter : 968896
model size : 5.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.721060276031494
Epoch: 1, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.449 Vali Acc: 0.281 Test Loss: 1.449 Test Acc: 0.281
Validation loss decreased (inf --> -0.281354).  Saving model ...
Epoch: 2 cost time: 5.224536180496216
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.450 Vali Acc: 0.251 Test Loss: 1.450 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.082348346710205
Epoch: 3, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.434 Vali Acc: 0.270 Test Loss: 1.434 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.169972658157349
Epoch: 4, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.429 Vali Acc: 0.270 Test Loss: 1.429 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.791531801223755
Epoch: 5, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.420 Vali Acc: 0.278 Test Loss: 1.420 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.8551785945892334
Epoch: 6, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.503 Vali Acc: 0.240 Test Loss: 1.503 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.355420112609863
Epoch: 7, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.486 Vali Acc: 0.259 Test Loss: 1.486 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.044511795043945
Epoch: 8, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.407 Vali Acc: 0.270 Test Loss: 1.407 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.702434778213501
Epoch: 9, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.461 Vali Acc: 0.270 Test Loss: 1.461 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.628953456878662
Epoch: 10, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.432 Vali Acc: 0.308 Test Loss: 1.432 Test Acc: 0.308
Validation loss decreased (-0.281354 --> -0.307970).  Saving model ...
Epoch: 11 cost time: 5.10745096206665
Epoch: 11, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.689 Vali Acc: 0.262 Test Loss: 1.689 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.6934216022491455
Epoch: 12, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.540 Vali Acc: 0.270 Test Loss: 1.540 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.405481338500977
Epoch: 13, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.438 Vali Acc: 0.274 Test Loss: 1.438 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.157347917556763
Epoch: 14, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.539 Vali Acc: 0.335 Test Loss: 1.539 Test Acc: 0.335
Validation loss decreased (-0.307970 --> -0.334585).  Saving model ...
Epoch: 15 cost time: 4.2015700340271
Epoch: 15, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.581 Vali Acc: 0.300 Test Loss: 1.581 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.523292541503906
Epoch: 16, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.849 Vali Acc: 0.354 Test Loss: 1.849 Test Acc: 0.354
Validation loss decreased (-0.334585 --> -0.353594).  Saving model ...
Epoch: 17 cost time: 4.6871654987335205
Epoch: 17, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.446 Vali Acc: 0.346 Test Loss: 1.446 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.43587851524353
Epoch: 18, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.466 Vali Acc: 0.380 Test Loss: 1.466 Test Acc: 0.380
Validation loss decreased (-0.353594 --> -0.380213).  Saving model ...
Epoch: 19 cost time: 4.181015253067017
Epoch: 19, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.449 Vali Acc: 0.388 Test Loss: 1.449 Test Acc: 0.388
Validation loss decreased (-0.380213 --> -0.387818).  Saving model ...
Epoch: 20 cost time: 3.6106297969818115
Epoch: 20, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.466 Vali Acc: 0.361 Test Loss: 1.466 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9453372955322266
Epoch: 21, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.529 Vali Acc: 0.365 Test Loss: 1.529 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.429079294204712
Epoch: 22, Steps: 17 | Train Loss: 0.842 Vali Loss: 1.552 Vali Acc: 0.388 Test Loss: 1.552 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.906421899795532
Epoch: 23, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.552 Vali Acc: 0.365 Test Loss: 1.552 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.044420003890991
Epoch: 24, Steps: 17 | Train Loss: 0.777 Vali Loss: 1.603 Vali Acc: 0.357 Test Loss: 1.603 Test Acc: 0.357
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.399791717529297
Epoch: 25, Steps: 17 | Train Loss: 0.703 Vali Loss: 1.645 Vali Acc: 0.411 Test Loss: 1.645 Test Acc: 0.411
Validation loss decreased (-0.387818 --> -0.410630).  Saving model ...
Epoch: 26 cost time: 3.9549660682678223
Epoch: 26, Steps: 17 | Train Loss: 0.730 Vali Loss: 1.609 Vali Acc: 0.384 Test Loss: 1.609 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.084872722625732
Epoch: 27, Steps: 17 | Train Loss: 0.686 Vali Loss: 1.578 Vali Acc: 0.384 Test Loss: 1.578 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.6998419761657715
Epoch: 28, Steps: 17 | Train Loss: 0.614 Vali Loss: 1.650 Vali Acc: 0.403 Test Loss: 1.650 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.574506998062134
Epoch: 29, Steps: 17 | Train Loss: 0.574 Vali Loss: 1.700 Vali Acc: 0.384 Test Loss: 1.700 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.133939027786255
Epoch: 30, Steps: 17 | Train Loss: 0.599 Vali Loss: 1.766 Vali Acc: 0.346 Test Loss: 1.766 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.055371522903442
Epoch: 31, Steps: 17 | Train Loss: 0.459 Vali Loss: 1.963 Vali Acc: 0.380 Test Loss: 1.963 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.78886342048645
Epoch: 32, Steps: 17 | Train Loss: 0.538 Vali Loss: 1.781 Vali Acc: 0.350 Test Loss: 1.781 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.832679271697998
Epoch: 33, Steps: 17 | Train Loss: 0.510 Vali Loss: 1.863 Vali Acc: 0.407 Test Loss: 1.863 Test Acc: 0.407
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.214707851409912
Epoch: 34, Steps: 17 | Train Loss: 0.495 Vali Loss: 1.836 Vali Acc: 0.376 Test Loss: 1.836 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.336963653564453
Epoch: 35, Steps: 17 | Train Loss: 0.445 Vali Loss: 2.097 Vali Acc: 0.327 Test Loss: 2.097 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 873088
model size : 4.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.241080284118652
Epoch: 1, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.417 Vali Acc: 0.266 Test Loss: 1.417 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 4.0283143520355225
Epoch: 2, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.423 Vali Acc: 0.255 Test Loss: 1.423 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.182534456253052
Epoch: 3, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.417 Vali Acc: 0.236 Test Loss: 1.417 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.721412181854248
Epoch: 4, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.529 Vali Acc: 0.262 Test Loss: 1.529 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.7460808753967285
Epoch: 5, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.412 Vali Acc: 0.274 Test Loss: 1.412 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273750).  Saving model ...
Epoch: 6 cost time: 4.028164863586426
Epoch: 6, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.416 Vali Acc: 0.323 Test Loss: 1.416 Test Acc: 0.323
Validation loss decreased (-0.273750 --> -0.323180).  Saving model ...
Epoch: 7 cost time: 3.986785650253296
Epoch: 7, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.561 Vali Acc: 0.247 Test Loss: 1.561 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8944287300109863
Epoch: 8, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.468 Vali Acc: 0.240 Test Loss: 1.468 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.206196308135986
Epoch: 9, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.417 Vali Acc: 0.259 Test Loss: 1.417 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.969853162765503
Epoch: 10, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.513 Vali Acc: 0.259 Test Loss: 1.513 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.334031105041504
Epoch: 11, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.562 Vali Acc: 0.262 Test Loss: 1.562 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.860684871673584
Epoch: 12, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.429 Vali Acc: 0.316 Test Loss: 1.429 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.9717133045196533
Epoch: 13, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.458 Vali Acc: 0.304 Test Loss: 1.458 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.204150199890137
Epoch: 14, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.556 Vali Acc: 0.316 Test Loss: 1.556 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.136474847793579
Epoch: 15, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.439 Vali Acc: 0.331 Test Loss: 1.439 Test Acc: 0.331
Validation loss decreased (-0.323180 --> -0.330784).  Saving model ...
Epoch: 16 cost time: 4.573281526565552
Epoch: 16, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.496 Vali Acc: 0.323 Test Loss: 1.496 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.5395591259002686
Epoch: 17, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.488 Vali Acc: 0.373 Test Loss: 1.488 Test Acc: 0.373
Validation loss decreased (-0.330784 --> -0.372609).  Saving model ...
Epoch: 18 cost time: 4.4577648639678955
Epoch: 18, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.452 Vali Acc: 0.395 Test Loss: 1.452 Test Acc: 0.395
Validation loss decreased (-0.372609 --> -0.395423).  Saving model ...
Epoch: 19 cost time: 4.271885395050049
Epoch: 19, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.414 Vali Acc: 0.392 Test Loss: 1.414 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.528223991394043
Epoch: 20, Steps: 17 | Train Loss: 0.871 Vali Loss: 1.548 Vali Acc: 0.369 Test Loss: 1.548 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.734842538833618
Epoch: 21, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.558 Vali Acc: 0.403 Test Loss: 1.558 Test Acc: 0.403
Validation loss decreased (-0.395423 --> -0.403026).  Saving model ...
Epoch: 22 cost time: 4.347432613372803
Epoch: 22, Steps: 17 | Train Loss: 0.830 Vali Loss: 1.486 Vali Acc: 0.369 Test Loss: 1.486 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.699570178985596
Epoch: 23, Steps: 17 | Train Loss: 0.789 Vali Loss: 1.423 Vali Acc: 0.411 Test Loss: 1.423 Test Acc: 0.411
Validation loss decreased (-0.403026 --> -0.410632).  Saving model ...
Epoch: 24 cost time: 4.608841180801392
Epoch: 24, Steps: 17 | Train Loss: 0.779 Vali Loss: 1.557 Vali Acc: 0.399 Test Loss: 1.557 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.151048898696899
Epoch: 25, Steps: 17 | Train Loss: 0.763 Vali Loss: 1.760 Vali Acc: 0.365 Test Loss: 1.760 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.1862804889678955
Epoch: 26, Steps: 17 | Train Loss: 0.676 Vali Loss: 1.823 Vali Acc: 0.388 Test Loss: 1.823 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.018007040023804
Epoch: 27, Steps: 17 | Train Loss: 0.720 Vali Loss: 1.527 Vali Acc: 0.407 Test Loss: 1.527 Test Acc: 0.407
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.292593240737915
Epoch: 28, Steps: 17 | Train Loss: 0.595 Vali Loss: 1.787 Vali Acc: 0.361 Test Loss: 1.787 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.682999134063721
Epoch: 29, Steps: 17 | Train Loss: 0.569 Vali Loss: 2.023 Vali Acc: 0.331 Test Loss: 2.023 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.414817571640015
Epoch: 30, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.726 Vali Acc: 0.369 Test Loss: 1.726 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.252035617828369
Epoch: 31, Steps: 17 | Train Loss: 0.698 Vali Loss: 2.034 Vali Acc: 0.380 Test Loss: 2.034 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.7271728515625
Epoch: 32, Steps: 17 | Train Loss: 0.569 Vali Loss: 1.876 Vali Acc: 0.388 Test Loss: 1.876 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.4302210807800293
Epoch: 33, Steps: 17 | Train Loss: 0.499 Vali Loss: 1.934 Vali Acc: 0.373 Test Loss: 1.934 Test Acc: 0.373
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 855488
model size : 4.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.522707939147949
Epoch: 1, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.432 Vali Acc: 0.247 Test Loss: 1.432 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 4.271126747131348
Epoch: 2, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.401 Vali Acc: 0.262 Test Loss: 1.401 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 3.897268533706665
Epoch: 3, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.542 Vali Acc: 0.259 Test Loss: 1.542 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9285826683044434
Epoch: 4, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.489 Vali Acc: 0.243 Test Loss: 1.489 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.019312381744385
Epoch: 5, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.443 Vali Acc: 0.285 Test Loss: 1.443 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285157).  Saving model ...
Epoch: 6 cost time: 4.223353624343872
Epoch: 6, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.449 Vali Acc: 0.270 Test Loss: 1.449 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.002769947052002
Epoch: 7, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.438 Vali Acc: 0.251 Test Loss: 1.438 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.918593645095825
Epoch: 8, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.435 Vali Acc: 0.312 Test Loss: 1.435 Test Acc: 0.312
Validation loss decreased (-0.285157 --> -0.311773).  Saving model ...
Epoch: 9 cost time: 4.059616804122925
Epoch: 9, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.507 Vali Acc: 0.266 Test Loss: 1.507 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.297010898590088
Epoch: 10, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.423 Vali Acc: 0.300 Test Loss: 1.423 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.299901247024536
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.511 Vali Acc: 0.266 Test Loss: 1.511 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.505505084991455
Epoch: 12, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.539 Vali Acc: 0.300 Test Loss: 1.539 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.719509840011597
Epoch: 13, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.502 Vali Acc: 0.274 Test Loss: 1.502 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.7057015895843506
Epoch: 14, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.525 Vali Acc: 0.289 Test Loss: 1.525 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.515338659286499
Epoch: 15, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.437 Vali Acc: 0.289 Test Loss: 1.437 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.5402708053588867
Epoch: 16, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.476 Vali Acc: 0.350 Test Loss: 1.476 Test Acc: 0.350
Validation loss decreased (-0.311773 --> -0.349795).  Saving model ...
Epoch: 17 cost time: 3.268822193145752
Epoch: 17, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.629 Vali Acc: 0.323 Test Loss: 1.629 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.504541635513306
Epoch: 18, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.378 Vali Acc: 0.361 Test Loss: 1.378 Test Acc: 0.361
Validation loss decreased (-0.349795 --> -0.361203).  Saving model ...
Epoch: 19 cost time: 3.901358127593994
Epoch: 19, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.555 Vali Acc: 0.342 Test Loss: 1.555 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.714400053024292
Epoch: 20, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.725 Vali Acc: 0.308 Test Loss: 1.725 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.607795000076294
Epoch: 21, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.424 Vali Acc: 0.380 Test Loss: 1.424 Test Acc: 0.380
Validation loss decreased (-0.361203 --> -0.380214).  Saving model ...
Epoch: 22 cost time: 4.286518096923828
Epoch: 22, Steps: 17 | Train Loss: 0.779 Vali Loss: 1.494 Vali Acc: 0.373 Test Loss: 1.494 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.412612438201904
Epoch: 23, Steps: 17 | Train Loss: 0.717 Vali Loss: 1.581 Vali Acc: 0.376 Test Loss: 1.581 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.29743218421936
Epoch: 24, Steps: 17 | Train Loss: 0.861 Vali Loss: 1.789 Vali Acc: 0.350 Test Loss: 1.789 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.704227924346924
Epoch: 25, Steps: 17 | Train Loss: 0.778 Vali Loss: 1.553 Vali Acc: 0.411 Test Loss: 1.553 Test Acc: 0.411
Validation loss decreased (-0.380214 --> -0.410631).  Saving model ...
Epoch: 26 cost time: 4.156872510910034
Epoch: 26, Steps: 17 | Train Loss: 0.809 Vali Loss: 1.662 Vali Acc: 0.335 Test Loss: 1.662 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.760709762573242
Epoch: 27, Steps: 17 | Train Loss: 0.759 Vali Loss: 1.751 Vali Acc: 0.392 Test Loss: 1.751 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.916724443435669
Epoch: 28, Steps: 17 | Train Loss: 0.717 Vali Loss: 1.522 Vali Acc: 0.373 Test Loss: 1.522 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.37243390083313
Epoch: 29, Steps: 17 | Train Loss: 0.657 Vali Loss: 1.906 Vali Acc: 0.380 Test Loss: 1.906 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.606036424636841
Epoch: 30, Steps: 17 | Train Loss: 0.659 Vali Loss: 1.717 Vali Acc: 0.373 Test Loss: 1.717 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.929554224014282
Epoch: 31, Steps: 17 | Train Loss: 0.564 Vali Loss: 1.855 Vali Acc: 0.388 Test Loss: 1.855 Test Acc: 0.388
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.975985288619995
Epoch: 32, Steps: 17 | Train Loss: 0.560 Vali Loss: 2.076 Vali Acc: 0.361 Test Loss: 2.076 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.698107004165649
Epoch: 33, Steps: 17 | Train Loss: 0.529 Vali Loss: 2.149 Vali Acc: 0.342 Test Loss: 2.149 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 5.174198150634766
Epoch: 34, Steps: 17 | Train Loss: 0.466 Vali Loss: 1.823 Vali Acc: 0.388 Test Loss: 1.823 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.348578214645386
Epoch: 35, Steps: 17 | Train Loss: 0.466 Vali Loss: 2.053 Vali Acc: 0.357 Test Loss: 2.053 Test Acc: 0.357
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 837888
model size : 4.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.478615045547485
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.453 Vali Acc: 0.247 Test Loss: 1.453 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 4.497328519821167
Epoch: 2, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.407 Vali Acc: 0.247 Test Loss: 1.407 Test Acc: 0.247
Validation loss decreased (-0.247134 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 4.8598473072052
Epoch: 3, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.463 Vali Acc: 0.255 Test Loss: 1.463 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254738).  Saving model ...
Epoch: 4 cost time: 4.132620811462402
Epoch: 4, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.460 Vali Acc: 0.270 Test Loss: 1.460 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269947).  Saving model ...
Epoch: 5 cost time: 4.43133807182312
Epoch: 5, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.475 Vali Acc: 0.255 Test Loss: 1.475 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.324128866195679
Epoch: 6, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.444 Vali Acc: 0.312 Test Loss: 1.444 Test Acc: 0.312
Validation loss decreased (-0.269947 --> -0.311773).  Saving model ...
Epoch: 7 cost time: 4.399107217788696
Epoch: 7, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.519 Vali Acc: 0.232 Test Loss: 1.519 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.996173620223999
Epoch: 8, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.605 Vali Acc: 0.255 Test Loss: 1.605 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.967674970626831
Epoch: 9, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.478 Vali Acc: 0.266 Test Loss: 1.478 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.028609991073608
Epoch: 10, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.645 Vali Acc: 0.293 Test Loss: 1.645 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.6825110912323
Epoch: 11, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.422 Vali Acc: 0.300 Test Loss: 1.422 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.558703899383545
Epoch: 12, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.502 Vali Acc: 0.289 Test Loss: 1.502 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.2808616161346436
Epoch: 13, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.589 Vali Acc: 0.312 Test Loss: 1.589 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.499606370925903
Epoch: 14, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.425 Vali Acc: 0.331 Test Loss: 1.425 Test Acc: 0.331
Validation loss decreased (-0.311773 --> -0.330784).  Saving model ...
Epoch: 15 cost time: 3.3600919246673584
Epoch: 15, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.521 Vali Acc: 0.342 Test Loss: 1.521 Test Acc: 0.342
Validation loss decreased (-0.330784 --> -0.342190).  Saving model ...
Epoch: 16 cost time: 3.8798675537109375
Epoch: 16, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.533 Vali Acc: 0.365 Test Loss: 1.533 Test Acc: 0.365
Validation loss decreased (-0.342190 --> -0.365004).  Saving model ...
Epoch: 17 cost time: 3.184565305709839
Epoch: 17, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.389 Vali Acc: 0.388 Test Loss: 1.389 Test Acc: 0.388
Validation loss decreased (-0.365004 --> -0.387819).  Saving model ...
Epoch: 18 cost time: 2.811117649078369
Epoch: 18, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.424 Vali Acc: 0.361 Test Loss: 1.424 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.203785419464111
Epoch: 19, Steps: 17 | Train Loss: 0.881 Vali Loss: 1.470 Vali Acc: 0.395 Test Loss: 1.470 Test Acc: 0.395
Validation loss decreased (-0.387819 --> -0.395423).  Saving model ...
Epoch: 20 cost time: 3.8054428100585938
Epoch: 20, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.479 Vali Acc: 0.403 Test Loss: 1.479 Test Acc: 0.403
Validation loss decreased (-0.395423 --> -0.403027).  Saving model ...
Epoch: 21 cost time: 3.907311201095581
Epoch: 21, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.520 Vali Acc: 0.392 Test Loss: 1.520 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.676012992858887
Epoch: 22, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.498 Vali Acc: 0.414 Test Loss: 1.498 Test Acc: 0.414
Validation loss decreased (-0.403027 --> -0.414434).  Saving model ...
Epoch: 23 cost time: 5.307960271835327
Epoch: 23, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.521 Vali Acc: 0.357 Test Loss: 1.521 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.711684942245483
Epoch: 24, Steps: 17 | Train Loss: 0.824 Vali Loss: 1.519 Vali Acc: 0.357 Test Loss: 1.519 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.1802709102630615
Epoch: 25, Steps: 17 | Train Loss: 0.661 Vali Loss: 1.683 Vali Acc: 0.399 Test Loss: 1.683 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.335919618606567
Epoch: 26, Steps: 17 | Train Loss: 0.732 Vali Loss: 1.641 Vali Acc: 0.376 Test Loss: 1.641 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.522226572036743
Epoch: 27, Steps: 17 | Train Loss: 0.655 Vali Loss: 1.745 Vali Acc: 0.388 Test Loss: 1.745 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.128034591674805
Epoch: 28, Steps: 17 | Train Loss: 0.688 Vali Loss: 1.659 Vali Acc: 0.403 Test Loss: 1.659 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.267253637313843
Epoch: 29, Steps: 17 | Train Loss: 0.648 Vali Loss: 1.665 Vali Acc: 0.418 Test Loss: 1.665 Test Acc: 0.418
Validation loss decreased (-0.414434 --> -0.418234).  Saving model ...
Epoch: 30 cost time: 4.817090749740601
Epoch: 30, Steps: 17 | Train Loss: 0.645 Vali Loss: 1.644 Vali Acc: 0.422 Test Loss: 1.644 Test Acc: 0.422
Validation loss decreased (-0.418234 --> -0.422037).  Saving model ...
Epoch: 31 cost time: 4.67874002456665
Epoch: 31, Steps: 17 | Train Loss: 0.526 Vali Loss: 1.733 Vali Acc: 0.399 Test Loss: 1.733 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.25557804107666
Epoch: 32, Steps: 17 | Train Loss: 0.529 Vali Loss: 1.892 Vali Acc: 0.426 Test Loss: 1.892 Test Acc: 0.426
Validation loss decreased (-0.422037 --> -0.425837).  Saving model ...
Epoch: 33 cost time: 5.201343774795532
Epoch: 33, Steps: 17 | Train Loss: 0.572 Vali Loss: 1.932 Vali Acc: 0.388 Test Loss: 1.932 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 4.97512412071228
Epoch: 34, Steps: 17 | Train Loss: 0.537 Vali Loss: 1.970 Vali Acc: 0.361 Test Loss: 1.970 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.841505289077759
Epoch: 35, Steps: 17 | Train Loss: 0.672 Vali Loss: 2.020 Vali Acc: 0.354 Test Loss: 2.020 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.870863676071167
Epoch: 36, Steps: 17 | Train Loss: 0.579 Vali Loss: 2.010 Vali Acc: 0.350 Test Loss: 2.010 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 3.648937702178955
Epoch: 37, Steps: 17 | Train Loss: 0.586 Vali Loss: 2.224 Vali Acc: 0.388 Test Loss: 2.224 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.072500705718994
Epoch: 38, Steps: 17 | Train Loss: 0.514 Vali Loss: 1.971 Vali Acc: 0.395 Test Loss: 1.971 Test Acc: 0.395
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.6574902534484863
Epoch: 39, Steps: 17 | Train Loss: 0.375 Vali Loss: 2.067 Vali Acc: 0.399 Test Loss: 2.067 Test Acc: 0.399
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 3.37134051322937
Epoch: 40, Steps: 17 | Train Loss: 0.348 Vali Loss: 2.525 Vali Acc: 0.373 Test Loss: 2.525 Test Acc: 0.373
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.6782689094543457
Epoch: 41, Steps: 17 | Train Loss: 0.321 Vali Loss: 2.241 Vali Acc: 0.403 Test Loss: 2.241 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.767284154891968
Epoch: 42, Steps: 17 | Train Loss: 0.303 Vali Loss: 2.440 Vali Acc: 0.369 Test Loss: 2.440 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.42585551330798477
model parameter : 820288
model size : 4.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.792781829833984
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.399 Vali Acc: 0.278 Test Loss: 1.399 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 3.8655734062194824
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.414 Vali Acc: 0.251 Test Loss: 1.414 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.907062530517578
Epoch: 3, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.428 Vali Acc: 0.255 Test Loss: 1.428 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.184630632400513
Epoch: 4, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.471 Vali Acc: 0.247 Test Loss: 1.471 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.518288850784302
Epoch: 5, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.399 Vali Acc: 0.278 Test Loss: 1.399 Test Acc: 0.278
Validation loss decreased (-0.277553 --> -0.277553).  Saving model ...
Epoch: 6 cost time: 4.162012577056885
Epoch: 6, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.466 Vali Acc: 0.255 Test Loss: 1.466 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.383857488632202
Epoch: 7, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.405 Vali Acc: 0.274 Test Loss: 1.405 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.711108684539795
Epoch: 8, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.415 Vali Acc: 0.270 Test Loss: 1.415 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.371561050415039
Epoch: 9, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.406 Vali Acc: 0.319 Test Loss: 1.406 Test Acc: 0.319
Validation loss decreased (-0.277553 --> -0.319378).  Saving model ...
Epoch: 10 cost time: 4.959845781326294
Epoch: 10, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.417 Vali Acc: 0.323 Test Loss: 1.417 Test Acc: 0.323
Validation loss decreased (-0.319378 --> -0.323180).  Saving model ...
Epoch: 11 cost time: 5.633229970932007
Epoch: 11, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.437 Vali Acc: 0.262 Test Loss: 1.437 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.484738349914551
Epoch: 12, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.442 Vali Acc: 0.278 Test Loss: 1.442 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.175538539886475
Epoch: 13, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.437 Vali Acc: 0.274 Test Loss: 1.437 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.4455156326293945
Epoch: 14, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.449 Vali Acc: 0.297 Test Loss: 1.449 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.0299458503723145
Epoch: 15, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.504 Vali Acc: 0.278 Test Loss: 1.504 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.563071012496948
Epoch: 16, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.440 Vali Acc: 0.319 Test Loss: 1.440 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.949607610702515
Epoch: 17, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.390 Vali Acc: 0.354 Test Loss: 1.390 Test Acc: 0.354
Validation loss decreased (-0.323180 --> -0.353598).  Saving model ...
Epoch: 18 cost time: 4.176783800125122
Epoch: 18, Steps: 17 | Train Loss: 1.096 Vali Loss: 1.399 Vali Acc: 0.342 Test Loss: 1.399 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4353950023651123
Epoch: 19, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.446 Vali Acc: 0.338 Test Loss: 1.446 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.607109546661377
Epoch: 20, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.368 Vali Acc: 0.373 Test Loss: 1.368 Test Acc: 0.373
Validation loss decreased (-0.353598 --> -0.372610).  Saving model ...
Epoch: 21 cost time: 3.501847267150879
Epoch: 21, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.323 Vali Acc: 0.418 Test Loss: 1.323 Test Acc: 0.418
Validation loss decreased (-0.372610 --> -0.418238).  Saving model ...
Epoch: 22 cost time: 3.7927558422088623
Epoch: 22, Steps: 17 | Train Loss: 0.957 Vali Loss: 1.544 Vali Acc: 0.338 Test Loss: 1.544 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9014434814453125
Epoch: 23, Steps: 17 | Train Loss: 0.881 Vali Loss: 1.328 Vali Acc: 0.411 Test Loss: 1.328 Test Acc: 0.411
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.416547536849976
Epoch: 24, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.471 Vali Acc: 0.388 Test Loss: 1.471 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.632636547088623
Epoch: 25, Steps: 17 | Train Loss: 0.889 Vali Loss: 1.557 Vali Acc: 0.335 Test Loss: 1.557 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.220396995544434
Epoch: 26, Steps: 17 | Train Loss: 0.812 Vali Loss: 1.440 Vali Acc: 0.407 Test Loss: 1.440 Test Acc: 0.407
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.363610506057739
Epoch: 27, Steps: 17 | Train Loss: 0.814 Vali Loss: 1.515 Vali Acc: 0.342 Test Loss: 1.515 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.600644588470459
Epoch: 28, Steps: 17 | Train Loss: 0.713 Vali Loss: 1.544 Vali Acc: 0.361 Test Loss: 1.544 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.3057732582092285
Epoch: 29, Steps: 17 | Train Loss: 0.752 Vali Loss: 1.506 Vali Acc: 0.395 Test Loss: 1.506 Test Acc: 0.395
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.4701995849609375
Epoch: 30, Steps: 17 | Train Loss: 0.647 Vali Loss: 1.521 Vali Acc: 0.346 Test Loss: 1.521 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.945355176925659
Epoch: 31, Steps: 17 | Train Loss: 0.660 Vali Loss: 1.666 Vali Acc: 0.361 Test Loss: 1.666 Test Acc: 0.361
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41825095057034223
model parameter : 813856
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.081003665924072
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.445 Vali Acc: 0.228 Test Loss: 1.445 Test Acc: 0.228
Validation loss decreased (inf --> -0.228122).  Saving model ...
Epoch: 2 cost time: 3.890723466873169
Epoch: 2, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.406 Vali Acc: 0.247 Test Loss: 1.406 Test Acc: 0.247
Validation loss decreased (-0.228122 --> -0.247134).  Saving model ...
Epoch: 3 cost time: 4.279198884963989
Epoch: 3, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.395 Vali Acc: 0.281 Test Loss: 1.395 Test Acc: 0.281
Validation loss decreased (-0.247134 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 4.3158118724823
Epoch: 4, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.451 Vali Acc: 0.259 Test Loss: 1.451 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.279071807861328
Epoch: 5, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.469 Vali Acc: 0.236 Test Loss: 1.469 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.465301752090454
Epoch: 6, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.444 Vali Acc: 0.262 Test Loss: 1.444 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.5311315059661865
Epoch: 7, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.461 Vali Acc: 0.259 Test Loss: 1.461 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.890721321105957
Epoch: 8, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.396 Vali Acc: 0.262 Test Loss: 1.396 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.489973306655884
Epoch: 9, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.765763998031616
Epoch: 10, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.445 Vali Acc: 0.259 Test Loss: 1.445 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.657306671142578
Epoch: 11, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.475 Vali Acc: 0.259 Test Loss: 1.475 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.4392778873443604
Epoch: 12, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.427 Vali Acc: 0.293 Test Loss: 1.427 Test Acc: 0.293
Validation loss decreased (-0.281355 --> -0.292761).  Saving model ...
Epoch: 13 cost time: 3.1926591396331787
Epoch: 13, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.430 Vali Acc: 0.338 Test Loss: 1.430 Test Acc: 0.338
Validation loss decreased (-0.292761 --> -0.338389).  Saving model ...
Epoch: 14 cost time: 3.886611223220825
Epoch: 14, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.514 Vali Acc: 0.289 Test Loss: 1.514 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.689378499984741
Epoch: 15, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.343 Vali Acc: 0.392 Test Loss: 1.343 Test Acc: 0.392
Validation loss decreased (-0.338389 --> -0.391622).  Saving model ...
Epoch: 16 cost time: 4.363461017608643
Epoch: 16, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.403 Vali Acc: 0.346 Test Loss: 1.403 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.212936162948608
Epoch: 17, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.382 Vali Acc: 0.369 Test Loss: 1.382 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.1908183097839355
Epoch: 18, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.348 Vali Acc: 0.342 Test Loss: 1.348 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.8931071758270264
Epoch: 19, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.273 Vali Acc: 0.403 Test Loss: 1.273 Test Acc: 0.403
Validation loss decreased (-0.391622 --> -0.403029).  Saving model ...
Epoch: 20 cost time: 4.2828028202056885
Epoch: 20, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.440 Vali Acc: 0.380 Test Loss: 1.440 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.304075717926025
Epoch: 21, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.436 Vali Acc: 0.346 Test Loss: 1.436 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.336970567703247
Epoch: 22, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.331 Vali Acc: 0.414 Test Loss: 1.331 Test Acc: 0.414
Validation loss decreased (-0.403029 --> -0.414435).  Saving model ...
Epoch: 23 cost time: 4.311910390853882
Epoch: 23, Steps: 17 | Train Loss: 0.907 Vali Loss: 1.488 Vali Acc: 0.384 Test Loss: 1.488 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.838301658630371
Epoch: 24, Steps: 17 | Train Loss: 0.835 Vali Loss: 1.495 Vali Acc: 0.373 Test Loss: 1.495 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.015552759170532
Epoch: 25, Steps: 17 | Train Loss: 0.908 Vali Loss: 1.527 Vali Acc: 0.342 Test Loss: 1.527 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.722107172012329
Epoch: 26, Steps: 17 | Train Loss: 0.884 Vali Loss: 1.393 Vali Acc: 0.346 Test Loss: 1.393 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.938026189804077
Epoch: 27, Steps: 17 | Train Loss: 0.770 Vali Loss: 1.488 Vali Acc: 0.380 Test Loss: 1.488 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.0728888511657715
Epoch: 28, Steps: 17 | Train Loss: 0.702 Vali Loss: 1.472 Vali Acc: 0.376 Test Loss: 1.472 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.8710544109344482
Epoch: 29, Steps: 17 | Train Loss: 0.771 Vali Loss: 1.752 Vali Acc: 0.350 Test Loss: 1.752 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.7736265659332275
Epoch: 30, Steps: 17 | Train Loss: 0.752 Vali Loss: 1.703 Vali Acc: 0.308 Test Loss: 1.703 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.0916640758514404
Epoch: 31, Steps: 17 | Train Loss: 0.739 Vali Loss: 1.612 Vali Acc: 0.414 Test Loss: 1.612 Test Acc: 0.414
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.5425820350646973
Epoch: 32, Steps: 17 | Train Loss: 0.704 Vali Loss: 1.868 Vali Acc: 0.342 Test Loss: 1.868 Test Acc: 0.342
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 805056
model size : 3.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.335374593734741
Epoch: 1, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.399 Vali Acc: 0.236 Test Loss: 1.399 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 3.6297545433044434
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.390 Vali Acc: 0.255 Test Loss: 1.390 Test Acc: 0.255
Validation loss decreased (-0.235727 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 4.049895763397217
Epoch: 3, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.450 Vali Acc: 0.270 Test Loss: 1.450 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 3.1537139415740967
Epoch: 4, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.429 Vali Acc: 0.262 Test Loss: 1.429 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.2727439403533936
Epoch: 5, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.401 Vali Acc: 0.262 Test Loss: 1.401 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.21598219871521
Epoch: 6, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.396 Vali Acc: 0.281 Test Loss: 1.396 Test Acc: 0.281
Validation loss decreased (-0.269947 --> -0.281355).  Saving model ...
Epoch: 7 cost time: 4.178950548171997
Epoch: 7, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.525 Vali Acc: 0.270 Test Loss: 1.525 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.126035451889038
Epoch: 8, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.500 Vali Acc: 0.259 Test Loss: 1.500 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.8835198879241943
Epoch: 9, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.471 Vali Acc: 0.266 Test Loss: 1.471 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.418742418289185
Epoch: 10, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.454 Vali Acc: 0.278 Test Loss: 1.454 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.248793125152588
Epoch: 11, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.443 Vali Acc: 0.266 Test Loss: 1.443 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.387620210647583
Epoch: 12, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.407 Vali Acc: 0.262 Test Loss: 1.407 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.721647024154663
Epoch: 13, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.421 Vali Acc: 0.281 Test Loss: 1.421 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.8477747440338135
Epoch: 14, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.412 Vali Acc: 0.312 Test Loss: 1.412 Test Acc: 0.312
Validation loss decreased (-0.281355 --> -0.311773).  Saving model ...
Epoch: 15 cost time: 4.3423779010772705
Epoch: 15, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.433 Vali Acc: 0.293 Test Loss: 1.433 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.344808101654053
Epoch: 16, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.452 Vali Acc: 0.316 Test Loss: 1.452 Test Acc: 0.316
Validation loss decreased (-0.311773 --> -0.315575).  Saving model ...
Epoch: 17 cost time: 4.604416847229004
Epoch: 17, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.479 Vali Acc: 0.338 Test Loss: 1.479 Test Acc: 0.338
Validation loss decreased (-0.315575 --> -0.338388).  Saving model ...
Epoch: 18 cost time: 4.155786514282227
Epoch: 18, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.388 Vali Acc: 0.384 Test Loss: 1.388 Test Acc: 0.384
Validation loss decreased (-0.338388 --> -0.384017).  Saving model ...
Epoch: 19 cost time: 4.051483869552612
Epoch: 19, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.418 Vali Acc: 0.327 Test Loss: 1.418 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.175050973892212
Epoch: 20, Steps: 17 | Train Loss: 0.962 Vali Loss: 1.546 Vali Acc: 0.361 Test Loss: 1.546 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.5710999965667725
Epoch: 21, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.451 Vali Acc: 0.327 Test Loss: 1.451 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.114976644515991
Epoch: 22, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.385 Vali Acc: 0.403 Test Loss: 1.385 Test Acc: 0.403
Validation loss decreased (-0.384017 --> -0.403028).  Saving model ...
Epoch: 23 cost time: 4.352628707885742
Epoch: 23, Steps: 17 | Train Loss: 0.869 Vali Loss: 1.465 Vali Acc: 0.361 Test Loss: 1.465 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.262589931488037
Epoch: 24, Steps: 17 | Train Loss: 0.827 Vali Loss: 1.515 Vali Acc: 0.342 Test Loss: 1.515 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.411684513092041
Epoch: 25, Steps: 17 | Train Loss: 0.794 Vali Loss: 1.470 Vali Acc: 0.380 Test Loss: 1.470 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.4876182079315186
Epoch: 26, Steps: 17 | Train Loss: 0.735 Vali Loss: 1.422 Vali Acc: 0.407 Test Loss: 1.422 Test Acc: 0.407
Validation loss decreased (-0.403028 --> -0.406830).  Saving model ...
Epoch: 27 cost time: 4.212766647338867
Epoch: 27, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.575 Vali Acc: 0.350 Test Loss: 1.575 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.927664041519165
Epoch: 28, Steps: 17 | Train Loss: 0.783 Vali Loss: 1.599 Vali Acc: 0.369 Test Loss: 1.599 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.416390895843506
Epoch: 29, Steps: 17 | Train Loss: 0.733 Vali Loss: 1.618 Vali Acc: 0.304 Test Loss: 1.618 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.784045696258545
Epoch: 30, Steps: 17 | Train Loss: 0.700 Vali Loss: 1.647 Vali Acc: 0.369 Test Loss: 1.647 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.635611534118652
Epoch: 31, Steps: 17 | Train Loss: 0.707 Vali Loss: 1.611 Vali Acc: 0.342 Test Loss: 1.611 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.218588829040527
Epoch: 32, Steps: 17 | Train Loss: 0.614 Vali Loss: 1.597 Vali Acc: 0.357 Test Loss: 1.597 Test Acc: 0.357
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.27007794380188
Epoch: 33, Steps: 17 | Train Loss: 0.570 Vali Loss: 1.750 Vali Acc: 0.357 Test Loss: 1.750 Test Acc: 0.357
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.5668230056762695
Epoch: 34, Steps: 17 | Train Loss: 0.582 Vali Loss: 1.793 Vali Acc: 0.361 Test Loss: 1.793 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.9604172706604004
Epoch: 35, Steps: 17 | Train Loss: 0.550 Vali Loss: 1.736 Vali Acc: 0.361 Test Loss: 1.736 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.180223703384399
Epoch: 36, Steps: 17 | Train Loss: 0.518 Vali Loss: 1.651 Vali Acc: 0.399 Test Loss: 1.651 Test Acc: 0.399
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4068441064638783
model parameter : 796256
model size : 3.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.559910535812378
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.487 Vali Acc: 0.285 Test Loss: 1.487 Test Acc: 0.285
Validation loss decreased (inf --> -0.285156).  Saving model ...
Epoch: 2 cost time: 3.2889063358306885
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.401 Vali Acc: 0.259 Test Loss: 1.401 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.623016834259033
Epoch: 3, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.407 Vali Acc: 0.274 Test Loss: 1.407 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.09910774230957
Epoch: 4, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.430 Vali Acc: 0.278 Test Loss: 1.430 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.51169753074646
Epoch: 5, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.432 Vali Acc: 0.281 Test Loss: 1.432 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.8609464168548584
Epoch: 6, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.467 Vali Acc: 0.270 Test Loss: 1.467 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.903315782546997
Epoch: 7, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.422 Vali Acc: 0.278 Test Loss: 1.422 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.981658697128296
Epoch: 8, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.435 Vali Acc: 0.255 Test Loss: 1.435 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 3.448115587234497
Epoch: 9, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.410 Vali Acc: 0.297 Test Loss: 1.410 Test Acc: 0.297
Validation loss decreased (-0.285156 --> -0.296564).  Saving model ...
Epoch: 10 cost time: 3.769435405731201
Epoch: 10, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.462 Vali Acc: 0.262 Test Loss: 1.462 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5394389629364014
Epoch: 11, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.418 Vali Acc: 0.274 Test Loss: 1.418 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.035698175430298
Epoch: 12, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.440 Vali Acc: 0.274 Test Loss: 1.440 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.278055191040039
Epoch: 13, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.434 Vali Acc: 0.297 Test Loss: 1.434 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.9009900093078613
Epoch: 14, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.628 Vali Acc: 0.335 Test Loss: 1.628 Test Acc: 0.335
Validation loss decreased (-0.296564 --> -0.334584).  Saving model ...
Epoch: 15 cost time: 4.012660264968872
Epoch: 15, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.451 Vali Acc: 0.342 Test Loss: 1.451 Test Acc: 0.342
Validation loss decreased (-0.334584 --> -0.342191).  Saving model ...
Epoch: 16 cost time: 3.624727725982666
Epoch: 16, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.436 Vali Acc: 0.300 Test Loss: 1.436 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6331324577331543
Epoch: 17, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.597 Vali Acc: 0.274 Test Loss: 1.597 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.500685691833496
Epoch: 18, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.464 Vali Acc: 0.285 Test Loss: 1.464 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.175069570541382
Epoch: 19, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.480 Vali Acc: 0.285 Test Loss: 1.480 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.76910400390625
Epoch: 20, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.463 Vali Acc: 0.350 Test Loss: 1.463 Test Acc: 0.350
Validation loss decreased (-0.342191 --> -0.349795).  Saving model ...
Epoch: 21 cost time: 4.108548641204834
Epoch: 21, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.429 Vali Acc: 0.373 Test Loss: 1.429 Test Acc: 0.373
Validation loss decreased (-0.349795 --> -0.372609).  Saving model ...
Epoch: 22 cost time: 3.944758176803589
Epoch: 22, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.434 Vali Acc: 0.357 Test Loss: 1.434 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.185770750045776
Epoch: 23, Steps: 17 | Train Loss: 0.936 Vali Loss: 1.402 Vali Acc: 0.369 Test Loss: 1.402 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.008738279342651
Epoch: 24, Steps: 17 | Train Loss: 0.872 Vali Loss: 1.431 Vali Acc: 0.399 Test Loss: 1.431 Test Acc: 0.399
Validation loss decreased (-0.372609 --> -0.399225).  Saving model ...
Epoch: 25 cost time: 3.3413820266723633
Epoch: 25, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.537 Vali Acc: 0.357 Test Loss: 1.537 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3233790397644043
Epoch: 26, Steps: 17 | Train Loss: 0.873 Vali Loss: 1.787 Vali Acc: 0.308 Test Loss: 1.787 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.636903762817383
Epoch: 27, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.600 Vali Acc: 0.338 Test Loss: 1.600 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.6042866706848145
Epoch: 28, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.520 Vali Acc: 0.335 Test Loss: 1.520 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.399664640426636
Epoch: 29, Steps: 17 | Train Loss: 0.742 Vali Loss: 1.583 Vali Acc: 0.346 Test Loss: 1.583 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.7250351905822754
Epoch: 30, Steps: 17 | Train Loss: 0.799 Vali Loss: 1.593 Vali Acc: 0.319 Test Loss: 1.593 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.6974644660949707
Epoch: 31, Steps: 17 | Train Loss: 0.713 Vali Loss: 1.583 Vali Acc: 0.342 Test Loss: 1.583 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.8330607414245605
Epoch: 32, Steps: 17 | Train Loss: 0.709 Vali Loss: 1.571 Vali Acc: 0.373 Test Loss: 1.571 Test Acc: 0.373
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.005451202392578
Epoch: 33, Steps: 17 | Train Loss: 0.604 Vali Loss: 1.597 Vali Acc: 0.407 Test Loss: 1.597 Test Acc: 0.407
Validation loss decreased (-0.399225 --> -0.406828).  Saving model ...
Epoch: 34 cost time: 3.402975559234619
Epoch: 34, Steps: 17 | Train Loss: 0.655 Vali Loss: 1.607 Vali Acc: 0.403 Test Loss: 1.607 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.247600793838501
Epoch: 35, Steps: 17 | Train Loss: 0.579 Vali Loss: 1.686 Vali Acc: 0.392 Test Loss: 1.686 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.846693754196167
Epoch: 36, Steps: 17 | Train Loss: 0.584 Vali Loss: 1.717 Vali Acc: 0.384 Test Loss: 1.717 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.4142937660217285
Epoch: 37, Steps: 17 | Train Loss: 0.584 Vali Loss: 1.647 Vali Acc: 0.407 Test Loss: 1.647 Test Acc: 0.407
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.812352418899536
Epoch: 38, Steps: 17 | Train Loss: 0.477 Vali Loss: 1.708 Vali Acc: 0.403 Test Loss: 1.708 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.836458921432495
Epoch: 39, Steps: 17 | Train Loss: 0.543 Vali Loss: 1.714 Vali Acc: 0.433 Test Loss: 1.714 Test Acc: 0.433
Validation loss decreased (-0.406828 --> -0.433443).  Saving model ...
Epoch: 40 cost time: 3.3520190715789795
Epoch: 40, Steps: 17 | Train Loss: 0.456 Vali Loss: 1.792 Vali Acc: 0.418 Test Loss: 1.792 Test Acc: 0.418
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 3.588970184326172
Epoch: 41, Steps: 17 | Train Loss: 0.501 Vali Loss: 2.009 Vali Acc: 0.331 Test Loss: 2.009 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 4.121044874191284
Epoch: 42, Steps: 17 | Train Loss: 0.435 Vali Loss: 1.977 Vali Acc: 0.365 Test Loss: 1.977 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 3.643421173095703
Epoch: 43, Steps: 17 | Train Loss: 0.416 Vali Loss: 1.890 Vali Acc: 0.399 Test Loss: 1.890 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 4.056546211242676
Epoch: 44, Steps: 17 | Train Loss: 0.436 Vali Loss: 1.930 Vali Acc: 0.407 Test Loss: 1.930 Test Acc: 0.407
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 3.9303784370422363
Epoch: 45, Steps: 17 | Train Loss: 0.338 Vali Loss: 1.918 Vali Acc: 0.411 Test Loss: 1.918 Test Acc: 0.411
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 3.922368288040161
Epoch: 46, Steps: 17 | Train Loss: 0.332 Vali Loss: 1.898 Vali Acc: 0.354 Test Loss: 1.898 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 3.6034955978393555
Epoch: 47, Steps: 17 | Train Loss: 0.386 Vali Loss: 1.988 Vali Acc: 0.426 Test Loss: 1.988 Test Acc: 0.426
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 3.9458024501800537
Epoch: 48, Steps: 17 | Train Loss: 0.272 Vali Loss: 2.129 Vali Acc: 0.384 Test Loss: 2.129 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 3.9827518463134766
Epoch: 49, Steps: 17 | Train Loss: 0.406 Vali Loss: 2.245 Vali Acc: 0.373 Test Loss: 2.245 Test Acc: 0.373
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.43346007604562736
model parameter : 787456
model size : 3.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.854758024215698
Epoch: 1, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.425 Vali Acc: 0.262 Test Loss: 1.425 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 4.306315660476685
Epoch: 2, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.416 Vali Acc: 0.228 Test Loss: 1.416 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.247257709503174
Epoch: 3, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.404 Vali Acc: 0.221 Test Loss: 1.404 Test Acc: 0.221
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.437756061553955
Epoch: 4, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.418 Vali Acc: 0.270 Test Loss: 1.418 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 5 cost time: 4.0579674243927
Epoch: 5, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.403 Vali Acc: 0.278 Test Loss: 1.403 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277553).  Saving model ...
Epoch: 6 cost time: 3.5036940574645996
Epoch: 6, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.434 Vali Acc: 0.247 Test Loss: 1.434 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9566493034362793
Epoch: 7, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.496 Vali Acc: 0.266 Test Loss: 1.496 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.618957281112671
Epoch: 8, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.423 Vali Acc: 0.228 Test Loss: 1.423 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.780200719833374
Epoch: 9, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.398 Vali Acc: 0.262 Test Loss: 1.398 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.084546804428101
Epoch: 10, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.464 Vali Acc: 0.289 Test Loss: 1.464 Test Acc: 0.289
Validation loss decreased (-0.277553 --> -0.288959).  Saving model ...
Epoch: 11 cost time: 4.980062246322632
Epoch: 11, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.415 Vali Acc: 0.259 Test Loss: 1.415 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.213535785675049
Epoch: 12, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.470 Vali Acc: 0.240 Test Loss: 1.470 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.852001190185547
Epoch: 13, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.533 Vali Acc: 0.236 Test Loss: 1.533 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.486587047576904
Epoch: 14, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.415 Vali Acc: 0.289 Test Loss: 1.415 Test Acc: 0.289
Validation loss decreased (-0.288959 --> -0.288959).  Saving model ...
Epoch: 15 cost time: 4.880337953567505
Epoch: 15, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.494 Vali Acc: 0.281 Test Loss: 1.494 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.993497848510742
Epoch: 16, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.396 Vali Acc: 0.297 Test Loss: 1.396 Test Acc: 0.297
Validation loss decreased (-0.288959 --> -0.296564).  Saving model ...
Epoch: 17 cost time: 4.973824977874756
Epoch: 17, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.418 Vali Acc: 0.338 Test Loss: 1.418 Test Acc: 0.338
Validation loss decreased (-0.296564 --> -0.338389).  Saving model ...
Epoch: 18 cost time: 4.401590824127197
Epoch: 18, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.403 Vali Acc: 0.335 Test Loss: 1.403 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6803290843963623
Epoch: 19, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.547 Vali Acc: 0.281 Test Loss: 1.547 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3975131511688232
Epoch: 20, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.458 Vali Acc: 0.289 Test Loss: 1.458 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.8059825897216797
Epoch: 21, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.526 Vali Acc: 0.319 Test Loss: 1.526 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.5395684242248535
Epoch: 22, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.511 Vali Acc: 0.335 Test Loss: 1.511 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.2987520694732666
Epoch: 23, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.550 Vali Acc: 0.308 Test Loss: 1.550 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.428996562957764
Epoch: 24, Steps: 17 | Train Loss: 0.957 Vali Loss: 1.433 Vali Acc: 0.373 Test Loss: 1.433 Test Acc: 0.373
Validation loss decreased (-0.338389 --> -0.372609).  Saving model ...
Epoch: 25 cost time: 4.381141424179077
Epoch: 25, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.393 Vali Acc: 0.403 Test Loss: 1.393 Test Acc: 0.403
Validation loss decreased (-0.372609 --> -0.403028).  Saving model ...
Epoch: 26 cost time: 4.303508996963501
Epoch: 26, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.486 Vali Acc: 0.346 Test Loss: 1.486 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.0848400592803955
Epoch: 27, Steps: 17 | Train Loss: 0.826 Vali Loss: 1.529 Vali Acc: 0.357 Test Loss: 1.529 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.433298587799072
Epoch: 28, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.630 Vali Acc: 0.342 Test Loss: 1.630 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.8310015201568604
Epoch: 29, Steps: 17 | Train Loss: 0.805 Vali Loss: 1.395 Vali Acc: 0.407 Test Loss: 1.395 Test Acc: 0.407
Validation loss decreased (-0.403028 --> -0.406830).  Saving model ...
Epoch: 30 cost time: 4.189995527267456
Epoch: 30, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.481 Vali Acc: 0.403 Test Loss: 1.481 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.620705604553223
Epoch: 31, Steps: 17 | Train Loss: 0.747 Vali Loss: 1.470 Vali Acc: 0.407 Test Loss: 1.470 Test Acc: 0.407
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.028975009918213
Epoch: 32, Steps: 17 | Train Loss: 0.680 Vali Loss: 1.552 Vali Acc: 0.369 Test Loss: 1.552 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.149298906326294
Epoch: 33, Steps: 17 | Train Loss: 0.682 Vali Loss: 1.559 Vali Acc: 0.399 Test Loss: 1.559 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.430004835128784
Epoch: 34, Steps: 17 | Train Loss: 0.630 Vali Loss: 1.516 Vali Acc: 0.380 Test Loss: 1.516 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.11370849609375
Epoch: 35, Steps: 17 | Train Loss: 0.647 Vali Loss: 1.576 Vali Acc: 0.403 Test Loss: 1.576 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.759758949279785
Epoch: 36, Steps: 17 | Train Loss: 0.650 Vali Loss: 1.539 Vali Acc: 0.422 Test Loss: 1.539 Test Acc: 0.422
Validation loss decreased (-0.406830 --> -0.422038).  Saving model ...
Epoch: 37 cost time: 3.892838954925537
Epoch: 37, Steps: 17 | Train Loss: 0.596 Vali Loss: 1.567 Vali Acc: 0.403 Test Loss: 1.567 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 4.814440488815308
Epoch: 38, Steps: 17 | Train Loss: 0.540 Vali Loss: 1.664 Vali Acc: 0.369 Test Loss: 1.664 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 4.444968223571777
Epoch: 39, Steps: 17 | Train Loss: 0.515 Vali Loss: 1.727 Vali Acc: 0.388 Test Loss: 1.727 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 4.709778070449829
Epoch: 40, Steps: 17 | Train Loss: 0.522 Vali Loss: 1.848 Vali Acc: 0.365 Test Loss: 1.848 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 4.663788080215454
Epoch: 41, Steps: 17 | Train Loss: 0.500 Vali Loss: 1.928 Vali Acc: 0.399 Test Loss: 1.928 Test Acc: 0.399
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.7833340167999268
Epoch: 42, Steps: 17 | Train Loss: 0.482 Vali Loss: 1.790 Vali Acc: 0.380 Test Loss: 1.790 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 4.255607843399048
Epoch: 43, Steps: 17 | Train Loss: 0.399 Vali Loss: 1.835 Vali Acc: 0.327 Test Loss: 1.835 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 4.794144868850708
Epoch: 44, Steps: 17 | Train Loss: 0.483 Vali Loss: 1.772 Vali Acc: 0.430 Test Loss: 1.772 Test Acc: 0.430
Validation loss decreased (-0.422038 --> -0.429640).  Saving model ...
Epoch: 45 cost time: 3.8336901664733887
Epoch: 45, Steps: 17 | Train Loss: 0.397 Vali Loss: 1.814 Vali Acc: 0.392 Test Loss: 1.814 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 4.08235239982605
Epoch: 46, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.840 Vali Acc: 0.414 Test Loss: 1.840 Test Acc: 0.414
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 4.010703086853027
Epoch: 47, Steps: 17 | Train Loss: 0.336 Vali Loss: 1.995 Vali Acc: 0.365 Test Loss: 1.995 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 3.5656580924987793
Epoch: 48, Steps: 17 | Train Loss: 0.349 Vali Loss: 1.932 Vali Acc: 0.407 Test Loss: 1.932 Test Acc: 0.407
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.4876818656921387
Epoch: 49, Steps: 17 | Train Loss: 0.411 Vali Loss: 1.871 Vali Acc: 0.376 Test Loss: 1.871 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 3.7814927101135254
Epoch: 50, Steps: 17 | Train Loss: 0.368 Vali Loss: 2.086 Vali Acc: 0.376 Test Loss: 2.086 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 4.664857864379883
Epoch: 51, Steps: 17 | Train Loss: 0.428 Vali Loss: 2.033 Vali Acc: 0.376 Test Loss: 2.033 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 4.412783622741699
Epoch: 52, Steps: 17 | Train Loss: 0.344 Vali Loss: 2.372 Vali Acc: 0.316 Test Loss: 2.372 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 4.581411361694336
Epoch: 53, Steps: 17 | Train Loss: 0.309 Vali Loss: 2.130 Vali Acc: 0.369 Test Loss: 2.130 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 4.272395133972168
Epoch: 54, Steps: 17 | Train Loss: 0.337 Vali Loss: 2.259 Vali Acc: 0.380 Test Loss: 2.259 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4296577946768061
model parameter : 514336
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.965095281600952
Epoch: 1, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.408 Vali Acc: 0.251 Test Loss: 1.408 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 4.1165242195129395
Epoch: 2, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.418 Vali Acc: 0.247 Test Loss: 1.418 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8136816024780273
Epoch: 3, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.386 Vali Acc: 0.255 Test Loss: 1.386 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254739).  Saving model ...
Epoch: 4 cost time: 4.068566083908081
Epoch: 4, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.479 Vali Acc: 0.259 Test Loss: 1.479 Test Acc: 0.259
Validation loss decreased (-0.254739 --> -0.258540).  Saving model ...
Epoch: 5 cost time: 3.4286446571350098
Epoch: 5, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.427 Vali Acc: 0.285 Test Loss: 1.427 Test Acc: 0.285
Validation loss decreased (-0.258540 --> -0.285157).  Saving model ...
Epoch: 6 cost time: 3.823904275894165
Epoch: 6, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.430 Vali Acc: 0.300 Test Loss: 1.430 Test Acc: 0.300
Validation loss decreased (-0.285157 --> -0.300366).  Saving model ...
Epoch: 7 cost time: 4.064287900924683
Epoch: 7, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.433 Vali Acc: 0.262 Test Loss: 1.433 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8462207317352295
Epoch: 8, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.407 Vali Acc: 0.262 Test Loss: 1.407 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.95920729637146
Epoch: 9, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.477 Vali Acc: 0.266 Test Loss: 1.477 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.460394859313965
Epoch: 10, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.456 Vali Acc: 0.278 Test Loss: 1.456 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.9349586963653564
Epoch: 11, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.553 Vali Acc: 0.255 Test Loss: 1.553 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.71907639503479
Epoch: 12, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.493 Vali Acc: 0.266 Test Loss: 1.493 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.564032554626465
Epoch: 13, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.493 Vali Acc: 0.293 Test Loss: 1.493 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.956853151321411
Epoch: 14, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.462 Vali Acc: 0.262 Test Loss: 1.462 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.7759995460510254
Epoch: 15, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.462 Vali Acc: 0.297 Test Loss: 1.462 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.517700433731079
Epoch: 16, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.516 Vali Acc: 0.274 Test Loss: 1.516 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 505536
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.532719373703003
Epoch: 1, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.452 Vali Acc: 0.255 Test Loss: 1.452 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 4.560903072357178
Epoch: 2, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
Validation loss decreased (-0.254738 --> -0.254739).  Saving model ...
Epoch: 3 cost time: 3.990987777709961
Epoch: 3, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.401 Vali Acc: 0.289 Test Loss: 1.401 Test Acc: 0.289
Validation loss decreased (-0.254739 --> -0.288959).  Saving model ...
Epoch: 4 cost time: 3.8121094703674316
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.405 Vali Acc: 0.281 Test Loss: 1.405 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.190900087356567
Epoch: 5, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.420 Vali Acc: 0.262 Test Loss: 1.420 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.662655353546143
Epoch: 6, Steps: 17 | Train Loss: 1.333 Vali Loss: 1.457 Vali Acc: 0.255 Test Loss: 1.457 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.474989175796509
Epoch: 7, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.426 Vali Acc: 0.262 Test Loss: 1.426 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.724103212356567
Epoch: 8, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.441 Vali Acc: 0.251 Test Loss: 1.441 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.208642244338989
Epoch: 9, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.531 Vali Acc: 0.243 Test Loss: 1.531 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.2137837409973145
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.517 Vali Acc: 0.274 Test Loss: 1.517 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.216789960861206
Epoch: 11, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.405 Vali Acc: 0.304 Test Loss: 1.405 Test Acc: 0.304
Validation loss decreased (-0.288959 --> -0.304168).  Saving model ...
Epoch: 12 cost time: 3.93839955329895
Epoch: 12, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.467 Vali Acc: 0.297 Test Loss: 1.467 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.683264970779419
Epoch: 13, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.427 Vali Acc: 0.319 Test Loss: 1.427 Test Acc: 0.319
Validation loss decreased (-0.304168 --> -0.319377).  Saving model ...
Epoch: 14 cost time: 4.756622076034546
Epoch: 14, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.440 Vali Acc: 0.304 Test Loss: 1.440 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.566961050033569
Epoch: 15, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.430 Vali Acc: 0.308 Test Loss: 1.430 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.556411027908325
Epoch: 16, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.457 Vali Acc: 0.300 Test Loss: 1.457 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.126988887786865
Epoch: 17, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.478 Vali Acc: 0.323 Test Loss: 1.478 Test Acc: 0.323
Validation loss decreased (-0.319377 --> -0.323179).  Saving model ...
Epoch: 18 cost time: 4.354954957962036
Epoch: 18, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.537 Vali Acc: 0.289 Test Loss: 1.537 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.308651447296143
Epoch: 19, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.485 Vali Acc: 0.350 Test Loss: 1.485 Test Acc: 0.350
Validation loss decreased (-0.323179 --> -0.349795).  Saving model ...
Epoch: 20 cost time: 4.139906644821167
Epoch: 20, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.514 Vali Acc: 0.338 Test Loss: 1.514 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.071770429611206
Epoch: 21, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.663 Vali Acc: 0.312 Test Loss: 1.663 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.691418647766113
Epoch: 22, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.609 Vali Acc: 0.304 Test Loss: 1.609 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.458669424057007
Epoch: 23, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.563 Vali Acc: 0.335 Test Loss: 1.563 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.693287134170532
Epoch: 24, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.450 Vali Acc: 0.380 Test Loss: 1.450 Test Acc: 0.380
Validation loss decreased (-0.349795 --> -0.380214).  Saving model ...
Epoch: 25 cost time: 3.83944034576416
Epoch: 25, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.506 Vali Acc: 0.342 Test Loss: 1.506 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.419504165649414
Epoch: 26, Steps: 17 | Train Loss: 0.786 Vali Loss: 1.495 Vali Acc: 0.361 Test Loss: 1.495 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.573613882064819
Epoch: 27, Steps: 17 | Train Loss: 0.794 Vali Loss: 1.404 Vali Acc: 0.395 Test Loss: 1.404 Test Acc: 0.395
Validation loss decreased (-0.380214 --> -0.395423).  Saving model ...
Epoch: 28 cost time: 4.190536975860596
Epoch: 28, Steps: 17 | Train Loss: 0.718 Vali Loss: 1.485 Vali Acc: 0.411 Test Loss: 1.485 Test Acc: 0.411
Validation loss decreased (-0.395423 --> -0.410632).  Saving model ...
Epoch: 29 cost time: 4.6649699211120605
Epoch: 29, Steps: 17 | Train Loss: 0.706 Vali Loss: 1.421 Vali Acc: 0.437 Test Loss: 1.421 Test Acc: 0.437
Validation loss decreased (-0.410632 --> -0.437248).  Saving model ...
Epoch: 30 cost time: 4.629519939422607
Epoch: 30, Steps: 17 | Train Loss: 0.658 Vali Loss: 1.497 Vali Acc: 0.392 Test Loss: 1.497 Test Acc: 0.392
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.7615292072296143
Epoch: 31, Steps: 17 | Train Loss: 0.644 Vali Loss: 1.554 Vali Acc: 0.380 Test Loss: 1.554 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.324283838272095
Epoch: 32, Steps: 17 | Train Loss: 0.665 Vali Loss: 1.611 Vali Acc: 0.380 Test Loss: 1.611 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.0730814933776855
Epoch: 33, Steps: 17 | Train Loss: 0.623 Vali Loss: 1.626 Vali Acc: 0.433 Test Loss: 1.626 Test Acc: 0.433
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.286086797714233
Epoch: 34, Steps: 17 | Train Loss: 0.637 Vali Loss: 1.664 Vali Acc: 0.338 Test Loss: 1.664 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.5042407512664795
Epoch: 35, Steps: 17 | Train Loss: 0.639 Vali Loss: 1.698 Vali Acc: 0.361 Test Loss: 1.698 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 4.51063871383667
Epoch: 36, Steps: 17 | Train Loss: 0.529 Vali Loss: 1.666 Vali Acc: 0.380 Test Loss: 1.666 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 4.362194061279297
Epoch: 37, Steps: 17 | Train Loss: 0.547 Vali Loss: 1.943 Vali Acc: 0.297 Test Loss: 1.943 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.734179258346558
Epoch: 38, Steps: 17 | Train Loss: 0.578 Vali Loss: 1.760 Vali Acc: 0.346 Test Loss: 1.760 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.120896339416504
Epoch: 39, Steps: 17 | Train Loss: 0.526 Vali Loss: 1.719 Vali Acc: 0.388 Test Loss: 1.719 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4372623574144487
model parameter : 496736
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.20932674407959
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.393 Vali Acc: 0.262 Test Loss: 1.393 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 4.0954248905181885
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.415 Vali Acc: 0.243 Test Loss: 1.415 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.782463312149048
Epoch: 3, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.394 Vali Acc: 0.289 Test Loss: 1.394 Test Acc: 0.289
Validation loss decreased (-0.262343 --> -0.288959).  Saving model ...
Epoch: 4 cost time: 3.1625540256500244
Epoch: 4, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.383 Vali Acc: 0.304 Test Loss: 1.383 Test Acc: 0.304
Validation loss decreased (-0.288959 --> -0.304169).  Saving model ...
Epoch: 5 cost time: 3.3033671379089355
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.402 Vali Acc: 0.266 Test Loss: 1.402 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8332571983337402
Epoch: 6, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.431 Vali Acc: 0.278 Test Loss: 1.431 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7109200954437256
Epoch: 7, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.409 Vali Acc: 0.274 Test Loss: 1.409 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.641582489013672
Epoch: 8, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.448 Vali Acc: 0.297 Test Loss: 1.448 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.4039270877838135
Epoch: 9, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.449 Vali Acc: 0.293 Test Loss: 1.449 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.644070625305176
Epoch: 10, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.397 Vali Acc: 0.274 Test Loss: 1.397 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.6269352436065674
Epoch: 11, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.359 Vali Acc: 0.316 Test Loss: 1.359 Test Acc: 0.316
Validation loss decreased (-0.304169 --> -0.315576).  Saving model ...
Epoch: 12 cost time: 3.5874392986297607
Epoch: 12, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.394 Vali Acc: 0.327 Test Loss: 1.394 Test Acc: 0.327
Validation loss decreased (-0.315576 --> -0.326982).  Saving model ...
Epoch: 13 cost time: 3.238030433654785
Epoch: 13, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.373 Vali Acc: 0.335 Test Loss: 1.373 Test Acc: 0.335
Validation loss decreased (-0.326982 --> -0.334587).  Saving model ...
Epoch: 14 cost time: 3.2728519439697266
Epoch: 14, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.352 Vali Acc: 0.316 Test Loss: 1.352 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0087530612945557
Epoch: 15, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.335 Vali Acc: 0.392 Test Loss: 1.335 Test Acc: 0.392
Validation loss decreased (-0.334587 --> -0.391622).  Saving model ...
Epoch: 16 cost time: 3.3704774379730225
Epoch: 16, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.363 Vali Acc: 0.376 Test Loss: 1.363 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.883983850479126
Epoch: 17, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.293 Vali Acc: 0.433 Test Loss: 1.293 Test Acc: 0.433
Validation loss decreased (-0.391622 --> -0.433447).  Saving model ...
Epoch: 18 cost time: 3.4726974964141846
Epoch: 18, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.289 Vali Acc: 0.414 Test Loss: 1.289 Test Acc: 0.414
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.402390480041504
Epoch: 19, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.337 Vali Acc: 0.399 Test Loss: 1.337 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9750072956085205
Epoch: 20, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.271 Vali Acc: 0.433 Test Loss: 1.271 Test Acc: 0.433
Validation loss decreased (-0.433447 --> -0.433447).  Saving model ...
Epoch: 21 cost time: 3.5991427898406982
Epoch: 21, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.330 Vali Acc: 0.395 Test Loss: 1.330 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.605116128921509
Epoch: 22, Steps: 17 | Train Loss: 0.913 Vali Loss: 1.472 Vali Acc: 0.403 Test Loss: 1.472 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.6362481117248535
Epoch: 23, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.422 Vali Acc: 0.403 Test Loss: 1.422 Test Acc: 0.403
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.173497915267944
Epoch: 24, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.349 Vali Acc: 0.430 Test Loss: 1.349 Test Acc: 0.430
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.650233507156372
Epoch: 25, Steps: 17 | Train Loss: 0.842 Vali Loss: 1.551 Vali Acc: 0.369 Test Loss: 1.551 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.2555623054504395
Epoch: 26, Steps: 17 | Train Loss: 0.835 Vali Loss: 1.472 Vali Acc: 0.365 Test Loss: 1.472 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.3156256675720215
Epoch: 27, Steps: 17 | Train Loss: 0.758 Vali Loss: 1.553 Vali Acc: 0.380 Test Loss: 1.553 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.8569211959838867
Epoch: 28, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.667 Vali Acc: 0.361 Test Loss: 1.667 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.630427122116089
Epoch: 29, Steps: 17 | Train Loss: 0.747 Vali Loss: 1.536 Vali Acc: 0.403 Test Loss: 1.536 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.1711859703063965
Epoch: 30, Steps: 17 | Train Loss: 0.670 Vali Loss: 1.619 Vali Acc: 0.388 Test Loss: 1.619 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.43346007604562736
model parameter : 487936
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.755034685134888
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.422 Vali Acc: 0.270 Test Loss: 1.422 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 4.244459629058838
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.399 Vali Acc: 0.240 Test Loss: 1.399 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.086653470993042
Epoch: 3, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.389 Vali Acc: 0.285 Test Loss: 1.389 Test Acc: 0.285
Validation loss decreased (-0.269948 --> -0.285157).  Saving model ...
Epoch: 4 cost time: 3.5471789836883545
Epoch: 4, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.405 Vali Acc: 0.266 Test Loss: 1.405 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.617007255554199
Epoch: 5, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.410 Vali Acc: 0.266 Test Loss: 1.410 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.021701335906982
Epoch: 6, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.417 Vali Acc: 0.259 Test Loss: 1.417 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.9567651748657227
Epoch: 7, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.433 Vali Acc: 0.259 Test Loss: 1.433 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.192680597305298
Epoch: 8, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.396 Vali Acc: 0.259 Test Loss: 1.396 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.430014610290527
Epoch: 9, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.405 Vali Acc: 0.300 Test Loss: 1.405 Test Acc: 0.300
Validation loss decreased (-0.285157 --> -0.300366).  Saving model ...
Epoch: 10 cost time: 4.1284425258636475
Epoch: 10, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.424 Vali Acc: 0.316 Test Loss: 1.424 Test Acc: 0.316
Validation loss decreased (-0.300366 --> -0.315575).  Saving model ...
Epoch: 11 cost time: 4.620094299316406
Epoch: 11, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.405 Vali Acc: 0.247 Test Loss: 1.405 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.515134811401367
Epoch: 12, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.432 Vali Acc: 0.323 Test Loss: 1.432 Test Acc: 0.323
Validation loss decreased (-0.315575 --> -0.323180).  Saving model ...
Epoch: 13 cost time: 4.604288101196289
Epoch: 13, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.400 Vali Acc: 0.278 Test Loss: 1.400 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.179011821746826
Epoch: 14, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.486 Vali Acc: 0.270 Test Loss: 1.486 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.318861484527588
Epoch: 15, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.471 Vali Acc: 0.285 Test Loss: 1.471 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.5916197299957275
Epoch: 16, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.398 Vali Acc: 0.312 Test Loss: 1.398 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.938093662261963
Epoch: 17, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.607 Vali Acc: 0.266 Test Loss: 1.607 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.649540901184082
Epoch: 18, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.388 Vali Acc: 0.300 Test Loss: 1.388 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.8040664196014404
Epoch: 19, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.374 Vali Acc: 0.335 Test Loss: 1.374 Test Acc: 0.335
Validation loss decreased (-0.323180 --> -0.334587).  Saving model ...
Epoch: 20 cost time: 4.615380048751831
Epoch: 20, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.423 Vali Acc: 0.335 Test Loss: 1.423 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.233961343765259
Epoch: 21, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.357 Vali Acc: 0.361 Test Loss: 1.357 Test Acc: 0.361
Validation loss decreased (-0.334587 --> -0.361203).  Saving model ...
Epoch: 22 cost time: 4.620176076889038
Epoch: 22, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.395 Vali Acc: 0.354 Test Loss: 1.395 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.64747428894043
Epoch: 23, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.404 Vali Acc: 0.373 Test Loss: 1.404 Test Acc: 0.373
Validation loss decreased (-0.361203 --> -0.372610).  Saving model ...
Epoch: 24 cost time: 4.111072778701782
Epoch: 24, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.364 Vali Acc: 0.414 Test Loss: 1.364 Test Acc: 0.414
Validation loss decreased (-0.372610 --> -0.414435).  Saving model ...
Epoch: 25 cost time: 4.473721027374268
Epoch: 25, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.426 Vali Acc: 0.395 Test Loss: 1.426 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.327269792556763
Epoch: 26, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.500 Vali Acc: 0.335 Test Loss: 1.500 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.780524730682373
Epoch: 27, Steps: 17 | Train Loss: 0.839 Vali Loss: 1.458 Vali Acc: 0.384 Test Loss: 1.458 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.552283525466919
Epoch: 28, Steps: 17 | Train Loss: 0.891 Vali Loss: 1.416 Vali Acc: 0.403 Test Loss: 1.416 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.263105869293213
Epoch: 29, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.433 Vali Acc: 0.376 Test Loss: 1.433 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.614543914794922
Epoch: 30, Steps: 17 | Train Loss: 0.815 Vali Loss: 1.659 Vali Acc: 0.369 Test Loss: 1.659 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.791015148162842
Epoch: 31, Steps: 17 | Train Loss: 0.841 Vali Loss: 1.445 Vali Acc: 0.395 Test Loss: 1.445 Test Acc: 0.395
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.160168409347534
Epoch: 32, Steps: 17 | Train Loss: 0.756 Vali Loss: 1.575 Vali Acc: 0.357 Test Loss: 1.575 Test Acc: 0.357
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.273708343505859
Epoch: 33, Steps: 17 | Train Loss: 0.737 Vali Loss: 1.503 Vali Acc: 0.373 Test Loss: 1.503 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.538836479187012
Epoch: 34, Steps: 17 | Train Loss: 0.704 Vali Loss: 1.473 Vali Acc: 0.388 Test Loss: 1.473 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 364576
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.056235313415527
Epoch: 1, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.424 Vali Acc: 0.236 Test Loss: 1.424 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 3.578666925430298
Epoch: 2, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.401 Vali Acc: 0.236 Test Loss: 1.401 Test Acc: 0.236
Validation loss decreased (-0.235727 --> -0.235727).  Saving model ...
Epoch: 3 cost time: 3.5789737701416016
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.402 Vali Acc: 0.293 Test Loss: 1.402 Test Acc: 0.293
Validation loss decreased (-0.235727 --> -0.292762).  Saving model ...
Epoch: 4 cost time: 3.6071460247039795
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.424 Vali Acc: 0.228 Test Loss: 1.424 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.483797311782837
Epoch: 5, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.394 Vali Acc: 0.247 Test Loss: 1.394 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.582941293716431
Epoch: 6, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.387 Vali Acc: 0.289 Test Loss: 1.387 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.5241663455963135
Epoch: 7, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.394 Vali Acc: 0.262 Test Loss: 1.394 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.602273225784302
Epoch: 8, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.411 Vali Acc: 0.266 Test Loss: 1.411 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.638530731201172
Epoch: 9, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.400 Vali Acc: 0.278 Test Loss: 1.400 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.793438673019409
Epoch: 10, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.476 Vali Acc: 0.281 Test Loss: 1.476 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.310379981994629
Epoch: 11, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.446 Vali Acc: 0.270 Test Loss: 1.446 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.5716512203216553
Epoch: 12, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.465 Vali Acc: 0.266 Test Loss: 1.465 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.021321773529053
Epoch: 13, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.452 Vali Acc: 0.251 Test Loss: 1.452 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 355776
model size : 2.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.9880290031433105
Epoch: 1, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.409 Vali Acc: 0.262 Test Loss: 1.409 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 4.565494775772095
Epoch: 2, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.425 Vali Acc: 0.247 Test Loss: 1.425 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.336000919342041
Epoch: 3, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.401 Vali Acc: 0.278 Test Loss: 1.401 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277553).  Saving model ...
Epoch: 4 cost time: 4.6621832847595215
Epoch: 4, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.392 Vali Acc: 0.297 Test Loss: 1.392 Test Acc: 0.297
Validation loss decreased (-0.277553 --> -0.296564).  Saving model ...
Epoch: 5 cost time: 4.629730939865112
Epoch: 5, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.397 Vali Acc: 0.281 Test Loss: 1.397 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.539995193481445
Epoch: 6, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.417 Vali Acc: 0.281 Test Loss: 1.417 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.339272499084473
Epoch: 7, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.458 Vali Acc: 0.259 Test Loss: 1.458 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.717294216156006
Epoch: 8, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.435 Vali Acc: 0.312 Test Loss: 1.435 Test Acc: 0.312
Validation loss decreased (-0.296564 --> -0.311773).  Saving model ...
Epoch: 9 cost time: 3.6807477474212646
Epoch: 9, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.392 Vali Acc: 0.312 Test Loss: 1.392 Test Acc: 0.312
Validation loss decreased (-0.311773 --> -0.311773).  Saving model ...
Epoch: 10 cost time: 3.9005632400512695
Epoch: 10, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.396 Vali Acc: 0.308 Test Loss: 1.396 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.992271661758423
Epoch: 11, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.470 Vali Acc: 0.274 Test Loss: 1.470 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.3011181354522705
Epoch: 12, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.458 Vali Acc: 0.293 Test Loss: 1.458 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.61072850227356
Epoch: 13, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.438 Vali Acc: 0.278 Test Loss: 1.438 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.207382440567017
Epoch: 14, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.482 Vali Acc: 0.297 Test Loss: 1.482 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.4940526485443115
Epoch: 15, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.400 Vali Acc: 0.323 Test Loss: 1.400 Test Acc: 0.323
Validation loss decreased (-0.311773 --> -0.323180).  Saving model ...
Epoch: 16 cost time: 3.803161859512329
Epoch: 16, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.432 Vali Acc: 0.346 Test Loss: 1.432 Test Acc: 0.346
Validation loss decreased (-0.323180 --> -0.345993).  Saving model ...
Epoch: 17 cost time: 4.487739086151123
Epoch: 17, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.506 Vali Acc: 0.369 Test Loss: 1.506 Test Acc: 0.369
Validation loss decreased (-0.345993 --> -0.368806).  Saving model ...
Epoch: 18 cost time: 4.5401411056518555
Epoch: 18, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.409 Vali Acc: 0.354 Test Loss: 1.409 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.280164957046509
Epoch: 19, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.394 Vali Acc: 0.342 Test Loss: 1.394 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.611409902572632
Epoch: 20, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.513 Vali Acc: 0.376 Test Loss: 1.513 Test Acc: 0.376
Validation loss decreased (-0.368806 --> -0.376411).  Saving model ...
Epoch: 21 cost time: 4.392770051956177
Epoch: 21, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.393 Vali Acc: 0.350 Test Loss: 1.393 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.091152667999268
Epoch: 22, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.449 Vali Acc: 0.350 Test Loss: 1.449 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.0933918952941895
Epoch: 23, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.333 Vali Acc: 0.411 Test Loss: 1.333 Test Acc: 0.411
Validation loss decreased (-0.376411 --> -0.410633).  Saving model ...
Epoch: 24 cost time: 3.9504308700561523
Epoch: 24, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.377 Vali Acc: 0.414 Test Loss: 1.377 Test Acc: 0.414
Validation loss decreased (-0.410633 --> -0.414435).  Saving model ...
Epoch: 25 cost time: 3.745203971862793
Epoch: 25, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.396 Vali Acc: 0.373 Test Loss: 1.396 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3056108951568604
Epoch: 26, Steps: 17 | Train Loss: 0.824 Vali Loss: 1.369 Vali Acc: 0.407 Test Loss: 1.369 Test Acc: 0.407
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.9843032360076904
Epoch: 27, Steps: 17 | Train Loss: 0.753 Vali Loss: 1.373 Vali Acc: 0.414 Test Loss: 1.373 Test Acc: 0.414
Validation loss decreased (-0.414435 --> -0.414435).  Saving model ...
Epoch: 28 cost time: 3.7404632568359375
Epoch: 28, Steps: 17 | Train Loss: 0.795 Vali Loss: 1.522 Vali Acc: 0.346 Test Loss: 1.522 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.191559314727783
Epoch: 29, Steps: 17 | Train Loss: 0.791 Vali Loss: 1.540 Vali Acc: 0.369 Test Loss: 1.540 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.9809346199035645
Epoch: 30, Steps: 17 | Train Loss: 0.727 Vali Loss: 1.395 Vali Acc: 0.392 Test Loss: 1.395 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.6711254119873047
Epoch: 31, Steps: 17 | Train Loss: 0.722 Vali Loss: 1.453 Vali Acc: 0.414 Test Loss: 1.453 Test Acc: 0.414
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.436034917831421
Epoch: 32, Steps: 17 | Train Loss: 0.683 Vali Loss: 1.545 Vali Acc: 0.407 Test Loss: 1.545 Test Acc: 0.407
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.456791639328003
Epoch: 33, Steps: 17 | Train Loss: 0.632 Vali Loss: 1.754 Vali Acc: 0.384 Test Loss: 1.754 Test Acc: 0.384
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.022032737731934
Epoch: 34, Steps: 17 | Train Loss: 0.595 Vali Loss: 1.536 Vali Acc: 0.376 Test Loss: 1.536 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.8368210792541504
Epoch: 35, Steps: 17 | Train Loss: 0.585 Vali Loss: 1.537 Vali Acc: 0.422 Test Loss: 1.537 Test Acc: 0.422
Validation loss decreased (-0.414435 --> -0.422038).  Saving model ...
Epoch: 36 cost time: 4.044934511184692
Epoch: 36, Steps: 17 | Train Loss: 0.635 Vali Loss: 1.535 Vali Acc: 0.369 Test Loss: 1.535 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.820152521133423
Epoch: 37, Steps: 17 | Train Loss: 0.573 Vali Loss: 1.646 Vali Acc: 0.403 Test Loss: 1.646 Test Acc: 0.403
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 4.313999891281128
Epoch: 38, Steps: 17 | Train Loss: 0.539 Vali Loss: 1.553 Vali Acc: 0.422 Test Loss: 1.553 Test Acc: 0.422
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.46588921546936
Epoch: 39, Steps: 17 | Train Loss: 0.576 Vali Loss: 1.555 Vali Acc: 0.392 Test Loss: 1.555 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.664289951324463
Epoch: 40, Steps: 17 | Train Loss: 0.520 Vali Loss: 1.658 Vali Acc: 0.395 Test Loss: 1.658 Test Acc: 0.395
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.225591659545898
Epoch: 41, Steps: 17 | Train Loss: 0.461 Vali Loss: 1.645 Vali Acc: 0.437 Test Loss: 1.645 Test Acc: 0.437
Validation loss decreased (-0.422038 --> -0.437246).  Saving model ...
Epoch: 42 cost time: 3.8511061668395996
Epoch: 42, Steps: 17 | Train Loss: 0.487 Vali Loss: 1.724 Vali Acc: 0.433 Test Loss: 1.724 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.951709270477295
Epoch: 43, Steps: 17 | Train Loss: 0.422 Vali Loss: 1.797 Vali Acc: 0.399 Test Loss: 1.797 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 4.372588634490967
Epoch: 44, Steps: 17 | Train Loss: 0.384 Vali Loss: 1.885 Vali Acc: 0.411 Test Loss: 1.885 Test Acc: 0.411
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.584871292114258
Epoch: 45, Steps: 17 | Train Loss: 0.351 Vali Loss: 1.840 Vali Acc: 0.411 Test Loss: 1.840 Test Acc: 0.411
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.9750401973724365
Epoch: 46, Steps: 17 | Train Loss: 0.381 Vali Loss: 2.171 Vali Acc: 0.350 Test Loss: 2.171 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 4.28622031211853
Epoch: 47, Steps: 17 | Train Loss: 0.450 Vali Loss: 2.112 Vali Acc: 0.346 Test Loss: 2.112 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.4828052520751953
Epoch: 48, Steps: 17 | Train Loss: 0.328 Vali Loss: 1.831 Vali Acc: 0.441 Test Loss: 1.831 Test Acc: 0.441
Validation loss decreased (-0.437246 --> -0.441046).  Saving model ...
Epoch: 49 cost time: 3.9447667598724365
Epoch: 49, Steps: 17 | Train Loss: 0.281 Vali Loss: 1.898 Vali Acc: 0.407 Test Loss: 1.898 Test Acc: 0.407
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 4.1845383644104
Epoch: 50, Steps: 17 | Train Loss: 0.247 Vali Loss: 1.973 Vali Acc: 0.433 Test Loss: 1.973 Test Acc: 0.433
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 4.2761547565460205
Epoch: 51, Steps: 17 | Train Loss: 0.232 Vali Loss: 2.071 Vali Acc: 0.388 Test Loss: 2.071 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 4.323322772979736
Epoch: 52, Steps: 17 | Train Loss: 0.223 Vali Loss: 2.241 Vali Acc: 0.399 Test Loss: 2.241 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 3.874826192855835
Epoch: 53, Steps: 17 | Train Loss: 0.211 Vali Loss: 2.200 Vali Acc: 0.380 Test Loss: 2.200 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 4.477214336395264
Epoch: 54, Steps: 17 | Train Loss: 0.236 Vali Loss: 2.153 Vali Acc: 0.418 Test Loss: 2.153 Test Acc: 0.418
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 4.048778772354126
Epoch: 55, Steps: 17 | Train Loss: 0.197 Vali Loss: 2.272 Vali Acc: 0.433 Test Loss: 2.272 Test Acc: 0.433
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 3.724656343460083
Epoch: 56, Steps: 17 | Train Loss: 0.175 Vali Loss: 2.220 Vali Acc: 0.411 Test Loss: 2.220 Test Acc: 0.411
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 4.080902576446533
Epoch: 57, Steps: 17 | Train Loss: 0.197 Vali Loss: 2.407 Vali Acc: 0.388 Test Loss: 2.407 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 3.977055072784424
Epoch: 58, Steps: 17 | Train Loss: 0.204 Vali Loss: 2.198 Vali Acc: 0.411 Test Loss: 2.198 Test Acc: 0.411
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.44106463878326996
model parameter : 346976
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.087956666946411
Epoch: 1, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.412 Vali Acc: 0.270 Test Loss: 1.412 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 4.0046303272247314
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.390 Vali Acc: 0.281 Test Loss: 1.390 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 3.7239718437194824
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.393 Vali Acc: 0.289 Test Loss: 1.393 Test Acc: 0.289
Validation loss decreased (-0.281355 --> -0.288959).  Saving model ...
Epoch: 4 cost time: 3.4183192253112793
Epoch: 4, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.428 Vali Acc: 0.243 Test Loss: 1.428 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0501365661621094
Epoch: 5, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.501 Vali Acc: 0.259 Test Loss: 1.501 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.048978090286255
Epoch: 6, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.390 Vali Acc: 0.262 Test Loss: 1.390 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.057022571563721
Epoch: 7, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.421 Vali Acc: 0.266 Test Loss: 1.421 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.5938732624053955
Epoch: 8, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.441 Vali Acc: 0.266 Test Loss: 1.441 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.1077566146850586
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.546 Vali Acc: 0.251 Test Loss: 1.546 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.026320219039917
Epoch: 10, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.449 Vali Acc: 0.274 Test Loss: 1.449 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.1666433811187744
Epoch: 11, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.7931292057037354
Epoch: 12, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.457 Vali Acc: 0.274 Test Loss: 1.457 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.5026767253875732
Epoch: 13, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.459 Vali Acc: 0.232 Test Loss: 1.459 Test Acc: 0.232
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 338176
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.678896427154541
Epoch: 1, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.412 Vali Acc: 0.205 Test Loss: 1.412 Test Acc: 0.205
Validation loss decreased (inf --> -0.205309).  Saving model ...
Epoch: 2 cost time: 4.36369252204895
Epoch: 2, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.402 Vali Acc: 0.262 Test Loss: 1.402 Test Acc: 0.262
Validation loss decreased (-0.205309 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 3.8301849365234375
Epoch: 3, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.414 Vali Acc: 0.243 Test Loss: 1.414 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1839120388031006
Epoch: 4, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.427 Vali Acc: 0.266 Test Loss: 1.427 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266145).  Saving model ...
Epoch: 5 cost time: 3.514357089996338
Epoch: 5, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.451 Vali Acc: 0.243 Test Loss: 1.451 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.319197177886963
Epoch: 6, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.410 Vali Acc: 0.236 Test Loss: 1.410 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.494929313659668
Epoch: 7, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.436 Vali Acc: 0.262 Test Loss: 1.436 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.160486936569214
Epoch: 8, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.438 Vali Acc: 0.300 Test Loss: 1.438 Test Acc: 0.300
Validation loss decreased (-0.266145 --> -0.300366).  Saving model ...
Epoch: 9 cost time: 3.6171422004699707
Epoch: 9, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.557 Vali Acc: 0.247 Test Loss: 1.557 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.823751211166382
Epoch: 10, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.396 Vali Acc: 0.255 Test Loss: 1.396 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.306166887283325
Epoch: 11, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.466 Vali Acc: 0.259 Test Loss: 1.466 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.3272461891174316
Epoch: 12, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.401 Vali Acc: 0.319 Test Loss: 1.401 Test Acc: 0.319
Validation loss decreased (-0.300366 --> -0.319378).  Saving model ...
Epoch: 13 cost time: 3.6222586631774902
Epoch: 13, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.408 Vali Acc: 0.289 Test Loss: 1.408 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.680627822875977
Epoch: 14, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.433 Vali Acc: 0.274 Test Loss: 1.433 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.576399564743042
Epoch: 15, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.381 Vali Acc: 0.278 Test Loss: 1.381 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.17909574508667
Epoch: 16, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.381 Vali Acc: 0.304 Test Loss: 1.381 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.905306816101074
Epoch: 17, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.354 Vali Acc: 0.331 Test Loss: 1.354 Test Acc: 0.331
Validation loss decreased (-0.319378 --> -0.330785).  Saving model ...
Epoch: 18 cost time: 4.29858922958374
Epoch: 18, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.506 Vali Acc: 0.350 Test Loss: 1.506 Test Acc: 0.350
Validation loss decreased (-0.330785 --> -0.349795).  Saving model ...
Epoch: 19 cost time: 4.313790559768677
Epoch: 19, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.310 Vali Acc: 0.392 Test Loss: 1.310 Test Acc: 0.392
Validation loss decreased (-0.349795 --> -0.391622).  Saving model ...
Epoch: 20 cost time: 3.491931438446045
Epoch: 20, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.434 Vali Acc: 0.346 Test Loss: 1.434 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.186394691467285
Epoch: 21, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.348 Vali Acc: 0.361 Test Loss: 1.348 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.625556468963623
Epoch: 22, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.378 Vali Acc: 0.407 Test Loss: 1.378 Test Acc: 0.407
Validation loss decreased (-0.391622 --> -0.406830).  Saving model ...
Epoch: 23 cost time: 4.133318901062012
Epoch: 23, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.453 Vali Acc: 0.376 Test Loss: 1.453 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.447166919708252
Epoch: 24, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.383 Vali Acc: 0.380 Test Loss: 1.383 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.1803038120269775
Epoch: 25, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.472 Vali Acc: 0.380 Test Loss: 1.472 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.157872915267944
Epoch: 26, Steps: 17 | Train Loss: 0.876 Vali Loss: 1.456 Vali Acc: 0.384 Test Loss: 1.456 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.962798833847046
Epoch: 27, Steps: 17 | Train Loss: 0.836 Vali Loss: 1.391 Vali Acc: 0.369 Test Loss: 1.391 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.078662157058716
Epoch: 28, Steps: 17 | Train Loss: 0.775 Vali Loss: 1.403 Vali Acc: 0.392 Test Loss: 1.403 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.181899309158325
Epoch: 29, Steps: 17 | Train Loss: 0.782 Vali Loss: 1.436 Vali Acc: 0.384 Test Loss: 1.436 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.138932228088379
Epoch: 30, Steps: 17 | Train Loss: 0.734 Vali Loss: 1.481 Vali Acc: 0.399 Test Loss: 1.481 Test Acc: 0.399
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.7972168922424316
Epoch: 31, Steps: 17 | Train Loss: 0.697 Vali Loss: 1.462 Vali Acc: 0.388 Test Loss: 1.462 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.699862241744995
Epoch: 32, Steps: 17 | Train Loss: 0.697 Vali Loss: 1.522 Vali Acc: 0.380 Test Loss: 1.522 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4068441064638783
model parameter : 289696
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.057223320007324
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.398 Vali Acc: 0.266 Test Loss: 1.398 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 3.849872350692749
Epoch: 2, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.390 Vali Acc: 0.259 Test Loss: 1.390 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4120829105377197
Epoch: 3, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.406 Vali Acc: 0.259 Test Loss: 1.406 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.237039089202881
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.400 Vali Acc: 0.255 Test Loss: 1.400 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.121265172958374
Epoch: 5, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.442 Vali Acc: 0.251 Test Loss: 1.442 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.8009414672851562
Epoch: 6, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.431 Vali Acc: 0.255 Test Loss: 1.431 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.8016350269317627
Epoch: 7, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.409 Vali Acc: 0.266 Test Loss: 1.409 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.5772976875305176
Epoch: 8, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.465 Vali Acc: 0.255 Test Loss: 1.465 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 4.047060489654541
Epoch: 9, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.410 Vali Acc: 0.259 Test Loss: 1.410 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 3.406399726867676
Epoch: 10, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.620 Vali Acc: 0.247 Test Loss: 1.620 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 4.411144256591797
Epoch: 11, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.426 Vali Acc: 0.285 Test Loss: 1.426 Test Acc: 0.285
Validation loss decreased (-0.266146 --> -0.285157).  Saving model ...
Epoch: 12 cost time: 4.23610520362854
Epoch: 12, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.483 Vali Acc: 0.266 Test Loss: 1.483 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.2682576179504395
Epoch: 13, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.425 Vali Acc: 0.262 Test Loss: 1.425 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.9084174633026123
Epoch: 14, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.424 Vali Acc: 0.278 Test Loss: 1.424 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.591102123260498
Epoch: 15, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.429 Vali Acc: 0.338 Test Loss: 1.429 Test Acc: 0.338
Validation loss decreased (-0.285157 --> -0.338389).  Saving model ...
Epoch: 16 cost time: 3.20737361907959
Epoch: 16, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.445 Vali Acc: 0.240 Test Loss: 1.445 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.5107202529907227
Epoch: 17, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.437 Vali Acc: 0.278 Test Loss: 1.437 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.145520448684692
Epoch: 18, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.454 Vali Acc: 0.338 Test Loss: 1.454 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.7298476696014404
Epoch: 19, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.496 Vali Acc: 0.281 Test Loss: 1.496 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.817596673965454
Epoch: 20, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.500 Vali Acc: 0.259 Test Loss: 1.500 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.662782907485962
Epoch: 21, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.472 Vali Acc: 0.304 Test Loss: 1.472 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.164431095123291
Epoch: 22, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.617 Vali Acc: 0.312 Test Loss: 1.617 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.875274896621704
Epoch: 23, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.453 Vali Acc: 0.278 Test Loss: 1.453 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.024866104125977
Epoch: 24, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.359 Vali Acc: 0.369 Test Loss: 1.359 Test Acc: 0.369
Validation loss decreased (-0.338389 --> -0.368808).  Saving model ...
Epoch: 25 cost time: 3.952321767807007
Epoch: 25, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.396 Vali Acc: 0.327 Test Loss: 1.396 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.906071901321411
Epoch: 26, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.369 Vali Acc: 0.403 Test Loss: 1.369 Test Acc: 0.403
Validation loss decreased (-0.368808 --> -0.403028).  Saving model ...
Epoch: 27 cost time: 4.054046869277954
Epoch: 27, Steps: 17 | Train Loss: 0.876 Vali Loss: 1.423 Vali Acc: 0.407 Test Loss: 1.423 Test Acc: 0.407
Validation loss decreased (-0.403028 --> -0.406830).  Saving model ...
Epoch: 28 cost time: 3.594792127609253
Epoch: 28, Steps: 17 | Train Loss: 0.884 Vali Loss: 1.442 Vali Acc: 0.376 Test Loss: 1.442 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.091333389282227
Epoch: 29, Steps: 17 | Train Loss: 0.844 Vali Loss: 1.368 Vali Acc: 0.399 Test Loss: 1.368 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.242400169372559
Epoch: 30, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.442 Vali Acc: 0.407 Test Loss: 1.442 Test Acc: 0.407
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.04529333114624
Epoch: 31, Steps: 17 | Train Loss: 0.804 Vali Loss: 1.416 Vali Acc: 0.395 Test Loss: 1.416 Test Acc: 0.395
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.001916170120239
Epoch: 32, Steps: 17 | Train Loss: 0.721 Vali Loss: 1.436 Vali Acc: 0.384 Test Loss: 1.436 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.8035385608673096
Epoch: 33, Steps: 17 | Train Loss: 0.684 Vali Loss: 1.486 Vali Acc: 0.373 Test Loss: 1.486 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.069682359695435
Epoch: 34, Steps: 17 | Train Loss: 0.730 Vali Loss: 1.587 Vali Acc: 0.350 Test Loss: 1.587 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 4.142239332199097
Epoch: 35, Steps: 17 | Train Loss: 0.714 Vali Loss: 1.514 Vali Acc: 0.384 Test Loss: 1.514 Test Acc: 0.384
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.4482176303863525
Epoch: 36, Steps: 17 | Train Loss: 0.671 Vali Loss: 1.519 Vali Acc: 0.376 Test Loss: 1.519 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 2.9452123641967773
Epoch: 37, Steps: 17 | Train Loss: 0.650 Vali Loss: 1.754 Vali Acc: 0.365 Test Loss: 1.754 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4068441064638783
model parameter : 280896
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.298430919647217
Epoch: 1, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.432 Vali Acc: 0.251 Test Loss: 1.432 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 4.849939823150635
Epoch: 2, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.432 Vali Acc: 0.243 Test Loss: 1.432 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.301944255828857
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.397 Vali Acc: 0.266 Test Loss: 1.397 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 3.9720330238342285
Epoch: 4, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.457 Vali Acc: 0.289 Test Loss: 1.457 Test Acc: 0.289
Validation loss decreased (-0.266146 --> -0.288959).  Saving model ...
Epoch: 5 cost time: 3.8888702392578125
Epoch: 5, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.465 Vali Acc: 0.266 Test Loss: 1.465 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.106576204299927
Epoch: 6, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.530 Vali Acc: 0.232 Test Loss: 1.530 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.8280301094055176
Epoch: 7, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.409 Vali Acc: 0.274 Test Loss: 1.409 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.884610414505005
Epoch: 8, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.437 Vali Acc: 0.274 Test Loss: 1.437 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.307184219360352
Epoch: 9, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.407 Vali Acc: 0.300 Test Loss: 1.407 Test Acc: 0.300
Validation loss decreased (-0.288959 --> -0.300366).  Saving model ...
Epoch: 10 cost time: 3.795332908630371
Epoch: 10, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.417 Vali Acc: 0.289 Test Loss: 1.417 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.955458164215088
Epoch: 11, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.393 Vali Acc: 0.266 Test Loss: 1.393 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.6637425422668457
Epoch: 12, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.430 Vali Acc: 0.262 Test Loss: 1.430 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5211570262908936
Epoch: 13, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.486 Vali Acc: 0.285 Test Loss: 1.486 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.867556095123291
Epoch: 14, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.394 Vali Acc: 0.285 Test Loss: 1.394 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.874637842178345
Epoch: 15, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.432 Vali Acc: 0.300 Test Loss: 1.432 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.093469142913818
Epoch: 16, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.405 Vali Acc: 0.316 Test Loss: 1.405 Test Acc: 0.316
Validation loss decreased (-0.300366 --> -0.315575).  Saving model ...
Epoch: 17 cost time: 4.326475381851196
Epoch: 17, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.406 Vali Acc: 0.316 Test Loss: 1.406 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.612222194671631
Epoch: 18, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.403 Vali Acc: 0.338 Test Loss: 1.403 Test Acc: 0.338
Validation loss decreased (-0.315575 --> -0.338389).  Saving model ...
Epoch: 19 cost time: 4.0285515785217285
Epoch: 19, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.383 Vali Acc: 0.331 Test Loss: 1.383 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2988474369049072
Epoch: 20, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.406 Vali Acc: 0.338 Test Loss: 1.406 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.381423711776733
Epoch: 21, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.458 Vali Acc: 0.342 Test Loss: 1.458 Test Acc: 0.342
Validation loss decreased (-0.338389 --> -0.342191).  Saving model ...
Epoch: 22 cost time: 4.414351463317871
Epoch: 22, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.441 Vali Acc: 0.361 Test Loss: 1.441 Test Acc: 0.361
Validation loss decreased (-0.342191 --> -0.361202).  Saving model ...
Epoch: 23 cost time: 3.816240072250366
Epoch: 23, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.427 Vali Acc: 0.418 Test Loss: 1.427 Test Acc: 0.418
Validation loss decreased (-0.361202 --> -0.418237).  Saving model ...
Epoch: 24 cost time: 4.2996697425842285
Epoch: 24, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.430 Vali Acc: 0.380 Test Loss: 1.430 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.8810415267944336
Epoch: 25, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.337 Vali Acc: 0.388 Test Loss: 1.337 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.057703256607056
Epoch: 26, Steps: 17 | Train Loss: 0.897 Vali Loss: 1.430 Vali Acc: 0.426 Test Loss: 1.430 Test Acc: 0.426
Validation loss decreased (-0.418237 --> -0.425841).  Saving model ...
Epoch: 27 cost time: 3.6917355060577393
Epoch: 27, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.319 Vali Acc: 0.426 Test Loss: 1.319 Test Acc: 0.426
Validation loss decreased (-0.425841 --> -0.425842).  Saving model ...
Epoch: 28 cost time: 3.7862162590026855
Epoch: 28, Steps: 17 | Train Loss: 0.846 Vali Loss: 1.425 Vali Acc: 0.411 Test Loss: 1.425 Test Acc: 0.411
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.229872226715088
Epoch: 29, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.392 Vali Acc: 0.399 Test Loss: 1.392 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.9573347568511963
Epoch: 30, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.521 Vali Acc: 0.357 Test Loss: 1.521 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.721647024154663
Epoch: 31, Steps: 17 | Train Loss: 0.779 Vali Loss: 1.552 Vali Acc: 0.388 Test Loss: 1.552 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.105773687362671
Epoch: 32, Steps: 17 | Train Loss: 0.750 Vali Loss: 1.388 Vali Acc: 0.433 Test Loss: 1.388 Test Acc: 0.433
Validation loss decreased (-0.425842 --> -0.433446).  Saving model ...
Epoch: 33 cost time: 3.5184154510498047
Epoch: 33, Steps: 17 | Train Loss: 0.770 Vali Loss: 1.435 Vali Acc: 0.456 Test Loss: 1.435 Test Acc: 0.456
Validation loss decreased (-0.433446 --> -0.456259).  Saving model ...
Epoch: 34 cost time: 3.847966432571411
Epoch: 34, Steps: 17 | Train Loss: 0.716 Vali Loss: 1.399 Vali Acc: 0.452 Test Loss: 1.399 Test Acc: 0.452
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 4.253902196884155
Epoch: 35, Steps: 17 | Train Loss: 0.767 Vali Loss: 1.412 Vali Acc: 0.441 Test Loss: 1.412 Test Acc: 0.441
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.18195366859436
Epoch: 36, Steps: 17 | Train Loss: 0.638 Vali Loss: 1.460 Vali Acc: 0.411 Test Loss: 1.460 Test Acc: 0.411
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 4.316423654556274
Epoch: 37, Steps: 17 | Train Loss: 0.638 Vali Loss: 1.582 Vali Acc: 0.407 Test Loss: 1.582 Test Acc: 0.407
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.1081383228302
Epoch: 38, Steps: 17 | Train Loss: 0.665 Vali Loss: 1.531 Vali Acc: 0.437 Test Loss: 1.531 Test Acc: 0.437
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.8984150886535645
Epoch: 39, Steps: 17 | Train Loss: 0.610 Vali Loss: 1.572 Vali Acc: 0.418 Test Loss: 1.572 Test Acc: 0.418
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 4.363267660140991
Epoch: 40, Steps: 17 | Train Loss: 0.547 Vali Loss: 1.599 Vali Acc: 0.392 Test Loss: 1.599 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 4.162745952606201
Epoch: 41, Steps: 17 | Train Loss: 0.622 Vali Loss: 1.694 Vali Acc: 0.384 Test Loss: 1.694 Test Acc: 0.384
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 4.060750722885132
Epoch: 42, Steps: 17 | Train Loss: 0.526 Vali Loss: 1.609 Vali Acc: 0.403 Test Loss: 1.609 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 4.550668478012085
Epoch: 43, Steps: 17 | Train Loss: 0.507 Vali Loss: 1.733 Vali Acc: 0.395 Test Loss: 1.733 Test Acc: 0.395
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.45627376425855515
model parameter : 272096
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.8776867389678955
Epoch: 1, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.432 Vali Acc: 0.259 Test Loss: 1.432 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 3.429682731628418
Epoch: 2, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.423 Vali Acc: 0.243 Test Loss: 1.423 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2463321685791016
Epoch: 3, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.397 Vali Acc: 0.243 Test Loss: 1.397 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5487470626831055
Epoch: 4, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.418 Vali Acc: 0.262 Test Loss: 1.418 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 3.136666774749756
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.410 Vali Acc: 0.247 Test Loss: 1.410 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0991549491882324
Epoch: 6, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.447 Vali Acc: 0.255 Test Loss: 1.447 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.938115119934082
Epoch: 7, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.413 Vali Acc: 0.232 Test Loss: 1.413 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.074690341949463
Epoch: 8, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.453 Vali Acc: 0.243 Test Loss: 1.453 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2277321815490723
Epoch: 9, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.470 Vali Acc: 0.274 Test Loss: 1.470 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 10 cost time: 3.0017268657684326
Epoch: 10, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.411 Vali Acc: 0.274 Test Loss: 1.411 Test Acc: 0.274
Validation loss decreased (-0.273750 --> -0.273750).  Saving model ...
Epoch: 11 cost time: 3.204040288925171
Epoch: 11, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.467 Vali Acc: 0.262 Test Loss: 1.467 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.254863977432251
Epoch: 12, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.438 Vali Acc: 0.247 Test Loss: 1.438 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.370535135269165
Epoch: 13, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.452 Vali Acc: 0.274 Test Loss: 1.452 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.4783904552459717
Epoch: 14, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.439 Vali Acc: 0.281 Test Loss: 1.439 Test Acc: 0.281
Validation loss decreased (-0.273750 --> -0.281354).  Saving model ...
Epoch: 15 cost time: 3.2712011337280273
Epoch: 15, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.436 Vali Acc: 0.251 Test Loss: 1.436 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.617011308670044
Epoch: 16, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.426 Vali Acc: 0.293 Test Loss: 1.426 Test Acc: 0.293
Validation loss decreased (-0.281354 --> -0.292761).  Saving model ...
Epoch: 17 cost time: 3.4703962802886963
Epoch: 17, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.489 Vali Acc: 0.255 Test Loss: 1.489 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2378909587860107
Epoch: 18, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.427 Vali Acc: 0.255 Test Loss: 1.427 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.332500696182251
Epoch: 19, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.541 Vali Acc: 0.255 Test Loss: 1.541 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.167407274246216
Epoch: 20, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.550 Vali Acc: 0.240 Test Loss: 1.550 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.1985363960266113
Epoch: 21, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.461 Vali Acc: 0.262 Test Loss: 1.461 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.3089778423309326
Epoch: 22, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.472 Vali Acc: 0.281 Test Loss: 1.472 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.4393699169158936
Epoch: 23, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.498 Vali Acc: 0.289 Test Loss: 1.498 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.049656629562378
Epoch: 24, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.615 Vali Acc: 0.278 Test Loss: 1.615 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.44486403465271
Epoch: 25, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.538 Vali Acc: 0.323 Test Loss: 1.538 Test Acc: 0.323
Validation loss decreased (-0.292761 --> -0.323179).  Saving model ...
Epoch: 26 cost time: 3.485408306121826
Epoch: 26, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.489 Vali Acc: 0.308 Test Loss: 1.489 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.5094518661499023
Epoch: 27, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.475 Vali Acc: 0.350 Test Loss: 1.475 Test Acc: 0.350
Validation loss decreased (-0.323179 --> -0.349795).  Saving model ...
Epoch: 28 cost time: 3.417196273803711
Epoch: 28, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.520 Vali Acc: 0.297 Test Loss: 1.520 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.036484479904175
Epoch: 29, Steps: 17 | Train Loss: 0.937 Vali Loss: 1.516 Vali Acc: 0.327 Test Loss: 1.516 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.282776117324829
Epoch: 30, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.495 Vali Acc: 0.308 Test Loss: 1.495 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.347287654876709
Epoch: 31, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.486 Vali Acc: 0.392 Test Loss: 1.486 Test Acc: 0.392
Validation loss decreased (-0.349795 --> -0.391620).  Saving model ...
Epoch: 32 cost time: 3.146433115005493
Epoch: 32, Steps: 17 | Train Loss: 0.832 Vali Loss: 1.674 Vali Acc: 0.308 Test Loss: 1.674 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.561469078063965
Epoch: 33, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.572 Vali Acc: 0.373 Test Loss: 1.572 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.4693005084991455
Epoch: 34, Steps: 17 | Train Loss: 0.735 Vali Loss: 1.496 Vali Acc: 0.418 Test Loss: 1.496 Test Acc: 0.418
Validation loss decreased (-0.391620 --> -0.418236).  Saving model ...
Epoch: 35 cost time: 3.5486321449279785
Epoch: 35, Steps: 17 | Train Loss: 0.743 Vali Loss: 1.618 Vali Acc: 0.418 Test Loss: 1.618 Test Acc: 0.418
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.326650857925415
Epoch: 36, Steps: 17 | Train Loss: 0.749 Vali Loss: 1.586 Vali Acc: 0.365 Test Loss: 1.586 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.5043327808380127
Epoch: 37, Steps: 17 | Train Loss: 0.681 Vali Loss: 1.659 Vali Acc: 0.365 Test Loss: 1.659 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.028850317001343
Epoch: 38, Steps: 17 | Train Loss: 0.651 Vali Loss: 1.647 Vali Acc: 0.357 Test Loss: 1.647 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.5863964557647705
Epoch: 39, Steps: 17 | Train Loss: 0.652 Vali Loss: 1.670 Vali Acc: 0.384 Test Loss: 1.670 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 3.0458478927612305
Epoch: 40, Steps: 17 | Train Loss: 0.651 Vali Loss: 1.673 Vali Acc: 0.369 Test Loss: 1.673 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.4717977046966553
Epoch: 41, Steps: 17 | Train Loss: 0.627 Vali Loss: 1.722 Vali Acc: 0.361 Test Loss: 1.722 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.3587186336517334
Epoch: 42, Steps: 17 | Train Loss: 0.564 Vali Loss: 1.885 Vali Acc: 0.308 Test Loss: 1.885 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.9925904273986816
Epoch: 43, Steps: 17 | Train Loss: 0.682 Vali Loss: 1.850 Vali Acc: 0.376 Test Loss: 1.850 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.2948570251464844
Epoch: 44, Steps: 17 | Train Loss: 0.538 Vali Loss: 1.730 Vali Acc: 0.365 Test Loss: 1.730 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41825095057034223
model parameter : 263296
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.997766017913818
Epoch: 1, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.743 Vali Acc: 0.259 Test Loss: 1.743 Test Acc: 0.259
Validation loss decreased (inf --> -0.258538).  Saving model ...
Epoch: 2 cost time: 6.540656805038452
Epoch: 2, Steps: 17 | Train Loss: 1.604 Vali Loss: 1.442 Vali Acc: 0.293 Test Loss: 1.442 Test Acc: 0.293
Validation loss decreased (-0.258538 --> -0.292761).  Saving model ...
Epoch: 3 cost time: 7.071791410446167
Epoch: 3, Steps: 17 | Train Loss: 1.603 Vali Loss: 1.503 Vali Acc: 0.274 Test Loss: 1.503 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.746652841567993
Epoch: 4, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.673 Vali Acc: 0.247 Test Loss: 1.673 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 6.822948217391968
Epoch: 5, Steps: 17 | Train Loss: 1.610 Vali Loss: 1.728 Vali Acc: 0.240 Test Loss: 1.728 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.869020938873291
Epoch: 6, Steps: 17 | Train Loss: 1.369 Vali Loss: 2.074 Vali Acc: 0.259 Test Loss: 2.074 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 7.35731315612793
Epoch: 7, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.560 Vali Acc: 0.300 Test Loss: 1.560 Test Acc: 0.300
Validation loss decreased (-0.292761 --> -0.300365).  Saving model ...
Epoch: 8 cost time: 7.0466837882995605
Epoch: 8, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.730 Vali Acc: 0.281 Test Loss: 1.730 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.456445932388306
Epoch: 9, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.770 Vali Acc: 0.289 Test Loss: 1.770 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.639350414276123
Epoch: 10, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.761 Vali Acc: 0.319 Test Loss: 1.761 Test Acc: 0.319
Validation loss decreased (-0.300365 --> -0.319374).  Saving model ...
Epoch: 11 cost time: 6.1368489265441895
Epoch: 11, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.619 Vali Acc: 0.323 Test Loss: 1.619 Test Acc: 0.323
Validation loss decreased (-0.319374 --> -0.323178).  Saving model ...
Epoch: 12 cost time: 6.067889928817749
Epoch: 12, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.787 Vali Acc: 0.373 Test Loss: 1.787 Test Acc: 0.373
Validation loss decreased (-0.323178 --> -0.372606).  Saving model ...
Epoch: 13 cost time: 5.742516994476318
Epoch: 13, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.662 Vali Acc: 0.308 Test Loss: 1.662 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.8314573764801025
Epoch: 14, Steps: 17 | Train Loss: 0.904 Vali Loss: 1.963 Vali Acc: 0.376 Test Loss: 1.963 Test Acc: 0.376
Validation loss decreased (-0.372606 --> -0.376406).  Saving model ...
Epoch: 15 cost time: 5.391534805297852
Epoch: 15, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.217 Vali Acc: 0.338 Test Loss: 2.217 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 7.609555959701538
Epoch: 16, Steps: 17 | Train Loss: 0.864 Vali Loss: 2.152 Vali Acc: 0.300 Test Loss: 2.152 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.157702445983887
Epoch: 17, Steps: 17 | Train Loss: 1.114 Vali Loss: 2.191 Vali Acc: 0.278 Test Loss: 2.191 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.451874017715454
Epoch: 18, Steps: 17 | Train Loss: 0.884 Vali Loss: 2.391 Vali Acc: 0.338 Test Loss: 2.391 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.2446019649505615
Epoch: 19, Steps: 17 | Train Loss: 1.080 Vali Loss: 2.321 Vali Acc: 0.300 Test Loss: 2.321 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 7.013891696929932
Epoch: 20, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.959 Vali Acc: 0.338 Test Loss: 1.959 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.748326539993286
Epoch: 21, Steps: 17 | Train Loss: 0.705 Vali Loss: 2.101 Vali Acc: 0.350 Test Loss: 2.101 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.952081918716431
Epoch: 22, Steps: 17 | Train Loss: 0.973 Vali Loss: 2.354 Vali Acc: 0.236 Test Loss: 2.354 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 6.923278093338013
Epoch: 23, Steps: 17 | Train Loss: 0.908 Vali Loss: 2.271 Vali Acc: 0.304 Test Loss: 2.271 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.50924277305603
Epoch: 24, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.857 Vali Acc: 0.281 Test Loss: 2.857 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.376425855513308
model parameter : 11573300
model size : 49.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.967952728271484
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.508 Vali Acc: 0.262 Test Loss: 1.508 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 6.60581111907959
Epoch: 2, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.732 Vali Acc: 0.247 Test Loss: 1.732 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.439075946807861
Epoch: 3, Steps: 17 | Train Loss: 1.700 Vali Loss: 1.681 Vali Acc: 0.247 Test Loss: 1.681 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.515857696533203
Epoch: 4, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.695 Vali Acc: 0.255 Test Loss: 1.695 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.210724353790283
Epoch: 5, Steps: 17 | Train Loss: 1.628 Vali Loss: 1.449 Vali Acc: 0.270 Test Loss: 1.449 Test Acc: 0.270
Validation loss decreased (-0.262342 --> -0.269947).  Saving model ...
Epoch: 6 cost time: 5.238872289657593
Epoch: 6, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.592 Vali Acc: 0.259 Test Loss: 1.592 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.125567197799683
Epoch: 7, Steps: 17 | Train Loss: 1.528 Vali Loss: 2.276 Vali Acc: 0.278 Test Loss: 2.276 Test Acc: 0.278
Validation loss decreased (-0.269947 --> -0.277544).  Saving model ...
Epoch: 8 cost time: 6.123526573181152
Epoch: 8, Steps: 17 | Train Loss: 1.587 Vali Loss: 1.637 Vali Acc: 0.278 Test Loss: 1.637 Test Acc: 0.278
Validation loss decreased (-0.277544 --> -0.277550).  Saving model ...
Epoch: 9 cost time: 6.880913257598877
Epoch: 9, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.831 Vali Acc: 0.369 Test Loss: 1.831 Test Acc: 0.369
Validation loss decreased (-0.277550 --> -0.368803).  Saving model ...
Epoch: 10 cost time: 7.041172027587891
Epoch: 10, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.869 Vali Acc: 0.278 Test Loss: 1.869 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.373231887817383
Epoch: 11, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.493 Vali Acc: 0.350 Test Loss: 1.493 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.2790539264678955
Epoch: 12, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.993 Vali Acc: 0.300 Test Loss: 1.993 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 7.639817714691162
Epoch: 13, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.843 Vali Acc: 0.316 Test Loss: 1.843 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.981600999832153
Epoch: 14, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.885 Vali Acc: 0.354 Test Loss: 1.885 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.4510157108306885
Epoch: 15, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.701 Vali Acc: 0.354 Test Loss: 1.701 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.929933786392212
Epoch: 16, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.789 Vali Acc: 0.319 Test Loss: 1.789 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.281053781509399
Epoch: 17, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.795 Vali Acc: 0.338 Test Loss: 1.795 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.078863859176636
Epoch: 18, Steps: 17 | Train Loss: 1.033 Vali Loss: 2.274 Vali Acc: 0.297 Test Loss: 2.274 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.734039068222046
Epoch: 19, Steps: 17 | Train Loss: 0.827 Vali Loss: 2.137 Vali Acc: 0.312 Test Loss: 2.137 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3688212927756654
model parameter : 11507764
model size : 48.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.666101455688477
Epoch: 1, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.799 Vali Acc: 0.262 Test Loss: 1.799 Test Acc: 0.262
Validation loss decreased (inf --> -0.262339).  Saving model ...
Epoch: 2 cost time: 6.19072413444519
Epoch: 2, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.437 Vali Acc: 0.278 Test Loss: 1.437 Test Acc: 0.278
Validation loss decreased (-0.262339 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 6.0712549686431885
Epoch: 3, Steps: 17 | Train Loss: 1.592 Vali Loss: 1.652 Vali Acc: 0.259 Test Loss: 1.652 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.888336181640625
Epoch: 4, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.608 Vali Acc: 0.266 Test Loss: 1.608 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.60824728012085
Epoch: 5, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.855 Vali Acc: 0.281 Test Loss: 1.855 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281350).  Saving model ...
Epoch: 6 cost time: 6.677382469177246
Epoch: 6, Steps: 17 | Train Loss: 1.306 Vali Loss: 2.202 Vali Acc: 0.278 Test Loss: 2.202 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.23166036605835
Epoch: 7, Steps: 17 | Train Loss: 1.454 Vali Loss: 2.215 Vali Acc: 0.331 Test Loss: 2.215 Test Acc: 0.331
Validation loss decreased (-0.281350 --> -0.330776).  Saving model ...
Epoch: 8 cost time: 5.584040880203247
Epoch: 8, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.681 Vali Acc: 0.319 Test Loss: 1.681 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.562102794647217
Epoch: 9, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.560 Vali Acc: 0.304 Test Loss: 1.560 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.751388788223267
Epoch: 10, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.720 Vali Acc: 0.323 Test Loss: 1.720 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.606393098831177
Epoch: 11, Steps: 17 | Train Loss: 1.082 Vali Loss: 2.303 Vali Acc: 0.380 Test Loss: 2.303 Test Acc: 0.380
Validation loss decreased (-0.330776 --> -0.380205).  Saving model ...
Epoch: 12 cost time: 6.877183675765991
Epoch: 12, Steps: 17 | Train Loss: 1.225 Vali Loss: 2.230 Vali Acc: 0.281 Test Loss: 2.230 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.910607576370239
Epoch: 13, Steps: 17 | Train Loss: 1.155 Vali Loss: 2.228 Vali Acc: 0.278 Test Loss: 2.228 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.42378568649292
Epoch: 14, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.590 Vali Acc: 0.346 Test Loss: 1.590 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.170990467071533
Epoch: 15, Steps: 17 | Train Loss: 0.957 Vali Loss: 1.960 Vali Acc: 0.354 Test Loss: 1.960 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.3437933921813965
Epoch: 16, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.714 Vali Acc: 0.373 Test Loss: 1.714 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.649395704269409
Epoch: 17, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.636 Vali Acc: 0.350 Test Loss: 1.636 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 6.150822877883911
Epoch: 18, Steps: 17 | Train Loss: 0.866 Vali Loss: 2.189 Vali Acc: 0.327 Test Loss: 2.189 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 6.701123237609863
Epoch: 19, Steps: 17 | Train Loss: 0.789 Vali Loss: 1.852 Vali Acc: 0.357 Test Loss: 1.852 Test Acc: 0.357
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 6.610926628112793
Epoch: 20, Steps: 17 | Train Loss: 0.849 Vali Loss: 2.310 Vali Acc: 0.380 Test Loss: 2.310 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.696787357330322
Epoch: 21, Steps: 17 | Train Loss: 0.855 Vali Loss: 2.467 Vali Acc: 0.338 Test Loss: 2.467 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38022813688212925
model parameter : 11442228
model size : 48.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.564243316650391
Epoch: 1, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.455 Vali Acc: 0.278 Test Loss: 1.455 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 6.578713655471802
Epoch: 2, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.818 Vali Acc: 0.240 Test Loss: 1.818 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.062540769577026
Epoch: 3, Steps: 17 | Train Loss: 1.662 Vali Loss: 1.481 Vali Acc: 0.274 Test Loss: 1.481 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 7.227444410324097
Epoch: 4, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.679 Vali Acc: 0.247 Test Loss: 1.679 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.433592796325684
Epoch: 5, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.643 Vali Acc: 0.247 Test Loss: 1.643 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.22723650932312
Epoch: 6, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.850 Vali Acc: 0.243 Test Loss: 1.850 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.034137487411499
Epoch: 7, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.682 Vali Acc: 0.293 Test Loss: 1.682 Test Acc: 0.293
Validation loss decreased (-0.277552 --> -0.292759).  Saving model ...
Epoch: 8 cost time: 4.853976726531982
Epoch: 8, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.913 Vali Acc: 0.281 Test Loss: 1.913 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.774203538894653
Epoch: 9, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.815 Vali Acc: 0.274 Test Loss: 1.815 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.5271382331848145
Epoch: 10, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.971 Vali Acc: 0.255 Test Loss: 1.971 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.076432943344116
Epoch: 11, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.754 Vali Acc: 0.342 Test Loss: 1.754 Test Acc: 0.342
Validation loss decreased (-0.292759 --> -0.342188).  Saving model ...
Epoch: 12 cost time: 5.659444808959961
Epoch: 12, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.762 Vali Acc: 0.319 Test Loss: 1.762 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.74031925201416
Epoch: 13, Steps: 17 | Train Loss: 0.993 Vali Loss: 2.139 Vali Acc: 0.338 Test Loss: 2.139 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.039147853851318
Epoch: 14, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.014 Vali Acc: 0.319 Test Loss: 2.014 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.2738025188446045
Epoch: 15, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.763 Vali Acc: 0.304 Test Loss: 1.763 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.575713396072388
Epoch: 16, Steps: 17 | Train Loss: 0.816 Vali Loss: 1.758 Vali Acc: 0.346 Test Loss: 1.758 Test Acc: 0.346
Validation loss decreased (-0.342188 --> -0.345990).  Saving model ...
Epoch: 17 cost time: 5.5993921756744385
Epoch: 17, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.971 Vali Acc: 0.338 Test Loss: 1.971 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.07901406288147
Epoch: 18, Steps: 17 | Train Loss: 0.893 Vali Loss: 2.014 Vali Acc: 0.357 Test Loss: 2.014 Test Acc: 0.357
Validation loss decreased (-0.345990 --> -0.357394).  Saving model ...
Epoch: 19 cost time: 5.487629175186157
Epoch: 19, Steps: 17 | Train Loss: 0.805 Vali Loss: 2.684 Vali Acc: 0.316 Test Loss: 2.684 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.176271915435791
Epoch: 20, Steps: 17 | Train Loss: 0.745 Vali Loss: 1.936 Vali Acc: 0.346 Test Loss: 1.936 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.412057161331177
Epoch: 21, Steps: 17 | Train Loss: 0.728 Vali Loss: 2.214 Vali Acc: 0.335 Test Loss: 2.214 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.907113552093506
Epoch: 22, Steps: 17 | Train Loss: 0.573 Vali Loss: 2.045 Vali Acc: 0.331 Test Loss: 2.045 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.50882363319397
Epoch: 23, Steps: 17 | Train Loss: 0.589 Vali Loss: 2.746 Vali Acc: 0.376 Test Loss: 2.746 Test Acc: 0.376
Validation loss decreased (-0.357394 --> -0.376398).  Saving model ...
Epoch: 24 cost time: 5.759486436843872
Epoch: 24, Steps: 17 | Train Loss: 0.748 Vali Loss: 2.426 Vali Acc: 0.338 Test Loss: 2.426 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.1570494174957275
Epoch: 25, Steps: 17 | Train Loss: 0.578 Vali Loss: 2.644 Vali Acc: 0.323 Test Loss: 2.644 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.607672452926636
Epoch: 26, Steps: 17 | Train Loss: 0.573 Vali Loss: 2.689 Vali Acc: 0.342 Test Loss: 2.689 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.691824674606323
Epoch: 27, Steps: 17 | Train Loss: 0.825 Vali Loss: 2.338 Vali Acc: 0.338 Test Loss: 2.338 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.6192967891693115
Epoch: 28, Steps: 17 | Train Loss: 0.532 Vali Loss: 3.467 Vali Acc: 0.316 Test Loss: 3.467 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.4587485790252686
Epoch: 29, Steps: 17 | Train Loss: 0.648 Vali Loss: 2.961 Vali Acc: 0.274 Test Loss: 2.961 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.411997556686401
Epoch: 30, Steps: 17 | Train Loss: 0.676 Vali Loss: 2.732 Vali Acc: 0.354 Test Loss: 2.732 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.523675441741943
Epoch: 31, Steps: 17 | Train Loss: 0.691 Vali Loss: 3.619 Vali Acc: 0.278 Test Loss: 3.619 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.6810622215271
Epoch: 32, Steps: 17 | Train Loss: 0.962 Vali Loss: 3.025 Vali Acc: 0.331 Test Loss: 3.025 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 6.11568808555603
Epoch: 33, Steps: 17 | Train Loss: 0.577 Vali Loss: 2.605 Vali Acc: 0.289 Test Loss: 2.605 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.376425855513308
model parameter : 11376692
model size : 48.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.885666370391846
Epoch: 1, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.531 Vali Acc: 0.247 Test Loss: 1.531 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 7.093360185623169
Epoch: 2, Steps: 17 | Train Loss: 1.614 Vali Loss: 1.745 Vali Acc: 0.259 Test Loss: 1.745 Test Acc: 0.259
Validation loss decreased (-0.247133 --> -0.258538).  Saving model ...
Epoch: 3 cost time: 6.7953691482543945
Epoch: 3, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.683 Vali Acc: 0.251 Test Loss: 1.683 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.657580852508545
Epoch: 4, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.621 Vali Acc: 0.247 Test Loss: 1.621 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.227745771408081
Epoch: 5, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.500 Vali Acc: 0.278 Test Loss: 1.500 Test Acc: 0.278
Validation loss decreased (-0.258538 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 5.052574396133423
Epoch: 6, Steps: 17 | Train Loss: 1.426 Vali Loss: 2.425 Vali Acc: 0.243 Test Loss: 2.425 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.036685943603516
Epoch: 7, Steps: 17 | Train Loss: 1.663 Vali Loss: 1.515 Vali Acc: 0.285 Test Loss: 1.515 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285156).  Saving model ...
Epoch: 8 cost time: 5.840298652648926
Epoch: 8, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.814 Vali Acc: 0.278 Test Loss: 1.814 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.784215927124023
Epoch: 9, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.650 Vali Acc: 0.289 Test Loss: 1.650 Test Acc: 0.289
Validation loss decreased (-0.285156 --> -0.288957).  Saving model ...
Epoch: 10 cost time: 6.239666938781738
Epoch: 10, Steps: 17 | Train Loss: 1.173 Vali Loss: 2.208 Vali Acc: 0.262 Test Loss: 2.208 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.960432052612305
Epoch: 11, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.856 Vali Acc: 0.297 Test Loss: 1.856 Test Acc: 0.297
Validation loss decreased (-0.288957 --> -0.296559).  Saving model ...
Epoch: 12 cost time: 5.569022178649902
Epoch: 12, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.951 Vali Acc: 0.297 Test Loss: 1.951 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.5500688552856445
Epoch: 13, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.623 Vali Acc: 0.346 Test Loss: 1.623 Test Acc: 0.346
Validation loss decreased (-0.296559 --> -0.345991).  Saving model ...
Epoch: 14 cost time: 5.774834156036377
Epoch: 14, Steps: 17 | Train Loss: 0.937 Vali Loss: 1.737 Vali Acc: 0.327 Test Loss: 1.737 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.156438589096069
Epoch: 15, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.867 Vali Acc: 0.357 Test Loss: 1.867 Test Acc: 0.357
Validation loss decreased (-0.345991 --> -0.357396).  Saving model ...
Epoch: 16 cost time: 5.623438358306885
Epoch: 16, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.033 Vali Acc: 0.319 Test Loss: 2.033 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 6.28578782081604
Epoch: 17, Steps: 17 | Train Loss: 0.862 Vali Loss: 2.658 Vali Acc: 0.289 Test Loss: 2.658 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.88748025894165
Epoch: 18, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.154 Vali Acc: 0.323 Test Loss: 2.154 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.357872486114502
Epoch: 19, Steps: 17 | Train Loss: 0.776 Vali Loss: 2.151 Vali Acc: 0.319 Test Loss: 2.151 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.42392635345459
Epoch: 20, Steps: 17 | Train Loss: 0.673 Vali Loss: 1.895 Vali Acc: 0.361 Test Loss: 1.895 Test Acc: 0.361
Validation loss decreased (-0.357396 --> -0.361198).  Saving model ...
Epoch: 21 cost time: 5.899004220962524
Epoch: 21, Steps: 17 | Train Loss: 0.883 Vali Loss: 2.387 Vali Acc: 0.357 Test Loss: 2.387 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.216531038284302
Epoch: 22, Steps: 17 | Train Loss: 0.775 Vali Loss: 1.961 Vali Acc: 0.335 Test Loss: 1.961 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.585516452789307
Epoch: 23, Steps: 17 | Train Loss: 0.764 Vali Loss: 2.423 Vali Acc: 0.308 Test Loss: 2.423 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.065998554229736
Epoch: 24, Steps: 17 | Train Loss: 0.605 Vali Loss: 2.436 Vali Acc: 0.327 Test Loss: 2.436 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.949010610580444
Epoch: 25, Steps: 17 | Train Loss: 0.633 Vali Loss: 2.197 Vali Acc: 0.304 Test Loss: 2.197 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.283454656600952
Epoch: 26, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.546 Vali Acc: 0.304 Test Loss: 2.546 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.158053159713745
Epoch: 27, Steps: 17 | Train Loss: 0.593 Vali Loss: 2.487 Vali Acc: 0.304 Test Loss: 2.487 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.036770343780518
Epoch: 28, Steps: 17 | Train Loss: 0.500 Vali Loss: 2.249 Vali Acc: 0.293 Test Loss: 2.249 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.943269729614258
Epoch: 29, Steps: 17 | Train Loss: 0.646 Vali Loss: 2.702 Vali Acc: 0.365 Test Loss: 2.702 Test Acc: 0.365
Validation loss decreased (-0.361198 --> -0.364992).  Saving model ...
Epoch: 30 cost time: 6.361836910247803
Epoch: 30, Steps: 17 | Train Loss: 0.597 Vali Loss: 2.969 Vali Acc: 0.335 Test Loss: 2.969 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 6.260451316833496
Epoch: 31, Steps: 17 | Train Loss: 0.607 Vali Loss: 2.772 Vali Acc: 0.361 Test Loss: 2.772 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 6.256449222564697
Epoch: 32, Steps: 17 | Train Loss: 0.504 Vali Loss: 2.859 Vali Acc: 0.308 Test Loss: 2.859 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.193008661270142
Epoch: 33, Steps: 17 | Train Loss: 0.432 Vali Loss: 2.671 Vali Acc: 0.297 Test Loss: 2.671 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.3896613121032715
Epoch: 34, Steps: 17 | Train Loss: 0.399 Vali Loss: 3.366 Vali Acc: 0.350 Test Loss: 3.366 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.221499919891357
Epoch: 35, Steps: 17 | Train Loss: 0.633 Vali Loss: 3.292 Vali Acc: 0.266 Test Loss: 3.292 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 6.010240077972412
Epoch: 36, Steps: 17 | Train Loss: 0.574 Vali Loss: 2.520 Vali Acc: 0.361 Test Loss: 2.520 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 6.729494094848633
Epoch: 37, Steps: 17 | Train Loss: 0.492 Vali Loss: 4.939 Vali Acc: 0.304 Test Loss: 4.939 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.94660758972168
Epoch: 38, Steps: 17 | Train Loss: 0.914 Vali Loss: 4.292 Vali Acc: 0.255 Test Loss: 4.292 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 4.99045729637146
Epoch: 39, Steps: 17 | Train Loss: 0.687 Vali Loss: 3.358 Vali Acc: 0.327 Test Loss: 3.358 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3650190114068441
model parameter : 9734708
model size : 42.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.680347919464111
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.567 Vali Acc: 0.285 Test Loss: 1.567 Test Acc: 0.285
Validation loss decreased (inf --> -0.285155).  Saving model ...
Epoch: 2 cost time: 5.710405111312866
Epoch: 2, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.679 Vali Acc: 0.266 Test Loss: 1.679 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.247969388961792
Epoch: 3, Steps: 17 | Train Loss: 1.569 Vali Loss: 1.791 Vali Acc: 0.259 Test Loss: 1.791 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 6.757577896118164
Epoch: 4, Steps: 17 | Train Loss: 1.875 Vali Loss: 1.478 Vali Acc: 0.300 Test Loss: 1.478 Test Acc: 0.300
Validation loss decreased (-0.285155 --> -0.300365).  Saving model ...
Epoch: 5 cost time: 6.32458758354187
Epoch: 5, Steps: 17 | Train Loss: 1.507 Vali Loss: 2.504 Vali Acc: 0.266 Test Loss: 2.504 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.096869945526123
Epoch: 6, Steps: 17 | Train Loss: 1.604 Vali Loss: 1.452 Vali Acc: 0.319 Test Loss: 1.452 Test Acc: 0.319
Validation loss decreased (-0.300365 --> -0.319377).  Saving model ...
Epoch: 7 cost time: 5.79829740524292
Epoch: 7, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.518 Vali Acc: 0.312 Test Loss: 1.518 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.040194988250732
Epoch: 8, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.910 Vali Acc: 0.278 Test Loss: 1.910 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.318284511566162
Epoch: 9, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.671 Vali Acc: 0.316 Test Loss: 1.671 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.730066299438477
Epoch: 10, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.669 Vali Acc: 0.262 Test Loss: 1.669 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.908248424530029
Epoch: 11, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.759 Vali Acc: 0.323 Test Loss: 1.759 Test Acc: 0.323
Validation loss decreased (-0.319377 --> -0.323176).  Saving model ...
Epoch: 12 cost time: 5.9711620807647705
Epoch: 12, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.781 Vali Acc: 0.308 Test Loss: 1.781 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.872723579406738
Epoch: 13, Steps: 17 | Train Loss: 1.169 Vali Loss: 2.066 Vali Acc: 0.335 Test Loss: 2.066 Test Acc: 0.335
Validation loss decreased (-0.323176 --> -0.334580).  Saving model ...
Epoch: 14 cost time: 6.401659965515137
Epoch: 14, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.566 Vali Acc: 0.342 Test Loss: 1.566 Test Acc: 0.342
Validation loss decreased (-0.334580 --> -0.342190).  Saving model ...
Epoch: 15 cost time: 6.05352520942688
Epoch: 15, Steps: 17 | Train Loss: 0.894 Vali Loss: 2.199 Vali Acc: 0.342 Test Loss: 2.199 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.873931407928467
Epoch: 16, Steps: 17 | Train Loss: 1.104 Vali Loss: 2.667 Vali Acc: 0.266 Test Loss: 2.667 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.994388818740845
Epoch: 17, Steps: 17 | Train Loss: 0.880 Vali Loss: 2.090 Vali Acc: 0.342 Test Loss: 2.090 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.086637735366821
Epoch: 18, Steps: 17 | Train Loss: 0.810 Vali Loss: 2.048 Vali Acc: 0.323 Test Loss: 2.048 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.011476993560791
Epoch: 19, Steps: 17 | Train Loss: 0.948 Vali Loss: 2.060 Vali Acc: 0.361 Test Loss: 2.060 Test Acc: 0.361
Validation loss decreased (-0.342190 --> -0.361196).  Saving model ...
Epoch: 20 cost time: 4.808814764022827
Epoch: 20, Steps: 17 | Train Loss: 0.770 Vali Loss: 2.282 Vali Acc: 0.312 Test Loss: 2.282 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.328997850418091
Epoch: 21, Steps: 17 | Train Loss: 0.781 Vali Loss: 1.945 Vali Acc: 0.350 Test Loss: 1.945 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.697599411010742
Epoch: 22, Steps: 17 | Train Loss: 0.616 Vali Loss: 2.215 Vali Acc: 0.331 Test Loss: 2.215 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.407663583755493
Epoch: 23, Steps: 17 | Train Loss: 0.754 Vali Loss: 2.449 Vali Acc: 0.335 Test Loss: 2.449 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.0933356285095215
Epoch: 24, Steps: 17 | Train Loss: 0.658 Vali Loss: 2.193 Vali Acc: 0.319 Test Loss: 2.193 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.032011032104492
Epoch: 25, Steps: 17 | Train Loss: 0.576 Vali Loss: 2.179 Vali Acc: 0.350 Test Loss: 2.179 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.595033884048462
Epoch: 26, Steps: 17 | Train Loss: 0.473 Vali Loss: 2.189 Vali Acc: 0.312 Test Loss: 2.189 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 6.75891375541687
Epoch: 27, Steps: 17 | Train Loss: 0.515 Vali Loss: 2.835 Vali Acc: 0.357 Test Loss: 2.835 Test Acc: 0.357
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 6.232084512710571
Epoch: 28, Steps: 17 | Train Loss: 0.627 Vali Loss: 3.085 Vali Acc: 0.384 Test Loss: 3.085 Test Acc: 0.384
Validation loss decreased (-0.361196 --> -0.384000).  Saving model ...
Epoch: 29 cost time: 6.622726917266846
Epoch: 29, Steps: 17 | Train Loss: 0.790 Vali Loss: 2.529 Vali Acc: 0.335 Test Loss: 2.529 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.971695899963379
Epoch: 30, Steps: 17 | Train Loss: 0.470 Vali Loss: 3.580 Vali Acc: 0.304 Test Loss: 3.580 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.026576042175293
Epoch: 31, Steps: 17 | Train Loss: 0.672 Vali Loss: 2.984 Vali Acc: 0.354 Test Loss: 2.984 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.554799318313599
Epoch: 32, Steps: 17 | Train Loss: 0.713 Vali Loss: 3.585 Vali Acc: 0.327 Test Loss: 3.585 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 5.763652086257935
Epoch: 33, Steps: 17 | Train Loss: 0.978 Vali Loss: 2.640 Vali Acc: 0.316 Test Loss: 2.640 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 5.8971006870269775
Epoch: 34, Steps: 17 | Train Loss: 0.537 Vali Loss: 2.752 Vali Acc: 0.335 Test Loss: 2.752 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 5.796124219894409
Epoch: 35, Steps: 17 | Train Loss: 0.676 Vali Loss: 3.049 Vali Acc: 0.327 Test Loss: 3.049 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 6.066518306732178
Epoch: 36, Steps: 17 | Train Loss: 0.723 Vali Loss: 3.018 Vali Acc: 0.285 Test Loss: 3.018 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 6.028557538986206
Epoch: 37, Steps: 17 | Train Loss: 0.577 Vali Loss: 3.258 Vali Acc: 0.297 Test Loss: 3.258 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.919022798538208
Epoch: 38, Steps: 17 | Train Loss: 0.604 Vali Loss: 3.860 Vali Acc: 0.304 Test Loss: 3.860 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3840304182509506
model parameter : 9669172
model size : 41.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.36673903465271
Epoch: 1, Steps: 17 | Train Loss: 1.528 Vali Loss: 1.699 Vali Acc: 0.270 Test Loss: 1.699 Test Acc: 0.270
Validation loss decreased (inf --> -0.269945).  Saving model ...
Epoch: 2 cost time: 5.68710994720459
Epoch: 2, Steps: 17 | Train Loss: 1.499 Vali Loss: 2.025 Vali Acc: 0.251 Test Loss: 2.025 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.555476903915405
Epoch: 3, Steps: 17 | Train Loss: 1.882 Vali Loss: 1.541 Vali Acc: 0.274 Test Loss: 1.541 Test Acc: 0.274
Validation loss decreased (-0.269945 --> -0.273749).  Saving model ...
Epoch: 4 cost time: 4.4830241203308105
Epoch: 4, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.694 Vali Acc: 0.281 Test Loss: 1.694 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281352).  Saving model ...
Epoch: 5 cost time: 6.023224592208862
Epoch: 5, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.593 Vali Acc: 0.289 Test Loss: 1.593 Test Acc: 0.289
Validation loss decreased (-0.281352 --> -0.288957).  Saving model ...
Epoch: 6 cost time: 5.5377724170684814
Epoch: 6, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.792 Vali Acc: 0.243 Test Loss: 1.792 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.2871034145355225
Epoch: 7, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.815 Vali Acc: 0.308 Test Loss: 1.815 Test Acc: 0.308
Validation loss decreased (-0.288957 --> -0.307967).  Saving model ...
Epoch: 8 cost time: 5.1381614208221436
Epoch: 8, Steps: 17 | Train Loss: 1.458 Vali Loss: 2.105 Vali Acc: 0.243 Test Loss: 2.105 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.598381042480469
Epoch: 9, Steps: 17 | Train Loss: 1.452 Vali Loss: 2.016 Vali Acc: 0.247 Test Loss: 2.016 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.34022331237793
Epoch: 10, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.647 Vali Acc: 0.308 Test Loss: 1.647 Test Acc: 0.308
Validation loss decreased (-0.307967 --> -0.307968).  Saving model ...
Epoch: 11 cost time: 5.558424949645996
Epoch: 11, Steps: 17 | Train Loss: 1.041 Vali Loss: 2.673 Vali Acc: 0.255 Test Loss: 2.673 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.927041053771973
Epoch: 12, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.832 Vali Acc: 0.369 Test Loss: 1.832 Test Acc: 0.369
Validation loss decreased (-0.307968 --> -0.368803).  Saving model ...
Epoch: 13 cost time: 6.64020562171936
Epoch: 13, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.792 Vali Acc: 0.346 Test Loss: 1.792 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.499725580215454
Epoch: 14, Steps: 17 | Train Loss: 1.053 Vali Loss: 2.182 Vali Acc: 0.354 Test Loss: 2.182 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.073508262634277
Epoch: 15, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.946 Vali Acc: 0.350 Test Loss: 1.946 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.733640193939209
Epoch: 16, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.909 Vali Acc: 0.342 Test Loss: 1.909 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.812534332275391
Epoch: 17, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.241 Vali Acc: 0.316 Test Loss: 2.241 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.94317364692688
Epoch: 18, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.949 Vali Acc: 0.346 Test Loss: 1.949 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.4456946849823
Epoch: 19, Steps: 17 | Train Loss: 0.832 Vali Loss: 2.247 Vali Acc: 0.331 Test Loss: 2.247 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.034193992614746
Epoch: 20, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.082 Vali Acc: 0.297 Test Loss: 2.082 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 5.330369234085083
Epoch: 21, Steps: 17 | Train Loss: 0.788 Vali Loss: 2.076 Vali Acc: 0.422 Test Loss: 2.076 Test Acc: 0.422
Validation loss decreased (-0.368803 --> -0.422032).  Saving model ...
Epoch: 22 cost time: 6.171899318695068
Epoch: 22, Steps: 17 | Train Loss: 0.813 Vali Loss: 2.003 Vali Acc: 0.338 Test Loss: 2.003 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.970336675643921
Epoch: 23, Steps: 17 | Train Loss: 0.657 Vali Loss: 2.645 Vali Acc: 0.281 Test Loss: 2.645 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.552021265029907
Epoch: 24, Steps: 17 | Train Loss: 1.003 Vali Loss: 2.440 Vali Acc: 0.316 Test Loss: 2.440 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.941275358200073
Epoch: 25, Steps: 17 | Train Loss: 0.795 Vali Loss: 2.525 Vali Acc: 0.266 Test Loss: 2.525 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.0596842765808105
Epoch: 26, Steps: 17 | Train Loss: 0.693 Vali Loss: 3.900 Vali Acc: 0.308 Test Loss: 3.900 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.083112955093384
Epoch: 27, Steps: 17 | Train Loss: 0.976 Vali Loss: 2.457 Vali Acc: 0.323 Test Loss: 2.457 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.977672338485718
Epoch: 28, Steps: 17 | Train Loss: 0.718 Vali Loss: 2.292 Vali Acc: 0.384 Test Loss: 2.292 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.979936122894287
Epoch: 29, Steps: 17 | Train Loss: 0.539 Vali Loss: 3.109 Vali Acc: 0.327 Test Loss: 3.109 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.744584798812866
Epoch: 30, Steps: 17 | Train Loss: 0.654 Vali Loss: 3.477 Vali Acc: 0.304 Test Loss: 3.477 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.7037353515625
Epoch: 31, Steps: 17 | Train Loss: 0.935 Vali Loss: 2.255 Vali Acc: 0.304 Test Loss: 2.255 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4220532319391635
model parameter : 9603636
model size : 41.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.093590259552002
Epoch: 1, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.587 Vali Acc: 0.247 Test Loss: 1.587 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 4.124846458435059
Epoch: 2, Steps: 17 | Train Loss: 1.546 Vali Loss: 1.708 Vali Acc: 0.243 Test Loss: 1.708 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.269873857498169
Epoch: 3, Steps: 17 | Train Loss: 1.593 Vali Loss: 1.549 Vali Acc: 0.278 Test Loss: 1.549 Test Acc: 0.278
Validation loss decreased (-0.247132 --> -0.277551).  Saving model ...
Epoch: 4 cost time: 5.046100378036499
Epoch: 4, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.666 Vali Acc: 0.262 Test Loss: 1.666 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.482205152511597
Epoch: 5, Steps: 17 | Train Loss: 1.474 Vali Loss: 2.076 Vali Acc: 0.251 Test Loss: 2.076 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.250671625137329
Epoch: 6, Steps: 17 | Train Loss: 1.612 Vali Loss: 1.774 Vali Acc: 0.293 Test Loss: 1.774 Test Acc: 0.293
Validation loss decreased (-0.277551 --> -0.292758).  Saving model ...
Epoch: 7 cost time: 5.659623146057129
Epoch: 7, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.863 Vali Acc: 0.251 Test Loss: 1.863 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.3545989990234375
Epoch: 8, Steps: 17 | Train Loss: 1.552 Vali Loss: 2.775 Vali Acc: 0.255 Test Loss: 2.775 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.793349742889404
Epoch: 9, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.867 Vali Acc: 0.274 Test Loss: 1.867 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.962862968444824
Epoch: 10, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.557 Vali Acc: 0.327 Test Loss: 1.557 Test Acc: 0.327
Validation loss decreased (-0.292758 --> -0.326981).  Saving model ...
Epoch: 11 cost time: 3.9077162742614746
Epoch: 11, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.538 Vali Acc: 0.323 Test Loss: 1.538 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.430663108825684
Epoch: 12, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.564 Vali Acc: 0.304 Test Loss: 1.564 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.534428358078003
Epoch: 13, Steps: 17 | Train Loss: 0.991 Vali Loss: 2.011 Vali Acc: 0.285 Test Loss: 2.011 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.8855860233306885
Epoch: 14, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.731 Vali Acc: 0.335 Test Loss: 1.731 Test Acc: 0.335
Validation loss decreased (-0.326981 --> -0.334583).  Saving model ...
Epoch: 15 cost time: 4.586645841598511
Epoch: 15, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.967 Vali Acc: 0.304 Test Loss: 1.967 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.662312746047974
Epoch: 16, Steps: 17 | Train Loss: 0.883 Vali Loss: 2.282 Vali Acc: 0.304 Test Loss: 2.282 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.175365209579468
Epoch: 17, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.719 Vali Acc: 0.388 Test Loss: 1.719 Test Acc: 0.388
Validation loss decreased (-0.334583 --> -0.387816).  Saving model ...
Epoch: 18 cost time: 5.948615550994873
Epoch: 18, Steps: 17 | Train Loss: 0.794 Vali Loss: 2.363 Vali Acc: 0.300 Test Loss: 2.363 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.477051019668579
Epoch: 19, Steps: 17 | Train Loss: 1.029 Vali Loss: 2.642 Vali Acc: 0.316 Test Loss: 2.642 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.801704168319702
Epoch: 20, Steps: 17 | Train Loss: 0.795 Vali Loss: 1.912 Vali Acc: 0.308 Test Loss: 1.912 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.89965033531189
Epoch: 21, Steps: 17 | Train Loss: 0.747 Vali Loss: 2.269 Vali Acc: 0.293 Test Loss: 2.269 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.113762378692627
Epoch: 22, Steps: 17 | Train Loss: 0.784 Vali Loss: 2.151 Vali Acc: 0.354 Test Loss: 2.151 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.582517385482788
Epoch: 23, Steps: 17 | Train Loss: 0.748 Vali Loss: 2.490 Vali Acc: 0.331 Test Loss: 2.490 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.59430456161499
Epoch: 24, Steps: 17 | Train Loss: 0.770 Vali Loss: 2.275 Vali Acc: 0.319 Test Loss: 2.275 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.692297697067261
Epoch: 25, Steps: 17 | Train Loss: 0.608 Vali Loss: 2.398 Vali Acc: 0.338 Test Loss: 2.398 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.397660970687866
Epoch: 26, Steps: 17 | Train Loss: 0.661 Vali Loss: 2.221 Vali Acc: 0.392 Test Loss: 2.221 Test Acc: 0.392
Validation loss decreased (-0.387816 --> -0.391613).  Saving model ...
Epoch: 27 cost time: 5.3188347816467285
Epoch: 27, Steps: 17 | Train Loss: 0.476 Vali Loss: 3.113 Vali Acc: 0.331 Test Loss: 3.113 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.423366546630859
Epoch: 28, Steps: 17 | Train Loss: 0.682 Vali Loss: 2.543 Vali Acc: 0.354 Test Loss: 2.543 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.6116180419921875
Epoch: 29, Steps: 17 | Train Loss: 0.759 Vali Loss: 2.320 Vali Acc: 0.278 Test Loss: 2.320 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.6330406665802
Epoch: 30, Steps: 17 | Train Loss: 0.440 Vali Loss: 3.004 Vali Acc: 0.395 Test Loss: 3.004 Test Acc: 0.395
Validation loss decreased (-0.391613 --> -0.395407).  Saving model ...
Epoch: 31 cost time: 5.01429557800293
Epoch: 31, Steps: 17 | Train Loss: 0.724 Vali Loss: 3.065 Vali Acc: 0.285 Test Loss: 3.065 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 5.466374397277832
Epoch: 32, Steps: 17 | Train Loss: 0.441 Vali Loss: 2.971 Vali Acc: 0.342 Test Loss: 2.971 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 5.384518623352051
Epoch: 33, Steps: 17 | Train Loss: 0.468 Vali Loss: 2.750 Vali Acc: 0.304 Test Loss: 2.750 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.540064811706543
Epoch: 34, Steps: 17 | Train Loss: 0.380 Vali Loss: 3.755 Vali Acc: 0.338 Test Loss: 3.755 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.1942107677459717
Epoch: 35, Steps: 17 | Train Loss: 0.670 Vali Loss: 2.882 Vali Acc: 0.319 Test Loss: 2.882 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.10066556930542
Epoch: 36, Steps: 17 | Train Loss: 0.468 Vali Loss: 2.917 Vali Acc: 0.331 Test Loss: 2.917 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 4.9359705448150635
Epoch: 37, Steps: 17 | Train Loss: 0.504 Vali Loss: 3.519 Vali Acc: 0.323 Test Loss: 3.519 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 4.826128244400024
Epoch: 38, Steps: 17 | Train Loss: 0.601 Vali Loss: 3.141 Vali Acc: 0.308 Test Loss: 3.141 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 5.3111960887908936
Epoch: 39, Steps: 17 | Train Loss: 0.501 Vali Loss: 3.089 Vali Acc: 0.323 Test Loss: 3.089 Test Acc: 0.323
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 5.205772399902344
Epoch: 40, Steps: 17 | Train Loss: 0.352 Vali Loss: 3.466 Vali Acc: 0.350 Test Loss: 3.466 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.39543726235741444
model parameter : 9538100
model size : 41.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.154778242111206
Epoch: 1, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.767 Vali Acc: 0.247 Test Loss: 1.767 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 4.297262191772461
Epoch: 2, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.563 Vali Acc: 0.259 Test Loss: 1.563 Test Acc: 0.259
Validation loss decreased (-0.247131 --> -0.258539).  Saving model ...
Epoch: 3 cost time: 4.259770631790161
Epoch: 3, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.729 Vali Acc: 0.259 Test Loss: 1.729 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.442692279815674
Epoch: 4, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.645 Vali Acc: 0.270 Test Loss: 1.645 Test Acc: 0.270
Validation loss decreased (-0.258539 --> -0.269946).  Saving model ...
Epoch: 5 cost time: 5.936244010925293
Epoch: 5, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.569 Vali Acc: 0.236 Test Loss: 1.569 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.094012975692749
Epoch: 6, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.979 Vali Acc: 0.346 Test Loss: 1.979 Test Acc: 0.346
Validation loss decreased (-0.269946 --> -0.345988).  Saving model ...
Epoch: 7 cost time: 5.985247373580933
Epoch: 7, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.442 Vali Acc: 0.338 Test Loss: 1.442 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.923978090286255
Epoch: 8, Steps: 17 | Train Loss: 1.250 Vali Loss: 2.316 Vali Acc: 0.278 Test Loss: 2.316 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.903196334838867
Epoch: 9, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.581 Vali Acc: 0.350 Test Loss: 1.581 Test Acc: 0.350
Validation loss decreased (-0.345988 --> -0.349794).  Saving model ...
Epoch: 10 cost time: 6.190180540084839
Epoch: 10, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.602 Vali Acc: 0.331 Test Loss: 1.602 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.774696350097656
Epoch: 11, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.677 Vali Acc: 0.323 Test Loss: 1.677 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.631527423858643
Epoch: 12, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.864 Vali Acc: 0.335 Test Loss: 1.864 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.395000219345093
Epoch: 13, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.237 Vali Acc: 0.323 Test Loss: 2.237 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.584327459335327
Epoch: 14, Steps: 17 | Train Loss: 1.096 Vali Loss: 2.639 Vali Acc: 0.262 Test Loss: 2.639 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.513624906539917
Epoch: 15, Steps: 17 | Train Loss: 1.182 Vali Loss: 2.079 Vali Acc: 0.357 Test Loss: 2.079 Test Acc: 0.357
Validation loss decreased (-0.349794 --> -0.357394).  Saving model ...
Epoch: 16 cost time: 5.654858350753784
Epoch: 16, Steps: 17 | Train Loss: 0.986 Vali Loss: 1.991 Vali Acc: 0.312 Test Loss: 1.991 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.133422136306763
Epoch: 17, Steps: 17 | Train Loss: 0.898 Vali Loss: 2.143 Vali Acc: 0.338 Test Loss: 2.143 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.40131402015686
Epoch: 18, Steps: 17 | Train Loss: 1.010 Vali Loss: 2.466 Vali Acc: 0.319 Test Loss: 2.466 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.394260883331299
Epoch: 19, Steps: 17 | Train Loss: 0.965 Vali Loss: 2.310 Vali Acc: 0.308 Test Loss: 2.310 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.500071048736572
Epoch: 20, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.492 Vali Acc: 0.316 Test Loss: 2.492 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.026788234710693
Epoch: 21, Steps: 17 | Train Loss: 0.905 Vali Loss: 1.963 Vali Acc: 0.300 Test Loss: 1.963 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.6749372482299805
Epoch: 22, Steps: 17 | Train Loss: 0.762 Vali Loss: 2.319 Vali Acc: 0.357 Test Loss: 2.319 Test Acc: 0.357
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.813783407211304
Epoch: 23, Steps: 17 | Train Loss: 0.673 Vali Loss: 2.179 Vali Acc: 0.319 Test Loss: 2.179 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.335690259933472
Epoch: 24, Steps: 17 | Train Loss: 0.709 Vali Loss: 2.307 Vali Acc: 0.342 Test Loss: 2.307 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.963438510894775
Epoch: 25, Steps: 17 | Train Loss: 0.726 Vali Loss: 2.280 Vali Acc: 0.384 Test Loss: 2.280 Test Acc: 0.384
Validation loss decreased (-0.357394 --> -0.384008).  Saving model ...
Epoch: 26 cost time: 5.657878875732422
Epoch: 26, Steps: 17 | Train Loss: 0.571 Vali Loss: 3.023 Vali Acc: 0.342 Test Loss: 3.023 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.48932147026062
Epoch: 27, Steps: 17 | Train Loss: 0.762 Vali Loss: 2.341 Vali Acc: 0.369 Test Loss: 2.341 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.680512189865112
Epoch: 28, Steps: 17 | Train Loss: 0.506 Vali Loss: 2.824 Vali Acc: 0.346 Test Loss: 2.824 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 6.049138784408569
Epoch: 29, Steps: 17 | Train Loss: 0.587 Vali Loss: 2.533 Vali Acc: 0.350 Test Loss: 2.533 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 6.189571857452393
Epoch: 30, Steps: 17 | Train Loss: 0.677 Vali Loss: 2.448 Vali Acc: 0.346 Test Loss: 2.448 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 6.033000707626343
Epoch: 31, Steps: 17 | Train Loss: 0.539 Vali Loss: 3.011 Vali Acc: 0.308 Test Loss: 3.011 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 6.176446199417114
Epoch: 32, Steps: 17 | Train Loss: 0.518 Vali Loss: 3.284 Vali Acc: 0.338 Test Loss: 3.284 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 5.388318061828613
Epoch: 33, Steps: 17 | Train Loss: 0.503 Vali Loss: 2.966 Vali Acc: 0.350 Test Loss: 2.966 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 6.8924477100372314
Epoch: 34, Steps: 17 | Train Loss: 0.538 Vali Loss: 2.857 Vali Acc: 0.327 Test Loss: 2.857 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 6.33600640296936
Epoch: 35, Steps: 17 | Train Loss: 0.591 Vali Loss: 3.210 Vali Acc: 0.312 Test Loss: 3.210 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3840304182509506
model parameter : 8815412
model size : 38.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.73548698425293
Epoch: 1, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.515 Vali Acc: 0.278 Test Loss: 1.515 Test Acc: 0.278
Validation loss decreased (inf --> -0.277551).  Saving model ...
Epoch: 2 cost time: 5.236260890960693
Epoch: 2, Steps: 17 | Train Loss: 1.593 Vali Loss: 1.707 Vali Acc: 0.255 Test Loss: 1.707 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.075834512710571
Epoch: 3, Steps: 17 | Train Loss: 1.773 Vali Loss: 1.826 Vali Acc: 0.255 Test Loss: 1.826 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.9601263999938965
Epoch: 4, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.551 Vali Acc: 0.270 Test Loss: 1.551 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 6.623692750930786
Epoch: 5, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.918 Vali Acc: 0.240 Test Loss: 1.918 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 6.2134850025177
Epoch: 6, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.800 Vali Acc: 0.251 Test Loss: 1.800 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 6.28964638710022
Epoch: 7, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.847 Vali Acc: 0.255 Test Loss: 1.847 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 5.019035577774048
Epoch: 8, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.570 Vali Acc: 0.297 Test Loss: 1.570 Test Acc: 0.297
Validation loss decreased (-0.277551 --> -0.296562).  Saving model ...
Epoch: 9 cost time: 5.108858823776245
Epoch: 9, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.917 Vali Acc: 0.285 Test Loss: 1.917 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.0004355907440186
Epoch: 10, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.890 Vali Acc: 0.316 Test Loss: 1.890 Test Acc: 0.316
Validation loss decreased (-0.296562 --> -0.315570).  Saving model ...
Epoch: 11 cost time: 5.672555208206177
Epoch: 11, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.751 Vali Acc: 0.335 Test Loss: 1.751 Test Acc: 0.335
Validation loss decreased (-0.315570 --> -0.334583).  Saving model ...
Epoch: 12 cost time: 6.302642345428467
Epoch: 12, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.688 Vali Acc: 0.308 Test Loss: 1.688 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.546111106872559
Epoch: 13, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.834 Vali Acc: 0.316 Test Loss: 1.834 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.344726324081421
Epoch: 14, Steps: 17 | Train Loss: 1.178 Vali Loss: 2.011 Vali Acc: 0.323 Test Loss: 2.011 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.399183511734009
Epoch: 15, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.764 Vali Acc: 0.308 Test Loss: 1.764 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.759516954421997
Epoch: 16, Steps: 17 | Train Loss: 0.937 Vali Loss: 2.167 Vali Acc: 0.300 Test Loss: 2.167 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.184900522232056
Epoch: 17, Steps: 17 | Train Loss: 0.767 Vali Loss: 1.799 Vali Acc: 0.335 Test Loss: 1.799 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.654526710510254
Epoch: 18, Steps: 17 | Train Loss: 0.832 Vali Loss: 2.166 Vali Acc: 0.346 Test Loss: 2.166 Test Acc: 0.346
Validation loss decreased (-0.334583 --> -0.345986).  Saving model ...
Epoch: 19 cost time: 6.144826412200928
Epoch: 19, Steps: 17 | Train Loss: 0.917 Vali Loss: 2.878 Vali Acc: 0.297 Test Loss: 2.878 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.891631364822388
Epoch: 20, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.998 Vali Acc: 0.342 Test Loss: 1.998 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.558710098266602
Epoch: 21, Steps: 17 | Train Loss: 0.818 Vali Loss: 2.510 Vali Acc: 0.342 Test Loss: 2.510 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.946997165679932
Epoch: 22, Steps: 17 | Train Loss: 0.821 Vali Loss: 2.398 Vali Acc: 0.319 Test Loss: 2.398 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.251732349395752
Epoch: 23, Steps: 17 | Train Loss: 0.756 Vali Loss: 2.254 Vali Acc: 0.335 Test Loss: 2.254 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.917023420333862
Epoch: 24, Steps: 17 | Train Loss: 0.640 Vali Loss: 2.596 Vali Acc: 0.300 Test Loss: 2.596 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.836455821990967
Epoch: 25, Steps: 17 | Train Loss: 0.687 Vali Loss: 2.282 Vali Acc: 0.327 Test Loss: 2.282 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.11857795715332
Epoch: 26, Steps: 17 | Train Loss: 0.671 Vali Loss: 2.415 Vali Acc: 0.365 Test Loss: 2.415 Test Acc: 0.365
Validation loss decreased (-0.345986 --> -0.364995).  Saving model ...
Epoch: 27 cost time: 6.45409369468689
Epoch: 27, Steps: 17 | Train Loss: 0.444 Vali Loss: 2.376 Vali Acc: 0.319 Test Loss: 2.376 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.405097484588623
Epoch: 28, Steps: 17 | Train Loss: 0.675 Vali Loss: 2.690 Vali Acc: 0.319 Test Loss: 2.690 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.535621643066406
Epoch: 29, Steps: 17 | Train Loss: 0.494 Vali Loss: 3.114 Vali Acc: 0.369 Test Loss: 3.114 Test Acc: 0.369
Validation loss decreased (-0.364995 --> -0.368790).  Saving model ...
Epoch: 30 cost time: 4.828444957733154
Epoch: 30, Steps: 17 | Train Loss: 0.634 Vali Loss: 3.259 Vali Acc: 0.293 Test Loss: 3.259 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.249857425689697
Epoch: 31, Steps: 17 | Train Loss: 0.391 Vali Loss: 3.089 Vali Acc: 0.331 Test Loss: 3.089 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.642693281173706
Epoch: 32, Steps: 17 | Train Loss: 0.488 Vali Loss: 2.870 Vali Acc: 0.331 Test Loss: 2.870 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.721306800842285
Epoch: 33, Steps: 17 | Train Loss: 0.567 Vali Loss: 3.389 Vali Acc: 0.384 Test Loss: 3.389 Test Acc: 0.384
Validation loss decreased (-0.368790 --> -0.383997).  Saving model ...
Epoch: 34 cost time: 5.42173171043396
Epoch: 34, Steps: 17 | Train Loss: 0.502 Vali Loss: 2.847 Vali Acc: 0.335 Test Loss: 2.847 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 5.924109220504761
Epoch: 35, Steps: 17 | Train Loss: 0.507 Vali Loss: 3.672 Vali Acc: 0.293 Test Loss: 3.672 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.750597238540649
Epoch: 36, Steps: 17 | Train Loss: 0.638 Vali Loss: 3.040 Vali Acc: 0.308 Test Loss: 3.040 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 6.237871408462524
Epoch: 37, Steps: 17 | Train Loss: 0.687 Vali Loss: 4.032 Vali Acc: 0.281 Test Loss: 4.032 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 6.245215892791748
Epoch: 38, Steps: 17 | Train Loss: 0.548 Vali Loss: 3.653 Vali Acc: 0.278 Test Loss: 3.653 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 6.0666491985321045
Epoch: 39, Steps: 17 | Train Loss: 0.333 Vali Loss: 4.092 Vali Acc: 0.346 Test Loss: 4.092 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 6.750680685043335
Epoch: 40, Steps: 17 | Train Loss: 0.366 Vali Loss: 4.267 Vali Acc: 0.312 Test Loss: 4.267 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 5.963763952255249
Epoch: 41, Steps: 17 | Train Loss: 0.635 Vali Loss: 3.598 Vali Acc: 0.373 Test Loss: 3.598 Test Acc: 0.373
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 6.0580360889434814
Epoch: 42, Steps: 17 | Train Loss: 0.556 Vali Loss: 3.580 Vali Acc: 0.293 Test Loss: 3.580 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 5.6723387241363525
Epoch: 43, Steps: 17 | Train Loss: 0.583 Vali Loss: 3.285 Vali Acc: 0.300 Test Loss: 3.285 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3840304182509506
model parameter : 8749876
model size : 38.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.723588705062866
Epoch: 1, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.598 Vali Acc: 0.251 Test Loss: 1.598 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 4.815083026885986
Epoch: 2, Steps: 17 | Train Loss: 1.611 Vali Loss: 1.727 Vali Acc: 0.274 Test Loss: 1.727 Test Acc: 0.274
Validation loss decreased (-0.250935 --> -0.273747).  Saving model ...
Epoch: 3 cost time: 5.235446929931641
Epoch: 3, Steps: 17 | Train Loss: 1.689 Vali Loss: 1.897 Vali Acc: 0.240 Test Loss: 1.897 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.629737854003906
Epoch: 4, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.476 Vali Acc: 0.266 Test Loss: 1.476 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.538336515426636
Epoch: 5, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.652 Vali Acc: 0.308 Test Loss: 1.652 Test Acc: 0.308
Validation loss decreased (-0.273747 --> -0.307968).  Saving model ...
Epoch: 6 cost time: 5.597851276397705
Epoch: 6, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.594 Vali Acc: 0.259 Test Loss: 1.594 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.6092753410339355
Epoch: 7, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.485 Vali Acc: 0.342 Test Loss: 1.485 Test Acc: 0.342
Validation loss decreased (-0.307968 --> -0.342190).  Saving model ...
Epoch: 8 cost time: 5.576425552368164
Epoch: 8, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.653 Vali Acc: 0.308 Test Loss: 1.653 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.366164445877075
Epoch: 9, Steps: 17 | Train Loss: 1.580 Vali Loss: 1.868 Vali Acc: 0.289 Test Loss: 1.868 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.026840925216675
Epoch: 10, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.624 Vali Acc: 0.342 Test Loss: 1.624 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.089970111846924
Epoch: 11, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.732 Vali Acc: 0.331 Test Loss: 1.732 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.047255516052246
Epoch: 12, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.938 Vali Acc: 0.300 Test Loss: 1.938 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.821532249450684
Epoch: 13, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.801 Vali Acc: 0.300 Test Loss: 1.801 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.523643732070923
Epoch: 14, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.774 Vali Acc: 0.346 Test Loss: 1.774 Test Acc: 0.346
Validation loss decreased (-0.342190 --> -0.345990).  Saving model ...
Epoch: 15 cost time: 5.545330762863159
Epoch: 15, Steps: 17 | Train Loss: 0.915 Vali Loss: 2.034 Vali Acc: 0.327 Test Loss: 2.034 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.405344009399414
Epoch: 16, Steps: 17 | Train Loss: 0.764 Vali Loss: 2.188 Vali Acc: 0.262 Test Loss: 2.188 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.708763122558594
Epoch: 17, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.916 Vali Acc: 0.357 Test Loss: 1.916 Test Acc: 0.357
Validation loss decreased (-0.345990 --> -0.357395).  Saving model ...
Epoch: 18 cost time: 5.406283617019653
Epoch: 18, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.242 Vali Acc: 0.335 Test Loss: 2.242 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.781595945358276
Epoch: 19, Steps: 17 | Train Loss: 0.809 Vali Loss: 2.225 Vali Acc: 0.361 Test Loss: 2.225 Test Acc: 0.361
Validation loss decreased (-0.357395 --> -0.361194).  Saving model ...
Epoch: 20 cost time: 5.493169546127319
Epoch: 20, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.800 Vali Acc: 0.369 Test Loss: 1.800 Test Acc: 0.369
Validation loss decreased (-0.361194 --> -0.368803).  Saving model ...
Epoch: 21 cost time: 5.316354274749756
Epoch: 21, Steps: 17 | Train Loss: 0.706 Vali Loss: 1.790 Vali Acc: 0.369 Test Loss: 1.790 Test Acc: 0.369
Validation loss decreased (-0.368803 --> -0.368803).  Saving model ...
Epoch: 22 cost time: 6.725381851196289
Epoch: 22, Steps: 17 | Train Loss: 0.623 Vali Loss: 2.282 Vali Acc: 0.350 Test Loss: 2.282 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.845287561416626
Epoch: 23, Steps: 17 | Train Loss: 0.677 Vali Loss: 2.238 Vali Acc: 0.323 Test Loss: 2.238 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.099339246749878
Epoch: 24, Steps: 17 | Train Loss: 0.639 Vali Loss: 2.401 Vali Acc: 0.354 Test Loss: 2.401 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.104075193405151
Epoch: 25, Steps: 17 | Train Loss: 0.581 Vali Loss: 2.872 Vali Acc: 0.300 Test Loss: 2.872 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 6.002893924713135
Epoch: 26, Steps: 17 | Train Loss: 0.806 Vali Loss: 2.122 Vali Acc: 0.361 Test Loss: 2.122 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 6.424806118011475
Epoch: 27, Steps: 17 | Train Loss: 0.454 Vali Loss: 2.565 Vali Acc: 0.300 Test Loss: 2.565 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.753946542739868
Epoch: 28, Steps: 17 | Train Loss: 0.646 Vali Loss: 3.170 Vali Acc: 0.342 Test Loss: 3.170 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.782799243927002
Epoch: 29, Steps: 17 | Train Loss: 0.600 Vali Loss: 3.154 Vali Acc: 0.300 Test Loss: 3.154 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.071945428848267
Epoch: 30, Steps: 17 | Train Loss: 0.680 Vali Loss: 2.852 Vali Acc: 0.338 Test Loss: 2.852 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 6.493115425109863
Epoch: 31, Steps: 17 | Train Loss: 0.439 Vali Loss: 3.146 Vali Acc: 0.365 Test Loss: 3.146 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3688212927756654
model parameter : 8684340
model size : 38.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.291107654571533
Epoch: 1, Steps: 17 | Train Loss: 1.648 Vali Loss: 1.699 Vali Acc: 0.243 Test Loss: 1.699 Test Acc: 0.243
Validation loss decreased (inf --> -0.243329).  Saving model ...
Epoch: 2 cost time: 5.557051658630371
Epoch: 2, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.800 Vali Acc: 0.274 Test Loss: 1.800 Test Acc: 0.274
Validation loss decreased (-0.243329 --> -0.273746).  Saving model ...
Epoch: 3 cost time: 5.804332256317139
Epoch: 3, Steps: 17 | Train Loss: 1.666 Vali Loss: 1.703 Vali Acc: 0.270 Test Loss: 1.703 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.25631308555603
Epoch: 4, Steps: 17 | Train Loss: 1.926 Vali Loss: 2.224 Vali Acc: 0.251 Test Loss: 2.224 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.825896501541138
Epoch: 5, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.901 Vali Acc: 0.270 Test Loss: 1.901 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.022821664810181
Epoch: 6, Steps: 17 | Train Loss: 1.463 Vali Loss: 2.102 Vali Acc: 0.243 Test Loss: 2.102 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.952003002166748
Epoch: 7, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.547 Vali Acc: 0.270 Test Loss: 1.547 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.342738389968872
Epoch: 8, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.782 Vali Acc: 0.285 Test Loss: 1.782 Test Acc: 0.285
Validation loss decreased (-0.273746 --> -0.285153).  Saving model ...
Epoch: 9 cost time: 4.738595008850098
Epoch: 9, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.578 Vali Acc: 0.319 Test Loss: 1.578 Test Acc: 0.319
Validation loss decreased (-0.285153 --> -0.319376).  Saving model ...
Epoch: 10 cost time: 5.495589971542358
Epoch: 10, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.861 Vali Acc: 0.266 Test Loss: 1.861 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.38424015045166
Epoch: 11, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.556 Vali Acc: 0.342 Test Loss: 1.556 Test Acc: 0.342
Validation loss decreased (-0.319376 --> -0.342190).  Saving model ...
Epoch: 12 cost time: 5.225866794586182
Epoch: 12, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.665 Vali Acc: 0.323 Test Loss: 1.665 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.713586807250977
Epoch: 13, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.965 Vali Acc: 0.281 Test Loss: 1.965 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.560512065887451
Epoch: 14, Steps: 17 | Train Loss: 1.017 Vali Loss: 1.965 Vali Acc: 0.350 Test Loss: 1.965 Test Acc: 0.350
Validation loss decreased (-0.342190 --> -0.349790).  Saving model ...
Epoch: 15 cost time: 5.6180503368377686
Epoch: 15, Steps: 17 | Train Loss: 0.993 Vali Loss: 2.029 Vali Acc: 0.278 Test Loss: 2.029 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.317147970199585
Epoch: 16, Steps: 17 | Train Loss: 0.811 Vali Loss: 1.986 Vali Acc: 0.350 Test Loss: 1.986 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.690971851348877
Epoch: 17, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.864 Vali Acc: 0.354 Test Loss: 1.864 Test Acc: 0.354
Validation loss decreased (-0.349790 --> -0.353594).  Saving model ...
Epoch: 18 cost time: 5.483153581619263
Epoch: 18, Steps: 17 | Train Loss: 0.830 Vali Loss: 2.321 Vali Acc: 0.342 Test Loss: 2.321 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.1914544105529785
Epoch: 19, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.827 Vali Acc: 0.357 Test Loss: 1.827 Test Acc: 0.357
Validation loss decreased (-0.353594 --> -0.357396).  Saving model ...
Epoch: 20 cost time: 5.0234692096710205
Epoch: 20, Steps: 17 | Train Loss: 0.792 Vali Loss: 2.538 Vali Acc: 0.327 Test Loss: 2.538 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.427981376647949
Epoch: 21, Steps: 17 | Train Loss: 0.679 Vali Loss: 1.978 Vali Acc: 0.312 Test Loss: 1.978 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.798445224761963
Epoch: 22, Steps: 17 | Train Loss: 0.912 Vali Loss: 2.167 Vali Acc: 0.327 Test Loss: 2.167 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.16411280632019
Epoch: 23, Steps: 17 | Train Loss: 0.641 Vali Loss: 2.617 Vali Acc: 0.300 Test Loss: 2.617 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.772979497909546
Epoch: 24, Steps: 17 | Train Loss: 0.584 Vali Loss: 2.380 Vali Acc: 0.365 Test Loss: 2.380 Test Acc: 0.365
Validation loss decreased (-0.357396 --> -0.364995).  Saving model ...
Epoch: 25 cost time: 5.208934307098389
Epoch: 25, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.827 Vali Acc: 0.308 Test Loss: 2.827 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.847186088562012
Epoch: 26, Steps: 17 | Train Loss: 0.841 Vali Loss: 2.891 Vali Acc: 0.289 Test Loss: 2.891 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.098714590072632
Epoch: 27, Steps: 17 | Train Loss: 0.666 Vali Loss: 2.895 Vali Acc: 0.270 Test Loss: 2.895 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.822457790374756
Epoch: 28, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.841 Vali Acc: 0.319 Test Loss: 2.841 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.983405590057373
Epoch: 29, Steps: 17 | Train Loss: 0.603 Vali Loss: 2.658 Vali Acc: 0.304 Test Loss: 2.658 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.670300483703613
Epoch: 30, Steps: 17 | Train Loss: 0.613 Vali Loss: 2.750 Vali Acc: 0.304 Test Loss: 2.750 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.7208921909332275
Epoch: 31, Steps: 17 | Train Loss: 0.531 Vali Loss: 3.019 Vali Acc: 0.304 Test Loss: 3.019 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.68397068977356
Epoch: 32, Steps: 17 | Train Loss: 0.503 Vali Loss: 3.358 Vali Acc: 0.270 Test Loss: 3.358 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.251647233963013
Epoch: 33, Steps: 17 | Train Loss: 0.606 Vali Loss: 2.821 Vali Acc: 0.319 Test Loss: 2.821 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.081562280654907
Epoch: 34, Steps: 17 | Train Loss: 0.552 Vali Loss: 2.823 Vali Acc: 0.300 Test Loss: 2.823 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3650190114068441
model parameter : 8618804
model size : 37.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.990991115570068
Epoch: 1, Steps: 17 | Train Loss: 1.608 Vali Loss: 1.894 Vali Acc: 0.270 Test Loss: 1.894 Test Acc: 0.270
Validation loss decreased (inf --> -0.269943).  Saving model ...
Epoch: 2 cost time: 4.862599849700928
Epoch: 2, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.930 Vali Acc: 0.255 Test Loss: 1.930 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.508529901504517
Epoch: 3, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.882 Vali Acc: 0.251 Test Loss: 1.882 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 5.62813401222229
Epoch: 4, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.591 Vali Acc: 0.259 Test Loss: 1.591 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.288761138916016
Epoch: 5, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.710 Vali Acc: 0.266 Test Loss: 1.710 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.742569208145142
Epoch: 6, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.552 Vali Acc: 0.300 Test Loss: 1.552 Test Acc: 0.300
Validation loss decreased (-0.269943 --> -0.300365).  Saving model ...
Epoch: 7 cost time: 5.6947386264801025
Epoch: 7, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.871 Vali Acc: 0.323 Test Loss: 1.871 Test Acc: 0.323
Validation loss decreased (-0.300365 --> -0.323175).  Saving model ...
Epoch: 8 cost time: 5.376816034317017
Epoch: 8, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.689 Vali Acc: 0.270 Test Loss: 1.689 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.2457356452941895
Epoch: 9, Steps: 17 | Train Loss: 1.253 Vali Loss: 2.032 Vali Acc: 0.251 Test Loss: 2.032 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.046718120574951
Epoch: 10, Steps: 17 | Train Loss: 1.148 Vali Loss: 2.196 Vali Acc: 0.274 Test Loss: 2.196 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.3708086013793945
Epoch: 11, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.807 Vali Acc: 0.346 Test Loss: 1.807 Test Acc: 0.346
Validation loss decreased (-0.323175 --> -0.345990).  Saving model ...
Epoch: 12 cost time: 4.787498950958252
Epoch: 12, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.611 Vali Acc: 0.338 Test Loss: 1.611 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.452643632888794
Epoch: 13, Steps: 17 | Train Loss: 1.055 Vali Loss: 2.089 Vali Acc: 0.281 Test Loss: 2.089 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.878960847854614
Epoch: 14, Steps: 17 | Train Loss: 0.992 Vali Loss: 1.725 Vali Acc: 0.331 Test Loss: 1.725 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.197128772735596
Epoch: 15, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.969 Vali Acc: 0.365 Test Loss: 1.969 Test Acc: 0.365
Validation loss decreased (-0.345990 --> -0.364999).  Saving model ...
Epoch: 16 cost time: 5.547145366668701
Epoch: 16, Steps: 17 | Train Loss: 0.992 Vali Loss: 1.847 Vali Acc: 0.335 Test Loss: 1.847 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.42254900932312
Epoch: 17, Steps: 17 | Train Loss: 1.078 Vali Loss: 2.033 Vali Acc: 0.300 Test Loss: 2.033 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.933020830154419
Epoch: 18, Steps: 17 | Train Loss: 1.029 Vali Loss: 3.039 Vali Acc: 0.270 Test Loss: 3.039 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.117737054824829
Epoch: 19, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.620 Vali Acc: 0.281 Test Loss: 2.620 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.214728593826294
Epoch: 20, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.280 Vali Acc: 0.331 Test Loss: 2.280 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.171588897705078
Epoch: 21, Steps: 17 | Train Loss: 0.760 Vali Loss: 2.224 Vali Acc: 0.335 Test Loss: 2.224 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.464209794998169
Epoch: 22, Steps: 17 | Train Loss: 0.745 Vali Loss: 1.977 Vali Acc: 0.392 Test Loss: 1.977 Test Acc: 0.392
Validation loss decreased (-0.364999 --> -0.391615).  Saving model ...
Epoch: 23 cost time: 5.37841272354126
Epoch: 23, Steps: 17 | Train Loss: 0.761 Vali Loss: 2.519 Vali Acc: 0.376 Test Loss: 2.519 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.488874197006226
Epoch: 24, Steps: 17 | Train Loss: 0.738 Vali Loss: 2.591 Vali Acc: 0.319 Test Loss: 2.591 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.890444993972778
Epoch: 25, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.734 Vali Acc: 0.369 Test Loss: 2.734 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.894122838973999
Epoch: 26, Steps: 17 | Train Loss: 0.638 Vali Loss: 3.105 Vali Acc: 0.308 Test Loss: 3.105 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.257967710494995
Epoch: 27, Steps: 17 | Train Loss: 0.661 Vali Loss: 2.417 Vali Acc: 0.354 Test Loss: 2.417 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.278284311294556
Epoch: 28, Steps: 17 | Train Loss: 0.670 Vali Loss: 2.641 Vali Acc: 0.342 Test Loss: 2.641 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.328974485397339
Epoch: 29, Steps: 17 | Train Loss: 0.849 Vali Loss: 2.286 Vali Acc: 0.357 Test Loss: 2.286 Test Acc: 0.357
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.422928094863892
Epoch: 30, Steps: 17 | Train Loss: 0.472 Vali Loss: 2.784 Vali Acc: 0.357 Test Loss: 2.784 Test Acc: 0.357
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.5385866165161133
Epoch: 31, Steps: 17 | Train Loss: 0.570 Vali Loss: 3.306 Vali Acc: 0.308 Test Loss: 3.306 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.005689859390259
Epoch: 32, Steps: 17 | Train Loss: 0.544 Vali Loss: 4.063 Vali Acc: 0.346 Test Loss: 4.063 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3916349809885932
model parameter : 8355764
model size : 36.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.156527280807495
Epoch: 1, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.685 Vali Acc: 0.247 Test Loss: 1.685 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 6.566066026687622
Epoch: 2, Steps: 17 | Train Loss: 1.684 Vali Loss: 2.190 Vali Acc: 0.247 Test Loss: 2.190 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.697290658950806
Epoch: 3, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.639 Vali Acc: 0.289 Test Loss: 1.639 Test Acc: 0.289
Validation loss decreased (-0.247131 --> -0.288957).  Saving model ...
Epoch: 4 cost time: 4.542211294174194
Epoch: 4, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.815 Vali Acc: 0.262 Test Loss: 1.815 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.420591115951538
Epoch: 5, Steps: 17 | Train Loss: 1.623 Vali Loss: 1.777 Vali Acc: 0.255 Test Loss: 1.777 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.879238605499268
Epoch: 6, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.632 Vali Acc: 0.262 Test Loss: 1.632 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 5.720680475234985
Epoch: 7, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.621 Vali Acc: 0.262 Test Loss: 1.621 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 5.690864324569702
Epoch: 8, Steps: 17 | Train Loss: 1.500 Vali Loss: 2.503 Vali Acc: 0.251 Test Loss: 2.503 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.133007287979126
Epoch: 9, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.694 Vali Acc: 0.319 Test Loss: 1.694 Test Acc: 0.319
Validation loss decreased (-0.288957 --> -0.319375).  Saving model ...
Epoch: 10 cost time: 5.150736570358276
Epoch: 10, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.709 Vali Acc: 0.319 Test Loss: 1.709 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.884966611862183
Epoch: 11, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.619 Vali Acc: 0.327 Test Loss: 1.619 Test Acc: 0.327
Validation loss decreased (-0.319375 --> -0.326980).  Saving model ...
Epoch: 12 cost time: 5.631547451019287
Epoch: 12, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.655 Vali Acc: 0.308 Test Loss: 1.655 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.7358057498931885
Epoch: 13, Steps: 17 | Train Loss: 1.018 Vali Loss: 2.092 Vali Acc: 0.297 Test Loss: 2.092 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.566190481185913
Epoch: 14, Steps: 17 | Train Loss: 1.067 Vali Loss: 2.012 Vali Acc: 0.338 Test Loss: 2.012 Test Acc: 0.338
Validation loss decreased (-0.326980 --> -0.338383).  Saving model ...
Epoch: 15 cost time: 5.032479286193848
Epoch: 15, Steps: 17 | Train Loss: 1.023 Vali Loss: 2.444 Vali Acc: 0.346 Test Loss: 2.444 Test Acc: 0.346
Validation loss decreased (-0.338383 --> -0.345983).  Saving model ...
Epoch: 16 cost time: 5.893904685974121
Epoch: 16, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.749 Vali Acc: 0.365 Test Loss: 1.749 Test Acc: 0.365
Validation loss decreased (-0.345983 --> -0.365002).  Saving model ...
Epoch: 17 cost time: 7.14605450630188
Epoch: 17, Steps: 17 | Train Loss: 0.821 Vali Loss: 2.258 Vali Acc: 0.308 Test Loss: 2.258 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.095090866088867
Epoch: 18, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.041 Vali Acc: 0.373 Test Loss: 2.041 Test Acc: 0.373
Validation loss decreased (-0.365002 --> -0.372603).  Saving model ...
Epoch: 19 cost time: 7.71955680847168
Epoch: 19, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.383 Vali Acc: 0.308 Test Loss: 2.383 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.455418348312378
Epoch: 20, Steps: 17 | Train Loss: 0.681 Vali Loss: 1.868 Vali Acc: 0.357 Test Loss: 1.868 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.996286392211914
Epoch: 21, Steps: 17 | Train Loss: 0.731 Vali Loss: 2.397 Vali Acc: 0.308 Test Loss: 2.397 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 6.570411682128906
Epoch: 22, Steps: 17 | Train Loss: 0.682 Vali Loss: 2.527 Vali Acc: 0.289 Test Loss: 2.527 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.532741069793701
Epoch: 23, Steps: 17 | Train Loss: 0.693 Vali Loss: 2.357 Vali Acc: 0.316 Test Loss: 2.357 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.971369743347168
Epoch: 24, Steps: 17 | Train Loss: 0.728 Vali Loss: 2.617 Vali Acc: 0.327 Test Loss: 2.617 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.390517950057983
Epoch: 25, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.875 Vali Acc: 0.342 Test Loss: 2.875 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.106333017349243
Epoch: 26, Steps: 17 | Train Loss: 0.615 Vali Loss: 3.150 Vali Acc: 0.289 Test Loss: 3.150 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.9531757831573486
Epoch: 27, Steps: 17 | Train Loss: 0.697 Vali Loss: 2.766 Vali Acc: 0.312 Test Loss: 2.766 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.940774202346802
Epoch: 28, Steps: 17 | Train Loss: 0.656 Vali Loss: 2.371 Vali Acc: 0.278 Test Loss: 2.371 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3726235741444867
model parameter : 8290228
model size : 36.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.181904315948486
Epoch: 1, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.407 Vali Acc: 0.274 Test Loss: 1.407 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 5.200586318969727
Epoch: 2, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.489 Vali Acc: 0.289 Test Loss: 1.489 Test Acc: 0.289
Validation loss decreased (-0.273750 --> -0.288958).  Saving model ...
Epoch: 3 cost time: 4.958359479904175
Epoch: 3, Steps: 17 | Train Loss: 1.818 Vali Loss: 1.560 Vali Acc: 0.270 Test Loss: 1.560 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.275495290756226
Epoch: 4, Steps: 17 | Train Loss: 1.656 Vali Loss: 1.562 Vali Acc: 0.228 Test Loss: 1.562 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.9982993602752686
Epoch: 5, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.797 Vali Acc: 0.259 Test Loss: 1.797 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 5.0638768672943115
Epoch: 6, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.574 Vali Acc: 0.312 Test Loss: 1.574 Test Acc: 0.312
Validation loss decreased (-0.288958 --> -0.311771).  Saving model ...
Epoch: 7 cost time: 5.363827705383301
Epoch: 7, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.628 Vali Acc: 0.289 Test Loss: 1.628 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.630537748336792
Epoch: 8, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.656 Vali Acc: 0.266 Test Loss: 1.656 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.934375762939453
Epoch: 9, Steps: 17 | Train Loss: 1.317 Vali Loss: 2.233 Vali Acc: 0.259 Test Loss: 2.233 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.505768537521362
Epoch: 10, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.712 Vali Acc: 0.323 Test Loss: 1.712 Test Acc: 0.323
Validation loss decreased (-0.311771 --> -0.323177).  Saving model ...
Epoch: 11 cost time: 5.295905113220215
Epoch: 11, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.668 Vali Acc: 0.361 Test Loss: 1.668 Test Acc: 0.361
Validation loss decreased (-0.323177 --> -0.361200).  Saving model ...
Epoch: 12 cost time: 4.56390905380249
Epoch: 12, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.795 Vali Acc: 0.323 Test Loss: 1.795 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.946659326553345
Epoch: 13, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.735 Vali Acc: 0.338 Test Loss: 1.735 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.108896493911743
Epoch: 14, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.785 Vali Acc: 0.369 Test Loss: 1.785 Test Acc: 0.369
Validation loss decreased (-0.361200 --> -0.368803).  Saving model ...
Epoch: 15 cost time: 5.451969385147095
Epoch: 15, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.577 Vali Acc: 0.369 Test Loss: 1.577 Test Acc: 0.369
Validation loss decreased (-0.368803 --> -0.368806).  Saving model ...
Epoch: 16 cost time: 5.191265344619751
Epoch: 16, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.812 Vali Acc: 0.399 Test Loss: 1.812 Test Acc: 0.399
Validation loss decreased (-0.368806 --> -0.399221).  Saving model ...
Epoch: 17 cost time: 5.661813259124756
Epoch: 17, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.839 Vali Acc: 0.373 Test Loss: 1.839 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.577953577041626
Epoch: 18, Steps: 17 | Train Loss: 0.937 Vali Loss: 2.340 Vali Acc: 0.327 Test Loss: 2.340 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.095238447189331
Epoch: 19, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.883 Vali Acc: 0.335 Test Loss: 1.883 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.376864671707153
Epoch: 20, Steps: 17 | Train Loss: 0.729 Vali Loss: 2.030 Vali Acc: 0.304 Test Loss: 2.030 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.202176094055176
Epoch: 21, Steps: 17 | Train Loss: 0.861 Vali Loss: 2.544 Vali Acc: 0.338 Test Loss: 2.544 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.589447975158691
Epoch: 22, Steps: 17 | Train Loss: 0.672 Vali Loss: 2.201 Vali Acc: 0.373 Test Loss: 2.201 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.3163371086120605
Epoch: 23, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.973 Vali Acc: 0.297 Test Loss: 1.973 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.354537725448608
Epoch: 24, Steps: 17 | Train Loss: 0.720 Vali Loss: 2.084 Vali Acc: 0.346 Test Loss: 2.084 Test Acc: 0.346
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.919111013412476
Epoch: 25, Steps: 17 | Train Loss: 0.884 Vali Loss: 2.887 Vali Acc: 0.312 Test Loss: 2.887 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.702753305435181
Epoch: 26, Steps: 17 | Train Loss: 0.581 Vali Loss: 2.706 Vali Acc: 0.319 Test Loss: 2.706 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.39923954372623577
model parameter : 8224692
model size : 36.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.868424892425537
Epoch: 1, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.775 Vali Acc: 0.251 Test Loss: 1.775 Test Acc: 0.251
Validation loss decreased (inf --> -0.250933).  Saving model ...
Epoch: 2 cost time: 4.744236469268799
Epoch: 2, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.625 Vali Acc: 0.281 Test Loss: 1.625 Test Acc: 0.281
Validation loss decreased (-0.250933 --> -0.281353).  Saving model ...
Epoch: 3 cost time: 4.039470911026001
Epoch: 3, Steps: 17 | Train Loss: 1.756 Vali Loss: 1.703 Vali Acc: 0.243 Test Loss: 1.703 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.190213680267334
Epoch: 4, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.454 Vali Acc: 0.274 Test Loss: 1.454 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.16820764541626
Epoch: 5, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.603 Vali Acc: 0.262 Test Loss: 1.603 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.786048650741577
Epoch: 6, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.572 Vali Acc: 0.289 Test Loss: 1.572 Test Acc: 0.289
Validation loss decreased (-0.281353 --> -0.288958).  Saving model ...
Epoch: 7 cost time: 5.287606239318848
Epoch: 7, Steps: 17 | Train Loss: 1.533 Vali Loss: 2.481 Vali Acc: 0.247 Test Loss: 2.481 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.664307594299316
Epoch: 8, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.839 Vali Acc: 0.281 Test Loss: 1.839 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.006068229675293
Epoch: 9, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.994 Vali Acc: 0.289 Test Loss: 1.994 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.083572149276733
Epoch: 10, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.871 Vali Acc: 0.304 Test Loss: 1.871 Test Acc: 0.304
Validation loss decreased (-0.288958 --> -0.304164).  Saving model ...
Epoch: 11 cost time: 4.898695945739746
Epoch: 11, Steps: 17 | Train Loss: 1.137 Vali Loss: 2.074 Vali Acc: 0.247 Test Loss: 2.074 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.779503107070923
Epoch: 12, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.726 Vali Acc: 0.304 Test Loss: 1.726 Test Acc: 0.304
Validation loss decreased (-0.304164 --> -0.304165).  Saving model ...
Epoch: 13 cost time: 4.9575395584106445
Epoch: 13, Steps: 17 | Train Loss: 1.280 Vali Loss: 2.279 Vali Acc: 0.285 Test Loss: 2.279 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.679696798324585
Epoch: 14, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.754 Vali Acc: 0.361 Test Loss: 1.754 Test Acc: 0.361
Validation loss decreased (-0.304165 --> -0.361199).  Saving model ...
Epoch: 15 cost time: 5.595427751541138
Epoch: 15, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.680 Vali Acc: 0.357 Test Loss: 1.680 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.604865550994873
Epoch: 16, Steps: 17 | Train Loss: 0.900 Vali Loss: 2.557 Vali Acc: 0.285 Test Loss: 2.557 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.121381759643555
Epoch: 17, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.862 Vali Acc: 0.388 Test Loss: 1.862 Test Acc: 0.388
Validation loss decreased (-0.361199 --> -0.387814).  Saving model ...
Epoch: 18 cost time: 4.959293603897095
Epoch: 18, Steps: 17 | Train Loss: 0.726 Vali Loss: 2.723 Vali Acc: 0.308 Test Loss: 2.723 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.797865867614746
Epoch: 19, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.751 Vali Acc: 0.308 Test Loss: 1.751 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.514278173446655
Epoch: 20, Steps: 17 | Train Loss: 0.889 Vali Loss: 2.624 Vali Acc: 0.281 Test Loss: 2.624 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.791048049926758
Epoch: 21, Steps: 17 | Train Loss: 0.825 Vali Loss: 2.229 Vali Acc: 0.342 Test Loss: 2.229 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.370304346084595
Epoch: 22, Steps: 17 | Train Loss: 0.676 Vali Loss: 2.475 Vali Acc: 0.373 Test Loss: 2.475 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.099001884460449
Epoch: 23, Steps: 17 | Train Loss: 0.603 Vali Loss: 2.339 Vali Acc: 0.361 Test Loss: 2.339 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.427274465560913
Epoch: 24, Steps: 17 | Train Loss: 0.595 Vali Loss: 2.224 Vali Acc: 0.335 Test Loss: 2.224 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.390873908996582
Epoch: 25, Steps: 17 | Train Loss: 0.575 Vali Loss: 2.432 Vali Acc: 0.304 Test Loss: 2.432 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.67947793006897
Epoch: 26, Steps: 17 | Train Loss: 0.564 Vali Loss: 3.308 Vali Acc: 0.316 Test Loss: 3.308 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.810455083847046
Epoch: 27, Steps: 17 | Train Loss: 0.653 Vali Loss: 2.802 Vali Acc: 0.350 Test Loss: 2.802 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38783269961977185
model parameter : 8159156
model size : 36.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 8.037443161010742
Epoch: 1, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.471 Vali Acc: 0.262 Test Loss: 1.471 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 5.304376840591431
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.523 Vali Acc: 0.281 Test Loss: 1.523 Test Acc: 0.281
Validation loss decreased (-0.262343 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 4.0204176902771
Epoch: 3, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.617 Vali Acc: 0.270 Test Loss: 1.617 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.391634702682495
Epoch: 4, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.499 Vali Acc: 0.304 Test Loss: 1.499 Test Acc: 0.304
Validation loss decreased (-0.281354 --> -0.304168).  Saving model ...
Epoch: 5 cost time: 3.8254575729370117
Epoch: 5, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.743 Vali Acc: 0.255 Test Loss: 1.743 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.136051654815674
Epoch: 6, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.492 Vali Acc: 0.289 Test Loss: 1.492 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.208827018737793
Epoch: 7, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.707 Vali Acc: 0.308 Test Loss: 1.707 Test Acc: 0.308
Validation loss decreased (-0.304168 --> -0.307968).  Saving model ...
Epoch: 8 cost time: 5.69100284576416
Epoch: 8, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.527 Vali Acc: 0.304 Test Loss: 1.527 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.057616949081421
Epoch: 9, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.834 Vali Acc: 0.278 Test Loss: 1.834 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.013875484466553
Epoch: 10, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.639 Vali Acc: 0.342 Test Loss: 1.639 Test Acc: 0.342
Validation loss decreased (-0.307968 --> -0.342189).  Saving model ...
Epoch: 11 cost time: 5.769674777984619
Epoch: 11, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.581 Vali Acc: 0.388 Test Loss: 1.581 Test Acc: 0.388
Validation loss decreased (-0.342189 --> -0.387817).  Saving model ...
Epoch: 12 cost time: 4.924086332321167
Epoch: 12, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.591 Vali Acc: 0.338 Test Loss: 1.591 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.739260911941528
Epoch: 13, Steps: 17 | Train Loss: 1.046 Vali Loss: 2.049 Vali Acc: 0.281 Test Loss: 2.049 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.9632885456085205
Epoch: 14, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.814 Vali Acc: 0.304 Test Loss: 1.814 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.010480165481567
Epoch: 15, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.768 Vali Acc: 0.323 Test Loss: 1.768 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.525819301605225
Epoch: 16, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.671 Vali Acc: 0.414 Test Loss: 1.671 Test Acc: 0.414
Validation loss decreased (-0.387817 --> -0.414432).  Saving model ...
Epoch: 17 cost time: 4.808935642242432
Epoch: 17, Steps: 17 | Train Loss: 0.989 Vali Loss: 2.161 Vali Acc: 0.342 Test Loss: 2.161 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.052408695220947
Epoch: 18, Steps: 17 | Train Loss: 0.875 Vali Loss: 1.729 Vali Acc: 0.342 Test Loss: 1.729 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.333160161972046
Epoch: 19, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.811 Vali Acc: 0.357 Test Loss: 1.811 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.832242250442505
Epoch: 20, Steps: 17 | Train Loss: 0.757 Vali Loss: 1.819 Vali Acc: 0.388 Test Loss: 1.819 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.225131273269653
Epoch: 21, Steps: 17 | Train Loss: 0.829 Vali Loss: 2.370 Vali Acc: 0.384 Test Loss: 2.370 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.068445920944214
Epoch: 22, Steps: 17 | Train Loss: 0.822 Vali Loss: 1.949 Vali Acc: 0.342 Test Loss: 1.949 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.390605211257935
Epoch: 23, Steps: 17 | Train Loss: 0.562 Vali Loss: 2.175 Vali Acc: 0.392 Test Loss: 2.175 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.191768407821655
Epoch: 24, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.205 Vali Acc: 0.380 Test Loss: 2.205 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.771549701690674
Epoch: 25, Steps: 17 | Train Loss: 0.711 Vali Loss: 2.181 Vali Acc: 0.346 Test Loss: 2.181 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.892993211746216
Epoch: 26, Steps: 17 | Train Loss: 0.574 Vali Loss: 2.052 Vali Acc: 0.411 Test Loss: 2.052 Test Acc: 0.411
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 3955252
model size : 17.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.391275882720947
Epoch: 1, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.534 Vali Acc: 0.262 Test Loss: 1.534 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 5.333393096923828
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.806 Vali Acc: 0.266 Test Loss: 1.806 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266142).  Saving model ...
Epoch: 3 cost time: 4.38039755821228
Epoch: 3, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.670 Vali Acc: 0.255 Test Loss: 1.670 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.381621599197388
Epoch: 4, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.526 Vali Acc: 0.251 Test Loss: 1.526 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.265343189239502
Epoch: 5, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.794 Vali Acc: 0.243 Test Loss: 1.794 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.902369499206543
Epoch: 6, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.706 Vali Acc: 0.278 Test Loss: 1.706 Test Acc: 0.278
Validation loss decreased (-0.266142 --> -0.277549).  Saving model ...
Epoch: 7 cost time: 5.01364278793335
Epoch: 7, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.509 Vali Acc: 0.304 Test Loss: 1.509 Test Acc: 0.304
Validation loss decreased (-0.277549 --> -0.304167).  Saving model ...
Epoch: 8 cost time: 4.464249610900879
Epoch: 8, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.566 Vali Acc: 0.289 Test Loss: 1.566 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.438030004501343
Epoch: 9, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.497 Vali Acc: 0.312 Test Loss: 1.497 Test Acc: 0.312
Validation loss decreased (-0.304167 --> -0.311772).  Saving model ...
Epoch: 10 cost time: 4.373564720153809
Epoch: 10, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.998 Vali Acc: 0.293 Test Loss: 1.998 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.543067455291748
Epoch: 11, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.779 Vali Acc: 0.278 Test Loss: 1.779 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.639147520065308
Epoch: 12, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.668 Vali Acc: 0.300 Test Loss: 1.668 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.931146621704102
Epoch: 13, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.529 Vali Acc: 0.373 Test Loss: 1.529 Test Acc: 0.373
Validation loss decreased (-0.311772 --> -0.372608).  Saving model ...
Epoch: 14 cost time: 5.4082560539245605
Epoch: 14, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.788 Vali Acc: 0.395 Test Loss: 1.788 Test Acc: 0.395
Validation loss decreased (-0.372608 --> -0.395419).  Saving model ...
Epoch: 15 cost time: 4.606052875518799
Epoch: 15, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.547 Vali Acc: 0.365 Test Loss: 1.547 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.21635103225708
Epoch: 16, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.801 Vali Acc: 0.369 Test Loss: 1.801 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.896669626235962
Epoch: 17, Steps: 17 | Train Loss: 0.868 Vali Loss: 1.709 Vali Acc: 0.369 Test Loss: 1.709 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.881103038787842
Epoch: 18, Steps: 17 | Train Loss: 0.815 Vali Loss: 1.734 Vali Acc: 0.357 Test Loss: 1.734 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.369608640670776
Epoch: 19, Steps: 17 | Train Loss: 0.751 Vali Loss: 1.665 Vali Acc: 0.365 Test Loss: 1.665 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.671561002731323
Epoch: 20, Steps: 17 | Train Loss: 0.693 Vali Loss: 1.792 Vali Acc: 0.323 Test Loss: 1.792 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 6.2050254344940186
Epoch: 21, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.837 Vali Acc: 0.392 Test Loss: 1.837 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.534667015075684
Epoch: 22, Steps: 17 | Train Loss: 0.739 Vali Loss: 2.293 Vali Acc: 0.354 Test Loss: 2.293 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.276748895645142
Epoch: 23, Steps: 17 | Train Loss: 0.793 Vali Loss: 2.319 Vali Acc: 0.289 Test Loss: 2.319 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.75765061378479
Epoch: 24, Steps: 17 | Train Loss: 0.717 Vali Loss: 1.986 Vali Acc: 0.403 Test Loss: 1.986 Test Acc: 0.403
Validation loss decreased (-0.395419 --> -0.403022).  Saving model ...
Epoch: 25 cost time: 5.620906352996826
Epoch: 25, Steps: 17 | Train Loss: 0.614 Vali Loss: 2.429 Vali Acc: 0.350 Test Loss: 2.429 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.874200105667114
Epoch: 26, Steps: 17 | Train Loss: 0.708 Vali Loss: 2.078 Vali Acc: 0.388 Test Loss: 2.078 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.201952934265137
Epoch: 27, Steps: 17 | Train Loss: 0.649 Vali Loss: 1.982 Vali Acc: 0.342 Test Loss: 1.982 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.611080646514893
Epoch: 28, Steps: 17 | Train Loss: 0.599 Vali Loss: 2.579 Vali Acc: 0.342 Test Loss: 2.579 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.496982574462891
Epoch: 29, Steps: 17 | Train Loss: 0.521 Vali Loss: 2.187 Vali Acc: 0.365 Test Loss: 2.187 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.296051263809204
Epoch: 30, Steps: 17 | Train Loss: 0.486 Vali Loss: 2.489 Vali Acc: 0.361 Test Loss: 2.489 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.033705949783325
Epoch: 31, Steps: 17 | Train Loss: 0.461 Vali Loss: 2.300 Vali Acc: 0.335 Test Loss: 2.300 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.929492235183716
Epoch: 32, Steps: 17 | Train Loss: 0.450 Vali Loss: 2.876 Vali Acc: 0.327 Test Loss: 2.876 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.713964939117432
Epoch: 33, Steps: 17 | Train Loss: 0.554 Vali Loss: 2.610 Vali Acc: 0.384 Test Loss: 2.610 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.654247760772705
Epoch: 34, Steps: 17 | Train Loss: 0.496 Vali Loss: 3.768 Vali Acc: 0.327 Test Loss: 3.768 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.40304182509505704
model parameter : 3922484
model size : 17.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.552110433578491
Epoch: 1, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.619 Vali Acc: 0.251 Test Loss: 1.619 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 5.683379173278809
Epoch: 2, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.576 Vali Acc: 0.285 Test Loss: 1.576 Test Acc: 0.285
Validation loss decreased (-0.250934 --> -0.285155).  Saving model ...
Epoch: 3 cost time: 5.349878549575806
Epoch: 3, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.491 Vali Acc: 0.285 Test Loss: 1.491 Test Acc: 0.285
Validation loss decreased (-0.285155 --> -0.285156).  Saving model ...
Epoch: 4 cost time: 4.448440074920654
Epoch: 4, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.555 Vali Acc: 0.300 Test Loss: 1.555 Test Acc: 0.300
Validation loss decreased (-0.285156 --> -0.300365).  Saving model ...
Epoch: 5 cost time: 4.015650272369385
Epoch: 5, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.564 Vali Acc: 0.251 Test Loss: 1.564 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.1368489265441895
Epoch: 6, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.426 Vali Acc: 0.304 Test Loss: 1.426 Test Acc: 0.304
Validation loss decreased (-0.300365 --> -0.304168).  Saving model ...
Epoch: 7 cost time: 5.348677635192871
Epoch: 7, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.642 Vali Acc: 0.232 Test Loss: 1.642 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.650085926055908
Epoch: 8, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.602 Vali Acc: 0.278 Test Loss: 1.602 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.068511486053467
Epoch: 9, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.505 Vali Acc: 0.300 Test Loss: 1.505 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.956490516662598
Epoch: 10, Steps: 17 | Train Loss: 1.213 Vali Loss: 2.157 Vali Acc: 0.289 Test Loss: 2.157 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.836293935775757
Epoch: 11, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.673 Vali Acc: 0.365 Test Loss: 1.673 Test Acc: 0.365
Validation loss decreased (-0.304168 --> -0.365002).  Saving model ...
Epoch: 12 cost time: 5.0385355949401855
Epoch: 12, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.530 Vali Acc: 0.350 Test Loss: 1.530 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.427891254425049
Epoch: 13, Steps: 17 | Train Loss: 1.000 Vali Loss: 1.572 Vali Acc: 0.319 Test Loss: 1.572 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.375345468521118
Epoch: 14, Steps: 17 | Train Loss: 0.948 Vali Loss: 1.624 Vali Acc: 0.354 Test Loss: 1.624 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.4386303424835205
Epoch: 15, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.599 Vali Acc: 0.354 Test Loss: 1.599 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.083650588989258
Epoch: 16, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.951 Vali Acc: 0.380 Test Loss: 1.951 Test Acc: 0.380
Validation loss decreased (-0.365002 --> -0.380209).  Saving model ...
Epoch: 17 cost time: 3.4630937576293945
Epoch: 17, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.644 Vali Acc: 0.384 Test Loss: 1.644 Test Acc: 0.384
Validation loss decreased (-0.380209 --> -0.384014).  Saving model ...
Epoch: 18 cost time: 5.715384244918823
Epoch: 18, Steps: 17 | Train Loss: 0.710 Vali Loss: 1.814 Vali Acc: 0.365 Test Loss: 1.814 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.897641658782959
Epoch: 19, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.017 Vali Acc: 0.373 Test Loss: 2.017 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.300468921661377
Epoch: 20, Steps: 17 | Train Loss: 0.601 Vali Loss: 1.792 Vali Acc: 0.384 Test Loss: 1.792 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.9273881912231445
Epoch: 21, Steps: 17 | Train Loss: 0.672 Vali Loss: 2.052 Vali Acc: 0.327 Test Loss: 2.052 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.362529754638672
Epoch: 22, Steps: 17 | Train Loss: 0.690 Vali Loss: 2.357 Vali Acc: 0.323 Test Loss: 2.357 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.895136833190918
Epoch: 23, Steps: 17 | Train Loss: 0.526 Vali Loss: 2.204 Vali Acc: 0.331 Test Loss: 2.204 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.344799041748047
Epoch: 24, Steps: 17 | Train Loss: 0.571 Vali Loss: 2.146 Vali Acc: 0.285 Test Loss: 2.146 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.593705654144287
Epoch: 25, Steps: 17 | Train Loss: 0.532 Vali Loss: 2.583 Vali Acc: 0.316 Test Loss: 2.583 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.698671817779541
Epoch: 26, Steps: 17 | Train Loss: 0.623 Vali Loss: 2.232 Vali Acc: 0.350 Test Loss: 2.232 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.1015002727508545
Epoch: 27, Steps: 17 | Train Loss: 0.573 Vali Loss: 2.364 Vali Acc: 0.319 Test Loss: 2.364 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3840304182509506
model parameter : 3889716
model size : 17.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.759211540222168
Epoch: 1, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.417 Vali Acc: 0.281 Test Loss: 1.417 Test Acc: 0.281
Validation loss decreased (inf --> -0.281355).  Saving model ...
Epoch: 2 cost time: 4.588087320327759
Epoch: 2, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.545 Vali Acc: 0.232 Test Loss: 1.545 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.720089673995972
Epoch: 3, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.709 Vali Acc: 0.259 Test Loss: 1.709 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.384347677230835
Epoch: 4, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.528 Vali Acc: 0.312 Test Loss: 1.528 Test Acc: 0.312
Validation loss decreased (-0.281355 --> -0.311772).  Saving model ...
Epoch: 5 cost time: 3.956242084503174
Epoch: 5, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.493 Vali Acc: 0.308 Test Loss: 1.493 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.889979362487793
Epoch: 6, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.406 Vali Acc: 0.319 Test Loss: 1.406 Test Acc: 0.319
Validation loss decreased (-0.311772 --> -0.319378).  Saving model ...
Epoch: 7 cost time: 3.6589982509613037
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.422 Vali Acc: 0.323 Test Loss: 1.422 Test Acc: 0.323
Validation loss decreased (-0.319378 --> -0.323180).  Saving model ...
Epoch: 8 cost time: 5.146921157836914
Epoch: 8, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.553 Vali Acc: 0.278 Test Loss: 1.553 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.281510829925537
Epoch: 9, Steps: 17 | Train Loss: 1.254 Vali Loss: 1.461 Vali Acc: 0.338 Test Loss: 1.461 Test Acc: 0.338
Validation loss decreased (-0.323180 --> -0.338388).  Saving model ...
Epoch: 10 cost time: 4.225919008255005
Epoch: 10, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.498 Vali Acc: 0.331 Test Loss: 1.498 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.12098503112793
Epoch: 11, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.608 Vali Acc: 0.289 Test Loss: 1.608 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.895393133163452
Epoch: 12, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.546 Vali Acc: 0.373 Test Loss: 1.546 Test Acc: 0.373
Validation loss decreased (-0.338388 --> -0.372608).  Saving model ...
Epoch: 13 cost time: 4.595710515975952
Epoch: 13, Steps: 17 | Train Loss: 0.907 Vali Loss: 1.545 Vali Acc: 0.384 Test Loss: 1.545 Test Acc: 0.384
Validation loss decreased (-0.372608 --> -0.384015).  Saving model ...
Epoch: 14 cost time: 4.831768274307251
Epoch: 14, Steps: 17 | Train Loss: 0.946 Vali Loss: 1.594 Vali Acc: 0.357 Test Loss: 1.594 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.187078237533569
Epoch: 15, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.677 Vali Acc: 0.346 Test Loss: 1.677 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.7655394077301025
Epoch: 16, Steps: 17 | Train Loss: 0.844 Vali Loss: 1.722 Vali Acc: 0.357 Test Loss: 1.722 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.557056427001953
Epoch: 17, Steps: 17 | Train Loss: 0.831 Vali Loss: 1.880 Vali Acc: 0.376 Test Loss: 1.880 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.312597274780273
Epoch: 18, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.538 Vali Acc: 0.369 Test Loss: 1.538 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.1567542552948
Epoch: 19, Steps: 17 | Train Loss: 0.699 Vali Loss: 1.959 Vali Acc: 0.369 Test Loss: 1.959 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.463203430175781
Epoch: 20, Steps: 17 | Train Loss: 0.768 Vali Loss: 1.667 Vali Acc: 0.365 Test Loss: 1.667 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.452367067337036
Epoch: 21, Steps: 17 | Train Loss: 0.663 Vali Loss: 2.275 Vali Acc: 0.335 Test Loss: 2.275 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.019702911376953
Epoch: 22, Steps: 17 | Train Loss: 0.705 Vali Loss: 1.781 Vali Acc: 0.331 Test Loss: 1.781 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.830444574356079
Epoch: 23, Steps: 17 | Train Loss: 0.820 Vali Loss: 1.821 Vali Acc: 0.331 Test Loss: 1.821 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3840304182509506
model parameter : 3856948
model size : 17.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.927424669265747
Epoch: 1, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.430 Vali Acc: 0.278 Test Loss: 1.430 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 4.827582120895386
Epoch: 2, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.491 Vali Acc: 0.262 Test Loss: 1.491 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.190671682357788
Epoch: 3, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.762 Vali Acc: 0.259 Test Loss: 1.762 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.749131441116333
Epoch: 4, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.654 Vali Acc: 0.266 Test Loss: 1.654 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.008238315582275
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.454 Vali Acc: 0.251 Test Loss: 1.454 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 5.206020355224609
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.544 Vali Acc: 0.240 Test Loss: 1.544 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.933511734008789
Epoch: 7, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.741 Vali Acc: 0.300 Test Loss: 1.741 Test Acc: 0.300
Validation loss decreased (-0.277552 --> -0.300363).  Saving model ...
Epoch: 8 cost time: 5.820318698883057
Epoch: 8, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.542 Vali Acc: 0.308 Test Loss: 1.542 Test Acc: 0.308
Validation loss decreased (-0.300363 --> -0.307969).  Saving model ...
Epoch: 9 cost time: 5.637261629104614
Epoch: 9, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.875 Vali Acc: 0.247 Test Loss: 1.875 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.382915496826172
Epoch: 10, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.840 Vali Acc: 0.255 Test Loss: 1.840 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.7650556564331055
Epoch: 11, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.749 Vali Acc: 0.312 Test Loss: 1.749 Test Acc: 0.312
Validation loss decreased (-0.307969 --> -0.311770).  Saving model ...
Epoch: 12 cost time: 4.5339484214782715
Epoch: 12, Steps: 17 | Train Loss: 1.253 Vali Loss: 2.010 Vali Acc: 0.274 Test Loss: 2.010 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.391845703125
Epoch: 13, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.522 Vali Acc: 0.323 Test Loss: 1.522 Test Acc: 0.323
Validation loss decreased (-0.311770 --> -0.323179).  Saving model ...
Epoch: 14 cost time: 5.1688573360443115
Epoch: 14, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.862 Vali Acc: 0.327 Test Loss: 1.862 Test Acc: 0.327
Validation loss decreased (-0.323179 --> -0.326978).  Saving model ...
Epoch: 15 cost time: 4.006911754608154
Epoch: 15, Steps: 17 | Train Loss: 1.059 Vali Loss: 1.653 Vali Acc: 0.365 Test Loss: 1.653 Test Acc: 0.365
Validation loss decreased (-0.326978 --> -0.365002).  Saving model ...
Epoch: 16 cost time: 4.72763991355896
Epoch: 16, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.931 Vali Acc: 0.312 Test Loss: 1.931 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.3192808628082275
Epoch: 17, Steps: 17 | Train Loss: 0.883 Vali Loss: 1.705 Vali Acc: 0.335 Test Loss: 1.705 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.509757995605469
Epoch: 18, Steps: 17 | Train Loss: 0.810 Vali Loss: 1.819 Vali Acc: 0.354 Test Loss: 1.819 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.7566070556640625
Epoch: 19, Steps: 17 | Train Loss: 0.797 Vali Loss: 1.835 Vali Acc: 0.376 Test Loss: 1.835 Test Acc: 0.376
Validation loss decreased (-0.365002 --> -0.376408).  Saving model ...
Epoch: 20 cost time: 3.8302414417266846
Epoch: 20, Steps: 17 | Train Loss: 0.678 Vali Loss: 2.041 Vali Acc: 0.319 Test Loss: 2.041 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.614523887634277
Epoch: 21, Steps: 17 | Train Loss: 0.708 Vali Loss: 1.983 Vali Acc: 0.361 Test Loss: 1.983 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.473785161972046
Epoch: 22, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.188 Vali Acc: 0.323 Test Loss: 2.188 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.687870979309082
Epoch: 23, Steps: 17 | Train Loss: 0.716 Vali Loss: 2.497 Vali Acc: 0.342 Test Loss: 2.497 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.2272303104400635
Epoch: 24, Steps: 17 | Train Loss: 0.640 Vali Loss: 2.185 Vali Acc: 0.350 Test Loss: 2.185 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.9197347164154053
Epoch: 25, Steps: 17 | Train Loss: 0.667 Vali Loss: 2.173 Vali Acc: 0.350 Test Loss: 2.173 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.471724271774292
Epoch: 26, Steps: 17 | Train Loss: 0.484 Vali Loss: 2.387 Vali Acc: 0.365 Test Loss: 2.387 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.948620796203613
Epoch: 27, Steps: 17 | Train Loss: 0.551 Vali Loss: 2.372 Vali Acc: 0.342 Test Loss: 2.372 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.331199884414673
Epoch: 28, Steps: 17 | Train Loss: 0.637 Vali Loss: 2.592 Vali Acc: 0.338 Test Loss: 2.592 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.55793571472168
Epoch: 29, Steps: 17 | Train Loss: 0.493 Vali Loss: 2.538 Vali Acc: 0.312 Test Loss: 2.538 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.376425855513308
model parameter : 3034164
model size : 14.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.837684392929077
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.452 Vali Acc: 0.262 Test Loss: 1.452 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 4.703048229217529
Epoch: 2, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.419 Vali Acc: 0.285 Test Loss: 1.419 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 3.8932509422302246
Epoch: 3, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.446 Vali Acc: 0.266 Test Loss: 1.446 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4403951168060303
Epoch: 4, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.429 Vali Acc: 0.255 Test Loss: 1.429 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.125896692276001
Epoch: 5, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.615 Vali Acc: 0.251 Test Loss: 1.615 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.365776538848877
Epoch: 6, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.726 Vali Acc: 0.270 Test Loss: 1.726 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.538102626800537
Epoch: 7, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.563 Vali Acc: 0.285 Test Loss: 1.563 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 4.763664960861206
Epoch: 8, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.784 Vali Acc: 0.255 Test Loss: 1.784 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 5.175238609313965
Epoch: 9, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.476 Vali Acc: 0.312 Test Loss: 1.476 Test Acc: 0.312
Validation loss decreased (-0.285157 --> -0.311772).  Saving model ...
Epoch: 10 cost time: 4.693108081817627
Epoch: 10, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.551 Vali Acc: 0.323 Test Loss: 1.551 Test Acc: 0.323
Validation loss decreased (-0.311772 --> -0.323178).  Saving model ...
Epoch: 11 cost time: 5.316021680831909
Epoch: 11, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.742 Vali Acc: 0.331 Test Loss: 1.742 Test Acc: 0.331
Validation loss decreased (-0.323178 --> -0.330781).  Saving model ...
Epoch: 12 cost time: 4.4028708934783936
Epoch: 12, Steps: 17 | Train Loss: 1.136 Vali Loss: 2.059 Vali Acc: 0.281 Test Loss: 2.059 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.327692985534668
Epoch: 13, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.532 Vali Acc: 0.342 Test Loss: 1.532 Test Acc: 0.342
Validation loss decreased (-0.330781 --> -0.342190).  Saving model ...
Epoch: 14 cost time: 4.772421360015869
Epoch: 14, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.777 Vali Acc: 0.342 Test Loss: 1.777 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.7091383934021
Epoch: 15, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.744 Vali Acc: 0.342 Test Loss: 1.744 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.857774019241333
Epoch: 16, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.849 Vali Acc: 0.338 Test Loss: 1.849 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.9464728832244873
Epoch: 17, Steps: 17 | Train Loss: 0.854 Vali Loss: 1.668 Vali Acc: 0.354 Test Loss: 1.668 Test Acc: 0.354
Validation loss decreased (-0.342190 --> -0.353595).  Saving model ...
Epoch: 18 cost time: 3.8947036266326904
Epoch: 18, Steps: 17 | Train Loss: 0.754 Vali Loss: 1.813 Vali Acc: 0.357 Test Loss: 1.813 Test Acc: 0.357
Validation loss decreased (-0.353595 --> -0.357396).  Saving model ...
Epoch: 19 cost time: 4.326433897018433
Epoch: 19, Steps: 17 | Train Loss: 0.839 Vali Loss: 1.712 Vali Acc: 0.346 Test Loss: 1.712 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.984776020050049
Epoch: 20, Steps: 17 | Train Loss: 0.772 Vali Loss: 1.973 Vali Acc: 0.338 Test Loss: 1.973 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.083582162857056
Epoch: 21, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.842 Vali Acc: 0.300 Test Loss: 1.842 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.515192747116089
Epoch: 22, Steps: 17 | Train Loss: 0.773 Vali Loss: 1.985 Vali Acc: 0.361 Test Loss: 1.985 Test Acc: 0.361
Validation loss decreased (-0.357396 --> -0.361197).  Saving model ...
Epoch: 23 cost time: 5.115596532821655
Epoch: 23, Steps: 17 | Train Loss: 0.664 Vali Loss: 1.970 Vali Acc: 0.365 Test Loss: 1.970 Test Acc: 0.365
Validation loss decreased (-0.361197 --> -0.364999).  Saving model ...
Epoch: 24 cost time: 5.1046552658081055
Epoch: 24, Steps: 17 | Train Loss: 0.613 Vali Loss: 2.006 Vali Acc: 0.357 Test Loss: 2.006 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.260964632034302
Epoch: 25, Steps: 17 | Train Loss: 0.519 Vali Loss: 2.236 Vali Acc: 0.354 Test Loss: 2.236 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.677372694015503
Epoch: 26, Steps: 17 | Train Loss: 0.609 Vali Loss: 2.125 Vali Acc: 0.365 Test Loss: 2.125 Test Acc: 0.365
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.68120813369751
Epoch: 27, Steps: 17 | Train Loss: 0.470 Vali Loss: 2.078 Vali Acc: 0.346 Test Loss: 2.078 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.950389862060547
Epoch: 28, Steps: 17 | Train Loss: 0.579 Vali Loss: 2.345 Vali Acc: 0.350 Test Loss: 2.345 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.099822759628296
Epoch: 29, Steps: 17 | Train Loss: 0.485 Vali Loss: 2.648 Vali Acc: 0.354 Test Loss: 2.648 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.660412788391113
Epoch: 30, Steps: 17 | Train Loss: 0.404 Vali Loss: 2.691 Vali Acc: 0.357 Test Loss: 2.691 Test Acc: 0.357
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.720566749572754
Epoch: 31, Steps: 17 | Train Loss: 0.425 Vali Loss: 2.783 Vali Acc: 0.361 Test Loss: 2.783 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.498474597930908
Epoch: 32, Steps: 17 | Train Loss: 0.396 Vali Loss: 2.742 Vali Acc: 0.361 Test Loss: 2.742 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.691903829574585
Epoch: 33, Steps: 17 | Train Loss: 0.475 Vali Loss: 2.794 Vali Acc: 0.361 Test Loss: 2.794 Test Acc: 0.361
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3650190114068441
model parameter : 3001396
model size : 14.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.46507453918457
Epoch: 1, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.494 Vali Acc: 0.270 Test Loss: 1.494 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 5.431454658508301
Epoch: 2, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.421 Vali Acc: 0.278 Test Loss: 1.421 Test Acc: 0.278
Validation loss decreased (-0.269947 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 4.848138093948364
Epoch: 3, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.511 Vali Acc: 0.274 Test Loss: 1.511 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.225039482116699
Epoch: 4, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.452 Vali Acc: 0.274 Test Loss: 1.452 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.091097831726074
Epoch: 5, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.887 Vali Acc: 0.281 Test Loss: 1.887 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281350).  Saving model ...
Epoch: 6 cost time: 5.664314270019531
Epoch: 6, Steps: 17 | Train Loss: 1.708 Vali Loss: 1.609 Vali Acc: 0.300 Test Loss: 1.609 Test Acc: 0.300
Validation loss decreased (-0.281350 --> -0.300364).  Saving model ...
Epoch: 7 cost time: 4.327509880065918
Epoch: 7, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.477 Vali Acc: 0.300 Test Loss: 1.477 Test Acc: 0.300
Validation loss decreased (-0.300364 --> -0.300365).  Saving model ...
Epoch: 8 cost time: 4.836833238601685
Epoch: 8, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.427 Vali Acc: 0.304 Test Loss: 1.427 Test Acc: 0.304
Validation loss decreased (-0.300365 --> -0.304168).  Saving model ...
Epoch: 9 cost time: 5.317765235900879
Epoch: 9, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.596 Vali Acc: 0.262 Test Loss: 1.596 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.674322128295898
Epoch: 10, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.662 Vali Acc: 0.338 Test Loss: 1.662 Test Acc: 0.338
Validation loss decreased (-0.304168 --> -0.338386).  Saving model ...
Epoch: 11 cost time: 4.682262420654297
Epoch: 11, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.539 Vali Acc: 0.365 Test Loss: 1.539 Test Acc: 0.365
Validation loss decreased (-0.338386 --> -0.365004).  Saving model ...
Epoch: 12 cost time: 4.7909095287323
Epoch: 12, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.686 Vali Acc: 0.342 Test Loss: 1.686 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5478742122650146
Epoch: 13, Steps: 17 | Train Loss: 1.009 Vali Loss: 1.845 Vali Acc: 0.308 Test Loss: 1.845 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.305375099182129
Epoch: 14, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.625 Vali Acc: 0.380 Test Loss: 1.625 Test Acc: 0.380
Validation loss decreased (-0.365004 --> -0.380212).  Saving model ...
Epoch: 15 cost time: 3.703429698944092
Epoch: 15, Steps: 17 | Train Loss: 0.836 Vali Loss: 1.635 Vali Acc: 0.365 Test Loss: 1.635 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.058368921279907
Epoch: 16, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.998 Vali Acc: 0.335 Test Loss: 1.998 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.479204177856445
Epoch: 17, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.925 Vali Acc: 0.323 Test Loss: 1.925 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.8060851097106934
Epoch: 18, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.946 Vali Acc: 0.350 Test Loss: 1.946 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.5273187160491943
Epoch: 19, Steps: 17 | Train Loss: 0.866 Vali Loss: 1.799 Vali Acc: 0.327 Test Loss: 1.799 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.473780393600464
Epoch: 20, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.040 Vali Acc: 0.373 Test Loss: 2.040 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.086298704147339
Epoch: 21, Steps: 17 | Train Loss: 0.755 Vali Loss: 1.986 Vali Acc: 0.361 Test Loss: 1.986 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.357609987258911
Epoch: 22, Steps: 17 | Train Loss: 0.734 Vali Loss: 1.901 Vali Acc: 0.354 Test Loss: 1.901 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.137004852294922
Epoch: 23, Steps: 17 | Train Loss: 0.664 Vali Loss: 2.350 Vali Acc: 0.335 Test Loss: 2.350 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.582014799118042
Epoch: 24, Steps: 17 | Train Loss: 0.657 Vali Loss: 2.275 Vali Acc: 0.316 Test Loss: 2.275 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38022813688212925
model parameter : 2968628
model size : 13.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.515242576599121
Epoch: 1, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.471 Vali Acc: 0.240 Test Loss: 1.471 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 3.5574562549591064
Epoch: 2, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.599 Vali Acc: 0.281 Test Loss: 1.599 Test Acc: 0.281
Validation loss decreased (-0.239529 --> -0.281353).  Saving model ...
Epoch: 3 cost time: 3.7848849296569824
Epoch: 3, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.533 Vali Acc: 0.281 Test Loss: 1.533 Test Acc: 0.281
Validation loss decreased (-0.281353 --> -0.281353).  Saving model ...
Epoch: 4 cost time: 4.480832815170288
Epoch: 4, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.445 Vali Acc: 0.293 Test Loss: 1.445 Test Acc: 0.293
Validation loss decreased (-0.281353 --> -0.292761).  Saving model ...
Epoch: 5 cost time: 3.534383535385132
Epoch: 5, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.649 Vali Acc: 0.274 Test Loss: 1.649 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.443568468093872
Epoch: 6, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.969 Vali Acc: 0.243 Test Loss: 1.969 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.781790256500244
Epoch: 7, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.637 Vali Acc: 0.251 Test Loss: 1.637 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.682792901992798
Epoch: 8, Steps: 17 | Train Loss: 1.251 Vali Loss: 1.705 Vali Acc: 0.289 Test Loss: 1.705 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.4621965885162354
Epoch: 9, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.502 Vali Acc: 0.274 Test Loss: 1.502 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.436077117919922
Epoch: 10, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.497 Vali Acc: 0.300 Test Loss: 1.497 Test Acc: 0.300
Validation loss decreased (-0.292761 --> -0.300365).  Saving model ...
Epoch: 11 cost time: 3.9597880840301514
Epoch: 11, Steps: 17 | Train Loss: 1.071 Vali Loss: 2.065 Vali Acc: 0.278 Test Loss: 2.065 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.431692123413086
Epoch: 12, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.685 Vali Acc: 0.304 Test Loss: 1.685 Test Acc: 0.304
Validation loss decreased (-0.300365 --> -0.304166).  Saving model ...
Epoch: 13 cost time: 4.474569082260132
Epoch: 13, Steps: 17 | Train Loss: 1.196 Vali Loss: 1.697 Vali Acc: 0.331 Test Loss: 1.697 Test Acc: 0.331
Validation loss decreased (-0.304166 --> -0.330782).  Saving model ...
Epoch: 14 cost time: 4.652297019958496
Epoch: 14, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.817 Vali Acc: 0.331 Test Loss: 1.817 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.6648054122924805
Epoch: 15, Steps: 17 | Train Loss: 1.087 Vali Loss: 2.158 Vali Acc: 0.289 Test Loss: 2.158 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.8931033611297607
Epoch: 16, Steps: 17 | Train Loss: 0.904 Vali Loss: 1.571 Vali Acc: 0.376 Test Loss: 1.571 Test Acc: 0.376
Validation loss decreased (-0.330782 --> -0.376410).  Saving model ...
Epoch: 17 cost time: 4.434591293334961
Epoch: 17, Steps: 17 | Train Loss: 0.830 Vali Loss: 1.611 Vali Acc: 0.373 Test Loss: 1.611 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.9046719074249268
Epoch: 18, Steps: 17 | Train Loss: 0.871 Vali Loss: 2.737 Vali Acc: 0.285 Test Loss: 2.737 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.341761350631714
Epoch: 19, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.738 Vali Acc: 0.323 Test Loss: 1.738 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.738928556442261
Epoch: 20, Steps: 17 | Train Loss: 0.753 Vali Loss: 1.818 Vali Acc: 0.357 Test Loss: 1.818 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.06350564956665
Epoch: 21, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.025 Vali Acc: 0.346 Test Loss: 2.025 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.637339353561401
Epoch: 22, Steps: 17 | Train Loss: 0.652 Vali Loss: 2.133 Vali Acc: 0.354 Test Loss: 2.133 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.45511269569397
Epoch: 23, Steps: 17 | Train Loss: 0.677 Vali Loss: 2.048 Vali Acc: 0.346 Test Loss: 2.048 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.296630144119263
Epoch: 24, Steps: 17 | Train Loss: 0.725 Vali Loss: 1.689 Vali Acc: 0.354 Test Loss: 1.689 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.2889978885650635
Epoch: 25, Steps: 17 | Train Loss: 0.821 Vali Loss: 2.419 Vali Acc: 0.335 Test Loss: 2.419 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.234015226364136
Epoch: 26, Steps: 17 | Train Loss: 0.618 Vali Loss: 2.170 Vali Acc: 0.380 Test Loss: 2.170 Test Acc: 0.380
Validation loss decreased (-0.376410 --> -0.380206).  Saving model ...
Epoch: 27 cost time: 3.8803303241729736
Epoch: 27, Steps: 17 | Train Loss: 0.601 Vali Loss: 2.240 Vali Acc: 0.354 Test Loss: 2.240 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.5343399047851562
Epoch: 28, Steps: 17 | Train Loss: 0.506 Vali Loss: 2.395 Vali Acc: 0.335 Test Loss: 2.395 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.099444627761841
Epoch: 29, Steps: 17 | Train Loss: 0.404 Vali Loss: 2.556 Vali Acc: 0.308 Test Loss: 2.556 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.691272497177124
Epoch: 30, Steps: 17 | Train Loss: 0.474 Vali Loss: 2.593 Vali Acc: 0.335 Test Loss: 2.593 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.049068927764893
Epoch: 31, Steps: 17 | Train Loss: 0.476 Vali Loss: 2.692 Vali Acc: 0.380 Test Loss: 2.692 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.192150592803955
Epoch: 32, Steps: 17 | Train Loss: 0.590 Vali Loss: 3.050 Vali Acc: 0.354 Test Loss: 3.050 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.7721896171569824
Epoch: 33, Steps: 17 | Train Loss: 0.557 Vali Loss: 2.603 Vali Acc: 0.380 Test Loss: 2.603 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.8664917945861816
Epoch: 34, Steps: 17 | Train Loss: 0.436 Vali Loss: 2.940 Vali Acc: 0.323 Test Loss: 2.940 Test Acc: 0.323
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.3398542404174805
Epoch: 35, Steps: 17 | Train Loss: 0.550 Vali Loss: 2.822 Vali Acc: 0.346 Test Loss: 2.822 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.761777639389038
Epoch: 36, Steps: 17 | Train Loss: 0.354 Vali Loss: 2.825 Vali Acc: 0.300 Test Loss: 2.825 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38022813688212925
model parameter : 2935860
model size : 13.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.923510313034058
Epoch: 1, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.502 Vali Acc: 0.243 Test Loss: 1.502 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 4.648446321487427
Epoch: 2, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.634 Vali Acc: 0.251 Test Loss: 1.634 Test Acc: 0.251
Validation loss decreased (-0.243331 --> -0.250934).  Saving model ...
Epoch: 3 cost time: 4.566348314285278
Epoch: 3, Steps: 17 | Train Loss: 1.535 Vali Loss: 1.714 Vali Acc: 0.251 Test Loss: 1.714 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.774508953094482
Epoch: 4, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.550 Vali Acc: 0.255 Test Loss: 1.550 Test Acc: 0.255
Validation loss decreased (-0.250934 --> -0.254737).  Saving model ...
Epoch: 5 cost time: 4.9078826904296875
Epoch: 5, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.552 Vali Acc: 0.262 Test Loss: 1.552 Test Acc: 0.262
Validation loss decreased (-0.254737 --> -0.262342).  Saving model ...
Epoch: 6 cost time: 5.305495023727417
Epoch: 6, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.414 Vali Acc: 0.274 Test Loss: 1.414 Test Acc: 0.274
Validation loss decreased (-0.262342 --> -0.273750).  Saving model ...
Epoch: 7 cost time: 4.9963600635528564
Epoch: 7, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.614 Vali Acc: 0.255 Test Loss: 1.614 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.246654748916626
Epoch: 8, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.480 Vali Acc: 0.285 Test Loss: 1.480 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 9 cost time: 4.084623098373413
Epoch: 9, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.750 Vali Acc: 0.278 Test Loss: 1.750 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.087804317474365
Epoch: 10, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.672 Vali Acc: 0.278 Test Loss: 1.672 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.200673341751099
Epoch: 11, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.659 Vali Acc: 0.342 Test Loss: 1.659 Test Acc: 0.342
Validation loss decreased (-0.285156 --> -0.342189).  Saving model ...
Epoch: 12 cost time: 4.0308005809783936
Epoch: 12, Steps: 17 | Train Loss: 1.202 Vali Loss: 2.274 Vali Acc: 0.285 Test Loss: 2.274 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.446476459503174
Epoch: 13, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.559 Vali Acc: 0.319 Test Loss: 1.559 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.0647852420806885
Epoch: 14, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.828 Vali Acc: 0.297 Test Loss: 1.828 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.453913927078247
Epoch: 15, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.751 Vali Acc: 0.300 Test Loss: 1.751 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.93339467048645
Epoch: 16, Steps: 17 | Train Loss: 0.868 Vali Loss: 2.005 Vali Acc: 0.285 Test Loss: 2.005 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.6785852909088135
Epoch: 17, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.959 Vali Acc: 0.376 Test Loss: 1.959 Test Acc: 0.376
Validation loss decreased (-0.342189 --> -0.376406).  Saving model ...
Epoch: 18 cost time: 3.49308705329895
Epoch: 18, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.836 Vali Acc: 0.342 Test Loss: 1.836 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0982282161712646
Epoch: 19, Steps: 17 | Train Loss: 0.743 Vali Loss: 1.881 Vali Acc: 0.350 Test Loss: 1.881 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.600642442703247
Epoch: 20, Steps: 17 | Train Loss: 0.775 Vali Loss: 1.816 Vali Acc: 0.323 Test Loss: 1.816 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.349284887313843
Epoch: 21, Steps: 17 | Train Loss: 0.798 Vali Loss: 2.351 Vali Acc: 0.346 Test Loss: 2.351 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.636133670806885
Epoch: 22, Steps: 17 | Train Loss: 0.637 Vali Loss: 2.072 Vali Acc: 0.350 Test Loss: 2.072 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.667709589004517
Epoch: 23, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.340 Vali Acc: 0.369 Test Loss: 2.340 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.37033486366272
Epoch: 24, Steps: 17 | Train Loss: 0.675 Vali Loss: 2.040 Vali Acc: 0.411 Test Loss: 2.040 Test Acc: 0.411
Validation loss decreased (-0.376406 --> -0.410626).  Saving model ...
Epoch: 25 cost time: 5.358104467391968
Epoch: 25, Steps: 17 | Train Loss: 0.540 Vali Loss: 2.243 Vali Acc: 0.357 Test Loss: 2.243 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.876944541931152
Epoch: 26, Steps: 17 | Train Loss: 0.600 Vali Loss: 2.173 Vali Acc: 0.376 Test Loss: 2.173 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.184027910232544
Epoch: 27, Steps: 17 | Train Loss: 0.549 Vali Loss: 2.415 Vali Acc: 0.316 Test Loss: 2.415 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 5.778093338012695
Epoch: 28, Steps: 17 | Train Loss: 0.455 Vali Loss: 2.282 Vali Acc: 0.346 Test Loss: 2.282 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.472825288772583
Epoch: 29, Steps: 17 | Train Loss: 0.546 Vali Loss: 2.508 Vali Acc: 0.369 Test Loss: 2.508 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.3301732540130615
Epoch: 30, Steps: 17 | Train Loss: 0.454 Vali Loss: 3.180 Vali Acc: 0.376 Test Loss: 3.180 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.05951189994812
Epoch: 31, Steps: 17 | Train Loss: 0.465 Vali Loss: 2.798 Vali Acc: 0.304 Test Loss: 2.798 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.050983428955078
Epoch: 32, Steps: 17 | Train Loss: 0.528 Vali Loss: 2.509 Vali Acc: 0.361 Test Loss: 2.509 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.6985011100769043
Epoch: 33, Steps: 17 | Train Loss: 0.486 Vali Loss: 2.777 Vali Acc: 0.338 Test Loss: 2.777 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.446270227432251
Epoch: 34, Steps: 17 | Train Loss: 0.516 Vali Loss: 3.133 Vali Acc: 0.323 Test Loss: 3.133 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 2573620
model size : 12.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.103960990905762
Epoch: 1, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.444 Vali Acc: 0.266 Test Loss: 1.444 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 5.60816216468811
Epoch: 2, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.461 Vali Acc: 0.278 Test Loss: 1.461 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 4.569708347320557
Epoch: 3, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.490 Vali Acc: 0.278 Test Loss: 1.490 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.899138927459717
Epoch: 4, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.429 Vali Acc: 0.270 Test Loss: 1.429 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.963109493255615
Epoch: 5, Steps: 17 | Train Loss: 1.421 Vali Loss: 2.054 Vali Acc: 0.255 Test Loss: 2.054 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.415295600891113
Epoch: 6, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.522 Vali Acc: 0.274 Test Loss: 1.522 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 4.291692733764648
Epoch: 7, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.613 Vali Acc: 0.281 Test Loss: 1.613 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281353).  Saving model ...
Epoch: 8 cost time: 3.738839626312256
Epoch: 8, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.655 Vali Acc: 0.259 Test Loss: 1.655 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1861352920532227
Epoch: 9, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.587 Vali Acc: 0.304 Test Loss: 1.587 Test Acc: 0.304
Validation loss decreased (-0.281353 --> -0.304167).  Saving model ...
Epoch: 10 cost time: 3.8792269229888916
Epoch: 10, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.751 Vali Acc: 0.293 Test Loss: 1.751 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.581641674041748
Epoch: 11, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.743 Vali Acc: 0.304 Test Loss: 1.743 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.999583959579468
Epoch: 12, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.640 Vali Acc: 0.350 Test Loss: 1.640 Test Acc: 0.350
Validation loss decreased (-0.304167 --> -0.349793).  Saving model ...
Epoch: 13 cost time: 4.803122043609619
Epoch: 13, Steps: 17 | Train Loss: 1.092 Vali Loss: 2.261 Vali Acc: 0.262 Test Loss: 2.261 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.348717212677002
Epoch: 14, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.763 Vali Acc: 0.369 Test Loss: 1.763 Test Acc: 0.369
Validation loss decreased (-0.349793 --> -0.368804).  Saving model ...
Epoch: 15 cost time: 4.730046510696411
Epoch: 15, Steps: 17 | Train Loss: 0.815 Vali Loss: 1.693 Vali Acc: 0.388 Test Loss: 1.693 Test Acc: 0.388
Validation loss decreased (-0.368804 --> -0.387816).  Saving model ...
Epoch: 16 cost time: 5.062148809432983
Epoch: 16, Steps: 17 | Train Loss: 0.807 Vali Loss: 2.003 Vali Acc: 0.323 Test Loss: 2.003 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.0072174072265625
Epoch: 17, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.130 Vali Acc: 0.312 Test Loss: 2.130 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.793426036834717
Epoch: 18, Steps: 17 | Train Loss: 1.016 Vali Loss: 1.767 Vali Acc: 0.354 Test Loss: 1.767 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.838825464248657
Epoch: 19, Steps: 17 | Train Loss: 0.671 Vali Loss: 1.948 Vali Acc: 0.335 Test Loss: 1.948 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.705047369003296
Epoch: 20, Steps: 17 | Train Loss: 0.631 Vali Loss: 1.941 Vali Acc: 0.361 Test Loss: 1.941 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.911267042160034
Epoch: 21, Steps: 17 | Train Loss: 0.613 Vali Loss: 2.040 Vali Acc: 0.365 Test Loss: 2.040 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.808544874191284
Epoch: 22, Steps: 17 | Train Loss: 0.606 Vali Loss: 2.072 Vali Acc: 0.380 Test Loss: 2.072 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.41796612739563
Epoch: 23, Steps: 17 | Train Loss: 0.540 Vali Loss: 2.254 Vali Acc: 0.327 Test Loss: 2.254 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.344648122787476
Epoch: 24, Steps: 17 | Train Loss: 0.724 Vali Loss: 2.537 Vali Acc: 0.388 Test Loss: 2.537 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.504133701324463
Epoch: 25, Steps: 17 | Train Loss: 0.615 Vali Loss: 2.376 Vali Acc: 0.354 Test Loss: 2.376 Test Acc: 0.354
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38783269961977185
model parameter : 2540852
model size : 12.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.521955966949463
Epoch: 1, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.449 Vali Acc: 0.251 Test Loss: 1.449 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 4.353425979614258
Epoch: 2, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.539 Vali Acc: 0.251 Test Loss: 1.539 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.593027114868164
Epoch: 3, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.519 Vali Acc: 0.262 Test Loss: 1.519 Test Acc: 0.262
Validation loss decreased (-0.250936 --> -0.262342).  Saving model ...
Epoch: 4 cost time: 5.153789758682251
Epoch: 4, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.482 Vali Acc: 0.281 Test Loss: 1.482 Test Acc: 0.281
Validation loss decreased (-0.262342 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 5.421022653579712
Epoch: 5, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.576 Vali Acc: 0.319 Test Loss: 1.576 Test Acc: 0.319
Validation loss decreased (-0.281354 --> -0.319376).  Saving model ...
Epoch: 6 cost time: 5.07069993019104
Epoch: 6, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.542 Vali Acc: 0.270 Test Loss: 1.542 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.180526256561279
Epoch: 7, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.510 Vali Acc: 0.342 Test Loss: 1.510 Test Acc: 0.342
Validation loss decreased (-0.319376 --> -0.342190).  Saving model ...
Epoch: 8 cost time: 5.513146877288818
Epoch: 8, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.474 Vali Acc: 0.266 Test Loss: 1.474 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.343794107437134
Epoch: 9, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.410 Vali Acc: 0.312 Test Loss: 1.410 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.317023038864136
Epoch: 10, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.607 Vali Acc: 0.354 Test Loss: 1.607 Test Acc: 0.354
Validation loss decreased (-0.342190 --> -0.353596).  Saving model ...
Epoch: 11 cost time: 5.114656686782837
Epoch: 11, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.530 Vali Acc: 0.319 Test Loss: 1.530 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.565676689147949
Epoch: 12, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.799 Vali Acc: 0.293 Test Loss: 1.799 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.363523483276367
Epoch: 13, Steps: 17 | Train Loss: 1.109 Vali Loss: 1.594 Vali Acc: 0.373 Test Loss: 1.594 Test Acc: 0.373
Validation loss decreased (-0.353596 --> -0.372608).  Saving model ...
Epoch: 14 cost time: 4.194014310836792
Epoch: 14, Steps: 17 | Train Loss: 0.982 Vali Loss: 2.247 Vali Acc: 0.289 Test Loss: 2.247 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8317716121673584
Epoch: 15, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.820 Vali Acc: 0.373 Test Loss: 1.820 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.940492630004883
Epoch: 16, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.781 Vali Acc: 0.338 Test Loss: 1.781 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.578500986099243
Epoch: 17, Steps: 17 | Train Loss: 0.889 Vali Loss: 1.810 Vali Acc: 0.331 Test Loss: 1.810 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.180462598800659
Epoch: 18, Steps: 17 | Train Loss: 0.839 Vali Loss: 1.806 Vali Acc: 0.335 Test Loss: 1.806 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.4075400829315186
Epoch: 19, Steps: 17 | Train Loss: 0.786 Vali Loss: 1.986 Vali Acc: 0.346 Test Loss: 1.986 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.102472305297852
Epoch: 20, Steps: 17 | Train Loss: 0.709 Vali Loss: 2.179 Vali Acc: 0.308 Test Loss: 2.179 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.96846342086792
Epoch: 21, Steps: 17 | Train Loss: 0.728 Vali Loss: 1.840 Vali Acc: 0.365 Test Loss: 1.840 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.8365747928619385
Epoch: 22, Steps: 17 | Train Loss: 0.642 Vali Loss: 1.947 Vali Acc: 0.369 Test Loss: 1.947 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.62547492980957
Epoch: 23, Steps: 17 | Train Loss: 0.602 Vali Loss: 2.272 Vali Acc: 0.323 Test Loss: 2.272 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3726235741444867
model parameter : 2508084
model size : 12.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.3483192920684814
Epoch: 1, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.414 Vali Acc: 0.274 Test Loss: 1.414 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 3.6182751655578613
Epoch: 2, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.661 Vali Acc: 0.262 Test Loss: 1.661 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.50883936882019
Epoch: 3, Steps: 17 | Train Loss: 1.675 Vali Loss: 1.816 Vali Acc: 0.251 Test Loss: 1.816 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.652715682983398
Epoch: 4, Steps: 17 | Train Loss: 1.549 Vali Loss: 1.432 Vali Acc: 0.270 Test Loss: 1.432 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.9477715492248535
Epoch: 5, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.473 Vali Acc: 0.289 Test Loss: 1.473 Test Acc: 0.289
Validation loss decreased (-0.273750 --> -0.288959).  Saving model ...
Epoch: 6 cost time: 3.3382511138916016
Epoch: 6, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.529 Vali Acc: 0.255 Test Loss: 1.529 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.250993967056274
Epoch: 7, Steps: 17 | Train Loss: 1.326 Vali Loss: 1.523 Vali Acc: 0.255 Test Loss: 1.523 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.026696681976318
Epoch: 8, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.560 Vali Acc: 0.293 Test Loss: 1.560 Test Acc: 0.293
Validation loss decreased (-0.288959 --> -0.292760).  Saving model ...
Epoch: 9 cost time: 3.2581112384796143
Epoch: 9, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.880 Vali Acc: 0.243 Test Loss: 1.880 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.350424289703369
Epoch: 10, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.517 Vali Acc: 0.327 Test Loss: 1.517 Test Acc: 0.327
Validation loss decreased (-0.292760 --> -0.326981).  Saving model ...
Epoch: 11 cost time: 4.489432334899902
Epoch: 11, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.805 Vali Acc: 0.300 Test Loss: 1.805 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7621471881866455
Epoch: 12, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.743 Vali Acc: 0.300 Test Loss: 1.743 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.238071441650391
Epoch: 13, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.596 Vali Acc: 0.335 Test Loss: 1.596 Test Acc: 0.335
Validation loss decreased (-0.326981 --> -0.334585).  Saving model ...
Epoch: 14 cost time: 4.811102390289307
Epoch: 14, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.798 Vali Acc: 0.384 Test Loss: 1.798 Test Acc: 0.384
Validation loss decreased (-0.334585 --> -0.384012).  Saving model ...
Epoch: 15 cost time: 4.091007947921753
Epoch: 15, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.655 Vali Acc: 0.411 Test Loss: 1.655 Test Acc: 0.411
Validation loss decreased (-0.384012 --> -0.410630).  Saving model ...
Epoch: 16 cost time: 4.434750318527222
Epoch: 16, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.803 Vali Acc: 0.331 Test Loss: 1.803 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.3762047290802
Epoch: 17, Steps: 17 | Train Loss: 0.877 Vali Loss: 2.159 Vali Acc: 0.300 Test Loss: 2.159 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.400027751922607
Epoch: 18, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.686 Vali Acc: 0.357 Test Loss: 1.686 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5312187671661377
Epoch: 19, Steps: 17 | Train Loss: 0.771 Vali Loss: 2.163 Vali Acc: 0.297 Test Loss: 2.163 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.9703164100646973
Epoch: 20, Steps: 17 | Train Loss: 0.672 Vali Loss: 1.855 Vali Acc: 0.361 Test Loss: 1.855 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.483327627182007
Epoch: 21, Steps: 17 | Train Loss: 0.789 Vali Loss: 2.054 Vali Acc: 0.335 Test Loss: 2.054 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.5945773124694824
Epoch: 22, Steps: 17 | Train Loss: 0.721 Vali Loss: 1.835 Vali Acc: 0.361 Test Loss: 1.835 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.4563915729522705
Epoch: 23, Steps: 17 | Train Loss: 0.626 Vali Loss: 1.940 Vali Acc: 0.361 Test Loss: 1.940 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.320493459701538
Epoch: 24, Steps: 17 | Train Loss: 0.682 Vali Loss: 2.053 Vali Acc: 0.338 Test Loss: 2.053 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.692392110824585
Epoch: 25, Steps: 17 | Train Loss: 0.605 Vali Loss: 2.205 Vali Acc: 0.327 Test Loss: 2.205 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 2475316
model size : 12.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.6675705909729
Epoch: 1, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.462 Vali Acc: 0.251 Test Loss: 1.462 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 2.8682868480682373
Epoch: 2, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.477 Vali Acc: 0.236 Test Loss: 1.477 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.364875078201294
Epoch: 3, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.561 Vali Acc: 0.247 Test Loss: 1.561 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.11612343788147
Epoch: 4, Steps: 17 | Train Loss: 1.558 Vali Loss: 2.137 Vali Acc: 0.251 Test Loss: 2.137 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.734495162963867
Epoch: 5, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.832 Vali Acc: 0.251 Test Loss: 1.832 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.472924709320068
Epoch: 6, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.936 Vali Acc: 0.240 Test Loss: 1.936 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.912823438644409
Epoch: 7, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.625 Vali Acc: 0.304 Test Loss: 1.625 Test Acc: 0.304
Validation loss decreased (-0.250936 --> -0.304166).  Saving model ...
Epoch: 8 cost time: 4.614528179168701
Epoch: 8, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.582 Vali Acc: 0.274 Test Loss: 1.582 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.850174188613892
Epoch: 9, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.874 Vali Acc: 0.304 Test Loss: 1.874 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.667091131210327
Epoch: 10, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.712 Vali Acc: 0.266 Test Loss: 1.712 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.457137107849121
Epoch: 11, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.920 Vali Acc: 0.259 Test Loss: 1.920 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.1631011962890625
Epoch: 12, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.641 Vali Acc: 0.316 Test Loss: 1.641 Test Acc: 0.316
Validation loss decreased (-0.304166 --> -0.315573).  Saving model ...
Epoch: 13 cost time: 4.607714653015137
Epoch: 13, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.655 Vali Acc: 0.300 Test Loss: 1.655 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.579342842102051
Epoch: 14, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.616 Vali Acc: 0.342 Test Loss: 1.616 Test Acc: 0.342
Validation loss decreased (-0.315573 --> -0.342189).  Saving model ...
Epoch: 15 cost time: 4.407597541809082
Epoch: 15, Steps: 17 | Train Loss: 1.003 Vali Loss: 2.391 Vali Acc: 0.300 Test Loss: 2.391 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.336303949356079
Epoch: 16, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.793 Vali Acc: 0.357 Test Loss: 1.793 Test Acc: 0.357
Validation loss decreased (-0.342189 --> -0.357397).  Saving model ...
Epoch: 17 cost time: 3.70815372467041
Epoch: 17, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.701 Vali Acc: 0.342 Test Loss: 1.701 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.013617992401123
Epoch: 18, Steps: 17 | Train Loss: 0.845 Vali Loss: 1.635 Vali Acc: 0.376 Test Loss: 1.635 Test Acc: 0.376
Validation loss decreased (-0.357397 --> -0.376410).  Saving model ...
Epoch: 19 cost time: 4.017836332321167
Epoch: 19, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.864 Vali Acc: 0.376 Test Loss: 1.864 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.755029916763306
Epoch: 20, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.777 Vali Acc: 0.380 Test Loss: 1.777 Test Acc: 0.380
Validation loss decreased (-0.376410 --> -0.380210).  Saving model ...
Epoch: 21 cost time: 4.27846360206604
Epoch: 21, Steps: 17 | Train Loss: 0.785 Vali Loss: 2.005 Vali Acc: 0.335 Test Loss: 2.005 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.263043403625488
Epoch: 22, Steps: 17 | Train Loss: 0.749 Vali Loss: 2.057 Vali Acc: 0.365 Test Loss: 2.057 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.058842182159424
Epoch: 23, Steps: 17 | Train Loss: 0.845 Vali Loss: 1.792 Vali Acc: 0.357 Test Loss: 1.792 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.697709321975708
Epoch: 24, Steps: 17 | Train Loss: 0.568 Vali Loss: 2.021 Vali Acc: 0.354 Test Loss: 2.021 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.4012439250946045
Epoch: 25, Steps: 17 | Train Loss: 0.648 Vali Loss: 2.155 Vali Acc: 0.342 Test Loss: 2.155 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.233603239059448
Epoch: 26, Steps: 17 | Train Loss: 0.821 Vali Loss: 1.758 Vali Acc: 0.414 Test Loss: 1.758 Test Acc: 0.414
Validation loss decreased (-0.380210 --> -0.414431).  Saving model ...
Epoch: 27 cost time: 4.662922143936157
Epoch: 27, Steps: 17 | Train Loss: 0.608 Vali Loss: 2.443 Vali Acc: 0.369 Test Loss: 2.443 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.204057455062866
Epoch: 28, Steps: 17 | Train Loss: 0.559 Vali Loss: 2.036 Vali Acc: 0.399 Test Loss: 2.036 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.328607797622681
Epoch: 29, Steps: 17 | Train Loss: 0.520 Vali Loss: 2.575 Vali Acc: 0.323 Test Loss: 2.575 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.572408676147461
Epoch: 30, Steps: 17 | Train Loss: 0.507 Vali Loss: 2.243 Vali Acc: 0.384 Test Loss: 2.243 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.824435710906982
Epoch: 31, Steps: 17 | Train Loss: 0.503 Vali Loss: 2.509 Vali Acc: 0.346 Test Loss: 2.509 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.965233325958252
Epoch: 32, Steps: 17 | Train Loss: 0.446 Vali Loss: 2.654 Vali Acc: 0.403 Test Loss: 2.654 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.930165529251099
Epoch: 33, Steps: 17 | Train Loss: 0.525 Vali Loss: 2.645 Vali Acc: 0.327 Test Loss: 2.645 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.237739562988281
Epoch: 34, Steps: 17 | Train Loss: 0.533 Vali Loss: 3.303 Vali Acc: 0.319 Test Loss: 3.303 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.438864469528198
Epoch: 35, Steps: 17 | Train Loss: 0.505 Vali Loss: 2.661 Vali Acc: 0.354 Test Loss: 2.661 Test Acc: 0.354
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.575972318649292
Epoch: 36, Steps: 17 | Train Loss: 0.501 Vali Loss: 2.671 Vali Acc: 0.392 Test Loss: 2.671 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 2343348
model size : 11.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.12446141242981
Epoch: 1, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.544 Vali Acc: 0.259 Test Loss: 1.544 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 4.28083348274231
Epoch: 2, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.885 Vali Acc: 0.251 Test Loss: 1.885 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.167985916137695
Epoch: 3, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.446 Vali Acc: 0.270 Test Loss: 1.446 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 4.052781343460083
Epoch: 4, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.439 Vali Acc: 0.262 Test Loss: 1.439 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.269679069519043
Epoch: 5, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.472 Vali Acc: 0.354 Test Loss: 1.472 Test Acc: 0.354
Validation loss decreased (-0.269948 --> -0.353597).  Saving model ...
Epoch: 6 cost time: 4.83458948135376
Epoch: 6, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.590 Vali Acc: 0.266 Test Loss: 1.590 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.363716125488281
Epoch: 7, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.660 Vali Acc: 0.247 Test Loss: 1.660 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.596008062362671
Epoch: 8, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.464 Vali Acc: 0.319 Test Loss: 1.464 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.9761412143707275
Epoch: 9, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.606 Vali Acc: 0.293 Test Loss: 1.606 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.078597068786621
Epoch: 10, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.951 Vali Acc: 0.243 Test Loss: 1.951 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.184941291809082
Epoch: 11, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.718 Vali Acc: 0.300 Test Loss: 1.718 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8764536380767822
Epoch: 12, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.814 Vali Acc: 0.300 Test Loss: 1.814 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.384977340698242
Epoch: 13, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.565 Vali Acc: 0.350 Test Loss: 1.565 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.100948095321655
Epoch: 14, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.579 Vali Acc: 0.327 Test Loss: 1.579 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.235475063323975
Epoch: 15, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.603 Vali Acc: 0.323 Test Loss: 1.603 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.35361216730038025
model parameter : 2310580
model size : 11.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.1625776290893555
Epoch: 1, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.453 Vali Acc: 0.240 Test Loss: 1.453 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 3.904146432876587
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.621 Vali Acc: 0.278 Test Loss: 1.621 Test Acc: 0.278
Validation loss decreased (-0.239529 --> -0.277550).  Saving model ...
Epoch: 3 cost time: 4.36104941368103
Epoch: 3, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.399 Vali Acc: 0.281 Test Loss: 1.399 Test Acc: 0.281
Validation loss decreased (-0.277550 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 4.769601821899414
Epoch: 4, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.425 Vali Acc: 0.278 Test Loss: 1.425 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.371546268463135
Epoch: 5, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.522 Vali Acc: 0.312 Test Loss: 1.522 Test Acc: 0.312
Validation loss decreased (-0.281355 --> -0.311772).  Saving model ...
Epoch: 6 cost time: 3.3120481967926025
Epoch: 6, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.740 Vali Acc: 0.323 Test Loss: 1.740 Test Acc: 0.323
Validation loss decreased (-0.311772 --> -0.323177).  Saving model ...
Epoch: 7 cost time: 3.9373302459716797
Epoch: 7, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.568 Vali Acc: 0.251 Test Loss: 1.568 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.2938268184661865
Epoch: 8, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.489 Vali Acc: 0.281 Test Loss: 1.489 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.077008008956909
Epoch: 9, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.604 Vali Acc: 0.251 Test Loss: 1.604 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.682946681976318
Epoch: 10, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.642 Vali Acc: 0.335 Test Loss: 1.642 Test Acc: 0.335
Validation loss decreased (-0.323177 --> -0.334584).  Saving model ...
Epoch: 11 cost time: 4.928112506866455
Epoch: 11, Steps: 17 | Train Loss: 1.164 Vali Loss: 1.768 Vali Acc: 0.316 Test Loss: 1.768 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.485645532608032
Epoch: 12, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.494 Vali Acc: 0.342 Test Loss: 1.494 Test Acc: 0.342
Validation loss decreased (-0.334584 --> -0.342190).  Saving model ...
Epoch: 13 cost time: 5.285547494888306
Epoch: 13, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.627 Vali Acc: 0.316 Test Loss: 1.627 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.053041696548462
Epoch: 14, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.659 Vali Acc: 0.350 Test Loss: 1.659 Test Acc: 0.350
Validation loss decreased (-0.342190 --> -0.349793).  Saving model ...
Epoch: 15 cost time: 4.450061798095703
Epoch: 15, Steps: 17 | Train Loss: 0.973 Vali Loss: 1.775 Vali Acc: 0.342 Test Loss: 1.775 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.134292364120483
Epoch: 16, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.967 Vali Acc: 0.338 Test Loss: 1.967 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.092107057571411
Epoch: 17, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.629 Vali Acc: 0.357 Test Loss: 1.629 Test Acc: 0.357
Validation loss decreased (-0.349793 --> -0.357398).  Saving model ...
Epoch: 18 cost time: 6.006190538406372
Epoch: 18, Steps: 17 | Train Loss: 0.837 Vali Loss: 1.729 Vali Acc: 0.346 Test Loss: 1.729 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.746026515960693
Epoch: 19, Steps: 17 | Train Loss: 0.841 Vali Loss: 2.202 Vali Acc: 0.365 Test Loss: 2.202 Test Acc: 0.365
Validation loss decreased (-0.357398 --> -0.364997).  Saving model ...
Epoch: 20 cost time: 5.158397197723389
Epoch: 20, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.786 Vali Acc: 0.369 Test Loss: 1.786 Test Acc: 0.369
Validation loss decreased (-0.364997 --> -0.368803).  Saving model ...
Epoch: 21 cost time: 5.1718909740448
Epoch: 21, Steps: 17 | Train Loss: 0.773 Vali Loss: 2.054 Vali Acc: 0.369 Test Loss: 2.054 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.634582042694092
Epoch: 22, Steps: 17 | Train Loss: 0.862 Vali Loss: 2.151 Vali Acc: 0.354 Test Loss: 2.151 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.996973037719727
Epoch: 23, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.195 Vali Acc: 0.338 Test Loss: 2.195 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.279433250427246
Epoch: 24, Steps: 17 | Train Loss: 0.743 Vali Loss: 1.838 Vali Acc: 0.380 Test Loss: 1.838 Test Acc: 0.380
Validation loss decreased (-0.368803 --> -0.380210).  Saving model ...
Epoch: 25 cost time: 5.752242565155029
Epoch: 25, Steps: 17 | Train Loss: 0.571 Vali Loss: 1.906 Vali Acc: 0.414 Test Loss: 1.906 Test Acc: 0.414
Validation loss decreased (-0.380210 --> -0.414430).  Saving model ...
Epoch: 26 cost time: 6.334270238876343
Epoch: 26, Steps: 17 | Train Loss: 0.543 Vali Loss: 2.204 Vali Acc: 0.369 Test Loss: 2.204 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.193397283554077
Epoch: 27, Steps: 17 | Train Loss: 0.562 Vali Loss: 2.071 Vali Acc: 0.350 Test Loss: 2.071 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.798577308654785
Epoch: 28, Steps: 17 | Train Loss: 0.484 Vali Loss: 2.684 Vali Acc: 0.331 Test Loss: 2.684 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.066102981567383
Epoch: 29, Steps: 17 | Train Loss: 0.636 Vali Loss: 2.048 Vali Acc: 0.380 Test Loss: 2.048 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.084984064102173
Epoch: 30, Steps: 17 | Train Loss: 0.510 Vali Loss: 2.197 Vali Acc: 0.338 Test Loss: 2.197 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.059862852096558
Epoch: 31, Steps: 17 | Train Loss: 0.514 Vali Loss: 2.238 Vali Acc: 0.376 Test Loss: 2.238 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.571599245071411
Epoch: 32, Steps: 17 | Train Loss: 0.390 Vali Loss: 2.522 Vali Acc: 0.392 Test Loss: 2.522 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.388563632965088
Epoch: 33, Steps: 17 | Train Loss: 0.376 Vali Loss: 2.357 Vali Acc: 0.388 Test Loss: 2.357 Test Acc: 0.388
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.604082345962524
Epoch: 34, Steps: 17 | Train Loss: 0.374 Vali Loss: 4.209 Vali Acc: 0.354 Test Loss: 4.209 Test Acc: 0.354
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 5.694531202316284
Epoch: 35, Steps: 17 | Train Loss: 0.928 Vali Loss: 2.344 Vali Acc: 0.327 Test Loss: 2.344 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 2277812
model size : 11.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.793468952178955
Epoch: 1, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.403 Vali Acc: 0.278 Test Loss: 1.403 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 4.4648191928863525
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.568 Vali Acc: 0.262 Test Loss: 1.568 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.672254800796509
Epoch: 3, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.542 Vali Acc: 0.255 Test Loss: 1.542 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.8312671184539795
Epoch: 4, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.674 Vali Acc: 0.240 Test Loss: 1.674 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 5.137590646743774
Epoch: 5, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.732 Vali Acc: 0.259 Test Loss: 1.732 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.499529123306274
Epoch: 6, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.708 Vali Acc: 0.251 Test Loss: 1.708 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 4.452641725540161
Epoch: 7, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.879 Vali Acc: 0.270 Test Loss: 1.879 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 4.4053215980529785
Epoch: 8, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.662 Vali Acc: 0.274 Test Loss: 1.662 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 5.615642786026001
Epoch: 9, Steps: 17 | Train Loss: 1.285 Vali Loss: 1.562 Vali Acc: 0.278 Test Loss: 1.562 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 4.851337671279907
Epoch: 10, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.725 Vali Acc: 0.262 Test Loss: 1.725 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 5.44411563873291
Epoch: 11, Steps: 17 | Train Loss: 1.240 Vali Loss: 1.560 Vali Acc: 0.354 Test Loss: 1.560 Test Acc: 0.354
Validation loss decreased (-0.277553 --> -0.353597).  Saving model ...
Epoch: 12 cost time: 4.65151309967041
Epoch: 12, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.660 Vali Acc: 0.312 Test Loss: 1.660 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.32383131980896
Epoch: 13, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.830 Vali Acc: 0.327 Test Loss: 1.830 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.5875039100646973
Epoch: 14, Steps: 17 | Train Loss: 1.039 Vali Loss: 1.623 Vali Acc: 0.361 Test Loss: 1.623 Test Acc: 0.361
Validation loss decreased (-0.353597 --> -0.361201).  Saving model ...
Epoch: 15 cost time: 3.2412378787994385
Epoch: 15, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.725 Vali Acc: 0.384 Test Loss: 1.725 Test Acc: 0.384
Validation loss decreased (-0.361201 --> -0.384013).  Saving model ...
Epoch: 16 cost time: 3.7455904483795166
Epoch: 16, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.623 Vali Acc: 0.357 Test Loss: 1.623 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.815311908721924
Epoch: 17, Steps: 17 | Train Loss: 0.967 Vali Loss: 1.776 Vali Acc: 0.388 Test Loss: 1.776 Test Acc: 0.388
Validation loss decreased (-0.384013 --> -0.387815).  Saving model ...
Epoch: 18 cost time: 4.473747968673706
Epoch: 18, Steps: 17 | Train Loss: 0.776 Vali Loss: 1.550 Vali Acc: 0.369 Test Loss: 1.550 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.435250997543335
Epoch: 19, Steps: 17 | Train Loss: 0.665 Vali Loss: 1.844 Vali Acc: 0.403 Test Loss: 1.844 Test Acc: 0.403
Validation loss decreased (-0.387815 --> -0.403023).  Saving model ...
Epoch: 20 cost time: 5.356212139129639
Epoch: 20, Steps: 17 | Train Loss: 0.799 Vali Loss: 1.757 Vali Acc: 0.373 Test Loss: 1.757 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.716995716094971
Epoch: 21, Steps: 17 | Train Loss: 0.773 Vali Loss: 2.100 Vali Acc: 0.346 Test Loss: 2.100 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.886101007461548
Epoch: 22, Steps: 17 | Train Loss: 0.791 Vali Loss: 2.052 Vali Acc: 0.395 Test Loss: 2.052 Test Acc: 0.395
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.509422302246094
Epoch: 23, Steps: 17 | Train Loss: 0.605 Vali Loss: 1.857 Vali Acc: 0.411 Test Loss: 1.857 Test Acc: 0.411
Validation loss decreased (-0.403023 --> -0.410628).  Saving model ...
Epoch: 24 cost time: 3.728961944580078
Epoch: 24, Steps: 17 | Train Loss: 0.566 Vali Loss: 2.312 Vali Acc: 0.342 Test Loss: 2.312 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.416337490081787
Epoch: 25, Steps: 17 | Train Loss: 0.583 Vali Loss: 2.251 Vali Acc: 0.365 Test Loss: 2.251 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.12450647354126
Epoch: 26, Steps: 17 | Train Loss: 0.798 Vali Loss: 2.070 Vali Acc: 0.376 Test Loss: 2.070 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.8178296089172363
Epoch: 27, Steps: 17 | Train Loss: 0.701 Vali Loss: 2.747 Vali Acc: 0.346 Test Loss: 2.747 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.239504337310791
Epoch: 28, Steps: 17 | Train Loss: 0.710 Vali Loss: 2.393 Vali Acc: 0.354 Test Loss: 2.393 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.365107297897339
Epoch: 29, Steps: 17 | Train Loss: 0.572 Vali Loss: 2.212 Vali Acc: 0.335 Test Loss: 2.212 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.2016279697418213
Epoch: 30, Steps: 17 | Train Loss: 0.486 Vali Loss: 2.604 Vali Acc: 0.376 Test Loss: 2.604 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.8642971515655518
Epoch: 31, Steps: 17 | Train Loss: 0.507 Vali Loss: 2.310 Vali Acc: 0.376 Test Loss: 2.310 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.584697484970093
Epoch: 32, Steps: 17 | Train Loss: 0.360 Vali Loss: 2.252 Vali Acc: 0.350 Test Loss: 2.252 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.276773691177368
Epoch: 33, Steps: 17 | Train Loss: 0.350 Vali Loss: 3.266 Vali Acc: 0.319 Test Loss: 3.266 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 2245044
model size : 11.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.285474538803101
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.406 Vali Acc: 0.259 Test Loss: 1.406 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 4.660529613494873
Epoch: 2, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.477 Vali Acc: 0.255 Test Loss: 1.477 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.830359935760498
Epoch: 3, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.650 Vali Acc: 0.240 Test Loss: 1.650 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.4378204345703125
Epoch: 4, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.544 Vali Acc: 0.304 Test Loss: 1.544 Test Acc: 0.304
Validation loss decreased (-0.258541 --> -0.304167).  Saving model ...
Epoch: 5 cost time: 4.840821981430054
Epoch: 5, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.512 Vali Acc: 0.270 Test Loss: 1.512 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.304590940475464
Epoch: 6, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.508 Vali Acc: 0.270 Test Loss: 1.508 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.2439398765563965
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.480 Vali Acc: 0.274 Test Loss: 1.480 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.210893869400024
Epoch: 8, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.506 Vali Acc: 0.240 Test Loss: 1.506 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.179603815078735
Epoch: 9, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.467 Vali Acc: 0.278 Test Loss: 1.467 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.946002006530762
Epoch: 10, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.495 Vali Acc: 0.266 Test Loss: 1.495 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.8009090423583984
Epoch: 11, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.642 Vali Acc: 0.262 Test Loss: 1.642 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.244501113891602
Epoch: 12, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.590 Vali Acc: 0.308 Test Loss: 1.590 Test Acc: 0.308
Validation loss decreased (-0.304167 --> -0.307969).  Saving model ...
Epoch: 13 cost time: 4.292121887207031
Epoch: 13, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.531 Vali Acc: 0.297 Test Loss: 1.531 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.668825149536133
Epoch: 14, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.870 Vali Acc: 0.285 Test Loss: 1.870 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.639273643493652
Epoch: 15, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.496 Vali Acc: 0.338 Test Loss: 1.496 Test Acc: 0.338
Validation loss decreased (-0.307969 --> -0.338388).  Saving model ...
Epoch: 16 cost time: 4.334141492843628
Epoch: 16, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.524 Vali Acc: 0.361 Test Loss: 1.524 Test Acc: 0.361
Validation loss decreased (-0.338388 --> -0.361201).  Saving model ...
Epoch: 17 cost time: 3.7153985500335693
Epoch: 17, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.606 Vali Acc: 0.338 Test Loss: 1.606 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.072829484939575
Epoch: 18, Steps: 17 | Train Loss: 0.868 Vali Loss: 1.599 Vali Acc: 0.346 Test Loss: 1.599 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.833919525146484
Epoch: 19, Steps: 17 | Train Loss: 0.804 Vali Loss: 1.571 Vali Acc: 0.357 Test Loss: 1.571 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.11745810508728
Epoch: 20, Steps: 17 | Train Loss: 0.768 Vali Loss: 1.611 Vali Acc: 0.357 Test Loss: 1.611 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.4817259311676025
Epoch: 21, Steps: 17 | Train Loss: 0.740 Vali Loss: 1.765 Vali Acc: 0.331 Test Loss: 1.765 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.156982660293579
Epoch: 22, Steps: 17 | Train Loss: 0.759 Vali Loss: 1.836 Vali Acc: 0.388 Test Loss: 1.836 Test Acc: 0.388
Validation loss decreased (-0.361201 --> -0.387814).  Saving model ...
Epoch: 23 cost time: 3.198491096496582
Epoch: 23, Steps: 17 | Train Loss: 0.709 Vali Loss: 1.914 Vali Acc: 0.369 Test Loss: 1.914 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.514441728591919
Epoch: 24, Steps: 17 | Train Loss: 0.640 Vali Loss: 1.820 Vali Acc: 0.357 Test Loss: 1.820 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.7935831546783447
Epoch: 25, Steps: 17 | Train Loss: 0.628 Vali Loss: 2.342 Vali Acc: 0.354 Test Loss: 2.342 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.237163782119751
Epoch: 26, Steps: 17 | Train Loss: 0.646 Vali Loss: 1.898 Vali Acc: 0.369 Test Loss: 1.898 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.393103122711182
Epoch: 27, Steps: 17 | Train Loss: 0.581 Vali Loss: 2.133 Vali Acc: 0.357 Test Loss: 2.133 Test Acc: 0.357
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.038628578186035
Epoch: 28, Steps: 17 | Train Loss: 0.581 Vali Loss: 1.993 Vali Acc: 0.376 Test Loss: 1.993 Test Acc: 0.376
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.552772283554077
Epoch: 29, Steps: 17 | Train Loss: 0.636 Vali Loss: 1.882 Vali Acc: 0.384 Test Loss: 1.882 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.312748432159424
Epoch: 30, Steps: 17 | Train Loss: 0.531 Vali Loss: 2.029 Vali Acc: 0.357 Test Loss: 2.029 Test Acc: 0.357
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.1629719734191895
Epoch: 31, Steps: 17 | Train Loss: 0.446 Vali Loss: 1.969 Vali Acc: 0.388 Test Loss: 1.969 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.689011812210083
Epoch: 32, Steps: 17 | Train Loss: 0.448 Vali Loss: 1.969 Vali Acc: 0.346 Test Loss: 1.969 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38783269961977185
model parameter : 1522484
model size : 7.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.089029312133789
Epoch: 1, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.395 Vali Acc: 0.236 Test Loss: 1.395 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 4.817475318908691
Epoch: 2, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.432 Vali Acc: 0.240 Test Loss: 1.432 Test Acc: 0.240
Validation loss decreased (-0.235727 --> -0.239529).  Saving model ...
Epoch: 3 cost time: 4.2791454792022705
Epoch: 3, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.411 Vali Acc: 0.270 Test Loss: 1.411 Test Acc: 0.270
Validation loss decreased (-0.239529 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 4.756346702575684
Epoch: 4, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.433 Vali Acc: 0.262 Test Loss: 1.433 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.173191070556641
Epoch: 5, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.576 Vali Acc: 0.281 Test Loss: 1.576 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281353).  Saving model ...
Epoch: 6 cost time: 4.121906995773315
Epoch: 6, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.589 Vali Acc: 0.285 Test Loss: 1.589 Test Acc: 0.285
Validation loss decreased (-0.281353 --> -0.285155).  Saving model ...
Epoch: 7 cost time: 4.618406772613525
Epoch: 7, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.733 Vali Acc: 0.274 Test Loss: 1.733 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.4766175746917725
Epoch: 8, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.479 Vali Acc: 0.285 Test Loss: 1.479 Test Acc: 0.285
Validation loss decreased (-0.285155 --> -0.285156).  Saving model ...
Epoch: 9 cost time: 4.832683563232422
Epoch: 9, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.150854587554932
Epoch: 10, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.628 Vali Acc: 0.289 Test Loss: 1.628 Test Acc: 0.289
Validation loss decreased (-0.285156 --> -0.288957).  Saving model ...
Epoch: 11 cost time: 4.465486288070679
Epoch: 11, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.693 Vali Acc: 0.304 Test Loss: 1.693 Test Acc: 0.304
Validation loss decreased (-0.288957 --> -0.304166).  Saving model ...
Epoch: 12 cost time: 4.824012279510498
Epoch: 12, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.481 Vali Acc: 0.354 Test Loss: 1.481 Test Acc: 0.354
Validation loss decreased (-0.304166 --> -0.353597).  Saving model ...
Epoch: 13 cost time: 4.453492879867554
Epoch: 13, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.601 Vali Acc: 0.293 Test Loss: 1.601 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2833619117736816
Epoch: 14, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.601 Vali Acc: 0.354 Test Loss: 1.601 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.146134614944458
Epoch: 15, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.535 Vali Acc: 0.335 Test Loss: 1.535 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.418270587921143
Epoch: 16, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.518 Vali Acc: 0.380 Test Loss: 1.518 Test Acc: 0.380
Validation loss decreased (-0.353597 --> -0.380213).  Saving model ...
Epoch: 17 cost time: 4.8450703620910645
Epoch: 17, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.493 Vali Acc: 0.373 Test Loss: 1.493 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.898524284362793
Epoch: 18, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.450 Vali Acc: 0.399 Test Loss: 1.450 Test Acc: 0.399
Validation loss decreased (-0.380213 --> -0.399225).  Saving model ...
Epoch: 19 cost time: 4.788008213043213
Epoch: 19, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.685 Vali Acc: 0.346 Test Loss: 1.685 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9585554599761963
Epoch: 20, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.621 Vali Acc: 0.384 Test Loss: 1.621 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.154237747192383
Epoch: 21, Steps: 17 | Train Loss: 0.794 Vali Loss: 1.611 Vali Acc: 0.357 Test Loss: 1.611 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.642483711242676
Epoch: 22, Steps: 17 | Train Loss: 0.725 Vali Loss: 1.661 Vali Acc: 0.376 Test Loss: 1.661 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.6634628772735596
Epoch: 23, Steps: 17 | Train Loss: 0.712 Vali Loss: 1.689 Vali Acc: 0.414 Test Loss: 1.689 Test Acc: 0.414
Validation loss decreased (-0.399225 --> -0.414432).  Saving model ...
Epoch: 24 cost time: 3.2952423095703125
Epoch: 24, Steps: 17 | Train Loss: 0.578 Vali Loss: 1.787 Vali Acc: 0.376 Test Loss: 1.787 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.1905879974365234
Epoch: 25, Steps: 17 | Train Loss: 0.653 Vali Loss: 1.671 Vali Acc: 0.433 Test Loss: 1.671 Test Acc: 0.433
Validation loss decreased (-0.414432 --> -0.433443).  Saving model ...
Epoch: 26 cost time: 3.914613962173462
Epoch: 26, Steps: 17 | Train Loss: 0.593 Vali Loss: 1.735 Vali Acc: 0.380 Test Loss: 1.735 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 4.646763801574707
Epoch: 27, Steps: 17 | Train Loss: 0.566 Vali Loss: 1.678 Vali Acc: 0.399 Test Loss: 1.678 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.229918479919434
Epoch: 28, Steps: 17 | Train Loss: 0.520 Vali Loss: 2.362 Vali Acc: 0.331 Test Loss: 2.362 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 4.865694284439087
Epoch: 29, Steps: 17 | Train Loss: 0.577 Vali Loss: 2.036 Vali Acc: 0.376 Test Loss: 2.036 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 4.319586753845215
Epoch: 30, Steps: 17 | Train Loss: 0.597 Vali Loss: 1.863 Vali Acc: 0.403 Test Loss: 1.863 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.615386486053467
Epoch: 31, Steps: 17 | Train Loss: 0.426 Vali Loss: 1.911 Vali Acc: 0.395 Test Loss: 1.911 Test Acc: 0.395
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.295758485794067
Epoch: 32, Steps: 17 | Train Loss: 0.511 Vali Loss: 2.246 Vali Acc: 0.403 Test Loss: 2.246 Test Acc: 0.403
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 4.802853345870972
Epoch: 33, Steps: 17 | Train Loss: 0.472 Vali Loss: 1.998 Vali Acc: 0.388 Test Loss: 1.998 Test Acc: 0.388
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 5.419914245605469
Epoch: 34, Steps: 17 | Train Loss: 0.371 Vali Loss: 2.238 Vali Acc: 0.433 Test Loss: 2.238 Test Acc: 0.433
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.970827579498291
Epoch: 35, Steps: 17 | Train Loss: 0.344 Vali Loss: 2.189 Vali Acc: 0.430 Test Loss: 2.189 Test Acc: 0.430
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.43346007604562736
model parameter : 1506100
model size : 7.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.896284341812134
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.445 Vali Acc: 0.247 Test Loss: 1.445 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 4.90272855758667
Epoch: 2, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.461 Vali Acc: 0.270 Test Loss: 1.461 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 3.423025608062744
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.445 Vali Acc: 0.259 Test Loss: 1.445 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.673459768295288
Epoch: 4, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.429 Vali Acc: 0.289 Test Loss: 1.429 Test Acc: 0.289
Validation loss decreased (-0.269947 --> -0.288959).  Saving model ...
Epoch: 5 cost time: 4.068403959274292
Epoch: 5, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.491 Vali Acc: 0.297 Test Loss: 1.491 Test Acc: 0.297
Validation loss decreased (-0.288959 --> -0.296563).  Saving model ...
Epoch: 6 cost time: 3.665074348449707
Epoch: 6, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.564 Vali Acc: 0.274 Test Loss: 1.564 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.292287826538086
Epoch: 7, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.449 Vali Acc: 0.278 Test Loss: 1.449 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.761099338531494
Epoch: 8, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.608 Vali Acc: 0.278 Test Loss: 1.608 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.950687885284424
Epoch: 9, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.428 Vali Acc: 0.308 Test Loss: 1.428 Test Acc: 0.308
Validation loss decreased (-0.296563 --> -0.307971).  Saving model ...
Epoch: 10 cost time: 4.115284442901611
Epoch: 10, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.481 Vali Acc: 0.323 Test Loss: 1.481 Test Acc: 0.323
Validation loss decreased (-0.307971 --> -0.323179).  Saving model ...
Epoch: 11 cost time: 4.3513147830963135
Epoch: 11, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.492 Vali Acc: 0.319 Test Loss: 1.492 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.958991527557373
Epoch: 12, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.766 Vali Acc: 0.266 Test Loss: 1.766 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.511024713516235
Epoch: 13, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.566 Vali Acc: 0.373 Test Loss: 1.566 Test Acc: 0.373
Validation loss decreased (-0.323179 --> -0.372608).  Saving model ...
Epoch: 14 cost time: 5.109139680862427
Epoch: 14, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.486 Vali Acc: 0.361 Test Loss: 1.486 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8189125061035156
Epoch: 15, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.520 Vali Acc: 0.388 Test Loss: 1.520 Test Acc: 0.388
Validation loss decreased (-0.372608 --> -0.387817).  Saving model ...
Epoch: 16 cost time: 3.9474973678588867
Epoch: 16, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.515 Vali Acc: 0.392 Test Loss: 1.515 Test Acc: 0.392
Validation loss decreased (-0.387817 --> -0.391620).  Saving model ...
Epoch: 17 cost time: 4.963085412979126
Epoch: 17, Steps: 17 | Train Loss: 0.870 Vali Loss: 1.741 Vali Acc: 0.350 Test Loss: 1.741 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.165956020355225
Epoch: 18, Steps: 17 | Train Loss: 0.783 Vali Loss: 1.575 Vali Acc: 0.411 Test Loss: 1.575 Test Acc: 0.411
Validation loss decreased (-0.391620 --> -0.410631).  Saving model ...
Epoch: 19 cost time: 4.407061815261841
Epoch: 19, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.742 Vali Acc: 0.319 Test Loss: 1.742 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8399863243103027
Epoch: 20, Steps: 17 | Train Loss: 0.696 Vali Loss: 1.577 Vali Acc: 0.426 Test Loss: 1.577 Test Acc: 0.426
Validation loss decreased (-0.410631 --> -0.425840).  Saving model ...
Epoch: 21 cost time: 3.8701558113098145
Epoch: 21, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.062 Vali Acc: 0.308 Test Loss: 2.062 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.339319705963135
Epoch: 22, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.747 Vali Acc: 0.384 Test Loss: 1.747 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.159574508666992
Epoch: 23, Steps: 17 | Train Loss: 0.665 Vali Loss: 1.869 Vali Acc: 0.361 Test Loss: 1.869 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.192734479904175
Epoch: 24, Steps: 17 | Train Loss: 0.617 Vali Loss: 1.832 Vali Acc: 0.376 Test Loss: 1.832 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.276047706604004
Epoch: 25, Steps: 17 | Train Loss: 0.566 Vali Loss: 1.880 Vali Acc: 0.384 Test Loss: 1.880 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.638611078262329
Epoch: 26, Steps: 17 | Train Loss: 0.676 Vali Loss: 2.109 Vali Acc: 0.392 Test Loss: 2.109 Test Acc: 0.392
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.20428466796875
Epoch: 27, Steps: 17 | Train Loss: 0.490 Vali Loss: 1.889 Vali Acc: 0.418 Test Loss: 1.889 Test Acc: 0.418
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.5591747760772705
Epoch: 28, Steps: 17 | Train Loss: 0.494 Vali Loss: 2.227 Vali Acc: 0.323 Test Loss: 2.227 Test Acc: 0.323
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.0392115116119385
Epoch: 29, Steps: 17 | Train Loss: 0.559 Vali Loss: 2.137 Vali Acc: 0.395 Test Loss: 2.137 Test Acc: 0.395
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.351104974746704
Epoch: 30, Steps: 17 | Train Loss: 0.470 Vali Loss: 2.093 Vali Acc: 0.369 Test Loss: 2.093 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.42585551330798477
model parameter : 1489716
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.797577142715454
Epoch: 1, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.496 Vali Acc: 0.255 Test Loss: 1.496 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 2.72155499458313
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.546 Vali Acc: 0.247 Test Loss: 1.546 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.039756536483765
Epoch: 3, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.406 Vali Acc: 0.281 Test Loss: 1.406 Test Acc: 0.281
Validation loss decreased (-0.254738 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 3.387972593307495
Epoch: 4, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.468 Vali Acc: 0.262 Test Loss: 1.468 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.547149419784546
Epoch: 5, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.527 Vali Acc: 0.297 Test Loss: 1.527 Test Acc: 0.297
Validation loss decreased (-0.281355 --> -0.296563).  Saving model ...
Epoch: 6 cost time: 4.119447469711304
Epoch: 6, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.722 Vali Acc: 0.247 Test Loss: 1.722 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.067253828048706
Epoch: 7, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.432 Vali Acc: 0.262 Test Loss: 1.432 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2457821369171143
Epoch: 8, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.432 Vali Acc: 0.262 Test Loss: 1.432 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.196101665496826
Epoch: 9, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.464 Vali Acc: 0.274 Test Loss: 1.464 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9220447540283203
Epoch: 10, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.503 Vali Acc: 0.297 Test Loss: 1.503 Test Acc: 0.297
Validation loss decreased (-0.296563 --> -0.296563).  Saving model ...
Epoch: 11 cost time: 2.7578742504119873
Epoch: 11, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.520 Vali Acc: 0.293 Test Loss: 1.520 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.684605360031128
Epoch: 12, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.597 Vali Acc: 0.316 Test Loss: 1.597 Test Acc: 0.316
Validation loss decreased (-0.296563 --> -0.315573).  Saving model ...
Epoch: 13 cost time: 3.9531123638153076
Epoch: 13, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.659 Vali Acc: 0.304 Test Loss: 1.659 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3383493423461914
Epoch: 14, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.426 Vali Acc: 0.399 Test Loss: 1.426 Test Acc: 0.399
Validation loss decreased (-0.315573 --> -0.399225).  Saving model ...
Epoch: 15 cost time: 3.5615971088409424
Epoch: 15, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.520 Vali Acc: 0.361 Test Loss: 1.520 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.136850595474243
Epoch: 16, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.804 Vali Acc: 0.293 Test Loss: 1.804 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7795169353485107
Epoch: 17, Steps: 17 | Train Loss: 0.980 Vali Loss: 1.522 Vali Acc: 0.373 Test Loss: 1.522 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.8207008838653564
Epoch: 18, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.638 Vali Acc: 0.350 Test Loss: 1.638 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.7252275943756104
Epoch: 19, Steps: 17 | Train Loss: 0.836 Vali Loss: 1.559 Vali Acc: 0.373 Test Loss: 1.559 Test Acc: 0.373
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.8780288696289062
Epoch: 20, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.606 Vali Acc: 0.399 Test Loss: 1.606 Test Acc: 0.399
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.8637354373931885
Epoch: 21, Steps: 17 | Train Loss: 0.773 Vali Loss: 1.676 Vali Acc: 0.380 Test Loss: 1.676 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.205180406570435
Epoch: 22, Steps: 17 | Train Loss: 0.707 Vali Loss: 1.590 Vali Acc: 0.418 Test Loss: 1.590 Test Acc: 0.418
Validation loss decreased (-0.399225 --> -0.418235).  Saving model ...
Epoch: 23 cost time: 4.073950529098511
Epoch: 23, Steps: 17 | Train Loss: 0.746 Vali Loss: 1.783 Vali Acc: 0.354 Test Loss: 1.783 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.150636672973633
Epoch: 24, Steps: 17 | Train Loss: 0.746 Vali Loss: 1.822 Vali Acc: 0.384 Test Loss: 1.822 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.517230987548828
Epoch: 25, Steps: 17 | Train Loss: 0.687 Vali Loss: 1.807 Vali Acc: 0.357 Test Loss: 1.807 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.632603406906128
Epoch: 26, Steps: 17 | Train Loss: 0.608 Vali Loss: 1.914 Vali Acc: 0.433 Test Loss: 1.914 Test Acc: 0.433
Validation loss decreased (-0.418235 --> -0.433441).  Saving model ...
Epoch: 27 cost time: 3.9032864570617676
Epoch: 27, Steps: 17 | Train Loss: 0.499 Vali Loss: 1.929 Vali Acc: 0.361 Test Loss: 1.929 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.317673444747925
Epoch: 28, Steps: 17 | Train Loss: 0.631 Vali Loss: 1.881 Vali Acc: 0.380 Test Loss: 1.881 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.9379189014434814
Epoch: 29, Steps: 17 | Train Loss: 0.509 Vali Loss: 2.047 Vali Acc: 0.361 Test Loss: 2.047 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.8646624088287354
Epoch: 30, Steps: 17 | Train Loss: 0.491 Vali Loss: 2.417 Vali Acc: 0.346 Test Loss: 2.417 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.657069683074951
Epoch: 31, Steps: 17 | Train Loss: 0.423 Vali Loss: 2.091 Vali Acc: 0.342 Test Loss: 2.091 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.158345460891724
Epoch: 32, Steps: 17 | Train Loss: 0.428 Vali Loss: 2.270 Vali Acc: 0.365 Test Loss: 2.270 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.7962732315063477
Epoch: 33, Steps: 17 | Train Loss: 0.419 Vali Loss: 2.243 Vali Acc: 0.392 Test Loss: 2.243 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 3.167915105819702
Epoch: 34, Steps: 17 | Train Loss: 0.346 Vali Loss: 2.338 Vali Acc: 0.350 Test Loss: 2.338 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 3.732581615447998
Epoch: 35, Steps: 17 | Train Loss: 0.344 Vali Loss: 2.358 Vali Acc: 0.388 Test Loss: 2.358 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 3.759737253189087
Epoch: 36, Steps: 17 | Train Loss: 0.318 Vali Loss: 2.606 Vali Acc: 0.380 Test Loss: 2.606 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.43346007604562736
model parameter : 1473332
model size : 6.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.282694101333618
Epoch: 1, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.454 Vali Acc: 0.251 Test Loss: 1.454 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 4.178987503051758
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.478 Vali Acc: 0.224 Test Loss: 1.478 Test Acc: 0.224
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.459975004196167
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.567 Vali Acc: 0.255 Test Loss: 1.567 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254737).  Saving model ...
Epoch: 4 cost time: 3.361762285232544
Epoch: 4, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.458 Vali Acc: 0.259 Test Loss: 1.458 Test Acc: 0.259
Validation loss decreased (-0.254737 --> -0.258541).  Saving model ...
Epoch: 5 cost time: 3.8441243171691895
Epoch: 5, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.433 Vali Acc: 0.281 Test Loss: 1.433 Test Acc: 0.281
Validation loss decreased (-0.258541 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 4.1144890785217285
Epoch: 6, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.573 Vali Acc: 0.251 Test Loss: 1.573 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.821814775466919
Epoch: 7, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.861 Vali Acc: 0.247 Test Loss: 1.861 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.2186994552612305
Epoch: 8, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.667 Vali Acc: 0.236 Test Loss: 1.667 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.924947738647461
Epoch: 9, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.603 Vali Acc: 0.270 Test Loss: 1.603 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.63302755355835
Epoch: 10, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.501 Vali Acc: 0.255 Test Loss: 1.501 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.3564183712005615
Epoch: 11, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.485 Vali Acc: 0.297 Test Loss: 1.485 Test Acc: 0.297
Validation loss decreased (-0.281354 --> -0.296563).  Saving model ...
Epoch: 12 cost time: 5.490286111831665
Epoch: 12, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.727 Vali Acc: 0.247 Test Loss: 1.727 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.454932451248169
Epoch: 13, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.647 Vali Acc: 0.251 Test Loss: 1.647 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.736754655838013
Epoch: 14, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.498 Vali Acc: 0.297 Test Loss: 1.498 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.745258092880249
Epoch: 15, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.564 Vali Acc: 0.308 Test Loss: 1.564 Test Acc: 0.308
Validation loss decreased (-0.296563 --> -0.307969).  Saving model ...
Epoch: 16 cost time: 5.288154125213623
Epoch: 16, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.543 Vali Acc: 0.308 Test Loss: 1.543 Test Acc: 0.308
Validation loss decreased (-0.307969 --> -0.307969).  Saving model ...
Epoch: 17 cost time: 5.484628677368164
Epoch: 17, Steps: 17 | Train Loss: 0.848 Vali Loss: 1.491 Vali Acc: 0.350 Test Loss: 1.491 Test Acc: 0.350
Validation loss decreased (-0.307969 --> -0.349795).  Saving model ...
Epoch: 18 cost time: 4.194610595703125
Epoch: 18, Steps: 17 | Train Loss: 0.797 Vali Loss: 1.534 Vali Acc: 0.357 Test Loss: 1.534 Test Acc: 0.357
Validation loss decreased (-0.349795 --> -0.357399).  Saving model ...
Epoch: 19 cost time: 4.086842060089111
Epoch: 19, Steps: 17 | Train Loss: 0.790 Vali Loss: 1.921 Vali Acc: 0.297 Test Loss: 1.921 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.719907283782959
Epoch: 20, Steps: 17 | Train Loss: 0.884 Vali Loss: 1.608 Vali Acc: 0.384 Test Loss: 1.608 Test Acc: 0.384
Validation loss decreased (-0.357399 --> -0.384014).  Saving model ...
Epoch: 21 cost time: 3.1373302936553955
Epoch: 21, Steps: 17 | Train Loss: 0.842 Vali Loss: 1.936 Vali Acc: 0.342 Test Loss: 1.936 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.126133680343628
Epoch: 22, Steps: 17 | Train Loss: 0.774 Vali Loss: 1.724 Vali Acc: 0.335 Test Loss: 1.724 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8955142498016357
Epoch: 23, Steps: 17 | Train Loss: 0.759 Vali Loss: 1.685 Vali Acc: 0.342 Test Loss: 1.685 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3739941120147705
Epoch: 24, Steps: 17 | Train Loss: 0.730 Vali Loss: 1.686 Vali Acc: 0.373 Test Loss: 1.686 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.246828317642212
Epoch: 25, Steps: 17 | Train Loss: 0.615 Vali Loss: 2.056 Vali Acc: 0.361 Test Loss: 2.056 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.449162006378174
Epoch: 26, Steps: 17 | Train Loss: 0.645 Vali Loss: 1.893 Vali Acc: 0.388 Test Loss: 1.893 Test Acc: 0.388
Validation loss decreased (-0.384014 --> -0.387814).  Saving model ...
Epoch: 27 cost time: 3.8453502655029297
Epoch: 27, Steps: 17 | Train Loss: 0.604 Vali Loss: 1.909 Vali Acc: 0.350 Test Loss: 1.909 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.260510444641113
Epoch: 28, Steps: 17 | Train Loss: 0.596 Vali Loss: 1.983 Vali Acc: 0.373 Test Loss: 1.983 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.55668306350708
Epoch: 29, Steps: 17 | Train Loss: 0.534 Vali Loss: 1.836 Vali Acc: 0.388 Test Loss: 1.836 Test Acc: 0.388
Validation loss decreased (-0.387814 --> -0.387814).  Saving model ...
Epoch: 30 cost time: 2.984433174133301
Epoch: 30, Steps: 17 | Train Loss: 0.470 Vali Loss: 1.963 Vali Acc: 0.388 Test Loss: 1.963 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.8597519397735596
Epoch: 31, Steps: 17 | Train Loss: 0.477 Vali Loss: 1.915 Vali Acc: 0.388 Test Loss: 1.915 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.649932384490967
Epoch: 32, Steps: 17 | Train Loss: 0.388 Vali Loss: 2.163 Vali Acc: 0.384 Test Loss: 2.163 Test Acc: 0.384
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.4025492668151855
Epoch: 33, Steps: 17 | Train Loss: 0.502 Vali Loss: 2.035 Vali Acc: 0.430 Test Loss: 2.035 Test Acc: 0.430
Validation loss decreased (-0.387814 --> -0.429637).  Saving model ...
Epoch: 34 cost time: 3.8171279430389404
Epoch: 34, Steps: 17 | Train Loss: 0.508 Vali Loss: 2.284 Vali Acc: 0.369 Test Loss: 2.284 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.4826033115386963
Epoch: 35, Steps: 17 | Train Loss: 0.349 Vali Loss: 2.315 Vali Acc: 0.373 Test Loss: 2.315 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.7155301570892334
Epoch: 36, Steps: 17 | Train Loss: 0.282 Vali Loss: 2.341 Vali Acc: 0.376 Test Loss: 2.341 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.496340751647949
Epoch: 37, Steps: 17 | Train Loss: 0.411 Vali Loss: 2.465 Vali Acc: 0.384 Test Loss: 2.465 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 4.1940765380859375
Epoch: 38, Steps: 17 | Train Loss: 0.300 Vali Loss: 2.407 Vali Acc: 0.403 Test Loss: 2.407 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.735149383544922
Epoch: 39, Steps: 17 | Train Loss: 0.284 Vali Loss: 2.417 Vali Acc: 0.388 Test Loss: 2.417 Test Acc: 0.388
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.9782326221466064
Epoch: 40, Steps: 17 | Train Loss: 0.286 Vali Loss: 2.740 Vali Acc: 0.388 Test Loss: 2.740 Test Acc: 0.388
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.851443290710449
Epoch: 41, Steps: 17 | Train Loss: 0.235 Vali Loss: 2.765 Vali Acc: 0.384 Test Loss: 2.765 Test Acc: 0.384
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.522325277328491
Epoch: 42, Steps: 17 | Train Loss: 0.266 Vali Loss: 2.530 Vali Acc: 0.403 Test Loss: 2.530 Test Acc: 0.403
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 5.090489625930786
Epoch: 43, Steps: 17 | Train Loss: 0.274 Vali Loss: 2.661 Vali Acc: 0.388 Test Loss: 2.661 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4296577946768061
model parameter : 1060148
model size : 5.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.289433002471924
Epoch: 1, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.456 Vali Acc: 0.259 Test Loss: 1.456 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 4.0683982372283936
Epoch: 2, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.529 Vali Acc: 0.251 Test Loss: 1.529 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.376246929168701
Epoch: 3, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.551 Vali Acc: 0.266 Test Loss: 1.551 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266144).  Saving model ...
Epoch: 4 cost time: 4.247168779373169
Epoch: 4, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.530 Vali Acc: 0.274 Test Loss: 1.530 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273749).  Saving model ...
Epoch: 5 cost time: 4.483897686004639
Epoch: 5, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.438 Vali Acc: 0.281 Test Loss: 1.438 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 4.194148302078247
Epoch: 6, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.447 Vali Acc: 0.247 Test Loss: 1.447 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.9909400939941406
Epoch: 7, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.466 Vali Acc: 0.255 Test Loss: 1.466 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.147709608078003
Epoch: 8, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.775 Vali Acc: 0.243 Test Loss: 1.775 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.663463354110718
Epoch: 9, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.552 Vali Acc: 0.285 Test Loss: 1.552 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285156).  Saving model ...
Epoch: 10 cost time: 4.6278181076049805
Epoch: 10, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.563 Vali Acc: 0.289 Test Loss: 1.563 Test Acc: 0.289
Validation loss decreased (-0.285156 --> -0.288958).  Saving model ...
Epoch: 11 cost time: 3.7283735275268555
Epoch: 11, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.522 Vali Acc: 0.274 Test Loss: 1.522 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.682375907897949
Epoch: 12, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.636 Vali Acc: 0.270 Test Loss: 1.636 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.57400107383728
Epoch: 13, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.590 Vali Acc: 0.308 Test Loss: 1.590 Test Acc: 0.308
Validation loss decreased (-0.288958 --> -0.307969).  Saving model ...
Epoch: 14 cost time: 3.8387389183044434
Epoch: 14, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.679 Vali Acc: 0.308 Test Loss: 1.679 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4480950832366943
Epoch: 15, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.706 Vali Acc: 0.308 Test Loss: 1.706 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.170074224472046
Epoch: 16, Steps: 17 | Train Loss: 1.005 Vali Loss: 1.606 Vali Acc: 0.357 Test Loss: 1.606 Test Acc: 0.357
Validation loss decreased (-0.307969 --> -0.357398).  Saving model ...
Epoch: 17 cost time: 3.3076984882354736
Epoch: 17, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.776 Vali Acc: 0.304 Test Loss: 1.776 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.266722679138184
Epoch: 18, Steps: 17 | Train Loss: 0.845 Vali Loss: 1.605 Vali Acc: 0.354 Test Loss: 1.605 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.7375595569610596
Epoch: 19, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.684 Vali Acc: 0.354 Test Loss: 1.684 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.6933798789978027
Epoch: 20, Steps: 17 | Train Loss: 0.773 Vali Loss: 1.566 Vali Acc: 0.403 Test Loss: 1.566 Test Acc: 0.403
Validation loss decreased (-0.357398 --> -0.403026).  Saving model ...
Epoch: 21 cost time: 4.921928644180298
Epoch: 21, Steps: 17 | Train Loss: 0.658 Vali Loss: 1.885 Vali Acc: 0.335 Test Loss: 1.885 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.8382508754730225
Epoch: 22, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.075 Vali Acc: 0.342 Test Loss: 2.075 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.234954118728638
Epoch: 23, Steps: 17 | Train Loss: 0.793 Vali Loss: 1.720 Vali Acc: 0.342 Test Loss: 1.720 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.2082295417785645
Epoch: 24, Steps: 17 | Train Loss: 0.573 Vali Loss: 1.845 Vali Acc: 0.388 Test Loss: 1.845 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.211981296539307
Epoch: 25, Steps: 17 | Train Loss: 0.614 Vali Loss: 1.880 Vali Acc: 0.335 Test Loss: 1.880 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.271414756774902
Epoch: 26, Steps: 17 | Train Loss: 0.665 Vali Loss: 1.983 Vali Acc: 0.373 Test Loss: 1.983 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.697109222412109
Epoch: 27, Steps: 17 | Train Loss: 0.524 Vali Loss: 2.035 Vali Acc: 0.388 Test Loss: 2.035 Test Acc: 0.388
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.573300123214722
Epoch: 28, Steps: 17 | Train Loss: 0.569 Vali Loss: 2.062 Vali Acc: 0.346 Test Loss: 2.062 Test Acc: 0.346
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.737416982650757
Epoch: 29, Steps: 17 | Train Loss: 0.423 Vali Loss: 2.120 Vali Acc: 0.361 Test Loss: 2.120 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.116994857788086
Epoch: 30, Steps: 17 | Train Loss: 0.443 Vali Loss: 2.074 Vali Acc: 0.365 Test Loss: 2.074 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.40304182509505704
model parameter : 1043764
model size : 5.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.428563117980957
Epoch: 1, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.411 Vali Acc: 0.247 Test Loss: 1.411 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 4.263141870498657
Epoch: 2, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.545 Vali Acc: 0.270 Test Loss: 1.545 Test Acc: 0.270
Validation loss decreased (-0.247134 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 3.8306326866149902
Epoch: 3, Steps: 17 | Train Loss: 1.510 Vali Loss: 1.433 Vali Acc: 0.259 Test Loss: 1.433 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8000006675720215
Epoch: 4, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.445 Vali Acc: 0.308 Test Loss: 1.445 Test Acc: 0.308
Validation loss decreased (-0.269947 --> -0.307970).  Saving model ...
Epoch: 5 cost time: 3.1706104278564453
Epoch: 5, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.467 Vali Acc: 0.262 Test Loss: 1.467 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.28204345703125
Epoch: 6, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.540 Vali Acc: 0.278 Test Loss: 1.540 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.340329885482788
Epoch: 7, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.595 Vali Acc: 0.255 Test Loss: 1.595 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.977731704711914
Epoch: 8, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.442 Vali Acc: 0.293 Test Loss: 1.442 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.35860538482666
Epoch: 9, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.552 Vali Acc: 0.266 Test Loss: 1.552 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.715459108352661
Epoch: 10, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.611 Vali Acc: 0.274 Test Loss: 1.611 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.8688955307006836
Epoch: 11, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.599 Vali Acc: 0.304 Test Loss: 1.599 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.9220545291900635
Epoch: 12, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.753 Vali Acc: 0.289 Test Loss: 1.753 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.471023082733154
Epoch: 13, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.420 Vali Acc: 0.354 Test Loss: 1.420 Test Acc: 0.354
Validation loss decreased (-0.307970 --> -0.353598).  Saving model ...
Epoch: 14 cost time: 5.094639301300049
Epoch: 14, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.601 Vali Acc: 0.335 Test Loss: 1.601 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.207397937774658
Epoch: 15, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.762 Vali Acc: 0.342 Test Loss: 1.762 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.23158073425293
Epoch: 16, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.433 Vali Acc: 0.418 Test Loss: 1.433 Test Acc: 0.418
Validation loss decreased (-0.353598 --> -0.418237).  Saving model ...
Epoch: 17 cost time: 3.9768714904785156
Epoch: 17, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.503 Vali Acc: 0.369 Test Loss: 1.503 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.086021661758423
Epoch: 18, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.742 Vali Acc: 0.354 Test Loss: 1.742 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.967950105667114
Epoch: 19, Steps: 17 | Train Loss: 0.906 Vali Loss: 1.682 Vali Acc: 0.361 Test Loss: 1.682 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.420053243637085
Epoch: 20, Steps: 17 | Train Loss: 0.775 Vali Loss: 1.511 Vali Acc: 0.411 Test Loss: 1.511 Test Acc: 0.411
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.6830925941467285
Epoch: 21, Steps: 17 | Train Loss: 0.744 Vali Loss: 1.646 Vali Acc: 0.392 Test Loss: 1.646 Test Acc: 0.392
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.067814588546753
Epoch: 22, Steps: 17 | Train Loss: 0.711 Vali Loss: 1.782 Vali Acc: 0.357 Test Loss: 1.782 Test Acc: 0.357
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.976600885391235
Epoch: 23, Steps: 17 | Train Loss: 0.661 Vali Loss: 1.747 Vali Acc: 0.399 Test Loss: 1.747 Test Acc: 0.399
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.645267486572266
Epoch: 24, Steps: 17 | Train Loss: 0.607 Vali Loss: 1.825 Vali Acc: 0.380 Test Loss: 1.825 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.2259016036987305
Epoch: 25, Steps: 17 | Train Loss: 0.666 Vali Loss: 1.963 Vali Acc: 0.369 Test Loss: 1.963 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.6427433490753174
Epoch: 26, Steps: 17 | Train Loss: 0.510 Vali Loss: 1.841 Vali Acc: 0.422 Test Loss: 1.841 Test Acc: 0.422
Validation loss decreased (-0.418237 --> -0.422035).  Saving model ...
Epoch: 27 cost time: 3.703062057495117
Epoch: 27, Steps: 17 | Train Loss: 0.484 Vali Loss: 1.803 Vali Acc: 0.407 Test Loss: 1.803 Test Acc: 0.407
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.939643144607544
Epoch: 28, Steps: 17 | Train Loss: 0.512 Vali Loss: 2.247 Vali Acc: 0.338 Test Loss: 2.247 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.912968873977661
Epoch: 29, Steps: 17 | Train Loss: 0.638 Vali Loss: 1.859 Vali Acc: 0.380 Test Loss: 1.859 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.3864312171936035
Epoch: 30, Steps: 17 | Train Loss: 0.567 Vali Loss: 1.995 Vali Acc: 0.376 Test Loss: 1.995 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.2402355670928955
Epoch: 31, Steps: 17 | Train Loss: 0.401 Vali Loss: 2.209 Vali Acc: 0.403 Test Loss: 2.209 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.147558689117432
Epoch: 32, Steps: 17 | Train Loss: 0.414 Vali Loss: 2.338 Vali Acc: 0.384 Test Loss: 2.338 Test Acc: 0.384
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.029522657394409
Epoch: 33, Steps: 17 | Train Loss: 0.419 Vali Loss: 2.188 Vali Acc: 0.384 Test Loss: 2.188 Test Acc: 0.384
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.512347459793091
Epoch: 34, Steps: 17 | Train Loss: 0.356 Vali Loss: 2.487 Vali Acc: 0.369 Test Loss: 2.487 Test Acc: 0.369
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 4.348717212677002
Epoch: 35, Steps: 17 | Train Loss: 0.361 Vali Loss: 2.360 Vali Acc: 0.369 Test Loss: 2.360 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.495806932449341
Epoch: 36, Steps: 17 | Train Loss: 0.290 Vali Loss: 2.613 Vali Acc: 0.403 Test Loss: 2.613 Test Acc: 0.403
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4220532319391635
model parameter : 1027380
model size : 5.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.794696569442749
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.468 Vali Acc: 0.255 Test Loss: 1.468 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 3.7859442234039307
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.447 Vali Acc: 0.243 Test Loss: 1.447 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.971849679946899
Epoch: 3, Steps: 17 | Train Loss: 1.504 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
Validation loss decreased (-0.254738 --> -0.266145).  Saving model ...
Epoch: 4 cost time: 4.584332227706909
Epoch: 4, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.543 Vali Acc: 0.255 Test Loss: 1.543 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.336538314819336
Epoch: 5, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.383 Vali Acc: 0.281 Test Loss: 1.383 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281355).  Saving model ...
Epoch: 6 cost time: 4.630303144454956
Epoch: 6, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.440 Vali Acc: 0.297 Test Loss: 1.440 Test Acc: 0.297
Validation loss decreased (-0.281355 --> -0.296564).  Saving model ...
Epoch: 7 cost time: 3.5773391723632812
Epoch: 7, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.525 Vali Acc: 0.259 Test Loss: 1.525 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.2757728099823
Epoch: 8, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.547 Vali Acc: 0.270 Test Loss: 1.547 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.363246440887451
Epoch: 9, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.490 Vali Acc: 0.312 Test Loss: 1.490 Test Acc: 0.312
Validation loss decreased (-0.296564 --> -0.311772).  Saving model ...
Epoch: 10 cost time: 3.020704507827759
Epoch: 10, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.589 Vali Acc: 0.255 Test Loss: 1.589 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4809682369232178
Epoch: 11, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.507 Vali Acc: 0.289 Test Loss: 1.507 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.975560188293457
Epoch: 12, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.627 Vali Acc: 0.285 Test Loss: 1.627 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1471619606018066
Epoch: 13, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.625 Vali Acc: 0.297 Test Loss: 1.625 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.665891408920288
Epoch: 14, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.585 Vali Acc: 0.335 Test Loss: 1.585 Test Acc: 0.335
Validation loss decreased (-0.311772 --> -0.334585).  Saving model ...
Epoch: 15 cost time: 4.143246173858643
Epoch: 15, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.580 Vali Acc: 0.319 Test Loss: 1.580 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.218482971191406
Epoch: 16, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.456 Vali Acc: 0.399 Test Loss: 1.456 Test Acc: 0.399
Validation loss decreased (-0.334585 --> -0.399225).  Saving model ...
Epoch: 17 cost time: 4.066149711608887
Epoch: 17, Steps: 17 | Train Loss: 0.836 Vali Loss: 1.513 Vali Acc: 0.411 Test Loss: 1.513 Test Acc: 0.411
Validation loss decreased (-0.399225 --> -0.410631).  Saving model ...
Epoch: 18 cost time: 3.725172519683838
Epoch: 18, Steps: 17 | Train Loss: 0.930 Vali Loss: 1.600 Vali Acc: 0.388 Test Loss: 1.600 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.220880746841431
Epoch: 19, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.656 Vali Acc: 0.395 Test Loss: 1.656 Test Acc: 0.395
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.715458869934082
Epoch: 20, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.643 Vali Acc: 0.346 Test Loss: 1.643 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.099593639373779
Epoch: 21, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.641 Vali Acc: 0.422 Test Loss: 1.641 Test Acc: 0.422
Validation loss decreased (-0.410631 --> -0.422037).  Saving model ...
Epoch: 22 cost time: 3.463636875152588
Epoch: 22, Steps: 17 | Train Loss: 0.785 Vali Loss: 1.714 Vali Acc: 0.369 Test Loss: 1.714 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.792668342590332
Epoch: 23, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.637 Vali Acc: 0.376 Test Loss: 1.637 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.210634708404541
Epoch: 24, Steps: 17 | Train Loss: 0.701 Vali Loss: 1.766 Vali Acc: 0.357 Test Loss: 1.766 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.206410646438599
Epoch: 25, Steps: 17 | Train Loss: 0.656 Vali Loss: 1.722 Vali Acc: 0.392 Test Loss: 1.722 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.058823585510254
Epoch: 26, Steps: 17 | Train Loss: 0.659 Vali Loss: 1.778 Vali Acc: 0.411 Test Loss: 1.778 Test Acc: 0.411
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.087775468826294
Epoch: 27, Steps: 17 | Train Loss: 0.682 Vali Loss: 2.165 Vali Acc: 0.331 Test Loss: 2.165 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.075949430465698
Epoch: 28, Steps: 17 | Train Loss: 0.785 Vali Loss: 1.885 Vali Acc: 0.354 Test Loss: 1.885 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.859278917312622
Epoch: 29, Steps: 17 | Train Loss: 0.635 Vali Loss: 2.319 Vali Acc: 0.388 Test Loss: 2.319 Test Acc: 0.388
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.6828725337982178
Epoch: 30, Steps: 17 | Train Loss: 0.597 Vali Loss: 2.182 Vali Acc: 0.373 Test Loss: 2.182 Test Acc: 0.373
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.006895065307617
Epoch: 31, Steps: 17 | Train Loss: 0.482 Vali Loss: 1.924 Vali Acc: 0.384 Test Loss: 1.924 Test Acc: 0.384
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4220532319391635
model parameter : 1010996
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.2525084018707275
Epoch: 1, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.398 Vali Acc: 0.224 Test Loss: 1.398 Test Acc: 0.224
Validation loss decreased (inf --> -0.224321).  Saving model ...
Epoch: 2 cost time: 4.488600492477417
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.470 Vali Acc: 0.251 Test Loss: 1.470 Test Acc: 0.251
Validation loss decreased (-0.224321 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 4.878280401229858
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.602 Vali Acc: 0.243 Test Loss: 1.602 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.4875712394714355
Epoch: 4, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.613 Vali Acc: 0.266 Test Loss: 1.613 Test Acc: 0.266
Validation loss decreased (-0.250936 --> -0.266144).  Saving model ...
Epoch: 5 cost time: 3.823800563812256
Epoch: 5, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.454 Vali Acc: 0.281 Test Loss: 1.454 Test Acc: 0.281
Validation loss decreased (-0.266144 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 3.7845523357391357
Epoch: 6, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.459 Vali Acc: 0.289 Test Loss: 1.459 Test Acc: 0.289
Validation loss decreased (-0.281354 --> -0.288959).  Saving model ...
Epoch: 7 cost time: 3.458845853805542
Epoch: 7, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.441 Vali Acc: 0.270 Test Loss: 1.441 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.791904926300049
Epoch: 8, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.538 Vali Acc: 0.251 Test Loss: 1.538 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.250831365585327
Epoch: 9, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.596 Vali Acc: 0.251 Test Loss: 1.596 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7752180099487305
Epoch: 10, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.680 Vali Acc: 0.316 Test Loss: 1.680 Test Acc: 0.316
Validation loss decreased (-0.288959 --> -0.315573).  Saving model ...
Epoch: 11 cost time: 4.529323101043701
Epoch: 11, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.610 Vali Acc: 0.270 Test Loss: 1.610 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.175723552703857
Epoch: 12, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.593 Vali Acc: 0.270 Test Loss: 1.593 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.168792009353638
Epoch: 13, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.599 Vali Acc: 0.304 Test Loss: 1.599 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.8468246459960938
Epoch: 14, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.581 Vali Acc: 0.293 Test Loss: 1.581 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.9555394649505615
Epoch: 15, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.681 Vali Acc: 0.312 Test Loss: 1.681 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.49147367477417
Epoch: 16, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.673 Vali Acc: 0.297 Test Loss: 1.673 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.352396249771118
Epoch: 17, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.819 Vali Acc: 0.319 Test Loss: 1.819 Test Acc: 0.319
Validation loss decreased (-0.315573 --> -0.319373).  Saving model ...
Epoch: 18 cost time: 4.398230075836182
Epoch: 18, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.531 Vali Acc: 0.354 Test Loss: 1.531 Test Acc: 0.354
Validation loss decreased (-0.319373 --> -0.353597).  Saving model ...
Epoch: 19 cost time: 4.207786798477173
Epoch: 19, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.546 Vali Acc: 0.350 Test Loss: 1.546 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8730435371398926
Epoch: 20, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.666 Vali Acc: 0.376 Test Loss: 1.666 Test Acc: 0.376
Validation loss decreased (-0.353597 --> -0.376409).  Saving model ...
Epoch: 21 cost time: 4.781552791595459
Epoch: 21, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.778 Vali Acc: 0.350 Test Loss: 1.778 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.897432804107666
Epoch: 22, Steps: 17 | Train Loss: 0.759 Vali Loss: 1.935 Vali Acc: 0.399 Test Loss: 1.935 Test Acc: 0.399
Validation loss decreased (-0.376409 --> -0.399220).  Saving model ...
Epoch: 23 cost time: 3.4250760078430176
Epoch: 23, Steps: 17 | Train Loss: 0.833 Vali Loss: 1.592 Vali Acc: 0.388 Test Loss: 1.592 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.9824142456054688
Epoch: 24, Steps: 17 | Train Loss: 0.800 Vali Loss: 2.054 Vali Acc: 0.331 Test Loss: 2.054 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.2145349979400635
Epoch: 25, Steps: 17 | Train Loss: 0.723 Vali Loss: 1.756 Vali Acc: 0.395 Test Loss: 1.756 Test Acc: 0.395
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.63802170753479
Epoch: 26, Steps: 17 | Train Loss: 0.638 Vali Loss: 1.786 Vali Acc: 0.357 Test Loss: 1.786 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.598431587219238
Epoch: 27, Steps: 17 | Train Loss: 0.677 Vali Loss: 1.947 Vali Acc: 0.319 Test Loss: 1.947 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.54778790473938
Epoch: 28, Steps: 17 | Train Loss: 0.769 Vali Loss: 1.951 Vali Acc: 0.342 Test Loss: 1.951 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.8011586666107178
Epoch: 29, Steps: 17 | Train Loss: 0.550 Vali Loss: 2.116 Vali Acc: 0.369 Test Loss: 2.116 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.7310545444488525
Epoch: 30, Steps: 17 | Train Loss: 0.539 Vali Loss: 2.172 Vali Acc: 0.338 Test Loss: 2.172 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.688568353652954
Epoch: 31, Steps: 17 | Train Loss: 0.517 Vali Loss: 2.548 Vali Acc: 0.308 Test Loss: 2.548 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.412431001663208
Epoch: 32, Steps: 17 | Train Loss: 0.497 Vali Loss: 2.005 Vali Acc: 0.411 Test Loss: 2.005 Test Acc: 0.411
Validation loss decreased (-0.399220 --> -0.410626).  Saving model ...
Epoch: 33 cost time: 3.5367226600646973
Epoch: 33, Steps: 17 | Train Loss: 0.417 Vali Loss: 2.312 Vali Acc: 0.300 Test Loss: 2.312 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.9378600120544434
Epoch: 34, Steps: 17 | Train Loss: 0.420 Vali Loss: 2.276 Vali Acc: 0.346 Test Loss: 2.276 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 4.509628772735596
Epoch: 35, Steps: 17 | Train Loss: 0.465 Vali Loss: 2.328 Vali Acc: 0.331 Test Loss: 2.328 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 4.952627182006836
Epoch: 36, Steps: 17 | Train Loss: 0.430 Vali Loss: 2.603 Vali Acc: 0.384 Test Loss: 2.603 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 4.229104518890381
Epoch: 37, Steps: 17 | Train Loss: 0.440 Vali Loss: 2.330 Vali Acc: 0.384 Test Loss: 2.330 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 4.064202070236206
Epoch: 38, Steps: 17 | Train Loss: 0.316 Vali Loss: 2.682 Vali Acc: 0.323 Test Loss: 2.682 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 4.230278015136719
Epoch: 39, Steps: 17 | Train Loss: 0.288 Vali Loss: 2.993 Vali Acc: 0.369 Test Loss: 2.993 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 4.410689830780029
Epoch: 40, Steps: 17 | Train Loss: 0.502 Vali Loss: 2.833 Vali Acc: 0.354 Test Loss: 2.833 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 4.938811779022217
Epoch: 41, Steps: 17 | Train Loss: 0.328 Vali Loss: 2.660 Vali Acc: 0.376 Test Loss: 2.660 Test Acc: 0.376
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 4.4045188426971436
Epoch: 42, Steps: 17 | Train Loss: 0.453 Vali Loss: 2.894 Vali Acc: 0.338 Test Loss: 2.894 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41064638783269963
model parameter : 828980
model size : 4.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.859710693359375
Epoch: 1, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.438 Vali Acc: 0.278 Test Loss: 1.438 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 3.536795139312744
Epoch: 2, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.605 Vali Acc: 0.221 Test Loss: 1.605 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.347775936126709
Epoch: 3, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.441 Vali Acc: 0.259 Test Loss: 1.441 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.6940290927886963
Epoch: 4, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.626 Vali Acc: 0.251 Test Loss: 1.626 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.384798526763916
Epoch: 5, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.460 Vali Acc: 0.300 Test Loss: 1.460 Test Acc: 0.300
Validation loss decreased (-0.277552 --> -0.300366).  Saving model ...
Epoch: 6 cost time: 4.703789472579956
Epoch: 6, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.427 Vali Acc: 0.266 Test Loss: 1.427 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.271871566772461
Epoch: 7, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.451 Vali Acc: 0.316 Test Loss: 1.451 Test Acc: 0.316
Validation loss decreased (-0.300366 --> -0.315575).  Saving model ...
Epoch: 8 cost time: 4.06789231300354
Epoch: 8, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.511 Vali Acc: 0.262 Test Loss: 1.511 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.32165265083313
Epoch: 9, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.507 Vali Acc: 0.243 Test Loss: 1.507 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.036232233047485
Epoch: 10, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.540 Vali Acc: 0.274 Test Loss: 1.540 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.242586135864258
Epoch: 11, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.537 Vali Acc: 0.289 Test Loss: 1.537 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.509048938751221
Epoch: 12, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.494 Vali Acc: 0.308 Test Loss: 1.494 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.884297609329224
Epoch: 13, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.585 Vali Acc: 0.331 Test Loss: 1.585 Test Acc: 0.331
Validation loss decreased (-0.315575 --> -0.330783).  Saving model ...
Epoch: 14 cost time: 4.38398551940918
Epoch: 14, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.535 Vali Acc: 0.327 Test Loss: 1.535 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4655070304870605
Epoch: 15, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.689 Vali Acc: 0.278 Test Loss: 1.689 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.897337913513184
Epoch: 16, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.641 Vali Acc: 0.357 Test Loss: 1.641 Test Acc: 0.357
Validation loss decreased (-0.330783 --> -0.357398).  Saving model ...
Epoch: 17 cost time: 3.4439713954925537
Epoch: 17, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.623 Vali Acc: 0.342 Test Loss: 1.623 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.555854082107544
Epoch: 18, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.692 Vali Acc: 0.342 Test Loss: 1.692 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.383185625076294
Epoch: 19, Steps: 17 | Train Loss: 0.927 Vali Loss: 1.646 Vali Acc: 0.346 Test Loss: 1.646 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.064606428146362
Epoch: 20, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.651 Vali Acc: 0.380 Test Loss: 1.651 Test Acc: 0.380
Validation loss decreased (-0.357398 --> -0.380212).  Saving model ...
Epoch: 21 cost time: 4.847826242446899
Epoch: 21, Steps: 17 | Train Loss: 0.878 Vali Loss: 1.857 Vali Acc: 0.354 Test Loss: 1.857 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.803943634033203
Epoch: 22, Steps: 17 | Train Loss: 0.720 Vali Loss: 1.620 Vali Acc: 0.357 Test Loss: 1.620 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.35926365852356
Epoch: 23, Steps: 17 | Train Loss: 0.655 Vali Loss: 1.804 Vali Acc: 0.380 Test Loss: 1.804 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.889765501022339
Epoch: 24, Steps: 17 | Train Loss: 0.774 Vali Loss: 1.768 Vali Acc: 0.342 Test Loss: 1.768 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.511427879333496
Epoch: 25, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.781 Vali Acc: 0.361 Test Loss: 1.781 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.507532596588135
Epoch: 26, Steps: 17 | Train Loss: 0.618 Vali Loss: 1.885 Vali Acc: 0.338 Test Loss: 1.885 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.304838418960571
Epoch: 27, Steps: 17 | Train Loss: 0.610 Vali Loss: 1.896 Vali Acc: 0.380 Test Loss: 1.896 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.8021528720855713
Epoch: 28, Steps: 17 | Train Loss: 0.664 Vali Loss: 1.964 Vali Acc: 0.365 Test Loss: 1.964 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.427957057952881
Epoch: 29, Steps: 17 | Train Loss: 0.469 Vali Loss: 2.012 Vali Acc: 0.380 Test Loss: 2.012 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.1943228244781494
Epoch: 30, Steps: 17 | Train Loss: 0.534 Vali Loss: 2.053 Vali Acc: 0.342 Test Loss: 2.053 Test Acc: 0.342
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38022813688212925
model parameter : 812596
model size : 4.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.82361912727356
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.498 Vali Acc: 0.262 Test Loss: 1.498 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 3.2196707725524902
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.452 Vali Acc: 0.281 Test Loss: 1.452 Test Acc: 0.281
Validation loss decreased (-0.262342 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 5.677479982376099
Epoch: 3, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.560 Vali Acc: 0.278 Test Loss: 1.560 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.023617506027222
Epoch: 4, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.456 Vali Acc: 0.240 Test Loss: 1.456 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3528425693511963
Epoch: 5, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.595 Vali Acc: 0.266 Test Loss: 1.595 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.733631134033203
Epoch: 6, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.534 Vali Acc: 0.274 Test Loss: 1.534 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.597773313522339
Epoch: 7, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.778 Vali Acc: 0.293 Test Loss: 1.778 Test Acc: 0.293
Validation loss decreased (-0.281354 --> -0.292758).  Saving model ...
Epoch: 8 cost time: 2.783111333847046
Epoch: 8, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.562 Vali Acc: 0.255 Test Loss: 1.562 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.199000597000122
Epoch: 9, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.482 Vali Acc: 0.247 Test Loss: 1.482 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0000762939453125
Epoch: 10, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.543 Vali Acc: 0.251 Test Loss: 1.543 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.037479877471924
Epoch: 11, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.476 Vali Acc: 0.289 Test Loss: 1.476 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.613799333572388
Epoch: 12, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.511 Vali Acc: 0.278 Test Loss: 1.511 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.816824436187744
Epoch: 13, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.737 Vali Acc: 0.281 Test Loss: 1.737 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.1221020221710205
Epoch: 14, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.561 Vali Acc: 0.281 Test Loss: 1.561 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.742213010787964
Epoch: 15, Steps: 17 | Train Loss: 1.106 Vali Loss: 2.060 Vali Acc: 0.247 Test Loss: 2.060 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.7970964908599854
Epoch: 16, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.671 Vali Acc: 0.289 Test Loss: 1.671 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.057629585266113
Epoch: 17, Steps: 17 | Train Loss: 1.020 Vali Loss: 1.627 Vali Acc: 0.312 Test Loss: 1.627 Test Acc: 0.312
Validation loss decreased (-0.292758 --> -0.311771).  Saving model ...
Epoch: 18 cost time: 4.195401191711426
Epoch: 18, Steps: 17 | Train Loss: 0.839 Vali Loss: 1.730 Vali Acc: 0.342 Test Loss: 1.730 Test Acc: 0.342
Validation loss decreased (-0.311771 --> -0.342188).  Saving model ...
Epoch: 19 cost time: 3.9457764625549316
Epoch: 19, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.766 Vali Acc: 0.308 Test Loss: 1.766 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.261148929595947
Epoch: 20, Steps: 17 | Train Loss: 0.820 Vali Loss: 1.679 Vali Acc: 0.354 Test Loss: 1.679 Test Acc: 0.354
Validation loss decreased (-0.342188 --> -0.353595).  Saving model ...
Epoch: 21 cost time: 3.5150957107543945
Epoch: 21, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.717 Vali Acc: 0.354 Test Loss: 1.717 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.294043064117432
Epoch: 22, Steps: 17 | Train Loss: 0.747 Vali Loss: 1.682 Vali Acc: 0.384 Test Loss: 1.682 Test Acc: 0.384
Validation loss decreased (-0.353595 --> -0.384014).  Saving model ...
Epoch: 23 cost time: 4.536062717437744
Epoch: 23, Steps: 17 | Train Loss: 0.807 Vali Loss: 1.709 Vali Acc: 0.373 Test Loss: 1.709 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.070878505706787
Epoch: 24, Steps: 17 | Train Loss: 0.630 Vali Loss: 1.841 Vali Acc: 0.342 Test Loss: 1.841 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.1837759017944336
Epoch: 25, Steps: 17 | Train Loss: 0.624 Vali Loss: 1.793 Vali Acc: 0.361 Test Loss: 1.793 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.9621105194091797
Epoch: 26, Steps: 17 | Train Loss: 0.654 Vali Loss: 1.878 Vali Acc: 0.384 Test Loss: 1.878 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.5507259368896484
Epoch: 27, Steps: 17 | Train Loss: 0.519 Vali Loss: 2.119 Vali Acc: 0.323 Test Loss: 2.119 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.415503978729248
Epoch: 28, Steps: 17 | Train Loss: 0.586 Vali Loss: 1.989 Vali Acc: 0.361 Test Loss: 1.989 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.2385406494140625
Epoch: 29, Steps: 17 | Train Loss: 0.638 Vali Loss: 2.235 Vali Acc: 0.365 Test Loss: 2.235 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.595714807510376
Epoch: 30, Steps: 17 | Train Loss: 0.820 Vali Loss: 2.213 Vali Acc: 0.338 Test Loss: 2.213 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.7051594257354736
Epoch: 31, Steps: 17 | Train Loss: 0.466 Vali Loss: 1.977 Vali Acc: 0.388 Test Loss: 1.977 Test Acc: 0.388
Validation loss decreased (-0.384014 --> -0.387813).  Saving model ...
Epoch: 32 cost time: 4.143812417984009
Epoch: 32, Steps: 17 | Train Loss: 0.406 Vali Loss: 2.313 Vali Acc: 0.369 Test Loss: 2.313 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.128225326538086
Epoch: 33, Steps: 17 | Train Loss: 0.441 Vali Loss: 2.200 Vali Acc: 0.388 Test Loss: 2.200 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.028791666030884
Epoch: 34, Steps: 17 | Train Loss: 0.392 Vali Loss: 2.352 Vali Acc: 0.376 Test Loss: 2.352 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 4.285546541213989
Epoch: 35, Steps: 17 | Train Loss: 0.353 Vali Loss: 2.288 Vali Acc: 0.380 Test Loss: 2.288 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 4.722806215286255
Epoch: 36, Steps: 17 | Train Loss: 0.374 Vali Loss: 2.539 Vali Acc: 0.384 Test Loss: 2.539 Test Acc: 0.384
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 4.9992897510528564
Epoch: 37, Steps: 17 | Train Loss: 0.359 Vali Loss: 2.414 Vali Acc: 0.369 Test Loss: 2.414 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 4.515865325927734
Epoch: 38, Steps: 17 | Train Loss: 0.299 Vali Loss: 2.506 Vali Acc: 0.369 Test Loss: 2.506 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.0890002250671387
Epoch: 39, Steps: 17 | Train Loss: 0.342 Vali Loss: 2.555 Vali Acc: 0.380 Test Loss: 2.555 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.2133631706237793
Epoch: 40, Steps: 17 | Train Loss: 0.299 Vali Loss: 2.837 Vali Acc: 0.365 Test Loss: 2.837 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.7394371032714844
Epoch: 41, Steps: 17 | Train Loss: 0.245 Vali Loss: 2.641 Vali Acc: 0.395 Test Loss: 2.641 Test Acc: 0.395
Validation loss decreased (-0.387813 --> -0.395411).  Saving model ...
Epoch: 42 cost time: 4.613036155700684
Epoch: 42, Steps: 17 | Train Loss: 0.287 Vali Loss: 2.746 Vali Acc: 0.399 Test Loss: 2.746 Test Acc: 0.399
Validation loss decreased (-0.395411 --> -0.399212).  Saving model ...
Epoch: 43 cost time: 3.851547956466675
Epoch: 43, Steps: 17 | Train Loss: 0.276 Vali Loss: 2.899 Vali Acc: 0.384 Test Loss: 2.899 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 4.163095235824585
Epoch: 44, Steps: 17 | Train Loss: 0.286 Vali Loss: 2.733 Vali Acc: 0.422 Test Loss: 2.733 Test Acc: 0.422
Validation loss decreased (-0.399212 --> -0.422026).  Saving model ...
Epoch: 45 cost time: 4.523877143859863
Epoch: 45, Steps: 17 | Train Loss: 0.241 Vali Loss: 3.072 Vali Acc: 0.384 Test Loss: 3.072 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 3.976428747177124
Epoch: 46, Steps: 17 | Train Loss: 0.299 Vali Loss: 2.915 Vali Acc: 0.312 Test Loss: 2.915 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 3.7692878246307373
Epoch: 47, Steps: 17 | Train Loss: 0.173 Vali Loss: 3.113 Vali Acc: 0.342 Test Loss: 3.113 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 4.537848472595215
Epoch: 48, Steps: 17 | Train Loss: 0.134 Vali Loss: 3.150 Vali Acc: 0.403 Test Loss: 3.150 Test Acc: 0.403
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 3.409956455230713
Epoch: 49, Steps: 17 | Train Loss: 0.146 Vali Loss: 3.129 Vali Acc: 0.399 Test Loss: 3.129 Test Acc: 0.399
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 4.2517712116241455
Epoch: 50, Steps: 17 | Train Loss: 0.167 Vali Loss: 3.284 Vali Acc: 0.323 Test Loss: 3.284 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 3.4825360774993896
Epoch: 51, Steps: 17 | Train Loss: 0.129 Vali Loss: 3.490 Vali Acc: 0.422 Test Loss: 3.490 Test Acc: 0.422
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 3.159489631652832
Epoch: 52, Steps: 17 | Train Loss: 0.168 Vali Loss: 3.354 Vali Acc: 0.354 Test Loss: 3.354 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 3.9653849601745605
Epoch: 53, Steps: 17 | Train Loss: 0.102 Vali Loss: 3.548 Vali Acc: 0.369 Test Loss: 3.548 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 5.190180063247681
Epoch: 54, Steps: 17 | Train Loss: 0.103 Vali Loss: 3.531 Vali Acc: 0.365 Test Loss: 3.531 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4220532319391635
model parameter : 796212
model size : 4.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.750338077545166
Epoch: 1, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.422 Vali Acc: 0.262 Test Loss: 1.422 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 4.0664684772491455
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.406 Vali Acc: 0.278 Test Loss: 1.406 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 3.1615283489227295
Epoch: 3, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.525 Vali Acc: 0.259 Test Loss: 1.525 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2561275959014893
Epoch: 4, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.437 Vali Acc: 0.251 Test Loss: 1.437 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8908040523529053
Epoch: 5, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.521 Vali Acc: 0.251 Test Loss: 1.521 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.881777048110962
Epoch: 6, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.422 Vali Acc: 0.270 Test Loss: 1.422 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.7882471084594727
Epoch: 7, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.503 Vali Acc: 0.327 Test Loss: 1.503 Test Acc: 0.327
Validation loss decreased (-0.277552 --> -0.326981).  Saving model ...
Epoch: 8 cost time: 3.738703966140747
Epoch: 8, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.499 Vali Acc: 0.319 Test Loss: 1.499 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.59755277633667
Epoch: 9, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.439 Vali Acc: 0.274 Test Loss: 1.439 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7902419567108154
Epoch: 10, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.464 Vali Acc: 0.293 Test Loss: 1.464 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.394160509109497
Epoch: 11, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.473 Vali Acc: 0.281 Test Loss: 1.473 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9821736812591553
Epoch: 12, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.641 Vali Acc: 0.300 Test Loss: 1.641 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.8418798446655273
Epoch: 13, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.551 Vali Acc: 0.304 Test Loss: 1.551 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.991971731185913
Epoch: 14, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.573 Vali Acc: 0.278 Test Loss: 1.573 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.9553732872009277
Epoch: 15, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.676 Vali Acc: 0.308 Test Loss: 1.676 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.4215316772460938
Epoch: 16, Steps: 17 | Train Loss: 1.019 Vali Loss: 1.599 Vali Acc: 0.327 Test Loss: 1.599 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.6269960403442383
Epoch: 17, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.549 Vali Acc: 0.323 Test Loss: 1.549 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3269961977186312
model parameter : 779828
model size : 4.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 7.056036710739136
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.409 Vali Acc: 0.274 Test Loss: 1.409 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 4.753227233886719
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.563 Vali Acc: 0.247 Test Loss: 1.563 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.855450868606567
Epoch: 3, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.461 Vali Acc: 0.232 Test Loss: 1.461 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 4.1617958545684814
Epoch: 4, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.410 Vali Acc: 0.259 Test Loss: 1.410 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 4.551545143127441
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.438 Vali Acc: 0.270 Test Loss: 1.438 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.1355226039886475
Epoch: 6, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.413 Vali Acc: 0.285 Test Loss: 1.413 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285157).  Saving model ...
Epoch: 7 cost time: 3.670496940612793
Epoch: 7, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.457 Vali Acc: 0.274 Test Loss: 1.457 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.9177613258361816
Epoch: 8, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.515 Vali Acc: 0.270 Test Loss: 1.515 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.149695873260498
Epoch: 9, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.545 Vali Acc: 0.259 Test Loss: 1.545 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.3976526260375977
Epoch: 10, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.469 Vali Acc: 0.270 Test Loss: 1.469 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.137700319290161
Epoch: 11, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.564 Vali Acc: 0.270 Test Loss: 1.564 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.375362873077393
Epoch: 12, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.728 Vali Acc: 0.270 Test Loss: 1.728 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.5952682495117188
Epoch: 13, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.601 Vali Acc: 0.274 Test Loss: 1.601 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.26466703414917
Epoch: 14, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.768 Vali Acc: 0.266 Test Loss: 1.768 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.235442876815796
Epoch: 15, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.592 Vali Acc: 0.319 Test Loss: 1.592 Test Acc: 0.319
Validation loss decreased (-0.285157 --> -0.319376).  Saving model ...
Epoch: 16 cost time: 4.622728586196899
Epoch: 16, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.769 Vali Acc: 0.278 Test Loss: 1.769 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.745921611785889
Epoch: 17, Steps: 17 | Train Loss: 1.063 Vali Loss: 1.762 Vali Acc: 0.289 Test Loss: 1.762 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.9105775356292725
Epoch: 18, Steps: 17 | Train Loss: 0.954 Vali Loss: 1.532 Vali Acc: 0.357 Test Loss: 1.532 Test Acc: 0.357
Validation loss decreased (-0.319376 --> -0.357399).  Saving model ...
Epoch: 19 cost time: 3.1988067626953125
Epoch: 19, Steps: 17 | Train Loss: 0.851 Vali Loss: 1.570 Vali Acc: 0.369 Test Loss: 1.570 Test Acc: 0.369
Validation loss decreased (-0.357399 --> -0.368806).  Saving model ...
Epoch: 20 cost time: 3.1593472957611084
Epoch: 20, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.692 Vali Acc: 0.369 Test Loss: 1.692 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.466069459915161
Epoch: 21, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.658 Vali Acc: 0.395 Test Loss: 1.658 Test Acc: 0.395
Validation loss decreased (-0.368806 --> -0.395421).  Saving model ...
Epoch: 22 cost time: 4.318125009536743
Epoch: 22, Steps: 17 | Train Loss: 0.818 Vali Loss: 1.769 Vali Acc: 0.346 Test Loss: 1.769 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.241912364959717
Epoch: 23, Steps: 17 | Train Loss: 0.752 Vali Loss: 1.940 Vali Acc: 0.342 Test Loss: 1.940 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.267060041427612
Epoch: 24, Steps: 17 | Train Loss: 0.716 Vali Loss: 1.686 Vali Acc: 0.357 Test Loss: 1.686 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.5082032680511475
Epoch: 25, Steps: 17 | Train Loss: 0.656 Vali Loss: 1.622 Vali Acc: 0.414 Test Loss: 1.622 Test Acc: 0.414
Validation loss decreased (-0.395421 --> -0.414432).  Saving model ...
Epoch: 26 cost time: 4.931751489639282
Epoch: 26, Steps: 17 | Train Loss: 0.636 Vali Loss: 1.738 Vali Acc: 0.361 Test Loss: 1.738 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.205735683441162
Epoch: 27, Steps: 17 | Train Loss: 0.629 Vali Loss: 1.777 Vali Acc: 0.407 Test Loss: 1.777 Test Acc: 0.407
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 4.430749893188477
Epoch: 28, Steps: 17 | Train Loss: 0.651 Vali Loss: 1.924 Vali Acc: 0.350 Test Loss: 1.924 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6341376304626465
Epoch: 29, Steps: 17 | Train Loss: 0.569 Vali Loss: 2.130 Vali Acc: 0.373 Test Loss: 2.130 Test Acc: 0.373
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.7648937702178955
Epoch: 30, Steps: 17 | Train Loss: 0.595 Vali Loss: 1.853 Vali Acc: 0.380 Test Loss: 1.853 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.811453342437744
Epoch: 31, Steps: 17 | Train Loss: 0.479 Vali Loss: 2.010 Vali Acc: 0.384 Test Loss: 2.010 Test Acc: 0.384
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.832644462585449
Epoch: 32, Steps: 17 | Train Loss: 0.474 Vali Loss: 2.058 Vali Acc: 0.357 Test Loss: 2.058 Test Acc: 0.357
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.653080940246582
Epoch: 33, Steps: 17 | Train Loss: 0.412 Vali Loss: 2.159 Vali Acc: 0.380 Test Loss: 2.159 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.409326076507568
Epoch: 34, Steps: 17 | Train Loss: 0.416 Vali Loss: 2.142 Vali Acc: 0.388 Test Loss: 2.142 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 4.597856760025024
Epoch: 35, Steps: 17 | Train Loss: 0.422 Vali Loss: 2.337 Vali Acc: 0.365 Test Loss: 2.337 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 713396
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.427204370498657
Epoch: 1, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.399 Vali Acc: 0.266 Test Loss: 1.399 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 4.590749979019165
Epoch: 2, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.460 Vali Acc: 0.259 Test Loss: 1.460 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.852851152420044
Epoch: 3, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.493 Vali Acc: 0.270 Test Loss: 1.493 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 4.1569883823394775
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.396 Vali Acc: 0.278 Test Loss: 1.396 Test Acc: 0.278
Validation loss decreased (-0.269947 --> -0.277553).  Saving model ...
Epoch: 5 cost time: 3.477015495300293
Epoch: 5, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.529 Vali Acc: 0.262 Test Loss: 1.529 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.583160877227783
Epoch: 6, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.428 Vali Acc: 0.316 Test Loss: 1.428 Test Acc: 0.316
Validation loss decreased (-0.277553 --> -0.315575).  Saving model ...
Epoch: 7 cost time: 4.388734340667725
Epoch: 7, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.452 Vali Acc: 0.278 Test Loss: 1.452 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.288827657699585
Epoch: 8, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.847 Vali Acc: 0.247 Test Loss: 1.847 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.341986417770386
Epoch: 9, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.451 Vali Acc: 0.270 Test Loss: 1.451 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.3767712116241455
Epoch: 10, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.554 Vali Acc: 0.240 Test Loss: 1.554 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.31834864616394
Epoch: 11, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.514 Vali Acc: 0.281 Test Loss: 1.514 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.990651369094849
Epoch: 12, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.433 Vali Acc: 0.312 Test Loss: 1.433 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.538514852523804
Epoch: 13, Steps: 17 | Train Loss: 1.260 Vali Loss: 1.694 Vali Acc: 0.270 Test Loss: 1.694 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.426224946975708
Epoch: 14, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.762 Vali Acc: 0.281 Test Loss: 1.762 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.899369478225708
Epoch: 15, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.472 Vali Acc: 0.342 Test Loss: 1.472 Test Acc: 0.342
Validation loss decreased (-0.315575 --> -0.342191).  Saving model ...
Epoch: 16 cost time: 4.370445489883423
Epoch: 16, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.587 Vali Acc: 0.297 Test Loss: 1.587 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.3751637935638428
Epoch: 17, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.739 Vali Acc: 0.312 Test Loss: 1.739 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.041761159896851
Epoch: 18, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.636 Vali Acc: 0.338 Test Loss: 1.636 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.9643614292144775
Epoch: 19, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.630 Vali Acc: 0.331 Test Loss: 1.630 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.19282078742981
Epoch: 20, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.676 Vali Acc: 0.338 Test Loss: 1.676 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.8520145416259766
Epoch: 21, Steps: 17 | Train Loss: 0.777 Vali Loss: 1.561 Vali Acc: 0.384 Test Loss: 1.561 Test Acc: 0.384
Validation loss decreased (-0.342191 --> -0.384015).  Saving model ...
Epoch: 22 cost time: 2.9281351566314697
Epoch: 22, Steps: 17 | Train Loss: 0.768 Vali Loss: 1.657 Vali Acc: 0.338 Test Loss: 1.657 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.95159649848938
Epoch: 23, Steps: 17 | Train Loss: 0.677 Vali Loss: 1.715 Vali Acc: 0.365 Test Loss: 1.715 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.168302536010742
Epoch: 24, Steps: 17 | Train Loss: 0.791 Vali Loss: 2.048 Vali Acc: 0.342 Test Loss: 2.048 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.8164920806884766
Epoch: 25, Steps: 17 | Train Loss: 0.773 Vali Loss: 1.932 Vali Acc: 0.338 Test Loss: 1.932 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.680830955505371
Epoch: 26, Steps: 17 | Train Loss: 0.805 Vali Loss: 1.828 Vali Acc: 0.338 Test Loss: 1.828 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.58884596824646
Epoch: 27, Steps: 17 | Train Loss: 0.623 Vali Loss: 1.722 Vali Acc: 0.369 Test Loss: 1.722 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.253319025039673
Epoch: 28, Steps: 17 | Train Loss: 0.691 Vali Loss: 1.867 Vali Acc: 0.342 Test Loss: 1.867 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.09191370010376
Epoch: 29, Steps: 17 | Train Loss: 0.663 Vali Loss: 1.897 Vali Acc: 0.369 Test Loss: 1.897 Test Acc: 0.369
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.673199415206909
Epoch: 30, Steps: 17 | Train Loss: 0.478 Vali Loss: 1.978 Vali Acc: 0.395 Test Loss: 1.978 Test Acc: 0.395
Validation loss decreased (-0.384015 --> -0.395417).  Saving model ...
Epoch: 31 cost time: 4.1315319538116455
Epoch: 31, Steps: 17 | Train Loss: 0.539 Vali Loss: 1.876 Vali Acc: 0.354 Test Loss: 1.876 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.9197096824645996
Epoch: 32, Steps: 17 | Train Loss: 0.484 Vali Loss: 2.082 Vali Acc: 0.384 Test Loss: 2.082 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.410358905792236
Epoch: 33, Steps: 17 | Train Loss: 0.544 Vali Loss: 1.977 Vali Acc: 0.395 Test Loss: 1.977 Test Acc: 0.395
Validation loss decreased (-0.395417 --> -0.395417).  Saving model ...
Epoch: 34 cost time: 3.6891531944274902
Epoch: 34, Steps: 17 | Train Loss: 0.569 Vali Loss: 2.167 Vali Acc: 0.369 Test Loss: 2.167 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.490455150604248
Epoch: 35, Steps: 17 | Train Loss: 0.426 Vali Loss: 2.279 Vali Acc: 0.361 Test Loss: 2.279 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 4.270761489868164
Epoch: 36, Steps: 17 | Train Loss: 0.432 Vali Loss: 2.458 Vali Acc: 0.373 Test Loss: 2.458 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.820220947265625
Epoch: 37, Steps: 17 | Train Loss: 0.446 Vali Loss: 2.385 Vali Acc: 0.350 Test Loss: 2.385 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.81593918800354
Epoch: 38, Steps: 17 | Train Loss: 0.434 Vali Loss: 2.355 Vali Acc: 0.365 Test Loss: 2.355 Test Acc: 0.365
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.7843971252441406
Epoch: 39, Steps: 17 | Train Loss: 0.450 Vali Loss: 2.324 Vali Acc: 0.373 Test Loss: 2.324 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.931304693222046
Epoch: 40, Steps: 17 | Train Loss: 0.333 Vali Loss: 2.724 Vali Acc: 0.369 Test Loss: 2.724 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 4.299775838851929
Epoch: 41, Steps: 17 | Train Loss: 0.326 Vali Loss: 2.608 Vali Acc: 0.354 Test Loss: 2.608 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 4.144412994384766
Epoch: 42, Steps: 17 | Train Loss: 0.387 Vali Loss: 2.379 Vali Acc: 0.392 Test Loss: 2.379 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 4.140777349472046
Epoch: 43, Steps: 17 | Train Loss: 0.239 Vali Loss: 2.831 Vali Acc: 0.392 Test Loss: 2.831 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.39543726235741444
model parameter : 697012
model size : 4.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.686999559402466
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.394 Vali Acc: 0.278 Test Loss: 1.394 Test Acc: 0.278
Validation loss decreased (inf --> -0.277553).  Saving model ...
Epoch: 2 cost time: 3.8442442417144775
Epoch: 2, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.416 Vali Acc: 0.262 Test Loss: 1.416 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.658766984939575
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.501 Vali Acc: 0.266 Test Loss: 1.501 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.797267436981201
Epoch: 4, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.456 Vali Acc: 0.240 Test Loss: 1.456 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2691473960876465
Epoch: 5, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.487 Vali Acc: 0.270 Test Loss: 1.487 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 4.124751329421997
Epoch: 6, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.442 Vali Acc: 0.285 Test Loss: 1.442 Test Acc: 0.285
Validation loss decreased (-0.277553 --> -0.285157).  Saving model ...
Epoch: 7 cost time: 3.5798301696777344
Epoch: 7, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.397 Vali Acc: 0.300 Test Loss: 1.397 Test Acc: 0.300
Validation loss decreased (-0.285157 --> -0.300366).  Saving model ...
Epoch: 8 cost time: 4.243323564529419
Epoch: 8, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.411 Vali Acc: 0.297 Test Loss: 1.411 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.3324315547943115
Epoch: 9, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.657 Vali Acc: 0.247 Test Loss: 1.657 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.2169036865234375
Epoch: 10, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.749 Vali Acc: 0.255 Test Loss: 1.749 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.446068048477173
Epoch: 11, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.575 Vali Acc: 0.251 Test Loss: 1.575 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.687178134918213
Epoch: 12, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.484 Vali Acc: 0.319 Test Loss: 1.484 Test Acc: 0.319
Validation loss decreased (-0.300366 --> -0.319377).  Saving model ...
Epoch: 13 cost time: 4.7037928104400635
Epoch: 13, Steps: 17 | Train Loss: 1.134 Vali Loss: 1.537 Vali Acc: 0.327 Test Loss: 1.537 Test Acc: 0.327
Validation loss decreased (-0.319377 --> -0.326981).  Saving model ...
Epoch: 14 cost time: 4.621002674102783
Epoch: 14, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.539 Vali Acc: 0.300 Test Loss: 1.539 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.169101715087891
Epoch: 15, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.417 Vali Acc: 0.361 Test Loss: 1.417 Test Acc: 0.361
Validation loss decreased (-0.326981 --> -0.361203).  Saving model ...
Epoch: 16 cost time: 4.020720958709717
Epoch: 16, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.917 Vali Acc: 0.293 Test Loss: 1.917 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.094741106033325
Epoch: 17, Steps: 17 | Train Loss: 1.041 Vali Loss: 1.652 Vali Acc: 0.335 Test Loss: 1.652 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.6048901081085205
Epoch: 18, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.451 Vali Acc: 0.399 Test Loss: 1.451 Test Acc: 0.399
Validation loss decreased (-0.361203 --> -0.399225).  Saving model ...
Epoch: 19 cost time: 3.889486074447632
Epoch: 19, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.512 Vali Acc: 0.365 Test Loss: 1.512 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.195210933685303
Epoch: 20, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.426 Vali Acc: 0.384 Test Loss: 1.426 Test Acc: 0.384
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.386322259902954
Epoch: 21, Steps: 17 | Train Loss: 0.820 Vali Loss: 1.618 Vali Acc: 0.373 Test Loss: 1.618 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.378961086273193
Epoch: 22, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.681 Vali Acc: 0.369 Test Loss: 1.681 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.404345273971558
Epoch: 23, Steps: 17 | Train Loss: 0.762 Vali Loss: 1.648 Vali Acc: 0.399 Test Loss: 1.648 Test Acc: 0.399
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.676865339279175
Epoch: 24, Steps: 17 | Train Loss: 0.751 Vali Loss: 1.719 Vali Acc: 0.369 Test Loss: 1.719 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.8382606506347656
Epoch: 25, Steps: 17 | Train Loss: 0.745 Vali Loss: 1.793 Vali Acc: 0.323 Test Loss: 1.793 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 4.216314792633057
Epoch: 26, Steps: 17 | Train Loss: 0.759 Vali Loss: 1.706 Vali Acc: 0.361 Test Loss: 1.706 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.887084722518921
Epoch: 27, Steps: 17 | Train Loss: 0.647 Vali Loss: 1.983 Vali Acc: 0.357 Test Loss: 1.983 Test Acc: 0.357
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.3323230743408203
Epoch: 28, Steps: 17 | Train Loss: 0.808 Vali Loss: 1.852 Vali Acc: 0.369 Test Loss: 1.852 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.39923954372623577
model parameter : 680628
model size : 3.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.992525339126587
Epoch: 1, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.414 Vali Acc: 0.262 Test Loss: 1.414 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 3.6510767936706543
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.383 Vali Acc: 0.281 Test Loss: 1.383 Test Acc: 0.281
Validation loss decreased (-0.262343 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 3.2311341762542725
Epoch: 3, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.450 Vali Acc: 0.293 Test Loss: 1.450 Test Acc: 0.293
Validation loss decreased (-0.281355 --> -0.292761).  Saving model ...
Epoch: 4 cost time: 3.608175039291382
Epoch: 4, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.486 Vali Acc: 0.262 Test Loss: 1.486 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8609461784362793
Epoch: 5, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.391 Vali Acc: 0.293 Test Loss: 1.391 Test Acc: 0.293
Validation loss decreased (-0.292761 --> -0.292762).  Saving model ...
Epoch: 6 cost time: 3.5238959789276123
Epoch: 6, Steps: 17 | Train Loss: 1.616 Vali Loss: 1.648 Vali Acc: 0.312 Test Loss: 1.648 Test Acc: 0.312
Validation loss decreased (-0.292762 --> -0.311771).  Saving model ...
Epoch: 7 cost time: 2.942098617553711
Epoch: 7, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.784 Vali Acc: 0.247 Test Loss: 1.784 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.676201343536377
Epoch: 8, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.470 Vali Acc: 0.281 Test Loss: 1.470 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9024674892425537
Epoch: 9, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.420 Vali Acc: 0.289 Test Loss: 1.420 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1087067127227783
Epoch: 10, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.515 Vali Acc: 0.278 Test Loss: 1.515 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.2728397846221924
Epoch: 11, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.579 Vali Acc: 0.274 Test Loss: 1.579 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.218395709991455
Epoch: 12, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.561 Vali Acc: 0.297 Test Loss: 1.561 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.288475275039673
Epoch: 13, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.647 Vali Acc: 0.251 Test Loss: 1.647 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.1440000534057617
Epoch: 14, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.585 Vali Acc: 0.304 Test Loss: 1.585 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.111435890197754
Epoch: 15, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.605 Vali Acc: 0.316 Test Loss: 1.605 Test Acc: 0.316
Validation loss decreased (-0.311771 --> -0.315573).  Saving model ...
Epoch: 16 cost time: 3.9530441761016846
Epoch: 16, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.549 Vali Acc: 0.350 Test Loss: 1.549 Test Acc: 0.350
Validation loss decreased (-0.315573 --> -0.349794).  Saving model ...
Epoch: 17 cost time: 2.964487075805664
Epoch: 17, Steps: 17 | Train Loss: 0.972 Vali Loss: 1.505 Vali Acc: 0.357 Test Loss: 1.505 Test Acc: 0.357
Validation loss decreased (-0.349794 --> -0.357399).  Saving model ...
Epoch: 18 cost time: 2.7234349250793457
Epoch: 18, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.677 Vali Acc: 0.312 Test Loss: 1.677 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.684624195098877
Epoch: 19, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.533 Vali Acc: 0.418 Test Loss: 1.533 Test Acc: 0.418
Validation loss decreased (-0.357399 --> -0.418236).  Saving model ...
Epoch: 20 cost time: 2.975003957748413
Epoch: 20, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.620 Vali Acc: 0.335 Test Loss: 1.620 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.936077833175659
Epoch: 21, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.623 Vali Acc: 0.430 Test Loss: 1.623 Test Acc: 0.430
Validation loss decreased (-0.418236 --> -0.429642).  Saving model ...
Epoch: 22 cost time: 2.746695041656494
Epoch: 22, Steps: 17 | Train Loss: 0.676 Vali Loss: 1.744 Vali Acc: 0.380 Test Loss: 1.744 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.348745346069336
Epoch: 23, Steps: 17 | Train Loss: 0.768 Vali Loss: 1.714 Vali Acc: 0.335 Test Loss: 1.714 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.550956964492798
Epoch: 24, Steps: 17 | Train Loss: 0.704 Vali Loss: 1.684 Vali Acc: 0.392 Test Loss: 1.684 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.051511287689209
Epoch: 25, Steps: 17 | Train Loss: 0.761 Vali Loss: 2.073 Vali Acc: 0.361 Test Loss: 2.073 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.814944267272949
Epoch: 26, Steps: 17 | Train Loss: 0.589 Vali Loss: 1.708 Vali Acc: 0.395 Test Loss: 1.708 Test Acc: 0.395
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.1049182415008545
Epoch: 27, Steps: 17 | Train Loss: 0.599 Vali Loss: 1.870 Vali Acc: 0.395 Test Loss: 1.870 Test Acc: 0.395
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.0063037872314453
Epoch: 28, Steps: 17 | Train Loss: 0.595 Vali Loss: 1.895 Vali Acc: 0.376 Test Loss: 1.895 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.5218634605407715
Epoch: 29, Steps: 17 | Train Loss: 0.503 Vali Loss: 2.007 Vali Acc: 0.392 Test Loss: 2.007 Test Acc: 0.392
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.0527291297912598
Epoch: 30, Steps: 17 | Train Loss: 0.671 Vali Loss: 1.993 Vali Acc: 0.384 Test Loss: 1.993 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.508537530899048
Epoch: 31, Steps: 17 | Train Loss: 0.561 Vali Loss: 2.184 Vali Acc: 0.350 Test Loss: 2.184 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4296577946768061
model parameter : 664244
model size : 3.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.683458566665649
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.465 Vali Acc: 0.251 Test Loss: 1.465 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 3.328660249710083
Epoch: 2, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.422 Vali Acc: 0.278 Test Loss: 1.422 Test Acc: 0.278
Validation loss decreased (-0.250936 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 2.8734652996063232
Epoch: 3, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.490 Vali Acc: 0.243 Test Loss: 1.490 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.513627767562866
Epoch: 4, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.410 Vali Acc: 0.224 Test Loss: 1.410 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.3642325401306152
Epoch: 5, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.401 Vali Acc: 0.308 Test Loss: 1.401 Test Acc: 0.308
Validation loss decreased (-0.277552 --> -0.307971).  Saving model ...
Epoch: 6 cost time: 3.133408784866333
Epoch: 6, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.489 Vali Acc: 0.243 Test Loss: 1.489 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1438372135162354
Epoch: 7, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.519 Vali Acc: 0.262 Test Loss: 1.519 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.198652982711792
Epoch: 8, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.410 Vali Acc: 0.236 Test Loss: 1.410 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.4519455432891846
Epoch: 9, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.597 Vali Acc: 0.262 Test Loss: 1.597 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.464150905609131
Epoch: 10, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.571 Vali Acc: 0.262 Test Loss: 1.571 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.565014123916626
Epoch: 11, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.497 Vali Acc: 0.266 Test Loss: 1.497 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.640882968902588
Epoch: 12, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.426 Vali Acc: 0.285 Test Loss: 1.426 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.534400701522827
Epoch: 13, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.513 Vali Acc: 0.293 Test Loss: 1.513 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.6576013565063477
Epoch: 14, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.510 Vali Acc: 0.255 Test Loss: 1.510 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.1022369861602783
Epoch: 15, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.557 Vali Acc: 0.266 Test Loss: 1.557 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 650164
model size : 3.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.582521200180054
Epoch: 1, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.407 Vali Acc: 0.247 Test Loss: 1.407 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 2.979473114013672
Epoch: 2, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.517 Vali Acc: 0.247 Test Loss: 1.517 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2743823528289795
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.438 Vali Acc: 0.278 Test Loss: 1.438 Test Acc: 0.278
Validation loss decreased (-0.247134 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 3.285341262817383
Epoch: 4, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.443 Vali Acc: 0.308 Test Loss: 1.443 Test Acc: 0.308
Validation loss decreased (-0.277552 --> -0.307970).  Saving model ...
Epoch: 5 cost time: 3.366833448410034
Epoch: 5, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.425 Vali Acc: 0.312 Test Loss: 1.425 Test Acc: 0.312
Validation loss decreased (-0.307970 --> -0.311773).  Saving model ...
Epoch: 6 cost time: 3.2480573654174805
Epoch: 6, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.413 Vali Acc: 0.259 Test Loss: 1.413 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6333351135253906
Epoch: 7, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.404 Vali Acc: 0.297 Test Loss: 1.404 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.440007209777832
Epoch: 8, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.473 Vali Acc: 0.285 Test Loss: 1.473 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.6841909885406494
Epoch: 9, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.435 Vali Acc: 0.285 Test Loss: 1.435 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.346007823944092
Epoch: 10, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.455 Vali Acc: 0.270 Test Loss: 1.455 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1180942058563232
Epoch: 11, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.494 Vali Acc: 0.274 Test Loss: 1.494 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.9760677814483643
Epoch: 12, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.414 Vali Acc: 0.319 Test Loss: 1.414 Test Acc: 0.319
Validation loss decreased (-0.311773 --> -0.319377).  Saving model ...
Epoch: 13 cost time: 2.645573377609253
Epoch: 13, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.396 Vali Acc: 0.342 Test Loss: 1.396 Test Acc: 0.342
Validation loss decreased (-0.319377 --> -0.342191).  Saving model ...
Epoch: 14 cost time: 2.7855520248413086
Epoch: 14, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.420 Vali Acc: 0.346 Test Loss: 1.420 Test Acc: 0.346
Validation loss decreased (-0.342191 --> -0.345993).  Saving model ...
Epoch: 15 cost time: 3.6832501888275146
Epoch: 15, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.507 Vali Acc: 0.304 Test Loss: 1.507 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4337587356567383
Epoch: 16, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.429 Vali Acc: 0.342 Test Loss: 1.429 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.455881118774414
Epoch: 17, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.389 Vali Acc: 0.373 Test Loss: 1.389 Test Acc: 0.373
Validation loss decreased (-0.345993 --> -0.372610).  Saving model ...
Epoch: 18 cost time: 3.21606707572937
Epoch: 18, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.498 Vali Acc: 0.384 Test Loss: 1.498 Test Acc: 0.384
Validation loss decreased (-0.372610 --> -0.384015).  Saving model ...
Epoch: 19 cost time: 3.280808210372925
Epoch: 19, Steps: 17 | Train Loss: 0.923 Vali Loss: 1.545 Vali Acc: 0.365 Test Loss: 1.545 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.2985880374908447
Epoch: 20, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.427 Vali Acc: 0.392 Test Loss: 1.427 Test Acc: 0.392
Validation loss decreased (-0.384015 --> -0.391621).  Saving model ...
Epoch: 21 cost time: 3.8228728771209717
Epoch: 21, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.572 Vali Acc: 0.369 Test Loss: 1.572 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.283386707305908
Epoch: 22, Steps: 17 | Train Loss: 0.815 Vali Loss: 1.648 Vali Acc: 0.388 Test Loss: 1.648 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.2760727405548096
Epoch: 23, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.603 Vali Acc: 0.357 Test Loss: 1.603 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.6944990158081055
Epoch: 24, Steps: 17 | Train Loss: 0.762 Vali Loss: 1.463 Vali Acc: 0.449 Test Loss: 1.463 Test Acc: 0.449
Validation loss decreased (-0.391621 --> -0.448655).  Saving model ...
Epoch: 25 cost time: 3.510960817337036
Epoch: 25, Steps: 17 | Train Loss: 0.720 Vali Loss: 1.498 Vali Acc: 0.373 Test Loss: 1.498 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3865346908569336
Epoch: 26, Steps: 17 | Train Loss: 0.713 Vali Loss: 1.776 Vali Acc: 0.411 Test Loss: 1.776 Test Acc: 0.411
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.23875093460083
Epoch: 27, Steps: 17 | Train Loss: 0.685 Vali Loss: 1.533 Vali Acc: 0.395 Test Loss: 1.533 Test Acc: 0.395
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.792015552520752
Epoch: 28, Steps: 17 | Train Loss: 0.643 Vali Loss: 1.608 Vali Acc: 0.411 Test Loss: 1.608 Test Acc: 0.411
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.9144771099090576
Epoch: 29, Steps: 17 | Train Loss: 0.620 Vali Loss: 1.646 Vali Acc: 0.361 Test Loss: 1.646 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.5134410858154297
Epoch: 30, Steps: 17 | Train Loss: 0.670 Vali Loss: 1.739 Vali Acc: 0.346 Test Loss: 1.739 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.381516695022583
Epoch: 31, Steps: 17 | Train Loss: 0.558 Vali Loss: 1.678 Vali Acc: 0.388 Test Loss: 1.678 Test Acc: 0.388
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.2509663105010986
Epoch: 32, Steps: 17 | Train Loss: 0.539 Vali Loss: 1.968 Vali Acc: 0.373 Test Loss: 1.968 Test Acc: 0.373
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.2661631107330322
Epoch: 33, Steps: 17 | Train Loss: 0.550 Vali Loss: 1.770 Vali Acc: 0.369 Test Loss: 1.770 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.0211005210876465
Epoch: 34, Steps: 17 | Train Loss: 0.538 Vali Loss: 1.885 Vali Acc: 0.399 Test Loss: 1.885 Test Acc: 0.399
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.44866920152091255
model parameter : 641972
model size : 3.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.045420169830322
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.460 Vali Acc: 0.262 Test Loss: 1.460 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 3.1003904342651367
Epoch: 2, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.451 Vali Acc: 0.243 Test Loss: 1.451 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.7344961166381836
Epoch: 3, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.393 Vali Acc: 0.266 Test Loss: 1.393 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266146).  Saving model ...
Epoch: 4 cost time: 2.645651340484619
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.424 Vali Acc: 0.266 Test Loss: 1.424 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.080395460128784
Epoch: 5, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.548 Vali Acc: 0.266 Test Loss: 1.548 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.4495925903320312
Epoch: 6, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.447 Vali Acc: 0.285 Test Loss: 1.447 Test Acc: 0.285
Validation loss decreased (-0.266146 --> -0.285157).  Saving model ...
Epoch: 7 cost time: 2.880894184112549
Epoch: 7, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.443 Vali Acc: 0.259 Test Loss: 1.443 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.674114942550659
Epoch: 8, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.500 Vali Acc: 0.251 Test Loss: 1.500 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.737776279449463
Epoch: 9, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.427 Vali Acc: 0.293 Test Loss: 1.427 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292761).  Saving model ...
Epoch: 10 cost time: 3.2675039768218994
Epoch: 10, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.480 Vali Acc: 0.270 Test Loss: 1.480 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7328920364379883
Epoch: 11, Steps: 17 | Train Loss: 1.324 Vali Loss: 1.424 Vali Acc: 0.316 Test Loss: 1.424 Test Acc: 0.316
Validation loss decreased (-0.292761 --> -0.315575).  Saving model ...
Epoch: 12 cost time: 3.0833194255828857
Epoch: 12, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.449 Vali Acc: 0.308 Test Loss: 1.449 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4668385982513428
Epoch: 13, Steps: 17 | Train Loss: 1.206 Vali Loss: 1.429 Vali Acc: 0.293 Test Loss: 1.429 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0524284839630127
Epoch: 14, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.641 Vali Acc: 0.304 Test Loss: 1.641 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6171674728393555
Epoch: 15, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.390 Vali Acc: 0.331 Test Loss: 1.390 Test Acc: 0.331
Validation loss decreased (-0.315575 --> -0.330785).  Saving model ...
Epoch: 16 cost time: 2.8645777702331543
Epoch: 16, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.375 Vali Acc: 0.354 Test Loss: 1.375 Test Acc: 0.354
Validation loss decreased (-0.330785 --> -0.353598).  Saving model ...
Epoch: 17 cost time: 2.985347032546997
Epoch: 17, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.432 Vali Acc: 0.399 Test Loss: 1.432 Test Acc: 0.399
Validation loss decreased (-0.353598 --> -0.399225).  Saving model ...
Epoch: 18 cost time: 2.6827375888824463
Epoch: 18, Steps: 17 | Train Loss: 0.995 Vali Loss: 1.375 Vali Acc: 0.380 Test Loss: 1.375 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6967291831970215
Epoch: 19, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.423 Vali Acc: 0.380 Test Loss: 1.423 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.057358503341675
Epoch: 20, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.486 Vali Acc: 0.395 Test Loss: 1.486 Test Acc: 0.395
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.964841604232788
Epoch: 21, Steps: 17 | Train Loss: 0.889 Vali Loss: 1.564 Vali Acc: 0.403 Test Loss: 1.564 Test Acc: 0.403
Validation loss decreased (-0.399225 --> -0.403026).  Saving model ...
Epoch: 22 cost time: 2.687541961669922
Epoch: 22, Steps: 17 | Train Loss: 0.842 Vali Loss: 1.410 Vali Acc: 0.407 Test Loss: 1.410 Test Acc: 0.407
Validation loss decreased (-0.403026 --> -0.406830).  Saving model ...
Epoch: 23 cost time: 2.8929641246795654
Epoch: 23, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.448 Vali Acc: 0.407 Test Loss: 1.448 Test Acc: 0.407
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.928584337234497
Epoch: 24, Steps: 17 | Train Loss: 0.830 Vali Loss: 1.722 Vali Acc: 0.354 Test Loss: 1.722 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3347513675689697
Epoch: 25, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.612 Vali Acc: 0.354 Test Loss: 1.612 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.185364007949829
Epoch: 26, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.502 Vali Acc: 0.384 Test Loss: 1.502 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.1099698543548584
Epoch: 27, Steps: 17 | Train Loss: 0.764 Vali Loss: 1.625 Vali Acc: 0.422 Test Loss: 1.625 Test Acc: 0.422
Validation loss decreased (-0.406830 --> -0.422037).  Saving model ...
Epoch: 28 cost time: 3.1216461658477783
Epoch: 28, Steps: 17 | Train Loss: 0.728 Vali Loss: 1.601 Vali Acc: 0.411 Test Loss: 1.601 Test Acc: 0.411
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9027817249298096
Epoch: 29, Steps: 17 | Train Loss: 0.747 Vali Loss: 1.530 Vali Acc: 0.399 Test Loss: 1.530 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.44564151763916
Epoch: 30, Steps: 17 | Train Loss: 0.718 Vali Loss: 1.580 Vali Acc: 0.437 Test Loss: 1.580 Test Acc: 0.437
Validation loss decreased (-0.422037 --> -0.437247).  Saving model ...
Epoch: 31 cost time: 3.4472005367279053
Epoch: 31, Steps: 17 | Train Loss: 0.603 Vali Loss: 1.536 Vali Acc: 0.445 Test Loss: 1.536 Test Acc: 0.445
Validation loss decreased (-0.437247 --> -0.444852).  Saving model ...
Epoch: 32 cost time: 3.0927586555480957
Epoch: 32, Steps: 17 | Train Loss: 0.543 Vali Loss: 1.614 Vali Acc: 0.388 Test Loss: 1.614 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.15964412689209
Epoch: 33, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.659 Vali Acc: 0.399 Test Loss: 1.659 Test Acc: 0.399
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.9952232837677
Epoch: 34, Steps: 17 | Train Loss: 0.551 Vali Loss: 1.668 Vali Acc: 0.395 Test Loss: 1.668 Test Acc: 0.395
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.302323818206787
Epoch: 35, Steps: 17 | Train Loss: 0.621 Vali Loss: 1.816 Vali Acc: 0.399 Test Loss: 1.816 Test Acc: 0.399
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.2907817363739014
Epoch: 36, Steps: 17 | Train Loss: 0.517 Vali Loss: 1.737 Vali Acc: 0.388 Test Loss: 1.737 Test Acc: 0.388
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.677053928375244
Epoch: 37, Steps: 17 | Train Loss: 0.444 Vali Loss: 1.701 Vali Acc: 0.411 Test Loss: 1.701 Test Acc: 0.411
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.534130334854126
Epoch: 38, Steps: 17 | Train Loss: 0.516 Vali Loss: 1.754 Vali Acc: 0.380 Test Loss: 1.754 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.6647753715515137
Epoch: 39, Steps: 17 | Train Loss: 0.395 Vali Loss: 1.815 Vali Acc: 0.437 Test Loss: 1.815 Test Acc: 0.437
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.5259206295013428
Epoch: 40, Steps: 17 | Train Loss: 0.442 Vali Loss: 1.788 Vali Acc: 0.445 Test Loss: 1.788 Test Acc: 0.445
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.6373908519744873
Epoch: 41, Steps: 17 | Train Loss: 0.311 Vali Loss: 2.078 Vali Acc: 0.399 Test Loss: 2.078 Test Acc: 0.399
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4448669201520912
model parameter : 633780
model size : 3.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.03731632232666
Epoch: 1, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.409 Vali Acc: 0.236 Test Loss: 1.409 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 2.6084935665130615
Epoch: 2, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.426 Vali Acc: 0.251 Test Loss: 1.426 Test Acc: 0.251
Validation loss decreased (-0.235727 --> -0.250936).  Saving model ...
Epoch: 3 cost time: 2.7708425521850586
Epoch: 3, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.448 Vali Acc: 0.259 Test Loss: 1.448 Test Acc: 0.259
Validation loss decreased (-0.250936 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 2.5428028106689453
Epoch: 4, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.394 Vali Acc: 0.266 Test Loss: 1.394 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266146).  Saving model ...
Epoch: 5 cost time: 2.602997303009033
Epoch: 5, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.593 Vali Acc: 0.274 Test Loss: 1.593 Test Acc: 0.274
Validation loss decreased (-0.266146 --> -0.273748).  Saving model ...
Epoch: 6 cost time: 3.1371326446533203
Epoch: 6, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.511 Vali Acc: 0.270 Test Loss: 1.511 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1988039016723633
Epoch: 7, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.400 Vali Acc: 0.259 Test Loss: 1.400 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.155689001083374
Epoch: 8, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.436 Vali Acc: 0.251 Test Loss: 1.436 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.904493570327759
Epoch: 9, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.418 Vali Acc: 0.262 Test Loss: 1.418 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.230543613433838
Epoch: 10, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.503 Vali Acc: 0.251 Test Loss: 1.503 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.652585744857788
Epoch: 11, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.406 Vali Acc: 0.308 Test Loss: 1.406 Test Acc: 0.308
Validation loss decreased (-0.273748 --> -0.307971).  Saving model ...
Epoch: 12 cost time: 2.8159594535827637
Epoch: 12, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.448 Vali Acc: 0.331 Test Loss: 1.448 Test Acc: 0.331
Validation loss decreased (-0.307971 --> -0.330784).  Saving model ...
Epoch: 13 cost time: 2.741694927215576
Epoch: 13, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.561 Vali Acc: 0.297 Test Loss: 1.561 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5049495697021484
Epoch: 14, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.479 Vali Acc: 0.338 Test Loss: 1.479 Test Acc: 0.338
Validation loss decreased (-0.330784 --> -0.338388).  Saving model ...
Epoch: 15 cost time: 2.57707142829895
Epoch: 15, Steps: 17 | Train Loss: 1.183 Vali Loss: 1.375 Vali Acc: 0.357 Test Loss: 1.375 Test Acc: 0.357
Validation loss decreased (-0.338388 --> -0.357401).  Saving model ...
Epoch: 16 cost time: 2.865288734436035
Epoch: 16, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.536 Vali Acc: 0.312 Test Loss: 1.536 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.202758312225342
Epoch: 17, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.488 Vali Acc: 0.338 Test Loss: 1.488 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2255821228027344
Epoch: 18, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.455 Vali Acc: 0.350 Test Loss: 1.455 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.7161624431610107
Epoch: 19, Steps: 17 | Train Loss: 0.968 Vali Loss: 1.411 Vali Acc: 0.369 Test Loss: 1.411 Test Acc: 0.369
Validation loss decreased (-0.357401 --> -0.368807).  Saving model ...
Epoch: 20 cost time: 2.7471368312835693
Epoch: 20, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.458 Vali Acc: 0.388 Test Loss: 1.458 Test Acc: 0.388
Validation loss decreased (-0.368807 --> -0.387818).  Saving model ...
Epoch: 21 cost time: 2.779308557510376
Epoch: 21, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.360 Vali Acc: 0.392 Test Loss: 1.360 Test Acc: 0.392
Validation loss decreased (-0.387818 --> -0.391621).  Saving model ...
Epoch: 22 cost time: 2.878828287124634
Epoch: 22, Steps: 17 | Train Loss: 0.877 Vali Loss: 1.433 Vali Acc: 0.403 Test Loss: 1.433 Test Acc: 0.403
Validation loss decreased (-0.391621 --> -0.403027).  Saving model ...
Epoch: 23 cost time: 2.7935714721679688
Epoch: 23, Steps: 17 | Train Loss: 0.896 Vali Loss: 1.443 Vali Acc: 0.395 Test Loss: 1.443 Test Acc: 0.395
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.715568780899048
Epoch: 24, Steps: 17 | Train Loss: 0.861 Vali Loss: 1.421 Vali Acc: 0.376 Test Loss: 1.421 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.8859057426452637
Epoch: 25, Steps: 17 | Train Loss: 0.788 Vali Loss: 1.587 Vali Acc: 0.373 Test Loss: 1.587 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.279682159423828
Epoch: 26, Steps: 17 | Train Loss: 0.800 Vali Loss: 1.588 Vali Acc: 0.323 Test Loss: 1.588 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.1788365840911865
Epoch: 27, Steps: 17 | Train Loss: 0.639 Vali Loss: 1.669 Vali Acc: 0.361 Test Loss: 1.669 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.52846097946167
Epoch: 28, Steps: 17 | Train Loss: 0.684 Vali Loss: 1.534 Vali Acc: 0.403 Test Loss: 1.534 Test Acc: 0.403
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.7421624660491943
Epoch: 29, Steps: 17 | Train Loss: 0.677 Vali Loss: 1.676 Vali Acc: 0.373 Test Loss: 1.676 Test Acc: 0.373
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.7065727710723877
Epoch: 30, Steps: 17 | Train Loss: 0.639 Vali Loss: 1.604 Vali Acc: 0.399 Test Loss: 1.604 Test Acc: 0.399
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.38824725151062
Epoch: 31, Steps: 17 | Train Loss: 0.651 Vali Loss: 1.698 Vali Acc: 0.350 Test Loss: 1.698 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.5344927310943604
Epoch: 32, Steps: 17 | Train Loss: 0.644 Vali Loss: 1.559 Vali Acc: 0.388 Test Loss: 1.559 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.40304182509505704
model parameter : 625588
model size : 3.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.3985207080841064
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.402 Vali Acc: 0.247 Test Loss: 1.402 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 3.6190297603607178
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.436 Vali Acc: 0.247 Test Loss: 1.436 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7001094818115234
Epoch: 3, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.435 Vali Acc: 0.224 Test Loss: 1.435 Test Acc: 0.224
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.534221649169922
Epoch: 4, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.500 Vali Acc: 0.255 Test Loss: 1.500 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254738).  Saving model ...
Epoch: 5 cost time: 3.5431907176971436
Epoch: 5, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.424 Vali Acc: 0.270 Test Loss: 1.424 Test Acc: 0.270
Validation loss decreased (-0.254738 --> -0.269948).  Saving model ...
Epoch: 6 cost time: 3.951507091522217
Epoch: 6, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.444 Vali Acc: 0.270 Test Loss: 1.444 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7754011154174805
Epoch: 7, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.421 Vali Acc: 0.278 Test Loss: 1.421 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277552).  Saving model ...
Epoch: 8 cost time: 3.573906183242798
Epoch: 8, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.458 Vali Acc: 0.270 Test Loss: 1.458 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.346895933151245
Epoch: 9, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.553 Vali Acc: 0.251 Test Loss: 1.553 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0686020851135254
Epoch: 10, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.472 Vali Acc: 0.255 Test Loss: 1.472 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.033421754837036
Epoch: 11, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.407 Vali Acc: 0.289 Test Loss: 1.407 Test Acc: 0.289
Validation loss decreased (-0.277552 --> -0.288959).  Saving model ...
Epoch: 12 cost time: 2.764726400375366
Epoch: 12, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.462 Vali Acc: 0.278 Test Loss: 1.462 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4045321941375732
Epoch: 13, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.467 Vali Acc: 0.316 Test Loss: 1.467 Test Acc: 0.316
Validation loss decreased (-0.288959 --> -0.315575).  Saving model ...
Epoch: 14 cost time: 3.244704008102417
Epoch: 14, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.453 Vali Acc: 0.297 Test Loss: 1.453 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8223352432250977
Epoch: 15, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.416 Vali Acc: 0.316 Test Loss: 1.416 Test Acc: 0.316
Validation loss decreased (-0.315575 --> -0.315575).  Saving model ...
Epoch: 16 cost time: 3.6537833213806152
Epoch: 16, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.454 Vali Acc: 0.312 Test Loss: 1.454 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.2764782905578613
Epoch: 17, Steps: 17 | Train Loss: 1.088 Vali Loss: 1.446 Vali Acc: 0.331 Test Loss: 1.446 Test Acc: 0.331
Validation loss decreased (-0.315575 --> -0.330784).  Saving model ...
Epoch: 18 cost time: 3.636779308319092
Epoch: 18, Steps: 17 | Train Loss: 1.067 Vali Loss: 1.384 Vali Acc: 0.365 Test Loss: 1.384 Test Acc: 0.365
Validation loss decreased (-0.330784 --> -0.365005).  Saving model ...
Epoch: 19 cost time: 3.7166237831115723
Epoch: 19, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.379 Vali Acc: 0.392 Test Loss: 1.379 Test Acc: 0.392
Validation loss decreased (-0.365005 --> -0.391621).  Saving model ...
Epoch: 20 cost time: 3.403904676437378
Epoch: 20, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.522 Vali Acc: 0.323 Test Loss: 1.522 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.1488332748413086
Epoch: 21, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.366 Vali Acc: 0.395 Test Loss: 1.366 Test Acc: 0.395
Validation loss decreased (-0.391621 --> -0.395424).  Saving model ...
Epoch: 22 cost time: 2.7621772289276123
Epoch: 22, Steps: 17 | Train Loss: 0.816 Vali Loss: 1.393 Vali Acc: 0.373 Test Loss: 1.393 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.7558391094207764
Epoch: 23, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.536 Vali Acc: 0.411 Test Loss: 1.536 Test Acc: 0.411
Validation loss decreased (-0.395424 --> -0.410631).  Saving model ...
Epoch: 24 cost time: 3.5587234497070312
Epoch: 24, Steps: 17 | Train Loss: 0.833 Vali Loss: 1.817 Vali Acc: 0.338 Test Loss: 1.817 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.665933132171631
Epoch: 25, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.687 Vali Acc: 0.361 Test Loss: 1.687 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.8268187046051025
Epoch: 26, Steps: 17 | Train Loss: 0.719 Vali Loss: 1.571 Vali Acc: 0.399 Test Loss: 1.571 Test Acc: 0.399
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.375808000564575
Epoch: 27, Steps: 17 | Train Loss: 0.699 Vali Loss: 1.519 Vali Acc: 0.395 Test Loss: 1.519 Test Acc: 0.395
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.920184373855591
Epoch: 28, Steps: 17 | Train Loss: 0.628 Vali Loss: 1.529 Vali Acc: 0.395 Test Loss: 1.529 Test Acc: 0.395
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.364652156829834
Epoch: 29, Steps: 17 | Train Loss: 0.696 Vali Loss: 1.720 Vali Acc: 0.418 Test Loss: 1.720 Test Acc: 0.418
Validation loss decreased (-0.410631 --> -0.418234).  Saving model ...
Epoch: 30 cost time: 2.959693193435669
Epoch: 30, Steps: 17 | Train Loss: 0.622 Vali Loss: 1.643 Vali Acc: 0.373 Test Loss: 1.643 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.1788604259490967
Epoch: 31, Steps: 17 | Train Loss: 0.551 Vali Loss: 1.902 Vali Acc: 0.376 Test Loss: 1.902 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.9129385948181152
Epoch: 32, Steps: 17 | Train Loss: 0.540 Vali Loss: 1.724 Vali Acc: 0.392 Test Loss: 1.724 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.4609997272491455
Epoch: 33, Steps: 17 | Train Loss: 0.521 Vali Loss: 1.805 Vali Acc: 0.365 Test Loss: 1.805 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.402526378631592
Epoch: 34, Steps: 17 | Train Loss: 0.486 Vali Loss: 2.119 Vali Acc: 0.395 Test Loss: 2.119 Test Acc: 0.395
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.019721508026123
Epoch: 35, Steps: 17 | Train Loss: 0.529 Vali Loss: 2.052 Vali Acc: 0.380 Test Loss: 2.052 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.408734083175659
Epoch: 36, Steps: 17 | Train Loss: 0.545 Vali Loss: 1.930 Vali Acc: 0.365 Test Loss: 1.930 Test Acc: 0.365
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.6251208782196045
Epoch: 37, Steps: 17 | Train Loss: 0.477 Vali Loss: 1.968 Vali Acc: 0.369 Test Loss: 1.968 Test Acc: 0.369
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.0855443477630615
Epoch: 38, Steps: 17 | Train Loss: 0.460 Vali Loss: 2.087 Vali Acc: 0.346 Test Loss: 2.087 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.8866775035858154
Epoch: 39, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.868 Vali Acc: 0.407 Test Loss: 1.868 Test Acc: 0.407
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41825095057034223
model parameter : 417204
model size : 2.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.472337245941162
Epoch: 1, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.447 Vali Acc: 0.259 Test Loss: 1.447 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 3.2894701957702637
Epoch: 2, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.431 Vali Acc: 0.262 Test Loss: 1.431 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 2.6241729259490967
Epoch: 3, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.388 Vali Acc: 0.243 Test Loss: 1.388 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8494837284088135
Epoch: 4, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.450 Vali Acc: 0.259 Test Loss: 1.450 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7354652881622314
Epoch: 5, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.477 Vali Acc: 0.285 Test Loss: 1.477 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285156).  Saving model ...
Epoch: 6 cost time: 2.9963290691375732
Epoch: 6, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.413 Vali Acc: 0.270 Test Loss: 1.413 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.374497413635254
Epoch: 7, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.413 Vali Acc: 0.278 Test Loss: 1.413 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6208062171936035
Epoch: 8, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.426 Vali Acc: 0.243 Test Loss: 1.426 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.173616647720337
Epoch: 9, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.483 Vali Acc: 0.270 Test Loss: 1.483 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.1896164417266846
Epoch: 10, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.496 Vali Acc: 0.270 Test Loss: 1.496 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.068570852279663
Epoch: 11, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.522 Vali Acc: 0.266 Test Loss: 1.522 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.29884672164917
Epoch: 12, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.540 Vali Acc: 0.323 Test Loss: 1.540 Test Acc: 0.323
Validation loss decreased (-0.285156 --> -0.323179).  Saving model ...
Epoch: 13 cost time: 3.0592682361602783
Epoch: 13, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.648 Vali Acc: 0.281 Test Loss: 1.648 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.478868246078491
Epoch: 14, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.524 Vali Acc: 0.289 Test Loss: 1.524 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.915398359298706
Epoch: 15, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.493 Vali Acc: 0.304 Test Loss: 1.493 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.729592800140381
Epoch: 16, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.453 Vali Acc: 0.297 Test Loss: 1.453 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.778320074081421
Epoch: 17, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.572 Vali Acc: 0.323 Test Loss: 1.572 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.9214513301849365
Epoch: 18, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.522 Vali Acc: 0.312 Test Loss: 1.522 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.174346923828125
Epoch: 19, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.460 Vali Acc: 0.327 Test Loss: 1.460 Test Acc: 0.327
Validation loss decreased (-0.323179 --> -0.326982).  Saving model ...
Epoch: 20 cost time: 3.463050365447998
Epoch: 20, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.429 Vali Acc: 0.331 Test Loss: 1.429 Test Acc: 0.331
Validation loss decreased (-0.326982 --> -0.330784).  Saving model ...
Epoch: 21 cost time: 3.586566925048828
Epoch: 21, Steps: 17 | Train Loss: 0.894 Vali Loss: 1.413 Vali Acc: 0.369 Test Loss: 1.413 Test Acc: 0.369
Validation loss decreased (-0.330784 --> -0.368807).  Saving model ...
Epoch: 22 cost time: 3.2460203170776367
Epoch: 22, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.546 Vali Acc: 0.338 Test Loss: 1.546 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2475836277008057
Epoch: 23, Steps: 17 | Train Loss: 0.892 Vali Loss: 1.627 Vali Acc: 0.319 Test Loss: 1.627 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.266716480255127
Epoch: 24, Steps: 17 | Train Loss: 0.808 Vali Loss: 1.527 Vali Acc: 0.323 Test Loss: 1.527 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.1159512996673584
Epoch: 25, Steps: 17 | Train Loss: 0.805 Vali Loss: 1.556 Vali Acc: 0.331 Test Loss: 1.556 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.15156888961792
Epoch: 26, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.591 Vali Acc: 0.376 Test Loss: 1.591 Test Acc: 0.376
Validation loss decreased (-0.368807 --> -0.376410).  Saving model ...
Epoch: 27 cost time: 3.404606819152832
Epoch: 27, Steps: 17 | Train Loss: 0.676 Vali Loss: 1.553 Vali Acc: 0.338 Test Loss: 1.553 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.9326846599578857
Epoch: 28, Steps: 17 | Train Loss: 0.718 Vali Loss: 1.619 Vali Acc: 0.346 Test Loss: 1.619 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.046461582183838
Epoch: 29, Steps: 17 | Train Loss: 0.675 Vali Loss: 1.860 Vali Acc: 0.297 Test Loss: 1.860 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.313619375228882
Epoch: 30, Steps: 17 | Train Loss: 0.718 Vali Loss: 1.656 Vali Acc: 0.357 Test Loss: 1.656 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.1124887466430664
Epoch: 31, Steps: 17 | Train Loss: 0.655 Vali Loss: 1.663 Vali Acc: 0.350 Test Loss: 1.663 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 3.2638602256774902
Epoch: 32, Steps: 17 | Train Loss: 0.683 Vali Loss: 1.783 Vali Acc: 0.350 Test Loss: 1.783 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.7300684452056885
Epoch: 33, Steps: 17 | Train Loss: 0.721 Vali Loss: 1.799 Vali Acc: 0.346 Test Loss: 1.799 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.935748338699341
Epoch: 34, Steps: 17 | Train Loss: 0.651 Vali Loss: 1.686 Vali Acc: 0.365 Test Loss: 1.686 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.914241075515747
Epoch: 35, Steps: 17 | Train Loss: 0.523 Vali Loss: 1.860 Vali Acc: 0.365 Test Loss: 1.860 Test Acc: 0.365
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.7466859817504883
Epoch: 36, Steps: 17 | Train Loss: 0.564 Vali Loss: 1.771 Vali Acc: 0.373 Test Loss: 1.771 Test Acc: 0.373
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.376425855513308
model parameter : 409012
model size : 2.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.509340286254883
Epoch: 1, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.421 Vali Acc: 0.278 Test Loss: 1.421 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 3.040976047515869
Epoch: 2, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.399 Vali Acc: 0.266 Test Loss: 1.399 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.907332420349121
Epoch: 3, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.413 Vali Acc: 0.266 Test Loss: 1.413 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.205267906188965
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.398 Vali Acc: 0.259 Test Loss: 1.398 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.479198455810547
Epoch: 5, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.409 Vali Acc: 0.316 Test Loss: 1.409 Test Acc: 0.316
Validation loss decreased (-0.277552 --> -0.315575).  Saving model ...
Epoch: 6 cost time: 3.0094265937805176
Epoch: 6, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.431 Vali Acc: 0.266 Test Loss: 1.431 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.724886417388916
Epoch: 7, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.508 Vali Acc: 0.266 Test Loss: 1.508 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7006256580352783
Epoch: 8, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.507 Vali Acc: 0.289 Test Loss: 1.507 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9916913509368896
Epoch: 9, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.447 Vali Acc: 0.266 Test Loss: 1.447 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.179576873779297
Epoch: 10, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.557 Vali Acc: 0.278 Test Loss: 1.557 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.282759189605713
Epoch: 11, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.532 Vali Acc: 0.274 Test Loss: 1.532 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.833620071411133
Epoch: 12, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.677 Vali Acc: 0.266 Test Loss: 1.677 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.0609517097473145
Epoch: 13, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.597 Vali Acc: 0.285 Test Loss: 1.597 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.9108879566192627
Epoch: 14, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.598 Vali Acc: 0.262 Test Loss: 1.598 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0773284435272217
Epoch: 15, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.580 Vali Acc: 0.236 Test Loss: 1.580 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 400820
model size : 2.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.27460503578186
Epoch: 1, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.402 Vali Acc: 0.221 Test Loss: 1.402 Test Acc: 0.221
Validation loss decreased (inf --> -0.220518).  Saving model ...
Epoch: 2 cost time: 2.748678684234619
Epoch: 2, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.396 Vali Acc: 0.274 Test Loss: 1.396 Test Acc: 0.274
Validation loss decreased (-0.220518 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 2.5081727504730225
Epoch: 3, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.456 Vali Acc: 0.266 Test Loss: 1.456 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.136018753051758
Epoch: 4, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.534 Vali Acc: 0.232 Test Loss: 1.534 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5839083194732666
Epoch: 5, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.524 Vali Acc: 0.247 Test Loss: 1.524 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.089369058609009
Epoch: 6, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.422 Vali Acc: 0.278 Test Loss: 1.422 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 7 cost time: 2.212082624435425
Epoch: 7, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.470 Vali Acc: 0.236 Test Loss: 1.470 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.243786334991455
Epoch: 8, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.441 Vali Acc: 0.278 Test Loss: 1.441 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6256842613220215
Epoch: 9, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.429 Vali Acc: 0.274 Test Loss: 1.429 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.0635318756103516
Epoch: 10, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.445 Vali Acc: 0.266 Test Loss: 1.445 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.837329387664795
Epoch: 11, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.516 Vali Acc: 0.289 Test Loss: 1.516 Test Acc: 0.289
Validation loss decreased (-0.277552 --> -0.288958).  Saving model ...
Epoch: 12 cost time: 2.6076948642730713
Epoch: 12, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.389 Vali Acc: 0.289 Test Loss: 1.389 Test Acc: 0.289
Validation loss decreased (-0.288958 --> -0.288959).  Saving model ...
Epoch: 13 cost time: 2.589599370956421
Epoch: 13, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.525 Vali Acc: 0.300 Test Loss: 1.525 Test Acc: 0.300
Validation loss decreased (-0.288959 --> -0.300365).  Saving model ...
Epoch: 14 cost time: 2.5642573833465576
Epoch: 14, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.479 Vali Acc: 0.308 Test Loss: 1.479 Test Acc: 0.308
Validation loss decreased (-0.300365 --> -0.307970).  Saving model ...
Epoch: 15 cost time: 2.3883438110351562
Epoch: 15, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.426 Vali Acc: 0.308 Test Loss: 1.426 Test Acc: 0.308
Validation loss decreased (-0.307970 --> -0.307971).  Saving model ...
Epoch: 16 cost time: 2.5326411724090576
Epoch: 16, Steps: 17 | Train Loss: 1.126 Vali Loss: 1.506 Vali Acc: 0.293 Test Loss: 1.506 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.706234931945801
Epoch: 17, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.408 Vali Acc: 0.346 Test Loss: 1.408 Test Acc: 0.346
Validation loss decreased (-0.307971 --> -0.345994).  Saving model ...
Epoch: 18 cost time: 2.776472330093384
Epoch: 18, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.597 Vali Acc: 0.373 Test Loss: 1.597 Test Acc: 0.373
Validation loss decreased (-0.345994 --> -0.372608).  Saving model ...
Epoch: 19 cost time: 2.3827104568481445
Epoch: 19, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.382 Vali Acc: 0.357 Test Loss: 1.382 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.719489097595215
Epoch: 20, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.463 Vali Acc: 0.350 Test Loss: 1.463 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.680631399154663
Epoch: 21, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.491 Vali Acc: 0.384 Test Loss: 1.491 Test Acc: 0.384
Validation loss decreased (-0.372608 --> -0.384016).  Saving model ...
Epoch: 22 cost time: 2.362514019012451
Epoch: 22, Steps: 17 | Train Loss: 0.904 Vali Loss: 1.408 Vali Acc: 0.365 Test Loss: 1.408 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.55161190032959
Epoch: 23, Steps: 17 | Train Loss: 0.826 Vali Loss: 1.406 Vali Acc: 0.399 Test Loss: 1.406 Test Acc: 0.399
Validation loss decreased (-0.384016 --> -0.399225).  Saving model ...
Epoch: 24 cost time: 2.6074392795562744
Epoch: 24, Steps: 17 | Train Loss: 0.824 Vali Loss: 1.482 Vali Acc: 0.373 Test Loss: 1.482 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.295631170272827
Epoch: 25, Steps: 17 | Train Loss: 0.763 Vali Loss: 1.472 Vali Acc: 0.392 Test Loss: 1.472 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.0443332195281982
Epoch: 26, Steps: 17 | Train Loss: 0.695 Vali Loss: 1.711 Vali Acc: 0.369 Test Loss: 1.711 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.103048086166382
Epoch: 27, Steps: 17 | Train Loss: 0.813 Vali Loss: 1.472 Vali Acc: 0.376 Test Loss: 1.472 Test Acc: 0.376
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.5179450511932373
Epoch: 28, Steps: 17 | Train Loss: 0.704 Vali Loss: 1.608 Vali Acc: 0.361 Test Loss: 1.608 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.0315535068511963
Epoch: 29, Steps: 17 | Train Loss: 0.680 Vali Loss: 1.611 Vali Acc: 0.338 Test Loss: 1.611 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.539013147354126
Epoch: 30, Steps: 17 | Train Loss: 0.610 Vali Loss: 1.867 Vali Acc: 0.376 Test Loss: 1.867 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.441038131713867
Epoch: 31, Steps: 17 | Train Loss: 0.726 Vali Loss: 1.645 Vali Acc: 0.395 Test Loss: 1.645 Test Acc: 0.395
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.6063618659973145
Epoch: 32, Steps: 17 | Train Loss: 0.623 Vali Loss: 1.593 Vali Acc: 0.392 Test Loss: 1.593 Test Acc: 0.392
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.9001784324645996
Epoch: 33, Steps: 17 | Train Loss: 0.567 Vali Loss: 1.552 Vali Acc: 0.426 Test Loss: 1.552 Test Acc: 0.426
Validation loss decreased (-0.399225 --> -0.425840).  Saving model ...
Epoch: 34 cost time: 2.4693689346313477
Epoch: 34, Steps: 17 | Train Loss: 0.576 Vali Loss: 1.673 Vali Acc: 0.414 Test Loss: 1.673 Test Acc: 0.414
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.5871007442474365
Epoch: 35, Steps: 17 | Train Loss: 0.553 Vali Loss: 2.038 Vali Acc: 0.346 Test Loss: 2.038 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.9504570960998535
Epoch: 36, Steps: 17 | Train Loss: 0.565 Vali Loss: 1.774 Vali Acc: 0.373 Test Loss: 1.774 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.8016045093536377
Epoch: 37, Steps: 17 | Train Loss: 0.493 Vali Loss: 1.779 Vali Acc: 0.380 Test Loss: 1.779 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.4777495861053467
Epoch: 38, Steps: 17 | Train Loss: 0.506 Vali Loss: 1.702 Vali Acc: 0.354 Test Loss: 1.702 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.807530641555786
Epoch: 39, Steps: 17 | Train Loss: 0.433 Vali Loss: 1.898 Vali Acc: 0.335 Test Loss: 1.898 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.906524419784546
Epoch: 40, Steps: 17 | Train Loss: 0.448 Vali Loss: 2.077 Vali Acc: 0.369 Test Loss: 2.077 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.7374508380889893
Epoch: 41, Steps: 17 | Train Loss: 0.442 Vali Loss: 1.841 Vali Acc: 0.418 Test Loss: 1.841 Test Acc: 0.418
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.948090076446533
Epoch: 42, Steps: 17 | Train Loss: 0.410 Vali Loss: 1.822 Vali Acc: 0.380 Test Loss: 1.822 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.6316077709198
Epoch: 43, Steps: 17 | Train Loss: 0.383 Vali Loss: 1.980 Vali Acc: 0.354 Test Loss: 1.980 Test Acc: 0.354
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.42585551330798477
model parameter : 392628
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.128579378128052
Epoch: 1, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.416 Vali Acc: 0.232 Test Loss: 1.416 Test Acc: 0.232
Validation loss decreased (inf --> -0.231925).  Saving model ...
Epoch: 2 cost time: 2.4096100330352783
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.396 Vali Acc: 0.262 Test Loss: 1.396 Test Acc: 0.262
Validation loss decreased (-0.231925 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 3.179429292678833
Epoch: 3, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.402 Vali Acc: 0.278 Test Loss: 1.402 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277553).  Saving model ...
Epoch: 4 cost time: 2.9130868911743164
Epoch: 4, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.419 Vali Acc: 0.270 Test Loss: 1.419 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.015681028366089
Epoch: 5, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.468 Vali Acc: 0.243 Test Loss: 1.468 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.1365966796875
Epoch: 6, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.458 Vali Acc: 0.278 Test Loss: 1.458 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.892097234725952
Epoch: 7, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.537 Vali Acc: 0.255 Test Loss: 1.537 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9836771488189697
Epoch: 8, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.426 Vali Acc: 0.262 Test Loss: 1.426 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.86771559715271
Epoch: 9, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.606 Vali Acc: 0.278 Test Loss: 1.606 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.0188486576080322
Epoch: 10, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.723 Vali Acc: 0.262 Test Loss: 1.723 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.873497247695923
Epoch: 11, Steps: 17 | Train Loss: 1.406 Vali Loss: 1.479 Vali Acc: 0.293 Test Loss: 1.479 Test Acc: 0.293
Validation loss decreased (-0.277553 --> -0.292761).  Saving model ...
Epoch: 12 cost time: 3.077059268951416
Epoch: 12, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.447 Vali Acc: 0.285 Test Loss: 1.447 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1307899951934814
Epoch: 13, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.479 Vali Acc: 0.262 Test Loss: 1.479 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.594261884689331
Epoch: 14, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.578 Vali Acc: 0.285 Test Loss: 1.578 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.094008445739746
Epoch: 15, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.569 Vali Acc: 0.262 Test Loss: 1.569 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.9109599590301514
Epoch: 16, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.518 Vali Acc: 0.304 Test Loss: 1.518 Test Acc: 0.304
Validation loss decreased (-0.292761 --> -0.304167).  Saving model ...
Epoch: 17 cost time: 3.740079402923584
Epoch: 17, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.550 Vali Acc: 0.300 Test Loss: 1.550 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.042588949203491
Epoch: 18, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.510 Vali Acc: 0.308 Test Loss: 1.510 Test Acc: 0.308
Validation loss decreased (-0.304167 --> -0.307970).  Saving model ...
Epoch: 19 cost time: 3.099008560180664
Epoch: 19, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.539 Vali Acc: 0.350 Test Loss: 1.539 Test Acc: 0.350
Validation loss decreased (-0.307970 --> -0.349794).  Saving model ...
Epoch: 20 cost time: 3.6004080772399902
Epoch: 20, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.519 Vali Acc: 0.338 Test Loss: 1.519 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7393155097961426
Epoch: 21, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.593 Vali Acc: 0.342 Test Loss: 1.593 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1627979278564453
Epoch: 22, Steps: 17 | Train Loss: 0.936 Vali Loss: 1.534 Vali Acc: 0.384 Test Loss: 1.534 Test Acc: 0.384
Validation loss decreased (-0.349794 --> -0.384015).  Saving model ...
Epoch: 23 cost time: 3.1388392448425293
Epoch: 23, Steps: 17 | Train Loss: 0.887 Vali Loss: 1.472 Vali Acc: 0.388 Test Loss: 1.472 Test Acc: 0.388
Validation loss decreased (-0.384015 --> -0.387818).  Saving model ...
Epoch: 24 cost time: 3.2169153690338135
Epoch: 24, Steps: 17 | Train Loss: 0.785 Vali Loss: 1.486 Vali Acc: 0.388 Test Loss: 1.486 Test Acc: 0.388
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.617497444152832
Epoch: 25, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.525 Vali Acc: 0.380 Test Loss: 1.525 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.9505913257598877
Epoch: 26, Steps: 17 | Train Loss: 0.729 Vali Loss: 1.531 Vali Acc: 0.388 Test Loss: 1.531 Test Acc: 0.388
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.643440008163452
Epoch: 27, Steps: 17 | Train Loss: 0.723 Vali Loss: 1.608 Vali Acc: 0.388 Test Loss: 1.608 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.706345558166504
Epoch: 28, Steps: 17 | Train Loss: 0.748 Vali Loss: 1.752 Vali Acc: 0.380 Test Loss: 1.752 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.5319149494171143
Epoch: 29, Steps: 17 | Train Loss: 0.689 Vali Loss: 1.580 Vali Acc: 0.395 Test Loss: 1.580 Test Acc: 0.395
Validation loss decreased (-0.387818 --> -0.395421).  Saving model ...
Epoch: 30 cost time: 2.6330080032348633
Epoch: 30, Steps: 17 | Train Loss: 0.627 Vali Loss: 1.649 Vali Acc: 0.373 Test Loss: 1.649 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.2609853744506836
Epoch: 31, Steps: 17 | Train Loss: 0.586 Vali Loss: 1.620 Vali Acc: 0.395 Test Loss: 1.620 Test Acc: 0.395
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.519810438156128
Epoch: 32, Steps: 17 | Train Loss: 0.670 Vali Loss: 1.706 Vali Acc: 0.399 Test Loss: 1.706 Test Acc: 0.399
Validation loss decreased (-0.395421 --> -0.399222).  Saving model ...
Epoch: 33 cost time: 3.4879558086395264
Epoch: 33, Steps: 17 | Train Loss: 0.554 Vali Loss: 1.634 Vali Acc: 0.414 Test Loss: 1.634 Test Acc: 0.414
Validation loss decreased (-0.399222 --> -0.414432).  Saving model ...
Epoch: 34 cost time: 3.217521905899048
Epoch: 34, Steps: 17 | Train Loss: 0.501 Vali Loss: 1.700 Vali Acc: 0.411 Test Loss: 1.700 Test Acc: 0.411
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.277625322341919
Epoch: 35, Steps: 17 | Train Loss: 0.496 Vali Loss: 1.824 Vali Acc: 0.388 Test Loss: 1.824 Test Acc: 0.388
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.143673896789551
Epoch: 36, Steps: 17 | Train Loss: 0.448 Vali Loss: 1.832 Vali Acc: 0.357 Test Loss: 1.832 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.381824254989624
Epoch: 37, Steps: 17 | Train Loss: 0.446 Vali Loss: 1.791 Vali Acc: 0.392 Test Loss: 1.791 Test Acc: 0.392
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.301819086074829
Epoch: 38, Steps: 17 | Train Loss: 0.409 Vali Loss: 2.065 Vali Acc: 0.361 Test Loss: 2.065 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.4194202423095703
Epoch: 39, Steps: 17 | Train Loss: 0.467 Vali Loss: 2.036 Vali Acc: 0.373 Test Loss: 2.036 Test Acc: 0.373
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.3935141563415527
Epoch: 40, Steps: 17 | Train Loss: 0.397 Vali Loss: 2.133 Vali Acc: 0.373 Test Loss: 2.133 Test Acc: 0.373
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.306187152862549
Epoch: 41, Steps: 17 | Train Loss: 0.501 Vali Loss: 2.041 Vali Acc: 0.369 Test Loss: 2.041 Test Acc: 0.369
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.374682903289795
Epoch: 42, Steps: 17 | Train Loss: 0.363 Vali Loss: 2.041 Vali Acc: 0.380 Test Loss: 2.041 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.0982766151428223
Epoch: 43, Steps: 17 | Train Loss: 0.416 Vali Loss: 2.029 Vali Acc: 0.388 Test Loss: 2.029 Test Acc: 0.388
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 300724
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.535107374191284
Epoch: 1, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.409 Vali Acc: 0.247 Test Loss: 1.409 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 3.0287609100341797
Epoch: 2, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.398 Vali Acc: 0.262 Test Loss: 1.398 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 3.015320301055908
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.393 Vali Acc: 0.255 Test Loss: 1.393 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.940351724624634
Epoch: 4, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.506 Vali Acc: 0.243 Test Loss: 1.506 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.229161024093628
Epoch: 5, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.399 Vali Acc: 0.255 Test Loss: 1.399 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.3444368839263916
Epoch: 6, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.415 Vali Acc: 0.281 Test Loss: 1.415 Test Acc: 0.281
Validation loss decreased (-0.262343 --> -0.281355).  Saving model ...
Epoch: 7 cost time: 3.342910051345825
Epoch: 7, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.425 Vali Acc: 0.274 Test Loss: 1.425 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2873947620391846
Epoch: 8, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.622 Vali Acc: 0.259 Test Loss: 1.622 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1554219722747803
Epoch: 9, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.532 Vali Acc: 0.285 Test Loss: 1.532 Test Acc: 0.285
Validation loss decreased (-0.281355 --> -0.285156).  Saving model ...
Epoch: 10 cost time: 2.7207295894622803
Epoch: 10, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.439 Vali Acc: 0.304 Test Loss: 1.439 Test Acc: 0.304
Validation loss decreased (-0.285156 --> -0.304168).  Saving model ...
Epoch: 11 cost time: 2.7372231483459473
Epoch: 11, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.464 Vali Acc: 0.278 Test Loss: 1.464 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0885751247406006
Epoch: 12, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.521 Vali Acc: 0.274 Test Loss: 1.521 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.000920534133911
Epoch: 13, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.459 Vali Acc: 0.251 Test Loss: 1.459 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1062564849853516
Epoch: 14, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.528 Vali Acc: 0.270 Test Loss: 1.528 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.0673961639404297
Epoch: 15, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.761 Vali Acc: 0.278 Test Loss: 1.761 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.137655019760132
Epoch: 16, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.492 Vali Acc: 0.289 Test Loss: 1.492 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.9463980197906494
Epoch: 17, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.581 Vali Acc: 0.251 Test Loss: 1.581 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.5410962104797363
Epoch: 18, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.588 Vali Acc: 0.262 Test Loss: 1.588 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.061081647872925
Epoch: 19, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.545 Vali Acc: 0.297 Test Loss: 1.545 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.086169958114624
Epoch: 20, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.482 Vali Acc: 0.319 Test Loss: 1.482 Test Acc: 0.319
Validation loss decreased (-0.304168 --> -0.319377).  Saving model ...
Epoch: 21 cost time: 2.751505136489868
Epoch: 21, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.633 Vali Acc: 0.350 Test Loss: 1.633 Test Acc: 0.350
Validation loss decreased (-0.319377 --> -0.349794).  Saving model ...
Epoch: 22 cost time: 3.1652989387512207
Epoch: 22, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.623 Vali Acc: 0.304 Test Loss: 1.623 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.2147934436798096
Epoch: 23, Steps: 17 | Train Loss: 0.895 Vali Loss: 1.517 Vali Acc: 0.346 Test Loss: 1.517 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.0364129543304443
Epoch: 24, Steps: 17 | Train Loss: 0.859 Vali Loss: 1.516 Vali Acc: 0.392 Test Loss: 1.516 Test Acc: 0.392
Validation loss decreased (-0.349794 --> -0.391620).  Saving model ...
Epoch: 25 cost time: 3.009723424911499
Epoch: 25, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.498 Vali Acc: 0.384 Test Loss: 1.498 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.171459913253784
Epoch: 26, Steps: 17 | Train Loss: 0.843 Vali Loss: 1.613 Vali Acc: 0.304 Test Loss: 1.613 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.0068259239196777
Epoch: 27, Steps: 17 | Train Loss: 0.826 Vali Loss: 1.509 Vali Acc: 0.369 Test Loss: 1.509 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.9807612895965576
Epoch: 28, Steps: 17 | Train Loss: 0.753 Vali Loss: 1.579 Vali Acc: 0.335 Test Loss: 1.579 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.3918659687042236
Epoch: 29, Steps: 17 | Train Loss: 0.717 Vali Loss: 1.546 Vali Acc: 0.312 Test Loss: 1.546 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.184269905090332
Epoch: 30, Steps: 17 | Train Loss: 0.731 Vali Loss: 1.721 Vali Acc: 0.331 Test Loss: 1.721 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.9861674308776855
Epoch: 31, Steps: 17 | Train Loss: 0.676 Vali Loss: 1.579 Vali Acc: 0.380 Test Loss: 1.579 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.969298839569092
Epoch: 32, Steps: 17 | Train Loss: 0.616 Vali Loss: 1.776 Vali Acc: 0.316 Test Loss: 1.776 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.037132978439331
Epoch: 33, Steps: 17 | Train Loss: 0.583 Vali Loss: 1.666 Vali Acc: 0.361 Test Loss: 1.666 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.9232428073883057
Epoch: 34, Steps: 17 | Train Loss: 0.585 Vali Loss: 1.721 Vali Acc: 0.350 Test Loss: 1.721 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3916349809885932
model parameter : 292532
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.9285783767700195
Epoch: 1, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.398 Vali Acc: 0.243 Test Loss: 1.398 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 2.7087786197662354
Epoch: 2, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.421 Vali Acc: 0.278 Test Loss: 1.421 Test Acc: 0.278
Validation loss decreased (-0.243332 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 2.4092869758605957
Epoch: 3, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.440 Vali Acc: 0.262 Test Loss: 1.440 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6987884044647217
Epoch: 4, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.429 Vali Acc: 0.247 Test Loss: 1.429 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.9424846172332764
Epoch: 5, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.482 Vali Acc: 0.247 Test Loss: 1.482 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.489881753921509
Epoch: 6, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.447 Vali Acc: 0.259 Test Loss: 1.447 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.519918918609619
Epoch: 7, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.510 Vali Acc: 0.285 Test Loss: 1.510 Test Acc: 0.285
Validation loss decreased (-0.277552 --> -0.285156).  Saving model ...
Epoch: 8 cost time: 2.8478963375091553
Epoch: 8, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.401 Vali Acc: 0.285 Test Loss: 1.401 Test Acc: 0.285
Validation loss decreased (-0.285156 --> -0.285157).  Saving model ...
Epoch: 9 cost time: 3.1575193405151367
Epoch: 9, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.399 Vali Acc: 0.281 Test Loss: 1.399 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.061947822570801
Epoch: 10, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.682 Vali Acc: 0.251 Test Loss: 1.682 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.933586359024048
Epoch: 11, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.559 Vali Acc: 0.236 Test Loss: 1.559 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.830653429031372
Epoch: 12, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.442 Vali Acc: 0.293 Test Loss: 1.442 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292761).  Saving model ...
Epoch: 13 cost time: 2.508939743041992
Epoch: 13, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.414 Vali Acc: 0.304 Test Loss: 1.414 Test Acc: 0.304
Validation loss decreased (-0.292761 --> -0.304168).  Saving model ...
Epoch: 14 cost time: 2.827468156814575
Epoch: 14, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.501 Vali Acc: 0.259 Test Loss: 1.501 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.173447370529175
Epoch: 15, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.637 Vali Acc: 0.331 Test Loss: 1.637 Test Acc: 0.331
Validation loss decreased (-0.304168 --> -0.330782).  Saving model ...
Epoch: 16 cost time: 3.203653573989868
Epoch: 16, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.466 Vali Acc: 0.247 Test Loss: 1.466 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1094138622283936
Epoch: 17, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.458 Vali Acc: 0.342 Test Loss: 1.458 Test Acc: 0.342
Validation loss decreased (-0.330782 --> -0.342191).  Saving model ...
Epoch: 18 cost time: 2.8701038360595703
Epoch: 18, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.466 Vali Acc: 0.300 Test Loss: 1.466 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.1301238536834717
Epoch: 19, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.410 Vali Acc: 0.365 Test Loss: 1.410 Test Acc: 0.365
Validation loss decreased (-0.342191 --> -0.365005).  Saving model ...
Epoch: 20 cost time: 3.192854881286621
Epoch: 20, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.498 Vali Acc: 0.335 Test Loss: 1.498 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.9959704875946045
Epoch: 21, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.542 Vali Acc: 0.327 Test Loss: 1.542 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1489460468292236
Epoch: 22, Steps: 17 | Train Loss: 0.868 Vali Loss: 1.733 Vali Acc: 0.316 Test Loss: 1.733 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.8468618392944336
Epoch: 23, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.538 Vali Acc: 0.369 Test Loss: 1.538 Test Acc: 0.369
Validation loss decreased (-0.365005 --> -0.368806).  Saving model ...
Epoch: 24 cost time: 2.7936923503875732
Epoch: 24, Steps: 17 | Train Loss: 0.791 Vali Loss: 1.519 Vali Acc: 0.380 Test Loss: 1.519 Test Acc: 0.380
Validation loss decreased (-0.368806 --> -0.380213).  Saving model ...
Epoch: 25 cost time: 2.470397710800171
Epoch: 25, Steps: 17 | Train Loss: 0.800 Vali Loss: 1.574 Vali Acc: 0.388 Test Loss: 1.574 Test Acc: 0.388
Validation loss decreased (-0.380213 --> -0.387817).  Saving model ...
Epoch: 26 cost time: 2.5038418769836426
Epoch: 26, Steps: 17 | Train Loss: 0.819 Vali Loss: 1.528 Vali Acc: 0.373 Test Loss: 1.528 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.512017250061035
Epoch: 27, Steps: 17 | Train Loss: 0.687 Vali Loss: 1.806 Vali Acc: 0.342 Test Loss: 1.806 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.5986971855163574
Epoch: 28, Steps: 17 | Train Loss: 0.722 Vali Loss: 1.703 Vali Acc: 0.373 Test Loss: 1.703 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.4196577072143555
Epoch: 29, Steps: 17 | Train Loss: 0.755 Vali Loss: 1.769 Vali Acc: 0.369 Test Loss: 1.769 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.9213814735412598
Epoch: 30, Steps: 17 | Train Loss: 0.648 Vali Loss: 1.980 Vali Acc: 0.335 Test Loss: 1.980 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.103449583053589
Epoch: 31, Steps: 17 | Train Loss: 0.725 Vali Loss: 1.714 Vali Acc: 0.346 Test Loss: 1.714 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.7750041484832764
Epoch: 32, Steps: 17 | Train Loss: 0.554 Vali Loss: 1.706 Vali Acc: 0.350 Test Loss: 1.706 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.762439012527466
Epoch: 33, Steps: 17 | Train Loss: 0.631 Vali Loss: 1.871 Vali Acc: 0.350 Test Loss: 1.871 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.0506017208099365
Epoch: 34, Steps: 17 | Train Loss: 0.519 Vali Loss: 1.789 Vali Acc: 0.357 Test Loss: 1.789 Test Acc: 0.357
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.7274484634399414
Epoch: 35, Steps: 17 | Train Loss: 0.572 Vali Loss: 1.725 Vali Acc: 0.365 Test Loss: 1.725 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38783269961977185
model parameter : 284340
model size : 1.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.95995831489563
Epoch: 1, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.406 Vali Acc: 0.266 Test Loss: 1.406 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 2.6031734943389893
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.398 Vali Acc: 0.217 Test Loss: 1.398 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.762566328048706
Epoch: 3, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.475 Vali Acc: 0.281 Test Loss: 1.475 Test Acc: 0.281
Validation loss decreased (-0.266146 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 2.456033945083618
Epoch: 4, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.428 Vali Acc: 0.270 Test Loss: 1.428 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6479427814483643
Epoch: 5, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.479 Vali Acc: 0.259 Test Loss: 1.479 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9421157836914062
Epoch: 6, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.408 Vali Acc: 0.300 Test Loss: 1.408 Test Acc: 0.300
Validation loss decreased (-0.281354 --> -0.300366).  Saving model ...
Epoch: 7 cost time: 2.6284754276275635
Epoch: 7, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.457 Vali Acc: 0.266 Test Loss: 1.457 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9246151447296143
Epoch: 8, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.498 Vali Acc: 0.240 Test Loss: 1.498 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.48213529586792
Epoch: 9, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.476 Vali Acc: 0.289 Test Loss: 1.476 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7142136096954346
Epoch: 10, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.465 Vali Acc: 0.255 Test Loss: 1.465 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.777902603149414
Epoch: 11, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.473 Vali Acc: 0.266 Test Loss: 1.473 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5595452785491943
Epoch: 12, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.433 Vali Acc: 0.293 Test Loss: 1.433 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.747792959213257
Epoch: 13, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.473 Vali Acc: 0.259 Test Loss: 1.473 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.7939558029174805
Epoch: 14, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.417 Vali Acc: 0.300 Test Loss: 1.417 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.628530502319336
Epoch: 15, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.500 Vali Acc: 0.266 Test Loss: 1.500 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.967571973800659
Epoch: 16, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.487 Vali Acc: 0.281 Test Loss: 1.487 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 276148
model size : 1.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.143665552139282
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.435 Vali Acc: 0.228 Test Loss: 1.435 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 2.9778389930725098
Epoch: 2, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.410 Vali Acc: 0.243 Test Loss: 1.410 Test Acc: 0.243
Validation loss decreased (-0.228123 --> -0.243332).  Saving model ...
Epoch: 3 cost time: 3.2741432189941406
Epoch: 3, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.431 Vali Acc: 0.259 Test Loss: 1.431 Test Acc: 0.259
Validation loss decreased (-0.243332 --> -0.258541).  Saving model ...
Epoch: 4 cost time: 3.054521322250366
Epoch: 4, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.412 Vali Acc: 0.262 Test Loss: 1.412 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 2.8834073543548584
Epoch: 5, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.510 Vali Acc: 0.278 Test Loss: 1.510 Test Acc: 0.278
Validation loss decreased (-0.262343 --> -0.277551).  Saving model ...
Epoch: 6 cost time: 2.783970832824707
Epoch: 6, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.445 Vali Acc: 0.270 Test Loss: 1.445 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.020289897918701
Epoch: 7, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.472 Vali Acc: 0.255 Test Loss: 1.472 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2297587394714355
Epoch: 8, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.468 Vali Acc: 0.255 Test Loss: 1.468 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8880934715270996
Epoch: 9, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.426 Vali Acc: 0.300 Test Loss: 1.426 Test Acc: 0.300
Validation loss decreased (-0.277551 --> -0.300366).  Saving model ...
Epoch: 10 cost time: 2.909700632095337
Epoch: 10, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.477 Vali Acc: 0.262 Test Loss: 1.477 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.231957197189331
Epoch: 11, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.554 Vali Acc: 0.259 Test Loss: 1.554 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.4440789222717285
Epoch: 12, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.437 Vali Acc: 0.289 Test Loss: 1.437 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5951130390167236
Epoch: 13, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.602 Vali Acc: 0.281 Test Loss: 1.602 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.163693428039551
Epoch: 14, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.583 Vali Acc: 0.289 Test Loss: 1.583 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.10890793800354
Epoch: 15, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.501 Vali Acc: 0.327 Test Loss: 1.501 Test Acc: 0.327
Validation loss decreased (-0.300366 --> -0.326981).  Saving model ...
Epoch: 16 cost time: 3.220796823501587
Epoch: 16, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.504 Vali Acc: 0.297 Test Loss: 1.504 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.8890933990478516
Epoch: 17, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.727 Vali Acc: 0.312 Test Loss: 1.727 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1737942695617676
Epoch: 18, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.474 Vali Acc: 0.327 Test Loss: 1.474 Test Acc: 0.327
Validation loss decreased (-0.326981 --> -0.326981).  Saving model ...
Epoch: 19 cost time: 2.957258462905884
Epoch: 19, Steps: 17 | Train Loss: 0.933 Vali Loss: 1.607 Vali Acc: 0.338 Test Loss: 1.607 Test Acc: 0.338
Validation loss decreased (-0.326981 --> -0.338387).  Saving model ...
Epoch: 20 cost time: 3.0969810485839844
Epoch: 20, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.462 Vali Acc: 0.414 Test Loss: 1.462 Test Acc: 0.414
Validation loss decreased (-0.338387 --> -0.414434).  Saving model ...
Epoch: 21 cost time: 3.0428407192230225
Epoch: 21, Steps: 17 | Train Loss: 0.874 Vali Loss: 1.458 Vali Acc: 0.403 Test Loss: 1.458 Test Acc: 0.403
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.1288270950317383
Epoch: 22, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.495 Vali Acc: 0.418 Test Loss: 1.495 Test Acc: 0.418
Validation loss decreased (-0.414434 --> -0.418236).  Saving model ...
Epoch: 23 cost time: 3.207735538482666
Epoch: 23, Steps: 17 | Train Loss: 1.004 Vali Loss: 1.554 Vali Acc: 0.369 Test Loss: 1.554 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.063100814819336
Epoch: 24, Steps: 17 | Train Loss: 0.903 Vali Loss: 1.532 Vali Acc: 0.380 Test Loss: 1.532 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.9347293376922607
Epoch: 25, Steps: 17 | Train Loss: 0.805 Vali Loss: 1.627 Vali Acc: 0.380 Test Loss: 1.627 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.9632668495178223
Epoch: 26, Steps: 17 | Train Loss: 0.765 Vali Loss: 1.603 Vali Acc: 0.384 Test Loss: 1.603 Test Acc: 0.384
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.583897352218628
Epoch: 27, Steps: 17 | Train Loss: 0.686 Vali Loss: 1.482 Vali Acc: 0.403 Test Loss: 1.482 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.8092124462127686
Epoch: 28, Steps: 17 | Train Loss: 0.719 Vali Loss: 1.531 Vali Acc: 0.407 Test Loss: 1.531 Test Acc: 0.407
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.8635952472686768
Epoch: 29, Steps: 17 | Train Loss: 0.651 Vali Loss: 1.582 Vali Acc: 0.380 Test Loss: 1.582 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.133329391479492
Epoch: 30, Steps: 17 | Train Loss: 0.622 Vali Loss: 1.627 Vali Acc: 0.392 Test Loss: 1.627 Test Acc: 0.392
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.183488130569458
Epoch: 31, Steps: 17 | Train Loss: 0.672 Vali Loss: 1.627 Vali Acc: 0.369 Test Loss: 1.627 Test Acc: 0.369
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.296778678894043
Epoch: 32, Steps: 17 | Train Loss: 0.588 Vali Loss: 1.653 Vali Acc: 0.392 Test Loss: 1.653 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.41825095057034223
model parameter : 242484
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.386303663253784
Epoch: 1, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.413 Vali Acc: 0.255 Test Loss: 1.413 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 2.4460606575012207
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.375 Vali Acc: 0.266 Test Loss: 1.375 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266146).  Saving model ...
Epoch: 3 cost time: 2.3959851264953613
Epoch: 3, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.417 Vali Acc: 0.297 Test Loss: 1.417 Test Acc: 0.297
Validation loss decreased (-0.266146 --> -0.296564).  Saving model ...
Epoch: 4 cost time: 2.6912219524383545
Epoch: 4, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.412 Vali Acc: 0.270 Test Loss: 1.412 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5066890716552734
Epoch: 5, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.418 Vali Acc: 0.270 Test Loss: 1.418 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.01796817779541
Epoch: 6, Steps: 17 | Train Loss: 1.365 Vali Loss: 1.394 Vali Acc: 0.255 Test Loss: 1.394 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.902937412261963
Epoch: 7, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.431 Vali Acc: 0.236 Test Loss: 1.431 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0324015617370605
Epoch: 8, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.503 Vali Acc: 0.236 Test Loss: 1.503 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8756799697875977
Epoch: 9, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.448 Vali Acc: 0.274 Test Loss: 1.448 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.780900239944458
Epoch: 10, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.568 Vali Acc: 0.297 Test Loss: 1.568 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 3.0377135276794434
Epoch: 11, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.430 Vali Acc: 0.281 Test Loss: 1.430 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.5086236000061035
Epoch: 12, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.423 Vali Acc: 0.285 Test Loss: 1.423 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.143920421600342
Epoch: 13, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.437 Vali Acc: 0.278 Test Loss: 1.437 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 234292
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.043335199356079
Epoch: 1, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.405 Vali Acc: 0.255 Test Loss: 1.405 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 2.552741765975952
Epoch: 2, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.425 Vali Acc: 0.240 Test Loss: 1.425 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8258183002471924
Epoch: 3, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.384 Vali Acc: 0.240 Test Loss: 1.384 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.260680675506592
Epoch: 4, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.425 Vali Acc: 0.255 Test Loss: 1.425 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.7184789180755615
Epoch: 5, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.412 Vali Acc: 0.251 Test Loss: 1.412 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.526594877243042
Epoch: 6, Steps: 17 | Train Loss: 1.378 Vali Loss: 1.482 Vali Acc: 0.255 Test Loss: 1.482 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.004085063934326
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.418 Vali Acc: 0.289 Test Loss: 1.418 Test Acc: 0.289
Validation loss decreased (-0.254739 --> -0.288959).  Saving model ...
Epoch: 8 cost time: 2.580061674118042
Epoch: 8, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.551 Vali Acc: 0.262 Test Loss: 1.551 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2772727012634277
Epoch: 9, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.482 Vali Acc: 0.262 Test Loss: 1.482 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.175445318222046
Epoch: 10, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.440 Vali Acc: 0.251 Test Loss: 1.440 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.1058013439178467
Epoch: 11, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.423 Vali Acc: 0.274 Test Loss: 1.423 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.2425789833068848
Epoch: 12, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.452 Vali Acc: 0.278 Test Loss: 1.452 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8747637271881104
Epoch: 13, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.471 Vali Acc: 0.274 Test Loss: 1.471 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.2845892906188965
Epoch: 14, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.408 Vali Acc: 0.327 Test Loss: 1.408 Test Acc: 0.327
Validation loss decreased (-0.288959 --> -0.326982).  Saving model ...
Epoch: 15 cost time: 3.072012424468994
Epoch: 15, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.499 Vali Acc: 0.289 Test Loss: 1.499 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1119544506073
Epoch: 16, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.514 Vali Acc: 0.259 Test Loss: 1.514 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.6117234230041504
Epoch: 17, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.486 Vali Acc: 0.281 Test Loss: 1.486 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6162941455841064
Epoch: 18, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.598 Vali Acc: 0.278 Test Loss: 1.598 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.6903181076049805
Epoch: 19, Steps: 17 | Train Loss: 1.166 Vali Loss: 1.495 Vali Acc: 0.323 Test Loss: 1.495 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1300365924835205
Epoch: 20, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.457 Vali Acc: 0.304 Test Loss: 1.457 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.159597635269165
Epoch: 21, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.458 Vali Acc: 0.319 Test Loss: 1.458 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.7109808921813965
Epoch: 22, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.472 Vali Acc: 0.346 Test Loss: 1.472 Test Acc: 0.346
Validation loss decreased (-0.326982 --> -0.345993).  Saving model ...
Epoch: 23 cost time: 2.6540560722351074
Epoch: 23, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.628 Vali Acc: 0.323 Test Loss: 1.628 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.358461618423462
Epoch: 24, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.489 Vali Acc: 0.376 Test Loss: 1.489 Test Acc: 0.376
Validation loss decreased (-0.345993 --> -0.376411).  Saving model ...
Epoch: 25 cost time: 2.693804979324341
Epoch: 25, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.474 Vali Acc: 0.384 Test Loss: 1.474 Test Acc: 0.384
Validation loss decreased (-0.376411 --> -0.384016).  Saving model ...
Epoch: 26 cost time: 2.8959755897521973
Epoch: 26, Steps: 17 | Train Loss: 0.871 Vali Loss: 1.482 Vali Acc: 0.376 Test Loss: 1.482 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.723982095718384
Epoch: 27, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.645 Vali Acc: 0.350 Test Loss: 1.645 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.061185598373413
Epoch: 28, Steps: 17 | Train Loss: 0.789 Vali Loss: 1.535 Vali Acc: 0.399 Test Loss: 1.535 Test Acc: 0.399
Validation loss decreased (-0.384016 --> -0.399224).  Saving model ...
Epoch: 29 cost time: 2.707293748855591
Epoch: 29, Steps: 17 | Train Loss: 0.735 Vali Loss: 1.592 Vali Acc: 0.411 Test Loss: 1.592 Test Acc: 0.411
Validation loss decreased (-0.399224 --> -0.410630).  Saving model ...
Epoch: 30 cost time: 2.6472325325012207
Epoch: 30, Steps: 17 | Train Loss: 0.686 Vali Loss: 1.537 Vali Acc: 0.411 Test Loss: 1.537 Test Acc: 0.411
Validation loss decreased (-0.410630 --> -0.410631).  Saving model ...
Epoch: 31 cost time: 2.5222856998443604
Epoch: 31, Steps: 17 | Train Loss: 0.697 Vali Loss: 1.638 Vali Acc: 0.426 Test Loss: 1.638 Test Acc: 0.426
Validation loss decreased (-0.410631 --> -0.425839).  Saving model ...
Epoch: 32 cost time: 2.483417510986328
Epoch: 32, Steps: 17 | Train Loss: 0.675 Vali Loss: 1.661 Vali Acc: 0.373 Test Loss: 1.661 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.824113368988037
Epoch: 33, Steps: 17 | Train Loss: 0.620 Vali Loss: 1.825 Vali Acc: 0.376 Test Loss: 1.825 Test Acc: 0.376
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.809453248977661
Epoch: 34, Steps: 17 | Train Loss: 0.716 Vali Loss: 1.829 Vali Acc: 0.376 Test Loss: 1.829 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.96783447265625
Epoch: 35, Steps: 17 | Train Loss: 0.652 Vali Loss: 1.831 Vali Acc: 0.350 Test Loss: 1.831 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.7621097564697266
Epoch: 36, Steps: 17 | Train Loss: 0.598 Vali Loss: 1.787 Vali Acc: 0.403 Test Loss: 1.787 Test Acc: 0.403
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.5319488048553467
Epoch: 37, Steps: 17 | Train Loss: 0.497 Vali Loss: 1.913 Vali Acc: 0.384 Test Loss: 1.913 Test Acc: 0.384
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.6216540336608887
Epoch: 38, Steps: 17 | Train Loss: 0.617 Vali Loss: 1.859 Vali Acc: 0.361 Test Loss: 1.859 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.786818742752075
Epoch: 39, Steps: 17 | Train Loss: 0.512 Vali Loss: 1.813 Vali Acc: 0.418 Test Loss: 1.813 Test Acc: 0.418
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.933804750442505
Epoch: 40, Steps: 17 | Train Loss: 0.479 Vali Loss: 1.839 Vali Acc: 0.384 Test Loss: 1.839 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.7166013717651367
Epoch: 41, Steps: 17 | Train Loss: 0.426 Vali Loss: 1.939 Vali Acc: 0.380 Test Loss: 1.939 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.42585551330798477
model parameter : 226100
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.596753120422363
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.429 Vali Acc: 0.228 Test Loss: 1.429 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 2.1272525787353516
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.442 Vali Acc: 0.232 Test Loss: 1.442 Test Acc: 0.232
Validation loss decreased (-0.228123 --> -0.231925).  Saving model ...
Epoch: 3 cost time: 2.616875171661377
Epoch: 3, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.438 Vali Acc: 0.247 Test Loss: 1.438 Test Acc: 0.247
Validation loss decreased (-0.231925 --> -0.247134).  Saving model ...
Epoch: 4 cost time: 2.2853143215179443
Epoch: 4, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.422 Vali Acc: 0.259 Test Loss: 1.422 Test Acc: 0.259
Validation loss decreased (-0.247134 --> -0.258541).  Saving model ...
Epoch: 5 cost time: 2.2360095977783203
Epoch: 5, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.470 Vali Acc: 0.270 Test Loss: 1.470 Test Acc: 0.270
Validation loss decreased (-0.258541 --> -0.269947).  Saving model ...
Epoch: 6 cost time: 2.489443063735962
Epoch: 6, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.441 Vali Acc: 0.274 Test Loss: 1.441 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273750).  Saving model ...
Epoch: 7 cost time: 2.419924020767212
Epoch: 7, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.435 Vali Acc: 0.270 Test Loss: 1.435 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1714303493499756
Epoch: 8, Steps: 17 | Train Loss: 1.348 Vali Loss: 1.402 Vali Acc: 0.240 Test Loss: 1.402 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.159536123275757
Epoch: 9, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.420 Vali Acc: 0.270 Test Loss: 1.420 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.219817876815796
Epoch: 10, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.601 Vali Acc: 0.259 Test Loss: 1.601 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.568460702896118
Epoch: 11, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.515 Vali Acc: 0.259 Test Loss: 1.515 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.696859121322632
Epoch: 12, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.491 Vali Acc: 0.270 Test Loss: 1.491 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.847810745239258
Epoch: 13, Steps: 17 | Train Loss: 1.287 Vali Loss: 1.552 Vali Acc: 0.270 Test Loss: 1.552 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.6104915142059326
Epoch: 14, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.507 Vali Acc: 0.243 Test Loss: 1.507 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.65899395942688
Epoch: 15, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.511 Vali Acc: 0.270 Test Loss: 1.511 Test Acc: 0.270
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.352836847305298
Epoch: 16, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.513 Vali Acc: 0.251 Test Loss: 1.513 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 217908
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.592363119125366
Epoch: 1, Steps: 17 | Train Loss: 1.605 Vali Loss: 1.986 Vali Acc: 0.270 Test Loss: 1.986 Test Acc: 0.270
Validation loss decreased (inf --> -0.269942).  Saving model ...
Epoch: 2 cost time: 3.720822811126709
Epoch: 2, Steps: 17 | Train Loss: 1.661 Vali Loss: 1.927 Vali Acc: 0.240 Test Loss: 1.927 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4265291690826416
Epoch: 3, Steps: 17 | Train Loss: 1.760 Vali Loss: 1.470 Vali Acc: 0.259 Test Loss: 1.470 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9548115730285645
Epoch: 4, Steps: 17 | Train Loss: 1.602 Vali Loss: 2.936 Vali Acc: 0.251 Test Loss: 2.936 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.2113752365112305
Epoch: 5, Steps: 17 | Train Loss: 1.988 Vali Loss: 2.100 Vali Acc: 0.259 Test Loss: 2.100 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.2545032501220703
Epoch: 6, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.924 Vali Acc: 0.251 Test Loss: 1.924 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.250593662261963
Epoch: 7, Steps: 17 | Train Loss: 1.445 Vali Loss: 2.055 Vali Acc: 0.240 Test Loss: 2.055 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.0203020572662354
Epoch: 8, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.950 Vali Acc: 0.304 Test Loss: 1.950 Test Acc: 0.304
Validation loss decreased (-0.269942 --> -0.304163).  Saving model ...
Epoch: 9 cost time: 3.706517457962036
Epoch: 9, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.777 Vali Acc: 0.335 Test Loss: 1.777 Test Acc: 0.335
Validation loss decreased (-0.304163 --> -0.334583).  Saving model ...
Epoch: 10 cost time: 3.4283814430236816
Epoch: 10, Steps: 17 | Train Loss: 1.155 Vali Loss: 1.763 Vali Acc: 0.319 Test Loss: 1.763 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.3859565258026123
Epoch: 11, Steps: 17 | Train Loss: 1.381 Vali Loss: 2.358 Vali Acc: 0.262 Test Loss: 2.358 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.5254814624786377
Epoch: 12, Steps: 17 | Train Loss: 1.174 Vali Loss: 2.209 Vali Acc: 0.308 Test Loss: 2.209 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.63035249710083
Epoch: 13, Steps: 17 | Train Loss: 0.906 Vali Loss: 1.843 Vali Acc: 0.312 Test Loss: 1.843 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.395969867706299
Epoch: 14, Steps: 17 | Train Loss: 0.813 Vali Loss: 2.081 Vali Acc: 0.335 Test Loss: 2.081 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.8922436237335205
Epoch: 15, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.006 Vali Acc: 0.316 Test Loss: 2.006 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.742255210876465
Epoch: 16, Steps: 17 | Train Loss: 0.825 Vali Loss: 2.556 Vali Acc: 0.335 Test Loss: 2.556 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.638845205307007
Epoch: 17, Steps: 17 | Train Loss: 1.021 Vali Loss: 2.131 Vali Acc: 0.354 Test Loss: 2.131 Test Acc: 0.354
Validation loss decreased (-0.334583 --> -0.353591).  Saving model ...
Epoch: 18 cost time: 4.205436944961548
Epoch: 18, Steps: 17 | Train Loss: 0.793 Vali Loss: 2.334 Vali Acc: 0.342 Test Loss: 2.334 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.9250659942626953
Epoch: 19, Steps: 17 | Train Loss: 0.732 Vali Loss: 2.331 Vali Acc: 0.323 Test Loss: 2.331 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.453606128692627
Epoch: 20, Steps: 17 | Train Loss: 0.952 Vali Loss: 3.067 Vali Acc: 0.270 Test Loss: 3.067 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.17319130897522
Epoch: 21, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.553 Vali Acc: 0.274 Test Loss: 2.553 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.843217134475708
Epoch: 22, Steps: 17 | Train Loss: 0.693 Vali Loss: 2.461 Vali Acc: 0.304 Test Loss: 2.461 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.8440842628479004
Epoch: 23, Steps: 17 | Train Loss: 0.523 Vali Loss: 2.702 Vali Acc: 0.357 Test Loss: 2.702 Test Acc: 0.357
Validation loss decreased (-0.353591 --> -0.357387).  Saving model ...
Epoch: 24 cost time: 2.7522332668304443
Epoch: 24, Steps: 17 | Train Loss: 0.451 Vali Loss: 2.830 Vali Acc: 0.308 Test Loss: 2.830 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.7649552822113037
Epoch: 25, Steps: 17 | Train Loss: 0.722 Vali Loss: 3.020 Vali Acc: 0.297 Test Loss: 3.020 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.911914348602295
Epoch: 26, Steps: 17 | Train Loss: 0.568 Vali Loss: 3.226 Vali Acc: 0.300 Test Loss: 3.226 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.912111282348633
Epoch: 27, Steps: 17 | Train Loss: 0.650 Vali Loss: 3.269 Vali Acc: 0.350 Test Loss: 3.269 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.032294988632202
Epoch: 28, Steps: 17 | Train Loss: 0.685 Vali Loss: 5.067 Vali Acc: 0.304 Test Loss: 5.067 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.6564691066741943
Epoch: 29, Steps: 17 | Train Loss: 0.924 Vali Loss: 4.069 Vali Acc: 0.308 Test Loss: 4.069 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.009692668914795
Epoch: 30, Steps: 17 | Train Loss: 0.497 Vali Loss: 3.676 Vali Acc: 0.354 Test Loss: 3.676 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.339378595352173
Epoch: 31, Steps: 17 | Train Loss: 0.511 Vali Loss: 4.188 Vali Acc: 0.338 Test Loss: 4.188 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.41446590423584
Epoch: 32, Steps: 17 | Train Loss: 0.425 Vali Loss: 3.365 Vali Acc: 0.297 Test Loss: 3.365 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.612769365310669
Epoch: 33, Steps: 17 | Train Loss: 0.419 Vali Loss: 4.419 Vali Acc: 0.304 Test Loss: 4.419 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3574144486692015
model parameter : 8480040
model size : 37.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.209209442138672
Epoch: 1, Steps: 17 | Train Loss: 1.577 Vali Loss: 1.969 Vali Acc: 0.232 Test Loss: 1.969 Test Acc: 0.232
Validation loss decreased (inf --> -0.231919).  Saving model ...
Epoch: 2 cost time: 3.7777421474456787
Epoch: 2, Steps: 17 | Train Loss: 1.728 Vali Loss: 1.880 Vali Acc: 0.251 Test Loss: 1.880 Test Acc: 0.251
Validation loss decreased (-0.231919 --> -0.250932).  Saving model ...
Epoch: 3 cost time: 3.523256540298462
Epoch: 3, Steps: 17 | Train Loss: 1.598 Vali Loss: 1.618 Vali Acc: 0.243 Test Loss: 1.618 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.800854206085205
Epoch: 4, Steps: 17 | Train Loss: 1.856 Vali Loss: 1.974 Vali Acc: 0.251 Test Loss: 1.974 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.09931755065918
Epoch: 5, Steps: 17 | Train Loss: 1.643 Vali Loss: 1.648 Vali Acc: 0.247 Test Loss: 1.648 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 4.189364671707153
Epoch: 6, Steps: 17 | Train Loss: 1.695 Vali Loss: 2.134 Vali Acc: 0.259 Test Loss: 2.134 Test Acc: 0.259
Validation loss decreased (-0.250932 --> -0.258534).  Saving model ...
Epoch: 7 cost time: 3.92240834236145
Epoch: 7, Steps: 17 | Train Loss: 1.557 Vali Loss: 1.708 Vali Acc: 0.259 Test Loss: 1.708 Test Acc: 0.259
Validation loss decreased (-0.258534 --> -0.258538).  Saving model ...
Epoch: 8 cost time: 3.8137078285217285
Epoch: 8, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.945 Vali Acc: 0.259 Test Loss: 1.945 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0591702461242676
Epoch: 9, Steps: 17 | Train Loss: 1.317 Vali Loss: 1.950 Vali Acc: 0.255 Test Loss: 1.950 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.7211081981658936
Epoch: 10, Steps: 17 | Train Loss: 1.203 Vali Loss: 2.464 Vali Acc: 0.281 Test Loss: 2.464 Test Acc: 0.281
Validation loss decreased (-0.258538 --> -0.281344).  Saving model ...
Epoch: 11 cost time: 3.2578117847442627
Epoch: 11, Steps: 17 | Train Loss: 1.199 Vali Loss: 2.353 Vali Acc: 0.316 Test Loss: 2.353 Test Acc: 0.316
Validation loss decreased (-0.281344 --> -0.315566).  Saving model ...
Epoch: 12 cost time: 3.088906764984131
Epoch: 12, Steps: 17 | Train Loss: 1.134 Vali Loss: 2.151 Vali Acc: 0.304 Test Loss: 2.151 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3818211555480957
Epoch: 13, Steps: 17 | Train Loss: 1.320 Vali Loss: 2.023 Vali Acc: 0.308 Test Loss: 2.023 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.872537612915039
Epoch: 14, Steps: 17 | Train Loss: 1.020 Vali Loss: 2.398 Vali Acc: 0.300 Test Loss: 2.398 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.9275689125061035
Epoch: 15, Steps: 17 | Train Loss: 1.147 Vali Loss: 2.313 Vali Acc: 0.281 Test Loss: 2.313 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.076886415481567
Epoch: 16, Steps: 17 | Train Loss: 0.995 Vali Loss: 2.596 Vali Acc: 0.304 Test Loss: 2.596 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.449296474456787
Epoch: 17, Steps: 17 | Train Loss: 1.003 Vali Loss: 2.535 Vali Acc: 0.270 Test Loss: 2.535 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.4696738719940186
Epoch: 18, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.800 Vali Acc: 0.319 Test Loss: 2.800 Test Acc: 0.319
Validation loss decreased (-0.315566 --> -0.319364).  Saving model ...
Epoch: 19 cost time: 3.5707201957702637
Epoch: 19, Steps: 17 | Train Loss: 0.965 Vali Loss: 2.570 Vali Acc: 0.297 Test Loss: 2.570 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.218008756637573
Epoch: 20, Steps: 17 | Train Loss: 0.772 Vali Loss: 3.526 Vali Acc: 0.300 Test Loss: 3.526 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.8188316822052
Epoch: 21, Steps: 17 | Train Loss: 0.845 Vali Loss: 4.349 Vali Acc: 0.293 Test Loss: 4.349 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.2594053745269775
Epoch: 22, Steps: 17 | Train Loss: 0.878 Vali Loss: 3.586 Vali Acc: 0.316 Test Loss: 3.586 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.427149534225464
Epoch: 23, Steps: 17 | Train Loss: 0.802 Vali Loss: 3.424 Vali Acc: 0.278 Test Loss: 3.424 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.9468228816986084
Epoch: 24, Steps: 17 | Train Loss: 0.695 Vali Loss: 2.739 Vali Acc: 0.293 Test Loss: 2.739 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.422268629074097
Epoch: 25, Steps: 17 | Train Loss: 0.572 Vali Loss: 2.761 Vali Acc: 0.319 Test Loss: 2.761 Test Acc: 0.319
Validation loss decreased (-0.319364 --> -0.319364).  Saving model ...
Epoch: 26 cost time: 3.9195470809936523
Epoch: 26, Steps: 17 | Train Loss: 0.554 Vali Loss: 3.846 Vali Acc: 0.304 Test Loss: 3.846 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.464839220046997
Epoch: 27, Steps: 17 | Train Loss: 0.622 Vali Loss: 4.024 Vali Acc: 0.274 Test Loss: 4.024 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.5683083534240723
Epoch: 28, Steps: 17 | Train Loss: 0.560 Vali Loss: 3.502 Vali Acc: 0.266 Test Loss: 3.502 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.197824478149414
Epoch: 29, Steps: 17 | Train Loss: 0.445 Vali Loss: 3.448 Vali Acc: 0.308 Test Loss: 3.448 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.3926167488098145
Epoch: 30, Steps: 17 | Train Loss: 0.487 Vali Loss: 3.784 Vali Acc: 0.297 Test Loss: 3.784 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 4.115801572799683
Epoch: 31, Steps: 17 | Train Loss: 0.619 Vali Loss: 3.523 Vali Acc: 0.300 Test Loss: 3.523 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.128143548965454
Epoch: 32, Steps: 17 | Train Loss: 0.476 Vali Loss: 3.788 Vali Acc: 0.274 Test Loss: 3.788 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.60626220703125
Epoch: 33, Steps: 17 | Train Loss: 0.480 Vali Loss: 4.745 Vali Acc: 0.281 Test Loss: 4.745 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.248473644256592
Epoch: 34, Steps: 17 | Train Loss: 0.544 Vali Loss: 3.984 Vali Acc: 0.331 Test Loss: 3.984 Test Acc: 0.331
Validation loss decreased (-0.319364 --> -0.330759).  Saving model ...
Epoch: 35 cost time: 2.881819009780884
Epoch: 35, Steps: 17 | Train Loss: 0.602 Vali Loss: 3.335 Vali Acc: 0.278 Test Loss: 3.335 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.761152744293213
Epoch: 36, Steps: 17 | Train Loss: 0.516 Vali Loss: 4.672 Vali Acc: 0.293 Test Loss: 4.672 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.850984573364258
Epoch: 37, Steps: 17 | Train Loss: 0.284 Vali Loss: 4.570 Vali Acc: 0.331 Test Loss: 4.570 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.8285634517669678
Epoch: 38, Steps: 17 | Train Loss: 0.452 Vali Loss: 5.299 Vali Acc: 0.289 Test Loss: 5.299 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 3.747973680496216
Epoch: 39, Steps: 17 | Train Loss: 0.700 Vali Loss: 5.049 Vali Acc: 0.281 Test Loss: 5.049 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.315079689025879
Epoch: 40, Steps: 17 | Train Loss: 0.485 Vali Loss: 4.229 Vali Acc: 0.319 Test Loss: 4.229 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.511482238769531
Epoch: 41, Steps: 17 | Train Loss: 0.569 Vali Loss: 4.255 Vali Acc: 0.319 Test Loss: 4.255 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.352787733078003
Epoch: 42, Steps: 17 | Train Loss: 0.563 Vali Loss: 4.103 Vali Acc: 0.300 Test Loss: 4.103 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.961751699447632
Epoch: 43, Steps: 17 | Train Loss: 0.481 Vali Loss: 5.963 Vali Acc: 0.331 Test Loss: 5.963 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.727353572845459
Epoch: 44, Steps: 17 | Train Loss: 0.711 Vali Loss: 4.861 Vali Acc: 0.293 Test Loss: 4.861 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33079847908745247
model parameter : 8423976
model size : 37.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.636304616928101
Epoch: 1, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.445 Vali Acc: 0.259 Test Loss: 1.445 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 3.7286601066589355
Epoch: 2, Steps: 17 | Train Loss: 1.686 Vali Loss: 2.454 Vali Acc: 0.255 Test Loss: 2.454 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.670071840286255
Epoch: 3, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.936 Vali Acc: 0.243 Test Loss: 1.936 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.9413793087005615
Epoch: 4, Steps: 17 | Train Loss: 1.748 Vali Loss: 1.567 Vali Acc: 0.293 Test Loss: 1.567 Test Acc: 0.293
Validation loss decreased (-0.258541 --> -0.292760).  Saving model ...
Epoch: 5 cost time: 3.2930197715759277
Epoch: 5, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.943 Vali Acc: 0.266 Test Loss: 1.943 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.797156810760498
Epoch: 6, Steps: 17 | Train Loss: 1.603 Vali Loss: 2.876 Vali Acc: 0.266 Test Loss: 2.876 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.5664994716644287
Epoch: 7, Steps: 17 | Train Loss: 2.013 Vali Loss: 1.668 Vali Acc: 0.270 Test Loss: 1.668 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2489025592803955
Epoch: 8, Steps: 17 | Train Loss: 1.464 Vali Loss: 2.533 Vali Acc: 0.255 Test Loss: 2.533 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.22103476524353
Epoch: 9, Steps: 17 | Train Loss: 1.518 Vali Loss: 2.824 Vali Acc: 0.251 Test Loss: 2.824 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.3672871589660645
Epoch: 10, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.947 Vali Acc: 0.274 Test Loss: 1.947 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.83742094039917
Epoch: 11, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.727 Vali Acc: 0.342 Test Loss: 1.727 Test Acc: 0.342
Validation loss decreased (-0.292760 --> -0.342188).  Saving model ...
Epoch: 12 cost time: 3.4047389030456543
Epoch: 12, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.911 Vali Acc: 0.346 Test Loss: 1.911 Test Acc: 0.346
Validation loss decreased (-0.342188 --> -0.345988).  Saving model ...
Epoch: 13 cost time: 3.7378084659576416
Epoch: 13, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.981 Vali Acc: 0.293 Test Loss: 1.981 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.900913715362549
Epoch: 14, Steps: 17 | Train Loss: 1.087 Vali Loss: 2.050 Vali Acc: 0.278 Test Loss: 2.050 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9797441959381104
Epoch: 15, Steps: 17 | Train Loss: 1.125 Vali Loss: 2.173 Vali Acc: 0.300 Test Loss: 2.173 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.006089925765991
Epoch: 16, Steps: 17 | Train Loss: 1.336 Vali Loss: 2.631 Vali Acc: 0.259 Test Loss: 2.631 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.3452961444854736
Epoch: 17, Steps: 17 | Train Loss: 1.115 Vali Loss: 2.291 Vali Acc: 0.361 Test Loss: 2.291 Test Acc: 0.361
Validation loss decreased (-0.345988 --> -0.361194).  Saving model ...
Epoch: 18 cost time: 3.518930673599243
Epoch: 18, Steps: 17 | Train Loss: 1.245 Vali Loss: 2.454 Vali Acc: 0.308 Test Loss: 2.454 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6862692832946777
Epoch: 19, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.472 Vali Acc: 0.300 Test Loss: 2.472 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.8767004013061523
Epoch: 20, Steps: 17 | Train Loss: 0.900 Vali Loss: 2.684 Vali Acc: 0.300 Test Loss: 2.684 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2310147285461426
Epoch: 21, Steps: 17 | Train Loss: 0.817 Vali Loss: 3.390 Vali Acc: 0.293 Test Loss: 3.390 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.540998697280884
Epoch: 22, Steps: 17 | Train Loss: 0.958 Vali Loss: 2.551 Vali Acc: 0.300 Test Loss: 2.551 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.0760648250579834
Epoch: 23, Steps: 17 | Train Loss: 0.841 Vali Loss: 3.134 Vali Acc: 0.304 Test Loss: 3.134 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3777027130126953
Epoch: 24, Steps: 17 | Train Loss: 0.873 Vali Loss: 3.395 Vali Acc: 0.297 Test Loss: 3.395 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.687546968460083
Epoch: 25, Steps: 17 | Train Loss: 1.072 Vali Loss: 2.950 Vali Acc: 0.297 Test Loss: 2.950 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.977168321609497
Epoch: 26, Steps: 17 | Train Loss: 0.737 Vali Loss: 3.122 Vali Acc: 0.304 Test Loss: 3.122 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.595080614089966
Epoch: 27, Steps: 17 | Train Loss: 0.576 Vali Loss: 3.630 Vali Acc: 0.316 Test Loss: 3.630 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3612167300380228
model parameter : 8367912
model size : 36.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.883464097976685
Epoch: 1, Steps: 17 | Train Loss: 1.616 Vali Loss: 1.917 Vali Acc: 0.255 Test Loss: 1.917 Test Acc: 0.255
Validation loss decreased (inf --> -0.254734).  Saving model ...
Epoch: 2 cost time: 3.1402058601379395
Epoch: 2, Steps: 17 | Train Loss: 1.746 Vali Loss: 1.876 Vali Acc: 0.255 Test Loss: 1.876 Test Acc: 0.255
Validation loss decreased (-0.254734 --> -0.254734).  Saving model ...
Epoch: 3 cost time: 3.0448238849639893
Epoch: 3, Steps: 17 | Train Loss: 1.855 Vali Loss: 2.215 Vali Acc: 0.270 Test Loss: 2.215 Test Acc: 0.270
Validation loss decreased (-0.254734 --> -0.269940).  Saving model ...
Epoch: 4 cost time: 3.6689093112945557
Epoch: 4, Steps: 17 | Train Loss: 1.802 Vali Loss: 1.598 Vali Acc: 0.278 Test Loss: 1.598 Test Acc: 0.278
Validation loss decreased (-0.269940 --> -0.277551).  Saving model ...
Epoch: 5 cost time: 4.046545505523682
Epoch: 5, Steps: 17 | Train Loss: 2.092 Vali Loss: 2.267 Vali Acc: 0.289 Test Loss: 2.267 Test Acc: 0.289
Validation loss decreased (-0.277551 --> -0.288951).  Saving model ...
Epoch: 6 cost time: 3.2670674324035645
Epoch: 6, Steps: 17 | Train Loss: 1.817 Vali Loss: 2.625 Vali Acc: 0.308 Test Loss: 2.625 Test Acc: 0.308
Validation loss decreased (-0.288951 --> -0.307959).  Saving model ...
Epoch: 7 cost time: 3.419285535812378
Epoch: 7, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.933 Vali Acc: 0.255 Test Loss: 1.933 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.988281011581421
Epoch: 8, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.935 Vali Acc: 0.259 Test Loss: 1.935 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.174466848373413
Epoch: 9, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.970 Vali Acc: 0.281 Test Loss: 1.970 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.309674263000488
Epoch: 10, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.717 Vali Acc: 0.308 Test Loss: 1.717 Test Acc: 0.308
Validation loss decreased (-0.307959 --> -0.307968).  Saving model ...
Epoch: 11 cost time: 3.65449595451355
Epoch: 11, Steps: 17 | Train Loss: 1.235 Vali Loss: 2.582 Vali Acc: 0.274 Test Loss: 2.582 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.246412515640259
Epoch: 12, Steps: 17 | Train Loss: 1.320 Vali Loss: 2.104 Vali Acc: 0.300 Test Loss: 2.104 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9433977603912354
Epoch: 13, Steps: 17 | Train Loss: 0.966 Vali Loss: 2.183 Vali Acc: 0.327 Test Loss: 2.183 Test Acc: 0.327
Validation loss decreased (-0.307968 --> -0.326974).  Saving model ...
Epoch: 14 cost time: 3.2139506340026855
Epoch: 14, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.280 Vali Acc: 0.323 Test Loss: 2.280 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7819108963012695
Epoch: 15, Steps: 17 | Train Loss: 0.880 Vali Loss: 2.357 Vali Acc: 0.361 Test Loss: 2.357 Test Acc: 0.361
Validation loss decreased (-0.326974 --> -0.361193).  Saving model ...
Epoch: 16 cost time: 2.5945332050323486
Epoch: 16, Steps: 17 | Train Loss: 0.881 Vali Loss: 3.061 Vali Acc: 0.266 Test Loss: 3.061 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.7456164360046387
Epoch: 17, Steps: 17 | Train Loss: 1.041 Vali Loss: 2.073 Vali Acc: 0.327 Test Loss: 2.073 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.00370717048645
Epoch: 18, Steps: 17 | Train Loss: 0.942 Vali Loss: 2.864 Vali Acc: 0.304 Test Loss: 2.864 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.1051268577575684
Epoch: 19, Steps: 17 | Train Loss: 0.874 Vali Loss: 2.577 Vali Acc: 0.346 Test Loss: 2.577 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.9822616577148438
Epoch: 20, Steps: 17 | Train Loss: 0.707 Vali Loss: 2.220 Vali Acc: 0.300 Test Loss: 2.220 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.322901964187622
Epoch: 21, Steps: 17 | Train Loss: 0.749 Vali Loss: 2.759 Vali Acc: 0.342 Test Loss: 2.759 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.387754440307617
Epoch: 22, Steps: 17 | Train Loss: 0.683 Vali Loss: 2.485 Vali Acc: 0.319 Test Loss: 2.485 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.7224438190460205
Epoch: 23, Steps: 17 | Train Loss: 0.883 Vali Loss: 2.970 Vali Acc: 0.300 Test Loss: 2.970 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.9122045040130615
Epoch: 24, Steps: 17 | Train Loss: 0.651 Vali Loss: 2.943 Vali Acc: 0.384 Test Loss: 2.943 Test Acc: 0.384
Validation loss decreased (-0.361193 --> -0.384001).  Saving model ...
Epoch: 25 cost time: 3.5234150886535645
Epoch: 25, Steps: 17 | Train Loss: 0.572 Vali Loss: 3.294 Vali Acc: 0.365 Test Loss: 3.294 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.2821996212005615
Epoch: 26, Steps: 17 | Train Loss: 0.629 Vali Loss: 2.484 Vali Acc: 0.346 Test Loss: 2.484 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.3746423721313477
Epoch: 27, Steps: 17 | Train Loss: 0.581 Vali Loss: 3.558 Vali Acc: 0.342 Test Loss: 3.558 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.457082748413086
Epoch: 28, Steps: 17 | Train Loss: 0.539 Vali Loss: 4.227 Vali Acc: 0.297 Test Loss: 4.227 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.567349910736084
Epoch: 29, Steps: 17 | Train Loss: 0.891 Vali Loss: 2.874 Vali Acc: 0.342 Test Loss: 2.874 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.6991543769836426
Epoch: 30, Steps: 17 | Train Loss: 0.778 Vali Loss: 3.715 Vali Acc: 0.278 Test Loss: 3.715 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 3.613154649734497
Epoch: 31, Steps: 17 | Train Loss: 0.668 Vali Loss: 3.907 Vali Acc: 0.323 Test Loss: 3.907 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.143256187438965
Epoch: 32, Steps: 17 | Train Loss: 0.776 Vali Loss: 2.919 Vali Acc: 0.338 Test Loss: 2.919 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.019641637802124
Epoch: 33, Steps: 17 | Train Loss: 0.440 Vali Loss: 3.424 Vali Acc: 0.316 Test Loss: 3.424 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.502998113632202
Epoch: 34, Steps: 17 | Train Loss: 0.452 Vali Loss: 5.464 Vali Acc: 0.278 Test Loss: 5.464 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3840304182509506
model parameter : 8311848
model size : 36.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.0751447677612305
Epoch: 1, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.987 Vali Acc: 0.251 Test Loss: 1.987 Test Acc: 0.251
Validation loss decreased (inf --> -0.250931).  Saving model ...
Epoch: 2 cost time: 2.9878756999969482
Epoch: 2, Steps: 17 | Train Loss: 2.006 Vali Loss: 1.898 Vali Acc: 0.274 Test Loss: 1.898 Test Acc: 0.274
Validation loss decreased (-0.250931 --> -0.273745).  Saving model ...
Epoch: 3 cost time: 2.7927770614624023
Epoch: 3, Steps: 17 | Train Loss: 2.086 Vali Loss: 2.444 Vali Acc: 0.251 Test Loss: 2.444 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5259921550750732
Epoch: 4, Steps: 17 | Train Loss: 2.195 Vali Loss: 2.468 Vali Acc: 0.266 Test Loss: 2.468 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8439993858337402
Epoch: 5, Steps: 17 | Train Loss: 1.698 Vali Loss: 1.799 Vali Acc: 0.297 Test Loss: 1.799 Test Acc: 0.297
Validation loss decreased (-0.273745 --> -0.296560).  Saving model ...
Epoch: 6 cost time: 3.2978875637054443
Epoch: 6, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.792 Vali Acc: 0.274 Test Loss: 1.792 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2998056411743164
Epoch: 7, Steps: 17 | Train Loss: 1.692 Vali Loss: 2.206 Vali Acc: 0.236 Test Loss: 2.206 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.571220636367798
Epoch: 8, Steps: 17 | Train Loss: 1.525 Vali Loss: 1.759 Vali Acc: 0.274 Test Loss: 1.759 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7179343700408936
Epoch: 9, Steps: 17 | Train Loss: 1.320 Vali Loss: 2.556 Vali Acc: 0.259 Test Loss: 2.556 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.332343339920044
Epoch: 10, Steps: 17 | Train Loss: 1.610 Vali Loss: 1.827 Vali Acc: 0.304 Test Loss: 1.827 Test Acc: 0.304
Validation loss decreased (-0.296560 --> -0.304164).  Saving model ...
Epoch: 11 cost time: 3.813586950302124
Epoch: 11, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.742 Vali Acc: 0.342 Test Loss: 1.742 Test Acc: 0.342
Validation loss decreased (-0.304164 --> -0.342188).  Saving model ...
Epoch: 12 cost time: 3.9755537509918213
Epoch: 12, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.326 Vali Acc: 0.316 Test Loss: 2.326 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.049154281616211
Epoch: 13, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.780 Vali Acc: 0.380 Test Loss: 1.780 Test Acc: 0.380
Validation loss decreased (-0.342188 --> -0.380210).  Saving model ...
Epoch: 14 cost time: 3.8342456817626953
Epoch: 14, Steps: 17 | Train Loss: 0.966 Vali Loss: 2.138 Vali Acc: 0.300 Test Loss: 2.138 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.2356700897216797
Epoch: 15, Steps: 17 | Train Loss: 1.019 Vali Loss: 2.420 Vali Acc: 0.335 Test Loss: 2.420 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.129361629486084
Epoch: 16, Steps: 17 | Train Loss: 1.025 Vali Loss: 2.368 Vali Acc: 0.335 Test Loss: 2.368 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.143826484680176
Epoch: 17, Steps: 17 | Train Loss: 0.957 Vali Loss: 2.502 Vali Acc: 0.361 Test Loss: 2.502 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.883842706680298
Epoch: 18, Steps: 17 | Train Loss: 1.032 Vali Loss: 2.608 Vali Acc: 0.293 Test Loss: 2.608 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.0948336124420166
Epoch: 19, Steps: 17 | Train Loss: 0.790 Vali Loss: 2.499 Vali Acc: 0.380 Test Loss: 2.499 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.2586958408355713
Epoch: 20, Steps: 17 | Train Loss: 1.013 Vali Loss: 2.943 Vali Acc: 0.323 Test Loss: 2.943 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.8468127250671387
Epoch: 21, Steps: 17 | Train Loss: 0.633 Vali Loss: 3.962 Vali Acc: 0.331 Test Loss: 3.962 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.0823118686676025
Epoch: 22, Steps: 17 | Train Loss: 0.853 Vali Loss: 2.803 Vali Acc: 0.342 Test Loss: 2.803 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.1085593700408936
Epoch: 23, Steps: 17 | Train Loss: 0.936 Vali Loss: 2.574 Vali Acc: 0.323 Test Loss: 2.574 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38022813688212925
model parameter : 7166760
model size : 32.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.967045545578003
Epoch: 1, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.433 Vali Acc: 0.281 Test Loss: 1.433 Test Acc: 0.281
Validation loss decreased (inf --> -0.281354).  Saving model ...
Epoch: 2 cost time: 3.728118658065796
Epoch: 2, Steps: 17 | Train Loss: 1.757 Vali Loss: 2.082 Vali Acc: 0.274 Test Loss: 2.082 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8073394298553467
Epoch: 3, Steps: 17 | Train Loss: 1.651 Vali Loss: 1.682 Vali Acc: 0.236 Test Loss: 1.682 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.257702112197876
Epoch: 4, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.747 Vali Acc: 0.281 Test Loss: 1.747 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.6331286430358887
Epoch: 5, Steps: 17 | Train Loss: 1.743 Vali Loss: 2.334 Vali Acc: 0.247 Test Loss: 2.334 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.605161666870117
Epoch: 6, Steps: 17 | Train Loss: 2.093 Vali Loss: 2.498 Vali Acc: 0.247 Test Loss: 2.498 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.1907222270965576
Epoch: 7, Steps: 17 | Train Loss: 1.383 Vali Loss: 2.562 Vali Acc: 0.243 Test Loss: 2.562 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 3.127485990524292
Epoch: 8, Steps: 17 | Train Loss: 1.935 Vali Loss: 1.768 Vali Acc: 0.338 Test Loss: 1.768 Test Acc: 0.338
Validation loss decreased (-0.281354 --> -0.338385).  Saving model ...
Epoch: 9 cost time: 3.5109081268310547
Epoch: 9, Steps: 17 | Train Loss: 1.361 Vali Loss: 2.273 Vali Acc: 0.247 Test Loss: 2.273 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4764578342437744
Epoch: 10, Steps: 17 | Train Loss: 1.791 Vali Loss: 2.695 Vali Acc: 0.270 Test Loss: 2.695 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.7973532676696777
Epoch: 11, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.891 Vali Acc: 0.293 Test Loss: 1.891 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.020678281784058
Epoch: 12, Steps: 17 | Train Loss: 1.152 Vali Loss: 2.619 Vali Acc: 0.281 Test Loss: 2.619 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4023051261901855
Epoch: 13, Steps: 17 | Train Loss: 1.238 Vali Loss: 2.226 Vali Acc: 0.293 Test Loss: 2.226 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.5941333770751953
Epoch: 14, Steps: 17 | Train Loss: 0.932 Vali Loss: 2.097 Vali Acc: 0.300 Test Loss: 2.097 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.020487070083618
Epoch: 15, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.959 Vali Acc: 0.308 Test Loss: 1.959 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.882749319076538
Epoch: 16, Steps: 17 | Train Loss: 0.805 Vali Loss: 2.254 Vali Acc: 0.350 Test Loss: 2.254 Test Acc: 0.350
Validation loss decreased (-0.338385 --> -0.349787).  Saving model ...
Epoch: 17 cost time: 3.0952136516571045
Epoch: 17, Steps: 17 | Train Loss: 1.029 Vali Loss: 2.782 Vali Acc: 0.316 Test Loss: 2.782 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.714085102081299
Epoch: 18, Steps: 17 | Train Loss: 1.159 Vali Loss: 2.597 Vali Acc: 0.312 Test Loss: 2.597 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.6934685707092285
Epoch: 19, Steps: 17 | Train Loss: 0.982 Vali Loss: 2.357 Vali Acc: 0.285 Test Loss: 2.357 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.2729945182800293
Epoch: 20, Steps: 17 | Train Loss: 0.821 Vali Loss: 3.949 Vali Acc: 0.270 Test Loss: 3.949 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.331818103790283
Epoch: 21, Steps: 17 | Train Loss: 0.943 Vali Loss: 2.742 Vali Acc: 0.262 Test Loss: 2.742 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.6894919872283936
Epoch: 22, Steps: 17 | Train Loss: 0.644 Vali Loss: 3.855 Vali Acc: 0.293 Test Loss: 3.855 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.8321211338043213
Epoch: 23, Steps: 17 | Train Loss: 0.851 Vali Loss: 2.904 Vali Acc: 0.289 Test Loss: 2.904 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.6937918663024902
Epoch: 24, Steps: 17 | Train Loss: 0.857 Vali Loss: 3.606 Vali Acc: 0.266 Test Loss: 3.606 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.3745384216308594
Epoch: 25, Steps: 17 | Train Loss: 0.793 Vali Loss: 3.325 Vali Acc: 0.300 Test Loss: 3.325 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.4768645763397217
Epoch: 26, Steps: 17 | Train Loss: 0.784 Vali Loss: 3.347 Vali Acc: 0.304 Test Loss: 3.347 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34980988593155893
model parameter : 7110696
model size : 32.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.120543956756592
Epoch: 1, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.512 Vali Acc: 0.262 Test Loss: 1.512 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 3.455122709274292
Epoch: 2, Steps: 17 | Train Loss: 1.690 Vali Loss: 1.906 Vali Acc: 0.255 Test Loss: 1.906 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.701962947845459
Epoch: 3, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.556 Vali Acc: 0.270 Test Loss: 1.556 Test Acc: 0.270
Validation loss decreased (-0.262342 --> -0.269946).  Saving model ...
Epoch: 4 cost time: 3.5489344596862793
Epoch: 4, Steps: 17 | Train Loss: 1.471 Vali Loss: 2.144 Vali Acc: 0.251 Test Loss: 2.144 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4999537467956543
Epoch: 5, Steps: 17 | Train Loss: 1.559 Vali Loss: 2.226 Vali Acc: 0.232 Test Loss: 2.226 Test Acc: 0.232
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.7845523357391357
Epoch: 6, Steps: 17 | Train Loss: 1.993 Vali Loss: 2.842 Vali Acc: 0.270 Test Loss: 2.842 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.8093421459198
Epoch: 7, Steps: 17 | Train Loss: 1.982 Vali Loss: 2.023 Vali Acc: 0.297 Test Loss: 2.023 Test Acc: 0.297
Validation loss decreased (-0.269946 --> -0.296558).  Saving model ...
Epoch: 8 cost time: 3.245323896408081
Epoch: 8, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.941 Vali Acc: 0.259 Test Loss: 1.941 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0323662757873535
Epoch: 9, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.926 Vali Acc: 0.255 Test Loss: 1.926 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1679883003234863
Epoch: 10, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.616 Vali Acc: 0.335 Test Loss: 1.616 Test Acc: 0.335
Validation loss decreased (-0.296558 --> -0.334585).  Saving model ...
Epoch: 11 cost time: 3.823509931564331
Epoch: 11, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.833 Vali Acc: 0.278 Test Loss: 1.833 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2063076496124268
Epoch: 12, Steps: 17 | Train Loss: 1.252 Vali Loss: 2.262 Vali Acc: 0.259 Test Loss: 2.262 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7562546730041504
Epoch: 13, Steps: 17 | Train Loss: 1.079 Vali Loss: 2.754 Vali Acc: 0.278 Test Loss: 2.754 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.616255283355713
Epoch: 14, Steps: 17 | Train Loss: 1.409 Vali Loss: 2.301 Vali Acc: 0.240 Test Loss: 2.301 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.7261109352111816
Epoch: 15, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.860 Vali Acc: 0.350 Test Loss: 1.860 Test Acc: 0.350
Validation loss decreased (-0.334585 --> -0.349791).  Saving model ...
Epoch: 16 cost time: 3.839325428009033
Epoch: 16, Steps: 17 | Train Loss: 1.006 Vali Loss: 2.242 Vali Acc: 0.304 Test Loss: 2.242 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.209040403366089
Epoch: 17, Steps: 17 | Train Loss: 0.926 Vali Loss: 2.448 Vali Acc: 0.300 Test Loss: 2.448 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.547243595123291
Epoch: 18, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.976 Vali Acc: 0.297 Test Loss: 1.976 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.0172431468963623
Epoch: 19, Steps: 17 | Train Loss: 1.027 Vali Loss: 3.466 Vali Acc: 0.285 Test Loss: 3.466 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.1903629302978516
Epoch: 20, Steps: 17 | Train Loss: 1.010 Vali Loss: 2.547 Vali Acc: 0.300 Test Loss: 2.547 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9812893867492676
Epoch: 21, Steps: 17 | Train Loss: 0.778 Vali Loss: 3.045 Vali Acc: 0.278 Test Loss: 3.045 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3648569583892822
Epoch: 22, Steps: 17 | Train Loss: 0.741 Vali Loss: 3.270 Vali Acc: 0.312 Test Loss: 3.270 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.524339437484741
Epoch: 23, Steps: 17 | Train Loss: 0.930 Vali Loss: 3.478 Vali Acc: 0.278 Test Loss: 3.478 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.3788299560546875
Epoch: 24, Steps: 17 | Train Loss: 0.831 Vali Loss: 3.034 Vali Acc: 0.262 Test Loss: 3.034 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.1792681217193604
Epoch: 25, Steps: 17 | Train Loss: 0.811 Vali Loss: 2.709 Vali Acc: 0.278 Test Loss: 2.709 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34980988593155893
model parameter : 7054632
model size : 31.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.489839315414429
Epoch: 1, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.432 Vali Acc: 0.278 Test Loss: 1.432 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 3.716912269592285
Epoch: 2, Steps: 17 | Train Loss: 1.612 Vali Loss: 1.587 Vali Acc: 0.259 Test Loss: 1.587 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.357154369354248
Epoch: 3, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.904 Vali Acc: 0.243 Test Loss: 1.904 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5570054054260254
Epoch: 4, Steps: 17 | Train Loss: 1.620 Vali Loss: 2.057 Vali Acc: 0.281 Test Loss: 2.057 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281348).  Saving model ...
Epoch: 5 cost time: 3.540942430496216
Epoch: 5, Steps: 17 | Train Loss: 1.889 Vali Loss: 2.158 Vali Acc: 0.247 Test Loss: 2.158 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.475299596786499
Epoch: 6, Steps: 17 | Train Loss: 1.913 Vali Loss: 1.899 Vali Acc: 0.335 Test Loss: 1.899 Test Acc: 0.335
Validation loss decreased (-0.281348 --> -0.334582).  Saving model ...
Epoch: 7 cost time: 3.9630165100097656
Epoch: 7, Steps: 17 | Train Loss: 1.703 Vali Loss: 2.005 Vali Acc: 0.262 Test Loss: 2.005 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.589763641357422
Epoch: 8, Steps: 17 | Train Loss: 1.480 Vali Loss: 2.243 Vali Acc: 0.270 Test Loss: 2.243 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.2596614360809326
Epoch: 9, Steps: 17 | Train Loss: 1.488 Vali Loss: 3.024 Vali Acc: 0.255 Test Loss: 3.024 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.7098677158355713
Epoch: 10, Steps: 17 | Train Loss: 1.927 Vali Loss: 2.272 Vali Acc: 0.259 Test Loss: 2.272 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.8122894763946533
Epoch: 11, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.828 Vali Acc: 0.308 Test Loss: 1.828 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4655487537384033
Epoch: 12, Steps: 17 | Train Loss: 1.549 Vali Loss: 2.419 Vali Acc: 0.285 Test Loss: 2.419 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.750047206878662
Epoch: 13, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.998 Vali Acc: 0.297 Test Loss: 1.998 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 3.3574059009552
Epoch: 14, Steps: 17 | Train Loss: 1.062 Vali Loss: 2.870 Vali Acc: 0.281 Test Loss: 2.870 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.6197617053985596
Epoch: 15, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.515 Vali Acc: 0.259 Test Loss: 2.515 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 3.2399847507476807
Epoch: 16, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.954 Vali Acc: 0.338 Test Loss: 1.954 Test Acc: 0.338
Validation loss decreased (-0.334582 --> -0.338384).  Saving model ...
Epoch: 17 cost time: 2.959300994873047
Epoch: 17, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.285 Vali Acc: 0.243 Test Loss: 2.285 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3331799507141113
Epoch: 18, Steps: 17 | Train Loss: 1.035 Vali Loss: 3.656 Vali Acc: 0.255 Test Loss: 3.656 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.1298463344573975
Epoch: 19, Steps: 17 | Train Loss: 1.190 Vali Loss: 2.393 Vali Acc: 0.331 Test Loss: 2.393 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.542248249053955
Epoch: 20, Steps: 17 | Train Loss: 0.917 Vali Loss: 2.251 Vali Acc: 0.331 Test Loss: 2.251 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.2275989055633545
Epoch: 21, Steps: 17 | Train Loss: 0.709 Vali Loss: 2.724 Vali Acc: 0.342 Test Loss: 2.724 Test Acc: 0.342
Validation loss decreased (-0.338384 --> -0.342178).  Saving model ...
Epoch: 22 cost time: 3.3197944164276123
Epoch: 22, Steps: 17 | Train Loss: 0.987 Vali Loss: 3.054 Vali Acc: 0.285 Test Loss: 3.054 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.499897003173828
Epoch: 23, Steps: 17 | Train Loss: 0.789 Vali Loss: 3.036 Vali Acc: 0.293 Test Loss: 3.036 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.835545301437378
Epoch: 24, Steps: 17 | Train Loss: 0.834 Vali Loss: 3.121 Vali Acc: 0.308 Test Loss: 3.121 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.108776330947876
Epoch: 25, Steps: 17 | Train Loss: 0.578 Vali Loss: 3.559 Vali Acc: 0.331 Test Loss: 3.559 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.907341957092285
Epoch: 26, Steps: 17 | Train Loss: 0.781 Vali Loss: 3.127 Vali Acc: 0.297 Test Loss: 3.127 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.3967463970184326
Epoch: 27, Steps: 17 | Train Loss: 0.743 Vali Loss: 2.942 Vali Acc: 0.338 Test Loss: 2.942 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.838240385055542
Epoch: 28, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.911 Vali Acc: 0.247 Test Loss: 2.911 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.06369423866272
Epoch: 29, Steps: 17 | Train Loss: 0.690 Vali Loss: 2.935 Vali Acc: 0.297 Test Loss: 2.935 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.373525857925415
Epoch: 30, Steps: 17 | Train Loss: 0.494 Vali Loss: 4.693 Vali Acc: 0.281 Test Loss: 4.693 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.245085954666138
Epoch: 31, Steps: 17 | Train Loss: 0.625 Vali Loss: 4.424 Vali Acc: 0.312 Test Loss: 4.424 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34220532319391633
model parameter : 6998568
model size : 31.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.348037242889404
Epoch: 1, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.815 Vali Acc: 0.251 Test Loss: 1.815 Test Acc: 0.251
Validation loss decreased (inf --> -0.250932).  Saving model ...
Epoch: 2 cost time: 2.732625722885132
Epoch: 2, Steps: 17 | Train Loss: 1.554 Vali Loss: 2.476 Vali Acc: 0.255 Test Loss: 2.476 Test Acc: 0.255
Validation loss decreased (-0.250932 --> -0.254728).  Saving model ...
Epoch: 3 cost time: 2.066352367401123
Epoch: 3, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.771 Vali Acc: 0.300 Test Loss: 1.771 Test Acc: 0.300
Validation loss decreased (-0.254728 --> -0.300363).  Saving model ...
Epoch: 4 cost time: 2.9879939556121826
Epoch: 4, Steps: 17 | Train Loss: 1.604 Vali Loss: 1.529 Vali Acc: 0.319 Test Loss: 1.529 Test Acc: 0.319
Validation loss decreased (-0.300363 --> -0.319376).  Saving model ...
Epoch: 5 cost time: 3.0756030082702637
Epoch: 5, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.634 Vali Acc: 0.262 Test Loss: 1.634 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.962671995162964
Epoch: 6, Steps: 17 | Train Loss: 1.817 Vali Loss: 2.256 Vali Acc: 0.247 Test Loss: 2.256 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.885392904281616
Epoch: 7, Steps: 17 | Train Loss: 1.811 Vali Loss: 2.293 Vali Acc: 0.308 Test Loss: 2.293 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.6119260787963867
Epoch: 8, Steps: 17 | Train Loss: 2.594 Vali Loss: 2.821 Vali Acc: 0.240 Test Loss: 2.821 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.4775164127349854
Epoch: 9, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.633 Vali Acc: 0.293 Test Loss: 1.633 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.2848293781280518
Epoch: 10, Steps: 17 | Train Loss: 1.301 Vali Loss: 2.286 Vali Acc: 0.278 Test Loss: 2.286 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.2394943237304688
Epoch: 11, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.967 Vali Acc: 0.289 Test Loss: 1.967 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.095120906829834
Epoch: 12, Steps: 17 | Train Loss: 0.932 Vali Loss: 2.174 Vali Acc: 0.297 Test Loss: 2.174 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.6421828269958496
Epoch: 13, Steps: 17 | Train Loss: 1.064 Vali Loss: 2.430 Vali Acc: 0.281 Test Loss: 2.430 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.455765962600708
Epoch: 14, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.932 Vali Acc: 0.335 Test Loss: 1.932 Test Acc: 0.335
Validation loss decreased (-0.319376 --> -0.334581).  Saving model ...
Epoch: 15 cost time: 3.147588014602661
Epoch: 15, Steps: 17 | Train Loss: 0.959 Vali Loss: 2.496 Vali Acc: 0.304 Test Loss: 2.496 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3096938133239746
Epoch: 16, Steps: 17 | Train Loss: 0.888 Vali Loss: 2.697 Vali Acc: 0.297 Test Loss: 2.697 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.348477602005005
Epoch: 17, Steps: 17 | Train Loss: 0.806 Vali Loss: 3.068 Vali Acc: 0.354 Test Loss: 3.068 Test Acc: 0.354
Validation loss decreased (-0.334581 --> -0.353581).  Saving model ...
Epoch: 18 cost time: 3.71415114402771
Epoch: 18, Steps: 17 | Train Loss: 1.050 Vali Loss: 2.358 Vali Acc: 0.327 Test Loss: 2.358 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.8575167655944824
Epoch: 19, Steps: 17 | Train Loss: 0.781 Vali Loss: 2.197 Vali Acc: 0.335 Test Loss: 2.197 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6174721717834473
Epoch: 20, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.913 Vali Acc: 0.300 Test Loss: 2.913 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.7496204376220703
Epoch: 21, Steps: 17 | Train Loss: 0.738 Vali Loss: 3.958 Vali Acc: 0.293 Test Loss: 3.958 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.122592926025391
Epoch: 22, Steps: 17 | Train Loss: 1.245 Vali Loss: 2.830 Vali Acc: 0.297 Test Loss: 2.830 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.588573932647705
Epoch: 23, Steps: 17 | Train Loss: 0.853 Vali Loss: 4.272 Vali Acc: 0.342 Test Loss: 4.272 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.425104856491089
Epoch: 24, Steps: 17 | Train Loss: 1.176 Vali Loss: 2.953 Vali Acc: 0.335 Test Loss: 2.953 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.8056490421295166
Epoch: 25, Steps: 17 | Train Loss: 0.756 Vali Loss: 2.822 Vali Acc: 0.274 Test Loss: 2.822 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.289144277572632
Epoch: 26, Steps: 17 | Train Loss: 0.720 Vali Loss: 2.604 Vali Acc: 0.319 Test Loss: 2.604 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.149756669998169
Epoch: 27, Steps: 17 | Train Loss: 0.570 Vali Loss: 3.589 Vali Acc: 0.316 Test Loss: 3.589 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.35361216730038025
model parameter : 6510120
model size : 29.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.236783504486084
Epoch: 1, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.503 Vali Acc: 0.255 Test Loss: 1.503 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 3.1827306747436523
Epoch: 2, Steps: 17 | Train Loss: 1.637 Vali Loss: 2.149 Vali Acc: 0.266 Test Loss: 2.149 Test Acc: 0.266
Validation loss decreased (-0.254738 --> -0.266138).  Saving model ...
Epoch: 3 cost time: 3.1002964973449707
Epoch: 3, Steps: 17 | Train Loss: 1.646 Vali Loss: 2.111 Vali Acc: 0.278 Test Loss: 2.111 Test Acc: 0.278
Validation loss decreased (-0.266138 --> -0.277545).  Saving model ...
Epoch: 4 cost time: 2.6934549808502197
Epoch: 4, Steps: 17 | Train Loss: 2.110 Vali Loss: 2.041 Vali Acc: 0.247 Test Loss: 2.041 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8998162746429443
Epoch: 5, Steps: 17 | Train Loss: 2.019 Vali Loss: 2.237 Vali Acc: 0.304 Test Loss: 2.237 Test Acc: 0.304
Validation loss decreased (-0.277545 --> -0.304160).  Saving model ...
Epoch: 6 cost time: 3.227170944213867
Epoch: 6, Steps: 17 | Train Loss: 1.747 Vali Loss: 1.582 Vali Acc: 0.270 Test Loss: 1.582 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9495298862457275
Epoch: 7, Steps: 17 | Train Loss: 1.801 Vali Loss: 2.278 Vali Acc: 0.259 Test Loss: 2.278 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.727682590484619
Epoch: 8, Steps: 17 | Train Loss: 1.737 Vali Loss: 2.912 Vali Acc: 0.251 Test Loss: 2.912 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.659041404724121
Epoch: 9, Steps: 17 | Train Loss: 1.504 Vali Loss: 2.147 Vali Acc: 0.274 Test Loss: 2.147 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.796475410461426
Epoch: 10, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.979 Vali Acc: 0.289 Test Loss: 1.979 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.133511781692505
Epoch: 11, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.987 Vali Acc: 0.289 Test Loss: 1.987 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.047869920730591
Epoch: 12, Steps: 17 | Train Loss: 1.120 Vali Loss: 2.812 Vali Acc: 0.247 Test Loss: 2.812 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.492341995239258
Epoch: 13, Steps: 17 | Train Loss: 1.316 Vali Loss: 2.433 Vali Acc: 0.259 Test Loss: 2.433 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.007772922515869
Epoch: 14, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.080 Vali Acc: 0.297 Test Loss: 2.080 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.611344575881958
Epoch: 15, Steps: 17 | Train Loss: 1.058 Vali Loss: 2.224 Vali Acc: 0.312 Test Loss: 2.224 Test Acc: 0.312
Validation loss decreased (-0.304160 --> -0.311765).  Saving model ...
Epoch: 16 cost time: 3.6509289741516113
Epoch: 16, Steps: 17 | Train Loss: 0.938 Vali Loss: 2.042 Vali Acc: 0.304 Test Loss: 2.042 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.548298120498657
Epoch: 17, Steps: 17 | Train Loss: 0.911 Vali Loss: 2.527 Vali Acc: 0.323 Test Loss: 2.527 Test Acc: 0.323
Validation loss decreased (-0.311765 --> -0.323169).  Saving model ...
Epoch: 18 cost time: 4.012251138687134
Epoch: 18, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.899 Vali Acc: 0.304 Test Loss: 1.899 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.497403144836426
Epoch: 19, Steps: 17 | Train Loss: 0.741 Vali Loss: 2.605 Vali Acc: 0.278 Test Loss: 2.605 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.9612348079681396
Epoch: 20, Steps: 17 | Train Loss: 0.725 Vali Loss: 2.351 Vali Acc: 0.342 Test Loss: 2.351 Test Acc: 0.342
Validation loss decreased (-0.323169 --> -0.342182).  Saving model ...
Epoch: 21 cost time: 3.271328926086426
Epoch: 21, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.609 Vali Acc: 0.323 Test Loss: 2.609 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.6519582271575928
Epoch: 22, Steps: 17 | Train Loss: 0.775 Vali Loss: 3.002 Vali Acc: 0.270 Test Loss: 3.002 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.9721322059631348
Epoch: 23, Steps: 17 | Train Loss: 0.762 Vali Loss: 2.683 Vali Acc: 0.323 Test Loss: 2.683 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.5833280086517334
Epoch: 24, Steps: 17 | Train Loss: 0.439 Vali Loss: 2.732 Vali Acc: 0.319 Test Loss: 2.732 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.103242874145508
Epoch: 25, Steps: 17 | Train Loss: 0.553 Vali Loss: 2.770 Vali Acc: 0.335 Test Loss: 2.770 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.42641806602478
Epoch: 26, Steps: 17 | Train Loss: 0.688 Vali Loss: 3.785 Vali Acc: 0.266 Test Loss: 3.785 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.191386461257935
Epoch: 27, Steps: 17 | Train Loss: 0.452 Vali Loss: 3.147 Vali Acc: 0.319 Test Loss: 3.147 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.17537522315979
Epoch: 28, Steps: 17 | Train Loss: 0.668 Vali Loss: 3.887 Vali Acc: 0.323 Test Loss: 3.887 Test Acc: 0.323
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.516596794128418
Epoch: 29, Steps: 17 | Train Loss: 0.520 Vali Loss: 3.190 Vali Acc: 0.308 Test Loss: 3.190 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.219081163406372
Epoch: 30, Steps: 17 | Train Loss: 0.588 Vali Loss: 3.629 Vali Acc: 0.289 Test Loss: 3.629 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34220532319391633
model parameter : 6454056
model size : 29.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.7962610721588135
Epoch: 1, Steps: 17 | Train Loss: 1.449 Vali Loss: 2.013 Vali Acc: 0.251 Test Loss: 2.013 Test Acc: 0.251
Validation loss decreased (inf --> -0.250930).  Saving model ...
Epoch: 2 cost time: 3.8017420768737793
Epoch: 2, Steps: 17 | Train Loss: 1.775 Vali Loss: 2.200 Vali Acc: 0.255 Test Loss: 2.200 Test Acc: 0.255
Validation loss decreased (-0.250930 --> -0.254731).  Saving model ...
Epoch: 3 cost time: 3.54282283782959
Epoch: 3, Steps: 17 | Train Loss: 2.015 Vali Loss: 2.661 Vali Acc: 0.262 Test Loss: 2.661 Test Acc: 0.262
Validation loss decreased (-0.254731 --> -0.262331).  Saving model ...
Epoch: 4 cost time: 3.961934804916382
Epoch: 4, Steps: 17 | Train Loss: 2.197 Vali Loss: 1.917 Vali Acc: 0.300 Test Loss: 1.917 Test Acc: 0.300
Validation loss decreased (-0.262331 --> -0.300361).  Saving model ...
Epoch: 5 cost time: 3.8695993423461914
Epoch: 5, Steps: 17 | Train Loss: 1.510 Vali Loss: 2.024 Vali Acc: 0.251 Test Loss: 2.024 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9435980319976807
Epoch: 6, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.914 Vali Acc: 0.240 Test Loss: 1.914 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.556657314300537
Epoch: 7, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.728 Vali Acc: 0.297 Test Loss: 1.728 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1549949645996094
Epoch: 8, Steps: 17 | Train Loss: 1.472 Vali Loss: 2.748 Vali Acc: 0.262 Test Loss: 2.748 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.842249393463135
Epoch: 9, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.700 Vali Acc: 0.266 Test Loss: 1.700 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.225254058837891
Epoch: 10, Steps: 17 | Train Loss: 1.405 Vali Loss: 2.015 Vali Acc: 0.266 Test Loss: 2.015 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 4.4945900440216064
Epoch: 11, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.765 Vali Acc: 0.297 Test Loss: 1.765 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.193572759628296
Epoch: 12, Steps: 17 | Train Loss: 1.215 Vali Loss: 2.193 Vali Acc: 0.270 Test Loss: 2.193 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 4.288305044174194
Epoch: 13, Steps: 17 | Train Loss: 1.236 Vali Loss: 2.301 Vali Acc: 0.289 Test Loss: 2.301 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.6911752223968506
Epoch: 14, Steps: 17 | Train Loss: 1.256 Vali Loss: 2.495 Vali Acc: 0.293 Test Loss: 2.495 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 6397992
model size : 29.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.967074155807495
Epoch: 1, Steps: 17 | Train Loss: 1.536 Vali Loss: 2.120 Vali Acc: 0.247 Test Loss: 2.120 Test Acc: 0.247
Validation loss decreased (inf --> -0.247127).  Saving model ...
Epoch: 2 cost time: 3.3423917293548584
Epoch: 2, Steps: 17 | Train Loss: 1.920 Vali Loss: 1.600 Vali Acc: 0.281 Test Loss: 1.600 Test Acc: 0.281
Validation loss decreased (-0.247127 --> -0.281353).  Saving model ...
Epoch: 3 cost time: 3.674614667892456
Epoch: 3, Steps: 17 | Train Loss: 1.772 Vali Loss: 2.267 Vali Acc: 0.262 Test Loss: 2.267 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.498537540435791
Epoch: 4, Steps: 17 | Train Loss: 2.034 Vali Loss: 2.133 Vali Acc: 0.243 Test Loss: 2.133 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.9190094470977783
Epoch: 5, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.538 Vali Acc: 0.327 Test Loss: 1.538 Test Acc: 0.327
Validation loss decreased (-0.281353 --> -0.326981).  Saving model ...
Epoch: 6 cost time: 2.9014008045196533
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 2.186 Vali Acc: 0.281 Test Loss: 2.186 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6028237342834473
Epoch: 7, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.921 Vali Acc: 0.285 Test Loss: 1.921 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.817544460296631
Epoch: 8, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.928 Vali Acc: 0.262 Test Loss: 1.928 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.871314287185669
Epoch: 9, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.648 Vali Acc: 0.327 Test Loss: 1.648 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.326066732406616
Epoch: 10, Steps: 17 | Train Loss: 1.068 Vali Loss: 2.530 Vali Acc: 0.304 Test Loss: 2.530 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.5682976245880127
Epoch: 11, Steps: 17 | Train Loss: 2.026 Vali Loss: 2.380 Vali Acc: 0.300 Test Loss: 2.380 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.717214822769165
Epoch: 12, Steps: 17 | Train Loss: 1.256 Vali Loss: 2.400 Vali Acc: 0.278 Test Loss: 2.400 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.827575445175171
Epoch: 13, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.748 Vali Acc: 0.323 Test Loss: 1.748 Test Acc: 0.323
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.1101877689361572
Epoch: 14, Steps: 17 | Train Loss: 0.904 Vali Loss: 2.314 Vali Acc: 0.289 Test Loss: 2.314 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.14390230178833
Epoch: 15, Steps: 17 | Train Loss: 1.367 Vali Loss: 2.519 Vali Acc: 0.247 Test Loss: 2.519 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3269961977186312
model parameter : 6341928
model size : 29.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.253772020339966
Epoch: 1, Steps: 17 | Train Loss: 1.639 Vali Loss: 2.334 Vali Acc: 0.251 Test Loss: 2.334 Test Acc: 0.251
Validation loss decreased (inf --> -0.250927).  Saving model ...
Epoch: 2 cost time: 3.858198404312134
Epoch: 2, Steps: 17 | Train Loss: 1.698 Vali Loss: 1.795 Vali Acc: 0.255 Test Loss: 1.795 Test Acc: 0.255
Validation loss decreased (-0.250927 --> -0.254735).  Saving model ...
Epoch: 3 cost time: 3.6087493896484375
Epoch: 3, Steps: 17 | Train Loss: 1.630 Vali Loss: 1.822 Vali Acc: 0.262 Test Loss: 1.822 Test Acc: 0.262
Validation loss decreased (-0.254735 --> -0.262339).  Saving model ...
Epoch: 4 cost time: 3.512341260910034
Epoch: 4, Steps: 17 | Train Loss: 1.618 Vali Loss: 3.018 Vali Acc: 0.247 Test Loss: 3.018 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.3605990409851074
Epoch: 5, Steps: 17 | Train Loss: 2.026 Vali Loss: 2.503 Vali Acc: 0.255 Test Loss: 2.503 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.676734447479248
Epoch: 6, Steps: 17 | Train Loss: 1.812 Vali Loss: 1.776 Vali Acc: 0.251 Test Loss: 1.776 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.663939952850342
Epoch: 7, Steps: 17 | Train Loss: 1.665 Vali Loss: 2.205 Vali Acc: 0.262 Test Loss: 2.205 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.325740814208984
Epoch: 8, Steps: 17 | Train Loss: 1.461 Vali Loss: 2.183 Vali Acc: 0.255 Test Loss: 2.183 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 4.515996694564819
Epoch: 9, Steps: 17 | Train Loss: 1.309 Vali Loss: 2.211 Vali Acc: 0.281 Test Loss: 2.211 Test Acc: 0.281
Validation loss decreased (-0.262339 --> -0.281347).  Saving model ...
Epoch: 10 cost time: 4.485579252243042
Epoch: 10, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.723 Vali Acc: 0.338 Test Loss: 1.723 Test Acc: 0.338
Validation loss decreased (-0.281347 --> -0.338386).  Saving model ...
Epoch: 11 cost time: 4.298721790313721
Epoch: 11, Steps: 17 | Train Loss: 1.276 Vali Loss: 2.826 Vali Acc: 0.255 Test Loss: 2.826 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.401567697525024
Epoch: 12, Steps: 17 | Train Loss: 1.225 Vali Loss: 2.225 Vali Acc: 0.300 Test Loss: 2.225 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.192253828048706
Epoch: 13, Steps: 17 | Train Loss: 1.344 Vali Loss: 2.231 Vali Acc: 0.312 Test Loss: 2.231 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.6236605644226074
Epoch: 14, Steps: 17 | Train Loss: 1.074 Vali Loss: 2.395 Vali Acc: 0.278 Test Loss: 2.395 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.4857101440429688
Epoch: 15, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.346 Vali Acc: 0.289 Test Loss: 2.346 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.0346860885620117
Epoch: 16, Steps: 17 | Train Loss: 0.977 Vali Loss: 2.687 Vali Acc: 0.285 Test Loss: 2.687 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.893930196762085
Epoch: 17, Steps: 17 | Train Loss: 1.110 Vali Loss: 2.720 Vali Acc: 0.289 Test Loss: 2.720 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.0604777336120605
Epoch: 18, Steps: 17 | Train Loss: 0.798 Vali Loss: 2.150 Vali Acc: 0.335 Test Loss: 2.150 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.9151651859283447
Epoch: 19, Steps: 17 | Train Loss: 0.888 Vali Loss: 2.366 Vali Acc: 0.240 Test Loss: 2.366 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.9886608123779297
Epoch: 20, Steps: 17 | Train Loss: 0.689 Vali Loss: 3.112 Vali Acc: 0.323 Test Loss: 3.112 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33840304182509506
model parameter : 6181800
model size : 28.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.499476671218872
Epoch: 1, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.800 Vali Acc: 0.270 Test Loss: 1.800 Test Acc: 0.270
Validation loss decreased (inf --> -0.269944).  Saving model ...
Epoch: 2 cost time: 3.526231050491333
Epoch: 2, Steps: 17 | Train Loss: 1.834 Vali Loss: 2.084 Vali Acc: 0.247 Test Loss: 2.084 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8617005348205566
Epoch: 3, Steps: 17 | Train Loss: 1.728 Vali Loss: 1.572 Vali Acc: 0.293 Test Loss: 1.572 Test Acc: 0.293
Validation loss decreased (-0.269944 --> -0.292760).  Saving model ...
Epoch: 4 cost time: 3.7200939655303955
Epoch: 4, Steps: 17 | Train Loss: 1.683 Vali Loss: 1.666 Vali Acc: 0.255 Test Loss: 1.666 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.4117608070373535
Epoch: 5, Steps: 17 | Train Loss: 1.739 Vali Loss: 1.661 Vali Acc: 0.274 Test Loss: 1.661 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0932435989379883
Epoch: 6, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.649 Vali Acc: 0.331 Test Loss: 1.649 Test Acc: 0.331
Validation loss decreased (-0.292760 --> -0.330782).  Saving model ...
Epoch: 7 cost time: 3.2163214683532715
Epoch: 7, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.844 Vali Acc: 0.274 Test Loss: 1.844 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.300374746322632
Epoch: 8, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.836 Vali Acc: 0.289 Test Loss: 1.836 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.640324354171753
Epoch: 9, Steps: 17 | Train Loss: 1.605 Vali Loss: 2.075 Vali Acc: 0.331 Test Loss: 2.075 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.376701593399048
Epoch: 10, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.971 Vali Acc: 0.289 Test Loss: 1.971 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.842594623565674
Epoch: 11, Steps: 17 | Train Loss: 1.434 Vali Loss: 2.998 Vali Acc: 0.259 Test Loss: 2.998 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.787194013595581
Epoch: 12, Steps: 17 | Train Loss: 1.643 Vali Loss: 2.200 Vali Acc: 0.266 Test Loss: 2.200 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.402263641357422
Epoch: 13, Steps: 17 | Train Loss: 1.543 Vali Loss: 2.244 Vali Acc: 0.274 Test Loss: 2.244 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.008374929428101
Epoch: 14, Steps: 17 | Train Loss: 1.167 Vali Loss: 2.126 Vali Acc: 0.319 Test Loss: 2.126 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 3.5209131240844727
Epoch: 15, Steps: 17 | Train Loss: 1.090 Vali Loss: 2.535 Vali Acc: 0.342 Test Loss: 2.535 Test Acc: 0.342
Validation loss decreased (-0.330782 --> -0.342180).  Saving model ...
Epoch: 16 cost time: 2.9179296493530273
Epoch: 16, Steps: 17 | Train Loss: 1.378 Vali Loss: 2.758 Vali Acc: 0.323 Test Loss: 2.758 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.751699447631836
Epoch: 17, Steps: 17 | Train Loss: 1.118 Vali Loss: 2.324 Vali Acc: 0.300 Test Loss: 2.324 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.12323522567749
Epoch: 18, Steps: 17 | Train Loss: 1.094 Vali Loss: 2.196 Vali Acc: 0.316 Test Loss: 2.196 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.4482991695404053
Epoch: 19, Steps: 17 | Train Loss: 1.111 Vali Loss: 2.584 Vali Acc: 0.308 Test Loss: 2.584 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.005563497543335
Epoch: 20, Steps: 17 | Train Loss: 0.785 Vali Loss: 2.855 Vali Acc: 0.319 Test Loss: 2.855 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.7913777828216553
Epoch: 21, Steps: 17 | Train Loss: 0.995 Vali Loss: 2.132 Vali Acc: 0.350 Test Loss: 2.132 Test Acc: 0.350
Validation loss decreased (-0.342180 --> -0.349789).  Saving model ...
Epoch: 22 cost time: 3.922248125076294
Epoch: 22, Steps: 17 | Train Loss: 0.717 Vali Loss: 2.793 Vali Acc: 0.255 Test Loss: 2.793 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.8978374004364014
Epoch: 23, Steps: 17 | Train Loss: 0.834 Vali Loss: 3.219 Vali Acc: 0.255 Test Loss: 3.219 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.0261149406433105
Epoch: 24, Steps: 17 | Train Loss: 0.630 Vali Loss: 3.711 Vali Acc: 0.346 Test Loss: 3.711 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.839566230773926
Epoch: 25, Steps: 17 | Train Loss: 0.946 Vali Loss: 3.132 Vali Acc: 0.289 Test Loss: 3.132 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.284044027328491
Epoch: 26, Steps: 17 | Train Loss: 0.900 Vali Loss: 3.244 Vali Acc: 0.270 Test Loss: 3.244 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.5636792182922363
Epoch: 27, Steps: 17 | Train Loss: 0.657 Vali Loss: 2.836 Vali Acc: 0.331 Test Loss: 2.836 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.6566321849823
Epoch: 28, Steps: 17 | Train Loss: 0.509 Vali Loss: 2.950 Vali Acc: 0.274 Test Loss: 2.950 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.652143955230713
Epoch: 29, Steps: 17 | Train Loss: 0.638 Vali Loss: 3.514 Vali Acc: 0.236 Test Loss: 3.514 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.7543816566467285
Epoch: 30, Steps: 17 | Train Loss: 0.841 Vali Loss: 3.203 Vali Acc: 0.354 Test Loss: 3.203 Test Acc: 0.354
Validation loss decreased (-0.349789 --> -0.353580).  Saving model ...
Epoch: 31 cost time: 2.917295455932617
Epoch: 31, Steps: 17 | Train Loss: 0.719 Vali Loss: 3.522 Vali Acc: 0.335 Test Loss: 3.522 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.777153968811035
Epoch: 32, Steps: 17 | Train Loss: 0.515 Vali Loss: 3.768 Vali Acc: 0.274 Test Loss: 3.768 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.478640556335449
Epoch: 33, Steps: 17 | Train Loss: 0.578 Vali Loss: 3.248 Vali Acc: 0.346 Test Loss: 3.248 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.425652265548706
Epoch: 34, Steps: 17 | Train Loss: 0.502 Vali Loss: 4.109 Vali Acc: 0.285 Test Loss: 4.109 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.5350661277770996
Epoch: 35, Steps: 17 | Train Loss: 0.650 Vali Loss: 3.982 Vali Acc: 0.342 Test Loss: 3.982 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.5027384757995605
Epoch: 36, Steps: 17 | Train Loss: 0.485 Vali Loss: 4.249 Vali Acc: 0.312 Test Loss: 4.249 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.6015985012054443
Epoch: 37, Steps: 17 | Train Loss: 0.628 Vali Loss: 4.507 Vali Acc: 0.297 Test Loss: 4.507 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 3.427859306335449
Epoch: 38, Steps: 17 | Train Loss: 0.787 Vali Loss: 4.209 Vali Acc: 0.335 Test Loss: 4.209 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 3.120317220687866
Epoch: 39, Steps: 17 | Train Loss: 0.490 Vali Loss: 4.702 Vali Acc: 0.316 Test Loss: 4.702 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 3.8308725357055664
Epoch: 40, Steps: 17 | Train Loss: 0.498 Vali Loss: 4.383 Vali Acc: 0.281 Test Loss: 4.383 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.35361216730038025
model parameter : 6125736
model size : 28.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.520308494567871
Epoch: 1, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.645 Vali Acc: 0.274 Test Loss: 1.645 Test Acc: 0.274
Validation loss decreased (inf --> -0.273748).  Saving model ...
Epoch: 2 cost time: 4.351503372192383
Epoch: 2, Steps: 17 | Train Loss: 1.728 Vali Loss: 1.713 Vali Acc: 0.304 Test Loss: 1.713 Test Acc: 0.304
Validation loss decreased (-0.273748 --> -0.304165).  Saving model ...
Epoch: 3 cost time: 4.009906530380249
Epoch: 3, Steps: 17 | Train Loss: 1.578 Vali Loss: 2.566 Vali Acc: 0.255 Test Loss: 2.566 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.371882200241089
Epoch: 4, Steps: 17 | Train Loss: 1.789 Vali Loss: 1.819 Vali Acc: 0.270 Test Loss: 1.819 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 4.141634941101074
Epoch: 5, Steps: 17 | Train Loss: 1.608 Vali Loss: 1.888 Vali Acc: 0.243 Test Loss: 1.888 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.4965298175811768
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.933 Vali Acc: 0.251 Test Loss: 1.933 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.442681312561035
Epoch: 7, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.694 Vali Acc: 0.285 Test Loss: 1.694 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.705390214920044
Epoch: 8, Steps: 17 | Train Loss: 1.353 Vali Loss: 1.811 Vali Acc: 0.270 Test Loss: 1.811 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 4.004295110702515
Epoch: 9, Steps: 17 | Train Loss: 1.329 Vali Loss: 2.295 Vali Acc: 0.259 Test Loss: 2.295 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 3.899458408355713
Epoch: 10, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.974 Vali Acc: 0.312 Test Loss: 1.974 Test Acc: 0.312
Validation loss decreased (-0.304165 --> -0.311767).  Saving model ...
Epoch: 11 cost time: 3.085974931716919
Epoch: 11, Steps: 17 | Train Loss: 1.323 Vali Loss: 2.701 Vali Acc: 0.327 Test Loss: 2.701 Test Acc: 0.327
Validation loss decreased (-0.311767 --> -0.326969).  Saving model ...
Epoch: 12 cost time: 3.494680166244507
Epoch: 12, Steps: 17 | Train Loss: 1.296 Vali Loss: 2.089 Vali Acc: 0.278 Test Loss: 2.089 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.1294777393341064
Epoch: 13, Steps: 17 | Train Loss: 0.973 Vali Loss: 2.182 Vali Acc: 0.312 Test Loss: 2.182 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0070719718933105
Epoch: 14, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.962 Vali Acc: 0.270 Test Loss: 1.962 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0783064365386963
Epoch: 15, Steps: 17 | Train Loss: 0.902 Vali Loss: 3.023 Vali Acc: 0.289 Test Loss: 3.023 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.7674496173858643
Epoch: 16, Steps: 17 | Train Loss: 0.907 Vali Loss: 2.726 Vali Acc: 0.281 Test Loss: 2.726 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.8925728797912598
Epoch: 17, Steps: 17 | Train Loss: 0.720 Vali Loss: 2.511 Vali Acc: 0.327 Test Loss: 2.511 Test Acc: 0.327
Validation loss decreased (-0.326969 --> -0.326971).  Saving model ...
Epoch: 18 cost time: 3.5935564041137695
Epoch: 18, Steps: 17 | Train Loss: 0.971 Vali Loss: 2.168 Vali Acc: 0.327 Test Loss: 2.168 Test Acc: 0.327
Validation loss decreased (-0.326971 --> -0.326975).  Saving model ...
Epoch: 19 cost time: 3.029876232147217
Epoch: 19, Steps: 17 | Train Loss: 0.804 Vali Loss: 2.250 Vali Acc: 0.338 Test Loss: 2.250 Test Acc: 0.338
Validation loss decreased (-0.326975 --> -0.338381).  Saving model ...
Epoch: 20 cost time: 3.5417559146881104
Epoch: 20, Steps: 17 | Train Loss: 0.729 Vali Loss: 2.620 Vali Acc: 0.342 Test Loss: 2.620 Test Acc: 0.342
Validation loss decreased (-0.338381 --> -0.342179).  Saving model ...
Epoch: 21 cost time: 3.4801456928253174
Epoch: 21, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.249 Vali Acc: 0.319 Test Loss: 2.249 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.0678393840789795
Epoch: 22, Steps: 17 | Train Loss: 0.632 Vali Loss: 2.904 Vali Acc: 0.308 Test Loss: 2.904 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.089897394180298
Epoch: 23, Steps: 17 | Train Loss: 1.141 Vali Loss: 3.124 Vali Acc: 0.308 Test Loss: 3.124 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 4.533938884735107
Epoch: 24, Steps: 17 | Train Loss: 0.738 Vali Loss: 2.589 Vali Acc: 0.350 Test Loss: 2.589 Test Acc: 0.350
Validation loss decreased (-0.342179 --> -0.349784).  Saving model ...
Epoch: 25 cost time: 4.171926736831665
Epoch: 25, Steps: 17 | Train Loss: 0.577 Vali Loss: 2.880 Vali Acc: 0.300 Test Loss: 2.880 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.08373236656189
Epoch: 26, Steps: 17 | Train Loss: 0.467 Vali Loss: 2.847 Vali Acc: 0.331 Test Loss: 2.847 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.321751832962036
Epoch: 27, Steps: 17 | Train Loss: 0.698 Vali Loss: 3.210 Vali Acc: 0.304 Test Loss: 3.210 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.871694326400757
Epoch: 28, Steps: 17 | Train Loss: 0.736 Vali Loss: 2.875 Vali Acc: 0.319 Test Loss: 2.875 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 4.392625570297241
Epoch: 29, Steps: 17 | Train Loss: 0.484 Vali Loss: 2.989 Vali Acc: 0.354 Test Loss: 2.989 Test Acc: 0.354
Validation loss decreased (-0.349784 --> -0.353582).  Saving model ...
Epoch: 30 cost time: 4.075515270233154
Epoch: 30, Steps: 17 | Train Loss: 0.417 Vali Loss: 3.438 Vali Acc: 0.327 Test Loss: 3.438 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.2884650230407715
Epoch: 31, Steps: 17 | Train Loss: 0.461 Vali Loss: 4.032 Vali Acc: 0.312 Test Loss: 4.032 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.009728908538818
Epoch: 32, Steps: 17 | Train Loss: 0.480 Vali Loss: 3.775 Vali Acc: 0.354 Test Loss: 3.775 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 4.158510208129883
Epoch: 33, Steps: 17 | Train Loss: 0.409 Vali Loss: 4.741 Vali Acc: 0.308 Test Loss: 4.741 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 4.3653035163879395
Epoch: 34, Steps: 17 | Train Loss: 0.515 Vali Loss: 4.709 Vali Acc: 0.270 Test Loss: 4.709 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 4.2748472690582275
Epoch: 35, Steps: 17 | Train Loss: 0.508 Vali Loss: 4.683 Vali Acc: 0.369 Test Loss: 4.683 Test Acc: 0.369
Validation loss decreased (-0.353582 --> -0.368774).  Saving model ...
Epoch: 36 cost time: 4.521465063095093
Epoch: 36, Steps: 17 | Train Loss: 0.452 Vali Loss: 4.086 Vali Acc: 0.289 Test Loss: 4.086 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.9489970207214355
Epoch: 37, Steps: 17 | Train Loss: 0.437 Vali Loss: 3.832 Vali Acc: 0.319 Test Loss: 3.832 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 3.4951412677764893
Epoch: 38, Steps: 17 | Train Loss: 0.564 Vali Loss: 4.463 Vali Acc: 0.293 Test Loss: 4.463 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 4.1616432666778564
Epoch: 39, Steps: 17 | Train Loss: 0.394 Vali Loss: 5.915 Vali Acc: 0.293 Test Loss: 5.915 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 4.119838714599609
Epoch: 40, Steps: 17 | Train Loss: 0.460 Vali Loss: 4.932 Vali Acc: 0.308 Test Loss: 4.932 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 4.384690999984741
Epoch: 41, Steps: 17 | Train Loss: 0.414 Vali Loss: 5.876 Vali Acc: 0.293 Test Loss: 5.876 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 4.360951662063599
Epoch: 42, Steps: 17 | Train Loss: 0.686 Vali Loss: 4.452 Vali Acc: 0.262 Test Loss: 4.452 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 4.017825603485107
Epoch: 43, Steps: 17 | Train Loss: 0.973 Vali Loss: 4.173 Vali Acc: 0.281 Test Loss: 4.173 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 4.437788963317871
Epoch: 44, Steps: 17 | Train Loss: 0.608 Vali Loss: 4.802 Vali Acc: 0.316 Test Loss: 4.802 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 4.423083305358887
Epoch: 45, Steps: 17 | Train Loss: 0.623 Vali Loss: 5.169 Vali Acc: 0.297 Test Loss: 5.169 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3688212927756654
model parameter : 6069672
model size : 28.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.333693265914917
Epoch: 1, Steps: 17 | Train Loss: 1.556 Vali Loss: 2.251 Vali Acc: 0.259 Test Loss: 2.251 Test Acc: 0.259
Validation loss decreased (inf --> -0.258533).  Saving model ...
Epoch: 2 cost time: 2.739612340927124
Epoch: 2, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.914 Vali Acc: 0.247 Test Loss: 1.914 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.1814582347869873
Epoch: 3, Steps: 17 | Train Loss: 2.036 Vali Loss: 2.041 Vali Acc: 0.316 Test Loss: 2.041 Test Acc: 0.316
Validation loss decreased (-0.258533 --> -0.315569).  Saving model ...
Epoch: 4 cost time: 2.6067745685577393
Epoch: 4, Steps: 17 | Train Loss: 1.836 Vali Loss: 1.732 Vali Acc: 0.259 Test Loss: 1.732 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5003440380096436
Epoch: 5, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.517 Vali Acc: 0.274 Test Loss: 1.517 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.981825590133667
Epoch: 6, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.794 Vali Acc: 0.262 Test Loss: 1.794 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.623965263366699
Epoch: 7, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.722 Vali Acc: 0.285 Test Loss: 1.722 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.6218791007995605
Epoch: 8, Steps: 17 | Train Loss: 1.781 Vali Loss: 1.738 Vali Acc: 0.312 Test Loss: 1.738 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.786700487136841
Epoch: 9, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.716 Vali Acc: 0.274 Test Loss: 1.716 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.139465093612671
Epoch: 10, Steps: 17 | Train Loss: 1.220 Vali Loss: 2.109 Vali Acc: 0.285 Test Loss: 2.109 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.198256015777588
Epoch: 11, Steps: 17 | Train Loss: 1.186 Vali Loss: 2.053 Vali Acc: 0.281 Test Loss: 2.053 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 4.0340704917907715
Epoch: 12, Steps: 17 | Train Loss: 1.150 Vali Loss: 2.338 Vali Acc: 0.293 Test Loss: 2.338 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 4.165815114974976
Epoch: 13, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.947 Vali Acc: 0.316 Test Loss: 1.947 Test Acc: 0.316
Validation loss decreased (-0.315569 --> -0.315570).  Saving model ...
Epoch: 14 cost time: 3.684688091278076
Epoch: 14, Steps: 17 | Train Loss: 0.897 Vali Loss: 3.302 Vali Acc: 0.274 Test Loss: 3.302 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4058923721313477
Epoch: 15, Steps: 17 | Train Loss: 1.167 Vali Loss: 2.074 Vali Acc: 0.285 Test Loss: 2.074 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.99878191947937
Epoch: 16, Steps: 17 | Train Loss: 1.224 Vali Loss: 2.205 Vali Acc: 0.319 Test Loss: 2.205 Test Acc: 0.319
Validation loss decreased (-0.315570 --> -0.319370).  Saving model ...
Epoch: 17 cost time: 2.747439384460449
Epoch: 17, Steps: 17 | Train Loss: 1.003 Vali Loss: 2.457 Vali Acc: 0.293 Test Loss: 2.457 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.6792027950286865
Epoch: 18, Steps: 17 | Train Loss: 0.919 Vali Loss: 2.719 Vali Acc: 0.293 Test Loss: 2.719 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.897447347640991
Epoch: 19, Steps: 17 | Train Loss: 0.790 Vali Loss: 2.828 Vali Acc: 0.293 Test Loss: 2.828 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.706277847290039
Epoch: 20, Steps: 17 | Train Loss: 1.012 Vali Loss: 3.054 Vali Acc: 0.281 Test Loss: 3.054 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.338106632232666
Epoch: 21, Steps: 17 | Train Loss: 1.073 Vali Loss: 3.511 Vali Acc: 0.281 Test Loss: 3.511 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.9578001499176025
Epoch: 22, Steps: 17 | Train Loss: 0.961 Vali Loss: 2.554 Vali Acc: 0.293 Test Loss: 2.554 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.552940607070923
Epoch: 23, Steps: 17 | Train Loss: 0.608 Vali Loss: 2.980 Vali Acc: 0.335 Test Loss: 2.980 Test Acc: 0.335
Validation loss decreased (-0.319370 --> -0.334571).  Saving model ...
Epoch: 24 cost time: 3.685495615005493
Epoch: 24, Steps: 17 | Train Loss: 0.564 Vali Loss: 3.472 Vali Acc: 0.308 Test Loss: 3.472 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.3256638050079346
Epoch: 25, Steps: 17 | Train Loss: 0.700 Vali Loss: 3.154 Vali Acc: 0.297 Test Loss: 3.154 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.448059320449829
Epoch: 26, Steps: 17 | Train Loss: 0.789 Vali Loss: 2.783 Vali Acc: 0.300 Test Loss: 2.783 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.031179904937744
Epoch: 27, Steps: 17 | Train Loss: 0.506 Vali Loss: 2.950 Vali Acc: 0.316 Test Loss: 2.950 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.9001693725585938
Epoch: 28, Steps: 17 | Train Loss: 0.783 Vali Loss: 2.884 Vali Acc: 0.289 Test Loss: 2.884 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.538144826889038
Epoch: 29, Steps: 17 | Train Loss: 0.569 Vali Loss: 3.616 Vali Acc: 0.319 Test Loss: 3.616 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.946296453475952
Epoch: 30, Steps: 17 | Train Loss: 0.601 Vali Loss: 3.302 Vali Acc: 0.316 Test Loss: 3.302 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.223039627075195
Epoch: 31, Steps: 17 | Train Loss: 0.740 Vali Loss: 4.226 Vali Acc: 0.304 Test Loss: 4.226 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.788658857345581
Epoch: 32, Steps: 17 | Train Loss: 0.574 Vali Loss: 4.332 Vali Acc: 0.304 Test Loss: 4.332 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.9883995056152344
Epoch: 33, Steps: 17 | Train Loss: 0.515 Vali Loss: 4.079 Vali Acc: 0.354 Test Loss: 4.079 Test Acc: 0.354
Validation loss decreased (-0.334571 --> -0.353571).  Saving model ...
Epoch: 34 cost time: 2.9215683937072754
Epoch: 34, Steps: 17 | Train Loss: 0.434 Vali Loss: 4.894 Vali Acc: 0.285 Test Loss: 4.894 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.9607858657836914
Epoch: 35, Steps: 17 | Train Loss: 0.411 Vali Loss: 5.172 Vali Acc: 0.243 Test Loss: 5.172 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.875140428543091
Epoch: 36, Steps: 17 | Train Loss: 0.604 Vali Loss: 4.411 Vali Acc: 0.281 Test Loss: 4.411 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.1195123195648193
Epoch: 37, Steps: 17 | Train Loss: 0.434 Vali Loss: 3.992 Vali Acc: 0.293 Test Loss: 3.992 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.730870008468628
Epoch: 38, Steps: 17 | Train Loss: 0.674 Vali Loss: 3.654 Vali Acc: 0.323 Test Loss: 3.654 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.6823606491088867
Epoch: 39, Steps: 17 | Train Loss: 0.868 Vali Loss: 5.945 Vali Acc: 0.289 Test Loss: 5.945 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.7468490600585938
Epoch: 40, Steps: 17 | Train Loss: 0.473 Vali Loss: 4.889 Vali Acc: 0.274 Test Loss: 4.889 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.804821729660034
Epoch: 41, Steps: 17 | Train Loss: 0.317 Vali Loss: 4.446 Vali Acc: 0.293 Test Loss: 4.446 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.6290056705474854
Epoch: 42, Steps: 17 | Train Loss: 0.516 Vali Loss: 5.061 Vali Acc: 0.278 Test Loss: 5.061 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.290945529937744
Epoch: 43, Steps: 17 | Train Loss: 0.638 Vali Loss: 5.129 Vali Acc: 0.316 Test Loss: 5.129 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.35361216730038025
model parameter : 6013608
model size : 27.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.7436792850494385
Epoch: 1, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.436 Vali Acc: 0.270 Test Loss: 1.436 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 3.454838275909424
Epoch: 2, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.648 Vali Acc: 0.247 Test Loss: 1.648 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.484752893447876
Epoch: 3, Steps: 17 | Train Loss: 1.590 Vali Loss: 1.459 Vali Acc: 0.300 Test Loss: 1.459 Test Acc: 0.300
Validation loss decreased (-0.269948 --> -0.300366).  Saving model ...
Epoch: 4 cost time: 3.328073263168335
Epoch: 4, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.765 Vali Acc: 0.247 Test Loss: 1.765 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2311923503875732
Epoch: 5, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.681 Vali Acc: 0.262 Test Loss: 1.681 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.785114288330078
Epoch: 6, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.761 Vali Acc: 0.247 Test Loss: 1.761 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.2999749183654785
Epoch: 7, Steps: 17 | Train Loss: 1.571 Vali Loss: 2.196 Vali Acc: 0.236 Test Loss: 2.196 Test Acc: 0.236
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.8598527908325195
Epoch: 8, Steps: 17 | Train Loss: 1.674 Vali Loss: 2.904 Vali Acc: 0.251 Test Loss: 2.904 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.6587278842926025
Epoch: 9, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.691 Vali Acc: 0.262 Test Loss: 1.691 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.4967169761657715
Epoch: 10, Steps: 17 | Train Loss: 1.577 Vali Loss: 1.787 Vali Acc: 0.274 Test Loss: 1.787 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 4.544657468795776
Epoch: 11, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.635 Vali Acc: 0.297 Test Loss: 1.635 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 3.2994608879089355
Epoch: 12, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.910 Vali Acc: 0.319 Test Loss: 1.910 Test Acc: 0.319
Validation loss decreased (-0.300366 --> -0.319373).  Saving model ...
Epoch: 13 cost time: 2.2300374507904053
Epoch: 13, Steps: 17 | Train Loss: 1.060 Vali Loss: 2.321 Vali Acc: 0.270 Test Loss: 2.321 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.326340913772583
Epoch: 14, Steps: 17 | Train Loss: 1.185 Vali Loss: 2.015 Vali Acc: 0.300 Test Loss: 2.015 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6594209671020508
Epoch: 15, Steps: 17 | Train Loss: 1.239 Vali Loss: 2.041 Vali Acc: 0.293 Test Loss: 2.041 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.107401132583618
Epoch: 16, Steps: 17 | Train Loss: 0.989 Vali Loss: 1.937 Vali Acc: 0.297 Test Loss: 1.937 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.2926549911499023
Epoch: 17, Steps: 17 | Train Loss: 0.844 Vali Loss: 2.443 Vali Acc: 0.293 Test Loss: 2.443 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5592973232269287
Epoch: 18, Steps: 17 | Train Loss: 0.912 Vali Loss: 2.088 Vali Acc: 0.312 Test Loss: 2.088 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.256883144378662
Epoch: 19, Steps: 17 | Train Loss: 0.835 Vali Loss: 3.209 Vali Acc: 0.308 Test Loss: 3.209 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.2097654342651367
Epoch: 20, Steps: 17 | Train Loss: 1.082 Vali Loss: 2.244 Vali Acc: 0.293 Test Loss: 2.244 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.598536252975464
Epoch: 21, Steps: 17 | Train Loss: 0.938 Vali Loss: 2.872 Vali Acc: 0.373 Test Loss: 2.872 Test Acc: 0.373
Validation loss decreased (-0.319373 --> -0.372595).  Saving model ...
Epoch: 22 cost time: 3.4478864669799805
Epoch: 22, Steps: 17 | Train Loss: 0.957 Vali Loss: 2.188 Vali Acc: 0.308 Test Loss: 2.188 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.909639596939087
Epoch: 23, Steps: 17 | Train Loss: 0.722 Vali Loss: 2.372 Vali Acc: 0.373 Test Loss: 2.372 Test Acc: 0.373
Validation loss decreased (-0.372595 --> -0.372600).  Saving model ...
Epoch: 24 cost time: 3.492042064666748
Epoch: 24, Steps: 17 | Train Loss: 0.740 Vali Loss: 2.195 Vali Acc: 0.300 Test Loss: 2.195 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.0908188819885254
Epoch: 25, Steps: 17 | Train Loss: 0.549 Vali Loss: 2.088 Vali Acc: 0.338 Test Loss: 2.088 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.334282636642456
Epoch: 26, Steps: 17 | Train Loss: 0.632 Vali Loss: 3.318 Vali Acc: 0.293 Test Loss: 3.318 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.7263224124908447
Epoch: 27, Steps: 17 | Train Loss: 0.721 Vali Loss: 2.521 Vali Acc: 0.308 Test Loss: 2.521 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.2486579418182373
Epoch: 28, Steps: 17 | Train Loss: 0.655 Vali Loss: 2.865 Vali Acc: 0.335 Test Loss: 2.865 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.439323663711548
Epoch: 29, Steps: 17 | Train Loss: 0.620 Vali Loss: 3.149 Vali Acc: 0.335 Test Loss: 3.149 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.8469183444976807
Epoch: 30, Steps: 17 | Train Loss: 0.536 Vali Loss: 2.548 Vali Acc: 0.312 Test Loss: 2.548 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.382031202316284
Epoch: 31, Steps: 17 | Train Loss: 0.443 Vali Loss: 3.198 Vali Acc: 0.319 Test Loss: 3.198 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.7553343772888184
Epoch: 32, Steps: 17 | Train Loss: 0.466 Vali Loss: 3.061 Vali Acc: 0.327 Test Loss: 3.061 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.5307655334472656
Epoch: 33, Steps: 17 | Train Loss: 0.398 Vali Loss: 3.330 Vali Acc: 0.327 Test Loss: 3.330 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3726235741444867
model parameter : 2931880
model size : 13.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.632310390472412
Epoch: 1, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.488 Vali Acc: 0.247 Test Loss: 1.488 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 3.9015684127807617
Epoch: 2, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.599 Vali Acc: 0.274 Test Loss: 1.599 Test Acc: 0.274
Validation loss decreased (-0.247133 --> -0.273748).  Saving model ...
Epoch: 3 cost time: 4.732000827789307
Epoch: 3, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.624 Vali Acc: 0.255 Test Loss: 1.624 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.554164886474609
Epoch: 4, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.593 Vali Acc: 0.274 Test Loss: 1.593 Test Acc: 0.274
Validation loss decreased (-0.273748 --> -0.273748).  Saving model ...
Epoch: 5 cost time: 4.150212049484253
Epoch: 5, Steps: 17 | Train Loss: 1.744 Vali Loss: 1.682 Vali Acc: 0.240 Test Loss: 1.682 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.044246196746826
Epoch: 6, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.577 Vali Acc: 0.289 Test Loss: 1.577 Test Acc: 0.289
Validation loss decreased (-0.273748 --> -0.288958).  Saving model ...
Epoch: 7 cost time: 3.7291624546051025
Epoch: 7, Steps: 17 | Train Loss: 1.352 Vali Loss: 2.168 Vali Acc: 0.243 Test Loss: 2.168 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.774700164794922
Epoch: 8, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.590 Vali Acc: 0.327 Test Loss: 1.590 Test Acc: 0.327
Validation loss decreased (-0.288958 --> -0.326980).  Saving model ...
Epoch: 9 cost time: 3.5681238174438477
Epoch: 9, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.865 Vali Acc: 0.285 Test Loss: 1.865 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.217548370361328
Epoch: 10, Steps: 17 | Train Loss: 1.546 Vali Loss: 1.923 Vali Acc: 0.274 Test Loss: 1.923 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2038447856903076
Epoch: 11, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.822 Vali Acc: 0.289 Test Loss: 1.822 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2816247940063477
Epoch: 12, Steps: 17 | Train Loss: 1.168 Vali Loss: 2.296 Vali Acc: 0.281 Test Loss: 2.296 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.085953950881958
Epoch: 13, Steps: 17 | Train Loss: 1.556 Vali Loss: 2.072 Vali Acc: 0.274 Test Loss: 2.072 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.4467997550964355
Epoch: 14, Steps: 17 | Train Loss: 1.158 Vali Loss: 2.175 Vali Acc: 0.327 Test Loss: 2.175 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.9996654987335205
Epoch: 15, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.743 Vali Acc: 0.316 Test Loss: 1.743 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.4159605503082275
Epoch: 16, Steps: 17 | Train Loss: 0.914 Vali Loss: 2.145 Vali Acc: 0.289 Test Loss: 2.145 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.4753618240356445
Epoch: 17, Steps: 17 | Train Loss: 1.046 Vali Loss: 1.996 Vali Acc: 0.338 Test Loss: 1.996 Test Acc: 0.338
Validation loss decreased (-0.326980 --> -0.338383).  Saving model ...
Epoch: 18 cost time: 3.1594948768615723
Epoch: 18, Steps: 17 | Train Loss: 0.764 Vali Loss: 2.208 Vali Acc: 0.266 Test Loss: 2.208 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5152599811553955
Epoch: 19, Steps: 17 | Train Loss: 0.811 Vali Loss: 2.193 Vali Acc: 0.327 Test Loss: 2.193 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.6734812259674072
Epoch: 20, Steps: 17 | Train Loss: 0.709 Vali Loss: 2.088 Vali Acc: 0.384 Test Loss: 2.088 Test Acc: 0.384
Validation loss decreased (-0.338383 --> -0.384010).  Saving model ...
Epoch: 21 cost time: 3.4881532192230225
Epoch: 21, Steps: 17 | Train Loss: 0.723 Vali Loss: 2.336 Vali Acc: 0.335 Test Loss: 2.336 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.2076261043548584
Epoch: 22, Steps: 17 | Train Loss: 0.649 Vali Loss: 2.390 Vali Acc: 0.312 Test Loss: 2.390 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.0441014766693115
Epoch: 23, Steps: 17 | Train Loss: 0.760 Vali Loss: 2.487 Vali Acc: 0.308 Test Loss: 2.487 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.0764997005462646
Epoch: 24, Steps: 17 | Train Loss: 0.640 Vali Loss: 2.216 Vali Acc: 0.312 Test Loss: 2.216 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.248683214187622
Epoch: 25, Steps: 17 | Train Loss: 0.593 Vali Loss: 2.228 Vali Acc: 0.342 Test Loss: 2.228 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.7105143070220947
Epoch: 26, Steps: 17 | Train Loss: 0.425 Vali Loss: 2.407 Vali Acc: 0.308 Test Loss: 2.407 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.10174298286438
Epoch: 27, Steps: 17 | Train Loss: 0.378 Vali Loss: 2.909 Vali Acc: 0.278 Test Loss: 2.909 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.272222995758057
Epoch: 28, Steps: 17 | Train Loss: 0.592 Vali Loss: 3.039 Vali Acc: 0.354 Test Loss: 3.039 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.348065137863159
Epoch: 29, Steps: 17 | Train Loss: 0.517 Vali Loss: 2.661 Vali Acc: 0.361 Test Loss: 2.661 Test Acc: 0.361
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.295123815536499
Epoch: 30, Steps: 17 | Train Loss: 0.495 Vali Loss: 3.269 Vali Acc: 0.331 Test Loss: 3.269 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3840304182509506
model parameter : 2903848
model size : 13.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.541490316390991
Epoch: 1, Steps: 17 | Train Loss: 1.612 Vali Loss: 1.425 Vali Acc: 0.243 Test Loss: 1.425 Test Acc: 0.243
Validation loss decreased (inf --> -0.243332).  Saving model ...
Epoch: 2 cost time: 3.7186708450317383
Epoch: 2, Steps: 17 | Train Loss: 1.545 Vali Loss: 1.430 Vali Acc: 0.228 Test Loss: 1.430 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2119064331054688
Epoch: 3, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.860 Vali Acc: 0.262 Test Loss: 1.860 Test Acc: 0.262
Validation loss decreased (-0.243332 --> -0.262339).  Saving model ...
Epoch: 4 cost time: 3.0215117931365967
Epoch: 4, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.497 Vali Acc: 0.308 Test Loss: 1.497 Test Acc: 0.308
Validation loss decreased (-0.262339 --> -0.307970).  Saving model ...
Epoch: 5 cost time: 2.8600449562072754
Epoch: 5, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.826 Vali Acc: 0.274 Test Loss: 1.826 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.122555732727051
Epoch: 6, Steps: 17 | Train Loss: 1.554 Vali Loss: 1.732 Vali Acc: 0.266 Test Loss: 1.732 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.2624781131744385
Epoch: 7, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.781 Vali Acc: 0.262 Test Loss: 1.781 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.126112461090088
Epoch: 8, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.671 Vali Acc: 0.285 Test Loss: 1.671 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.9961109161376953
Epoch: 9, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.734 Vali Acc: 0.274 Test Loss: 1.734 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.997241497039795
Epoch: 10, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.979 Vali Acc: 0.293 Test Loss: 1.979 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.5418596267700195
Epoch: 11, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.771 Vali Acc: 0.297 Test Loss: 1.771 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.8315978050231934
Epoch: 12, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.711 Vali Acc: 0.350 Test Loss: 1.711 Test Acc: 0.350
Validation loss decreased (-0.307970 --> -0.349793).  Saving model ...
Epoch: 13 cost time: 4.187713146209717
Epoch: 13, Steps: 17 | Train Loss: 0.987 Vali Loss: 2.245 Vali Acc: 0.278 Test Loss: 2.245 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.030871629714966
Epoch: 14, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.765 Vali Acc: 0.316 Test Loss: 1.765 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.124238967895508
Epoch: 15, Steps: 17 | Train Loss: 0.829 Vali Loss: 1.996 Vali Acc: 0.350 Test Loss: 1.996 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.909453868865967
Epoch: 16, Steps: 17 | Train Loss: 1.028 Vali Loss: 2.261 Vali Acc: 0.342 Test Loss: 2.261 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.085433721542358
Epoch: 17, Steps: 17 | Train Loss: 0.791 Vali Loss: 2.200 Vali Acc: 0.369 Test Loss: 2.200 Test Acc: 0.369
Validation loss decreased (-0.349793 --> -0.368799).  Saving model ...
Epoch: 18 cost time: 3.9101998805999756
Epoch: 18, Steps: 17 | Train Loss: 0.709 Vali Loss: 1.844 Vali Acc: 0.335 Test Loss: 1.844 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.62082576751709
Epoch: 19, Steps: 17 | Train Loss: 0.605 Vali Loss: 2.281 Vali Acc: 0.354 Test Loss: 2.281 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.233835220336914
Epoch: 20, Steps: 17 | Train Loss: 0.567 Vali Loss: 2.159 Vali Acc: 0.342 Test Loss: 2.159 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.7951455116271973
Epoch: 21, Steps: 17 | Train Loss: 0.624 Vali Loss: 2.563 Vali Acc: 0.335 Test Loss: 2.563 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.94047212600708
Epoch: 22, Steps: 17 | Train Loss: 0.857 Vali Loss: 2.319 Vali Acc: 0.350 Test Loss: 2.319 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.80771803855896
Epoch: 23, Steps: 17 | Train Loss: 0.502 Vali Loss: 2.554 Vali Acc: 0.342 Test Loss: 2.554 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.88025164604187
Epoch: 24, Steps: 17 | Train Loss: 0.426 Vali Loss: 2.673 Vali Acc: 0.297 Test Loss: 2.673 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.5952486991882324
Epoch: 25, Steps: 17 | Train Loss: 0.543 Vali Loss: 2.793 Vali Acc: 0.327 Test Loss: 2.793 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.2530932426452637
Epoch: 26, Steps: 17 | Train Loss: 0.691 Vali Loss: 2.793 Vali Acc: 0.297 Test Loss: 2.793 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.3279924392700195
Epoch: 27, Steps: 17 | Train Loss: 0.405 Vali Loss: 3.288 Vali Acc: 0.312 Test Loss: 3.288 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3688212927756654
model parameter : 2875816
model size : 13.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.686046838760376
Epoch: 1, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.468 Vali Acc: 0.247 Test Loss: 1.468 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 4.1987690925598145
Epoch: 2, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.675 Vali Acc: 0.247 Test Loss: 1.675 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3133177757263184
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 2.190 Vali Acc: 0.251 Test Loss: 2.190 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250929).  Saving model ...
Epoch: 4 cost time: 2.957599401473999
Epoch: 4, Steps: 17 | Train Loss: 1.660 Vali Loss: 1.521 Vali Acc: 0.247 Test Loss: 1.521 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2242588996887207
Epoch: 5, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.716 Vali Acc: 0.266 Test Loss: 1.716 Test Acc: 0.266
Validation loss decreased (-0.250929 --> -0.266143).  Saving model ...
Epoch: 6 cost time: 2.863640785217285
Epoch: 6, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.548 Vali Acc: 0.240 Test Loss: 1.548 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2199997901916504
Epoch: 7, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.516 Vali Acc: 0.262 Test Loss: 1.516 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.599358558654785
Epoch: 8, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.853 Vali Acc: 0.293 Test Loss: 1.853 Test Acc: 0.293
Validation loss decreased (-0.266143 --> -0.292757).  Saving model ...
Epoch: 9 cost time: 2.695772886276245
Epoch: 9, Steps: 17 | Train Loss: 1.180 Vali Loss: 2.212 Vali Acc: 0.278 Test Loss: 2.212 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0577375888824463
Epoch: 10, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.893 Vali Acc: 0.255 Test Loss: 1.893 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7382454872131348
Epoch: 11, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.999 Vali Acc: 0.251 Test Loss: 1.999 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9184556007385254
Epoch: 12, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.845 Vali Acc: 0.297 Test Loss: 1.845 Test Acc: 0.297
Validation loss decreased (-0.292757 --> -0.296559).  Saving model ...
Epoch: 13 cost time: 2.7320640087127686
Epoch: 13, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.986 Vali Acc: 0.297 Test Loss: 1.986 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.578514337539673
Epoch: 14, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.735 Vali Acc: 0.323 Test Loss: 1.735 Test Acc: 0.323
Validation loss decreased (-0.296559 --> -0.323177).  Saving model ...
Epoch: 15 cost time: 3.732828378677368
Epoch: 15, Steps: 17 | Train Loss: 0.902 Vali Loss: 1.941 Vali Acc: 0.293 Test Loss: 1.941 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.997864007949829
Epoch: 16, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.863 Vali Acc: 0.323 Test Loss: 1.863 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.821099281311035
Epoch: 17, Steps: 17 | Train Loss: 0.815 Vali Loss: 2.228 Vali Acc: 0.300 Test Loss: 2.228 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.7808966636657715
Epoch: 18, Steps: 17 | Train Loss: 0.786 Vali Loss: 2.474 Vali Acc: 0.304 Test Loss: 2.474 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.795402765274048
Epoch: 19, Steps: 17 | Train Loss: 0.821 Vali Loss: 2.081 Vali Acc: 0.319 Test Loss: 2.081 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.8791873455047607
Epoch: 20, Steps: 17 | Train Loss: 0.638 Vali Loss: 2.968 Vali Acc: 0.289 Test Loss: 2.968 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.430739402770996
Epoch: 21, Steps: 17 | Train Loss: 0.677 Vali Loss: 2.331 Vali Acc: 0.316 Test Loss: 2.331 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.0250821113586426
Epoch: 22, Steps: 17 | Train Loss: 0.552 Vali Loss: 2.314 Vali Acc: 0.350 Test Loss: 2.314 Test Acc: 0.350
Validation loss decreased (-0.323177 --> -0.349787).  Saving model ...
Epoch: 23 cost time: 3.0253660678863525
Epoch: 23, Steps: 17 | Train Loss: 0.648 Vali Loss: 2.433 Vali Acc: 0.323 Test Loss: 2.433 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.873060941696167
Epoch: 24, Steps: 17 | Train Loss: 0.632 Vali Loss: 2.646 Vali Acc: 0.335 Test Loss: 2.646 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.4281182289123535
Epoch: 25, Steps: 17 | Train Loss: 0.504 Vali Loss: 2.444 Vali Acc: 0.346 Test Loss: 2.444 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.165200471878052
Epoch: 26, Steps: 17 | Train Loss: 0.491 Vali Loss: 2.828 Vali Acc: 0.335 Test Loss: 2.828 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.909168004989624
Epoch: 27, Steps: 17 | Train Loss: 0.444 Vali Loss: 2.860 Vali Acc: 0.308 Test Loss: 2.860 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.9891722202301025
Epoch: 28, Steps: 17 | Train Loss: 0.540 Vali Loss: 2.988 Vali Acc: 0.346 Test Loss: 2.988 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.491933584213257
Epoch: 29, Steps: 17 | Train Loss: 0.483 Vali Loss: 2.865 Vali Acc: 0.338 Test Loss: 2.865 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.0563366413116455
Epoch: 30, Steps: 17 | Train Loss: 0.375 Vali Loss: 2.961 Vali Acc: 0.365 Test Loss: 2.961 Test Acc: 0.365
Validation loss decreased (-0.349787 --> -0.364989).  Saving model ...
Epoch: 31 cost time: 2.825225591659546
Epoch: 31, Steps: 17 | Train Loss: 0.470 Vali Loss: 3.358 Vali Acc: 0.289 Test Loss: 3.358 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.924337387084961
Epoch: 32, Steps: 17 | Train Loss: 0.502 Vali Loss: 2.808 Vali Acc: 0.380 Test Loss: 2.808 Test Acc: 0.380
Validation loss decreased (-0.364989 --> -0.380200).  Saving model ...
Epoch: 33 cost time: 3.568617582321167
Epoch: 33, Steps: 17 | Train Loss: 0.376 Vali Loss: 3.654 Vali Acc: 0.281 Test Loss: 3.654 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.459594488143921
Epoch: 34, Steps: 17 | Train Loss: 0.302 Vali Loss: 3.414 Vali Acc: 0.361 Test Loss: 3.414 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.964041233062744
Epoch: 35, Steps: 17 | Train Loss: 0.380 Vali Loss: 2.772 Vali Acc: 0.335 Test Loss: 2.772 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 3.309178590774536
Epoch: 36, Steps: 17 | Train Loss: 0.343 Vali Loss: 3.552 Vali Acc: 0.361 Test Loss: 3.552 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.8458359241485596
Epoch: 37, Steps: 17 | Train Loss: 0.378 Vali Loss: 3.691 Vali Acc: 0.312 Test Loss: 3.691 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 3.183521270751953
Epoch: 38, Steps: 17 | Train Loss: 0.236 Vali Loss: 3.230 Vali Acc: 0.327 Test Loss: 3.230 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 3.1594552993774414
Epoch: 39, Steps: 17 | Train Loss: 0.291 Vali Loss: 3.479 Vali Acc: 0.319 Test Loss: 3.479 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.8732850551605225
Epoch: 40, Steps: 17 | Train Loss: 0.360 Vali Loss: 4.077 Vali Acc: 0.350 Test Loss: 4.077 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 3.743095636367798
Epoch: 41, Steps: 17 | Train Loss: 0.393 Vali Loss: 3.904 Vali Acc: 0.335 Test Loss: 3.904 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 3.24861216545105
Epoch: 42, Steps: 17 | Train Loss: 0.242 Vali Loss: 3.747 Vali Acc: 0.346 Test Loss: 3.747 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38022813688212925
model parameter : 2847784
model size : 13.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.080509185791016
Epoch: 1, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.537 Vali Acc: 0.259 Test Loss: 1.537 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 3.1769940853118896
Epoch: 2, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.737 Vali Acc: 0.247 Test Loss: 1.737 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.0327980518341064
Epoch: 3, Steps: 17 | Train Loss: 1.624 Vali Loss: 1.532 Vali Acc: 0.278 Test Loss: 1.532 Test Acc: 0.278
Validation loss decreased (-0.258540 --> -0.277551).  Saving model ...
Epoch: 4 cost time: 3.6124982833862305
Epoch: 4, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.562 Vali Acc: 0.262 Test Loss: 1.562 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.076416969299316
Epoch: 5, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.509 Vali Acc: 0.281 Test Loss: 1.509 Test Acc: 0.281
Validation loss decreased (-0.277551 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 4.060946464538574
Epoch: 6, Steps: 17 | Train Loss: 1.676 Vali Loss: 1.673 Vali Acc: 0.255 Test Loss: 1.673 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.4504945278167725
Epoch: 7, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.713 Vali Acc: 0.304 Test Loss: 1.713 Test Acc: 0.304
Validation loss decreased (-0.281354 --> -0.304165).  Saving model ...
Epoch: 8 cost time: 4.143588066101074
Epoch: 8, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.811 Vali Acc: 0.247 Test Loss: 1.811 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9162700176239014
Epoch: 9, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.864 Vali Acc: 0.274 Test Loss: 1.864 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.186441421508789
Epoch: 10, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.670 Vali Acc: 0.266 Test Loss: 1.670 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.4630799293518066
Epoch: 11, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.813 Vali Acc: 0.300 Test Loss: 1.813 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.084237813949585
Epoch: 12, Steps: 17 | Train Loss: 1.138 Vali Loss: 1.702 Vali Acc: 0.316 Test Loss: 1.702 Test Acc: 0.316
Validation loss decreased (-0.304165 --> -0.315572).  Saving model ...
Epoch: 13 cost time: 2.939527750015259
Epoch: 13, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.818 Vali Acc: 0.297 Test Loss: 1.818 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4634628295898438
Epoch: 14, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.979 Vali Acc: 0.278 Test Loss: 1.979 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.3590855598449707
Epoch: 15, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.907 Vali Acc: 0.312 Test Loss: 1.907 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.5012028217315674
Epoch: 16, Steps: 17 | Train Loss: 0.996 Vali Loss: 2.087 Vali Acc: 0.319 Test Loss: 2.087 Test Acc: 0.319
Validation loss decreased (-0.315572 --> -0.319371).  Saving model ...
Epoch: 17 cost time: 3.488844871520996
Epoch: 17, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.574 Vali Acc: 0.316 Test Loss: 2.574 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.704763174057007
Epoch: 18, Steps: 17 | Train Loss: 1.220 Vali Loss: 2.223 Vali Acc: 0.319 Test Loss: 2.223 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.9368982315063477
Epoch: 19, Steps: 17 | Train Loss: 1.142 Vali Loss: 2.529 Vali Acc: 0.289 Test Loss: 2.529 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.754934787750244
Epoch: 20, Steps: 17 | Train Loss: 1.051 Vali Loss: 2.175 Vali Acc: 0.346 Test Loss: 2.175 Test Acc: 0.346
Validation loss decreased (-0.319371 --> -0.345986).  Saving model ...
Epoch: 21 cost time: 2.7408719062805176
Epoch: 21, Steps: 17 | Train Loss: 0.887 Vali Loss: 2.461 Vali Acc: 0.350 Test Loss: 2.461 Test Acc: 0.350
Validation loss decreased (-0.345986 --> -0.349785).  Saving model ...
Epoch: 22 cost time: 2.5845251083374023
Epoch: 22, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.478 Vali Acc: 0.289 Test Loss: 2.478 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.3377685546875
Epoch: 23, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.236 Vali Acc: 0.281 Test Loss: 2.236 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.582152843475342
Epoch: 24, Steps: 17 | Train Loss: 0.767 Vali Loss: 2.688 Vali Acc: 0.335 Test Loss: 2.688 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.072038173675537
Epoch: 25, Steps: 17 | Train Loss: 0.933 Vali Loss: 3.112 Vali Acc: 0.338 Test Loss: 3.112 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.0447189807891846
Epoch: 26, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.985 Vali Acc: 0.297 Test Loss: 2.985 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.0278701782226562
Epoch: 27, Steps: 17 | Train Loss: 0.754 Vali Loss: 2.437 Vali Acc: 0.338 Test Loss: 2.437 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.11488676071167
Epoch: 28, Steps: 17 | Train Loss: 0.598 Vali Loss: 2.596 Vali Acc: 0.342 Test Loss: 2.596 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.3297953605651855
Epoch: 29, Steps: 17 | Train Loss: 0.603 Vali Loss: 2.498 Vali Acc: 0.350 Test Loss: 2.498 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.648315191268921
Epoch: 30, Steps: 17 | Train Loss: 0.402 Vali Loss: 3.037 Vali Acc: 0.316 Test Loss: 3.037 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.653258800506592
Epoch: 31, Steps: 17 | Train Loss: 0.445 Vali Loss: 2.996 Vali Acc: 0.293 Test Loss: 2.996 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34980988593155893
model parameter : 2273960
model size : 11.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.046673774719238
Epoch: 1, Steps: 17 | Train Loss: 1.524 Vali Loss: 1.600 Vali Acc: 0.224 Test Loss: 1.600 Test Acc: 0.224
Validation loss decreased (inf --> -0.224319).  Saving model ...
Epoch: 2 cost time: 3.852748394012451
Epoch: 2, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.467 Vali Acc: 0.266 Test Loss: 1.467 Test Acc: 0.266
Validation loss decreased (-0.224319 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 3.4656827449798584
Epoch: 3, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.993 Vali Acc: 0.262 Test Loss: 1.993 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.919389009475708
Epoch: 4, Steps: 17 | Train Loss: 1.890 Vali Loss: 2.093 Vali Acc: 0.259 Test Loss: 2.093 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5404181480407715
Epoch: 5, Steps: 17 | Train Loss: 1.552 Vali Loss: 1.705 Vali Acc: 0.281 Test Loss: 1.705 Test Acc: 0.281
Validation loss decreased (-0.266145 --> -0.281352).  Saving model ...
Epoch: 6 cost time: 2.3114662170410156
Epoch: 6, Steps: 17 | Train Loss: 1.531 Vali Loss: 2.573 Vali Acc: 0.251 Test Loss: 2.573 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.703886032104492
Epoch: 7, Steps: 17 | Train Loss: 2.044 Vali Loss: 1.855 Vali Acc: 0.270 Test Loss: 1.855 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6693038940429688
Epoch: 8, Steps: 17 | Train Loss: 1.516 Vali Loss: 1.662 Vali Acc: 0.312 Test Loss: 1.662 Test Acc: 0.312
Validation loss decreased (-0.281352 --> -0.311770).  Saving model ...
Epoch: 9 cost time: 3.3263163566589355
Epoch: 9, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.574 Vali Acc: 0.331 Test Loss: 1.574 Test Acc: 0.331
Validation loss decreased (-0.311770 --> -0.330783).  Saving model ...
Epoch: 10 cost time: 3.498350143432617
Epoch: 10, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.546 Vali Acc: 0.323 Test Loss: 1.546 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.321694850921631
Epoch: 11, Steps: 17 | Train Loss: 1.173 Vali Loss: 2.143 Vali Acc: 0.262 Test Loss: 2.143 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.225064992904663
Epoch: 12, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.632 Vali Acc: 0.308 Test Loss: 1.632 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.145458936691284
Epoch: 13, Steps: 17 | Train Loss: 1.116 Vali Loss: 2.156 Vali Acc: 0.300 Test Loss: 2.156 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.454138994216919
Epoch: 14, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.981 Vali Acc: 0.297 Test Loss: 1.981 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.470985174179077
Epoch: 15, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.854 Vali Acc: 0.312 Test Loss: 1.854 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.224964141845703
Epoch: 16, Steps: 17 | Train Loss: 0.815 Vali Loss: 2.098 Vali Acc: 0.308 Test Loss: 2.098 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.9080159664154053
Epoch: 17, Steps: 17 | Train Loss: 0.759 Vali Loss: 2.365 Vali Acc: 0.335 Test Loss: 2.365 Test Acc: 0.335
Validation loss decreased (-0.330783 --> -0.334577).  Saving model ...
Epoch: 18 cost time: 3.821178436279297
Epoch: 18, Steps: 17 | Train Loss: 0.807 Vali Loss: 2.443 Vali Acc: 0.281 Test Loss: 2.443 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.2942588329315186
Epoch: 19, Steps: 17 | Train Loss: 0.913 Vali Loss: 2.481 Vali Acc: 0.300 Test Loss: 2.481 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.951792001724243
Epoch: 20, Steps: 17 | Train Loss: 0.854 Vali Loss: 2.115 Vali Acc: 0.338 Test Loss: 2.115 Test Acc: 0.338
Validation loss decreased (-0.334577 --> -0.338382).  Saving model ...
Epoch: 21 cost time: 3.5531585216522217
Epoch: 21, Steps: 17 | Train Loss: 0.665 Vali Loss: 2.263 Vali Acc: 0.350 Test Loss: 2.263 Test Acc: 0.350
Validation loss decreased (-0.338382 --> -0.349787).  Saving model ...
Epoch: 22 cost time: 4.462498903274536
Epoch: 22, Steps: 17 | Train Loss: 0.574 Vali Loss: 2.306 Vali Acc: 0.331 Test Loss: 2.306 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.670938491821289
Epoch: 23, Steps: 17 | Train Loss: 0.525 Vali Loss: 2.494 Vali Acc: 0.335 Test Loss: 2.494 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.588388442993164
Epoch: 24, Steps: 17 | Train Loss: 0.527 Vali Loss: 2.408 Vali Acc: 0.319 Test Loss: 2.408 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.9374492168426514
Epoch: 25, Steps: 17 | Train Loss: 0.513 Vali Loss: 2.622 Vali Acc: 0.338 Test Loss: 2.622 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.167451858520508
Epoch: 26, Steps: 17 | Train Loss: 0.402 Vali Loss: 2.746 Vali Acc: 0.335 Test Loss: 2.746 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.413581609725952
Epoch: 27, Steps: 17 | Train Loss: 0.467 Vali Loss: 2.764 Vali Acc: 0.384 Test Loss: 2.764 Test Acc: 0.384
Validation loss decreased (-0.349787 --> -0.384003).  Saving model ...
Epoch: 28 cost time: 3.9218788146972656
Epoch: 28, Steps: 17 | Train Loss: 0.456 Vali Loss: 3.176 Vali Acc: 0.335 Test Loss: 3.176 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.746208667755127
Epoch: 29, Steps: 17 | Train Loss: 0.422 Vali Loss: 3.568 Vali Acc: 0.342 Test Loss: 3.568 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.439946413040161
Epoch: 30, Steps: 17 | Train Loss: 0.605 Vali Loss: 3.266 Vali Acc: 0.350 Test Loss: 3.266 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.5186266899108887
Epoch: 31, Steps: 17 | Train Loss: 0.298 Vali Loss: 3.085 Vali Acc: 0.361 Test Loss: 3.085 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.5214242935180664
Epoch: 32, Steps: 17 | Train Loss: 0.456 Vali Loss: 2.994 Vali Acc: 0.331 Test Loss: 2.994 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.1402697563171387
Epoch: 33, Steps: 17 | Train Loss: 0.488 Vali Loss: 3.081 Vali Acc: 0.323 Test Loss: 3.081 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.9619200229644775
Epoch: 34, Steps: 17 | Train Loss: 0.337 Vali Loss: 3.587 Vali Acc: 0.331 Test Loss: 3.587 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 2.5399181842803955
Epoch: 35, Steps: 17 | Train Loss: 0.248 Vali Loss: 3.430 Vali Acc: 0.354 Test Loss: 3.430 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 2.8860747814178467
Epoch: 36, Steps: 17 | Train Loss: 0.208 Vali Loss: 4.319 Vali Acc: 0.338 Test Loss: 4.319 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.015547275543213
Epoch: 37, Steps: 17 | Train Loss: 0.783 Vali Loss: 5.251 Vali Acc: 0.316 Test Loss: 5.251 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3840304182509506
model parameter : 2245928
model size : 11.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.3049476146698
Epoch: 1, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.416 Vali Acc: 0.285 Test Loss: 1.416 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 2.6614627838134766
Epoch: 2, Steps: 17 | Train Loss: 1.589 Vali Loss: 1.855 Vali Acc: 0.259 Test Loss: 1.855 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4876558780670166
Epoch: 3, Steps: 17 | Train Loss: 1.577 Vali Loss: 1.413 Vali Acc: 0.297 Test Loss: 1.413 Test Acc: 0.297
Validation loss decreased (-0.285157 --> -0.296564).  Saving model ...
Epoch: 4 cost time: 3.4649174213409424
Epoch: 4, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.514 Vali Acc: 0.255 Test Loss: 1.514 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.779400110244751
Epoch: 5, Steps: 17 | Train Loss: 1.745 Vali Loss: 2.159 Vali Acc: 0.262 Test Loss: 2.159 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.2839884757995605
Epoch: 6, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.549 Vali Acc: 0.278 Test Loss: 1.549 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.8536856174468994
Epoch: 7, Steps: 17 | Train Loss: 1.481 Vali Loss: 2.023 Vali Acc: 0.281 Test Loss: 2.023 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.846741199493408
Epoch: 8, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.565 Vali Acc: 0.331 Test Loss: 1.565 Test Acc: 0.331
Validation loss decreased (-0.296564 --> -0.330783).  Saving model ...
Epoch: 9 cost time: 2.9156994819641113
Epoch: 9, Steps: 17 | Train Loss: 1.332 Vali Loss: 1.912 Vali Acc: 0.274 Test Loss: 1.912 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0582869052886963
Epoch: 10, Steps: 17 | Train Loss: 1.185 Vali Loss: 2.371 Vali Acc: 0.251 Test Loss: 2.371 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.376821756362915
Epoch: 11, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.631 Vali Acc: 0.331 Test Loss: 1.631 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.265556812286377
Epoch: 12, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.792 Vali Acc: 0.297 Test Loss: 1.792 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.737858772277832
Epoch: 13, Steps: 17 | Train Loss: 0.993 Vali Loss: 1.823 Vali Acc: 0.285 Test Loss: 1.823 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.498994827270508
Epoch: 14, Steps: 17 | Train Loss: 1.031 Vali Loss: 1.938 Vali Acc: 0.316 Test Loss: 1.938 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.6758711338043213
Epoch: 15, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.735 Vali Acc: 0.281 Test Loss: 2.735 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.100464344024658
Epoch: 16, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.797 Vali Acc: 0.319 Test Loss: 1.797 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.434638977050781
Epoch: 17, Steps: 17 | Train Loss: 0.781 Vali Loss: 1.852 Vali Acc: 0.357 Test Loss: 1.852 Test Acc: 0.357
Validation loss decreased (-0.330783 --> -0.357396).  Saving model ...
Epoch: 18 cost time: 3.5753583908081055
Epoch: 18, Steps: 17 | Train Loss: 0.778 Vali Loss: 3.061 Vali Acc: 0.293 Test Loss: 3.061 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.5409576892852783
Epoch: 19, Steps: 17 | Train Loss: 0.775 Vali Loss: 2.029 Vali Acc: 0.342 Test Loss: 2.029 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.280825138092041
Epoch: 20, Steps: 17 | Train Loss: 0.622 Vali Loss: 2.744 Vali Acc: 0.319 Test Loss: 2.744 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.306610584259033
Epoch: 21, Steps: 17 | Train Loss: 0.846 Vali Loss: 2.442 Vali Acc: 0.312 Test Loss: 2.442 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.1757659912109375
Epoch: 22, Steps: 17 | Train Loss: 0.690 Vali Loss: 2.847 Vali Acc: 0.327 Test Loss: 2.847 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.4440975189208984
Epoch: 23, Steps: 17 | Train Loss: 0.806 Vali Loss: 2.257 Vali Acc: 0.300 Test Loss: 2.257 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.1703696250915527
Epoch: 24, Steps: 17 | Train Loss: 0.711 Vali Loss: 2.787 Vali Acc: 0.335 Test Loss: 2.787 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.3792524337768555
Epoch: 25, Steps: 17 | Train Loss: 0.637 Vali Loss: 2.577 Vali Acc: 0.354 Test Loss: 2.577 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.2049899101257324
Epoch: 26, Steps: 17 | Train Loss: 0.456 Vali Loss: 2.457 Vali Acc: 0.338 Test Loss: 2.457 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.9650654792785645
Epoch: 27, Steps: 17 | Train Loss: 0.572 Vali Loss: 2.731 Vali Acc: 0.338 Test Loss: 2.731 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3574144486692015
model parameter : 2217896
model size : 11.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.538849592208862
Epoch: 1, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.474 Vali Acc: 0.251 Test Loss: 1.474 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 2.05367374420166
Epoch: 2, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.987 Vali Acc: 0.255 Test Loss: 1.987 Test Acc: 0.255
Validation loss decreased (-0.250936 --> -0.254733).  Saving model ...
Epoch: 3 cost time: 2.9436659812927246
Epoch: 3, Steps: 17 | Train Loss: 1.735 Vali Loss: 1.475 Vali Acc: 0.259 Test Loss: 1.475 Test Acc: 0.259
Validation loss decreased (-0.254733 --> -0.258540).  Saving model ...
Epoch: 4 cost time: 3.567779064178467
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 2.049 Vali Acc: 0.251 Test Loss: 2.049 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5532209873199463
Epoch: 5, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.836 Vali Acc: 0.274 Test Loss: 1.836 Test Acc: 0.274
Validation loss decreased (-0.258540 --> -0.273746).  Saving model ...
Epoch: 6 cost time: 2.9171576499938965
Epoch: 6, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.725 Vali Acc: 0.262 Test Loss: 1.725 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.044780254364014
Epoch: 7, Steps: 17 | Train Loss: 1.634 Vali Loss: 2.134 Vali Acc: 0.240 Test Loss: 2.134 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2690062522888184
Epoch: 8, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.737 Vali Acc: 0.278 Test Loss: 1.737 Test Acc: 0.278
Validation loss decreased (-0.273746 --> -0.277549).  Saving model ...
Epoch: 9 cost time: 2.6521480083465576
Epoch: 9, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.900 Vali Acc: 0.285 Test Loss: 1.900 Test Acc: 0.285
Validation loss decreased (-0.277549 --> -0.285152).  Saving model ...
Epoch: 10 cost time: 2.9575376510620117
Epoch: 10, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.766 Vali Acc: 0.266 Test Loss: 1.766 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.455305337905884
Epoch: 11, Steps: 17 | Train Loss: 1.230 Vali Loss: 1.710 Vali Acc: 0.270 Test Loss: 1.710 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3301467895507812
Epoch: 12, Steps: 17 | Train Loss: 1.028 Vali Loss: 1.946 Vali Acc: 0.281 Test Loss: 1.946 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1301050186157227
Epoch: 13, Steps: 17 | Train Loss: 1.037 Vali Loss: 2.132 Vali Acc: 0.278 Test Loss: 2.132 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.860220193862915
Epoch: 14, Steps: 17 | Train Loss: 1.148 Vali Loss: 2.127 Vali Acc: 0.255 Test Loss: 2.127 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.6801860332489014
Epoch: 15, Steps: 17 | Train Loss: 0.998 Vali Loss: 2.058 Vali Acc: 0.300 Test Loss: 2.058 Test Acc: 0.300
Validation loss decreased (-0.285152 --> -0.300360).  Saving model ...
Epoch: 16 cost time: 3.7837860584259033
Epoch: 16, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.976 Vali Acc: 0.327 Test Loss: 1.976 Test Acc: 0.327
Validation loss decreased (-0.300360 --> -0.326976).  Saving model ...
Epoch: 17 cost time: 3.1968986988067627
Epoch: 17, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.982 Vali Acc: 0.319 Test Loss: 1.982 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2846274375915527
Epoch: 18, Steps: 17 | Train Loss: 0.934 Vali Loss: 2.333 Vali Acc: 0.319 Test Loss: 2.333 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.5268216133117676
Epoch: 19, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.036 Vali Acc: 0.338 Test Loss: 2.036 Test Acc: 0.338
Validation loss decreased (-0.326976 --> -0.338383).  Saving model ...
Epoch: 20 cost time: 3.115072727203369
Epoch: 20, Steps: 17 | Train Loss: 0.860 Vali Loss: 2.215 Vali Acc: 0.335 Test Loss: 2.215 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.973687171936035
Epoch: 21, Steps: 17 | Train Loss: 0.612 Vali Loss: 2.180 Vali Acc: 0.319 Test Loss: 2.180 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.492197275161743
Epoch: 22, Steps: 17 | Train Loss: 0.857 Vali Loss: 2.012 Vali Acc: 0.342 Test Loss: 2.012 Test Acc: 0.342
Validation loss decreased (-0.338383 --> -0.342185).  Saving model ...
Epoch: 23 cost time: 2.5813677310943604
Epoch: 23, Steps: 17 | Train Loss: 0.533 Vali Loss: 2.423 Vali Acc: 0.346 Test Loss: 2.423 Test Acc: 0.346
Validation loss decreased (-0.342185 --> -0.345983).  Saving model ...
Epoch: 24 cost time: 2.993220567703247
Epoch: 24, Steps: 17 | Train Loss: 0.802 Vali Loss: 2.546 Vali Acc: 0.316 Test Loss: 2.546 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4814717769622803
Epoch: 25, Steps: 17 | Train Loss: 0.710 Vali Loss: 2.974 Vali Acc: 0.388 Test Loss: 2.974 Test Acc: 0.388
Validation loss decreased (-0.345983 --> -0.387803).  Saving model ...
Epoch: 26 cost time: 3.0164241790771484
Epoch: 26, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.992 Vali Acc: 0.323 Test Loss: 1.992 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.602529764175415
Epoch: 27, Steps: 17 | Train Loss: 0.589 Vali Loss: 3.016 Vali Acc: 0.323 Test Loss: 3.016 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.7797129154205322
Epoch: 28, Steps: 17 | Train Loss: 0.715 Vali Loss: 3.152 Vali Acc: 0.323 Test Loss: 3.152 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.7565417289733887
Epoch: 29, Steps: 17 | Train Loss: 0.669 Vali Loss: 3.323 Vali Acc: 0.369 Test Loss: 3.323 Test Acc: 0.369
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.8462862968444824
Epoch: 30, Steps: 17 | Train Loss: 0.604 Vali Loss: 2.623 Vali Acc: 0.357 Test Loss: 2.623 Test Acc: 0.357
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.3477563858032227
Epoch: 31, Steps: 17 | Train Loss: 0.438 Vali Loss: 2.613 Vali Acc: 0.388 Test Loss: 2.613 Test Acc: 0.388
Validation loss decreased (-0.387803 --> -0.387807).  Saving model ...
Epoch: 32 cost time: 3.4851417541503906
Epoch: 32, Steps: 17 | Train Loss: 0.323 Vali Loss: 2.858 Vali Acc: 0.331 Test Loss: 2.858 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 3.86631441116333
Epoch: 33, Steps: 17 | Train Loss: 0.325 Vali Loss: 3.232 Vali Acc: 0.312 Test Loss: 3.232 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 3.675337314605713
Epoch: 34, Steps: 17 | Train Loss: 0.327 Vali Loss: 2.990 Vali Acc: 0.316 Test Loss: 2.990 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.735321283340454
Epoch: 35, Steps: 17 | Train Loss: 0.351 Vali Loss: 3.454 Vali Acc: 0.316 Test Loss: 3.454 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 4.091911792755127
Epoch: 36, Steps: 17 | Train Loss: 0.481 Vali Loss: 3.470 Vali Acc: 0.327 Test Loss: 3.470 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 4.132843255996704
Epoch: 37, Steps: 17 | Train Loss: 0.324 Vali Loss: 3.739 Vali Acc: 0.308 Test Loss: 3.739 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.7822704315185547
Epoch: 38, Steps: 17 | Train Loss: 0.353 Vali Loss: 3.285 Vali Acc: 0.342 Test Loss: 3.285 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.561711549758911
Epoch: 39, Steps: 17 | Train Loss: 0.178 Vali Loss: 4.107 Vali Acc: 0.323 Test Loss: 4.107 Test Acc: 0.323
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.994839668273926
Epoch: 40, Steps: 17 | Train Loss: 0.406 Vali Loss: 3.989 Vali Acc: 0.293 Test Loss: 3.989 Test Acc: 0.293
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.553157329559326
Epoch: 41, Steps: 17 | Train Loss: 0.229 Vali Loss: 4.386 Vali Acc: 0.293 Test Loss: 4.386 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38783269961977185
model parameter : 2189864
model size : 10.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.482489585876465
Epoch: 1, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.545 Vali Acc: 0.255 Test Loss: 1.545 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 3.4029624462127686
Epoch: 2, Steps: 17 | Train Loss: 1.492 Vali Loss: 2.016 Vali Acc: 0.247 Test Loss: 2.016 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4004147052764893
Epoch: 3, Steps: 17 | Train Loss: 1.718 Vali Loss: 1.809 Vali Acc: 0.255 Test Loss: 1.809 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.8268516063690186
Epoch: 4, Steps: 17 | Train Loss: 1.549 Vali Loss: 2.159 Vali Acc: 0.247 Test Loss: 2.159 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.0878467559814453
Epoch: 5, Steps: 17 | Train Loss: 1.863 Vali Loss: 1.915 Vali Acc: 0.247 Test Loss: 1.915 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.219700813293457
Epoch: 6, Steps: 17 | Train Loss: 1.674 Vali Loss: 1.585 Vali Acc: 0.285 Test Loss: 1.585 Test Acc: 0.285
Validation loss decreased (-0.254737 --> -0.285155).  Saving model ...
Epoch: 7 cost time: 3.6703410148620605
Epoch: 7, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.976 Vali Acc: 0.251 Test Loss: 1.976 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.861351251602173
Epoch: 8, Steps: 17 | Train Loss: 1.405 Vali Loss: 2.439 Vali Acc: 0.266 Test Loss: 2.439 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1894471645355225
Epoch: 9, Steps: 17 | Train Loss: 1.607 Vali Loss: 2.281 Vali Acc: 0.243 Test Loss: 2.281 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.1426618099212646
Epoch: 10, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.937 Vali Acc: 0.293 Test Loss: 1.937 Test Acc: 0.293
Validation loss decreased (-0.285155 --> -0.292756).  Saving model ...
Epoch: 11 cost time: 3.7407305240631104
Epoch: 11, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.932 Vali Acc: 0.297 Test Loss: 1.932 Test Acc: 0.297
Validation loss decreased (-0.292756 --> -0.296559).  Saving model ...
Epoch: 12 cost time: 3.210589647293091
Epoch: 12, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.871 Vali Acc: 0.289 Test Loss: 1.871 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7745566368103027
Epoch: 13, Steps: 17 | Train Loss: 1.014 Vali Loss: 1.830 Vali Acc: 0.297 Test Loss: 1.830 Test Acc: 0.297
Validation loss decreased (-0.296559 --> -0.296560).  Saving model ...
Epoch: 14 cost time: 2.8798372745513916
Epoch: 14, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.845 Vali Acc: 0.300 Test Loss: 1.845 Test Acc: 0.300
Validation loss decreased (-0.296560 --> -0.300362).  Saving model ...
Epoch: 15 cost time: 2.0116801261901855
Epoch: 15, Steps: 17 | Train Loss: 0.893 Vali Loss: 2.246 Vali Acc: 0.300 Test Loss: 2.246 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6166505813598633
Epoch: 16, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.851 Vali Acc: 0.331 Test Loss: 1.851 Test Acc: 0.331
Validation loss decreased (-0.300362 --> -0.330780).  Saving model ...
Epoch: 17 cost time: 3.503540277481079
Epoch: 17, Steps: 17 | Train Loss: 1.001 Vali Loss: 2.094 Vali Acc: 0.335 Test Loss: 2.094 Test Acc: 0.335
Validation loss decreased (-0.330780 --> -0.334580).  Saving model ...
Epoch: 18 cost time: 3.426196336746216
Epoch: 18, Steps: 17 | Train Loss: 0.831 Vali Loss: 2.464 Vali Acc: 0.304 Test Loss: 2.464 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.6892993450164795
Epoch: 19, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.988 Vali Acc: 0.312 Test Loss: 1.988 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.912497043609619
Epoch: 20, Steps: 17 | Train Loss: 0.684 Vali Loss: 2.730 Vali Acc: 0.319 Test Loss: 2.730 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.9501845836639404
Epoch: 21, Steps: 17 | Train Loss: 0.641 Vali Loss: 2.992 Vali Acc: 0.278 Test Loss: 2.992 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.5745010375976562
Epoch: 22, Steps: 17 | Train Loss: 0.728 Vali Loss: 2.580 Vali Acc: 0.327 Test Loss: 2.580 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.872457981109619
Epoch: 23, Steps: 17 | Train Loss: 0.577 Vali Loss: 2.268 Vali Acc: 0.338 Test Loss: 2.268 Test Acc: 0.338
Validation loss decreased (-0.334580 --> -0.338380).  Saving model ...
Epoch: 24 cost time: 3.6409010887145996
Epoch: 24, Steps: 17 | Train Loss: 0.517 Vali Loss: 2.818 Vali Acc: 0.338 Test Loss: 2.818 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6711390018463135
Epoch: 25, Steps: 17 | Train Loss: 0.908 Vali Loss: 2.336 Vali Acc: 0.369 Test Loss: 2.336 Test Acc: 0.369
Validation loss decreased (-0.338380 --> -0.368798).  Saving model ...
Epoch: 26 cost time: 3.4611446857452393
Epoch: 26, Steps: 17 | Train Loss: 0.486 Vali Loss: 2.911 Vali Acc: 0.308 Test Loss: 2.911 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.3640973567962646
Epoch: 27, Steps: 17 | Train Loss: 0.535 Vali Loss: 2.912 Vali Acc: 0.308 Test Loss: 2.912 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3027937412261963
Epoch: 28, Steps: 17 | Train Loss: 0.434 Vali Loss: 2.607 Vali Acc: 0.308 Test Loss: 2.607 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.6313295364379883
Epoch: 29, Steps: 17 | Train Loss: 0.464 Vali Loss: 3.502 Vali Acc: 0.331 Test Loss: 3.502 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.4743192195892334
Epoch: 30, Steps: 17 | Train Loss: 0.495 Vali Loss: 2.924 Vali Acc: 0.319 Test Loss: 2.924 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.007018566131592
Epoch: 31, Steps: 17 | Train Loss: 0.277 Vali Loss: 3.347 Vali Acc: 0.350 Test Loss: 3.347 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.3010222911834717
Epoch: 32, Steps: 17 | Train Loss: 0.313 Vali Loss: 3.333 Vali Acc: 0.361 Test Loss: 3.333 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.824911117553711
Epoch: 33, Steps: 17 | Train Loss: 0.364 Vali Loss: 3.454 Vali Acc: 0.319 Test Loss: 3.454 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.2851781845092773
Epoch: 34, Steps: 17 | Train Loss: 0.470 Vali Loss: 3.612 Vali Acc: 0.338 Test Loss: 3.612 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.9999892711639404
Epoch: 35, Steps: 17 | Train Loss: 0.408 Vali Loss: 3.033 Vali Acc: 0.323 Test Loss: 3.033 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3688212927756654
model parameter : 1945000
model size : 9.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.5911688804626465
Epoch: 1, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.561 Vali Acc: 0.270 Test Loss: 1.561 Test Acc: 0.270
Validation loss decreased (inf --> -0.269946).  Saving model ...
Epoch: 2 cost time: 3.716261148452759
Epoch: 2, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.751 Vali Acc: 0.247 Test Loss: 1.751 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.3775434494018555
Epoch: 3, Steps: 17 | Train Loss: 1.717 Vali Loss: 1.432 Vali Acc: 0.312 Test Loss: 1.432 Test Acc: 0.312
Validation loss decreased (-0.269946 --> -0.311773).  Saving model ...
Epoch: 4 cost time: 3.4905457496643066
Epoch: 4, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.489 Vali Acc: 0.274 Test Loss: 1.489 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9776251316070557
Epoch: 5, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.824 Vali Acc: 0.236 Test Loss: 1.824 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0773041248321533
Epoch: 6, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.793 Vali Acc: 0.293 Test Loss: 1.793 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.8104684352874756
Epoch: 7, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.498 Vali Acc: 0.270 Test Loss: 1.498 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.629978895187378
Epoch: 8, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.976 Vali Acc: 0.259 Test Loss: 1.976 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.6896908283233643
Epoch: 9, Steps: 17 | Train Loss: 1.975 Vali Loss: 2.134 Vali Acc: 0.270 Test Loss: 2.134 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.171637773513794
Epoch: 10, Steps: 17 | Train Loss: 1.276 Vali Loss: 2.085 Vali Acc: 0.270 Test Loss: 2.085 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.596714973449707
Epoch: 11, Steps: 17 | Train Loss: 1.180 Vali Loss: 2.390 Vali Acc: 0.259 Test Loss: 2.390 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.812915325164795
Epoch: 12, Steps: 17 | Train Loss: 1.469 Vali Loss: 2.366 Vali Acc: 0.274 Test Loss: 2.366 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 3.707134962081909
Epoch: 13, Steps: 17 | Train Loss: 1.249 Vali Loss: 2.020 Vali Acc: 0.247 Test Loss: 2.020 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 1916968
model size : 9.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.944798946380615
Epoch: 1, Steps: 17 | Train Loss: 1.544 Vali Loss: 1.533 Vali Acc: 0.255 Test Loss: 1.533 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 3.793236255645752
Epoch: 2, Steps: 17 | Train Loss: 1.530 Vali Loss: 1.432 Vali Acc: 0.278 Test Loss: 1.432 Test Acc: 0.278
Validation loss decreased (-0.254738 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 3.8643760681152344
Epoch: 3, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.706 Vali Acc: 0.297 Test Loss: 1.706 Test Acc: 0.297
Validation loss decreased (-0.277552 --> -0.296561).  Saving model ...
Epoch: 4 cost time: 3.750985622406006
Epoch: 4, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.869 Vali Acc: 0.259 Test Loss: 1.869 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.120416879653931
Epoch: 5, Steps: 17 | Train Loss: 1.673 Vali Loss: 2.051 Vali Acc: 0.270 Test Loss: 2.051 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3448355197906494
Epoch: 6, Steps: 17 | Train Loss: 1.513 Vali Loss: 2.371 Vali Acc: 0.251 Test Loss: 2.371 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.6251251697540283
Epoch: 7, Steps: 17 | Train Loss: 1.773 Vali Loss: 1.609 Vali Acc: 0.308 Test Loss: 1.609 Test Acc: 0.308
Validation loss decreased (-0.296561 --> -0.307969).  Saving model ...
Epoch: 8 cost time: 3.9841220378875732
Epoch: 8, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.766 Vali Acc: 0.262 Test Loss: 1.766 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.569908618927002
Epoch: 9, Steps: 17 | Train Loss: 1.311 Vali Loss: 1.582 Vali Acc: 0.297 Test Loss: 1.582 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.4598519802093506
Epoch: 10, Steps: 17 | Train Loss: 1.405 Vali Loss: 2.019 Vali Acc: 0.266 Test Loss: 2.019 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.840292453765869
Epoch: 11, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.657 Vali Acc: 0.319 Test Loss: 1.657 Test Acc: 0.319
Validation loss decreased (-0.307969 --> -0.319375).  Saving model ...
Epoch: 12 cost time: 3.4991509914398193
Epoch: 12, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.832 Vali Acc: 0.289 Test Loss: 1.832 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9863109588623047
Epoch: 13, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.926 Vali Acc: 0.289 Test Loss: 1.926 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.003915309906006
Epoch: 14, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.750 Vali Acc: 0.327 Test Loss: 1.750 Test Acc: 0.327
Validation loss decreased (-0.319375 --> -0.326979).  Saving model ...
Epoch: 15 cost time: 1.720200777053833
Epoch: 15, Steps: 17 | Train Loss: 1.051 Vali Loss: 2.383 Vali Acc: 0.247 Test Loss: 2.383 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6028270721435547
Epoch: 16, Steps: 17 | Train Loss: 0.893 Vali Loss: 2.071 Vali Acc: 0.323 Test Loss: 2.071 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.3973419666290283
Epoch: 17, Steps: 17 | Train Loss: 0.987 Vali Loss: 2.043 Vali Acc: 0.308 Test Loss: 2.043 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.048023223876953
Epoch: 18, Steps: 17 | Train Loss: 0.724 Vali Loss: 2.140 Vali Acc: 0.300 Test Loss: 2.140 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.7038357257843018
Epoch: 19, Steps: 17 | Train Loss: 0.808 Vali Loss: 2.244 Vali Acc: 0.319 Test Loss: 2.244 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.51311469078064
Epoch: 20, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.101 Vali Acc: 0.293 Test Loss: 2.101 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.076568841934204
Epoch: 21, Steps: 17 | Train Loss: 0.645 Vali Loss: 2.120 Vali Acc: 0.323 Test Loss: 2.120 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.114838123321533
Epoch: 22, Steps: 17 | Train Loss: 0.661 Vali Loss: 2.202 Vali Acc: 0.316 Test Loss: 2.202 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.306498765945435
Epoch: 23, Steps: 17 | Train Loss: 0.667 Vali Loss: 2.577 Vali Acc: 0.312 Test Loss: 2.577 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.5129480361938477
Epoch: 24, Steps: 17 | Train Loss: 0.561 Vali Loss: 2.305 Vali Acc: 0.357 Test Loss: 2.305 Test Acc: 0.357
Validation loss decreased (-0.326979 --> -0.357391).  Saving model ...
Epoch: 25 cost time: 3.766836404800415
Epoch: 25, Steps: 17 | Train Loss: 0.460 Vali Loss: 2.510 Vali Acc: 0.335 Test Loss: 2.510 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.3885488510131836
Epoch: 26, Steps: 17 | Train Loss: 0.522 Vali Loss: 2.737 Vali Acc: 0.323 Test Loss: 2.737 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.336869716644287
Epoch: 27, Steps: 17 | Train Loss: 0.506 Vali Loss: 2.657 Vali Acc: 0.365 Test Loss: 2.657 Test Acc: 0.365
Validation loss decreased (-0.357391 --> -0.364992).  Saving model ...
Epoch: 28 cost time: 3.0830531120300293
Epoch: 28, Steps: 17 | Train Loss: 0.535 Vali Loss: 3.305 Vali Acc: 0.346 Test Loss: 3.305 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.8665168285369873
Epoch: 29, Steps: 17 | Train Loss: 0.583 Vali Loss: 2.947 Vali Acc: 0.300 Test Loss: 2.947 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.701814889907837
Epoch: 30, Steps: 17 | Train Loss: 0.505 Vali Loss: 3.069 Vali Acc: 0.300 Test Loss: 3.069 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.7815048694610596
Epoch: 31, Steps: 17 | Train Loss: 0.459 Vali Loss: 3.398 Vali Acc: 0.319 Test Loss: 3.398 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.513138771057129
Epoch: 32, Steps: 17 | Train Loss: 0.482 Vali Loss: 3.007 Vali Acc: 0.304 Test Loss: 3.007 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.5287182331085205
Epoch: 33, Steps: 17 | Train Loss: 0.356 Vali Loss: 3.253 Vali Acc: 0.373 Test Loss: 3.253 Test Acc: 0.373
Validation loss decreased (-0.364992 --> -0.372591).  Saving model ...
Epoch: 34 cost time: 2.8464195728302
Epoch: 34, Steps: 17 | Train Loss: 0.273 Vali Loss: 3.301 Vali Acc: 0.335 Test Loss: 3.301 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.6023895740509033
Epoch: 35, Steps: 17 | Train Loss: 0.242 Vali Loss: 5.575 Vali Acc: 0.259 Test Loss: 5.575 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.1754894256591797
Epoch: 36, Steps: 17 | Train Loss: 0.513 Vali Loss: 3.693 Vali Acc: 0.350 Test Loss: 3.693 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.509671449661255
Epoch: 37, Steps: 17 | Train Loss: 0.346 Vali Loss: 3.556 Vali Acc: 0.319 Test Loss: 3.556 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 3.7769081592559814
Epoch: 38, Steps: 17 | Train Loss: 0.234 Vali Loss: 4.281 Vali Acc: 0.319 Test Loss: 4.281 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.8956401348114014
Epoch: 39, Steps: 17 | Train Loss: 0.312 Vali Loss: 3.774 Vali Acc: 0.300 Test Loss: 3.774 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.1505720615386963
Epoch: 40, Steps: 17 | Train Loss: 0.264 Vali Loss: 4.462 Vali Acc: 0.297 Test Loss: 4.462 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.6031250953674316
Epoch: 41, Steps: 17 | Train Loss: 0.453 Vali Loss: 4.131 Vali Acc: 0.346 Test Loss: 4.131 Test Acc: 0.346
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.1743905544281006
Epoch: 42, Steps: 17 | Train Loss: 0.295 Vali Loss: 4.057 Vali Acc: 0.331 Test Loss: 4.057 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.363799810409546
Epoch: 43, Steps: 17 | Train Loss: 0.188 Vali Loss: 4.420 Vali Acc: 0.285 Test Loss: 4.420 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3726235741444867
model parameter : 1888936
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 6.5913026332855225
Epoch: 1, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.582 Vali Acc: 0.262 Test Loss: 1.582 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 3.0143988132476807
Epoch: 2, Steps: 17 | Train Loss: 1.633 Vali Loss: 2.002 Vali Acc: 0.251 Test Loss: 2.002 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7945852279663086
Epoch: 3, Steps: 17 | Train Loss: 1.856 Vali Loss: 1.610 Vali Acc: 0.266 Test Loss: 1.610 Test Acc: 0.266
Validation loss decreased (-0.262342 --> -0.266144).  Saving model ...
Epoch: 4 cost time: 2.9741573333740234
Epoch: 4, Steps: 17 | Train Loss: 1.670 Vali Loss: 1.596 Vali Acc: 0.285 Test Loss: 1.596 Test Acc: 0.285
Validation loss decreased (-0.266144 --> -0.285155).  Saving model ...
Epoch: 5 cost time: 2.9424922466278076
Epoch: 5, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.642 Vali Acc: 0.243 Test Loss: 1.642 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8885905742645264
Epoch: 6, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.560 Vali Acc: 0.266 Test Loss: 1.560 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.1030032634735107
Epoch: 7, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.915 Vali Acc: 0.259 Test Loss: 1.915 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.1978790760040283
Epoch: 8, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.813 Vali Acc: 0.259 Test Loss: 1.813 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.986006498336792
Epoch: 9, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.527 Vali Acc: 0.281 Test Loss: 1.527 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.0511841773986816
Epoch: 10, Steps: 17 | Train Loss: 1.232 Vali Loss: 1.763 Vali Acc: 0.274 Test Loss: 1.763 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.060481309890747
Epoch: 11, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.861 Vali Acc: 0.285 Test Loss: 1.861 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.1338088512420654
Epoch: 12, Steps: 17 | Train Loss: 1.149 Vali Loss: 2.176 Vali Acc: 0.289 Test Loss: 2.176 Test Acc: 0.289
Validation loss decreased (-0.285155 --> -0.288952).  Saving model ...
Epoch: 13 cost time: 3.5715808868408203
Epoch: 13, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.739 Vali Acc: 0.297 Test Loss: 1.739 Test Acc: 0.297
Validation loss decreased (-0.288952 --> -0.296561).  Saving model ...
Epoch: 14 cost time: 3.6673519611358643
Epoch: 14, Steps: 17 | Train Loss: 1.053 Vali Loss: 2.030 Vali Acc: 0.278 Test Loss: 2.030 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.027655124664307
Epoch: 15, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.871 Vali Acc: 0.278 Test Loss: 1.871 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.160426139831543
Epoch: 16, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.908 Vali Acc: 0.312 Test Loss: 1.908 Test Acc: 0.312
Validation loss decreased (-0.296561 --> -0.311768).  Saving model ...
Epoch: 17 cost time: 3.200429916381836
Epoch: 17, Steps: 17 | Train Loss: 0.804 Vali Loss: 2.471 Vali Acc: 0.335 Test Loss: 2.471 Test Acc: 0.335
Validation loss decreased (-0.311768 --> -0.334576).  Saving model ...
Epoch: 18 cost time: 3.2904717922210693
Epoch: 18, Steps: 17 | Train Loss: 1.004 Vali Loss: 2.072 Vali Acc: 0.342 Test Loss: 2.072 Test Acc: 0.342
Validation loss decreased (-0.334576 --> -0.342185).  Saving model ...
Epoch: 19 cost time: 2.882516384124756
Epoch: 19, Steps: 17 | Train Loss: 0.803 Vali Loss: 2.649 Vali Acc: 0.281 Test Loss: 2.649 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9425642490386963
Epoch: 20, Steps: 17 | Train Loss: 0.722 Vali Loss: 2.183 Vali Acc: 0.335 Test Loss: 2.183 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.0660834312438965
Epoch: 21, Steps: 17 | Train Loss: 0.887 Vali Loss: 2.427 Vali Acc: 0.304 Test Loss: 2.427 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.162076234817505
Epoch: 22, Steps: 17 | Train Loss: 0.724 Vali Loss: 2.282 Vali Acc: 0.285 Test Loss: 2.282 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.92435884475708
Epoch: 23, Steps: 17 | Train Loss: 0.559 Vali Loss: 2.165 Vali Acc: 0.338 Test Loss: 2.165 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.6958608627319336
Epoch: 24, Steps: 17 | Train Loss: 0.516 Vali Loss: 2.517 Vali Acc: 0.342 Test Loss: 2.517 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.2121024131774902
Epoch: 25, Steps: 17 | Train Loss: 0.490 Vali Loss: 2.699 Vali Acc: 0.365 Test Loss: 2.699 Test Acc: 0.365
Validation loss decreased (-0.342185 --> -0.364992).  Saving model ...
Epoch: 26 cost time: 2.840052843093872
Epoch: 26, Steps: 17 | Train Loss: 0.803 Vali Loss: 2.376 Vali Acc: 0.335 Test Loss: 2.376 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.694237232208252
Epoch: 27, Steps: 17 | Train Loss: 0.566 Vali Loss: 2.408 Vali Acc: 0.357 Test Loss: 2.408 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.97352933883667
Epoch: 28, Steps: 17 | Train Loss: 0.414 Vali Loss: 2.913 Vali Acc: 0.357 Test Loss: 2.913 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.7686338424682617
Epoch: 29, Steps: 17 | Train Loss: 0.624 Vali Loss: 3.484 Vali Acc: 0.300 Test Loss: 3.484 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.2150156497955322
Epoch: 30, Steps: 17 | Train Loss: 0.416 Vali Loss: 3.053 Vali Acc: 0.350 Test Loss: 3.053 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.683051109313965
Epoch: 31, Steps: 17 | Train Loss: 0.349 Vali Loss: 3.016 Vali Acc: 0.304 Test Loss: 3.016 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.632404088973999
Epoch: 32, Steps: 17 | Train Loss: 0.395 Vali Loss: 2.926 Vali Acc: 0.323 Test Loss: 2.926 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.5295655727386475
Epoch: 33, Steps: 17 | Train Loss: 0.560 Vali Loss: 3.657 Vali Acc: 0.354 Test Loss: 3.657 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.616253137588501
Epoch: 34, Steps: 17 | Train Loss: 0.628 Vali Loss: 2.735 Vali Acc: 0.338 Test Loss: 2.735 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.2537271976470947
Epoch: 35, Steps: 17 | Train Loss: 0.311 Vali Loss: 4.047 Vali Acc: 0.338 Test Loss: 4.047 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3650190114068441
model parameter : 1860904
model size : 9.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.089164733886719
Epoch: 1, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.502 Vali Acc: 0.270 Test Loss: 1.502 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 3.7538907527923584
Epoch: 2, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.468 Vali Acc: 0.259 Test Loss: 1.468 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4138214588165283
Epoch: 3, Steps: 17 | Train Loss: 1.428 Vali Loss: 2.318 Vali Acc: 0.266 Test Loss: 2.318 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.5542824268341064
Epoch: 4, Steps: 17 | Train Loss: 1.714 Vali Loss: 1.636 Vali Acc: 0.278 Test Loss: 1.636 Test Acc: 0.278
Validation loss decreased (-0.269947 --> -0.277550).  Saving model ...
Epoch: 5 cost time: 3.212714195251465
Epoch: 5, Steps: 17 | Train Loss: 1.532 Vali Loss: 2.116 Vali Acc: 0.262 Test Loss: 2.116 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.2155871391296387
Epoch: 6, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.561 Vali Acc: 0.285 Test Loss: 1.561 Test Acc: 0.285
Validation loss decreased (-0.277550 --> -0.285155).  Saving model ...
Epoch: 7 cost time: 3.000457525253296
Epoch: 7, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.807 Vali Acc: 0.243 Test Loss: 1.807 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.3312623500823975
Epoch: 8, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.514 Vali Acc: 0.285 Test Loss: 1.514 Test Acc: 0.285
Validation loss decreased (-0.285155 --> -0.285156).  Saving model ...
Epoch: 9 cost time: 2.9606049060821533
Epoch: 9, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.589 Vali Acc: 0.259 Test Loss: 1.589 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3579955101013184
Epoch: 10, Steps: 17 | Train Loss: 1.296 Vali Loss: 2.074 Vali Acc: 0.278 Test Loss: 2.074 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.472695827484131
Epoch: 11, Steps: 17 | Train Loss: 1.321 Vali Loss: 2.157 Vali Acc: 0.266 Test Loss: 2.157 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1640467643737793
Epoch: 12, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.832 Vali Acc: 0.266 Test Loss: 1.832 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.0396194458007812
Epoch: 13, Steps: 17 | Train Loss: 1.111 Vali Loss: 2.550 Vali Acc: 0.278 Test Loss: 2.550 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1285018920898438
Epoch: 14, Steps: 17 | Train Loss: 1.240 Vali Loss: 2.045 Vali Acc: 0.262 Test Loss: 2.045 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.597968816757202
Epoch: 15, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.991 Vali Acc: 0.289 Test Loss: 1.991 Test Acc: 0.289
Validation loss decreased (-0.285156 --> -0.288953).  Saving model ...
Epoch: 16 cost time: 5.07245659828186
Epoch: 16, Steps: 17 | Train Loss: 0.937 Vali Loss: 2.019 Vali Acc: 0.342 Test Loss: 2.019 Test Acc: 0.342
Validation loss decreased (-0.288953 --> -0.342185).  Saving model ...
Epoch: 17 cost time: 3.3029041290283203
Epoch: 17, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.885 Vali Acc: 0.350 Test Loss: 1.885 Test Acc: 0.350
Validation loss decreased (-0.342185 --> -0.349791).  Saving model ...
Epoch: 18 cost time: 2.9834036827087402
Epoch: 18, Steps: 17 | Train Loss: 1.072 Vali Loss: 2.117 Vali Acc: 0.300 Test Loss: 2.117 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.321803092956543
Epoch: 19, Steps: 17 | Train Loss: 0.985 Vali Loss: 2.171 Vali Acc: 0.335 Test Loss: 2.171 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3513102531433105
Epoch: 20, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.906 Vali Acc: 0.323 Test Loss: 1.906 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.2697415351867676
Epoch: 21, Steps: 17 | Train Loss: 0.757 Vali Loss: 2.094 Vali Acc: 0.346 Test Loss: 2.094 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.2110466957092285
Epoch: 22, Steps: 17 | Train Loss: 0.624 Vali Loss: 2.011 Vali Acc: 0.335 Test Loss: 2.011 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.6466939449310303
Epoch: 23, Steps: 17 | Train Loss: 0.605 Vali Loss: 2.273 Vali Acc: 0.350 Test Loss: 2.273 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.0585551261901855
Epoch: 24, Steps: 17 | Train Loss: 0.577 Vali Loss: 2.367 Vali Acc: 0.354 Test Loss: 2.367 Test Acc: 0.354
Validation loss decreased (-0.349791 --> -0.353589).  Saving model ...
Epoch: 25 cost time: 3.004796266555786
Epoch: 25, Steps: 17 | Train Loss: 0.547 Vali Loss: 2.279 Vali Acc: 0.369 Test Loss: 2.279 Test Acc: 0.369
Validation loss decreased (-0.353589 --> -0.368799).  Saving model ...
Epoch: 26 cost time: 2.9653689861297607
Epoch: 26, Steps: 17 | Train Loss: 0.654 Vali Loss: 2.733 Vali Acc: 0.316 Test Loss: 2.733 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.0286335945129395
Epoch: 27, Steps: 17 | Train Loss: 0.616 Vali Loss: 2.717 Vali Acc: 0.331 Test Loss: 2.717 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3783693313598633
Epoch: 28, Steps: 17 | Train Loss: 0.493 Vali Loss: 2.751 Vali Acc: 0.373 Test Loss: 2.751 Test Acc: 0.373
Validation loss decreased (-0.368799 --> -0.372596).  Saving model ...
Epoch: 29 cost time: 3.345041513442993
Epoch: 29, Steps: 17 | Train Loss: 0.449 Vali Loss: 3.019 Vali Acc: 0.293 Test Loss: 3.019 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.844818353652954
Epoch: 30, Steps: 17 | Train Loss: 0.587 Vali Loss: 2.432 Vali Acc: 0.373 Test Loss: 2.432 Test Acc: 0.373
Validation loss decreased (-0.372596 --> -0.372599).  Saving model ...
Epoch: 31 cost time: 3.0744879245758057
Epoch: 31, Steps: 17 | Train Loss: 0.347 Vali Loss: 3.186 Vali Acc: 0.350 Test Loss: 3.186 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.294053077697754
Epoch: 32, Steps: 17 | Train Loss: 0.418 Vali Loss: 3.204 Vali Acc: 0.304 Test Loss: 3.204 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.8381059169769287
Epoch: 33, Steps: 17 | Train Loss: 0.343 Vali Loss: 3.214 Vali Acc: 0.395 Test Loss: 3.214 Test Acc: 0.395
Validation loss decreased (-0.372599 --> -0.395405).  Saving model ...
Epoch: 34 cost time: 2.2078378200531006
Epoch: 34, Steps: 17 | Train Loss: 0.462 Vali Loss: 3.950 Vali Acc: 0.357 Test Loss: 3.950 Test Acc: 0.357
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.307323694229126
Epoch: 35, Steps: 17 | Train Loss: 0.330 Vali Loss: 3.037 Vali Acc: 0.357 Test Loss: 3.037 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 3.041684627532959
Epoch: 36, Steps: 17 | Train Loss: 0.332 Vali Loss: 3.152 Vali Acc: 0.335 Test Loss: 3.152 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.1567656993865967
Epoch: 37, Steps: 17 | Train Loss: 0.303 Vali Loss: 3.442 Vali Acc: 0.342 Test Loss: 3.442 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.4505560398101807
Epoch: 38, Steps: 17 | Train Loss: 0.385 Vali Loss: 3.335 Vali Acc: 0.327 Test Loss: 3.335 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.438052177429199
Epoch: 39, Steps: 17 | Train Loss: 0.245 Vali Loss: 3.568 Vali Acc: 0.308 Test Loss: 3.568 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.5127904415130615
Epoch: 40, Steps: 17 | Train Loss: 0.199 Vali Loss: 3.419 Vali Acc: 0.376 Test Loss: 3.419 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.312746047973633
Epoch: 41, Steps: 17 | Train Loss: 0.201 Vali Loss: 3.664 Vali Acc: 0.338 Test Loss: 3.664 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.941188097000122
Epoch: 42, Steps: 17 | Train Loss: 0.106 Vali Loss: 3.998 Vali Acc: 0.388 Test Loss: 3.998 Test Acc: 0.388
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 3.3284223079681396
Epoch: 43, Steps: 17 | Train Loss: 0.146 Vali Loss: 4.048 Vali Acc: 0.354 Test Loss: 4.048 Test Acc: 0.354
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.39543726235741444
model parameter : 1780520
model size : 9.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.777843952178955
Epoch: 1, Steps: 17 | Train Loss: 1.639 Vali Loss: 1.441 Vali Acc: 0.281 Test Loss: 1.441 Test Acc: 0.281
Validation loss decreased (inf --> -0.281354).  Saving model ...
Epoch: 2 cost time: 3.7375707626342773
Epoch: 2, Steps: 17 | Train Loss: 1.635 Vali Loss: 1.665 Vali Acc: 0.255 Test Loss: 1.665 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2891643047332764
Epoch: 3, Steps: 17 | Train Loss: 1.792 Vali Loss: 1.637 Vali Acc: 0.262 Test Loss: 1.637 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.619126796722412
Epoch: 4, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.586 Vali Acc: 0.247 Test Loss: 1.586 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 3.8918240070343018
Epoch: 5, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.612 Vali Acc: 0.281 Test Loss: 1.612 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 3.636284351348877
Epoch: 6, Steps: 17 | Train Loss: 1.611 Vali Loss: 1.591 Vali Acc: 0.259 Test Loss: 1.591 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 3.0954651832580566
Epoch: 7, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.551 Vali Acc: 0.285 Test Loss: 1.551 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285156).  Saving model ...
Epoch: 8 cost time: 2.2854082584381104
Epoch: 8, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.794 Vali Acc: 0.278 Test Loss: 1.794 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6735050678253174
Epoch: 9, Steps: 17 | Train Loss: 1.499 Vali Loss: 2.140 Vali Acc: 0.255 Test Loss: 2.140 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8893909454345703
Epoch: 10, Steps: 17 | Train Loss: 1.606 Vali Loss: 2.085 Vali Acc: 0.300 Test Loss: 2.085 Test Acc: 0.300
Validation loss decreased (-0.285156 --> -0.300359).  Saving model ...
Epoch: 11 cost time: 3.1603450775146484
Epoch: 11, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.682 Vali Acc: 0.293 Test Loss: 1.682 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.1397271156311035
Epoch: 12, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.865 Vali Acc: 0.281 Test Loss: 1.865 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.316352128982544
Epoch: 13, Steps: 17 | Train Loss: 1.084 Vali Loss: 2.162 Vali Acc: 0.308 Test Loss: 2.162 Test Acc: 0.308
Validation loss decreased (-0.300359 --> -0.307963).  Saving model ...
Epoch: 14 cost time: 3.3799829483032227
Epoch: 14, Steps: 17 | Train Loss: 1.054 Vali Loss: 1.722 Vali Acc: 0.316 Test Loss: 1.722 Test Acc: 0.316
Validation loss decreased (-0.307963 --> -0.315572).  Saving model ...
Epoch: 15 cost time: 3.603931427001953
Epoch: 15, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.717 Vali Acc: 0.331 Test Loss: 1.717 Test Acc: 0.331
Validation loss decreased (-0.315572 --> -0.330781).  Saving model ...
Epoch: 16 cost time: 3.071053981781006
Epoch: 16, Steps: 17 | Train Loss: 0.951 Vali Loss: 2.115 Vali Acc: 0.335 Test Loss: 2.115 Test Acc: 0.335
Validation loss decreased (-0.330781 --> -0.334580).  Saving model ...
Epoch: 17 cost time: 3.8552193641662598
Epoch: 17, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.776 Vali Acc: 0.346 Test Loss: 1.776 Test Acc: 0.346
Validation loss decreased (-0.334580 --> -0.345990).  Saving model ...
Epoch: 18 cost time: 3.153367042541504
Epoch: 18, Steps: 17 | Train Loss: 0.916 Vali Loss: 2.036 Vali Acc: 0.323 Test Loss: 2.036 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.583611249923706
Epoch: 19, Steps: 17 | Train Loss: 0.837 Vali Loss: 2.058 Vali Acc: 0.335 Test Loss: 2.058 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.7584736347198486
Epoch: 20, Steps: 17 | Train Loss: 0.865 Vali Loss: 2.257 Vali Acc: 0.312 Test Loss: 2.257 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.15084171295166
Epoch: 21, Steps: 17 | Train Loss: 0.843 Vali Loss: 2.207 Vali Acc: 0.293 Test Loss: 2.207 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.358429193496704
Epoch: 22, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.003 Vali Acc: 0.350 Test Loss: 2.003 Test Acc: 0.350
Validation loss decreased (-0.345990 --> -0.349790).  Saving model ...
Epoch: 23 cost time: 3.83815860748291
Epoch: 23, Steps: 17 | Train Loss: 0.631 Vali Loss: 2.504 Vali Acc: 0.361 Test Loss: 2.504 Test Acc: 0.361
Validation loss decreased (-0.349790 --> -0.361192).  Saving model ...
Epoch: 24 cost time: 3.171093463897705
Epoch: 24, Steps: 17 | Train Loss: 0.920 Vali Loss: 2.355 Vali Acc: 0.342 Test Loss: 2.355 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.422318458557129
Epoch: 25, Steps: 17 | Train Loss: 0.573 Vali Loss: 2.035 Vali Acc: 0.323 Test Loss: 2.035 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.17282509803772
Epoch: 26, Steps: 17 | Train Loss: 0.471 Vali Loss: 2.568 Vali Acc: 0.323 Test Loss: 2.568 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.6776421070098877
Epoch: 27, Steps: 17 | Train Loss: 0.660 Vali Loss: 2.609 Vali Acc: 0.327 Test Loss: 2.609 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.281855583190918
Epoch: 28, Steps: 17 | Train Loss: 0.476 Vali Loss: 2.538 Vali Acc: 0.338 Test Loss: 2.538 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.2718915939331055
Epoch: 29, Steps: 17 | Train Loss: 0.456 Vali Loss: 2.807 Vali Acc: 0.361 Test Loss: 2.807 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.7531676292419434
Epoch: 30, Steps: 17 | Train Loss: 0.447 Vali Loss: 2.772 Vali Acc: 0.335 Test Loss: 2.772 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.783046007156372
Epoch: 31, Steps: 17 | Train Loss: 0.346 Vali Loss: 3.057 Vali Acc: 0.373 Test Loss: 3.057 Test Acc: 0.373
Validation loss decreased (-0.361192 --> -0.372593).  Saving model ...
Epoch: 32 cost time: 3.0262184143066406
Epoch: 32, Steps: 17 | Train Loss: 0.404 Vali Loss: 3.202 Vali Acc: 0.316 Test Loss: 3.202 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.5591490268707275
Epoch: 33, Steps: 17 | Train Loss: 0.420 Vali Loss: 3.011 Vali Acc: 0.331 Test Loss: 3.011 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.4181578159332275
Epoch: 34, Steps: 17 | Train Loss: 0.336 Vali Loss: 4.021 Vali Acc: 0.300 Test Loss: 4.021 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.1400628089904785
Epoch: 35, Steps: 17 | Train Loss: 0.629 Vali Loss: 3.146 Vali Acc: 0.331 Test Loss: 3.146 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.963857650756836
Epoch: 36, Steps: 17 | Train Loss: 0.547 Vali Loss: 3.234 Vali Acc: 0.346 Test Loss: 3.234 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.159858465194702
Epoch: 37, Steps: 17 | Train Loss: 0.331 Vali Loss: 3.689 Vali Acc: 0.304 Test Loss: 3.689 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.3353168964385986
Epoch: 38, Steps: 17 | Train Loss: 0.255 Vali Loss: 3.629 Vali Acc: 0.316 Test Loss: 3.629 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.8793511390686035
Epoch: 39, Steps: 17 | Train Loss: 0.275 Vali Loss: 3.683 Vali Acc: 0.346 Test Loss: 3.683 Test Acc: 0.346
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.888784170150757
Epoch: 40, Steps: 17 | Train Loss: 0.252 Vali Loss: 3.734 Vali Acc: 0.335 Test Loss: 3.734 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.8040456771850586
Epoch: 41, Steps: 17 | Train Loss: 0.246 Vali Loss: 3.684 Vali Acc: 0.327 Test Loss: 3.684 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3726235741444867
model parameter : 1752488
model size : 9.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.784440040588379
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.644 Vali Acc: 0.247 Test Loss: 1.644 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 2.7520434856414795
Epoch: 2, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.589 Vali Acc: 0.270 Test Loss: 1.589 Test Acc: 0.270
Validation loss decreased (-0.247132 --> -0.269946).  Saving model ...
Epoch: 3 cost time: 3.2468209266662598
Epoch: 3, Steps: 17 | Train Loss: 1.526 Vali Loss: 2.175 Vali Acc: 0.247 Test Loss: 2.175 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.416707992553711
Epoch: 4, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.568 Vali Acc: 0.285 Test Loss: 1.568 Test Acc: 0.285
Validation loss decreased (-0.269946 --> -0.285155).  Saving model ...
Epoch: 5 cost time: 2.803591251373291
Epoch: 5, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.786 Vali Acc: 0.274 Test Loss: 1.786 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8933587074279785
Epoch: 6, Steps: 17 | Train Loss: 1.768 Vali Loss: 1.737 Vali Acc: 0.262 Test Loss: 1.737 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.551506996154785
Epoch: 7, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.981 Vali Acc: 0.259 Test Loss: 1.981 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.165879011154175
Epoch: 8, Steps: 17 | Train Loss: 1.408 Vali Loss: 2.254 Vali Acc: 0.259 Test Loss: 2.254 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.370265960693359
Epoch: 9, Steps: 17 | Train Loss: 1.606 Vali Loss: 2.328 Vali Acc: 0.255 Test Loss: 2.328 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.5864391326904297
Epoch: 10, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.934 Vali Acc: 0.274 Test Loss: 1.934 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.147836446762085
Epoch: 11, Steps: 17 | Train Loss: 1.342 Vali Loss: 2.058 Vali Acc: 0.251 Test Loss: 2.058 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.7827672958374023
Epoch: 12, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.767 Vali Acc: 0.281 Test Loss: 1.767 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.899740695953369
Epoch: 13, Steps: 17 | Train Loss: 1.133 Vali Loss: 2.012 Vali Acc: 0.331 Test Loss: 2.012 Test Acc: 0.331
Validation loss decreased (-0.285155 --> -0.330778).  Saving model ...
Epoch: 14 cost time: 3.838117837905884
Epoch: 14, Steps: 17 | Train Loss: 1.109 Vali Loss: 2.201 Vali Acc: 0.262 Test Loss: 2.201 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.263750791549683
Epoch: 15, Steps: 17 | Train Loss: 1.066 Vali Loss: 1.964 Vali Acc: 0.304 Test Loss: 1.964 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.3619637489318848
Epoch: 16, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.845 Vali Acc: 0.316 Test Loss: 1.845 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.80127215385437
Epoch: 17, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.706 Vali Acc: 0.335 Test Loss: 1.706 Test Acc: 0.335
Validation loss decreased (-0.330778 --> -0.334584).  Saving model ...
Epoch: 18 cost time: 3.6610405445098877
Epoch: 18, Steps: 17 | Train Loss: 1.121 Vali Loss: 2.606 Vali Acc: 0.316 Test Loss: 2.606 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3089261054992676
Epoch: 19, Steps: 17 | Train Loss: 1.025 Vali Loss: 2.173 Vali Acc: 0.323 Test Loss: 2.173 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.372426748275757
Epoch: 20, Steps: 17 | Train Loss: 0.789 Vali Loss: 1.875 Vali Acc: 0.312 Test Loss: 1.875 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1336684226989746
Epoch: 21, Steps: 17 | Train Loss: 0.665 Vali Loss: 1.944 Vali Acc: 0.335 Test Loss: 1.944 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5090579986572266
Epoch: 22, Steps: 17 | Train Loss: 0.750 Vali Loss: 2.200 Vali Acc: 0.350 Test Loss: 2.200 Test Acc: 0.350
Validation loss decreased (-0.334584 --> -0.349788).  Saving model ...
Epoch: 23 cost time: 2.548104763031006
Epoch: 23, Steps: 17 | Train Loss: 0.760 Vali Loss: 2.466 Vali Acc: 0.331 Test Loss: 2.466 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9294507503509521
Epoch: 24, Steps: 17 | Train Loss: 0.637 Vali Loss: 2.062 Vali Acc: 0.308 Test Loss: 2.062 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.4554197788238525
Epoch: 25, Steps: 17 | Train Loss: 0.680 Vali Loss: 2.419 Vali Acc: 0.331 Test Loss: 2.419 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.974919557571411
Epoch: 26, Steps: 17 | Train Loss: 0.587 Vali Loss: 2.208 Vali Acc: 0.357 Test Loss: 2.208 Test Acc: 0.357
Validation loss decreased (-0.349788 --> -0.357392).  Saving model ...
Epoch: 27 cost time: 3.255486011505127
Epoch: 27, Steps: 17 | Train Loss: 0.573 Vali Loss: 2.269 Vali Acc: 0.327 Test Loss: 2.269 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 3.7151904106140137
Epoch: 28, Steps: 17 | Train Loss: 0.476 Vali Loss: 2.481 Vali Acc: 0.346 Test Loss: 2.481 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 3.209165573120117
Epoch: 29, Steps: 17 | Train Loss: 0.430 Vali Loss: 3.289 Vali Acc: 0.323 Test Loss: 3.289 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.3072288036346436
Epoch: 30, Steps: 17 | Train Loss: 0.658 Vali Loss: 3.034 Vali Acc: 0.369 Test Loss: 3.034 Test Acc: 0.369
Validation loss decreased (-0.357392 --> -0.368791).  Saving model ...
Epoch: 31 cost time: 2.888866662979126
Epoch: 31, Steps: 17 | Train Loss: 0.551 Vali Loss: 2.713 Vali Acc: 0.354 Test Loss: 2.713 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.654483079910278
Epoch: 32, Steps: 17 | Train Loss: 0.396 Vali Loss: 3.107 Vali Acc: 0.335 Test Loss: 3.107 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.9284849166870117
Epoch: 33, Steps: 17 | Train Loss: 0.356 Vali Loss: 2.602 Vali Acc: 0.384 Test Loss: 2.602 Test Acc: 0.384
Validation loss decreased (-0.368791 --> -0.384004).  Saving model ...
Epoch: 34 cost time: 3.574984550476074
Epoch: 34, Steps: 17 | Train Loss: 0.315 Vali Loss: 3.181 Vali Acc: 0.308 Test Loss: 3.181 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 3.8107595443725586
Epoch: 35, Steps: 17 | Train Loss: 0.385 Vali Loss: 3.279 Vali Acc: 0.354 Test Loss: 3.279 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.414658546447754
Epoch: 36, Steps: 17 | Train Loss: 0.361 Vali Loss: 2.822 Vali Acc: 0.338 Test Loss: 2.822 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 3.172492265701294
Epoch: 37, Steps: 17 | Train Loss: 0.194 Vali Loss: 3.411 Vali Acc: 0.338 Test Loss: 3.411 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.8621387481689453
Epoch: 38, Steps: 17 | Train Loss: 0.247 Vali Loss: 3.523 Vali Acc: 0.361 Test Loss: 3.523 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 3.2687551975250244
Epoch: 39, Steps: 17 | Train Loss: 0.296 Vali Loss: 3.095 Vali Acc: 0.380 Test Loss: 3.095 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 3.342397928237915
Epoch: 40, Steps: 17 | Train Loss: 0.339 Vali Loss: 4.033 Vali Acc: 0.342 Test Loss: 4.033 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 3.686645984649658
Epoch: 41, Steps: 17 | Train Loss: 0.385 Vali Loss: 3.106 Vali Acc: 0.392 Test Loss: 3.106 Test Acc: 0.392
Validation loss decreased (-0.384004 --> -0.391604).  Saving model ...
Epoch: 42 cost time: 3.399333953857422
Epoch: 42, Steps: 17 | Train Loss: 0.262 Vali Loss: 3.773 Vali Acc: 0.365 Test Loss: 3.773 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.2259066104888916
Epoch: 43, Steps: 17 | Train Loss: 0.352 Vali Loss: 4.484 Vali Acc: 0.278 Test Loss: 4.484 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 3.5907421112060547
Epoch: 44, Steps: 17 | Train Loss: 0.342 Vali Loss: 3.768 Vali Acc: 0.373 Test Loss: 3.768 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 3.442456007003784
Epoch: 45, Steps: 17 | Train Loss: 0.198 Vali Loss: 4.037 Vali Acc: 0.335 Test Loss: 4.037 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 3.202388286590576
Epoch: 46, Steps: 17 | Train Loss: 0.160 Vali Loss: 4.914 Vali Acc: 0.323 Test Loss: 4.914 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 3.5687077045440674
Epoch: 47, Steps: 17 | Train Loss: 0.307 Vali Loss: 4.447 Vali Acc: 0.342 Test Loss: 4.447 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 4.155417442321777
Epoch: 48, Steps: 17 | Train Loss: 0.366 Vali Loss: 4.409 Vali Acc: 0.354 Test Loss: 4.409 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 4.194747447967529
Epoch: 49, Steps: 17 | Train Loss: 0.316 Vali Loss: 3.912 Vali Acc: 0.346 Test Loss: 3.912 Test Acc: 0.346
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 3.3040976524353027
Epoch: 50, Steps: 17 | Train Loss: 0.111 Vali Loss: 4.263 Vali Acc: 0.354 Test Loss: 4.263 Test Acc: 0.354
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 3.1331841945648193
Epoch: 51, Steps: 17 | Train Loss: 0.162 Vali Loss: 4.953 Vali Acc: 0.319 Test Loss: 4.953 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3916349809885932
model parameter : 1724456
model size : 9.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.507883310317993
Epoch: 1, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.689 Vali Acc: 0.281 Test Loss: 1.689 Test Acc: 0.281
Validation loss decreased (inf --> -0.281352).  Saving model ...
Epoch: 2 cost time: 2.747642755508423
Epoch: 2, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.511 Vali Acc: 0.259 Test Loss: 1.511 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9987571239471436
Epoch: 3, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.495 Vali Acc: 0.293 Test Loss: 1.495 Test Acc: 0.293
Validation loss decreased (-0.281352 --> -0.292761).  Saving model ...
Epoch: 4 cost time: 3.047926425933838
Epoch: 4, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.449 Vali Acc: 0.285 Test Loss: 1.449 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.6698520183563232
Epoch: 5, Steps: 17 | Train Loss: 1.358 Vali Loss: 1.504 Vali Acc: 0.259 Test Loss: 1.504 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.221918821334839
Epoch: 6, Steps: 17 | Train Loss: 1.252 Vali Loss: 2.287 Vali Acc: 0.247 Test Loss: 2.287 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.166987895965576
Epoch: 7, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.792 Vali Acc: 0.281 Test Loss: 1.792 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.1269054412841797
Epoch: 8, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.672 Vali Acc: 0.251 Test Loss: 1.672 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.0804319381713867
Epoch: 9, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.705 Vali Acc: 0.285 Test Loss: 1.705 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 3.2386364936828613
Epoch: 10, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.666 Vali Acc: 0.289 Test Loss: 1.666 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.9632046222686768
Epoch: 11, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.756 Vali Acc: 0.270 Test Loss: 1.756 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.6279964447021484
Epoch: 12, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.802 Vali Acc: 0.281 Test Loss: 1.802 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.5100464820861816
Epoch: 13, Steps: 17 | Train Loss: 0.999 Vali Loss: 1.968 Vali Acc: 0.308 Test Loss: 1.968 Test Acc: 0.308
Validation loss decreased (-0.292761 --> -0.307965).  Saving model ...
Epoch: 14 cost time: 3.0338494777679443
Epoch: 14, Steps: 17 | Train Loss: 0.898 Vali Loss: 1.857 Vali Acc: 0.327 Test Loss: 1.857 Test Acc: 0.327
Validation loss decreased (-0.307965 --> -0.326978).  Saving model ...
Epoch: 15 cost time: 2.7768311500549316
Epoch: 15, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.940 Vali Acc: 0.297 Test Loss: 1.940 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0776195526123047
Epoch: 16, Steps: 17 | Train Loss: 0.911 Vali Loss: 2.060 Vali Acc: 0.316 Test Loss: 2.060 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.415257692337036
Epoch: 17, Steps: 17 | Train Loss: 0.840 Vali Loss: 1.890 Vali Acc: 0.308 Test Loss: 1.890 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.1519088745117188
Epoch: 18, Steps: 17 | Train Loss: 0.943 Vali Loss: 2.301 Vali Acc: 0.319 Test Loss: 2.301 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1012144088745117
Epoch: 19, Steps: 17 | Train Loss: 0.885 Vali Loss: 1.878 Vali Acc: 0.373 Test Loss: 1.878 Test Acc: 0.373
Validation loss decreased (-0.326978 --> -0.372605).  Saving model ...
Epoch: 20 cost time: 3.5317487716674805
Epoch: 20, Steps: 17 | Train Loss: 0.695 Vali Loss: 2.296 Vali Acc: 0.373 Test Loss: 2.296 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.15258526802063
Epoch: 21, Steps: 17 | Train Loss: 0.668 Vali Loss: 2.213 Vali Acc: 0.342 Test Loss: 2.213 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.870272397994995
Epoch: 22, Steps: 17 | Train Loss: 0.666 Vali Loss: 2.321 Vali Acc: 0.323 Test Loss: 2.321 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.4169113636016846
Epoch: 23, Steps: 17 | Train Loss: 0.714 Vali Loss: 2.109 Vali Acc: 0.350 Test Loss: 2.109 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.5137953758239746
Epoch: 24, Steps: 17 | Train Loss: 0.575 Vali Loss: 2.675 Vali Acc: 0.316 Test Loss: 2.675 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.31809401512146
Epoch: 25, Steps: 17 | Train Loss: 0.582 Vali Loss: 2.470 Vali Acc: 0.312 Test Loss: 2.470 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.006685256958008
Epoch: 26, Steps: 17 | Train Loss: 0.537 Vali Loss: 2.303 Vali Acc: 0.323 Test Loss: 2.303 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.1653213500976562
Epoch: 27, Steps: 17 | Train Loss: 0.481 Vali Loss: 2.706 Vali Acc: 0.331 Test Loss: 2.706 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.4685349464416504
Epoch: 28, Steps: 17 | Train Loss: 0.662 Vali Loss: 2.392 Vali Acc: 0.331 Test Loss: 2.392 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.5837743282318115
Epoch: 29, Steps: 17 | Train Loss: 0.497 Vali Loss: 3.097 Vali Acc: 0.319 Test Loss: 3.097 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3726235741444867
model parameter : 1696424
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.428003549575806
Epoch: 1, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.447 Vali Acc: 0.259 Test Loss: 1.447 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 3.7411792278289795
Epoch: 2, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.629 Vali Acc: 0.251 Test Loss: 1.629 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.4648654460906982
Epoch: 3, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.644 Vali Acc: 0.262 Test Loss: 1.644 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262341).  Saving model ...
Epoch: 4 cost time: 3.7105343341827393
Epoch: 4, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.570 Vali Acc: 0.255 Test Loss: 1.570 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.592369318008423
Epoch: 5, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.488 Vali Acc: 0.281 Test Loss: 1.488 Test Acc: 0.281
Validation loss decreased (-0.262341 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 2.9748075008392334
Epoch: 6, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.761 Vali Acc: 0.247 Test Loss: 1.761 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1328017711639404
Epoch: 7, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.636 Vali Acc: 0.255 Test Loss: 1.636 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2692980766296387
Epoch: 8, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.476 Vali Acc: 0.278 Test Loss: 1.476 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.272819757461548
Epoch: 9, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.734 Vali Acc: 0.259 Test Loss: 1.734 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.4568521976470947
Epoch: 10, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.647 Vali Acc: 0.262 Test Loss: 1.647 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.691896438598633
Epoch: 11, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.784 Vali Acc: 0.308 Test Loss: 1.784 Test Acc: 0.308
Validation loss decreased (-0.281354 --> -0.307967).  Saving model ...
Epoch: 12 cost time: 2.999958038330078
Epoch: 12, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.816 Vali Acc: 0.327 Test Loss: 1.816 Test Acc: 0.327
Validation loss decreased (-0.307967 --> -0.326978).  Saving model ...
Epoch: 13 cost time: 3.554931402206421
Epoch: 13, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.839 Vali Acc: 0.319 Test Loss: 1.839 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3967719078063965
Epoch: 14, Steps: 17 | Train Loss: 0.960 Vali Loss: 1.754 Vali Acc: 0.289 Test Loss: 1.754 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.780750274658203
Epoch: 15, Steps: 17 | Train Loss: 1.013 Vali Loss: 1.914 Vali Acc: 0.304 Test Loss: 1.914 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5448086261749268
Epoch: 16, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.728 Vali Acc: 0.365 Test Loss: 1.728 Test Acc: 0.365
Validation loss decreased (-0.326978 --> -0.365002).  Saving model ...
Epoch: 17 cost time: 2.8296656608581543
Epoch: 17, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.657 Vali Acc: 0.304 Test Loss: 1.657 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.104679822921753
Epoch: 18, Steps: 17 | Train Loss: 0.806 Vali Loss: 1.793 Vali Acc: 0.346 Test Loss: 1.793 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.449061632156372
Epoch: 19, Steps: 17 | Train Loss: 0.737 Vali Loss: 1.918 Vali Acc: 0.327 Test Loss: 1.918 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.8288588523864746
Epoch: 20, Steps: 17 | Train Loss: 0.708 Vali Loss: 1.913 Vali Acc: 0.323 Test Loss: 1.913 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.7529826164245605
Epoch: 21, Steps: 17 | Train Loss: 0.780 Vali Loss: 2.627 Vali Acc: 0.361 Test Loss: 2.627 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.773466110229492
Epoch: 22, Steps: 17 | Train Loss: 0.767 Vali Loss: 1.878 Vali Acc: 0.350 Test Loss: 1.878 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.9326934814453125
Epoch: 23, Steps: 17 | Train Loss: 0.580 Vali Loss: 2.087 Vali Acc: 0.312 Test Loss: 2.087 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.200972557067871
Epoch: 24, Steps: 17 | Train Loss: 0.689 Vali Loss: 2.319 Vali Acc: 0.327 Test Loss: 2.319 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.239570140838623
Epoch: 25, Steps: 17 | Train Loss: 0.608 Vali Loss: 2.433 Vali Acc: 0.335 Test Loss: 2.433 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.5056443214416504
Epoch: 26, Steps: 17 | Train Loss: 0.581 Vali Loss: 2.443 Vali Acc: 0.331 Test Loss: 2.443 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3650190114068441
model parameter : 1140840
model size : 5.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.3228747844696045
Epoch: 1, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.450 Vali Acc: 0.255 Test Loss: 1.450 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 4.160282850265503
Epoch: 2, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.516 Vali Acc: 0.236 Test Loss: 1.516 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8144948482513428
Epoch: 3, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.547 Vali Acc: 0.262 Test Loss: 1.547 Test Acc: 0.262
Validation loss decreased (-0.254738 --> -0.262342).  Saving model ...
Epoch: 4 cost time: 2.971360683441162
Epoch: 4, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.521 Vali Acc: 0.270 Test Loss: 1.521 Test Acc: 0.270
Validation loss decreased (-0.262342 --> -0.269947).  Saving model ...
Epoch: 5 cost time: 2.7643978595733643
Epoch: 5, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.474 Vali Acc: 0.304 Test Loss: 1.474 Test Acc: 0.304
Validation loss decreased (-0.269947 --> -0.304168).  Saving model ...
Epoch: 6 cost time: 2.5105817317962646
Epoch: 6, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.649 Vali Acc: 0.266 Test Loss: 1.649 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3664376735687256
Epoch: 7, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.611 Vali Acc: 0.316 Test Loss: 1.611 Test Acc: 0.316
Validation loss decreased (-0.304168 --> -0.315573).  Saving model ...
Epoch: 8 cost time: 3.2564473152160645
Epoch: 8, Steps: 17 | Train Loss: 1.313 Vali Loss: 1.628 Vali Acc: 0.297 Test Loss: 1.628 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.634009122848511
Epoch: 9, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.858 Vali Acc: 0.251 Test Loss: 1.858 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.3836872577667236
Epoch: 10, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.497 Vali Acc: 0.281 Test Loss: 1.497 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.5962860584259033
Epoch: 11, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.656 Vali Acc: 0.278 Test Loss: 1.656 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.082042694091797
Epoch: 12, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.568 Vali Acc: 0.281 Test Loss: 1.568 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.810659885406494
Epoch: 13, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.971 Vali Acc: 0.270 Test Loss: 1.971 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.170517444610596
Epoch: 14, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.746 Vali Acc: 0.274 Test Loss: 1.746 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.5255773067474365
Epoch: 15, Steps: 17 | Train Loss: 0.937 Vali Loss: 1.715 Vali Acc: 0.293 Test Loss: 1.715 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.750983953475952
Epoch: 16, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.977 Vali Acc: 0.323 Test Loss: 1.977 Test Acc: 0.323
Validation loss decreased (-0.315573 --> -0.323174).  Saving model ...
Epoch: 17 cost time: 3.3733484745025635
Epoch: 17, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.730 Vali Acc: 0.316 Test Loss: 1.730 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.543978452682495
Epoch: 18, Steps: 17 | Train Loss: 0.979 Vali Loss: 1.826 Vali Acc: 0.327 Test Loss: 1.826 Test Acc: 0.327
Validation loss decreased (-0.323174 --> -0.326978).  Saving model ...
Epoch: 19 cost time: 2.8109192848205566
Epoch: 19, Steps: 17 | Train Loss: 0.898 Vali Loss: 2.006 Vali Acc: 0.316 Test Loss: 2.006 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0331614017486572
Epoch: 20, Steps: 17 | Train Loss: 0.808 Vali Loss: 1.743 Vali Acc: 0.354 Test Loss: 1.743 Test Acc: 0.354
Validation loss decreased (-0.326978 --> -0.353595).  Saving model ...
Epoch: 21 cost time: 3.1488397121429443
Epoch: 21, Steps: 17 | Train Loss: 0.810 Vali Loss: 1.888 Vali Acc: 0.350 Test Loss: 1.888 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5635335445404053
Epoch: 22, Steps: 17 | Train Loss: 0.654 Vali Loss: 2.706 Vali Acc: 0.285 Test Loss: 2.706 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.555898904800415
Epoch: 23, Steps: 17 | Train Loss: 0.849 Vali Loss: 2.351 Vali Acc: 0.319 Test Loss: 2.351 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4610774517059326
Epoch: 24, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.089 Vali Acc: 0.327 Test Loss: 2.089 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.343398332595825
Epoch: 25, Steps: 17 | Train Loss: 0.654 Vali Loss: 2.048 Vali Acc: 0.365 Test Loss: 2.048 Test Acc: 0.365
Validation loss decreased (-0.353595 --> -0.364999).  Saving model ...
Epoch: 26 cost time: 2.2065799236297607
Epoch: 26, Steps: 17 | Train Loss: 0.576 Vali Loss: 2.206 Vali Acc: 0.335 Test Loss: 2.206 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.4655532836914062
Epoch: 27, Steps: 17 | Train Loss: 0.540 Vali Loss: 2.164 Vali Acc: 0.380 Test Loss: 2.164 Test Acc: 0.380
Validation loss decreased (-0.364999 --> -0.380206).  Saving model ...
Epoch: 28 cost time: 3.1703648567199707
Epoch: 28, Steps: 17 | Train Loss: 0.620 Vali Loss: 2.322 Vali Acc: 0.369 Test Loss: 2.322 Test Acc: 0.369
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.677638530731201
Epoch: 29, Steps: 17 | Train Loss: 0.659 Vali Loss: 2.452 Vali Acc: 0.293 Test Loss: 2.452 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.3385605812072754
Epoch: 30, Steps: 17 | Train Loss: 0.451 Vali Loss: 2.251 Vali Acc: 0.342 Test Loss: 2.251 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.969137668609619
Epoch: 31, Steps: 17 | Train Loss: 0.475 Vali Loss: 2.579 Vali Acc: 0.335 Test Loss: 2.579 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.896973133087158
Epoch: 32, Steps: 17 | Train Loss: 0.436 Vali Loss: 2.431 Vali Acc: 0.323 Test Loss: 2.431 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.761943817138672
Epoch: 33, Steps: 17 | Train Loss: 0.361 Vali Loss: 2.615 Vali Acc: 0.331 Test Loss: 2.615 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.547229290008545
Epoch: 34, Steps: 17 | Train Loss: 0.616 Vali Loss: 2.417 Vali Acc: 0.407 Test Loss: 2.417 Test Acc: 0.407
Validation loss decreased (-0.380206 --> -0.406820).  Saving model ...
Epoch: 35 cost time: 3.670713424682617
Epoch: 35, Steps: 17 | Train Loss: 0.446 Vali Loss: 3.066 Vali Acc: 0.316 Test Loss: 3.066 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.3498456478118896
Epoch: 36, Steps: 17 | Train Loss: 0.409 Vali Loss: 2.747 Vali Acc: 0.350 Test Loss: 2.747 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 3.4674365520477295
Epoch: 37, Steps: 17 | Train Loss: 0.258 Vali Loss: 3.077 Vali Acc: 0.357 Test Loss: 3.077 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.19950270652771
Epoch: 38, Steps: 17 | Train Loss: 0.241 Vali Loss: 2.938 Vali Acc: 0.365 Test Loss: 2.938 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.758636236190796
Epoch: 39, Steps: 17 | Train Loss: 0.251 Vali Loss: 2.943 Vali Acc: 0.380 Test Loss: 2.943 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.603492259979248
Epoch: 40, Steps: 17 | Train Loss: 0.231 Vali Loss: 3.424 Vali Acc: 0.365 Test Loss: 3.424 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 3.632188081741333
Epoch: 41, Steps: 17 | Train Loss: 0.271 Vali Loss: 3.543 Vali Acc: 0.342 Test Loss: 3.543 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 3.4436442852020264
Epoch: 42, Steps: 17 | Train Loss: 0.266 Vali Loss: 4.040 Vali Acc: 0.331 Test Loss: 4.040 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 3.0870535373687744
Epoch: 43, Steps: 17 | Train Loss: 0.241 Vali Loss: 3.352 Vali Acc: 0.354 Test Loss: 3.352 Test Acc: 0.354
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 3.0262374877929688
Epoch: 44, Steps: 17 | Train Loss: 0.162 Vali Loss: 3.560 Vali Acc: 0.357 Test Loss: 3.560 Test Acc: 0.357
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4068441064638783
model parameter : 1126824
model size : 5.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.902830600738525
Epoch: 1, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.425 Vali Acc: 0.240 Test Loss: 1.425 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 2.7238311767578125
Epoch: 2, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.447 Vali Acc: 0.262 Test Loss: 1.447 Test Acc: 0.262
Validation loss decreased (-0.239529 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 2.884608030319214
Epoch: 3, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.569 Vali Acc: 0.262 Test Loss: 1.569 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.111506700515747
Epoch: 4, Steps: 17 | Train Loss: 1.543 Vali Loss: 1.590 Vali Acc: 0.266 Test Loss: 1.590 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266144).  Saving model ...
Epoch: 5 cost time: 2.7912161350250244
Epoch: 5, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.508 Vali Acc: 0.255 Test Loss: 1.508 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3582513332366943
Epoch: 6, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.732 Vali Acc: 0.259 Test Loss: 1.732 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.190587282180786
Epoch: 7, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.588 Vali Acc: 0.304 Test Loss: 1.588 Test Acc: 0.304
Validation loss decreased (-0.266144 --> -0.304167).  Saving model ...
Epoch: 8 cost time: 2.1643528938293457
Epoch: 8, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.730 Vali Acc: 0.247 Test Loss: 1.730 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.891875982284546
Epoch: 9, Steps: 17 | Train Loss: 1.296 Vali Loss: 1.688 Vali Acc: 0.266 Test Loss: 1.688 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.0778307914733887
Epoch: 10, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.690 Vali Acc: 0.274 Test Loss: 1.690 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.45900297164917
Epoch: 11, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.568 Vali Acc: 0.308 Test Loss: 1.568 Test Acc: 0.308
Validation loss decreased (-0.304167 --> -0.307969).  Saving model ...
Epoch: 12 cost time: 2.8823368549346924
Epoch: 12, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.848 Vali Acc: 0.278 Test Loss: 1.848 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2108397483825684
Epoch: 13, Steps: 17 | Train Loss: 1.165 Vali Loss: 1.610 Vali Acc: 0.316 Test Loss: 1.610 Test Acc: 0.316
Validation loss decreased (-0.307969 --> -0.315573).  Saving model ...
Epoch: 14 cost time: 3.370486259460449
Epoch: 14, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.726 Vali Acc: 0.327 Test Loss: 1.726 Test Acc: 0.327
Validation loss decreased (-0.315573 --> -0.326979).  Saving model ...
Epoch: 15 cost time: 3.4250876903533936
Epoch: 15, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.753 Vali Acc: 0.266 Test Loss: 1.753 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0695927143096924
Epoch: 16, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.846 Vali Acc: 0.331 Test Loss: 1.846 Test Acc: 0.331
Validation loss decreased (-0.326979 --> -0.330780).  Saving model ...
Epoch: 17 cost time: 2.9564049243927
Epoch: 17, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.711 Vali Acc: 0.304 Test Loss: 1.711 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.3593332767486572
Epoch: 18, Steps: 17 | Train Loss: 0.930 Vali Loss: 1.869 Vali Acc: 0.323 Test Loss: 1.869 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.3686420917510986
Epoch: 19, Steps: 17 | Train Loss: 0.794 Vali Loss: 1.769 Vali Acc: 0.331 Test Loss: 1.769 Test Acc: 0.331
Validation loss decreased (-0.330780 --> -0.330781).  Saving model ...
Epoch: 20 cost time: 2.9090490341186523
Epoch: 20, Steps: 17 | Train Loss: 0.906 Vali Loss: 1.862 Vali Acc: 0.323 Test Loss: 1.862 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8842217922210693
Epoch: 21, Steps: 17 | Train Loss: 0.713 Vali Loss: 1.875 Vali Acc: 0.331 Test Loss: 1.875 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1907784938812256
Epoch: 22, Steps: 17 | Train Loss: 0.649 Vali Loss: 1.992 Vali Acc: 0.323 Test Loss: 1.992 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.067305088043213
Epoch: 23, Steps: 17 | Train Loss: 0.612 Vali Loss: 2.002 Vali Acc: 0.323 Test Loss: 2.002 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.221503734588623
Epoch: 24, Steps: 17 | Train Loss: 0.655 Vali Loss: 2.201 Vali Acc: 0.335 Test Loss: 2.201 Test Acc: 0.335
Validation loss decreased (-0.330781 --> -0.334579).  Saving model ...
Epoch: 25 cost time: 3.0298192501068115
Epoch: 25, Steps: 17 | Train Loss: 0.571 Vali Loss: 2.022 Vali Acc: 0.335 Test Loss: 2.022 Test Acc: 0.335
Validation loss decreased (-0.334579 --> -0.334581).  Saving model ...
Epoch: 26 cost time: 3.3036997318267822
Epoch: 26, Steps: 17 | Train Loss: 0.546 Vali Loss: 2.673 Vali Acc: 0.308 Test Loss: 2.673 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7077560424804688
Epoch: 27, Steps: 17 | Train Loss: 0.623 Vali Loss: 2.693 Vali Acc: 0.312 Test Loss: 2.693 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.2853708267211914
Epoch: 28, Steps: 17 | Train Loss: 0.825 Vali Loss: 2.794 Vali Acc: 0.338 Test Loss: 2.794 Test Acc: 0.338
Validation loss decreased (-0.334581 --> -0.338375).  Saving model ...
Epoch: 29 cost time: 3.3537492752075195
Epoch: 29, Steps: 17 | Train Loss: 0.643 Vali Loss: 2.274 Vali Acc: 0.308 Test Loss: 2.274 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 3.0722055435180664
Epoch: 30, Steps: 17 | Train Loss: 0.425 Vali Loss: 2.522 Vali Acc: 0.361 Test Loss: 2.522 Test Acc: 0.361
Validation loss decreased (-0.338375 --> -0.361192).  Saving model ...
Epoch: 31 cost time: 3.1705048084259033
Epoch: 31, Steps: 17 | Train Loss: 0.372 Vali Loss: 2.405 Vali Acc: 0.335 Test Loss: 2.405 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 3.082838535308838
Epoch: 32, Steps: 17 | Train Loss: 0.362 Vali Loss: 2.620 Vali Acc: 0.323 Test Loss: 2.620 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 3.3103761672973633
Epoch: 33, Steps: 17 | Train Loss: 0.382 Vali Loss: 2.622 Vali Acc: 0.350 Test Loss: 2.622 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.9374468326568604
Epoch: 34, Steps: 17 | Train Loss: 0.341 Vali Loss: 2.828 Vali Acc: 0.331 Test Loss: 2.828 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.314042806625366
Epoch: 35, Steps: 17 | Train Loss: 0.295 Vali Loss: 3.141 Vali Acc: 0.342 Test Loss: 3.141 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.876509428024292
Epoch: 36, Steps: 17 | Train Loss: 0.429 Vali Loss: 3.050 Vali Acc: 0.331 Test Loss: 3.050 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 3.0655345916748047
Epoch: 37, Steps: 17 | Train Loss: 0.244 Vali Loss: 2.850 Vali Acc: 0.346 Test Loss: 2.850 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.5429651737213135
Epoch: 38, Steps: 17 | Train Loss: 0.237 Vali Loss: 2.975 Vali Acc: 0.350 Test Loss: 2.975 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.961016893386841
Epoch: 39, Steps: 17 | Train Loss: 0.218 Vali Loss: 3.359 Vali Acc: 0.338 Test Loss: 3.359 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.6875314712524414
Epoch: 40, Steps: 17 | Train Loss: 0.359 Vali Loss: 3.093 Vali Acc: 0.293 Test Loss: 3.093 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3612167300380228
model parameter : 1112808
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.962325572967529
Epoch: 1, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.408 Vali Acc: 0.274 Test Loss: 1.408 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 3.4546172618865967
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.444 Vali Acc: 0.278 Test Loss: 1.444 Test Acc: 0.278
Validation loss decreased (-0.273750 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 3.114795207977295
Epoch: 3, Steps: 17 | Train Loss: 1.481 Vali Loss: 1.601 Vali Acc: 0.266 Test Loss: 1.601 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.2458183765411377
Epoch: 4, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.668 Vali Acc: 0.243 Test Loss: 1.668 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.2824442386627197
Epoch: 5, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.651 Vali Acc: 0.243 Test Loss: 1.651 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1825132369995117
Epoch: 6, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.666 Vali Acc: 0.255 Test Loss: 1.666 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 3.184431791305542
Epoch: 7, Steps: 17 | Train Loss: 1.500 Vali Loss: 1.494 Vali Acc: 0.232 Test Loss: 1.494 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.923767328262329
Epoch: 8, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.521 Vali Acc: 0.297 Test Loss: 1.521 Test Acc: 0.297
Validation loss decreased (-0.277552 --> -0.296563).  Saving model ...
Epoch: 9 cost time: 3.794924736022949
Epoch: 9, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.546 Vali Acc: 0.259 Test Loss: 1.546 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.776705503463745
Epoch: 10, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.695 Vali Acc: 0.274 Test Loss: 1.695 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.865525722503662
Epoch: 11, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.641 Vali Acc: 0.278 Test Loss: 1.641 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.5019679069519043
Epoch: 12, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.638 Vali Acc: 0.312 Test Loss: 1.638 Test Acc: 0.312
Validation loss decreased (-0.296563 --> -0.311771).  Saving model ...
Epoch: 13 cost time: 2.805981397628784
Epoch: 13, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.778 Vali Acc: 0.316 Test Loss: 1.778 Test Acc: 0.316
Validation loss decreased (-0.311771 --> -0.315572).  Saving model ...
Epoch: 14 cost time: 2.550898313522339
Epoch: 14, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.864 Vali Acc: 0.297 Test Loss: 1.864 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4925332069396973
Epoch: 15, Steps: 17 | Train Loss: 0.914 Vali Loss: 1.818 Vali Acc: 0.300 Test Loss: 1.818 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.0812952518463135
Epoch: 16, Steps: 17 | Train Loss: 0.882 Vali Loss: 2.016 Vali Acc: 0.304 Test Loss: 2.016 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.9046123027801514
Epoch: 17, Steps: 17 | Train Loss: 0.892 Vali Loss: 2.097 Vali Acc: 0.304 Test Loss: 2.097 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6666653156280518
Epoch: 18, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.060 Vali Acc: 0.300 Test Loss: 2.060 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.649076223373413
Epoch: 19, Steps: 17 | Train Loss: 0.824 Vali Loss: 1.989 Vali Acc: 0.319 Test Loss: 1.989 Test Acc: 0.319
Validation loss decreased (-0.315572 --> -0.319372).  Saving model ...
Epoch: 20 cost time: 2.5896260738372803
Epoch: 20, Steps: 17 | Train Loss: 0.757 Vali Loss: 2.269 Vali Acc: 0.293 Test Loss: 2.269 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2060976028442383
Epoch: 21, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.037 Vali Acc: 0.327 Test Loss: 2.037 Test Acc: 0.327
Validation loss decreased (-0.319372 --> -0.326976).  Saving model ...
Epoch: 22 cost time: 2.8971211910247803
Epoch: 22, Steps: 17 | Train Loss: 0.579 Vali Loss: 2.311 Vali Acc: 0.342 Test Loss: 2.311 Test Acc: 0.342
Validation loss decreased (-0.326976 --> -0.342182).  Saving model ...
Epoch: 23 cost time: 2.604297161102295
Epoch: 23, Steps: 17 | Train Loss: 0.640 Vali Loss: 2.093 Vali Acc: 0.331 Test Loss: 2.093 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.143012046813965
Epoch: 24, Steps: 17 | Train Loss: 0.556 Vali Loss: 2.212 Vali Acc: 0.335 Test Loss: 2.212 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.0923235416412354
Epoch: 25, Steps: 17 | Train Loss: 0.594 Vali Loss: 2.189 Vali Acc: 0.338 Test Loss: 2.189 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.060107707977295
Epoch: 26, Steps: 17 | Train Loss: 0.495 Vali Loss: 3.067 Vali Acc: 0.308 Test Loss: 3.067 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.7759387493133545
Epoch: 27, Steps: 17 | Train Loss: 0.718 Vali Loss: 2.337 Vali Acc: 0.369 Test Loss: 2.337 Test Acc: 0.369
Validation loss decreased (-0.342182 --> -0.368798).  Saving model ...
Epoch: 28 cost time: 1.7807776927947998
Epoch: 28, Steps: 17 | Train Loss: 0.461 Vali Loss: 2.851 Vali Acc: 0.350 Test Loss: 2.851 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.8519995212554932
Epoch: 29, Steps: 17 | Train Loss: 0.628 Vali Loss: 2.457 Vali Acc: 0.350 Test Loss: 2.457 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9844386577606201
Epoch: 30, Steps: 17 | Train Loss: 0.377 Vali Loss: 2.849 Vali Acc: 0.316 Test Loss: 2.849 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7503743171691895
Epoch: 31, Steps: 17 | Train Loss: 0.379 Vali Loss: 2.691 Vali Acc: 0.380 Test Loss: 2.691 Test Acc: 0.380
Validation loss decreased (-0.368798 --> -0.380201).  Saving model ...
Epoch: 32 cost time: 2.0037841796875
Epoch: 32, Steps: 17 | Train Loss: 0.383 Vali Loss: 2.617 Vali Acc: 0.338 Test Loss: 2.617 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.2933311462402344
Epoch: 33, Steps: 17 | Train Loss: 0.367 Vali Loss: 2.733 Vali Acc: 0.319 Test Loss: 2.733 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0066750049591064
Epoch: 34, Steps: 17 | Train Loss: 0.396 Vali Loss: 2.912 Vali Acc: 0.376 Test Loss: 2.912 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.235515832901001
Epoch: 35, Steps: 17 | Train Loss: 0.366 Vali Loss: 3.138 Vali Acc: 0.357 Test Loss: 3.138 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.3298652172088623
Epoch: 36, Steps: 17 | Train Loss: 0.330 Vali Loss: 3.108 Vali Acc: 0.346 Test Loss: 3.108 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.3153510093688965
Epoch: 37, Steps: 17 | Train Loss: 0.311 Vali Loss: 3.351 Vali Acc: 0.312 Test Loss: 3.351 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.605863332748413
Epoch: 38, Steps: 17 | Train Loss: 0.357 Vali Loss: 3.258 Vali Acc: 0.350 Test Loss: 3.258 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.8913207054138184
Epoch: 39, Steps: 17 | Train Loss: 0.359 Vali Loss: 3.575 Vali Acc: 0.331 Test Loss: 3.575 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.8805949687957764
Epoch: 40, Steps: 17 | Train Loss: 0.205 Vali Loss: 3.553 Vali Acc: 0.304 Test Loss: 3.553 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 3.0027763843536377
Epoch: 41, Steps: 17 | Train Loss: 0.264 Vali Loss: 3.550 Vali Acc: 0.384 Test Loss: 3.550 Test Acc: 0.384
Validation loss decreased (-0.380201 --> -0.383995).  Saving model ...
Epoch: 42 cost time: 2.662271738052368
Epoch: 42, Steps: 17 | Train Loss: 0.297 Vali Loss: 3.587 Vali Acc: 0.323 Test Loss: 3.587 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 2.880261182785034
Epoch: 43, Steps: 17 | Train Loss: 0.258 Vali Loss: 3.863 Vali Acc: 0.335 Test Loss: 3.863 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 2.701467275619507
Epoch: 44, Steps: 17 | Train Loss: 0.276 Vali Loss: 3.702 Vali Acc: 0.342 Test Loss: 3.702 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.9711644649505615
Epoch: 45, Steps: 17 | Train Loss: 0.160 Vali Loss: 3.880 Vali Acc: 0.354 Test Loss: 3.880 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 2.6267893314361572
Epoch: 46, Steps: 17 | Train Loss: 0.144 Vali Loss: 3.752 Vali Acc: 0.361 Test Loss: 3.752 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 2.715264320373535
Epoch: 47, Steps: 17 | Train Loss: 0.208 Vali Loss: 3.903 Vali Acc: 0.350 Test Loss: 3.903 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 3.039353370666504
Epoch: 48, Steps: 17 | Train Loss: 0.215 Vali Loss: 4.381 Vali Acc: 0.331 Test Loss: 4.381 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 2.912945508956909
Epoch: 49, Steps: 17 | Train Loss: 0.168 Vali Loss: 4.108 Vali Acc: 0.350 Test Loss: 4.108 Test Acc: 0.350
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 2.6371140480041504
Epoch: 50, Steps: 17 | Train Loss: 0.102 Vali Loss: 4.349 Vali Acc: 0.308 Test Loss: 4.349 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 2.3251943588256836
Epoch: 51, Steps: 17 | Train Loss: 0.121 Vali Loss: 4.243 Vali Acc: 0.346 Test Loss: 4.243 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3840304182509506
model parameter : 1098792
model size : 5.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.9762842655181885
Epoch: 1, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.424 Vali Acc: 0.247 Test Loss: 1.424 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 2.9841246604919434
Epoch: 2, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.491 Vali Acc: 0.243 Test Loss: 1.491 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9875893592834473
Epoch: 3, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.530 Vali Acc: 0.262 Test Loss: 1.530 Test Acc: 0.262
Validation loss decreased (-0.247134 --> -0.262342).  Saving model ...
Epoch: 4 cost time: 2.7237770557403564
Epoch: 4, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.510 Vali Acc: 0.255 Test Loss: 1.510 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.331749200820923
Epoch: 5, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.538 Vali Acc: 0.270 Test Loss: 1.538 Test Acc: 0.270
Validation loss decreased (-0.262342 --> -0.269947).  Saving model ...
Epoch: 6 cost time: 3.5613961219787598
Epoch: 6, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.488 Vali Acc: 0.285 Test Loss: 1.488 Test Acc: 0.285
Validation loss decreased (-0.269947 --> -0.285156).  Saving model ...
Epoch: 7 cost time: 3.433114528656006
Epoch: 7, Steps: 17 | Train Loss: 1.389 Vali Loss: 1.511 Vali Acc: 0.262 Test Loss: 1.511 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.233551263809204
Epoch: 8, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.566 Vali Acc: 0.255 Test Loss: 1.566 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1179282665252686
Epoch: 9, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.615 Vali Acc: 0.278 Test Loss: 1.615 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9250295162200928
Epoch: 10, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.911 Vali Acc: 0.293 Test Loss: 1.911 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292757).  Saving model ...
Epoch: 11 cost time: 2.8379271030426025
Epoch: 11, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.903 Vali Acc: 0.293 Test Loss: 1.903 Test Acc: 0.293
Validation loss decreased (-0.292757 --> -0.292757).  Saving model ...
Epoch: 12 cost time: 3.422828197479248
Epoch: 12, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.976 Vali Acc: 0.278 Test Loss: 1.976 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.4050979614257812
Epoch: 13, Steps: 17 | Train Loss: 1.040 Vali Loss: 2.275 Vali Acc: 0.266 Test Loss: 2.275 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8008065223693848
Epoch: 14, Steps: 17 | Train Loss: 1.184 Vali Loss: 2.145 Vali Acc: 0.300 Test Loss: 2.145 Test Acc: 0.300
Validation loss decreased (-0.292757 --> -0.300359).  Saving model ...
Epoch: 15 cost time: 2.087562084197998
Epoch: 15, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.811 Vali Acc: 0.270 Test Loss: 1.811 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0488333702087402
Epoch: 16, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.951 Vali Acc: 0.266 Test Loss: 1.951 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4638559818267822
Epoch: 17, Steps: 17 | Train Loss: 0.823 Vali Loss: 1.959 Vali Acc: 0.346 Test Loss: 1.959 Test Acc: 0.346
Validation loss decreased (-0.300359 --> -0.345988).  Saving model ...
Epoch: 18 cost time: 3.0040502548217773
Epoch: 18, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.869 Vali Acc: 0.335 Test Loss: 1.869 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3560359477996826
Epoch: 19, Steps: 17 | Train Loss: 0.764 Vali Loss: 2.327 Vali Acc: 0.304 Test Loss: 2.327 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0359323024749756
Epoch: 20, Steps: 17 | Train Loss: 0.871 Vali Loss: 1.935 Vali Acc: 0.319 Test Loss: 1.935 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.6793899536132812
Epoch: 21, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.204 Vali Acc: 0.319 Test Loss: 2.204 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.473975896835327
Epoch: 22, Steps: 17 | Train Loss: 0.726 Vali Loss: 2.071 Vali Acc: 0.316 Test Loss: 2.071 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.1949453353881836
Epoch: 23, Steps: 17 | Train Loss: 0.673 Vali Loss: 2.231 Vali Acc: 0.312 Test Loss: 2.231 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.937415838241577
Epoch: 24, Steps: 17 | Train Loss: 0.787 Vali Loss: 2.254 Vali Acc: 0.350 Test Loss: 2.254 Test Acc: 0.350
Validation loss decreased (-0.345988 --> -0.349787).  Saving model ...
Epoch: 25 cost time: 3.438883066177368
Epoch: 25, Steps: 17 | Train Loss: 0.733 Vali Loss: 2.267 Vali Acc: 0.312 Test Loss: 2.267 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.044821739196777
Epoch: 26, Steps: 17 | Train Loss: 0.818 Vali Loss: 2.058 Vali Acc: 0.335 Test Loss: 2.058 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.120630264282227
Epoch: 27, Steps: 17 | Train Loss: 0.553 Vali Loss: 2.449 Vali Acc: 0.350 Test Loss: 2.449 Test Acc: 0.350
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.8530008792877197
Epoch: 28, Steps: 17 | Train Loss: 0.599 Vali Loss: 2.556 Vali Acc: 0.304 Test Loss: 2.556 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.464290142059326
Epoch: 29, Steps: 17 | Train Loss: 0.484 Vali Loss: 2.392 Vali Acc: 0.323 Test Loss: 2.392 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 3.9415841102600098
Epoch: 30, Steps: 17 | Train Loss: 0.542 Vali Loss: 2.661 Vali Acc: 0.342 Test Loss: 2.661 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.9836320877075195
Epoch: 31, Steps: 17 | Train Loss: 0.481 Vali Loss: 3.181 Vali Acc: 0.300 Test Loss: 3.181 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 3.394427537918091
Epoch: 32, Steps: 17 | Train Loss: 0.535 Vali Loss: 3.310 Vali Acc: 0.319 Test Loss: 3.310 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.5585544109344482
Epoch: 33, Steps: 17 | Train Loss: 0.494 Vali Loss: 2.516 Vali Acc: 0.346 Test Loss: 2.516 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 3.1594409942626953
Epoch: 34, Steps: 17 | Train Loss: 0.288 Vali Loss: 3.166 Vali Acc: 0.323 Test Loss: 3.166 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34980988593155893
model parameter : 810600
model size : 4.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.477998971939087
Epoch: 1, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.552 Vali Acc: 0.262 Test Loss: 1.552 Test Acc: 0.262
Validation loss decreased (inf --> -0.262342).  Saving model ...
Epoch: 2 cost time: 2.5617406368255615
Epoch: 2, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.475 Vali Acc: 0.270 Test Loss: 1.475 Test Acc: 0.270
Validation loss decreased (-0.262342 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 3.2718632221221924
Epoch: 3, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.477 Vali Acc: 0.259 Test Loss: 1.477 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.014807939529419
Epoch: 4, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.566 Vali Acc: 0.262 Test Loss: 1.566 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.8970541954040527
Epoch: 5, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.736 Vali Acc: 0.247 Test Loss: 1.736 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.9709577560424805
Epoch: 6, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.641 Vali Acc: 0.262 Test Loss: 1.641 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.9219441413879395
Epoch: 7, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.433 Vali Acc: 0.289 Test Loss: 1.433 Test Acc: 0.289
Validation loss decreased (-0.269947 --> -0.288959).  Saving model ...
Epoch: 8 cost time: 3.2871663570404053
Epoch: 8, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.936 Vali Acc: 0.240 Test Loss: 1.936 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.9321513175964355
Epoch: 9, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.558 Vali Acc: 0.270 Test Loss: 1.558 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.4804227352142334
Epoch: 10, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.625 Vali Acc: 0.285 Test Loss: 1.625 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.246061086654663
Epoch: 11, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.723 Vali Acc: 0.274 Test Loss: 1.723 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.228163719177246
Epoch: 12, Steps: 17 | Train Loss: 1.121 Vali Loss: 1.602 Vali Acc: 0.266 Test Loss: 1.602 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.1915736198425293
Epoch: 13, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.827 Vali Acc: 0.293 Test Loss: 1.827 Test Acc: 0.293
Validation loss decreased (-0.288959 --> -0.292757).  Saving model ...
Epoch: 14 cost time: 2.7904462814331055
Epoch: 14, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.949 Vali Acc: 0.297 Test Loss: 1.949 Test Acc: 0.297
Validation loss decreased (-0.292757 --> -0.296558).  Saving model ...
Epoch: 15 cost time: 4.203678846359253
Epoch: 15, Steps: 17 | Train Loss: 0.976 Vali Loss: 1.841 Vali Acc: 0.262 Test Loss: 1.841 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2849793434143066
Epoch: 16, Steps: 17 | Train Loss: 0.971 Vali Loss: 1.819 Vali Acc: 0.304 Test Loss: 1.819 Test Acc: 0.304
Validation loss decreased (-0.296558 --> -0.304164).  Saving model ...
Epoch: 17 cost time: 3.316802978515625
Epoch: 17, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.771 Vali Acc: 0.323 Test Loss: 1.771 Test Acc: 0.323
Validation loss decreased (-0.304164 --> -0.323176).  Saving model ...
Epoch: 18 cost time: 2.9873244762420654
Epoch: 18, Steps: 17 | Train Loss: 0.798 Vali Loss: 1.786 Vali Acc: 0.319 Test Loss: 1.786 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.0803956985473633
Epoch: 19, Steps: 17 | Train Loss: 0.740 Vali Loss: 1.943 Vali Acc: 0.304 Test Loss: 1.943 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.7149507999420166
Epoch: 20, Steps: 17 | Train Loss: 0.747 Vali Loss: 1.878 Vali Acc: 0.327 Test Loss: 1.878 Test Acc: 0.327
Validation loss decreased (-0.323176 --> -0.326977).  Saving model ...
Epoch: 21 cost time: 2.892190456390381
Epoch: 21, Steps: 17 | Train Loss: 0.638 Vali Loss: 1.937 Vali Acc: 0.319 Test Loss: 1.937 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.022864818572998
Epoch: 22, Steps: 17 | Train Loss: 0.668 Vali Loss: 2.151 Vali Acc: 0.300 Test Loss: 2.151 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.6681742668151855
Epoch: 23, Steps: 17 | Train Loss: 0.850 Vali Loss: 2.261 Vali Acc: 0.327 Test Loss: 2.261 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.8690829277038574
Epoch: 24, Steps: 17 | Train Loss: 0.702 Vali Loss: 2.164 Vali Acc: 0.338 Test Loss: 2.164 Test Acc: 0.338
Validation loss decreased (-0.326977 --> -0.338381).  Saving model ...
Epoch: 25 cost time: 3.1333799362182617
Epoch: 25, Steps: 17 | Train Loss: 0.504 Vali Loss: 2.117 Vali Acc: 0.346 Test Loss: 2.117 Test Acc: 0.346
Validation loss decreased (-0.338381 --> -0.345986).  Saving model ...
Epoch: 26 cost time: 2.7058537006378174
Epoch: 26, Steps: 17 | Train Loss: 0.577 Vali Loss: 2.921 Vali Acc: 0.342 Test Loss: 2.921 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9660513401031494
Epoch: 27, Steps: 17 | Train Loss: 0.629 Vali Loss: 2.310 Vali Acc: 0.308 Test Loss: 2.310 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.715198278427124
Epoch: 28, Steps: 17 | Train Loss: 0.498 Vali Loss: 2.669 Vali Acc: 0.323 Test Loss: 2.669 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3859810829162598
Epoch: 29, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.877 Vali Acc: 0.304 Test Loss: 2.877 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.814720392227173
Epoch: 30, Steps: 17 | Train Loss: 0.478 Vali Loss: 2.561 Vali Acc: 0.338 Test Loss: 2.561 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.8574187755584717
Epoch: 31, Steps: 17 | Train Loss: 0.417 Vali Loss: 2.881 Vali Acc: 0.308 Test Loss: 2.881 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.3356122970581055
Epoch: 32, Steps: 17 | Train Loss: 0.422 Vali Loss: 3.109 Vali Acc: 0.300 Test Loss: 3.109 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.026005744934082
Epoch: 33, Steps: 17 | Train Loss: 0.384 Vali Loss: 3.000 Vali Acc: 0.342 Test Loss: 3.000 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.1304380893707275
Epoch: 34, Steps: 17 | Train Loss: 0.329 Vali Loss: 2.677 Vali Acc: 0.350 Test Loss: 2.677 Test Acc: 0.350
Validation loss decreased (-0.345986 --> -0.349783).  Saving model ...
Epoch: 35 cost time: 2.795517683029175
Epoch: 35, Steps: 17 | Train Loss: 0.308 Vali Loss: 3.142 Vali Acc: 0.350 Test Loss: 3.142 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 3.083599328994751
Epoch: 36, Steps: 17 | Train Loss: 0.378 Vali Loss: 3.051 Vali Acc: 0.338 Test Loss: 3.051 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.9867613315582275
Epoch: 37, Steps: 17 | Train Loss: 0.337 Vali Loss: 3.377 Vali Acc: 0.335 Test Loss: 3.377 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 3.5778396129608154
Epoch: 38, Steps: 17 | Train Loss: 0.320 Vali Loss: 3.103 Vali Acc: 0.376 Test Loss: 3.103 Test Acc: 0.376
Validation loss decreased (-0.349783 --> -0.376395).  Saving model ...
Epoch: 39 cost time: 3.037752628326416
Epoch: 39, Steps: 17 | Train Loss: 0.304 Vali Loss: 3.162 Vali Acc: 0.361 Test Loss: 3.162 Test Acc: 0.361
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 2.973724842071533
Epoch: 40, Steps: 17 | Train Loss: 0.237 Vali Loss: 3.294 Vali Acc: 0.350 Test Loss: 3.294 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 3.443018674850464
Epoch: 41, Steps: 17 | Train Loss: 0.225 Vali Loss: 3.303 Vali Acc: 0.369 Test Loss: 3.303 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 3.209754705429077
Epoch: 42, Steps: 17 | Train Loss: 0.237 Vali Loss: 3.735 Vali Acc: 0.335 Test Loss: 3.735 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 3.531071901321411
Epoch: 43, Steps: 17 | Train Loss: 0.155 Vali Loss: 3.364 Vali Acc: 0.403 Test Loss: 3.364 Test Acc: 0.403
Validation loss decreased (-0.376395 --> -0.403008).  Saving model ...
Epoch: 44 cost time: 3.9378888607025146
Epoch: 44, Steps: 17 | Train Loss: 0.176 Vali Loss: 3.664 Vali Acc: 0.350 Test Loss: 3.664 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 3.040527105331421
Epoch: 45, Steps: 17 | Train Loss: 0.291 Vali Loss: 3.676 Vali Acc: 0.350 Test Loss: 3.676 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 2.6035244464874268
Epoch: 46, Steps: 17 | Train Loss: 0.212 Vali Loss: 3.686 Vali Acc: 0.392 Test Loss: 3.686 Test Acc: 0.392
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 2.5380611419677734
Epoch: 47, Steps: 17 | Train Loss: 0.205 Vali Loss: 3.729 Vali Acc: 0.338 Test Loss: 3.729 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 3.2817275524139404
Epoch: 48, Steps: 17 | Train Loss: 0.112 Vali Loss: 3.790 Vali Acc: 0.331 Test Loss: 3.790 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 3.425865888595581
Epoch: 49, Steps: 17 | Train Loss: 0.110 Vali Loss: 3.760 Vali Acc: 0.369 Test Loss: 3.760 Test Acc: 0.369
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 3.1572234630584717
Epoch: 50, Steps: 17 | Train Loss: 0.113 Vali Loss: 3.848 Vali Acc: 0.369 Test Loss: 3.848 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 3.4515271186828613
Epoch: 51, Steps: 17 | Train Loss: 0.245 Vali Loss: 4.050 Vali Acc: 0.342 Test Loss: 4.050 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 3.614985227584839
Epoch: 52, Steps: 17 | Train Loss: 0.170 Vali Loss: 4.034 Vali Acc: 0.384 Test Loss: 4.034 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 3.345137596130371
Epoch: 53, Steps: 17 | Train Loss: 0.096 Vali Loss: 4.338 Vali Acc: 0.369 Test Loss: 4.338 Test Acc: 0.369
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.40304182509505704
model parameter : 796584
model size : 4.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.965505599975586
Epoch: 1, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.446 Vali Acc: 0.259 Test Loss: 1.446 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 2.5097427368164062
Epoch: 2, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.411 Vali Acc: 0.289 Test Loss: 1.411 Test Acc: 0.289
Validation loss decreased (-0.258541 --> -0.288959).  Saving model ...
Epoch: 3 cost time: 2.7549257278442383
Epoch: 3, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.812 Vali Acc: 0.255 Test Loss: 1.812 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8656890392303467
Epoch: 4, Steps: 17 | Train Loss: 1.610 Vali Loss: 1.546 Vali Acc: 0.312 Test Loss: 1.546 Test Acc: 0.312
Validation loss decreased (-0.288959 --> -0.311772).  Saving model ...
Epoch: 5 cost time: 3.1030399799346924
Epoch: 5, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.539 Vali Acc: 0.289 Test Loss: 1.539 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.577108860015869
Epoch: 6, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.401 Vali Acc: 0.278 Test Loss: 1.401 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.063457489013672
Epoch: 7, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.978 Vali Acc: 0.266 Test Loss: 1.978 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.15977144241333
Epoch: 8, Steps: 17 | Train Loss: 1.591 Vali Loss: 1.897 Vali Acc: 0.262 Test Loss: 1.897 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.612365484237671
Epoch: 9, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.588 Vali Acc: 0.281 Test Loss: 1.588 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.740124464035034
Epoch: 10, Steps: 17 | Train Loss: 1.234 Vali Loss: 1.459 Vali Acc: 0.270 Test Loss: 1.459 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.887852191925049
Epoch: 11, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.867 Vali Acc: 0.300 Test Loss: 1.867 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.2487337589263916
Epoch: 12, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.580 Vali Acc: 0.297 Test Loss: 1.580 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.0986220836639404
Epoch: 13, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.970 Vali Acc: 0.243 Test Loss: 1.970 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.8940420150756836
Epoch: 14, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.615 Vali Acc: 0.331 Test Loss: 1.615 Test Acc: 0.331
Validation loss decreased (-0.311772 --> -0.330782).  Saving model ...
Epoch: 15 cost time: 2.8896570205688477
Epoch: 15, Steps: 17 | Train Loss: 1.024 Vali Loss: 2.067 Vali Acc: 0.262 Test Loss: 2.067 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1260626316070557
Epoch: 16, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.672 Vali Acc: 0.335 Test Loss: 1.672 Test Acc: 0.335
Validation loss decreased (-0.330782 --> -0.334584).  Saving model ...
Epoch: 17 cost time: 2.658712863922119
Epoch: 17, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.876 Vali Acc: 0.281 Test Loss: 1.876 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.200927257537842
Epoch: 18, Steps: 17 | Train Loss: 0.828 Vali Loss: 1.653 Vali Acc: 0.361 Test Loss: 1.653 Test Acc: 0.361
Validation loss decreased (-0.334584 --> -0.361200).  Saving model ...
Epoch: 19 cost time: 3.0017316341400146
Epoch: 19, Steps: 17 | Train Loss: 0.804 Vali Loss: 1.918 Vali Acc: 0.354 Test Loss: 1.918 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5587916374206543
Epoch: 20, Steps: 17 | Train Loss: 0.925 Vali Loss: 2.030 Vali Acc: 0.289 Test Loss: 2.030 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.4795706272125244
Epoch: 21, Steps: 17 | Train Loss: 0.796 Vali Loss: 1.685 Vali Acc: 0.354 Test Loss: 1.685 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.093116283416748
Epoch: 22, Steps: 17 | Train Loss: 0.640 Vali Loss: 1.803 Vali Acc: 0.357 Test Loss: 1.803 Test Acc: 0.357
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.847433567047119
Epoch: 23, Steps: 17 | Train Loss: 0.669 Vali Loss: 1.958 Vali Acc: 0.365 Test Loss: 1.958 Test Acc: 0.365
Validation loss decreased (-0.361200 --> -0.364999).  Saving model ...
Epoch: 24 cost time: 3.1011433601379395
Epoch: 24, Steps: 17 | Train Loss: 0.756 Vali Loss: 1.752 Vali Acc: 0.335 Test Loss: 1.752 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.944683790206909
Epoch: 25, Steps: 17 | Train Loss: 0.581 Vali Loss: 1.934 Vali Acc: 0.376 Test Loss: 1.934 Test Acc: 0.376
Validation loss decreased (-0.364999 --> -0.376407).  Saving model ...
Epoch: 26 cost time: 3.0008044242858887
Epoch: 26, Steps: 17 | Train Loss: 0.518 Vali Loss: 2.122 Vali Acc: 0.335 Test Loss: 2.122 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9655325412750244
Epoch: 27, Steps: 17 | Train Loss: 0.531 Vali Loss: 2.343 Vali Acc: 0.361 Test Loss: 2.343 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.0157015323638916
Epoch: 28, Steps: 17 | Train Loss: 0.520 Vali Loss: 2.234 Vali Acc: 0.354 Test Loss: 2.234 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.279709815979004
Epoch: 29, Steps: 17 | Train Loss: 0.490 Vali Loss: 2.137 Vali Acc: 0.361 Test Loss: 2.137 Test Acc: 0.361
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.5217244625091553
Epoch: 30, Steps: 17 | Train Loss: 0.470 Vali Loss: 2.430 Vali Acc: 0.361 Test Loss: 2.430 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.6015102863311768
Epoch: 31, Steps: 17 | Train Loss: 0.434 Vali Loss: 2.302 Vali Acc: 0.354 Test Loss: 2.302 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.748697280883789
Epoch: 32, Steps: 17 | Train Loss: 0.424 Vali Loss: 2.608 Vali Acc: 0.357 Test Loss: 2.608 Test Acc: 0.357
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.174374580383301
Epoch: 33, Steps: 17 | Train Loss: 0.355 Vali Loss: 2.442 Vali Acc: 0.384 Test Loss: 2.442 Test Acc: 0.384
Validation loss decreased (-0.376407 --> -0.384006).  Saving model ...
Epoch: 34 cost time: 2.7187139987945557
Epoch: 34, Steps: 17 | Train Loss: 0.322 Vali Loss: 2.743 Vali Acc: 0.327 Test Loss: 2.743 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.506381034851074
Epoch: 35, Steps: 17 | Train Loss: 0.328 Vali Loss: 2.680 Vali Acc: 0.327 Test Loss: 2.680 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.9479050636291504
Epoch: 36, Steps: 17 | Train Loss: 0.339 Vali Loss: 2.562 Vali Acc: 0.373 Test Loss: 2.562 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.7998130321502686
Epoch: 37, Steps: 17 | Train Loss: 0.257 Vali Loss: 3.226 Vali Acc: 0.297 Test Loss: 3.226 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.7899436950683594
Epoch: 38, Steps: 17 | Train Loss: 0.429 Vali Loss: 3.281 Vali Acc: 0.319 Test Loss: 3.281 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.8208694458007812
Epoch: 39, Steps: 17 | Train Loss: 0.375 Vali Loss: 2.822 Vali Acc: 0.380 Test Loss: 2.822 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.9157917499542236
Epoch: 40, Steps: 17 | Train Loss: 0.255 Vali Loss: 2.757 Vali Acc: 0.369 Test Loss: 2.757 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.7237532138824463
Epoch: 41, Steps: 17 | Train Loss: 0.293 Vali Loss: 3.115 Vali Acc: 0.365 Test Loss: 3.115 Test Acc: 0.365
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 3.226486921310425
Epoch: 42, Steps: 17 | Train Loss: 0.226 Vali Loss: 3.023 Vali Acc: 0.392 Test Loss: 3.023 Test Acc: 0.392
Validation loss decreased (-0.384006 --> -0.391605).  Saving model ...
Epoch: 43 cost time: 3.241701126098633
Epoch: 43, Steps: 17 | Train Loss: 0.143 Vali Loss: 3.423 Vali Acc: 0.373 Test Loss: 3.423 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.7788095474243164
Epoch: 44, Steps: 17 | Train Loss: 0.292 Vali Loss: 3.179 Vali Acc: 0.342 Test Loss: 3.179 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 3.150052070617676
Epoch: 45, Steps: 17 | Train Loss: 0.184 Vali Loss: 3.808 Vali Acc: 0.361 Test Loss: 3.808 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 3.0248992443084717
Epoch: 46, Steps: 17 | Train Loss: 0.211 Vali Loss: 4.028 Vali Acc: 0.354 Test Loss: 4.028 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 3.02640438079834
Epoch: 47, Steps: 17 | Train Loss: 0.227 Vali Loss: 3.547 Vali Acc: 0.323 Test Loss: 3.547 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.755293846130371
Epoch: 48, Steps: 17 | Train Loss: 0.216 Vali Loss: 3.414 Vali Acc: 0.361 Test Loss: 3.414 Test Acc: 0.361
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 3.242449998855591
Epoch: 49, Steps: 17 | Train Loss: 0.297 Vali Loss: 3.672 Vali Acc: 0.331 Test Loss: 3.672 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 2.987475633621216
Epoch: 50, Steps: 17 | Train Loss: 0.206 Vali Loss: 3.805 Vali Acc: 0.338 Test Loss: 3.805 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 2.721440553665161
Epoch: 51, Steps: 17 | Train Loss: 0.163 Vali Loss: 3.742 Vali Acc: 0.342 Test Loss: 3.742 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 2.7533769607543945
Epoch: 52, Steps: 17 | Train Loss: 0.147 Vali Loss: 3.658 Vali Acc: 0.354 Test Loss: 3.658 Test Acc: 0.354
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3916349809885932
model parameter : 782568
model size : 4.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.040010452270508
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.483 Vali Acc: 0.255 Test Loss: 1.483 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 3.121617555618286
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.704 Vali Acc: 0.259 Test Loss: 1.704 Test Acc: 0.259
Validation loss decreased (-0.254738 --> -0.258538).  Saving model ...
Epoch: 3 cost time: 3.027972459793091
Epoch: 3, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.447 Vali Acc: 0.285 Test Loss: 1.447 Test Acc: 0.285
Validation loss decreased (-0.258538 --> -0.285157).  Saving model ...
Epoch: 4 cost time: 2.9194440841674805
Epoch: 4, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.496 Vali Acc: 0.274 Test Loss: 1.496 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.8447396755218506
Epoch: 5, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.682 Vali Acc: 0.251 Test Loss: 1.682 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.174299478530884
Epoch: 6, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.522 Vali Acc: 0.262 Test Loss: 1.522 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.14253306388855
Epoch: 7, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.512 Vali Acc: 0.262 Test Loss: 1.512 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.9808850288391113
Epoch: 8, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.595 Vali Acc: 0.262 Test Loss: 1.595 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.2203876972198486
Epoch: 9, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.512 Vali Acc: 0.266 Test Loss: 1.512 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.668363332748413
Epoch: 10, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.985 Vali Acc: 0.266 Test Loss: 1.985 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7014238834381104
Epoch: 11, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.839 Vali Acc: 0.270 Test Loss: 1.839 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.3901779651641846
Epoch: 12, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.663 Vali Acc: 0.289 Test Loss: 1.663 Test Acc: 0.289
Validation loss decreased (-0.285157 --> -0.288957).  Saving model ...
Epoch: 13 cost time: 1.8731250762939453
Epoch: 13, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.678 Vali Acc: 0.293 Test Loss: 1.678 Test Acc: 0.293
Validation loss decreased (-0.288957 --> -0.292759).  Saving model ...
Epoch: 14 cost time: 2.366626739501953
Epoch: 14, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.670 Vali Acc: 0.278 Test Loss: 1.670 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.64210844039917
Epoch: 15, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.909 Vali Acc: 0.278 Test Loss: 1.909 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.265019416809082
Epoch: 16, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.742 Vali Acc: 0.304 Test Loss: 1.742 Test Acc: 0.304
Validation loss decreased (-0.292759 --> -0.304165).  Saving model ...
Epoch: 17 cost time: 2.4623727798461914
Epoch: 17, Steps: 17 | Train Loss: 1.033 Vali Loss: 2.047 Vali Acc: 0.266 Test Loss: 2.047 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.964232921600342
Epoch: 18, Steps: 17 | Train Loss: 0.906 Vali Loss: 1.810 Vali Acc: 0.304 Test Loss: 1.810 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5750598907470703
Epoch: 19, Steps: 17 | Train Loss: 0.812 Vali Loss: 1.815 Vali Acc: 0.361 Test Loss: 1.815 Test Acc: 0.361
Validation loss decreased (-0.304165 --> -0.361199).  Saving model ...
Epoch: 20 cost time: 2.6201491355895996
Epoch: 20, Steps: 17 | Train Loss: 0.803 Vali Loss: 2.106 Vali Acc: 0.316 Test Loss: 2.106 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8859405517578125
Epoch: 21, Steps: 17 | Train Loss: 0.890 Vali Loss: 2.114 Vali Acc: 0.312 Test Loss: 2.114 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.9300150871276855
Epoch: 22, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.306 Vali Acc: 0.346 Test Loss: 2.306 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.0569944381713867
Epoch: 23, Steps: 17 | Train Loss: 0.936 Vali Loss: 2.133 Vali Acc: 0.338 Test Loss: 2.133 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.1150553226470947
Epoch: 24, Steps: 17 | Train Loss: 0.706 Vali Loss: 2.115 Vali Acc: 0.350 Test Loss: 2.115 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.0478718280792236
Epoch: 25, Steps: 17 | Train Loss: 0.654 Vali Loss: 2.571 Vali Acc: 0.308 Test Loss: 2.571 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.5946261882781982
Epoch: 26, Steps: 17 | Train Loss: 0.623 Vali Loss: 2.135 Vali Acc: 0.312 Test Loss: 2.135 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.322582721710205
Epoch: 27, Steps: 17 | Train Loss: 0.564 Vali Loss: 2.237 Vali Acc: 0.342 Test Loss: 2.237 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.5848071575164795
Epoch: 28, Steps: 17 | Train Loss: 0.660 Vali Loss: 2.203 Vali Acc: 0.350 Test Loss: 2.203 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.878124475479126
Epoch: 29, Steps: 17 | Train Loss: 0.473 Vali Loss: 2.333 Vali Acc: 0.346 Test Loss: 2.333 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3612167300380228
model parameter : 768552
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.487414360046387
Epoch: 1, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.406 Vali Acc: 0.270 Test Loss: 1.406 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 3.7109053134918213
Epoch: 2, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.504 Vali Acc: 0.259 Test Loss: 1.504 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9330620765686035
Epoch: 3, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.978 Vali Acc: 0.251 Test Loss: 1.978 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.814236879348755
Epoch: 4, Steps: 17 | Train Loss: 1.628 Vali Loss: 1.489 Vali Acc: 0.274 Test Loss: 1.489 Test Acc: 0.274
Validation loss decreased (-0.269948 --> -0.273749).  Saving model ...
Epoch: 5 cost time: 2.4309234619140625
Epoch: 5, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.612 Vali Acc: 0.247 Test Loss: 1.612 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.786041259765625
Epoch: 6, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.558 Vali Acc: 0.247 Test Loss: 1.558 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9126076698303223
Epoch: 7, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.663 Vali Acc: 0.266 Test Loss: 1.663 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9216134548187256
Epoch: 8, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.507 Vali Acc: 0.281 Test Loss: 1.507 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281354).  Saving model ...
Epoch: 9 cost time: 2.991633892059326
Epoch: 9, Steps: 17 | Train Loss: 1.307 Vali Loss: 2.097 Vali Acc: 0.255 Test Loss: 2.097 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.176656484603882
Epoch: 10, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.481 Vali Acc: 0.281 Test Loss: 1.481 Test Acc: 0.281
Validation loss decreased (-0.281354 --> -0.281354).  Saving model ...
Epoch: 11 cost time: 2.83541202545166
Epoch: 11, Steps: 17 | Train Loss: 1.193 Vali Loss: 1.817 Vali Acc: 0.281 Test Loss: 1.817 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9067578315734863
Epoch: 12, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.833 Vali Acc: 0.247 Test Loss: 1.833 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9294867515563965
Epoch: 13, Steps: 17 | Train Loss: 1.173 Vali Loss: 1.884 Vali Acc: 0.274 Test Loss: 1.884 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.058129072189331
Epoch: 14, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.630 Vali Acc: 0.308 Test Loss: 1.630 Test Acc: 0.308
Validation loss decreased (-0.281354 --> -0.307968).  Saving model ...
Epoch: 15 cost time: 2.709458827972412
Epoch: 15, Steps: 17 | Train Loss: 0.953 Vali Loss: 1.829 Vali Acc: 0.297 Test Loss: 1.829 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.4781932830810547
Epoch: 16, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.830 Vali Acc: 0.266 Test Loss: 1.830 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.7213683128356934
Epoch: 17, Steps: 17 | Train Loss: 0.985 Vali Loss: 1.927 Vali Acc: 0.274 Test Loss: 1.927 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.9257993698120117
Epoch: 18, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.806 Vali Acc: 0.312 Test Loss: 1.806 Test Acc: 0.312
Validation loss decreased (-0.307968 --> -0.311769).  Saving model ...
Epoch: 19 cost time: 3.0664613246917725
Epoch: 19, Steps: 17 | Train Loss: 0.968 Vali Loss: 1.793 Vali Acc: 0.297 Test Loss: 1.793 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.595842123031616
Epoch: 20, Steps: 17 | Train Loss: 0.816 Vali Loss: 1.882 Vali Acc: 0.300 Test Loss: 1.882 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.220224142074585
Epoch: 21, Steps: 17 | Train Loss: 0.802 Vali Loss: 1.996 Vali Acc: 0.316 Test Loss: 1.996 Test Acc: 0.316
Validation loss decreased (-0.311769 --> -0.315569).  Saving model ...
Epoch: 22 cost time: 2.427963972091675
Epoch: 22, Steps: 17 | Train Loss: 0.748 Vali Loss: 2.621 Vali Acc: 0.300 Test Loss: 2.621 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0270779132843018
Epoch: 23, Steps: 17 | Train Loss: 0.760 Vali Loss: 2.091 Vali Acc: 0.319 Test Loss: 2.091 Test Acc: 0.319
Validation loss decreased (-0.315569 --> -0.319371).  Saving model ...
Epoch: 24 cost time: 3.1051363945007324
Epoch: 24, Steps: 17 | Train Loss: 0.718 Vali Loss: 2.049 Vali Acc: 0.350 Test Loss: 2.049 Test Acc: 0.350
Validation loss decreased (-0.319371 --> -0.349789).  Saving model ...
Epoch: 25 cost time: 3.5971932411193848
Epoch: 25, Steps: 17 | Train Loss: 0.726 Vali Loss: 2.190 Vali Acc: 0.308 Test Loss: 2.190 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 3.0950510501861572
Epoch: 26, Steps: 17 | Train Loss: 0.745 Vali Loss: 2.078 Vali Acc: 0.304 Test Loss: 2.078 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 3.1041603088378906
Epoch: 27, Steps: 17 | Train Loss: 0.676 Vali Loss: 2.524 Vali Acc: 0.293 Test Loss: 2.524 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 3.355370044708252
Epoch: 28, Steps: 17 | Train Loss: 0.666 Vali Loss: 2.200 Vali Acc: 0.361 Test Loss: 2.200 Test Acc: 0.361
Validation loss decreased (-0.349789 --> -0.361195).  Saving model ...
Epoch: 29 cost time: 2.6688756942749023
Epoch: 29, Steps: 17 | Train Loss: 0.551 Vali Loss: 2.505 Vali Acc: 0.327 Test Loss: 2.505 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.743119955062866
Epoch: 30, Steps: 17 | Train Loss: 0.555 Vali Loss: 2.400 Vali Acc: 0.319 Test Loss: 2.400 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 3.245464563369751
Epoch: 31, Steps: 17 | Train Loss: 0.519 Vali Loss: 2.252 Vali Acc: 0.316 Test Loss: 2.252 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.9028308391571045
Epoch: 32, Steps: 17 | Train Loss: 0.513 Vali Loss: 2.390 Vali Acc: 0.338 Test Loss: 2.390 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 3.1908605098724365
Epoch: 33, Steps: 17 | Train Loss: 0.445 Vali Loss: 2.675 Vali Acc: 0.331 Test Loss: 2.675 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.8636512756347656
Epoch: 34, Steps: 17 | Train Loss: 0.482 Vali Loss: 2.551 Vali Acc: 0.308 Test Loss: 2.551 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.571953535079956
Epoch: 35, Steps: 17 | Train Loss: 0.519 Vali Loss: 2.798 Vali Acc: 0.319 Test Loss: 2.798 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 2.6705880165100098
Epoch: 36, Steps: 17 | Train Loss: 0.409 Vali Loss: 2.742 Vali Acc: 0.327 Test Loss: 2.742 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 2.9615702629089355
Epoch: 37, Steps: 17 | Train Loss: 0.356 Vali Loss: 2.652 Vali Acc: 0.323 Test Loss: 2.652 Test Acc: 0.323
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 3.297438859939575
Epoch: 38, Steps: 17 | Train Loss: 0.357 Vali Loss: 2.838 Vali Acc: 0.357 Test Loss: 2.838 Test Acc: 0.357
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3612167300380228
model parameter : 645480
model size : 3.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.963485479354858
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.434 Vali Acc: 0.262 Test Loss: 1.434 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 3.3463246822357178
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.396 Vali Acc: 0.270 Test Loss: 1.396 Test Acc: 0.270
Validation loss decreased (-0.262343 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 3.0626964569091797
Epoch: 3, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.394 Vali Acc: 0.270 Test Loss: 1.394 Test Acc: 0.270
Validation loss decreased (-0.269948 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 2.8650259971618652
Epoch: 4, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.566 Vali Acc: 0.278 Test Loss: 1.566 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277551).  Saving model ...
Epoch: 5 cost time: 2.4609875679016113
Epoch: 5, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.964 Vali Acc: 0.251 Test Loss: 1.964 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.260632038116455
Epoch: 6, Steps: 17 | Train Loss: 1.740 Vali Loss: 2.106 Vali Acc: 0.251 Test Loss: 2.106 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2819747924804688
Epoch: 7, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.892 Vali Acc: 0.255 Test Loss: 1.892 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.9702811241149902
Epoch: 8, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.412 Vali Acc: 0.278 Test Loss: 1.412 Test Acc: 0.278
Validation loss decreased (-0.277551 --> -0.277552).  Saving model ...
Epoch: 9 cost time: 2.683300256729126
Epoch: 9, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.904 Vali Acc: 0.240 Test Loss: 1.904 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1603283882141113
Epoch: 10, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.492 Vali Acc: 0.293 Test Loss: 1.492 Test Acc: 0.293
Validation loss decreased (-0.277552 --> -0.292761).  Saving model ...
Epoch: 11 cost time: 3.4022340774536133
Epoch: 11, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.541 Vali Acc: 0.297 Test Loss: 1.541 Test Acc: 0.297
Validation loss decreased (-0.292761 --> -0.296563).  Saving model ...
Epoch: 12 cost time: 2.441657543182373
Epoch: 12, Steps: 17 | Train Loss: 1.157 Vali Loss: 1.589 Vali Acc: 0.281 Test Loss: 1.589 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.757533311843872
Epoch: 13, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.743 Vali Acc: 0.262 Test Loss: 1.743 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.381396055221558
Epoch: 14, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.819 Vali Acc: 0.285 Test Loss: 1.819 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.5199131965637207
Epoch: 15, Steps: 17 | Train Loss: 1.034 Vali Loss: 1.650 Vali Acc: 0.331 Test Loss: 1.650 Test Acc: 0.331
Validation loss decreased (-0.296563 --> -0.330782).  Saving model ...
Epoch: 16 cost time: 2.858304262161255
Epoch: 16, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.669 Vali Acc: 0.304 Test Loss: 1.669 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.433547258377075
Epoch: 17, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.761 Vali Acc: 0.319 Test Loss: 1.761 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.194279670715332
Epoch: 18, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.760 Vali Acc: 0.293 Test Loss: 1.760 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.2535548210144043
Epoch: 19, Steps: 17 | Train Loss: 0.882 Vali Loss: 1.887 Vali Acc: 0.297 Test Loss: 1.887 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1261305809020996
Epoch: 20, Steps: 17 | Train Loss: 0.888 Vali Loss: 1.822 Vali Acc: 0.319 Test Loss: 1.822 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7929396629333496
Epoch: 21, Steps: 17 | Train Loss: 0.866 Vali Loss: 2.040 Vali Acc: 0.323 Test Loss: 2.040 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.022225856781006
Epoch: 22, Steps: 17 | Train Loss: 0.841 Vali Loss: 2.073 Vali Acc: 0.297 Test Loss: 2.073 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.711078405380249
Epoch: 23, Steps: 17 | Train Loss: 0.735 Vali Loss: 2.102 Vali Acc: 0.285 Test Loss: 2.102 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.8972716331481934
Epoch: 24, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.041 Vali Acc: 0.289 Test Loss: 2.041 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.18942928314209
Epoch: 25, Steps: 17 | Train Loss: 0.776 Vali Loss: 1.978 Vali Acc: 0.304 Test Loss: 1.978 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33079847908745247
model parameter : 631464
model size : 3.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.371539115905762
Epoch: 1, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.525 Vali Acc: 0.270 Test Loss: 1.525 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 2.5772042274475098
Epoch: 2, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.424 Vali Acc: 0.278 Test Loss: 1.424 Test Acc: 0.278
Validation loss decreased (-0.269947 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 2.5754141807556152
Epoch: 3, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.423 Vali Acc: 0.300 Test Loss: 1.423 Test Acc: 0.300
Validation loss decreased (-0.277552 --> -0.300366).  Saving model ...
Epoch: 4 cost time: 2.7283928394317627
Epoch: 4, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.421 Vali Acc: 0.289 Test Loss: 1.421 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.86020827293396
Epoch: 5, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.577 Vali Acc: 0.255 Test Loss: 1.577 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.698430299758911
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.509 Vali Acc: 0.274 Test Loss: 1.509 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.900221109390259
Epoch: 7, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.547 Vali Acc: 0.262 Test Loss: 1.547 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.83160662651062
Epoch: 8, Steps: 17 | Train Loss: 1.401 Vali Loss: 1.717 Vali Acc: 0.255 Test Loss: 1.717 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.4322493076324463
Epoch: 9, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.552 Vali Acc: 0.312 Test Loss: 1.552 Test Acc: 0.312
Validation loss decreased (-0.300366 --> -0.311772).  Saving model ...
Epoch: 10 cost time: 3.3895792961120605
Epoch: 10, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.540 Vali Acc: 0.262 Test Loss: 1.540 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4597411155700684
Epoch: 11, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.973 Vali Acc: 0.278 Test Loss: 1.973 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.32620906829834
Epoch: 12, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.699 Vali Acc: 0.259 Test Loss: 1.699 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6446337699890137
Epoch: 13, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.744 Vali Acc: 0.285 Test Loss: 1.744 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.528646945953369
Epoch: 14, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.715 Vali Acc: 0.293 Test Loss: 1.715 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.9848604202270508
Epoch: 15, Steps: 17 | Train Loss: 1.200 Vali Loss: 1.685 Vali Acc: 0.293 Test Loss: 1.685 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.002406120300293
Epoch: 16, Steps: 17 | Train Loss: 1.180 Vali Loss: 1.785 Vali Acc: 0.293 Test Loss: 1.785 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.925251007080078
Epoch: 17, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.805 Vali Acc: 0.297 Test Loss: 1.805 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.7178142070770264
Epoch: 18, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.819 Vali Acc: 0.278 Test Loss: 1.819 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.9349231719970703
Epoch: 19, Steps: 17 | Train Loss: 0.937 Vali Loss: 1.874 Vali Acc: 0.304 Test Loss: 1.874 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 617448
model size : 3.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.563915491104126
Epoch: 1, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.404 Vali Acc: 0.274 Test Loss: 1.404 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 2.794645309448242
Epoch: 2, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.431 Vali Acc: 0.266 Test Loss: 1.431 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.860603094100952
Epoch: 3, Steps: 17 | Train Loss: 1.510 Vali Loss: 2.156 Vali Acc: 0.247 Test Loss: 2.156 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.0257811546325684
Epoch: 4, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.547 Vali Acc: 0.289 Test Loss: 1.547 Test Acc: 0.289
Validation loss decreased (-0.273750 --> -0.288958).  Saving model ...
Epoch: 5 cost time: 2.197038412094116
Epoch: 5, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.512 Vali Acc: 0.255 Test Loss: 1.512 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.463205575942993
Epoch: 6, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.565 Vali Acc: 0.240 Test Loss: 1.565 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.5220987796783447
Epoch: 7, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.556 Vali Acc: 0.262 Test Loss: 1.556 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.321321725845337
Epoch: 8, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.584 Vali Acc: 0.274 Test Loss: 1.584 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5120160579681396
Epoch: 9, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.794 Vali Acc: 0.259 Test Loss: 1.794 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.79522967338562
Epoch: 10, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.494 Vali Acc: 0.251 Test Loss: 1.494 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.3981711864471436
Epoch: 11, Steps: 17 | Train Loss: 1.239 Vali Loss: 1.685 Vali Acc: 0.274 Test Loss: 1.685 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.9399285316467285
Epoch: 12, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.615 Vali Acc: 0.289 Test Loss: 1.615 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.2646243572235107
Epoch: 13, Steps: 17 | Train Loss: 1.043 Vali Loss: 1.636 Vali Acc: 0.289 Test Loss: 1.636 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.411911725997925
Epoch: 14, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.758 Vali Acc: 0.308 Test Loss: 1.758 Test Acc: 0.308
Validation loss decreased (-0.288958 --> -0.307967).  Saving model ...
Epoch: 15 cost time: 2.2696919441223145
Epoch: 15, Steps: 17 | Train Loss: 1.123 Vali Loss: 2.056 Vali Acc: 0.285 Test Loss: 2.056 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.556734323501587
Epoch: 16, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.844 Vali Acc: 0.312 Test Loss: 1.844 Test Acc: 0.312
Validation loss decreased (-0.307967 --> -0.311769).  Saving model ...
Epoch: 17 cost time: 2.655123710632324
Epoch: 17, Steps: 17 | Train Loss: 0.991 Vali Loss: 1.867 Vali Acc: 0.281 Test Loss: 1.867 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.1918368339538574
Epoch: 18, Steps: 17 | Train Loss: 0.905 Vali Loss: 1.895 Vali Acc: 0.285 Test Loss: 1.895 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.6905317306518555
Epoch: 19, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.937 Vali Acc: 0.319 Test Loss: 1.937 Test Acc: 0.319
Validation loss decreased (-0.311769 --> -0.319372).  Saving model ...
Epoch: 20 cost time: 2.448242664337158
Epoch: 20, Steps: 17 | Train Loss: 0.852 Vali Loss: 1.875 Vali Acc: 0.342 Test Loss: 1.875 Test Acc: 0.342
Validation loss decreased (-0.319372 --> -0.342187).  Saving model ...
Epoch: 21 cost time: 2.0363097190856934
Epoch: 21, Steps: 17 | Train Loss: 0.906 Vali Loss: 1.977 Vali Acc: 0.327 Test Loss: 1.977 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.9062283039093018
Epoch: 22, Steps: 17 | Train Loss: 0.805 Vali Loss: 1.887 Vali Acc: 0.346 Test Loss: 1.887 Test Acc: 0.346
Validation loss decreased (-0.342187 --> -0.345989).  Saving model ...
Epoch: 23 cost time: 2.5138015747070312
Epoch: 23, Steps: 17 | Train Loss: 0.774 Vali Loss: 1.884 Vali Acc: 0.335 Test Loss: 1.884 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.995192766189575
Epoch: 24, Steps: 17 | Train Loss: 0.682 Vali Loss: 2.594 Vali Acc: 0.293 Test Loss: 2.594 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.0392112731933594
Epoch: 25, Steps: 17 | Train Loss: 0.812 Vali Loss: 2.227 Vali Acc: 0.319 Test Loss: 2.227 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.157623529434204
Epoch: 26, Steps: 17 | Train Loss: 0.772 Vali Loss: 2.321 Vali Acc: 0.338 Test Loss: 2.321 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5419507026672363
Epoch: 27, Steps: 17 | Train Loss: 0.763 Vali Loss: 2.343 Vali Acc: 0.300 Test Loss: 2.343 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.727660655975342
Epoch: 28, Steps: 17 | Train Loss: 0.534 Vali Loss: 2.225 Vali Acc: 0.327 Test Loss: 2.225 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.719512462615967
Epoch: 29, Steps: 17 | Train Loss: 0.510 Vali Loss: 2.238 Vali Acc: 0.335 Test Loss: 2.238 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.7832729816436768
Epoch: 30, Steps: 17 | Train Loss: 0.536 Vali Loss: 2.408 Vali Acc: 0.335 Test Loss: 2.408 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.188703775405884
Epoch: 31, Steps: 17 | Train Loss: 0.456 Vali Loss: 2.399 Vali Acc: 0.354 Test Loss: 2.399 Test Acc: 0.354
Validation loss decreased (-0.345989 --> -0.353588).  Saving model ...
Epoch: 32 cost time: 3.2405245304107666
Epoch: 32, Steps: 17 | Train Loss: 0.455 Vali Loss: 2.309 Vali Acc: 0.308 Test Loss: 2.309 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.408024787902832
Epoch: 33, Steps: 17 | Train Loss: 0.363 Vali Loss: 2.486 Vali Acc: 0.361 Test Loss: 2.486 Test Acc: 0.361
Validation loss decreased (-0.353588 --> -0.361192).  Saving model ...
Epoch: 34 cost time: 2.2168943881988525
Epoch: 34, Steps: 17 | Train Loss: 0.451 Vali Loss: 2.717 Vali Acc: 0.323 Test Loss: 2.717 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.219538450241089
Epoch: 35, Steps: 17 | Train Loss: 0.460 Vali Loss: 2.824 Vali Acc: 0.300 Test Loss: 2.824 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.9136807918548584
Epoch: 36, Steps: 17 | Train Loss: 0.439 Vali Loss: 2.696 Vali Acc: 0.327 Test Loss: 2.696 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.2288856506347656
Epoch: 37, Steps: 17 | Train Loss: 0.326 Vali Loss: 2.785 Vali Acc: 0.331 Test Loss: 2.785 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.5517754554748535
Epoch: 38, Steps: 17 | Train Loss: 0.291 Vali Loss: 2.997 Vali Acc: 0.312 Test Loss: 2.997 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.9096388816833496
Epoch: 39, Steps: 17 | Train Loss: 0.317 Vali Loss: 2.937 Vali Acc: 0.342 Test Loss: 2.937 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.7148735523223877
Epoch: 40, Steps: 17 | Train Loss: 0.205 Vali Loss: 3.163 Vali Acc: 0.316 Test Loss: 3.163 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.9264864921569824
Epoch: 41, Steps: 17 | Train Loss: 0.334 Vali Loss: 3.064 Vali Acc: 0.308 Test Loss: 3.064 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 2.7739179134368896
Epoch: 42, Steps: 17 | Train Loss: 0.276 Vali Loss: 3.784 Vali Acc: 0.323 Test Loss: 3.784 Test Acc: 0.323
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 2.5128977298736572
Epoch: 43, Steps: 17 | Train Loss: 0.293 Vali Loss: 3.073 Vali Acc: 0.327 Test Loss: 3.073 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3612167300380228
model parameter : 603432
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 5.135071039199829
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.501 Vali Acc: 0.247 Test Loss: 1.501 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 3.0637457370758057
Epoch: 2, Steps: 17 | Train Loss: 1.509 Vali Loss: 1.442 Vali Acc: 0.297 Test Loss: 1.442 Test Acc: 0.297
Validation loss decreased (-0.247133 --> -0.296564).  Saving model ...
Epoch: 3 cost time: 2.94625186920166
Epoch: 3, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.527 Vali Acc: 0.262 Test Loss: 1.527 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8324453830718994
Epoch: 4, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.589 Vali Acc: 0.251 Test Loss: 1.589 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.7638471126556396
Epoch: 5, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.497 Vali Acc: 0.289 Test Loss: 1.497 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.260948657989502
Epoch: 6, Steps: 17 | Train Loss: 1.539 Vali Loss: 2.016 Vali Acc: 0.270 Test Loss: 2.016 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.3709468841552734
Epoch: 7, Steps: 17 | Train Loss: 1.595 Vali Loss: 1.562 Vali Acc: 0.266 Test Loss: 1.562 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.618511438369751
Epoch: 8, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.796 Vali Acc: 0.259 Test Loss: 1.796 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.9030697345733643
Epoch: 9, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.833 Vali Acc: 0.243 Test Loss: 1.833 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.765202045440674
Epoch: 10, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.759 Vali Acc: 0.266 Test Loss: 1.759 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 3.091214418411255
Epoch: 11, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.735 Vali Acc: 0.285 Test Loss: 1.735 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 3.8399336338043213
Epoch: 12, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.912 Vali Acc: 0.251 Test Loss: 1.912 Test Acc: 0.251
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 562920
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.627058744430542
Epoch: 1, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.480 Vali Acc: 0.247 Test Loss: 1.480 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 3.02009916305542
Epoch: 2, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.461 Vali Acc: 0.243 Test Loss: 1.461 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.2344470024108887
Epoch: 3, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.514 Vali Acc: 0.278 Test Loss: 1.514 Test Acc: 0.278
Validation loss decreased (-0.247133 --> -0.277551).  Saving model ...
Epoch: 4 cost time: 2.8136990070343018
Epoch: 4, Steps: 17 | Train Loss: 1.613 Vali Loss: 1.587 Vali Acc: 0.266 Test Loss: 1.587 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6533286571502686
Epoch: 5, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.438 Vali Acc: 0.297 Test Loss: 1.438 Test Acc: 0.297
Validation loss decreased (-0.277551 --> -0.296564).  Saving model ...
Epoch: 6 cost time: 2.886918544769287
Epoch: 6, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.828 Vali Acc: 0.251 Test Loss: 1.828 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6984682083129883
Epoch: 7, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.810 Vali Acc: 0.270 Test Loss: 1.810 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1525003910064697
Epoch: 8, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.481 Vali Acc: 0.278 Test Loss: 1.481 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.98572039604187
Epoch: 9, Steps: 17 | Train Loss: 1.308 Vali Loss: 1.583 Vali Acc: 0.278 Test Loss: 1.583 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.3225865364074707
Epoch: 10, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.865 Vali Acc: 0.259 Test Loss: 1.865 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.940636157989502
Epoch: 11, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.810 Vali Acc: 0.270 Test Loss: 1.810 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.348165512084961
Epoch: 12, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.586 Vali Acc: 0.274 Test Loss: 1.586 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.551917552947998
Epoch: 13, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.713 Vali Acc: 0.297 Test Loss: 1.713 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.6825578212738037
Epoch: 14, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.768 Vali Acc: 0.278 Test Loss: 1.768 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.801640510559082
Epoch: 15, Steps: 17 | Train Loss: 1.038 Vali Loss: 1.774 Vali Acc: 0.289 Test Loss: 1.774 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 548904
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.249895334243774
Epoch: 1, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.409 Vali Acc: 0.236 Test Loss: 1.409 Test Acc: 0.236
Validation loss decreased (inf --> -0.235727).  Saving model ...
Epoch: 2 cost time: 2.666452169418335
Epoch: 2, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.584 Vali Acc: 0.228 Test Loss: 1.584 Test Acc: 0.228
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4259467124938965
Epoch: 3, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.473 Vali Acc: 0.243 Test Loss: 1.473 Test Acc: 0.243
Validation loss decreased (-0.235727 --> -0.243331).  Saving model ...
Epoch: 4 cost time: 2.24696946144104
Epoch: 4, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.401 Vali Acc: 0.251 Test Loss: 1.401 Test Acc: 0.251
Validation loss decreased (-0.243331 --> -0.250937).  Saving model ...
Epoch: 5 cost time: 2.9560999870300293
Epoch: 5, Steps: 17 | Train Loss: 1.375 Vali Loss: 1.439 Vali Acc: 0.243 Test Loss: 1.439 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.749993324279785
Epoch: 6, Steps: 17 | Train Loss: 1.320 Vali Loss: 1.645 Vali Acc: 0.266 Test Loss: 1.645 Test Acc: 0.266
Validation loss decreased (-0.250937 --> -0.266143).  Saving model ...
Epoch: 7 cost time: 3.1488497257232666
Epoch: 7, Steps: 17 | Train Loss: 1.295 Vali Loss: 1.666 Vali Acc: 0.289 Test Loss: 1.666 Test Acc: 0.289
Validation loss decreased (-0.266143 --> -0.288957).  Saving model ...
Epoch: 8 cost time: 3.223618268966675
Epoch: 8, Steps: 17 | Train Loss: 1.323 Vali Loss: 1.691 Vali Acc: 0.281 Test Loss: 1.691 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.773374080657959
Epoch: 9, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.588 Vali Acc: 0.293 Test Loss: 1.588 Test Acc: 0.293
Validation loss decreased (-0.288957 --> -0.292760).  Saving model ...
Epoch: 10 cost time: 3.057878255844116
Epoch: 10, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.778 Vali Acc: 0.274 Test Loss: 1.778 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2897520065307617
Epoch: 11, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.580 Vali Acc: 0.300 Test Loss: 1.580 Test Acc: 0.300
Validation loss decreased (-0.292760 --> -0.300364).  Saving model ...
Epoch: 12 cost time: 3.1778628826141357
Epoch: 12, Steps: 17 | Train Loss: 1.037 Vali Loss: 1.670 Vali Acc: 0.274 Test Loss: 1.670 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2096455097198486
Epoch: 13, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.808 Vali Acc: 0.293 Test Loss: 1.808 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8558666706085205
Epoch: 14, Steps: 17 | Train Loss: 1.130 Vali Loss: 2.445 Vali Acc: 0.255 Test Loss: 2.445 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.393507957458496
Epoch: 15, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.859 Vali Acc: 0.274 Test Loss: 1.859 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.926697015762329
Epoch: 16, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.983 Vali Acc: 0.274 Test Loss: 1.983 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.8820362091064453
Epoch: 17, Steps: 17 | Train Loss: 0.984 Vali Loss: 2.033 Vali Acc: 0.270 Test Loss: 2.033 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.827406406402588
Epoch: 18, Steps: 17 | Train Loss: 0.997 Vali Loss: 1.800 Vali Acc: 0.293 Test Loss: 1.800 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.1142289638519287
Epoch: 19, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.853 Vali Acc: 0.312 Test Loss: 1.853 Test Acc: 0.312
Validation loss decreased (-0.300364 --> -0.311769).  Saving model ...
Epoch: 20 cost time: 2.7160162925720215
Epoch: 20, Steps: 17 | Train Loss: 0.876 Vali Loss: 1.876 Vali Acc: 0.354 Test Loss: 1.876 Test Acc: 0.354
Validation loss decreased (-0.311769 --> -0.353593).  Saving model ...
Epoch: 21 cost time: 2.4307634830474854
Epoch: 21, Steps: 17 | Train Loss: 0.943 Vali Loss: 2.112 Vali Acc: 0.335 Test Loss: 2.112 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6110212802886963
Epoch: 22, Steps: 17 | Train Loss: 0.910 Vali Loss: 2.070 Vali Acc: 0.327 Test Loss: 2.070 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8802099227905273
Epoch: 23, Steps: 17 | Train Loss: 0.773 Vali Loss: 2.196 Vali Acc: 0.331 Test Loss: 2.196 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.258115530014038
Epoch: 24, Steps: 17 | Train Loss: 0.712 Vali Loss: 2.146 Vali Acc: 0.335 Test Loss: 2.146 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.455501079559326
Epoch: 25, Steps: 17 | Train Loss: 0.652 Vali Loss: 2.235 Vali Acc: 0.293 Test Loss: 2.235 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.7831127643585205
Epoch: 26, Steps: 17 | Train Loss: 0.796 Vali Loss: 2.271 Vali Acc: 0.327 Test Loss: 2.271 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.324720859527588
Epoch: 27, Steps: 17 | Train Loss: 0.558 Vali Loss: 2.357 Vali Acc: 0.342 Test Loss: 2.357 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.7300186157226562
Epoch: 28, Steps: 17 | Train Loss: 0.610 Vali Loss: 2.125 Vali Acc: 0.335 Test Loss: 2.125 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.1111936569213867
Epoch: 29, Steps: 17 | Train Loss: 0.544 Vali Loss: 2.295 Vali Acc: 0.312 Test Loss: 2.295 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.0757782459259033
Epoch: 30, Steps: 17 | Train Loss: 0.532 Vali Loss: 2.791 Vali Acc: 0.338 Test Loss: 2.791 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.35361216730038025
model parameter : 534888
model size : 3.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.424498558044434
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.415 Vali Acc: 0.228 Test Loss: 1.415 Test Acc: 0.228
Validation loss decreased (inf --> -0.228123).  Saving model ...
Epoch: 2 cost time: 2.160534381866455
Epoch: 2, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.467 Vali Acc: 0.270 Test Loss: 1.467 Test Acc: 0.270
Validation loss decreased (-0.228123 --> -0.269947).  Saving model ...
Epoch: 3 cost time: 2.757103204727173
Epoch: 3, Steps: 17 | Train Loss: 1.548 Vali Loss: 1.442 Vali Acc: 0.270 Test Loss: 1.442 Test Acc: 0.270
Validation loss decreased (-0.269947 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 1.904874563217163
Epoch: 4, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.738 Vali Acc: 0.251 Test Loss: 1.738 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7528421878814697
Epoch: 5, Steps: 17 | Train Loss: 1.598 Vali Loss: 2.022 Vali Acc: 0.251 Test Loss: 2.022 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4597504138946533
Epoch: 6, Steps: 17 | Train Loss: 1.639 Vali Loss: 1.594 Vali Acc: 0.251 Test Loss: 1.594 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1951584815979004
Epoch: 7, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.417 Vali Acc: 0.285 Test Loss: 1.417 Test Acc: 0.285
Validation loss decreased (-0.269948 --> -0.285157).  Saving model ...
Epoch: 8 cost time: 2.3568267822265625
Epoch: 8, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.951 Vali Acc: 0.251 Test Loss: 1.951 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3576579093933105
Epoch: 9, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.668 Vali Acc: 0.278 Test Loss: 1.668 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2377700805664062
Epoch: 10, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.700 Vali Acc: 0.293 Test Loss: 1.700 Test Acc: 0.293
Validation loss decreased (-0.285157 --> -0.292759).  Saving model ...
Epoch: 11 cost time: 2.6243035793304443
Epoch: 11, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.703 Vali Acc: 0.247 Test Loss: 1.703 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7516860961914062
Epoch: 12, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.507 Vali Acc: 0.285 Test Loss: 1.507 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5749683380126953
Epoch: 13, Steps: 17 | Train Loss: 1.162 Vali Loss: 1.919 Vali Acc: 0.228 Test Loss: 1.919 Test Acc: 0.228
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8382198810577393
Epoch: 14, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.784 Vali Acc: 0.266 Test Loss: 1.784 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5412092208862305
Epoch: 15, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.623 Vali Acc: 0.281 Test Loss: 1.623 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.59906005859375
Epoch: 16, Steps: 17 | Train Loss: 1.030 Vali Loss: 2.172 Vali Acc: 0.255 Test Loss: 2.172 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.594033718109131
Epoch: 17, Steps: 17 | Train Loss: 1.082 Vali Loss: 1.693 Vali Acc: 0.312 Test Loss: 1.693 Test Acc: 0.312
Validation loss decreased (-0.292759 --> -0.311770).  Saving model ...
Epoch: 18 cost time: 2.372898578643799
Epoch: 18, Steps: 17 | Train Loss: 0.899 Vali Loss: 1.777 Vali Acc: 0.293 Test Loss: 1.777 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3829829692840576
Epoch: 19, Steps: 17 | Train Loss: 0.838 Vali Loss: 1.748 Vali Acc: 0.319 Test Loss: 1.748 Test Acc: 0.319
Validation loss decreased (-0.311770 --> -0.319374).  Saving model ...
Epoch: 20 cost time: 2.365964651107788
Epoch: 20, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.940 Vali Acc: 0.350 Test Loss: 1.940 Test Acc: 0.350
Validation loss decreased (-0.319374 --> -0.349790).  Saving model ...
Epoch: 21 cost time: 2.4336302280426025
Epoch: 21, Steps: 17 | Train Loss: 0.792 Vali Loss: 1.866 Vali Acc: 0.300 Test Loss: 1.866 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.3303704261779785
Epoch: 22, Steps: 17 | Train Loss: 0.901 Vali Loss: 1.812 Vali Acc: 0.327 Test Loss: 1.812 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.5228545665740967
Epoch: 23, Steps: 17 | Train Loss: 0.678 Vali Loss: 1.879 Vali Acc: 0.331 Test Loss: 1.879 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.6323766708374023
Epoch: 24, Steps: 17 | Train Loss: 0.667 Vali Loss: 2.233 Vali Acc: 0.323 Test Loss: 2.233 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.98319411277771
Epoch: 25, Steps: 17 | Train Loss: 0.672 Vali Loss: 2.232 Vali Acc: 0.323 Test Loss: 2.232 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.333195209503174
Epoch: 26, Steps: 17 | Train Loss: 0.708 Vali Loss: 2.055 Vali Acc: 0.338 Test Loss: 2.055 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.752387285232544
Epoch: 27, Steps: 17 | Train Loss: 0.667 Vali Loss: 2.378 Vali Acc: 0.350 Test Loss: 2.378 Test Acc: 0.350
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.1262640953063965
Epoch: 28, Steps: 17 | Train Loss: 0.610 Vali Loss: 2.424 Vali Acc: 0.327 Test Loss: 2.424 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.8219680786132812
Epoch: 29, Steps: 17 | Train Loss: 0.604 Vali Loss: 2.285 Vali Acc: 0.350 Test Loss: 2.285 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.3769071102142334
Epoch: 30, Steps: 17 | Train Loss: 0.485 Vali Loss: 2.340 Vali Acc: 0.335 Test Loss: 2.340 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34980988593155893
model parameter : 520872
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.55792760848999
Epoch: 1, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.465 Vali Acc: 0.251 Test Loss: 1.465 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 2.2956037521362305
Epoch: 2, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.440 Vali Acc: 0.274 Test Loss: 1.440 Test Acc: 0.274
Validation loss decreased (-0.250936 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 2.424801826477051
Epoch: 3, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.496 Vali Acc: 0.259 Test Loss: 1.496 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.6077747344970703
Epoch: 4, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.549 Vali Acc: 0.270 Test Loss: 1.549 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6044392585754395
Epoch: 5, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.403 Vali Acc: 0.270 Test Loss: 1.403 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.255828380584717
Epoch: 6, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.431 Vali Acc: 0.270 Test Loss: 1.431 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.214350700378418
Epoch: 7, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.520 Vali Acc: 0.285 Test Loss: 1.520 Test Acc: 0.285
Validation loss decreased (-0.273750 --> -0.285156).  Saving model ...
Epoch: 8 cost time: 2.2377429008483887
Epoch: 8, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.546 Vali Acc: 0.259 Test Loss: 1.546 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.3610525131225586
Epoch: 9, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.802 Vali Acc: 0.281 Test Loss: 1.802 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.45563006401062
Epoch: 10, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.580 Vali Acc: 0.297 Test Loss: 1.580 Test Acc: 0.297
Validation loss decreased (-0.285156 --> -0.296562).  Saving model ...
Epoch: 11 cost time: 1.8268673419952393
Epoch: 11, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.468 Vali Acc: 0.300 Test Loss: 1.468 Test Acc: 0.300
Validation loss decreased (-0.296562 --> -0.300366).  Saving model ...
Epoch: 12 cost time: 2.892551898956299
Epoch: 12, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.584 Vali Acc: 0.285 Test Loss: 1.584 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7797369956970215
Epoch: 13, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.805 Vali Acc: 0.274 Test Loss: 1.805 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.75388503074646
Epoch: 14, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.617 Vali Acc: 0.285 Test Loss: 1.617 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0807430744171143
Epoch: 15, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.744 Vali Acc: 0.274 Test Loss: 1.744 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4319663047790527
Epoch: 16, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.776 Vali Acc: 0.293 Test Loss: 1.776 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.9430344104766846
Epoch: 17, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.620 Vali Acc: 0.304 Test Loss: 1.620 Test Acc: 0.304
Validation loss decreased (-0.300366 --> -0.304166).  Saving model ...
Epoch: 18 cost time: 2.29600191116333
Epoch: 18, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.583 Vali Acc: 0.319 Test Loss: 1.583 Test Acc: 0.319
Validation loss decreased (-0.304166 --> -0.319376).  Saving model ...
Epoch: 19 cost time: 2.3342478275299072
Epoch: 19, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.648 Vali Acc: 0.289 Test Loss: 1.648 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.0239615440368652
Epoch: 20, Steps: 17 | Train Loss: 0.886 Vali Loss: 1.874 Vali Acc: 0.308 Test Loss: 1.874 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2467193603515625
Epoch: 21, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.811 Vali Acc: 0.300 Test Loss: 1.811 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0812854766845703
Epoch: 22, Steps: 17 | Train Loss: 0.794 Vali Loss: 1.774 Vali Acc: 0.338 Test Loss: 1.774 Test Acc: 0.338
Validation loss decreased (-0.319376 --> -0.338385).  Saving model ...
Epoch: 23 cost time: 2.1106765270233154
Epoch: 23, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.854 Vali Acc: 0.323 Test Loss: 1.854 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.4624130725860596
Epoch: 24, Steps: 17 | Train Loss: 0.771 Vali Loss: 1.795 Vali Acc: 0.373 Test Loss: 1.795 Test Acc: 0.373
Validation loss decreased (-0.338385 --> -0.372606).  Saving model ...
Epoch: 25 cost time: 2.6423351764678955
Epoch: 25, Steps: 17 | Train Loss: 0.733 Vali Loss: 1.941 Vali Acc: 0.335 Test Loss: 1.941 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.9673585891723633
Epoch: 26, Steps: 17 | Train Loss: 0.677 Vali Loss: 1.830 Vali Acc: 0.323 Test Loss: 1.830 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.642703056335449
Epoch: 27, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.287 Vali Acc: 0.289 Test Loss: 2.287 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.320490837097168
Epoch: 28, Steps: 17 | Train Loss: 0.687 Vali Loss: 1.904 Vali Acc: 0.335 Test Loss: 1.904 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.273796558380127
Epoch: 29, Steps: 17 | Train Loss: 0.517 Vali Loss: 2.005 Vali Acc: 0.323 Test Loss: 2.005 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.8018405437469482
Epoch: 30, Steps: 17 | Train Loss: 0.482 Vali Loss: 2.026 Vali Acc: 0.323 Test Loss: 2.026 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.7141153812408447
Epoch: 31, Steps: 17 | Train Loss: 0.549 Vali Loss: 2.023 Vali Acc: 0.335 Test Loss: 2.023 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.2470874786376953
Epoch: 32, Steps: 17 | Train Loss: 0.482 Vali Loss: 1.985 Vali Acc: 0.354 Test Loss: 1.985 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.7469866275787354
Epoch: 33, Steps: 17 | Train Loss: 0.359 Vali Loss: 2.056 Vali Acc: 0.354 Test Loss: 2.056 Test Acc: 0.354
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.3774757385253906
Epoch: 34, Steps: 17 | Train Loss: 0.406 Vali Loss: 2.125 Vali Acc: 0.361 Test Loss: 2.125 Test Acc: 0.361
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3726235741444867
model parameter : 491080
model size : 2.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.804471969604492
Epoch: 1, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.433 Vali Acc: 0.262 Test Loss: 1.433 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 2.193371534347534
Epoch: 2, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.435 Vali Acc: 0.259 Test Loss: 1.435 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.4394328594207764
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.416 Vali Acc: 0.259 Test Loss: 1.416 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2765419483184814
Epoch: 4, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.413 Vali Acc: 0.240 Test Loss: 1.413 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.5187859535217285
Epoch: 5, Steps: 17 | Train Loss: 1.541 Vali Loss: 1.506 Vali Acc: 0.247 Test Loss: 1.506 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.9143481254577637
Epoch: 6, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.578 Vali Acc: 0.240 Test Loss: 1.578 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.34403920173645
Epoch: 7, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.488 Vali Acc: 0.285 Test Loss: 1.488 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285156).  Saving model ...
Epoch: 8 cost time: 2.2649970054626465
Epoch: 8, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.429 Vali Acc: 0.312 Test Loss: 1.429 Test Acc: 0.312
Validation loss decreased (-0.285156 --> -0.311773).  Saving model ...
Epoch: 9 cost time: 2.2652134895324707
Epoch: 9, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.634 Vali Acc: 0.240 Test Loss: 1.634 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4277150630950928
Epoch: 10, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.611 Vali Acc: 0.262 Test Loss: 1.611 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4674222469329834
Epoch: 11, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.496 Vali Acc: 0.278 Test Loss: 1.496 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6432433128356934
Epoch: 12, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.667 Vali Acc: 0.262 Test Loss: 1.667 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6352474689483643
Epoch: 13, Steps: 17 | Train Loss: 1.185 Vali Loss: 1.766 Vali Acc: 0.251 Test Loss: 1.766 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.863016366958618
Epoch: 14, Steps: 17 | Train Loss: 1.179 Vali Loss: 1.493 Vali Acc: 0.297 Test Loss: 1.493 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.905867576599121
Epoch: 15, Steps: 17 | Train Loss: 1.103 Vali Loss: 1.530 Vali Acc: 0.308 Test Loss: 1.530 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5277676582336426
Epoch: 16, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.603 Vali Acc: 0.281 Test Loss: 1.603 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.4311745166778564
Epoch: 17, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.892 Vali Acc: 0.308 Test Loss: 1.892 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.2506415843963623
Epoch: 18, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.734 Vali Acc: 0.316 Test Loss: 1.734 Test Acc: 0.316
Validation loss decreased (-0.311773 --> -0.315572).  Saving model ...
Epoch: 19 cost time: 2.1058061122894287
Epoch: 19, Steps: 17 | Train Loss: 0.984 Vali Loss: 1.593 Vali Acc: 0.323 Test Loss: 1.593 Test Acc: 0.323
Validation loss decreased (-0.315572 --> -0.323178).  Saving model ...
Epoch: 20 cost time: 2.2568769454956055
Epoch: 20, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.689 Vali Acc: 0.319 Test Loss: 1.689 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.3018949031829834
Epoch: 21, Steps: 17 | Train Loss: 0.773 Vali Loss: 1.751 Vali Acc: 0.346 Test Loss: 1.751 Test Acc: 0.346
Validation loss decreased (-0.323178 --> -0.345990).  Saving model ...
Epoch: 22 cost time: 2.2213754653930664
Epoch: 22, Steps: 17 | Train Loss: 0.785 Vali Loss: 1.760 Vali Acc: 0.365 Test Loss: 1.760 Test Acc: 0.365
Validation loss decreased (-0.345990 --> -0.365001).  Saving model ...
Epoch: 23 cost time: 2.3426334857940674
Epoch: 23, Steps: 17 | Train Loss: 0.721 Vali Loss: 1.745 Vali Acc: 0.323 Test Loss: 1.745 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.181509017944336
Epoch: 24, Steps: 17 | Train Loss: 0.739 Vali Loss: 1.787 Vali Acc: 0.365 Test Loss: 1.787 Test Acc: 0.365
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.722177505493164
Epoch: 25, Steps: 17 | Train Loss: 0.665 Vali Loss: 1.799 Vali Acc: 0.376 Test Loss: 1.799 Test Acc: 0.376
Validation loss decreased (-0.365001 --> -0.376408).  Saving model ...
Epoch: 26 cost time: 2.3551430702209473
Epoch: 26, Steps: 17 | Train Loss: 0.698 Vali Loss: 2.009 Vali Acc: 0.354 Test Loss: 2.009 Test Acc: 0.354
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.324712038040161
Epoch: 27, Steps: 17 | Train Loss: 0.728 Vali Loss: 1.759 Vali Acc: 0.369 Test Loss: 1.759 Test Acc: 0.369
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.423013687133789
Epoch: 28, Steps: 17 | Train Loss: 0.533 Vali Loss: 1.853 Vali Acc: 0.338 Test Loss: 1.853 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.1364192962646484
Epoch: 29, Steps: 17 | Train Loss: 0.486 Vali Loss: 2.073 Vali Acc: 0.327 Test Loss: 2.073 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0844054222106934
Epoch: 30, Steps: 17 | Train Loss: 0.493 Vali Loss: 1.986 Vali Acc: 0.342 Test Loss: 1.986 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.1269984245300293
Epoch: 31, Steps: 17 | Train Loss: 0.468 Vali Loss: 2.169 Vali Acc: 0.323 Test Loss: 2.169 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.3710250854492188
Epoch: 32, Steps: 17 | Train Loss: 0.443 Vali Loss: 2.086 Vali Acc: 0.376 Test Loss: 2.086 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.8295228481292725
Epoch: 33, Steps: 17 | Train Loss: 0.444 Vali Loss: 2.306 Vali Acc: 0.369 Test Loss: 2.306 Test Acc: 0.369
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.1135618686676025
Epoch: 34, Steps: 17 | Train Loss: 0.427 Vali Loss: 2.056 Vali Acc: 0.388 Test Loss: 2.056 Test Acc: 0.388
Validation loss decreased (-0.376408 --> -0.387812).  Saving model ...
Epoch: 35 cost time: 1.875028371810913
Epoch: 35, Steps: 17 | Train Loss: 0.400 Vali Loss: 2.530 Vali Acc: 0.342 Test Loss: 2.530 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.1917715072631836
Epoch: 36, Steps: 17 | Train Loss: 0.333 Vali Loss: 2.154 Vali Acc: 0.357 Test Loss: 2.154 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.4962143898010254
Epoch: 37, Steps: 17 | Train Loss: 0.313 Vali Loss: 2.435 Vali Acc: 0.373 Test Loss: 2.435 Test Acc: 0.373
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.5794389247894287
Epoch: 38, Steps: 17 | Train Loss: 0.394 Vali Loss: 2.461 Vali Acc: 0.338 Test Loss: 2.461 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.572693109512329
Epoch: 39, Steps: 17 | Train Loss: 0.292 Vali Loss: 2.462 Vali Acc: 0.369 Test Loss: 2.462 Test Acc: 0.369
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.5937366485595703
Epoch: 40, Steps: 17 | Train Loss: 0.261 Vali Loss: 2.419 Vali Acc: 0.380 Test Loss: 2.419 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.3519768714904785
Epoch: 41, Steps: 17 | Train Loss: 0.247 Vali Loss: 2.623 Vali Acc: 0.346 Test Loss: 2.623 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.3230419158935547
Epoch: 42, Steps: 17 | Train Loss: 0.375 Vali Loss: 2.647 Vali Acc: 0.392 Test Loss: 2.647 Test Acc: 0.392
Validation loss decreased (-0.387812 --> -0.391609).  Saving model ...
Epoch: 43 cost time: 2.1844475269317627
Epoch: 43, Steps: 17 | Train Loss: 0.255 Vali Loss: 2.772 Vali Acc: 0.319 Test Loss: 2.772 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 2.4215171337127686
Epoch: 44, Steps: 17 | Train Loss: 0.207 Vali Loss: 2.586 Vali Acc: 0.373 Test Loss: 2.586 Test Acc: 0.373
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 2.4059360027313232
Epoch: 45, Steps: 17 | Train Loss: 0.220 Vali Loss: 2.629 Vali Acc: 0.338 Test Loss: 2.629 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 2.4885306358337402
Epoch: 46, Steps: 17 | Train Loss: 0.182 Vali Loss: 2.712 Vali Acc: 0.388 Test Loss: 2.712 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 2.3131179809570312
Epoch: 47, Steps: 17 | Train Loss: 0.123 Vali Loss: 2.856 Vali Acc: 0.361 Test Loss: 2.856 Test Acc: 0.361
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 2.3685877323150635
Epoch: 48, Steps: 17 | Train Loss: 0.096 Vali Loss: 2.902 Vali Acc: 0.395 Test Loss: 2.902 Test Acc: 0.395
Validation loss decreased (-0.391609 --> -0.395408).  Saving model ...
Epoch: 49 cost time: 2.5845654010772705
Epoch: 49, Steps: 17 | Train Loss: 0.128 Vali Loss: 3.486 Vali Acc: 0.331 Test Loss: 3.486 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 2.1050806045532227
Epoch: 50, Steps: 17 | Train Loss: 0.207 Vali Loss: 3.086 Vali Acc: 0.346 Test Loss: 3.086 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 2.2610859870910645
Epoch: 51, Steps: 17 | Train Loss: 0.142 Vali Loss: 2.989 Vali Acc: 0.369 Test Loss: 2.989 Test Acc: 0.369
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 2.248915672302246
Epoch: 52, Steps: 17 | Train Loss: 0.117 Vali Loss: 3.188 Vali Acc: 0.365 Test Loss: 3.188 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 2.2839109897613525
Epoch: 53, Steps: 17 | Train Loss: 0.093 Vali Loss: 3.269 Vali Acc: 0.376 Test Loss: 3.269 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 2.0573782920837402
Epoch: 54, Steps: 17 | Train Loss: 0.120 Vali Loss: 3.280 Vali Acc: 0.384 Test Loss: 3.280 Test Acc: 0.384
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 2.2231857776641846
Epoch: 55, Steps: 17 | Train Loss: 0.092 Vali Loss: 3.307 Vali Acc: 0.399 Test Loss: 3.307 Test Acc: 0.399
Validation loss decreased (-0.395408 --> -0.399206).  Saving model ...
Epoch: 56 cost time: 2.3213553428649902
Epoch: 56, Steps: 17 | Train Loss: 0.098 Vali Loss: 3.117 Vali Acc: 0.384 Test Loss: 3.117 Test Acc: 0.384
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 2.497288227081299
Epoch: 57, Steps: 17 | Train Loss: 0.064 Vali Loss: 3.610 Vali Acc: 0.335 Test Loss: 3.610 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 2.4160590171813965
Epoch: 58, Steps: 17 | Train Loss: 0.059 Vali Loss: 3.395 Vali Acc: 0.414 Test Loss: 3.395 Test Acc: 0.414
Validation loss decreased (-0.399206 --> -0.414415).  Saving model ...
Epoch: 59 cost time: 2.165571689605713
Epoch: 59, Steps: 17 | Train Loss: 0.079 Vali Loss: 3.845 Vali Acc: 0.327 Test Loss: 3.845 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 2.5409154891967773
Epoch: 60, Steps: 17 | Train Loss: 0.096 Vali Loss: 3.359 Vali Acc: 0.392 Test Loss: 3.359 Test Acc: 0.392
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 2.15914249420166
Epoch: 61, Steps: 17 | Train Loss: 0.154 Vali Loss: 3.492 Vali Acc: 0.376 Test Loss: 3.492 Test Acc: 0.376
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 2.258714199066162
Epoch: 62, Steps: 17 | Train Loss: 0.144 Vali Loss: 3.460 Vali Acc: 0.395 Test Loss: 3.460 Test Acc: 0.395
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 2.224586009979248
Epoch: 63, Steps: 17 | Train Loss: 0.058 Vali Loss: 3.875 Vali Acc: 0.380 Test Loss: 3.875 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 2.347475290298462
Epoch: 64, Steps: 17 | Train Loss: 0.071 Vali Loss: 3.877 Vali Acc: 0.384 Test Loss: 3.877 Test Acc: 0.384
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 2.434056043624878
Epoch: 65, Steps: 17 | Train Loss: 0.058 Vali Loss: 3.641 Vali Acc: 0.392 Test Loss: 3.641 Test Acc: 0.392
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 2.241002082824707
Epoch: 66, Steps: 17 | Train Loss: 0.021 Vali Loss: 3.765 Vali Acc: 0.376 Test Loss: 3.765 Test Acc: 0.376
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 2.5330183506011963
Epoch: 67, Steps: 17 | Train Loss: 0.030 Vali Loss: 3.718 Vali Acc: 0.399 Test Loss: 3.718 Test Acc: 0.399
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.987123727798462
Epoch: 68, Steps: 17 | Train Loss: 0.048 Vali Loss: 3.725 Vali Acc: 0.392 Test Loss: 3.725 Test Acc: 0.392
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.4144486692015209
model parameter : 484072
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.939521551132202
Epoch: 1, Steps: 17 | Train Loss: 1.429 Vali Loss: 1.455 Vali Acc: 0.247 Test Loss: 1.455 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 2.3785243034362793
Epoch: 2, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.414 Vali Acc: 0.297 Test Loss: 1.414 Test Acc: 0.297
Validation loss decreased (-0.247134 --> -0.296564).  Saving model ...
Epoch: 3 cost time: 2.2807366847991943
Epoch: 3, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.395 Vali Acc: 0.304 Test Loss: 1.395 Test Acc: 0.304
Validation loss decreased (-0.296564 --> -0.304169).  Saving model ...
Epoch: 4 cost time: 1.816807508468628
Epoch: 4, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.462 Vali Acc: 0.270 Test Loss: 1.462 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.342237949371338
Epoch: 5, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.379 Vali Acc: 0.323 Test Loss: 1.379 Test Acc: 0.323
Validation loss decreased (-0.304169 --> -0.323180).  Saving model ...
Epoch: 6 cost time: 2.1537017822265625
Epoch: 6, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.495 Vali Acc: 0.270 Test Loss: 1.495 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.354198932647705
Epoch: 7, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.434 Vali Acc: 0.251 Test Loss: 1.434 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4406559467315674
Epoch: 8, Steps: 17 | Train Loss: 1.345 Vali Loss: 1.427 Vali Acc: 0.297 Test Loss: 1.427 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4586191177368164
Epoch: 9, Steps: 17 | Train Loss: 1.335 Vali Loss: 1.529 Vali Acc: 0.278 Test Loss: 1.529 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4624030590057373
Epoch: 10, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.503 Vali Acc: 0.278 Test Loss: 1.503 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.058408260345459
Epoch: 11, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.455 Vali Acc: 0.300 Test Loss: 1.455 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.440542221069336
Epoch: 12, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.628 Vali Acc: 0.274 Test Loss: 1.628 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.336703300476074
Epoch: 13, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.460 Vali Acc: 0.323 Test Loss: 1.460 Test Acc: 0.323
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.178570032119751
Epoch: 14, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.510 Vali Acc: 0.323 Test Loss: 1.510 Test Acc: 0.323
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.0776207447052
Epoch: 15, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.668 Vali Acc: 0.297 Test Loss: 1.668 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3231939163498099
model parameter : 477064
model size : 2.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.377105712890625
Epoch: 1, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.465 Vali Acc: 0.262 Test Loss: 1.465 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 2.031749963760376
Epoch: 2, Steps: 17 | Train Loss: 1.471 Vali Loss: 1.430 Vali Acc: 0.274 Test Loss: 1.430 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 2.669637680053711
Epoch: 3, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.426 Vali Acc: 0.247 Test Loss: 1.426 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.2740700244903564
Epoch: 4, Steps: 17 | Train Loss: 1.403 Vali Loss: 1.443 Vali Acc: 0.247 Test Loss: 1.443 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.3367176055908203
Epoch: 5, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.415 Vali Acc: 0.270 Test Loss: 1.415 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.4536325931549072
Epoch: 6, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.450 Vali Acc: 0.240 Test Loss: 1.450 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.527306318283081
Epoch: 7, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.500 Vali Acc: 0.293 Test Loss: 1.500 Test Acc: 0.293
Validation loss decreased (-0.273750 --> -0.292761).  Saving model ...
Epoch: 8 cost time: 2.2185025215148926
Epoch: 8, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.495 Vali Acc: 0.262 Test Loss: 1.495 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0325207710266113
Epoch: 9, Steps: 17 | Train Loss: 1.327 Vali Loss: 1.624 Vali Acc: 0.255 Test Loss: 1.624 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.512974262237549
Epoch: 10, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.493 Vali Acc: 0.262 Test Loss: 1.493 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.223548412322998
Epoch: 11, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.496 Vali Acc: 0.255 Test Loss: 1.496 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1023337841033936
Epoch: 12, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.535 Vali Acc: 0.266 Test Loss: 1.535 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.332050085067749
Epoch: 13, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.593 Vali Acc: 0.274 Test Loss: 1.593 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.303476572036743
Epoch: 14, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.599 Vali Acc: 0.281 Test Loss: 1.599 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.3844029903411865
Epoch: 15, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.567 Vali Acc: 0.289 Test Loss: 1.567 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.101534128189087
Epoch: 16, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.511 Vali Acc: 0.312 Test Loss: 1.511 Test Acc: 0.312
Validation loss decreased (-0.292761 --> -0.311772).  Saving model ...
Epoch: 17 cost time: 2.2165751457214355
Epoch: 17, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.767 Vali Acc: 0.281 Test Loss: 1.767 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.361747980117798
Epoch: 18, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.483 Vali Acc: 0.327 Test Loss: 1.483 Test Acc: 0.327
Validation loss decreased (-0.311772 --> -0.326981).  Saving model ...
Epoch: 19 cost time: 2.197909355163574
Epoch: 19, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.709 Vali Acc: 0.297 Test Loss: 1.709 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.113273859024048
Epoch: 20, Steps: 17 | Train Loss: 0.931 Vali Loss: 1.998 Vali Acc: 0.255 Test Loss: 1.998 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.5205910205841064
Epoch: 21, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.646 Vali Acc: 0.338 Test Loss: 1.646 Test Acc: 0.338
Validation loss decreased (-0.326981 --> -0.338387).  Saving model ...
Epoch: 22 cost time: 1.9442245960235596
Epoch: 22, Steps: 17 | Train Loss: 0.858 Vali Loss: 1.547 Vali Acc: 0.354 Test Loss: 1.547 Test Acc: 0.354
Validation loss decreased (-0.338387 --> -0.353597).  Saving model ...
Epoch: 23 cost time: 2.113326072692871
Epoch: 23, Steps: 17 | Train Loss: 0.905 Vali Loss: 1.688 Vali Acc: 0.335 Test Loss: 1.688 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.5092363357543945
Epoch: 24, Steps: 17 | Train Loss: 0.770 Vali Loss: 1.672 Vali Acc: 0.327 Test Loss: 1.672 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1983962059020996
Epoch: 25, Steps: 17 | Train Loss: 0.748 Vali Loss: 1.818 Vali Acc: 0.354 Test Loss: 1.818 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.030083656311035
Epoch: 26, Steps: 17 | Train Loss: 0.728 Vali Loss: 1.653 Vali Acc: 0.342 Test Loss: 1.653 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.0414421558380127
Epoch: 27, Steps: 17 | Train Loss: 0.628 Vali Loss: 1.652 Vali Acc: 0.361 Test Loss: 1.652 Test Acc: 0.361
Validation loss decreased (-0.353597 --> -0.361200).  Saving model ...
Epoch: 28 cost time: 1.9933412075042725
Epoch: 28, Steps: 17 | Train Loss: 0.651 Vali Loss: 1.802 Vali Acc: 0.350 Test Loss: 1.802 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.5437862873077393
Epoch: 29, Steps: 17 | Train Loss: 0.591 Vali Loss: 1.742 Vali Acc: 0.350 Test Loss: 1.742 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.3852195739746094
Epoch: 30, Steps: 17 | Train Loss: 0.610 Vali Loss: 1.804 Vali Acc: 0.342 Test Loss: 1.804 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.435819149017334
Epoch: 31, Steps: 17 | Train Loss: 0.518 Vali Loss: 1.846 Vali Acc: 0.384 Test Loss: 1.846 Test Acc: 0.384
Validation loss decreased (-0.361200 --> -0.384012).  Saving model ...
Epoch: 32 cost time: 1.9353992938995361
Epoch: 32, Steps: 17 | Train Loss: 0.504 Vali Loss: 1.815 Vali Acc: 0.403 Test Loss: 1.815 Test Acc: 0.403
Validation loss decreased (-0.384012 --> -0.403024).  Saving model ...
Epoch: 33 cost time: 2.0203781127929688
Epoch: 33, Steps: 17 | Train Loss: 0.483 Vali Loss: 1.918 Vali Acc: 0.365 Test Loss: 1.918 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.1123998165130615
Epoch: 34, Steps: 17 | Train Loss: 0.478 Vali Loss: 1.996 Vali Acc: 0.380 Test Loss: 1.996 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.356557846069336
Epoch: 35, Steps: 17 | Train Loss: 0.441 Vali Loss: 1.981 Vali Acc: 0.361 Test Loss: 1.981 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.1371400356292725
Epoch: 36, Steps: 17 | Train Loss: 0.363 Vali Loss: 2.135 Vali Acc: 0.365 Test Loss: 2.135 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.1468703746795654
Epoch: 37, Steps: 17 | Train Loss: 0.447 Vali Loss: 2.172 Vali Acc: 0.357 Test Loss: 2.172 Test Acc: 0.357
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.080951690673828
Epoch: 38, Steps: 17 | Train Loss: 0.526 Vali Loss: 2.202 Vali Acc: 0.365 Test Loss: 2.202 Test Acc: 0.365
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.0650250911712646
Epoch: 39, Steps: 17 | Train Loss: 0.356 Vali Loss: 2.172 Vali Acc: 0.346 Test Loss: 2.172 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.4036245346069336
Epoch: 40, Steps: 17 | Train Loss: 0.393 Vali Loss: 2.416 Vali Acc: 0.323 Test Loss: 2.416 Test Acc: 0.323
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.5006213188171387
Epoch: 41, Steps: 17 | Train Loss: 0.280 Vali Loss: 2.337 Vali Acc: 0.384 Test Loss: 2.337 Test Acc: 0.384
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 2.5077929496765137
Epoch: 42, Steps: 17 | Train Loss: 0.233 Vali Loss: 2.437 Vali Acc: 0.354 Test Loss: 2.437 Test Acc: 0.354
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.40304182509505704
model parameter : 470056
model size : 2.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.458115100860596
Epoch: 1, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.432 Vali Acc: 0.259 Test Loss: 1.432 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 2.009852886199951
Epoch: 2, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.473 Vali Acc: 0.262 Test Loss: 1.473 Test Acc: 0.262
Validation loss decreased (-0.258541 --> -0.262343).  Saving model ...
Epoch: 3 cost time: 2.372232675552368
Epoch: 3, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.403 Vali Acc: 0.293 Test Loss: 1.403 Test Acc: 0.293
Validation loss decreased (-0.262343 --> -0.292762).  Saving model ...
Epoch: 4 cost time: 2.4389240741729736
Epoch: 4, Steps: 17 | Train Loss: 1.440 Vali Loss: 1.494 Vali Acc: 0.270 Test Loss: 1.494 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4726226329803467
Epoch: 5, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.534 Vali Acc: 0.259 Test Loss: 1.534 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.1386876106262207
Epoch: 6, Steps: 17 | Train Loss: 1.388 Vali Loss: 1.473 Vali Acc: 0.251 Test Loss: 1.473 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5208377838134766
Epoch: 7, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.469 Vali Acc: 0.289 Test Loss: 1.469 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.212214469909668
Epoch: 8, Steps: 17 | Train Loss: 1.325 Vali Loss: 1.519 Vali Acc: 0.236 Test Loss: 1.519 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9071598052978516
Epoch: 9, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.439 Vali Acc: 0.266 Test Loss: 1.439 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.9927482604980469
Epoch: 10, Steps: 17 | Train Loss: 1.305 Vali Loss: 1.705 Vali Acc: 0.262 Test Loss: 1.705 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.374034881591797
Epoch: 11, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.500 Vali Acc: 0.278 Test Loss: 1.500 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.4203670024871826
Epoch: 12, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.564 Vali Acc: 0.278 Test Loss: 1.564 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.225217342376709
Epoch: 13, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.573 Vali Acc: 0.262 Test Loss: 1.573 Test Acc: 0.262
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 324680
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.005911827087402
Epoch: 1, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.386 Vali Acc: 0.270 Test Loss: 1.386 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 2.144432544708252
Epoch: 2, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.402 Vali Acc: 0.285 Test Loss: 1.402 Test Acc: 0.285
Validation loss decreased (-0.269948 --> -0.285157).  Saving model ...
Epoch: 3 cost time: 2.0270133018493652
Epoch: 3, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.411 Vali Acc: 0.255 Test Loss: 1.411 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0820531845092773
Epoch: 4, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.428 Vali Acc: 0.228 Test Loss: 1.428 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.30924129486084
Epoch: 5, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.523 Vali Acc: 0.243 Test Loss: 1.523 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9440431594848633
Epoch: 6, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.715 Vali Acc: 0.247 Test Loss: 1.715 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0426199436187744
Epoch: 7, Steps: 17 | Train Loss: 1.374 Vali Loss: 1.641 Vali Acc: 0.259 Test Loss: 1.641 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.1053848266601562
Epoch: 8, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.446 Vali Acc: 0.259 Test Loss: 1.446 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1841518878936768
Epoch: 9, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.412 Vali Acc: 0.274 Test Loss: 1.412 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.3229291439056396
Epoch: 10, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.618 Vali Acc: 0.266 Test Loss: 1.618 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.3121697902679443
Epoch: 11, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.447 Vali Acc: 0.259 Test Loss: 1.447 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.223045825958252
Epoch: 12, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.499 Vali Acc: 0.281 Test Loss: 1.499 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 317672
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.207787036895752
Epoch: 1, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.462 Vali Acc: 0.251 Test Loss: 1.462 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 2.539799451828003
Epoch: 2, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.407 Vali Acc: 0.278 Test Loss: 1.407 Test Acc: 0.278
Validation loss decreased (-0.250936 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 2.3195009231567383
Epoch: 3, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.470 Vali Acc: 0.308 Test Loss: 1.470 Test Acc: 0.308
Validation loss decreased (-0.277552 --> -0.307970).  Saving model ...
Epoch: 4 cost time: 2.0668179988861084
Epoch: 4, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.565 Vali Acc: 0.262 Test Loss: 1.565 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.029264450073242
Epoch: 5, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.456 Vali Acc: 0.236 Test Loss: 1.456 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4569735527038574
Epoch: 6, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.420 Vali Acc: 0.251 Test Loss: 1.420 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.25585675239563
Epoch: 7, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.495 Vali Acc: 0.281 Test Loss: 1.495 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.011046886444092
Epoch: 8, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.568 Vali Acc: 0.266 Test Loss: 1.568 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.9221982955932617
Epoch: 9, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.481 Vali Acc: 0.278 Test Loss: 1.481 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.2169947624206543
Epoch: 10, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.451 Vali Acc: 0.251 Test Loss: 1.451 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.367558717727661
Epoch: 11, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.968 Vali Acc: 0.243 Test Loss: 1.968 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.167696475982666
Epoch: 12, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.638 Vali Acc: 0.251 Test Loss: 1.638 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.2971932888031006
Epoch: 13, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.720 Vali Acc: 0.247 Test Loss: 1.720 Test Acc: 0.247
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 310664
model size : 1.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3266143798828125
Epoch: 1, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.397 Vali Acc: 0.259 Test Loss: 1.397 Test Acc: 0.259
Validation loss decreased (inf --> -0.258541).  Saving model ...
Epoch: 2 cost time: 1.6960945129394531
Epoch: 2, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.484 Vali Acc: 0.281 Test Loss: 1.484 Test Acc: 0.281
Validation loss decreased (-0.258541 --> -0.281354).  Saving model ...
Epoch: 3 cost time: 1.810673713684082
Epoch: 3, Steps: 17 | Train Loss: 1.390 Vali Loss: 1.392 Vali Acc: 0.281 Test Loss: 1.392 Test Acc: 0.281
Validation loss decreased (-0.281354 --> -0.281355).  Saving model ...
Epoch: 4 cost time: 1.7567873001098633
Epoch: 4, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.483 Vali Acc: 0.259 Test Loss: 1.483 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9765758514404297
Epoch: 5, Steps: 17 | Train Loss: 1.359 Vali Loss: 1.508 Vali Acc: 0.243 Test Loss: 1.508 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8513720035552979
Epoch: 6, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.667 Vali Acc: 0.251 Test Loss: 1.667 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9261963367462158
Epoch: 7, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.442 Vali Acc: 0.278 Test Loss: 1.442 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8361918926239014
Epoch: 8, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.524 Vali Acc: 0.243 Test Loss: 1.524 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.8018674850463867
Epoch: 9, Steps: 17 | Train Loss: 1.315 Vali Loss: 1.537 Vali Acc: 0.243 Test Loss: 1.537 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.8565113544464111
Epoch: 10, Steps: 17 | Train Loss: 1.322 Vali Loss: 1.459 Vali Acc: 0.281 Test Loss: 1.459 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9331028461456299
Epoch: 11, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.459 Vali Acc: 0.274 Test Loss: 1.459 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8986070156097412
Epoch: 12, Steps: 17 | Train Loss: 1.284 Vali Loss: 1.507 Vali Acc: 0.243 Test Loss: 1.507 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.8976047039031982
Epoch: 13, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.664 Vali Acc: 0.259 Test Loss: 1.664 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2813688212927757
model parameter : 303656
model size : 1.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.020973443984985
Epoch: 1, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.409 Vali Acc: 0.247 Test Loss: 1.409 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 2.2697436809539795
Epoch: 2, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.576 Vali Acc: 0.251 Test Loss: 1.576 Test Acc: 0.251
Validation loss decreased (-0.247134 --> -0.250935).  Saving model ...
Epoch: 3 cost time: 2.0411229133605957
Epoch: 3, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.550 Vali Acc: 0.255 Test Loss: 1.550 Test Acc: 0.255
Validation loss decreased (-0.250935 --> -0.254737).  Saving model ...
Epoch: 4 cost time: 2.4030191898345947
Epoch: 4, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.424 Vali Acc: 0.240 Test Loss: 1.424 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4855782985687256
Epoch: 5, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.506 Vali Acc: 0.251 Test Loss: 1.506 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.2170486450195312
Epoch: 6, Steps: 17 | Train Loss: 1.484 Vali Loss: 1.599 Vali Acc: 0.247 Test Loss: 1.599 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.0566225051879883
Epoch: 7, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.565 Vali Acc: 0.251 Test Loss: 1.565 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.304922103881836
Epoch: 8, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.429 Vali Acc: 0.278 Test Loss: 1.429 Test Acc: 0.278
Validation loss decreased (-0.254737 --> -0.277552).  Saving model ...
Epoch: 9 cost time: 2.041950225830078
Epoch: 9, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.552 Vali Acc: 0.308 Test Loss: 1.552 Test Acc: 0.308
Validation loss decreased (-0.277552 --> -0.307969).  Saving model ...
Epoch: 10 cost time: 1.8593673706054688
Epoch: 10, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.485 Vali Acc: 0.262 Test Loss: 1.485 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.602264165878296
Epoch: 11, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.544 Vali Acc: 0.259 Test Loss: 1.544 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0392374992370605
Epoch: 12, Steps: 17 | Train Loss: 1.244 Vali Loss: 1.705 Vali Acc: 0.247 Test Loss: 1.705 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.197660207748413
Epoch: 13, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.555 Vali Acc: 0.255 Test Loss: 1.555 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1003286838531494
Epoch: 14, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.613 Vali Acc: 0.278 Test Loss: 1.613 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7966103553771973
Epoch: 15, Steps: 17 | Train Loss: 1.124 Vali Loss: 2.003 Vali Acc: 0.255 Test Loss: 2.003 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.105039596557617
Epoch: 16, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.643 Vali Acc: 0.274 Test Loss: 1.643 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.094524621963501
Epoch: 17, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.808 Vali Acc: 0.274 Test Loss: 1.808 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.862950086593628
Epoch: 18, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.689 Vali Acc: 0.251 Test Loss: 1.689 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.112318277359009
Epoch: 19, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.879 Vali Acc: 0.285 Test Loss: 1.879 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 241480
model size : 1.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.752248764038086
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.425 Vali Acc: 0.266 Test Loss: 1.425 Test Acc: 0.266
Validation loss decreased (inf --> -0.266145).  Saving model ...
Epoch: 2 cost time: 2.3108327388763428
Epoch: 2, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.471 Vali Acc: 0.217 Test Loss: 1.471 Test Acc: 0.217
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3430068492889404
Epoch: 3, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.610 Vali Acc: 0.236 Test Loss: 1.610 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2083723545074463
Epoch: 4, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.458 Vali Acc: 0.278 Test Loss: 1.458 Test Acc: 0.278
Validation loss decreased (-0.266145 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 2.1526031494140625
Epoch: 5, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.446 Vali Acc: 0.281 Test Loss: 1.446 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 2.3635828495025635
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.632 Vali Acc: 0.247 Test Loss: 1.632 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0297653675079346
Epoch: 7, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.461 Vali Acc: 0.278 Test Loss: 1.461 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.276944875717163
Epoch: 8, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.485 Vali Acc: 0.266 Test Loss: 1.485 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.2003042697906494
Epoch: 9, Steps: 17 | Train Loss: 1.369 Vali Loss: 1.501 Vali Acc: 0.274 Test Loss: 1.501 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3797996044158936
Epoch: 10, Steps: 17 | Train Loss: 1.330 Vali Loss: 1.544 Vali Acc: 0.270 Test Loss: 1.544 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.1323888301849365
Epoch: 11, Steps: 17 | Train Loss: 1.350 Vali Loss: 1.595 Vali Acc: 0.255 Test Loss: 1.595 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.058248996734619
Epoch: 12, Steps: 17 | Train Loss: 1.182 Vali Loss: 1.600 Vali Acc: 0.281 Test Loss: 1.600 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.8914780616760254
Epoch: 13, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.648 Vali Acc: 0.262 Test Loss: 1.648 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.302436351776123
Epoch: 14, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.709 Vali Acc: 0.285 Test Loss: 1.709 Test Acc: 0.285
Validation loss decreased (-0.281354 --> -0.285154).  Saving model ...
Epoch: 15 cost time: 2.1778910160064697
Epoch: 15, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.670 Vali Acc: 0.266 Test Loss: 1.670 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.215808868408203
Epoch: 16, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.823 Vali Acc: 0.281 Test Loss: 1.823 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.444404125213623
Epoch: 17, Steps: 17 | Train Loss: 1.120 Vali Loss: 1.796 Vali Acc: 0.262 Test Loss: 1.796 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.2487576007843018
Epoch: 18, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.630 Vali Acc: 0.300 Test Loss: 1.630 Test Acc: 0.300
Validation loss decreased (-0.285154 --> -0.300364).  Saving model ...
Epoch: 19 cost time: 2.1131210327148438
Epoch: 19, Steps: 17 | Train Loss: 1.118 Vali Loss: 1.780 Vali Acc: 0.281 Test Loss: 1.780 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.063206434249878
Epoch: 20, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.937 Vali Acc: 0.308 Test Loss: 1.937 Test Acc: 0.308
Validation loss decreased (-0.300364 --> -0.307965).  Saving model ...
Epoch: 21 cost time: 2.1763176918029785
Epoch: 21, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.697 Vali Acc: 0.335 Test Loss: 1.697 Test Acc: 0.335
Validation loss decreased (-0.307965 --> -0.334584).  Saving model ...
Epoch: 22 cost time: 2.1822454929351807
Epoch: 22, Steps: 17 | Train Loss: 0.862 Vali Loss: 1.777 Vali Acc: 0.297 Test Loss: 1.777 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7212669849395752
Epoch: 23, Steps: 17 | Train Loss: 0.821 Vali Loss: 1.973 Vali Acc: 0.316 Test Loss: 1.973 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.205467700958252
Epoch: 24, Steps: 17 | Train Loss: 0.790 Vali Loss: 1.810 Vali Acc: 0.327 Test Loss: 1.810 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2701621055603027
Epoch: 25, Steps: 17 | Train Loss: 0.857 Vali Loss: 1.764 Vali Acc: 0.323 Test Loss: 1.764 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.9617533683776855
Epoch: 26, Steps: 17 | Train Loss: 0.710 Vali Loss: 1.932 Vali Acc: 0.300 Test Loss: 1.932 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.058098077774048
Epoch: 27, Steps: 17 | Train Loss: 0.716 Vali Loss: 1.848 Vali Acc: 0.323 Test Loss: 1.848 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.0053870677948
Epoch: 28, Steps: 17 | Train Loss: 0.651 Vali Loss: 1.855 Vali Acc: 0.338 Test Loss: 1.855 Test Acc: 0.338
Validation loss decreased (-0.334584 --> -0.338384).  Saving model ...
Epoch: 29 cost time: 1.7086873054504395
Epoch: 29, Steps: 17 | Train Loss: 0.673 Vali Loss: 2.216 Vali Acc: 0.285 Test Loss: 2.216 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.0100111961364746
Epoch: 30, Steps: 17 | Train Loss: 0.619 Vali Loss: 1.938 Vali Acc: 0.327 Test Loss: 1.938 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.454552173614502
Epoch: 31, Steps: 17 | Train Loss: 0.545 Vali Loss: 1.934 Vali Acc: 0.335 Test Loss: 1.934 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.334348201751709
Epoch: 32, Steps: 17 | Train Loss: 0.509 Vali Loss: 1.966 Vali Acc: 0.342 Test Loss: 1.966 Test Acc: 0.342
Validation loss decreased (-0.338384 --> -0.342186).  Saving model ...
Epoch: 33 cost time: 2.159109354019165
Epoch: 33, Steps: 17 | Train Loss: 0.540 Vali Loss: 2.020 Vali Acc: 0.327 Test Loss: 2.020 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.1736583709716797
Epoch: 34, Steps: 17 | Train Loss: 0.473 Vali Loss: 2.106 Vali Acc: 0.361 Test Loss: 2.106 Test Acc: 0.361
Validation loss decreased (-0.342186 --> -0.361196).  Saving model ...
Epoch: 35 cost time: 2.207644462585449
Epoch: 35, Steps: 17 | Train Loss: 0.435 Vali Loss: 2.325 Vali Acc: 0.327 Test Loss: 2.325 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.0997588634490967
Epoch: 36, Steps: 17 | Train Loss: 0.436 Vali Loss: 2.082 Vali Acc: 0.369 Test Loss: 2.082 Test Acc: 0.369
Validation loss decreased (-0.361196 --> -0.368800).  Saving model ...
Epoch: 37 cost time: 1.738663673400879
Epoch: 37, Steps: 17 | Train Loss: 0.363 Vali Loss: 2.287 Vali Acc: 0.346 Test Loss: 2.287 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.9945921897888184
Epoch: 38, Steps: 17 | Train Loss: 0.405 Vali Loss: 2.505 Vali Acc: 0.361 Test Loss: 2.505 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 2.0244977474212646
Epoch: 39, Steps: 17 | Train Loss: 0.429 Vali Loss: 2.135 Vali Acc: 0.399 Test Loss: 2.135 Test Acc: 0.399
Validation loss decreased (-0.368800 --> -0.399218).  Saving model ...
Epoch: 40 cost time: 1.8081574440002441
Epoch: 40, Steps: 17 | Train Loss: 0.334 Vali Loss: 2.450 Vali Acc: 0.346 Test Loss: 2.450 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 2.3567845821380615
Epoch: 41, Steps: 17 | Train Loss: 0.333 Vali Loss: 2.382 Vali Acc: 0.380 Test Loss: 2.382 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 2.234335422515869
Epoch: 42, Steps: 17 | Train Loss: 0.273 Vali Loss: 2.705 Vali Acc: 0.338 Test Loss: 2.705 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.9788904190063477
Epoch: 43, Steps: 17 | Train Loss: 0.471 Vali Loss: 2.411 Vali Acc: 0.388 Test Loss: 2.411 Test Acc: 0.388
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 2.2775535583496094
Epoch: 44, Steps: 17 | Train Loss: 0.264 Vali Loss: 2.389 Vali Acc: 0.376 Test Loss: 2.389 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 2.2193994522094727
Epoch: 45, Steps: 17 | Train Loss: 0.313 Vali Loss: 2.475 Vali Acc: 0.380 Test Loss: 2.475 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.9459984302520752
Epoch: 46, Steps: 17 | Train Loss: 0.288 Vali Loss: 2.638 Vali Acc: 0.373 Test Loss: 2.638 Test Acc: 0.373
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 2.1944022178649902
Epoch: 47, Steps: 17 | Train Loss: 0.327 Vali Loss: 2.687 Vali Acc: 0.388 Test Loss: 2.687 Test Acc: 0.388
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 2.202343225479126
Epoch: 48, Steps: 17 | Train Loss: 0.240 Vali Loss: 2.682 Vali Acc: 0.346 Test Loss: 2.682 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 2.3512539863586426
Epoch: 49, Steps: 17 | Train Loss: 0.288 Vali Loss: 2.807 Vali Acc: 0.338 Test Loss: 2.807 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.39923954372623577
model parameter : 234472
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.000843524932861
Epoch: 1, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.457 Vali Acc: 0.243 Test Loss: 1.457 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 1.9871551990509033
Epoch: 2, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.527 Vali Acc: 0.266 Test Loss: 1.527 Test Acc: 0.266
Validation loss decreased (-0.243331 --> -0.266144).  Saving model ...
Epoch: 3 cost time: 2.0872015953063965
Epoch: 3, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.413 Vali Acc: 0.270 Test Loss: 1.413 Test Acc: 0.270
Validation loss decreased (-0.266144 --> -0.269948).  Saving model ...
Epoch: 4 cost time: 2.1983911991119385
Epoch: 4, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.430 Vali Acc: 0.278 Test Loss: 1.430 Test Acc: 0.278
Validation loss decreased (-0.269948 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 2.1517751216888428
Epoch: 5, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.479 Vali Acc: 0.266 Test Loss: 1.479 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9800643920898438
Epoch: 6, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.433 Vali Acc: 0.259 Test Loss: 1.433 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.223928689956665
Epoch: 7, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.529 Vali Acc: 0.274 Test Loss: 1.529 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.1941335201263428
Epoch: 8, Steps: 17 | Train Loss: 1.328 Vali Loss: 1.525 Vali Acc: 0.281 Test Loss: 1.525 Test Acc: 0.281
Validation loss decreased (-0.277552 --> -0.281354).  Saving model ...
Epoch: 9 cost time: 1.8215630054473877
Epoch: 9, Steps: 17 | Train Loss: 1.318 Vali Loss: 1.444 Vali Acc: 0.232 Test Loss: 1.444 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1480846405029297
Epoch: 10, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.473 Vali Acc: 0.266 Test Loss: 1.473 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.001901865005493
Epoch: 11, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.673 Vali Acc: 0.259 Test Loss: 1.673 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.189671039581299
Epoch: 12, Steps: 17 | Train Loss: 1.221 Vali Loss: 1.503 Vali Acc: 0.289 Test Loss: 1.503 Test Acc: 0.289
Validation loss decreased (-0.281354 --> -0.288958).  Saving model ...
Epoch: 13 cost time: 1.9559235572814941
Epoch: 13, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.667 Vali Acc: 0.266 Test Loss: 1.667 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3521368503570557
Epoch: 14, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.669 Vali Acc: 0.285 Test Loss: 1.669 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.345926284790039
Epoch: 15, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.533 Vali Acc: 0.297 Test Loss: 1.533 Test Acc: 0.297
Validation loss decreased (-0.288958 --> -0.296563).  Saving model ...
Epoch: 16 cost time: 2.1225016117095947
Epoch: 16, Steps: 17 | Train Loss: 1.083 Vali Loss: 1.538 Vali Acc: 0.293 Test Loss: 1.538 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.335651159286499
Epoch: 17, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.610 Vali Acc: 0.312 Test Loss: 1.610 Test Acc: 0.312
Validation loss decreased (-0.296563 --> -0.311771).  Saving model ...
Epoch: 18 cost time: 2.2159335613250732
Epoch: 18, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.671 Vali Acc: 0.308 Test Loss: 1.671 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5198466777801514
Epoch: 19, Steps: 17 | Train Loss: 0.951 Vali Loss: 1.838 Vali Acc: 0.289 Test Loss: 1.838 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.1195671558380127
Epoch: 20, Steps: 17 | Train Loss: 0.912 Vali Loss: 1.713 Vali Acc: 0.312 Test Loss: 1.713 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9022700786590576
Epoch: 21, Steps: 17 | Train Loss: 0.932 Vali Loss: 1.686 Vali Acc: 0.308 Test Loss: 1.686 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.113886833190918
Epoch: 22, Steps: 17 | Train Loss: 0.794 Vali Loss: 1.692 Vali Acc: 0.335 Test Loss: 1.692 Test Acc: 0.335
Validation loss decreased (-0.311771 --> -0.334584).  Saving model ...
Epoch: 23 cost time: 2.1719892024993896
Epoch: 23, Steps: 17 | Train Loss: 0.809 Vali Loss: 1.675 Vali Acc: 0.338 Test Loss: 1.675 Test Acc: 0.338
Validation loss decreased (-0.334584 --> -0.338386).  Saving model ...
Epoch: 24 cost time: 1.8146214485168457
Epoch: 24, Steps: 17 | Train Loss: 0.744 Vali Loss: 1.931 Vali Acc: 0.304 Test Loss: 1.931 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.266058921813965
Epoch: 25, Steps: 17 | Train Loss: 0.836 Vali Loss: 1.876 Vali Acc: 0.327 Test Loss: 1.876 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.394447088241577
Epoch: 26, Steps: 17 | Train Loss: 0.671 Vali Loss: 1.942 Vali Acc: 0.316 Test Loss: 1.942 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0151238441467285
Epoch: 27, Steps: 17 | Train Loss: 0.708 Vali Loss: 1.878 Vali Acc: 0.373 Test Loss: 1.878 Test Acc: 0.373
Validation loss decreased (-0.338386 --> -0.372605).  Saving model ...
Epoch: 28 cost time: 1.880323886871338
Epoch: 28, Steps: 17 | Train Loss: 0.749 Vali Loss: 1.974 Vali Acc: 0.331 Test Loss: 1.974 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.033834218978882
Epoch: 29, Steps: 17 | Train Loss: 0.672 Vali Loss: 1.968 Vali Acc: 0.327 Test Loss: 1.968 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 2.1616950035095215
Epoch: 30, Steps: 17 | Train Loss: 0.603 Vali Loss: 1.893 Vali Acc: 0.380 Test Loss: 1.893 Test Acc: 0.380
Validation loss decreased (-0.372605 --> -0.380209).  Saving model ...
Epoch: 31 cost time: 1.8417489528656006
Epoch: 31, Steps: 17 | Train Loss: 0.537 Vali Loss: 1.926 Vali Acc: 0.376 Test Loss: 1.926 Test Acc: 0.376
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.701082229614258
Epoch: 32, Steps: 17 | Train Loss: 0.488 Vali Loss: 1.956 Vali Acc: 0.354 Test Loss: 1.956 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.416337728500366
Epoch: 33, Steps: 17 | Train Loss: 0.434 Vali Loss: 1.956 Vali Acc: 0.361 Test Loss: 1.956 Test Acc: 0.361
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.246213912963867
Epoch: 34, Steps: 17 | Train Loss: 0.402 Vali Loss: 2.023 Vali Acc: 0.354 Test Loss: 2.023 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.1413888931274414
Epoch: 35, Steps: 17 | Train Loss: 0.480 Vali Loss: 2.156 Vali Acc: 0.342 Test Loss: 2.156 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.258697271347046
Epoch: 36, Steps: 17 | Train Loss: 0.442 Vali Loss: 2.281 Vali Acc: 0.346 Test Loss: 2.281 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.328641653060913
Epoch: 37, Steps: 17 | Train Loss: 0.491 Vali Loss: 2.311 Vali Acc: 0.361 Test Loss: 2.311 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.216369867324829
Epoch: 38, Steps: 17 | Train Loss: 0.386 Vali Loss: 2.440 Vali Acc: 0.297 Test Loss: 2.440 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.351762056350708
Epoch: 39, Steps: 17 | Train Loss: 0.369 Vali Loss: 2.557 Vali Acc: 0.316 Test Loss: 2.557 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.366621971130371
Epoch: 40, Steps: 17 | Train Loss: 0.359 Vali Loss: 2.467 Vali Acc: 0.373 Test Loss: 2.467 Test Acc: 0.373
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38022813688212925
model parameter : 227464
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8043994903564453
Epoch: 1, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.392 Vali Acc: 0.270 Test Loss: 1.392 Test Acc: 0.270
Validation loss decreased (inf --> -0.269948).  Saving model ...
Epoch: 2 cost time: 1.810415506362915
Epoch: 2, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.385 Vali Acc: 0.289 Test Loss: 1.385 Test Acc: 0.289
Validation loss decreased (-0.269948 --> -0.288960).  Saving model ...
Epoch: 3 cost time: 2.094356060028076
Epoch: 3, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.513 Vali Acc: 0.247 Test Loss: 1.513 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.962571144104004
Epoch: 4, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.482 Vali Acc: 0.262 Test Loss: 1.482 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.792943000793457
Epoch: 5, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.441 Vali Acc: 0.281 Test Loss: 1.441 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.004638671875
Epoch: 6, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.588 Vali Acc: 0.281 Test Loss: 1.588 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.9798450469970703
Epoch: 7, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.460 Vali Acc: 0.270 Test Loss: 1.460 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0494558811187744
Epoch: 8, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.544 Vali Acc: 0.232 Test Loss: 1.544 Test Acc: 0.232
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7337310314178467
Epoch: 9, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.616 Vali Acc: 0.262 Test Loss: 1.616 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8917946815490723
Epoch: 10, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.460 Vali Acc: 0.304 Test Loss: 1.460 Test Acc: 0.304
Validation loss decreased (-0.288960 --> -0.304168).  Saving model ...
Epoch: 11 cost time: 1.8147070407867432
Epoch: 11, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.493 Vali Acc: 0.274 Test Loss: 1.493 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0550317764282227
Epoch: 12, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.962 Vali Acc: 0.251 Test Loss: 1.962 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.761730432510376
Epoch: 13, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.900 Vali Acc: 0.266 Test Loss: 1.900 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.807938575744629
Epoch: 14, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.537 Vali Acc: 0.274 Test Loss: 1.537 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8045265674591064
Epoch: 15, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.848 Vali Acc: 0.240 Test Loss: 1.848 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9703190326690674
Epoch: 16, Steps: 17 | Train Loss: 1.252 Vali Loss: 1.612 Vali Acc: 0.281 Test Loss: 1.612 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8384003639221191
Epoch: 17, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.793 Vali Acc: 0.274 Test Loss: 1.793 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6908926963806152
Epoch: 18, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.619 Vali Acc: 0.274 Test Loss: 1.619 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9568970203399658
Epoch: 19, Steps: 17 | Train Loss: 1.165 Vali Loss: 2.015 Vali Acc: 0.262 Test Loss: 2.015 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.758681058883667
Epoch: 20, Steps: 17 | Train Loss: 1.079 Vali Loss: 1.773 Vali Acc: 0.266 Test Loss: 1.773 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 220456
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.8845667839050293
Epoch: 1, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.406 Vali Acc: 0.251 Test Loss: 1.406 Test Acc: 0.251
Validation loss decreased (inf --> -0.250937).  Saving model ...
Epoch: 2 cost time: 1.9672088623046875
Epoch: 2, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.533 Vali Acc: 0.251 Test Loss: 1.533 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.1658999919891357
Epoch: 3, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.421 Vali Acc: 0.247 Test Loss: 1.421 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2825510501861572
Epoch: 4, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.467 Vali Acc: 0.262 Test Loss: 1.467 Test Acc: 0.262
Validation loss decreased (-0.250937 --> -0.262343).  Saving model ...
Epoch: 5 cost time: 2.1146743297576904
Epoch: 5, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.528 Vali Acc: 0.266 Test Loss: 1.528 Test Acc: 0.266
Validation loss decreased (-0.262343 --> -0.266144).  Saving model ...
Epoch: 6 cost time: 2.068134307861328
Epoch: 6, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.454 Vali Acc: 0.270 Test Loss: 1.454 Test Acc: 0.270
Validation loss decreased (-0.266144 --> -0.269947).  Saving model ...
Epoch: 7 cost time: 2.3165886402130127
Epoch: 7, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.576 Vali Acc: 0.259 Test Loss: 1.576 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.37787127494812
Epoch: 8, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.628 Vali Acc: 0.251 Test Loss: 1.628 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8705387115478516
Epoch: 9, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.481 Vali Acc: 0.255 Test Loss: 1.481 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.290604591369629
Epoch: 10, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.579 Vali Acc: 0.266 Test Loss: 1.579 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.538405656814575
Epoch: 11, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.499 Vali Acc: 0.270 Test Loss: 1.499 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.1720497608184814
Epoch: 12, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.583 Vali Acc: 0.270 Test Loss: 1.583 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.0169990062713623
Epoch: 13, Steps: 17 | Train Loss: 1.208 Vali Loss: 1.652 Vali Acc: 0.243 Test Loss: 1.652 Test Acc: 0.243
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.210662603378296
Epoch: 14, Steps: 17 | Train Loss: 1.154 Vali Loss: 1.759 Vali Acc: 0.247 Test Loss: 1.759 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.299872636795044
Epoch: 15, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.741 Vali Acc: 0.266 Test Loss: 1.741 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.290415048599243
Epoch: 16, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.802 Vali Acc: 0.266 Test Loss: 1.802 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.26996197718631176
model parameter : 199880
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9572291374206543
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.430 Vali Acc: 0.255 Test Loss: 1.430 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 2.100449562072754
Epoch: 2, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.474 Vali Acc: 0.221 Test Loss: 1.474 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.016587018966675
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.663 Vali Acc: 0.266 Test Loss: 1.663 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266143).  Saving model ...
Epoch: 4 cost time: 2.242705821990967
Epoch: 4, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.560 Vali Acc: 0.259 Test Loss: 1.560 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2177646160125732
Epoch: 5, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.604 Vali Acc: 0.247 Test Loss: 1.604 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.281229257583618
Epoch: 6, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.578 Vali Acc: 0.266 Test Loss: 1.578 Test Acc: 0.266
Validation loss decreased (-0.266143 --> -0.266144).  Saving model ...
Epoch: 7 cost time: 2.2637157440185547
Epoch: 7, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.429 Vali Acc: 0.274 Test Loss: 1.429 Test Acc: 0.274
Validation loss decreased (-0.266144 --> -0.273750).  Saving model ...
Epoch: 8 cost time: 2.1964969635009766
Epoch: 8, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.500 Vali Acc: 0.266 Test Loss: 1.500 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.182474374771118
Epoch: 9, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.791 Vali Acc: 0.262 Test Loss: 1.791 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.045776128768921
Epoch: 10, Steps: 17 | Train Loss: 1.387 Vali Loss: 2.066 Vali Acc: 0.255 Test Loss: 2.066 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.195572853088379
Epoch: 11, Steps: 17 | Train Loss: 1.498 Vali Loss: 1.608 Vali Acc: 0.259 Test Loss: 1.608 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.261219024658203
Epoch: 12, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.492 Vali Acc: 0.274 Test Loss: 1.492 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.1560068130493164
Epoch: 13, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.641 Vali Acc: 0.251 Test Loss: 1.641 Test Acc: 0.251
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.372357130050659
Epoch: 14, Steps: 17 | Train Loss: 1.225 Vali Loss: 1.716 Vali Acc: 0.251 Test Loss: 1.716 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.348129987716675
Epoch: 15, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.754 Vali Acc: 0.247 Test Loss: 1.754 Test Acc: 0.247
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.057600498199463
Epoch: 16, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.606 Vali Acc: 0.259 Test Loss: 1.606 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.15738582611084
Epoch: 17, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.755 Vali Acc: 0.255 Test Loss: 1.755 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2737642585551331
model parameter : 192872
model size : 1.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6893720626831055
Epoch: 1, Steps: 17 | Train Loss: 1.411 Vali Loss: 1.400 Vali Acc: 0.285 Test Loss: 1.400 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.9178872108459473
Epoch: 2, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.408 Vali Acc: 0.270 Test Loss: 1.408 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.005770683288574
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.523 Vali Acc: 0.255 Test Loss: 1.523 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2016453742980957
Epoch: 4, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.508 Vali Acc: 0.278 Test Loss: 1.508 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8253676891326904
Epoch: 5, Steps: 17 | Train Loss: 1.427 Vali Loss: 1.494 Vali Acc: 0.251 Test Loss: 1.494 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.237945318222046
Epoch: 6, Steps: 17 | Train Loss: 1.377 Vali Loss: 1.398 Vali Acc: 0.281 Test Loss: 1.398 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.9861717224121094
Epoch: 7, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.598 Vali Acc: 0.262 Test Loss: 1.598 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 2.023601770401001
Epoch: 8, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.737 Vali Acc: 0.266 Test Loss: 1.737 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 2.2974772453308105
Epoch: 9, Steps: 17 | Train Loss: 1.361 Vali Loss: 1.443 Vali Acc: 0.259 Test Loss: 1.443 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 2.060035228729248
Epoch: 10, Steps: 17 | Train Loss: 1.373 Vali Loss: 1.516 Vali Acc: 0.259 Test Loss: 1.516 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 2.1190097332000732
Epoch: 11, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.489 Vali Acc: 0.285 Test Loss: 1.489 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.28517110266159695
model parameter : 185864
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.0646281242370605
Epoch: 1, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.390 Vali Acc: 0.217 Test Loss: 1.390 Test Acc: 0.217
Validation loss decreased (inf --> -0.216716).  Saving model ...
Epoch: 2 cost time: 1.6633729934692383
Epoch: 2, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.388 Vali Acc: 0.281 Test Loss: 1.388 Test Acc: 0.281
Validation loss decreased (-0.216716 --> -0.281355).  Saving model ...
Epoch: 3 cost time: 1.6268455982208252
Epoch: 3, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.424 Vali Acc: 0.259 Test Loss: 1.424 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.015676259994507
Epoch: 4, Steps: 17 | Train Loss: 1.364 Vali Loss: 1.554 Vali Acc: 0.255 Test Loss: 1.554 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.8671042919158936
Epoch: 5, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.608 Vali Acc: 0.240 Test Loss: 1.608 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9295177459716797
Epoch: 6, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.461 Vali Acc: 0.274 Test Loss: 1.461 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6759395599365234
Epoch: 7, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.551 Vali Acc: 0.270 Test Loss: 1.551 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.8174710273742676
Epoch: 8, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.487 Vali Acc: 0.262 Test Loss: 1.487 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9057772159576416
Epoch: 9, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.474 Vali Acc: 0.266 Test Loss: 1.474 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.0006601810455322
Epoch: 10, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.489 Vali Acc: 0.236 Test Loss: 1.489 Test Acc: 0.236
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.9120869636535645
Epoch: 11, Steps: 17 | Train Loss: 1.245 Vali Loss: 1.491 Vali Acc: 0.255 Test Loss: 1.491 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.831815242767334
Epoch: 12, Steps: 17 | Train Loss: 1.186 Vali Loss: 1.472 Vali Acc: 0.297 Test Loss: 1.472 Test Acc: 0.297
Validation loss decreased (-0.281355 --> -0.296563).  Saving model ...
Epoch: 13 cost time: 1.6419892311096191
Epoch: 13, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.715 Vali Acc: 0.243 Test Loss: 1.715 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9947254657745361
Epoch: 14, Steps: 17 | Train Loss: 1.199 Vali Loss: 1.773 Vali Acc: 0.243 Test Loss: 1.773 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.861191749572754
Epoch: 15, Steps: 17 | Train Loss: 1.214 Vali Loss: 1.614 Vali Acc: 0.262 Test Loss: 1.614 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9173948764801025
Epoch: 16, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.625 Vali Acc: 0.274 Test Loss: 1.625 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9158680438995361
Epoch: 17, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.928 Vali Acc: 0.270 Test Loss: 1.928 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.850987434387207
Epoch: 18, Steps: 17 | Train Loss: 1.106 Vali Loss: 1.649 Vali Acc: 0.293 Test Loss: 1.649 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.135878562927246
Epoch: 19, Steps: 17 | Train Loss: 1.025 Vali Loss: 1.673 Vali Acc: 0.274 Test Loss: 1.673 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.9568796157836914
Epoch: 20, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.807 Vali Acc: 0.266 Test Loss: 1.807 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8437936305999756
Epoch: 21, Steps: 17 | Train Loss: 0.987 Vali Loss: 1.855 Vali Acc: 0.259 Test Loss: 1.855 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.668107271194458
Epoch: 22, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.716 Vali Acc: 0.278 Test Loss: 1.716 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 178856
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.778364419937134
Epoch: 1, Steps: 17 | Train Loss: 1.874 Vali Loss: 1.824 Vali Acc: 0.262 Test Loss: 1.824 Test Acc: 0.262
Validation loss decreased (inf --> -0.262339).  Saving model ...
Epoch: 2 cost time: 1.789121389389038
Epoch: 2, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.910 Vali Acc: 0.259 Test Loss: 1.910 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5606203079223633
Epoch: 3, Steps: 17 | Train Loss: 1.768 Vali Loss: 2.490 Vali Acc: 0.270 Test Loss: 2.490 Test Acc: 0.270
Validation loss decreased (-0.262339 --> -0.269937).  Saving model ...
Epoch: 4 cost time: 1.8101632595062256
Epoch: 4, Steps: 17 | Train Loss: 2.134 Vali Loss: 3.538 Vali Acc: 0.251 Test Loss: 3.538 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7264378070831299
Epoch: 5, Steps: 17 | Train Loss: 2.339 Vali Loss: 1.955 Vali Acc: 0.304 Test Loss: 1.955 Test Acc: 0.304
Validation loss decreased (-0.269937 --> -0.304163).  Saving model ...
Epoch: 6 cost time: 1.6360313892364502
Epoch: 6, Steps: 17 | Train Loss: 1.837 Vali Loss: 2.233 Vali Acc: 0.251 Test Loss: 2.233 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6115617752075195
Epoch: 7, Steps: 17 | Train Loss: 1.901 Vali Loss: 3.481 Vali Acc: 0.247 Test Loss: 3.481 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6354765892028809
Epoch: 8, Steps: 17 | Train Loss: 1.764 Vali Loss: 1.832 Vali Acc: 0.300 Test Loss: 1.832 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9214887619018555
Epoch: 9, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.907 Vali Acc: 0.293 Test Loss: 1.907 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1855738162994385
Epoch: 10, Steps: 17 | Train Loss: 1.329 Vali Loss: 2.234 Vali Acc: 0.278 Test Loss: 2.234 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.938478708267212
Epoch: 11, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.761 Vali Acc: 0.278 Test Loss: 2.761 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.0710771083831787
Epoch: 12, Steps: 17 | Train Loss: 1.215 Vali Loss: 2.011 Vali Acc: 0.304 Test Loss: 2.011 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.133073329925537
Epoch: 13, Steps: 17 | Train Loss: 0.984 Vali Loss: 2.859 Vali Acc: 0.316 Test Loss: 2.859 Test Acc: 0.316
Validation loss decreased (-0.304163 --> -0.315561).  Saving model ...
Epoch: 14 cost time: 1.9103424549102783
Epoch: 14, Steps: 17 | Train Loss: 1.171 Vali Loss: 2.556 Vali Acc: 0.319 Test Loss: 2.556 Test Acc: 0.319
Validation loss decreased (-0.315561 --> -0.319366).  Saving model ...
Epoch: 15 cost time: 2.1505208015441895
Epoch: 15, Steps: 17 | Train Loss: 1.008 Vali Loss: 2.598 Vali Acc: 0.327 Test Loss: 2.598 Test Acc: 0.327
Validation loss decreased (-0.319366 --> -0.326970).  Saving model ...
Epoch: 16 cost time: 2.3457727432250977
Epoch: 16, Steps: 17 | Train Loss: 1.001 Vali Loss: 2.222 Vali Acc: 0.300 Test Loss: 2.222 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.209740161895752
Epoch: 17, Steps: 17 | Train Loss: 0.819 Vali Loss: 2.703 Vali Acc: 0.289 Test Loss: 2.703 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.1094813346862793
Epoch: 18, Steps: 17 | Train Loss: 1.405 Vali Loss: 3.899 Vali Acc: 0.281 Test Loss: 3.899 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1257247924804688
Epoch: 19, Steps: 17 | Train Loss: 1.105 Vali Loss: 2.688 Vali Acc: 0.323 Test Loss: 2.688 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.315001964569092
Epoch: 20, Steps: 17 | Train Loss: 0.643 Vali Loss: 2.437 Vali Acc: 0.369 Test Loss: 2.437 Test Acc: 0.369
Validation loss decreased (-0.326970 --> -0.368797).  Saving model ...
Epoch: 21 cost time: 2.4816908836364746
Epoch: 21, Steps: 17 | Train Loss: 0.620 Vali Loss: 2.710 Vali Acc: 0.335 Test Loss: 2.710 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2653517723083496
Epoch: 22, Steps: 17 | Train Loss: 0.726 Vali Loss: 3.393 Vali Acc: 0.293 Test Loss: 3.393 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1474757194519043
Epoch: 23, Steps: 17 | Train Loss: 0.694 Vali Loss: 2.961 Vali Acc: 0.316 Test Loss: 2.961 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.166041374206543
Epoch: 24, Steps: 17 | Train Loss: 0.852 Vali Loss: 3.178 Vali Acc: 0.316 Test Loss: 3.178 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9987154006958008
Epoch: 25, Steps: 17 | Train Loss: 0.759 Vali Loss: 3.956 Vali Acc: 0.316 Test Loss: 3.956 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.0245182514190674
Epoch: 26, Steps: 17 | Train Loss: 0.453 Vali Loss: 3.737 Vali Acc: 0.297 Test Loss: 3.737 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.133753776550293
Epoch: 27, Steps: 17 | Train Loss: 0.550 Vali Loss: 3.642 Vali Acc: 0.354 Test Loss: 3.642 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.145526647567749
Epoch: 28, Steps: 17 | Train Loss: 0.920 Vali Loss: 4.091 Vali Acc: 0.278 Test Loss: 4.091 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.3394336700439453
Epoch: 29, Steps: 17 | Train Loss: 0.707 Vali Loss: 4.262 Vali Acc: 0.323 Test Loss: 4.262 Test Acc: 0.323
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.2067978382110596
Epoch: 30, Steps: 17 | Train Loss: 0.725 Vali Loss: 4.023 Vali Acc: 0.319 Test Loss: 4.023 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3688212927756654
model parameter : 5463580
model size : 25.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9234068393707275
Epoch: 1, Steps: 17 | Train Loss: 1.791 Vali Loss: 1.659 Vali Acc: 0.259 Test Loss: 1.659 Test Acc: 0.259
Validation loss decreased (inf --> -0.258539).  Saving model ...
Epoch: 2 cost time: 2.044363260269165
Epoch: 2, Steps: 17 | Train Loss: 1.708 Vali Loss: 2.015 Vali Acc: 0.266 Test Loss: 2.015 Test Acc: 0.266
Validation loss decreased (-0.258539 --> -0.266140).  Saving model ...
Epoch: 3 cost time: 1.9998643398284912
Epoch: 3, Steps: 17 | Train Loss: 1.980 Vali Loss: 3.001 Vali Acc: 0.251 Test Loss: 3.001 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0922961235046387
Epoch: 4, Steps: 17 | Train Loss: 2.570 Vali Loss: 2.997 Vali Acc: 0.251 Test Loss: 2.997 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.117518424987793
Epoch: 5, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.978 Vali Acc: 0.274 Test Loss: 1.978 Test Acc: 0.274
Validation loss decreased (-0.266140 --> -0.273744).  Saving model ...
Epoch: 6 cost time: 2.1040570735931396
Epoch: 6, Steps: 17 | Train Loss: 1.984 Vali Loss: 2.795 Vali Acc: 0.240 Test Loss: 2.795 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.303394079208374
Epoch: 7, Steps: 17 | Train Loss: 2.123 Vali Loss: 1.788 Vali Acc: 0.346 Test Loss: 1.788 Test Acc: 0.346
Validation loss decreased (-0.273744 --> -0.345990).  Saving model ...
Epoch: 8 cost time: 2.4383413791656494
Epoch: 8, Steps: 17 | Train Loss: 1.615 Vali Loss: 2.551 Vali Acc: 0.262 Test Loss: 2.551 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.942659616470337
Epoch: 9, Steps: 17 | Train Loss: 1.631 Vali Loss: 2.324 Vali Acc: 0.274 Test Loss: 2.324 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8036563396453857
Epoch: 10, Steps: 17 | Train Loss: 1.270 Vali Loss: 2.677 Vali Acc: 0.270 Test Loss: 2.677 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.257967710494995
Epoch: 11, Steps: 17 | Train Loss: 1.310 Vali Loss: 2.596 Vali Acc: 0.266 Test Loss: 2.596 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.298185348510742
Epoch: 12, Steps: 17 | Train Loss: 1.780 Vali Loss: 2.193 Vali Acc: 0.255 Test Loss: 2.193 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.258331060409546
Epoch: 13, Steps: 17 | Train Loss: 0.974 Vali Loss: 2.111 Vali Acc: 0.316 Test Loss: 2.111 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.279372215270996
Epoch: 14, Steps: 17 | Train Loss: 1.113 Vali Loss: 2.373 Vali Acc: 0.289 Test Loss: 2.373 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.290855646133423
Epoch: 15, Steps: 17 | Train Loss: 0.899 Vali Loss: 2.555 Vali Acc: 0.289 Test Loss: 2.555 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.2537436485290527
Epoch: 16, Steps: 17 | Train Loss: 0.784 Vali Loss: 2.982 Vali Acc: 0.308 Test Loss: 2.982 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.993952989578247
Epoch: 17, Steps: 17 | Train Loss: 1.093 Vali Loss: 2.312 Vali Acc: 0.323 Test Loss: 2.312 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34600760456273766
model parameter : 5426204
model size : 25.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.893108367919922
Epoch: 1, Steps: 17 | Train Loss: 1.578 Vali Loss: 1.606 Vali Acc: 0.274 Test Loss: 1.606 Test Acc: 0.274
Validation loss decreased (inf --> -0.273748).  Saving model ...
Epoch: 2 cost time: 1.7746655941009521
Epoch: 2, Steps: 17 | Train Loss: 1.834 Vali Loss: 2.541 Vali Acc: 0.266 Test Loss: 2.541 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.29070782661438
Epoch: 3, Steps: 17 | Train Loss: 2.585 Vali Loss: 2.101 Vali Acc: 0.243 Test Loss: 2.101 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.4915270805358887
Epoch: 4, Steps: 17 | Train Loss: 2.272 Vali Loss: 2.115 Vali Acc: 0.251 Test Loss: 2.115 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.357412099838257
Epoch: 5, Steps: 17 | Train Loss: 1.866 Vali Loss: 2.136 Vali Acc: 0.259 Test Loss: 2.136 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.9200847148895264
Epoch: 6, Steps: 17 | Train Loss: 1.859 Vali Loss: 1.752 Vali Acc: 0.300 Test Loss: 1.752 Test Acc: 0.300
Validation loss decreased (-0.273748 --> -0.300363).  Saving model ...
Epoch: 7 cost time: 2.364626169204712
Epoch: 7, Steps: 17 | Train Loss: 1.661 Vali Loss: 2.321 Vali Acc: 0.278 Test Loss: 2.321 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.039579153060913
Epoch: 8, Steps: 17 | Train Loss: 1.530 Vali Loss: 2.133 Vali Acc: 0.262 Test Loss: 2.133 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0051822662353516
Epoch: 9, Steps: 17 | Train Loss: 1.703 Vali Loss: 2.488 Vali Acc: 0.289 Test Loss: 2.488 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.436915159225464
Epoch: 10, Steps: 17 | Train Loss: 1.453 Vali Loss: 2.100 Vali Acc: 0.331 Test Loss: 2.100 Test Acc: 0.331
Validation loss decreased (-0.300363 --> -0.330777).  Saving model ...
Epoch: 11 cost time: 2.216611385345459
Epoch: 11, Steps: 17 | Train Loss: 1.425 Vali Loss: 2.256 Vali Acc: 0.300 Test Loss: 2.256 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4846293926239014
Epoch: 12, Steps: 17 | Train Loss: 1.229 Vali Loss: 2.545 Vali Acc: 0.278 Test Loss: 2.545 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0574588775634766
Epoch: 13, Steps: 17 | Train Loss: 1.425 Vali Loss: 2.522 Vali Acc: 0.289 Test Loss: 2.522 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.225494146347046
Epoch: 14, Steps: 17 | Train Loss: 1.440 Vali Loss: 2.739 Vali Acc: 0.289 Test Loss: 2.739 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3873205184936523
Epoch: 15, Steps: 17 | Train Loss: 1.353 Vali Loss: 2.619 Vali Acc: 0.308 Test Loss: 2.619 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.2150988578796387
Epoch: 16, Steps: 17 | Train Loss: 1.113 Vali Loss: 2.261 Vali Acc: 0.308 Test Loss: 2.261 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.7812304496765137
Epoch: 17, Steps: 17 | Train Loss: 1.220 Vali Loss: 2.313 Vali Acc: 0.335 Test Loss: 2.313 Test Acc: 0.335
Validation loss decreased (-0.330777 --> -0.334578).  Saving model ...
Epoch: 18 cost time: 2.1680517196655273
Epoch: 18, Steps: 17 | Train Loss: 0.927 Vali Loss: 3.955 Vali Acc: 0.300 Test Loss: 3.955 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.39760684967041
Epoch: 19, Steps: 17 | Train Loss: 1.244 Vali Loss: 2.510 Vali Acc: 0.346 Test Loss: 2.510 Test Acc: 0.346
Validation loss decreased (-0.334578 --> -0.345983).  Saving model ...
Epoch: 20 cost time: 2.6785852909088135
Epoch: 20, Steps: 17 | Train Loss: 0.903 Vali Loss: 2.530 Vali Acc: 0.312 Test Loss: 2.530 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2937231063842773
Epoch: 21, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.971 Vali Acc: 0.312 Test Loss: 2.971 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.2347936630249023
Epoch: 22, Steps: 17 | Train Loss: 0.870 Vali Loss: 4.021 Vali Acc: 0.281 Test Loss: 4.021 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.3082475662231445
Epoch: 23, Steps: 17 | Train Loss: 1.084 Vali Loss: 3.211 Vali Acc: 0.331 Test Loss: 3.211 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.5348920822143555
Epoch: 24, Steps: 17 | Train Loss: 0.785 Vali Loss: 3.197 Vali Acc: 0.331 Test Loss: 3.197 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.394564151763916
Epoch: 25, Steps: 17 | Train Loss: 0.699 Vali Loss: 3.623 Vali Acc: 0.289 Test Loss: 3.623 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.105930805206299
Epoch: 26, Steps: 17 | Train Loss: 0.650 Vali Loss: 2.788 Vali Acc: 0.346 Test Loss: 2.788 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.234386682510376
Epoch: 27, Steps: 17 | Train Loss: 0.675 Vali Loss: 3.346 Vali Acc: 0.354 Test Loss: 3.346 Test Acc: 0.354
Validation loss decreased (-0.345983 --> -0.353579).  Saving model ...
Epoch: 28 cost time: 2.009406089782715
Epoch: 28, Steps: 17 | Train Loss: 0.742 Vali Loss: 3.493 Vali Acc: 0.335 Test Loss: 3.493 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.0111887454986572
Epoch: 29, Steps: 17 | Train Loss: 0.495 Vali Loss: 4.035 Vali Acc: 0.350 Test Loss: 4.035 Test Acc: 0.350
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9451661109924316
Epoch: 30, Steps: 17 | Train Loss: 0.587 Vali Loss: 4.393 Vali Acc: 0.281 Test Loss: 4.393 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 2.8207433223724365
Epoch: 31, Steps: 17 | Train Loss: 0.402 Vali Loss: 3.962 Vali Acc: 0.308 Test Loss: 3.962 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 2.5831847190856934
Epoch: 32, Steps: 17 | Train Loss: 0.447 Vali Loss: 4.818 Vali Acc: 0.293 Test Loss: 4.818 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 2.626121759414673
Epoch: 33, Steps: 17 | Train Loss: 0.471 Vali Loss: 4.223 Vali Acc: 0.365 Test Loss: 4.223 Test Acc: 0.365
Validation loss decreased (-0.353579 --> -0.364977).  Saving model ...
Epoch: 34 cost time: 2.512972116470337
Epoch: 34, Steps: 17 | Train Loss: 0.590 Vali Loss: 3.911 Vali Acc: 0.327 Test Loss: 3.911 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 2.0666286945343018
Epoch: 35, Steps: 17 | Train Loss: 0.495 Vali Loss: 4.894 Vali Acc: 0.285 Test Loss: 4.894 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 2.6763110160827637
Epoch: 36, Steps: 17 | Train Loss: 0.544 Vali Loss: 5.061 Vali Acc: 0.342 Test Loss: 5.061 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 2.5625534057617188
Epoch: 37, Steps: 17 | Train Loss: 0.851 Vali Loss: 5.412 Vali Acc: 0.316 Test Loss: 5.412 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 2.556339740753174
Epoch: 38, Steps: 17 | Train Loss: 0.569 Vali Loss: 5.373 Vali Acc: 0.304 Test Loss: 5.373 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 2.366334915161133
Epoch: 39, Steps: 17 | Train Loss: 0.353 Vali Loss: 5.692 Vali Acc: 0.335 Test Loss: 5.692 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 2.7232542037963867
Epoch: 40, Steps: 17 | Train Loss: 0.877 Vali Loss: 5.385 Vali Acc: 0.361 Test Loss: 5.385 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 2.243497371673584
Epoch: 41, Steps: 17 | Train Loss: 0.538 Vali Loss: 6.892 Vali Acc: 0.312 Test Loss: 6.892 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.8751873970031738
Epoch: 42, Steps: 17 | Train Loss: 0.690 Vali Loss: 6.588 Vali Acc: 0.300 Test Loss: 6.588 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.7652859687805176
Epoch: 43, Steps: 17 | Train Loss: 0.873 Vali Loss: 5.820 Vali Acc: 0.304 Test Loss: 5.820 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3650190114068441
model parameter : 5388828
model size : 25.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5863401889801025
Epoch: 1, Steps: 17 | Train Loss: 1.778 Vali Loss: 1.931 Vali Acc: 0.266 Test Loss: 1.931 Test Acc: 0.266
Validation loss decreased (inf --> -0.266140).  Saving model ...
Epoch: 2 cost time: 2.1228926181793213
Epoch: 2, Steps: 17 | Train Loss: 1.880 Vali Loss: 2.631 Vali Acc: 0.255 Test Loss: 2.631 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.2761480808258057
Epoch: 3, Steps: 17 | Train Loss: 1.840 Vali Loss: 3.078 Vali Acc: 0.228 Test Loss: 3.078 Test Acc: 0.228
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.2399842739105225
Epoch: 4, Steps: 17 | Train Loss: 2.576 Vali Loss: 3.310 Vali Acc: 0.293 Test Loss: 3.310 Test Acc: 0.293
Validation loss decreased (-0.266140 --> -0.292743).  Saving model ...
Epoch: 5 cost time: 1.9936528205871582
Epoch: 5, Steps: 17 | Train Loss: 2.698 Vali Loss: 2.907 Vali Acc: 0.251 Test Loss: 2.907 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.028654098510742
Epoch: 6, Steps: 17 | Train Loss: 1.777 Vali Loss: 2.848 Vali Acc: 0.255 Test Loss: 2.848 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7254374027252197
Epoch: 7, Steps: 17 | Train Loss: 1.642 Vali Loss: 2.707 Vali Acc: 0.281 Test Loss: 2.707 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.076622486114502
Epoch: 8, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.673 Vali Acc: 0.293 Test Loss: 1.673 Test Acc: 0.293
Validation loss decreased (-0.292743 --> -0.292759).  Saving model ...
Epoch: 9 cost time: 1.9698703289031982
Epoch: 9, Steps: 17 | Train Loss: 1.205 Vali Loss: 1.749 Vali Acc: 0.338 Test Loss: 1.749 Test Acc: 0.338
Validation loss decreased (-0.292759 --> -0.338386).  Saving model ...
Epoch: 10 cost time: 1.6928424835205078
Epoch: 10, Steps: 17 | Train Loss: 1.639 Vali Loss: 2.200 Vali Acc: 0.300 Test Loss: 2.200 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2194674015045166
Epoch: 11, Steps: 17 | Train Loss: 1.385 Vali Loss: 2.791 Vali Acc: 0.289 Test Loss: 2.791 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.040940284729004
Epoch: 12, Steps: 17 | Train Loss: 1.762 Vali Loss: 2.322 Vali Acc: 0.285 Test Loss: 2.322 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.9885296821594238
Epoch: 13, Steps: 17 | Train Loss: 1.013 Vali Loss: 2.161 Vali Acc: 0.323 Test Loss: 2.161 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.8066465854644775
Epoch: 14, Steps: 17 | Train Loss: 1.024 Vali Loss: 2.580 Vali Acc: 0.338 Test Loss: 2.580 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.2071990966796875
Epoch: 15, Steps: 17 | Train Loss: 1.009 Vali Loss: 3.910 Vali Acc: 0.270 Test Loss: 3.910 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.227052688598633
Epoch: 16, Steps: 17 | Train Loss: 1.255 Vali Loss: 2.197 Vali Acc: 0.293 Test Loss: 2.197 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.117239475250244
Epoch: 17, Steps: 17 | Train Loss: 1.105 Vali Loss: 3.188 Vali Acc: 0.270 Test Loss: 3.188 Test Acc: 0.270
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.6994993686676025
Epoch: 18, Steps: 17 | Train Loss: 0.982 Vali Loss: 2.583 Vali Acc: 0.285 Test Loss: 2.583 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.888087511062622
Epoch: 19, Steps: 17 | Train Loss: 0.848 Vali Loss: 3.371 Vali Acc: 0.278 Test Loss: 3.371 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33840304182509506
model parameter : 5351452
model size : 25.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7681055068969727
Epoch: 1, Steps: 17 | Train Loss: 1.643 Vali Loss: 2.141 Vali Acc: 0.266 Test Loss: 2.141 Test Acc: 0.266
Validation loss decreased (inf --> -0.266138).  Saving model ...
Epoch: 2 cost time: 2.1594302654266357
Epoch: 2, Steps: 17 | Train Loss: 2.018 Vali Loss: 1.826 Vali Acc: 0.266 Test Loss: 1.826 Test Acc: 0.266
Validation loss decreased (-0.266138 --> -0.266141).  Saving model ...
Epoch: 3 cost time: 2.0656116008758545
Epoch: 3, Steps: 17 | Train Loss: 2.503 Vali Loss: 3.043 Vali Acc: 0.255 Test Loss: 3.043 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1263582706451416
Epoch: 4, Steps: 17 | Train Loss: 3.173 Vali Loss: 3.869 Vali Acc: 0.251 Test Loss: 3.869 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.098172664642334
Epoch: 5, Steps: 17 | Train Loss: 1.998 Vali Loss: 2.560 Vali Acc: 0.247 Test Loss: 2.560 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5757346153259277
Epoch: 6, Steps: 17 | Train Loss: 2.012 Vali Loss: 2.024 Vali Acc: 0.262 Test Loss: 2.024 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.567406415939331
Epoch: 7, Steps: 17 | Train Loss: 1.961 Vali Loss: 2.510 Vali Acc: 0.236 Test Loss: 2.510 Test Acc: 0.236
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.3082289695739746
Epoch: 8, Steps: 17 | Train Loss: 1.826 Vali Loss: 2.456 Vali Acc: 0.255 Test Loss: 2.456 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.1905601024627686
Epoch: 9, Steps: 17 | Train Loss: 1.800 Vali Loss: 2.251 Vali Acc: 0.300 Test Loss: 2.251 Test Acc: 0.300
Validation loss decreased (-0.266141 --> -0.300358).  Saving model ...
Epoch: 10 cost time: 2.3013064861297607
Epoch: 10, Steps: 17 | Train Loss: 1.292 Vali Loss: 2.482 Vali Acc: 0.262 Test Loss: 2.482 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1939241886138916
Epoch: 11, Steps: 17 | Train Loss: 1.342 Vali Loss: 2.835 Vali Acc: 0.259 Test Loss: 2.835 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.1619887351989746
Epoch: 12, Steps: 17 | Train Loss: 1.536 Vali Loss: 2.738 Vali Acc: 0.255 Test Loss: 2.738 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1995317935943604
Epoch: 13, Steps: 17 | Train Loss: 1.224 Vali Loss: 2.393 Vali Acc: 0.338 Test Loss: 2.393 Test Acc: 0.338
Validation loss decreased (-0.300358 --> -0.338379).  Saving model ...
Epoch: 14 cost time: 2.019747734069824
Epoch: 14, Steps: 17 | Train Loss: 1.022 Vali Loss: 2.294 Vali Acc: 0.308 Test Loss: 2.294 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1382274627685547
Epoch: 15, Steps: 17 | Train Loss: 1.335 Vali Loss: 2.193 Vali Acc: 0.331 Test Loss: 2.193 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8219118118286133
Epoch: 16, Steps: 17 | Train Loss: 1.181 Vali Loss: 2.308 Vali Acc: 0.319 Test Loss: 2.308 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9956223964691162
Epoch: 17, Steps: 17 | Train Loss: 1.031 Vali Loss: 2.785 Vali Acc: 0.297 Test Loss: 2.785 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.157895803451538
Epoch: 18, Steps: 17 | Train Loss: 1.078 Vali Loss: 4.199 Vali Acc: 0.255 Test Loss: 4.199 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0406858921051025
Epoch: 19, Steps: 17 | Train Loss: 1.326 Vali Loss: 4.179 Vali Acc: 0.278 Test Loss: 4.179 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.345919609069824
Epoch: 20, Steps: 17 | Train Loss: 1.201 Vali Loss: 2.826 Vali Acc: 0.319 Test Loss: 2.826 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.4126250743865967
Epoch: 21, Steps: 17 | Train Loss: 0.823 Vali Loss: 3.627 Vali Acc: 0.300 Test Loss: 3.627 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.3096203804016113
Epoch: 22, Steps: 17 | Train Loss: 1.188 Vali Loss: 3.267 Vali Acc: 0.262 Test Loss: 3.267 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1951518058776855
Epoch: 23, Steps: 17 | Train Loss: 0.885 Vali Loss: 3.366 Vali Acc: 0.304 Test Loss: 3.366 Test Acc: 0.304
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33840304182509506
model parameter : 4675612
model size : 22.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.064045190811157
Epoch: 1, Steps: 17 | Train Loss: 1.947 Vali Loss: 2.154 Vali Acc: 0.278 Test Loss: 2.154 Test Acc: 0.278
Validation loss decreased (inf --> -0.277545).  Saving model ...
Epoch: 2 cost time: 2.022500991821289
Epoch: 2, Steps: 17 | Train Loss: 2.308 Vali Loss: 2.215 Vali Acc: 0.247 Test Loss: 2.215 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.125525951385498
Epoch: 3, Steps: 17 | Train Loss: 1.854 Vali Loss: 1.783 Vali Acc: 0.300 Test Loss: 1.783 Test Acc: 0.300
Validation loss decreased (-0.277545 --> -0.300362).  Saving model ...
Epoch: 4 cost time: 2.0161261558532715
Epoch: 4, Steps: 17 | Train Loss: 1.607 Vali Loss: 2.447 Vali Acc: 0.251 Test Loss: 2.447 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3425066471099854
Epoch: 5, Steps: 17 | Train Loss: 2.729 Vali Loss: 3.485 Vali Acc: 0.274 Test Loss: 3.485 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8523364067077637
Epoch: 6, Steps: 17 | Train Loss: 2.643 Vali Loss: 3.364 Vali Acc: 0.255 Test Loss: 3.364 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.1305766105651855
Epoch: 7, Steps: 17 | Train Loss: 1.958 Vali Loss: 2.230 Vali Acc: 0.255 Test Loss: 2.230 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8369951248168945
Epoch: 8, Steps: 17 | Train Loss: 1.424 Vali Loss: 2.025 Vali Acc: 0.243 Test Loss: 2.025 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.277132034301758
Epoch: 9, Steps: 17 | Train Loss: 1.514 Vali Loss: 3.281 Vali Acc: 0.259 Test Loss: 3.281 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.3325798511505127
Epoch: 10, Steps: 17 | Train Loss: 1.623 Vali Loss: 1.810 Vali Acc: 0.289 Test Loss: 1.810 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.9697179794311523
Epoch: 11, Steps: 17 | Train Loss: 1.490 Vali Loss: 2.420 Vali Acc: 0.285 Test Loss: 2.420 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6992859840393066
Epoch: 12, Steps: 17 | Train Loss: 1.635 Vali Loss: 2.716 Vali Acc: 0.247 Test Loss: 2.716 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.9685087203979492
Epoch: 13, Steps: 17 | Train Loss: 1.505 Vali Loss: 2.612 Vali Acc: 0.266 Test Loss: 2.612 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30038022813688214
model parameter : 4638236
model size : 22.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.769628047943115
Epoch: 1, Steps: 17 | Train Loss: 1.847 Vali Loss: 1.773 Vali Acc: 0.247 Test Loss: 1.773 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 1.9576618671417236
Epoch: 2, Steps: 17 | Train Loss: 1.765 Vali Loss: 2.278 Vali Acc: 0.259 Test Loss: 2.278 Test Acc: 0.259
Validation loss decreased (-0.247131 --> -0.258532).  Saving model ...
Epoch: 3 cost time: 2.1977133750915527
Epoch: 3, Steps: 17 | Train Loss: 1.870 Vali Loss: 2.146 Vali Acc: 0.221 Test Loss: 2.146 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1938490867614746
Epoch: 4, Steps: 17 | Train Loss: 2.391 Vali Loss: 4.973 Vali Acc: 0.251 Test Loss: 4.973 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.4287726879119873
Epoch: 5, Steps: 17 | Train Loss: 3.170 Vali Loss: 2.396 Vali Acc: 0.266 Test Loss: 2.396 Test Acc: 0.266
Validation loss decreased (-0.258532 --> -0.266136).  Saving model ...
Epoch: 6 cost time: 2.006913900375366
Epoch: 6, Steps: 17 | Train Loss: 2.081 Vali Loss: 3.317 Vali Acc: 0.281 Test Loss: 3.317 Test Acc: 0.281
Validation loss decreased (-0.266136 --> -0.281336).  Saving model ...
Epoch: 7 cost time: 2.1725754737854004
Epoch: 7, Steps: 17 | Train Loss: 2.454 Vali Loss: 1.968 Vali Acc: 0.293 Test Loss: 1.968 Test Acc: 0.293
Validation loss decreased (-0.281336 --> -0.292756).  Saving model ...
Epoch: 8 cost time: 1.9863176345825195
Epoch: 8, Steps: 17 | Train Loss: 1.698 Vali Loss: 2.162 Vali Acc: 0.243 Test Loss: 2.162 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.343632459640503
Epoch: 9, Steps: 17 | Train Loss: 1.941 Vali Loss: 2.099 Vali Acc: 0.255 Test Loss: 2.099 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.929682970046997
Epoch: 10, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.982 Vali Acc: 0.285 Test Loss: 1.982 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.84493088722229
Epoch: 11, Steps: 17 | Train Loss: 1.534 Vali Loss: 2.880 Vali Acc: 0.297 Test Loss: 2.880 Test Acc: 0.297
Validation loss decreased (-0.292756 --> -0.296549).  Saving model ...
Epoch: 12 cost time: 1.8986408710479736
Epoch: 12, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.916 Vali Acc: 0.293 Test Loss: 1.916 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9419500827789307
Epoch: 13, Steps: 17 | Train Loss: 1.078 Vali Loss: 2.049 Vali Acc: 0.293 Test Loss: 2.049 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9104244709014893
Epoch: 14, Steps: 17 | Train Loss: 0.952 Vali Loss: 2.395 Vali Acc: 0.297 Test Loss: 2.395 Test Acc: 0.297
Validation loss decreased (-0.296549 --> -0.296554).  Saving model ...
Epoch: 15 cost time: 1.9610249996185303
Epoch: 15, Steps: 17 | Train Loss: 1.152 Vali Loss: 2.150 Vali Acc: 0.293 Test Loss: 2.150 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9544830322265625
Epoch: 16, Steps: 17 | Train Loss: 0.881 Vali Loss: 2.916 Vali Acc: 0.312 Test Loss: 2.916 Test Acc: 0.312
Validation loss decreased (-0.296554 --> -0.311758).  Saving model ...
Epoch: 17 cost time: 2.1407432556152344
Epoch: 17, Steps: 17 | Train Loss: 1.099 Vali Loss: 2.979 Vali Acc: 0.285 Test Loss: 2.979 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0888988971710205
Epoch: 18, Steps: 17 | Train Loss: 0.979 Vali Loss: 2.574 Vali Acc: 0.281 Test Loss: 2.574 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9419138431549072
Epoch: 19, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.690 Vali Acc: 0.342 Test Loss: 2.690 Test Acc: 0.342
Validation loss decreased (-0.311758 --> -0.342178).  Saving model ...
Epoch: 20 cost time: 1.975548505783081
Epoch: 20, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.964 Vali Acc: 0.335 Test Loss: 2.964 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8567941188812256
Epoch: 21, Steps: 17 | Train Loss: 0.742 Vali Loss: 2.554 Vali Acc: 0.289 Test Loss: 2.554 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0462262630462646
Epoch: 22, Steps: 17 | Train Loss: 0.815 Vali Loss: 2.888 Vali Acc: 0.338 Test Loss: 2.888 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.1502230167388916
Epoch: 23, Steps: 17 | Train Loss: 0.899 Vali Loss: 3.355 Vali Acc: 0.259 Test Loss: 3.355 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9726934432983398
Epoch: 24, Steps: 17 | Train Loss: 0.853 Vali Loss: 3.303 Vali Acc: 0.289 Test Loss: 3.303 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.751891851425171
Epoch: 25, Steps: 17 | Train Loss: 0.773 Vali Loss: 4.312 Vali Acc: 0.285 Test Loss: 4.312 Test Acc: 0.285
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.275310754776001
Epoch: 26, Steps: 17 | Train Loss: 0.908 Vali Loss: 3.933 Vali Acc: 0.308 Test Loss: 3.933 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.2584493160247803
Epoch: 27, Steps: 17 | Train Loss: 0.767 Vali Loss: 3.709 Vali Acc: 0.319 Test Loss: 3.709 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.360767364501953
Epoch: 28, Steps: 17 | Train Loss: 0.717 Vali Loss: 3.843 Vali Acc: 0.304 Test Loss: 3.843 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.1955361366271973
Epoch: 29, Steps: 17 | Train Loss: 0.795 Vali Loss: 3.762 Vali Acc: 0.312 Test Loss: 3.762 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34220532319391633
model parameter : 4600860
model size : 22.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.92101788520813
Epoch: 1, Steps: 17 | Train Loss: 1.980 Vali Loss: 2.923 Vali Acc: 0.247 Test Loss: 2.923 Test Acc: 0.247
Validation loss decreased (inf --> -0.247119).  Saving model ...
Epoch: 2 cost time: 1.9311726093292236
Epoch: 2, Steps: 17 | Train Loss: 2.082 Vali Loss: 3.251 Vali Acc: 0.255 Test Loss: 3.251 Test Acc: 0.255
Validation loss decreased (-0.247119 --> -0.254720).  Saving model ...
Epoch: 3 cost time: 1.8570291996002197
Epoch: 3, Steps: 17 | Train Loss: 2.698 Vali Loss: 2.339 Vali Acc: 0.251 Test Loss: 2.339 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8387811183929443
Epoch: 4, Steps: 17 | Train Loss: 2.516 Vali Loss: 3.189 Vali Acc: 0.247 Test Loss: 3.189 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.878800868988037
Epoch: 5, Steps: 17 | Train Loss: 2.082 Vali Loss: 3.236 Vali Acc: 0.251 Test Loss: 3.236 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9223225116729736
Epoch: 6, Steps: 17 | Train Loss: 1.942 Vali Loss: 2.052 Vali Acc: 0.255 Test Loss: 2.052 Test Acc: 0.255
Validation loss decreased (-0.254720 --> -0.254732).  Saving model ...
Epoch: 7 cost time: 1.7084274291992188
Epoch: 7, Steps: 17 | Train Loss: 1.808 Vali Loss: 3.771 Vali Acc: 0.251 Test Loss: 3.771 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7812345027923584
Epoch: 8, Steps: 17 | Train Loss: 2.126 Vali Loss: 3.751 Vali Acc: 0.255 Test Loss: 3.751 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.758155107498169
Epoch: 9, Steps: 17 | Train Loss: 1.748 Vali Loss: 1.809 Vali Acc: 0.297 Test Loss: 1.809 Test Acc: 0.297
Validation loss decreased (-0.254732 --> -0.296560).  Saving model ...
Epoch: 10 cost time: 1.6672272682189941
Epoch: 10, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.998 Vali Acc: 0.289 Test Loss: 1.998 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6992294788360596
Epoch: 11, Steps: 17 | Train Loss: 1.173 Vali Loss: 3.095 Vali Acc: 0.274 Test Loss: 3.095 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7030985355377197
Epoch: 12, Steps: 17 | Train Loss: 1.547 Vali Loss: 2.108 Vali Acc: 0.316 Test Loss: 2.108 Test Acc: 0.316
Validation loss decreased (-0.296560 --> -0.315568).  Saving model ...
Epoch: 13 cost time: 1.4600400924682617
Epoch: 13, Steps: 17 | Train Loss: 1.482 Vali Loss: 2.748 Vali Acc: 0.262 Test Loss: 2.748 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7949552536010742
Epoch: 14, Steps: 17 | Train Loss: 1.017 Vali Loss: 2.233 Vali Acc: 0.319 Test Loss: 2.233 Test Acc: 0.319
Validation loss decreased (-0.315568 --> -0.319369).  Saving model ...
Epoch: 15 cost time: 1.7733590602874756
Epoch: 15, Steps: 17 | Train Loss: 1.090 Vali Loss: 2.682 Vali Acc: 0.281 Test Loss: 2.682 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6483299732208252
Epoch: 16, Steps: 17 | Train Loss: 1.095 Vali Loss: 2.665 Vali Acc: 0.319 Test Loss: 2.665 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7633521556854248
Epoch: 17, Steps: 17 | Train Loss: 1.017 Vali Loss: 2.438 Vali Acc: 0.300 Test Loss: 2.438 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7118265628814697
Epoch: 18, Steps: 17 | Train Loss: 1.109 Vali Loss: 2.376 Vali Acc: 0.327 Test Loss: 2.376 Test Acc: 0.327
Validation loss decreased (-0.319369 --> -0.326972).  Saving model ...
Epoch: 19 cost time: 1.8724963665008545
Epoch: 19, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.984 Vali Acc: 0.316 Test Loss: 2.984 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9663269519805908
Epoch: 20, Steps: 17 | Train Loss: 0.888 Vali Loss: 2.556 Vali Acc: 0.335 Test Loss: 2.556 Test Acc: 0.335
Validation loss decreased (-0.326972 --> -0.334575).  Saving model ...
Epoch: 21 cost time: 1.8855252265930176
Epoch: 21, Steps: 17 | Train Loss: 0.828 Vali Loss: 2.921 Vali Acc: 0.350 Test Loss: 2.921 Test Acc: 0.350
Validation loss decreased (-0.334575 --> -0.349781).  Saving model ...
Epoch: 22 cost time: 1.8858585357666016
Epoch: 22, Steps: 17 | Train Loss: 0.686 Vali Loss: 3.599 Vali Acc: 0.300 Test Loss: 3.599 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.8545548915863037
Epoch: 23, Steps: 17 | Train Loss: 0.860 Vali Loss: 2.950 Vali Acc: 0.323 Test Loss: 2.950 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9426603317260742
Epoch: 24, Steps: 17 | Train Loss: 0.842 Vali Loss: 3.626 Vali Acc: 0.281 Test Loss: 3.626 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.2019641399383545
Epoch: 25, Steps: 17 | Train Loss: 0.765 Vali Loss: 3.413 Vali Acc: 0.319 Test Loss: 3.413 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7269439697265625
Epoch: 26, Steps: 17 | Train Loss: 0.725 Vali Loss: 3.760 Vali Acc: 0.278 Test Loss: 3.760 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.129042148590088
Epoch: 27, Steps: 17 | Train Loss: 0.646 Vali Loss: 3.521 Vali Acc: 0.297 Test Loss: 3.521 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.0228943824768066
Epoch: 28, Steps: 17 | Train Loss: 0.648 Vali Loss: 4.216 Vali Acc: 0.293 Test Loss: 4.216 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.035160541534424
Epoch: 29, Steps: 17 | Train Loss: 0.662 Vali Loss: 4.106 Vali Acc: 0.289 Test Loss: 4.106 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.2114298343658447
Epoch: 30, Steps: 17 | Train Loss: 0.600 Vali Loss: 4.367 Vali Acc: 0.297 Test Loss: 4.367 Test Acc: 0.297
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.1214230060577393
Epoch: 31, Steps: 17 | Train Loss: 0.397 Vali Loss: 4.496 Vali Acc: 0.278 Test Loss: 4.496 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34980988593155893
model parameter : 4563484
model size : 22.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7057976722717285
Epoch: 1, Steps: 17 | Train Loss: 1.810 Vali Loss: 2.370 Vali Acc: 0.251 Test Loss: 2.370 Test Acc: 0.251
Validation loss decreased (inf --> -0.250927).  Saving model ...
Epoch: 2 cost time: 1.8904294967651367
Epoch: 2, Steps: 17 | Train Loss: 2.710 Vali Loss: 2.854 Vali Acc: 0.274 Test Loss: 2.854 Test Acc: 0.274
Validation loss decreased (-0.250927 --> -0.273736).  Saving model ...
Epoch: 3 cost time: 2.1389901638031006
Epoch: 3, Steps: 17 | Train Loss: 2.447 Vali Loss: 2.651 Vali Acc: 0.274 Test Loss: 2.651 Test Acc: 0.274
Validation loss decreased (-0.273736 --> -0.273738).  Saving model ...
Epoch: 4 cost time: 1.9123451709747314
Epoch: 4, Steps: 17 | Train Loss: 3.073 Vali Loss: 4.025 Vali Acc: 0.247 Test Loss: 4.025 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9393186569213867
Epoch: 5, Steps: 17 | Train Loss: 2.594 Vali Loss: 2.247 Vali Acc: 0.281 Test Loss: 2.247 Test Acc: 0.281
Validation loss decreased (-0.273738 --> -0.281346).  Saving model ...
Epoch: 6 cost time: 1.913595199584961
Epoch: 6, Steps: 17 | Train Loss: 1.671 Vali Loss: 2.422 Vali Acc: 0.274 Test Loss: 2.422 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.620906114578247
Epoch: 7, Steps: 17 | Train Loss: 1.506 Vali Loss: 2.082 Vali Acc: 0.255 Test Loss: 2.082 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.120579719543457
Epoch: 8, Steps: 17 | Train Loss: 2.010 Vali Loss: 3.023 Vali Acc: 0.259 Test Loss: 3.023 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.023106813430786
Epoch: 9, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.911 Vali Acc: 0.289 Test Loss: 1.911 Test Acc: 0.289
Validation loss decreased (-0.281346 --> -0.288954).  Saving model ...
Epoch: 10 cost time: 1.954026222229004
Epoch: 10, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.893 Vali Acc: 0.304 Test Loss: 1.893 Test Acc: 0.304
Validation loss decreased (-0.288954 --> -0.304164).  Saving model ...
Epoch: 11 cost time: 1.878598928451538
Epoch: 11, Steps: 17 | Train Loss: 1.258 Vali Loss: 2.305 Vali Acc: 0.259 Test Loss: 2.305 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.63177490234375
Epoch: 12, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.805 Vali Acc: 0.338 Test Loss: 1.805 Test Acc: 0.338
Validation loss decreased (-0.304164 --> -0.338385).  Saving model ...
Epoch: 13 cost time: 1.7799913883209229
Epoch: 13, Steps: 17 | Train Loss: 1.277 Vali Loss: 2.531 Vali Acc: 0.308 Test Loss: 2.531 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.490509271621704
Epoch: 14, Steps: 17 | Train Loss: 1.076 Vali Loss: 2.953 Vali Acc: 0.278 Test Loss: 2.953 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.567595958709717
Epoch: 15, Steps: 17 | Train Loss: 1.331 Vali Loss: 2.231 Vali Acc: 0.312 Test Loss: 2.231 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6104846000671387
Epoch: 16, Steps: 17 | Train Loss: 0.986 Vali Loss: 3.527 Vali Acc: 0.304 Test Loss: 3.527 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7398219108581543
Epoch: 17, Steps: 17 | Train Loss: 0.956 Vali Loss: 3.224 Vali Acc: 0.289 Test Loss: 3.224 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8802776336669922
Epoch: 18, Steps: 17 | Train Loss: 0.935 Vali Loss: 2.694 Vali Acc: 0.338 Test Loss: 2.694 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.7583200931549072
Epoch: 19, Steps: 17 | Train Loss: 1.091 Vali Loss: 2.492 Vali Acc: 0.297 Test Loss: 2.492 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.582320213317871
Epoch: 20, Steps: 17 | Train Loss: 0.698 Vali Loss: 2.370 Vali Acc: 0.350 Test Loss: 2.370 Test Acc: 0.350
Validation loss decreased (-0.338385 --> -0.349786).  Saving model ...
Epoch: 21 cost time: 1.6288268566131592
Epoch: 21, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.694 Vali Acc: 0.316 Test Loss: 2.694 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7584714889526367
Epoch: 22, Steps: 17 | Train Loss: 0.898 Vali Loss: 2.682 Vali Acc: 0.338 Test Loss: 2.682 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8113679885864258
Epoch: 23, Steps: 17 | Train Loss: 0.711 Vali Loss: 3.174 Vali Acc: 0.346 Test Loss: 3.174 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4416148662567139
Epoch: 24, Steps: 17 | Train Loss: 0.605 Vali Loss: 2.772 Vali Acc: 0.342 Test Loss: 2.772 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.478691816329956
Epoch: 25, Steps: 17 | Train Loss: 0.532 Vali Loss: 3.242 Vali Acc: 0.327 Test Loss: 3.242 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.3348369598388672
Epoch: 26, Steps: 17 | Train Loss: 0.579 Vali Loss: 4.156 Vali Acc: 0.289 Test Loss: 4.156 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.9981544017791748
Epoch: 27, Steps: 17 | Train Loss: 0.619 Vali Loss: 3.969 Vali Acc: 0.308 Test Loss: 3.969 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6384892463684082
Epoch: 28, Steps: 17 | Train Loss: 0.897 Vali Loss: 3.974 Vali Acc: 0.281 Test Loss: 3.974 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9022810459136963
Epoch: 29, Steps: 17 | Train Loss: 0.745 Vali Loss: 3.997 Vali Acc: 0.350 Test Loss: 3.997 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8202235698699951
Epoch: 30, Steps: 17 | Train Loss: 0.548 Vali Loss: 3.666 Vali Acc: 0.369 Test Loss: 3.666 Test Acc: 0.369
Validation loss decreased (-0.349786 --> -0.368785).  Saving model ...
Epoch: 31 cost time: 1.999936580657959
Epoch: 31, Steps: 17 | Train Loss: 0.496 Vali Loss: 4.726 Vali Acc: 0.319 Test Loss: 4.726 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.3148655891418457
Epoch: 32, Steps: 17 | Train Loss: 0.605 Vali Loss: 5.873 Vali Acc: 0.278 Test Loss: 5.873 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.013376235961914
Epoch: 33, Steps: 17 | Train Loss: 1.297 Vali Loss: 4.504 Vali Acc: 0.297 Test Loss: 4.504 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.8655321598052979
Epoch: 34, Steps: 17 | Train Loss: 0.574 Vali Loss: 5.301 Vali Acc: 0.285 Test Loss: 5.301 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.9485869407653809
Epoch: 35, Steps: 17 | Train Loss: 0.534 Vali Loss: 4.680 Vali Acc: 0.304 Test Loss: 4.680 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.8790359497070312
Epoch: 36, Steps: 17 | Train Loss: 0.382 Vali Loss: 4.587 Vali Acc: 0.327 Test Loss: 4.587 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6511693000793457
Epoch: 37, Steps: 17 | Train Loss: 1.013 Vali Loss: 7.658 Vali Acc: 0.255 Test Loss: 7.658 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.0293636322021484
Epoch: 38, Steps: 17 | Train Loss: 0.617 Vali Loss: 5.267 Vali Acc: 0.285 Test Loss: 5.267 Test Acc: 0.285
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.9693982601165771
Epoch: 39, Steps: 17 | Train Loss: 0.441 Vali Loss: 5.355 Vali Acc: 0.338 Test Loss: 5.355 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6416740417480469
Epoch: 40, Steps: 17 | Train Loss: 0.551 Vali Loss: 5.337 Vali Acc: 0.308 Test Loss: 5.337 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3688212927756654
model parameter : 4281628
model size : 21.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.822519540786743
Epoch: 1, Steps: 17 | Train Loss: 1.778 Vali Loss: 2.924 Vali Acc: 0.262 Test Loss: 2.924 Test Acc: 0.262
Validation loss decreased (inf --> -0.262328).  Saving model ...
Epoch: 2 cost time: 1.798377513885498
Epoch: 2, Steps: 17 | Train Loss: 2.153 Vali Loss: 2.297 Vali Acc: 0.270 Test Loss: 2.297 Test Acc: 0.270
Validation loss decreased (-0.262328 --> -0.269939).  Saving model ...
Epoch: 3 cost time: 1.8815834522247314
Epoch: 3, Steps: 17 | Train Loss: 2.403 Vali Loss: 1.985 Vali Acc: 0.255 Test Loss: 1.985 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.0359535217285156
Epoch: 4, Steps: 17 | Train Loss: 2.526 Vali Loss: 4.608 Vali Acc: 0.251 Test Loss: 4.608 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9888191223144531
Epoch: 5, Steps: 17 | Train Loss: 3.050 Vali Loss: 2.191 Vali Acc: 0.262 Test Loss: 2.191 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1207435131073
Epoch: 6, Steps: 17 | Train Loss: 1.631 Vali Loss: 2.532 Vali Acc: 0.293 Test Loss: 2.532 Test Acc: 0.293
Validation loss decreased (-0.269939 --> -0.292750).  Saving model ...
Epoch: 7 cost time: 2.0317540168762207
Epoch: 7, Steps: 17 | Train Loss: 2.012 Vali Loss: 2.452 Vali Acc: 0.266 Test Loss: 2.452 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.086881637573242
Epoch: 8, Steps: 17 | Train Loss: 1.722 Vali Loss: 1.851 Vali Acc: 0.312 Test Loss: 1.851 Test Acc: 0.312
Validation loss decreased (-0.292750 --> -0.311769).  Saving model ...
Epoch: 9 cost time: 2.198716163635254
Epoch: 9, Steps: 17 | Train Loss: 1.790 Vali Loss: 3.833 Vali Acc: 0.259 Test Loss: 3.833 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0585134029388428
Epoch: 10, Steps: 17 | Train Loss: 1.943 Vali Loss: 1.847 Vali Acc: 0.300 Test Loss: 1.847 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3655965328216553
Epoch: 11, Steps: 17 | Train Loss: 1.682 Vali Loss: 2.763 Vali Acc: 0.247 Test Loss: 2.763 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9733176231384277
Epoch: 12, Steps: 17 | Train Loss: 1.901 Vali Loss: 2.485 Vali Acc: 0.297 Test Loss: 2.485 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0491511821746826
Epoch: 13, Steps: 17 | Train Loss: 1.350 Vali Loss: 2.209 Vali Acc: 0.281 Test Loss: 2.209 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.938471794128418
Epoch: 14, Steps: 17 | Train Loss: 1.600 Vali Loss: 2.390 Vali Acc: 0.312 Test Loss: 2.390 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1919443607330322
Epoch: 15, Steps: 17 | Train Loss: 1.210 Vali Loss: 3.021 Vali Acc: 0.270 Test Loss: 3.021 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.035270929336548
Epoch: 16, Steps: 17 | Train Loss: 1.037 Vali Loss: 2.338 Vali Acc: 0.289 Test Loss: 2.338 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9341986179351807
Epoch: 17, Steps: 17 | Train Loss: 0.955 Vali Loss: 2.359 Vali Acc: 0.335 Test Loss: 2.359 Test Acc: 0.335
Validation loss decreased (-0.311769 --> -0.334577).  Saving model ...
Epoch: 18 cost time: 2.015669345855713
Epoch: 18, Steps: 17 | Train Loss: 0.909 Vali Loss: 2.403 Vali Acc: 0.335 Test Loss: 2.403 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8283119201660156
Epoch: 19, Steps: 17 | Train Loss: 0.982 Vali Loss: 3.578 Vali Acc: 0.312 Test Loss: 3.578 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9357106685638428
Epoch: 20, Steps: 17 | Train Loss: 0.996 Vali Loss: 2.727 Vali Acc: 0.304 Test Loss: 2.727 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.109689950942993
Epoch: 21, Steps: 17 | Train Loss: 1.076 Vali Loss: 3.086 Vali Acc: 0.300 Test Loss: 3.086 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9594745635986328
Epoch: 22, Steps: 17 | Train Loss: 0.810 Vali Loss: 5.671 Vali Acc: 0.304 Test Loss: 5.671 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9486753940582275
Epoch: 23, Steps: 17 | Train Loss: 1.914 Vali Loss: 4.901 Vali Acc: 0.278 Test Loss: 4.901 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8794550895690918
Epoch: 24, Steps: 17 | Train Loss: 1.046 Vali Loss: 2.981 Vali Acc: 0.281 Test Loss: 2.981 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.9910964965820312
Epoch: 25, Steps: 17 | Train Loss: 0.914 Vali Loss: 4.503 Vali Acc: 0.316 Test Loss: 4.503 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.9465913772583008
Epoch: 26, Steps: 17 | Train Loss: 1.093 Vali Loss: 3.120 Vali Acc: 0.331 Test Loss: 3.120 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9151265621185303
Epoch: 27, Steps: 17 | Train Loss: 0.845 Vali Loss: 3.298 Vali Acc: 0.308 Test Loss: 3.298 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33460076045627374
model parameter : 4244252
model size : 21.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.857573986053467
Epoch: 1, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.478 Vali Acc: 0.270 Test Loss: 1.478 Test Acc: 0.270
Validation loss decreased (inf --> -0.269947).  Saving model ...
Epoch: 2 cost time: 1.9378905296325684
Epoch: 2, Steps: 17 | Train Loss: 1.697 Vali Loss: 3.549 Vali Acc: 0.243 Test Loss: 3.549 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.165539026260376
Epoch: 3, Steps: 17 | Train Loss: 2.561 Vali Loss: 2.893 Vali Acc: 0.274 Test Loss: 2.893 Test Acc: 0.274
Validation loss decreased (-0.269947 --> -0.273735).  Saving model ...
Epoch: 4 cost time: 2.114140748977661
Epoch: 4, Steps: 17 | Train Loss: 1.769 Vali Loss: 1.879 Vali Acc: 0.289 Test Loss: 1.879 Test Acc: 0.289
Validation loss decreased (-0.273735 --> -0.288955).  Saving model ...
Epoch: 5 cost time: 2.057363748550415
Epoch: 5, Steps: 17 | Train Loss: 2.651 Vali Loss: 3.688 Vali Acc: 0.251 Test Loss: 3.688 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1767702102661133
Epoch: 6, Steps: 17 | Train Loss: 2.815 Vali Loss: 3.661 Vali Acc: 0.262 Test Loss: 3.661 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.944453239440918
Epoch: 7, Steps: 17 | Train Loss: 2.067 Vali Loss: 1.700 Vali Acc: 0.308 Test Loss: 1.700 Test Acc: 0.308
Validation loss decreased (-0.288955 --> -0.307968).  Saving model ...
Epoch: 8 cost time: 2.1934261322021484
Epoch: 8, Steps: 17 | Train Loss: 1.347 Vali Loss: 2.392 Vali Acc: 0.293 Test Loss: 2.392 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9667911529541016
Epoch: 9, Steps: 17 | Train Loss: 1.761 Vali Loss: 3.236 Vali Acc: 0.285 Test Loss: 3.236 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.110724449157715
Epoch: 10, Steps: 17 | Train Loss: 1.625 Vali Loss: 2.224 Vali Acc: 0.289 Test Loss: 2.224 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.003237724304199
Epoch: 11, Steps: 17 | Train Loss: 1.795 Vali Loss: 2.040 Vali Acc: 0.308 Test Loss: 2.040 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.9562878608703613
Epoch: 12, Steps: 17 | Train Loss: 1.119 Vali Loss: 2.467 Vali Acc: 0.232 Test Loss: 2.467 Test Acc: 0.232
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0817790031433105
Epoch: 13, Steps: 17 | Train Loss: 1.467 Vali Loss: 2.083 Vali Acc: 0.270 Test Loss: 2.083 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.964871883392334
Epoch: 14, Steps: 17 | Train Loss: 1.270 Vali Loss: 2.516 Vali Acc: 0.319 Test Loss: 2.516 Test Acc: 0.319
Validation loss decreased (-0.307968 --> -0.319366).  Saving model ...
Epoch: 15 cost time: 2.0928385257720947
Epoch: 15, Steps: 17 | Train Loss: 1.236 Vali Loss: 3.536 Vali Acc: 0.278 Test Loss: 3.536 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9779822826385498
Epoch: 16, Steps: 17 | Train Loss: 1.368 Vali Loss: 2.359 Vali Acc: 0.285 Test Loss: 2.359 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7968370914459229
Epoch: 17, Steps: 17 | Train Loss: 1.080 Vali Loss: 3.727 Vali Acc: 0.266 Test Loss: 3.727 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.873387336730957
Epoch: 18, Steps: 17 | Train Loss: 1.298 Vali Loss: 2.726 Vali Acc: 0.316 Test Loss: 2.726 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0206990242004395
Epoch: 19, Steps: 17 | Train Loss: 1.045 Vali Loss: 2.952 Vali Acc: 0.316 Test Loss: 2.952 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.654317855834961
Epoch: 20, Steps: 17 | Train Loss: 0.910 Vali Loss: 3.065 Vali Acc: 0.289 Test Loss: 3.065 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0566322803497314
Epoch: 21, Steps: 17 | Train Loss: 1.107 Vali Loss: 3.317 Vali Acc: 0.266 Test Loss: 3.317 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.0531318187713623
Epoch: 22, Steps: 17 | Train Loss: 0.888 Vali Loss: 2.729 Vali Acc: 0.331 Test Loss: 2.729 Test Acc: 0.331
Validation loss decreased (-0.319366 --> -0.330771).  Saving model ...
Epoch: 23 cost time: 1.8248331546783447
Epoch: 23, Steps: 17 | Train Loss: 1.015 Vali Loss: 3.139 Vali Acc: 0.274 Test Loss: 3.139 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0439655780792236
Epoch: 24, Steps: 17 | Train Loss: 0.689 Vali Loss: 3.035 Vali Acc: 0.323 Test Loss: 3.035 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.9211838245391846
Epoch: 25, Steps: 17 | Train Loss: 0.623 Vali Loss: 4.174 Vali Acc: 0.319 Test Loss: 4.174 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.928337574005127
Epoch: 26, Steps: 17 | Train Loss: 0.671 Vali Loss: 4.210 Vali Acc: 0.289 Test Loss: 4.210 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.896479606628418
Epoch: 27, Steps: 17 | Train Loss: 0.885 Vali Loss: 3.991 Vali Acc: 0.304 Test Loss: 3.991 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.8872244358062744
Epoch: 28, Steps: 17 | Train Loss: 0.990 Vali Loss: 3.795 Vali Acc: 0.312 Test Loss: 3.795 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8132250308990479
Epoch: 29, Steps: 17 | Train Loss: 0.716 Vali Loss: 3.797 Vali Acc: 0.304 Test Loss: 3.797 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.1093356609344482
Epoch: 30, Steps: 17 | Train Loss: 0.618 Vali Loss: 4.173 Vali Acc: 0.331 Test Loss: 4.173 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.860471248626709
Epoch: 31, Steps: 17 | Train Loss: 0.966 Vali Loss: 4.842 Vali Acc: 0.285 Test Loss: 4.842 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8981354236602783
Epoch: 32, Steps: 17 | Train Loss: 0.580 Vali Loss: 4.478 Vali Acc: 0.323 Test Loss: 4.478 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33079847908745247
model parameter : 4206876
model size : 21.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.390880584716797
Epoch: 1, Steps: 17 | Train Loss: 1.702 Vali Loss: 2.935 Vali Acc: 0.255 Test Loss: 2.935 Test Acc: 0.255
Validation loss decreased (inf --> -0.254724).  Saving model ...
Epoch: 2 cost time: 2.1211047172546387
Epoch: 2, Steps: 17 | Train Loss: 2.169 Vali Loss: 1.566 Vali Acc: 0.316 Test Loss: 1.566 Test Acc: 0.316
Validation loss decreased (-0.254724 --> -0.315574).  Saving model ...
Epoch: 3 cost time: 2.1145236492156982
Epoch: 3, Steps: 17 | Train Loss: 2.711 Vali Loss: 3.374 Vali Acc: 0.251 Test Loss: 3.374 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.061838388442993
Epoch: 4, Steps: 17 | Train Loss: 3.147 Vali Loss: 3.058 Vali Acc: 0.304 Test Loss: 3.058 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.06575608253479
Epoch: 5, Steps: 17 | Train Loss: 2.062 Vali Loss: 3.675 Vali Acc: 0.251 Test Loss: 3.675 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9403457641601562
Epoch: 6, Steps: 17 | Train Loss: 2.322 Vali Loss: 2.075 Vali Acc: 0.289 Test Loss: 2.075 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.84122896194458
Epoch: 7, Steps: 17 | Train Loss: 1.616 Vali Loss: 2.114 Vali Acc: 0.289 Test Loss: 2.114 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.723151683807373
Epoch: 8, Steps: 17 | Train Loss: 1.843 Vali Loss: 2.516 Vali Acc: 0.259 Test Loss: 2.516 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.995887279510498
Epoch: 9, Steps: 17 | Train Loss: 1.902 Vali Loss: 2.678 Vali Acc: 0.255 Test Loss: 2.678 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.1479947566986084
Epoch: 10, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.976 Vali Acc: 0.278 Test Loss: 1.976 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.122443675994873
Epoch: 11, Steps: 17 | Train Loss: 1.402 Vali Loss: 2.286 Vali Acc: 0.300 Test Loss: 2.286 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.2070558071136475
Epoch: 12, Steps: 17 | Train Loss: 1.175 Vali Loss: 2.475 Vali Acc: 0.259 Test Loss: 2.475 Test Acc: 0.259
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 4169500
model size : 20.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.731365919113159
Epoch: 1, Steps: 17 | Train Loss: 1.905 Vali Loss: 3.567 Vali Acc: 0.251 Test Loss: 3.567 Test Acc: 0.251
Validation loss decreased (inf --> -0.250915).  Saving model ...
Epoch: 2 cost time: 1.8875350952148438
Epoch: 2, Steps: 17 | Train Loss: 2.469 Vali Loss: 1.805 Vali Acc: 0.262 Test Loss: 1.805 Test Acc: 0.262
Validation loss decreased (-0.250915 --> -0.262339).  Saving model ...
Epoch: 3 cost time: 1.8801424503326416
Epoch: 3, Steps: 17 | Train Loss: 2.295 Vali Loss: 2.467 Vali Acc: 0.259 Test Loss: 2.467 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.022660732269287
Epoch: 4, Steps: 17 | Train Loss: 2.444 Vali Loss: 2.868 Vali Acc: 0.240 Test Loss: 2.868 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.9628815650939941
Epoch: 5, Steps: 17 | Train Loss: 2.416 Vali Loss: 2.115 Vali Acc: 0.247 Test Loss: 2.115 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.9585485458374023
Epoch: 6, Steps: 17 | Train Loss: 2.382 Vali Loss: 3.294 Vali Acc: 0.278 Test Loss: 3.294 Test Acc: 0.278
Validation loss decreased (-0.262339 --> -0.277534).  Saving model ...
Epoch: 7 cost time: 1.9187216758728027
Epoch: 7, Steps: 17 | Train Loss: 2.697 Vali Loss: 4.309 Vali Acc: 0.259 Test Loss: 4.309 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.033449172973633
Epoch: 8, Steps: 17 | Train Loss: 2.033 Vali Loss: 2.198 Vali Acc: 0.274 Test Loss: 2.198 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8584139347076416
Epoch: 9, Steps: 17 | Train Loss: 1.812 Vali Loss: 2.899 Vali Acc: 0.255 Test Loss: 2.899 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8425519466400146
Epoch: 10, Steps: 17 | Train Loss: 2.054 Vali Loss: 3.218 Vali Acc: 0.240 Test Loss: 3.218 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.467254877090454
Epoch: 11, Steps: 17 | Train Loss: 1.735 Vali Loss: 2.581 Vali Acc: 0.278 Test Loss: 2.581 Test Acc: 0.278
Validation loss decreased (-0.277534 --> -0.277541).  Saving model ...
Epoch: 12 cost time: 2.1073901653289795
Epoch: 12, Steps: 17 | Train Loss: 1.252 Vali Loss: 2.403 Vali Acc: 0.308 Test Loss: 2.403 Test Acc: 0.308
Validation loss decreased (-0.277541 --> -0.307961).  Saving model ...
Epoch: 13 cost time: 2.0725841522216797
Epoch: 13, Steps: 17 | Train Loss: 1.242 Vali Loss: 2.559 Vali Acc: 0.316 Test Loss: 2.559 Test Acc: 0.316
Validation loss decreased (-0.307961 --> -0.315564).  Saving model ...
Epoch: 14 cost time: 2.0018529891967773
Epoch: 14, Steps: 17 | Train Loss: 1.186 Vali Loss: 2.552 Vali Acc: 0.300 Test Loss: 2.552 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0956883430480957
Epoch: 15, Steps: 17 | Train Loss: 1.275 Vali Loss: 2.749 Vali Acc: 0.338 Test Loss: 2.749 Test Acc: 0.338
Validation loss decreased (-0.315564 --> -0.338376).  Saving model ...
Epoch: 16 cost time: 1.8572609424591064
Epoch: 16, Steps: 17 | Train Loss: 1.159 Vali Loss: 2.566 Vali Acc: 0.300 Test Loss: 2.566 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2148616313934326
Epoch: 17, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.252 Vali Acc: 0.338 Test Loss: 2.252 Test Acc: 0.338
Validation loss decreased (-0.338376 --> -0.338381).  Saving model ...
Epoch: 18 cost time: 2.135266065597534
Epoch: 18, Steps: 17 | Train Loss: 1.164 Vali Loss: 2.440 Vali Acc: 0.331 Test Loss: 2.440 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.969468593597412
Epoch: 19, Steps: 17 | Train Loss: 0.948 Vali Loss: 3.207 Vali Acc: 0.262 Test Loss: 3.207 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9603617191314697
Epoch: 20, Steps: 17 | Train Loss: 0.753 Vali Loss: 3.006 Vali Acc: 0.323 Test Loss: 3.006 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.048330783843994
Epoch: 21, Steps: 17 | Train Loss: 1.026 Vali Loss: 3.872 Vali Acc: 0.327 Test Loss: 3.872 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.132181406021118
Epoch: 22, Steps: 17 | Train Loss: 1.065 Vali Loss: 4.012 Vali Acc: 0.300 Test Loss: 4.012 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.042252540588379
Epoch: 23, Steps: 17 | Train Loss: 0.976 Vali Loss: 2.721 Vali Acc: 0.300 Test Loss: 2.721 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.9840741157531738
Epoch: 24, Steps: 17 | Train Loss: 0.615 Vali Loss: 4.426 Vali Acc: 0.323 Test Loss: 4.426 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.843245506286621
Epoch: 25, Steps: 17 | Train Loss: 0.881 Vali Loss: 4.644 Vali Acc: 0.262 Test Loss: 4.644 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.0858845710754395
Epoch: 26, Steps: 17 | Train Loss: 0.972 Vali Loss: 3.445 Vali Acc: 0.304 Test Loss: 3.445 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.996194839477539
Epoch: 27, Steps: 17 | Train Loss: 0.751 Vali Loss: 3.689 Vali Acc: 0.338 Test Loss: 3.689 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33840304182509506
model parameter : 4084636
model size : 20.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.150085210800171
Epoch: 1, Steps: 17 | Train Loss: 1.824 Vali Loss: 1.999 Vali Acc: 0.243 Test Loss: 1.999 Test Acc: 0.243
Validation loss decreased (inf --> -0.243326).  Saving model ...
Epoch: 2 cost time: 1.751629114151001
Epoch: 2, Steps: 17 | Train Loss: 2.381 Vali Loss: 1.823 Vali Acc: 0.281 Test Loss: 1.823 Test Acc: 0.281
Validation loss decreased (-0.243326 --> -0.281351).  Saving model ...
Epoch: 3 cost time: 2.0901758670806885
Epoch: 3, Steps: 17 | Train Loss: 2.007 Vali Loss: 3.235 Vali Acc: 0.270 Test Loss: 3.235 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9756319522857666
Epoch: 4, Steps: 17 | Train Loss: 2.311 Vali Loss: 1.686 Vali Acc: 0.270 Test Loss: 1.686 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.0297319889068604
Epoch: 5, Steps: 17 | Train Loss: 2.074 Vali Loss: 3.845 Vali Acc: 0.266 Test Loss: 3.845 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.1236300468444824
Epoch: 6, Steps: 17 | Train Loss: 3.529 Vali Loss: 2.415 Vali Acc: 0.270 Test Loss: 2.415 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.0313241481781006
Epoch: 7, Steps: 17 | Train Loss: 1.836 Vali Loss: 2.123 Vali Acc: 0.240 Test Loss: 2.123 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.992891788482666
Epoch: 8, Steps: 17 | Train Loss: 1.814 Vali Loss: 3.399 Vali Acc: 0.243 Test Loss: 3.399 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 2.157642126083374
Epoch: 9, Steps: 17 | Train Loss: 1.947 Vali Loss: 2.248 Vali Acc: 0.281 Test Loss: 2.248 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.9576740264892578
Epoch: 10, Steps: 17 | Train Loss: 1.563 Vali Loss: 2.541 Vali Acc: 0.255 Test Loss: 2.541 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.067437171936035
Epoch: 11, Steps: 17 | Train Loss: 1.473 Vali Loss: 3.566 Vali Acc: 0.251 Test Loss: 3.566 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.094163656234741
Epoch: 12, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.871 Vali Acc: 0.316 Test Loss: 1.871 Test Acc: 0.316
Validation loss decreased (-0.281351 --> -0.315571).  Saving model ...
Epoch: 13 cost time: 2.0673975944519043
Epoch: 13, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.984 Vali Acc: 0.297 Test Loss: 1.984 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7911155223846436
Epoch: 14, Steps: 17 | Train Loss: 1.225 Vali Loss: 2.828 Vali Acc: 0.323 Test Loss: 2.828 Test Acc: 0.323
Validation loss decreased (-0.315571 --> -0.323166).  Saving model ...
Epoch: 15 cost time: 1.9715745449066162
Epoch: 15, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.927 Vali Acc: 0.323 Test Loss: 1.927 Test Acc: 0.323
Validation loss decreased (-0.323166 --> -0.323175).  Saving model ...
Epoch: 16 cost time: 2.1613011360168457
Epoch: 16, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.861 Vali Acc: 0.285 Test Loss: 2.861 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2395834922790527
Epoch: 17, Steps: 17 | Train Loss: 1.129 Vali Loss: 3.698 Vali Acc: 0.270 Test Loss: 3.698 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.994913101196289
Epoch: 18, Steps: 17 | Train Loss: 1.040 Vali Loss: 3.060 Vali Acc: 0.293 Test Loss: 3.060 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8624818325042725
Epoch: 19, Steps: 17 | Train Loss: 1.282 Vali Loss: 3.489 Vali Acc: 0.327 Test Loss: 3.489 Test Acc: 0.327
Validation loss decreased (-0.323175 --> -0.326961).  Saving model ...
Epoch: 20 cost time: 2.2351484298706055
Epoch: 20, Steps: 17 | Train Loss: 0.783 Vali Loss: 2.445 Vali Acc: 0.388 Test Loss: 2.445 Test Acc: 0.388
Validation loss decreased (-0.326961 --> -0.387808).  Saving model ...
Epoch: 21 cost time: 1.8638627529144287
Epoch: 21, Steps: 17 | Train Loss: 0.964 Vali Loss: 2.678 Vali Acc: 0.350 Test Loss: 2.678 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.863128662109375
Epoch: 22, Steps: 17 | Train Loss: 0.951 Vali Loss: 3.533 Vali Acc: 0.297 Test Loss: 3.533 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.005990505218506
Epoch: 23, Steps: 17 | Train Loss: 0.894 Vali Loss: 3.108 Vali Acc: 0.293 Test Loss: 3.108 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.0175511837005615
Epoch: 24, Steps: 17 | Train Loss: 0.891 Vali Loss: 3.353 Vali Acc: 0.300 Test Loss: 3.353 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9819796085357666
Epoch: 25, Steps: 17 | Train Loss: 0.554 Vali Loss: 3.009 Vali Acc: 0.312 Test Loss: 3.009 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8478631973266602
Epoch: 26, Steps: 17 | Train Loss: 0.609 Vali Loss: 4.079 Vali Acc: 0.278 Test Loss: 4.079 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.882451057434082
Epoch: 27, Steps: 17 | Train Loss: 0.582 Vali Loss: 3.456 Vali Acc: 0.319 Test Loss: 3.456 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.053788661956787
Epoch: 28, Steps: 17 | Train Loss: 0.869 Vali Loss: 5.136 Vali Acc: 0.300 Test Loss: 5.136 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.9335319995880127
Epoch: 29, Steps: 17 | Train Loss: 1.043 Vali Loss: 4.591 Vali Acc: 0.281 Test Loss: 4.591 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8169147968292236
Epoch: 30, Steps: 17 | Train Loss: 0.739 Vali Loss: 4.377 Vali Acc: 0.243 Test Loss: 4.377 Test Acc: 0.243
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38783269961977185
model parameter : 4047260
model size : 20.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.371429443359375
Epoch: 1, Steps: 17 | Train Loss: 1.853 Vali Loss: 2.355 Vali Acc: 0.266 Test Loss: 2.355 Test Acc: 0.266
Validation loss decreased (inf --> -0.266136).  Saving model ...
Epoch: 2 cost time: 1.9660701751708984
Epoch: 2, Steps: 17 | Train Loss: 1.924 Vali Loss: 1.913 Vali Acc: 0.259 Test Loss: 1.913 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.0582125186920166
Epoch: 3, Steps: 17 | Train Loss: 1.883 Vali Loss: 2.595 Vali Acc: 0.259 Test Loss: 2.595 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 2.0529956817626953
Epoch: 4, Steps: 17 | Train Loss: 2.016 Vali Loss: 3.837 Vali Acc: 0.251 Test Loss: 3.837 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.0026183128356934
Epoch: 5, Steps: 17 | Train Loss: 2.521 Vali Loss: 3.038 Vali Acc: 0.262 Test Loss: 3.038 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 2.0036892890930176
Epoch: 6, Steps: 17 | Train Loss: 2.236 Vali Loss: 2.607 Vali Acc: 0.266 Test Loss: 2.607 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 2.170958995819092
Epoch: 7, Steps: 17 | Train Loss: 1.664 Vali Loss: 1.884 Vali Acc: 0.300 Test Loss: 1.884 Test Acc: 0.300
Validation loss decreased (-0.266136 --> -0.300361).  Saving model ...
Epoch: 8 cost time: 2.091312885284424
Epoch: 8, Steps: 17 | Train Loss: 1.561 Vali Loss: 2.855 Vali Acc: 0.270 Test Loss: 2.855 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0971741676330566
Epoch: 9, Steps: 17 | Train Loss: 2.193 Vali Loss: 3.386 Vali Acc: 0.259 Test Loss: 3.386 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2160446643829346
Epoch: 10, Steps: 17 | Train Loss: 1.666 Vali Loss: 2.985 Vali Acc: 0.240 Test Loss: 2.985 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2096493244171143
Epoch: 11, Steps: 17 | Train Loss: 1.621 Vali Loss: 2.724 Vali Acc: 0.293 Test Loss: 2.724 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.3165557384490967
Epoch: 12, Steps: 17 | Train Loss: 1.613 Vali Loss: 1.991 Vali Acc: 0.285 Test Loss: 1.991 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9757447242736816
Epoch: 13, Steps: 17 | Train Loss: 1.235 Vali Loss: 2.341 Vali Acc: 0.278 Test Loss: 2.341 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.098942518234253
Epoch: 14, Steps: 17 | Train Loss: 1.289 Vali Loss: 3.049 Vali Acc: 0.274 Test Loss: 3.049 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.306443691253662
Epoch: 15, Steps: 17 | Train Loss: 1.062 Vali Loss: 2.332 Vali Acc: 0.312 Test Loss: 2.332 Test Acc: 0.312
Validation loss decreased (-0.300361 --> -0.311764).  Saving model ...
Epoch: 16 cost time: 2.054372787475586
Epoch: 16, Steps: 17 | Train Loss: 1.086 Vali Loss: 2.438 Vali Acc: 0.323 Test Loss: 2.438 Test Acc: 0.323
Validation loss decreased (-0.311764 --> -0.323170).  Saving model ...
Epoch: 17 cost time: 1.749803066253662
Epoch: 17, Steps: 17 | Train Loss: 1.015 Vali Loss: 2.672 Vali Acc: 0.289 Test Loss: 2.672 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9625766277313232
Epoch: 18, Steps: 17 | Train Loss: 0.897 Vali Loss: 2.325 Vali Acc: 0.331 Test Loss: 2.325 Test Acc: 0.331
Validation loss decreased (-0.323170 --> -0.330775).  Saving model ...
Epoch: 19 cost time: 1.954206943511963
Epoch: 19, Steps: 17 | Train Loss: 0.804 Vali Loss: 3.045 Vali Acc: 0.335 Test Loss: 3.045 Test Acc: 0.335
Validation loss decreased (-0.330775 --> -0.334570).  Saving model ...
Epoch: 20 cost time: 1.8118565082550049
Epoch: 20, Steps: 17 | Train Loss: 1.061 Vali Loss: 3.702 Vali Acc: 0.243 Test Loss: 3.702 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.874680995941162
Epoch: 21, Steps: 17 | Train Loss: 0.836 Vali Loss: 2.857 Vali Acc: 0.285 Test Loss: 2.857 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.074506998062134
Epoch: 22, Steps: 17 | Train Loss: 1.007 Vali Loss: 3.559 Vali Acc: 0.316 Test Loss: 3.559 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.110521078109741
Epoch: 23, Steps: 17 | Train Loss: 0.880 Vali Loss: 2.896 Vali Acc: 0.297 Test Loss: 2.896 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.0397682189941406
Epoch: 24, Steps: 17 | Train Loss: 0.648 Vali Loss: 2.829 Vali Acc: 0.323 Test Loss: 2.829 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8913459777832031
Epoch: 25, Steps: 17 | Train Loss: 1.065 Vali Loss: 3.140 Vali Acc: 0.335 Test Loss: 3.140 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.8798441886901855
Epoch: 26, Steps: 17 | Train Loss: 0.693 Vali Loss: 3.029 Vali Acc: 0.278 Test Loss: 3.029 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.146389961242676
Epoch: 27, Steps: 17 | Train Loss: 0.601 Vali Loss: 3.708 Vali Acc: 0.304 Test Loss: 3.708 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8287570476531982
Epoch: 28, Steps: 17 | Train Loss: 0.618 Vali Loss: 3.376 Vali Acc: 0.335 Test Loss: 3.376 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9357826709747314
Epoch: 29, Steps: 17 | Train Loss: 0.545 Vali Loss: 4.017 Vali Acc: 0.331 Test Loss: 4.017 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33460076045627374
model parameter : 4009884
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6866424083709717
Epoch: 1, Steps: 17 | Train Loss: 1.717 Vali Loss: 3.206 Vali Acc: 0.243 Test Loss: 3.206 Test Acc: 0.243
Validation loss decreased (inf --> -0.243314).  Saving model ...
Epoch: 2 cost time: 1.7974879741668701
Epoch: 2, Steps: 17 | Train Loss: 2.277 Vali Loss: 2.479 Vali Acc: 0.255 Test Loss: 2.479 Test Acc: 0.255
Validation loss decreased (-0.243314 --> -0.254728).  Saving model ...
Epoch: 3 cost time: 1.8248178958892822
Epoch: 3, Steps: 17 | Train Loss: 1.986 Vali Loss: 1.656 Vali Acc: 0.262 Test Loss: 1.656 Test Acc: 0.262
Validation loss decreased (-0.254728 --> -0.262341).  Saving model ...
Epoch: 4 cost time: 1.9390761852264404
Epoch: 4, Steps: 17 | Train Loss: 1.940 Vali Loss: 3.648 Vali Acc: 0.289 Test Loss: 3.648 Test Acc: 0.289
Validation loss decreased (-0.262341 --> -0.288937).  Saving model ...
Epoch: 5 cost time: 1.8244044780731201
Epoch: 5, Steps: 17 | Train Loss: 3.328 Vali Loss: 3.106 Vali Acc: 0.262 Test Loss: 3.106 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8412339687347412
Epoch: 6, Steps: 17 | Train Loss: 2.906 Vali Loss: 2.788 Vali Acc: 0.285 Test Loss: 2.788 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7274296283721924
Epoch: 7, Steps: 17 | Train Loss: 1.647 Vali Loss: 1.729 Vali Acc: 0.323 Test Loss: 1.729 Test Acc: 0.323
Validation loss decreased (-0.288937 --> -0.323177).  Saving model ...
Epoch: 8 cost time: 1.8486614227294922
Epoch: 8, Steps: 17 | Train Loss: 1.572 Vali Loss: 3.417 Vali Acc: 0.240 Test Loss: 3.417 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8220524787902832
Epoch: 9, Steps: 17 | Train Loss: 1.950 Vali Loss: 2.747 Vali Acc: 0.278 Test Loss: 2.747 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8140385150909424
Epoch: 10, Steps: 17 | Train Loss: 1.840 Vali Loss: 3.585 Vali Acc: 0.251 Test Loss: 3.585 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.842935562133789
Epoch: 11, Steps: 17 | Train Loss: 1.674 Vali Loss: 2.104 Vali Acc: 0.281 Test Loss: 2.104 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7769484519958496
Epoch: 12, Steps: 17 | Train Loss: 1.463 Vali Loss: 2.623 Vali Acc: 0.274 Test Loss: 2.623 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.9723689556121826
Epoch: 13, Steps: 17 | Train Loss: 1.395 Vali Loss: 2.767 Vali Acc: 0.281 Test Loss: 2.767 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.9850990772247314
Epoch: 14, Steps: 17 | Train Loss: 1.192 Vali Loss: 3.801 Vali Acc: 0.255 Test Loss: 3.801 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9154973030090332
Epoch: 15, Steps: 17 | Train Loss: 1.713 Vali Loss: 2.774 Vali Acc: 0.278 Test Loss: 2.774 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7867519855499268
Epoch: 16, Steps: 17 | Train Loss: 1.153 Vali Loss: 2.504 Vali Acc: 0.331 Test Loss: 2.504 Test Acc: 0.331
Validation loss decreased (-0.323177 --> -0.330773).  Saving model ...
Epoch: 17 cost time: 1.8141770362854004
Epoch: 17, Steps: 17 | Train Loss: 1.133 Vali Loss: 2.436 Vali Acc: 0.319 Test Loss: 2.436 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.4861516952514648
Epoch: 18, Steps: 17 | Train Loss: 0.885 Vali Loss: 2.649 Vali Acc: 0.281 Test Loss: 2.649 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.4912562370300293
Epoch: 19, Steps: 17 | Train Loss: 0.997 Vali Loss: 2.453 Vali Acc: 0.357 Test Loss: 2.453 Test Acc: 0.357
Validation loss decreased (-0.330773 --> -0.357390).  Saving model ...
Epoch: 20 cost time: 2.014221429824829
Epoch: 20, Steps: 17 | Train Loss: 0.794 Vali Loss: 2.706 Vali Acc: 0.316 Test Loss: 2.706 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.896235704421997
Epoch: 21, Steps: 17 | Train Loss: 0.925 Vali Loss: 3.603 Vali Acc: 0.335 Test Loss: 3.603 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.506972312927246
Epoch: 22, Steps: 17 | Train Loss: 1.071 Vali Loss: 3.020 Vali Acc: 0.380 Test Loss: 3.020 Test Acc: 0.380
Validation loss decreased (-0.357390 --> -0.380198).  Saving model ...
Epoch: 23 cost time: 1.4483983516693115
Epoch: 23, Steps: 17 | Train Loss: 1.082 Vali Loss: 3.264 Vali Acc: 0.346 Test Loss: 3.264 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5379490852355957
Epoch: 24, Steps: 17 | Train Loss: 0.767 Vali Loss: 3.593 Vali Acc: 0.319 Test Loss: 3.593 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4717152118682861
Epoch: 25, Steps: 17 | Train Loss: 0.717 Vali Loss: 2.536 Vali Acc: 0.392 Test Loss: 2.536 Test Acc: 0.392
Validation loss decreased (-0.380198 --> -0.391610).  Saving model ...
Epoch: 26 cost time: 1.7952380180358887
Epoch: 26, Steps: 17 | Train Loss: 0.632 Vali Loss: 4.082 Vali Acc: 0.289 Test Loss: 4.082 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.594376802444458
Epoch: 27, Steps: 17 | Train Loss: 0.596 Vali Loss: 3.376 Vali Acc: 0.357 Test Loss: 3.376 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5650904178619385
Epoch: 28, Steps: 17 | Train Loss: 0.673 Vali Loss: 3.415 Vali Acc: 0.357 Test Loss: 3.415 Test Acc: 0.357
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3267300128936768
Epoch: 29, Steps: 17 | Train Loss: 0.777 Vali Loss: 4.042 Vali Acc: 0.327 Test Loss: 4.042 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6486778259277344
Epoch: 30, Steps: 17 | Train Loss: 0.750 Vali Loss: 4.558 Vali Acc: 0.278 Test Loss: 4.558 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.366159200668335
Epoch: 31, Steps: 17 | Train Loss: 0.471 Vali Loss: 4.227 Vali Acc: 0.350 Test Loss: 4.227 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.4280104637145996
Epoch: 32, Steps: 17 | Train Loss: 0.881 Vali Loss: 3.945 Vali Acc: 0.335 Test Loss: 3.945 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.657283067703247
Epoch: 33, Steps: 17 | Train Loss: 0.653 Vali Loss: 4.603 Vali Acc: 0.335 Test Loss: 4.603 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.105088949203491
Epoch: 34, Steps: 17 | Train Loss: 0.587 Vali Loss: 4.458 Vali Acc: 0.357 Test Loss: 4.458 Test Acc: 0.357
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.009922981262207
Epoch: 35, Steps: 17 | Train Loss: 0.579 Vali Loss: 3.746 Vali Acc: 0.327 Test Loss: 3.746 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3916349809885932
model parameter : 3972508
model size : 20.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.059614181518555
Epoch: 1, Steps: 17 | Train Loss: 1.614 Vali Loss: 1.496 Vali Acc: 0.278 Test Loss: 1.496 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 1.9462685585021973
Epoch: 2, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.542 Vali Acc: 0.278 Test Loss: 1.542 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8730943202972412
Epoch: 3, Steps: 17 | Train Loss: 1.849 Vali Loss: 2.367 Vali Acc: 0.262 Test Loss: 2.367 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6591503620147705
Epoch: 4, Steps: 17 | Train Loss: 1.752 Vali Loss: 1.543 Vali Acc: 0.278 Test Loss: 1.543 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 2.128187894821167
Epoch: 5, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.830 Vali Acc: 0.255 Test Loss: 1.830 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.868650197982788
Epoch: 6, Steps: 17 | Train Loss: 1.432 Vali Loss: 2.472 Vali Acc: 0.270 Test Loss: 2.472 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.452111005783081
Epoch: 7, Steps: 17 | Train Loss: 1.675 Vali Loss: 3.279 Vali Acc: 0.255 Test Loss: 3.279 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.9344608783721924
Epoch: 8, Steps: 17 | Train Loss: 1.772 Vali Loss: 1.638 Vali Acc: 0.297 Test Loss: 1.638 Test Acc: 0.297
Validation loss decreased (-0.277552 --> -0.296562).  Saving model ...
Epoch: 9 cost time: 1.68208646774292
Epoch: 9, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.958 Vali Acc: 0.259 Test Loss: 1.958 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6947717666625977
Epoch: 10, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.920 Vali Acc: 0.278 Test Loss: 1.920 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9129829406738281
Epoch: 11, Steps: 17 | Train Loss: 1.217 Vali Loss: 2.171 Vali Acc: 0.262 Test Loss: 2.171 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7888176441192627
Epoch: 12, Steps: 17 | Train Loss: 1.411 Vali Loss: 2.059 Vali Acc: 0.293 Test Loss: 2.059 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4861769676208496
Epoch: 13, Steps: 17 | Train Loss: 0.948 Vali Loss: 2.157 Vali Acc: 0.300 Test Loss: 2.157 Test Acc: 0.300
Validation loss decreased (-0.296562 --> -0.300359).  Saving model ...
Epoch: 14 cost time: 1.8641290664672852
Epoch: 14, Steps: 17 | Train Loss: 0.956 Vali Loss: 2.364 Vali Acc: 0.297 Test Loss: 2.364 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8505127429962158
Epoch: 15, Steps: 17 | Train Loss: 1.055 Vali Loss: 2.760 Vali Acc: 0.293 Test Loss: 2.760 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6242034435272217
Epoch: 16, Steps: 17 | Train Loss: 1.027 Vali Loss: 2.144 Vali Acc: 0.278 Test Loss: 2.144 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9298675060272217
Epoch: 17, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.407 Vali Acc: 0.316 Test Loss: 2.407 Test Acc: 0.316
Validation loss decreased (-0.300359 --> -0.315565).  Saving model ...
Epoch: 18 cost time: 1.767141342163086
Epoch: 18, Steps: 17 | Train Loss: 1.112 Vali Loss: 2.715 Vali Acc: 0.342 Test Loss: 2.715 Test Acc: 0.342
Validation loss decreased (-0.315565 --> -0.342178).  Saving model ...
Epoch: 19 cost time: 2.01644229888916
Epoch: 19, Steps: 17 | Train Loss: 0.972 Vali Loss: 2.434 Vali Acc: 0.342 Test Loss: 2.434 Test Acc: 0.342
Validation loss decreased (-0.342178 --> -0.342181).  Saving model ...
Epoch: 20 cost time: 1.9215867519378662
Epoch: 20, Steps: 17 | Train Loss: 0.782 Vali Loss: 2.816 Vali Acc: 0.308 Test Loss: 2.816 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6520113945007324
Epoch: 21, Steps: 17 | Train Loss: 0.696 Vali Loss: 2.406 Vali Acc: 0.338 Test Loss: 2.406 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9995782375335693
Epoch: 22, Steps: 17 | Train Loss: 0.737 Vali Loss: 2.702 Vali Acc: 0.338 Test Loss: 2.702 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8247179985046387
Epoch: 23, Steps: 17 | Train Loss: 0.570 Vali Loss: 2.551 Vali Acc: 0.369 Test Loss: 2.551 Test Acc: 0.369
Validation loss decreased (-0.342181 --> -0.368796).  Saving model ...
Epoch: 24 cost time: 1.956169605255127
Epoch: 24, Steps: 17 | Train Loss: 0.573 Vali Loss: 3.118 Vali Acc: 0.308 Test Loss: 3.118 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.923076868057251
Epoch: 25, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.612 Vali Acc: 0.354 Test Loss: 2.612 Test Acc: 0.354
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7072889804840088
Epoch: 26, Steps: 17 | Train Loss: 0.575 Vali Loss: 2.589 Vali Acc: 0.335 Test Loss: 2.589 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1246376037597656
Epoch: 27, Steps: 17 | Train Loss: 0.679 Vali Loss: 2.976 Vali Acc: 0.312 Test Loss: 2.976 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.033545970916748
Epoch: 28, Steps: 17 | Train Loss: 0.430 Vali Loss: 3.504 Vali Acc: 0.335 Test Loss: 3.504 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8766241073608398
Epoch: 29, Steps: 17 | Train Loss: 0.615 Vali Loss: 3.071 Vali Acc: 0.346 Test Loss: 3.071 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9120426177978516
Epoch: 30, Steps: 17 | Train Loss: 0.537 Vali Loss: 3.160 Vali Acc: 0.331 Test Loss: 3.160 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.058243989944458
Epoch: 31, Steps: 17 | Train Loss: 0.423 Vali Loss: 3.841 Vali Acc: 0.342 Test Loss: 3.841 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6974108219146729
Epoch: 32, Steps: 17 | Train Loss: 0.536 Vali Loss: 3.516 Vali Acc: 0.350 Test Loss: 3.516 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.0482332706451416
Epoch: 33, Steps: 17 | Train Loss: 0.626 Vali Loss: 4.307 Vali Acc: 0.312 Test Loss: 4.307 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3688212927756654
model parameter : 1946908
model size : 9.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.048024415969849
Epoch: 1, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.705 Vali Acc: 0.251 Test Loss: 1.705 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 1.9314112663269043
Epoch: 2, Steps: 17 | Train Loss: 1.658 Vali Loss: 2.033 Vali Acc: 0.251 Test Loss: 2.033 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7008426189422607
Epoch: 3, Steps: 17 | Train Loss: 2.151 Vali Loss: 1.637 Vali Acc: 0.259 Test Loss: 1.637 Test Acc: 0.259
Validation loss decreased (-0.250934 --> -0.258539).  Saving model ...
Epoch: 4 cost time: 1.7599384784698486
Epoch: 4, Steps: 17 | Train Loss: 1.969 Vali Loss: 2.425 Vali Acc: 0.262 Test Loss: 2.425 Test Acc: 0.262
Validation loss decreased (-0.258539 --> -0.262333).  Saving model ...
Epoch: 5 cost time: 1.7947545051574707
Epoch: 5, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.960 Vali Acc: 0.247 Test Loss: 1.960 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8005774021148682
Epoch: 6, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.576 Vali Acc: 0.289 Test Loss: 1.576 Test Acc: 0.289
Validation loss decreased (-0.262333 --> -0.288958).  Saving model ...
Epoch: 7 cost time: 1.6878268718719482
Epoch: 7, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.707 Vali Acc: 0.323 Test Loss: 1.707 Test Acc: 0.323
Validation loss decreased (-0.288958 --> -0.323177).  Saving model ...
Epoch: 8 cost time: 1.7223589420318604
Epoch: 8, Steps: 17 | Train Loss: 1.518 Vali Loss: 2.359 Vali Acc: 0.259 Test Loss: 2.359 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.063786506652832
Epoch: 9, Steps: 17 | Train Loss: 1.630 Vali Loss: 2.222 Vali Acc: 0.289 Test Loss: 2.222 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.887054681777954
Epoch: 10, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.783 Vali Acc: 0.354 Test Loss: 1.783 Test Acc: 0.354
Validation loss decreased (-0.323177 --> -0.353594).  Saving model ...
Epoch: 11 cost time: 1.9260334968566895
Epoch: 11, Steps: 17 | Train Loss: 1.246 Vali Loss: 2.149 Vali Acc: 0.270 Test Loss: 2.149 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8719573020935059
Epoch: 12, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.940 Vali Acc: 0.312 Test Loss: 1.940 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.141140937805176
Epoch: 13, Steps: 17 | Train Loss: 1.166 Vali Loss: 2.435 Vali Acc: 0.266 Test Loss: 2.435 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8284547328948975
Epoch: 14, Steps: 17 | Train Loss: 1.150 Vali Loss: 2.322 Vali Acc: 0.342 Test Loss: 2.322 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9023520946502686
Epoch: 15, Steps: 17 | Train Loss: 1.108 Vali Loss: 2.655 Vali Acc: 0.293 Test Loss: 2.655 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4763717651367188
Epoch: 16, Steps: 17 | Train Loss: 1.255 Vali Loss: 2.623 Vali Acc: 0.304 Test Loss: 2.623 Test Acc: 0.304
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9318225383758545
Epoch: 17, Steps: 17 | Train Loss: 0.933 Vali Loss: 2.201 Vali Acc: 0.323 Test Loss: 2.201 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.860856294631958
Epoch: 18, Steps: 17 | Train Loss: 0.784 Vali Loss: 2.301 Vali Acc: 0.354 Test Loss: 2.301 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7237920761108398
Epoch: 19, Steps: 17 | Train Loss: 1.115 Vali Loss: 2.560 Vali Acc: 0.342 Test Loss: 2.560 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9140326976776123
Epoch: 20, Steps: 17 | Train Loss: 0.640 Vali Loss: 2.234 Vali Acc: 0.323 Test Loss: 2.234 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.35361216730038025
model parameter : 1928220
model size : 9.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6372904777526855
Epoch: 1, Steps: 17 | Train Loss: 1.559 Vali Loss: 2.041 Vali Acc: 0.251 Test Loss: 2.041 Test Acc: 0.251
Validation loss decreased (inf --> -0.250930).  Saving model ...
Epoch: 2 cost time: 1.8841042518615723
Epoch: 2, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.981 Vali Acc: 0.251 Test Loss: 1.981 Test Acc: 0.251
Validation loss decreased (-0.250930 --> -0.250931).  Saving model ...
Epoch: 3 cost time: 1.803025484085083
Epoch: 3, Steps: 17 | Train Loss: 1.978 Vali Loss: 2.276 Vali Acc: 0.262 Test Loss: 2.276 Test Acc: 0.262
Validation loss decreased (-0.250931 --> -0.262335).  Saving model ...
Epoch: 4 cost time: 1.8866333961486816
Epoch: 4, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.676 Vali Acc: 0.274 Test Loss: 1.676 Test Acc: 0.274
Validation loss decreased (-0.262335 --> -0.273748).  Saving model ...
Epoch: 5 cost time: 1.8152949810028076
Epoch: 5, Steps: 17 | Train Loss: 1.771 Vali Loss: 2.008 Vali Acc: 0.240 Test Loss: 2.008 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5804011821746826
Epoch: 6, Steps: 17 | Train Loss: 1.764 Vali Loss: 1.775 Vali Acc: 0.255 Test Loss: 1.775 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8003501892089844
Epoch: 7, Steps: 17 | Train Loss: 1.288 Vali Loss: 2.400 Vali Acc: 0.255 Test Loss: 2.400 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.8628475666046143
Epoch: 8, Steps: 17 | Train Loss: 1.472 Vali Loss: 1.729 Vali Acc: 0.289 Test Loss: 1.729 Test Acc: 0.289
Validation loss decreased (-0.273748 --> -0.288956).  Saving model ...
Epoch: 9 cost time: 1.9156906604766846
Epoch: 9, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.882 Vali Acc: 0.327 Test Loss: 1.882 Test Acc: 0.327
Validation loss decreased (-0.288956 --> -0.326977).  Saving model ...
Epoch: 10 cost time: 1.6080970764160156
Epoch: 10, Steps: 17 | Train Loss: 1.433 Vali Loss: 4.040 Vali Acc: 0.251 Test Loss: 4.040 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6572608947753906
Epoch: 11, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.935 Vali Acc: 0.293 Test Loss: 1.935 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8306550979614258
Epoch: 12, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.882 Vali Acc: 0.285 Test Loss: 1.882 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7408332824707031
Epoch: 13, Steps: 17 | Train Loss: 1.009 Vali Loss: 2.301 Vali Acc: 0.270 Test Loss: 2.301 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.634843349456787
Epoch: 14, Steps: 17 | Train Loss: 1.180 Vali Loss: 2.707 Vali Acc: 0.270 Test Loss: 2.707 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.806473970413208
Epoch: 15, Steps: 17 | Train Loss: 1.296 Vali Loss: 3.295 Vali Acc: 0.255 Test Loss: 3.295 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8422763347625732
Epoch: 16, Steps: 17 | Train Loss: 1.325 Vali Loss: 2.416 Vali Acc: 0.281 Test Loss: 2.416 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.9638829231262207
Epoch: 17, Steps: 17 | Train Loss: 0.908 Vali Loss: 2.342 Vali Acc: 0.300 Test Loss: 2.342 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.654796838760376
Epoch: 18, Steps: 17 | Train Loss: 0.744 Vali Loss: 2.317 Vali Acc: 0.346 Test Loss: 2.317 Test Acc: 0.346
Validation loss decreased (-0.326977 --> -0.345984).  Saving model ...
Epoch: 19 cost time: 1.6023459434509277
Epoch: 19, Steps: 17 | Train Loss: 0.900 Vali Loss: 2.156 Vali Acc: 0.350 Test Loss: 2.156 Test Acc: 0.350
Validation loss decreased (-0.345984 --> -0.349788).  Saving model ...
Epoch: 20 cost time: 1.6417489051818848
Epoch: 20, Steps: 17 | Train Loss: 1.024 Vali Loss: 3.437 Vali Acc: 0.308 Test Loss: 3.437 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8432533740997314
Epoch: 21, Steps: 17 | Train Loss: 0.973 Vali Loss: 2.854 Vali Acc: 0.304 Test Loss: 2.854 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.760514497756958
Epoch: 22, Steps: 17 | Train Loss: 1.086 Vali Loss: 2.439 Vali Acc: 0.354 Test Loss: 2.439 Test Acc: 0.354
Validation loss decreased (-0.349788 --> -0.353588).  Saving model ...
Epoch: 23 cost time: 1.9199905395507812
Epoch: 23, Steps: 17 | Train Loss: 0.922 Vali Loss: 3.062 Vali Acc: 0.304 Test Loss: 3.062 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8637008666992188
Epoch: 24, Steps: 17 | Train Loss: 0.848 Vali Loss: 3.763 Vali Acc: 0.293 Test Loss: 3.763 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.309037446975708
Epoch: 25, Steps: 17 | Train Loss: 1.081 Vali Loss: 2.682 Vali Acc: 0.300 Test Loss: 2.682 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6447463035583496
Epoch: 26, Steps: 17 | Train Loss: 0.658 Vali Loss: 2.866 Vali Acc: 0.308 Test Loss: 2.866 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7557957172393799
Epoch: 27, Steps: 17 | Train Loss: 0.588 Vali Loss: 3.182 Vali Acc: 0.312 Test Loss: 3.182 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.538426160812378
Epoch: 28, Steps: 17 | Train Loss: 0.686 Vali Loss: 3.218 Vali Acc: 0.357 Test Loss: 3.218 Test Acc: 0.357
Validation loss decreased (-0.353588 --> -0.357382).  Saving model ...
Epoch: 29 cost time: 1.9095830917358398
Epoch: 29, Steps: 17 | Train Loss: 0.712 Vali Loss: 3.151 Vali Acc: 0.331 Test Loss: 3.151 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.880526065826416
Epoch: 30, Steps: 17 | Train Loss: 0.487 Vali Loss: 3.302 Vali Acc: 0.308 Test Loss: 3.302 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.681074857711792
Epoch: 31, Steps: 17 | Train Loss: 0.505 Vali Loss: 4.287 Vali Acc: 0.289 Test Loss: 4.287 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.233687162399292
Epoch: 32, Steps: 17 | Train Loss: 0.637 Vali Loss: 3.482 Vali Acc: 0.323 Test Loss: 3.482 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.0567328929901123
Epoch: 33, Steps: 17 | Train Loss: 0.844 Vali Loss: 3.989 Vali Acc: 0.312 Test Loss: 3.989 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.8788728713989258
Epoch: 34, Steps: 17 | Train Loss: 0.858 Vali Loss: 3.949 Vali Acc: 0.316 Test Loss: 3.949 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.8569042682647705
Epoch: 35, Steps: 17 | Train Loss: 0.538 Vali Loss: 3.392 Vali Acc: 0.338 Test Loss: 3.392 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.9688501358032227
Epoch: 36, Steps: 17 | Train Loss: 0.687 Vali Loss: 3.779 Vali Acc: 0.289 Test Loss: 3.779 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.612600326538086
Epoch: 37, Steps: 17 | Train Loss: 0.333 Vali Loss: 3.680 Vali Acc: 0.312 Test Loss: 3.680 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.672612190246582
Epoch: 38, Steps: 17 | Train Loss: 0.495 Vali Loss: 4.171 Vali Acc: 0.342 Test Loss: 4.171 Test Acc: 0.342
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3574144486692015
model parameter : 1909532
model size : 9.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4883956909179688
Epoch: 1, Steps: 17 | Train Loss: 1.630 Vali Loss: 1.733 Vali Acc: 0.247 Test Loss: 1.733 Test Acc: 0.247
Validation loss decreased (inf --> -0.247131).  Saving model ...
Epoch: 2 cost time: 1.6496522426605225
Epoch: 2, Steps: 17 | Train Loss: 1.674 Vali Loss: 1.833 Vali Acc: 0.255 Test Loss: 1.833 Test Acc: 0.255
Validation loss decreased (-0.247131 --> -0.254735).  Saving model ...
Epoch: 3 cost time: 1.701301097869873
Epoch: 3, Steps: 17 | Train Loss: 1.623 Vali Loss: 1.690 Vali Acc: 0.240 Test Loss: 1.690 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8079555034637451
Epoch: 4, Steps: 17 | Train Loss: 1.485 Vali Loss: 2.263 Vali Acc: 0.270 Test Loss: 2.263 Test Acc: 0.270
Validation loss decreased (-0.254735 --> -0.269939).  Saving model ...
Epoch: 5 cost time: 1.5752172470092773
Epoch: 5, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.506 Vali Acc: 0.285 Test Loss: 1.506 Test Acc: 0.285
Validation loss decreased (-0.269939 --> -0.285156).  Saving model ...
Epoch: 6 cost time: 1.6255929470062256
Epoch: 6, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.777 Vali Acc: 0.293 Test Loss: 1.777 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292758).  Saving model ...
Epoch: 7 cost time: 1.8902838230133057
Epoch: 7, Steps: 17 | Train Loss: 1.466 Vali Loss: 2.112 Vali Acc: 0.243 Test Loss: 2.112 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6455321311950684
Epoch: 8, Steps: 17 | Train Loss: 1.472 Vali Loss: 2.376 Vali Acc: 0.285 Test Loss: 2.376 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6739401817321777
Epoch: 9, Steps: 17 | Train Loss: 1.641 Vali Loss: 2.515 Vali Acc: 0.255 Test Loss: 2.515 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5199291706085205
Epoch: 10, Steps: 17 | Train Loss: 1.430 Vali Loss: 1.871 Vali Acc: 0.304 Test Loss: 1.871 Test Acc: 0.304
Validation loss decreased (-0.292758 --> -0.304164).  Saving model ...
Epoch: 11 cost time: 1.540435791015625
Epoch: 11, Steps: 17 | Train Loss: 1.360 Vali Loss: 2.680 Vali Acc: 0.251 Test Loss: 2.680 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7651631832122803
Epoch: 12, Steps: 17 | Train Loss: 1.102 Vali Loss: 2.113 Vali Acc: 0.300 Test Loss: 2.113 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4468300342559814
Epoch: 13, Steps: 17 | Train Loss: 1.100 Vali Loss: 2.231 Vali Acc: 0.289 Test Loss: 2.231 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6433346271514893
Epoch: 14, Steps: 17 | Train Loss: 0.940 Vali Loss: 2.492 Vali Acc: 0.316 Test Loss: 2.492 Test Acc: 0.316
Validation loss decreased (-0.304164 --> -0.315564).  Saving model ...
Epoch: 15 cost time: 1.591278314590454
Epoch: 15, Steps: 17 | Train Loss: 1.133 Vali Loss: 2.433 Vali Acc: 0.285 Test Loss: 2.433 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6462900638580322
Epoch: 16, Steps: 17 | Train Loss: 1.153 Vali Loss: 2.128 Vali Acc: 0.354 Test Loss: 2.128 Test Acc: 0.354
Validation loss decreased (-0.315564 --> -0.353591).  Saving model ...
Epoch: 17 cost time: 1.6370036602020264
Epoch: 17, Steps: 17 | Train Loss: 1.034 Vali Loss: 2.109 Vali Acc: 0.327 Test Loss: 2.109 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2877252101898193
Epoch: 18, Steps: 17 | Train Loss: 0.740 Vali Loss: 2.119 Vali Acc: 0.327 Test Loss: 2.119 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6539616584777832
Epoch: 19, Steps: 17 | Train Loss: 1.111 Vali Loss: 2.711 Vali Acc: 0.304 Test Loss: 2.711 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7791728973388672
Epoch: 20, Steps: 17 | Train Loss: 0.865 Vali Loss: 2.363 Vali Acc: 0.361 Test Loss: 2.363 Test Acc: 0.361
Validation loss decreased (-0.353591 --> -0.361193).  Saving model ...
Epoch: 21 cost time: 1.5625829696655273
Epoch: 21, Steps: 17 | Train Loss: 0.769 Vali Loss: 2.232 Vali Acc: 0.346 Test Loss: 2.232 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.7338523864746094
Epoch: 22, Steps: 17 | Train Loss: 0.858 Vali Loss: 2.313 Vali Acc: 0.312 Test Loss: 2.313 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4813408851623535
Epoch: 23, Steps: 17 | Train Loss: 0.800 Vali Loss: 2.929 Vali Acc: 0.312 Test Loss: 2.929 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.3814780712127686
Epoch: 24, Steps: 17 | Train Loss: 0.617 Vali Loss: 2.500 Vali Acc: 0.331 Test Loss: 2.500 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5653069019317627
Epoch: 25, Steps: 17 | Train Loss: 0.454 Vali Loss: 2.694 Vali Acc: 0.338 Test Loss: 2.694 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5374410152435303
Epoch: 26, Steps: 17 | Train Loss: 0.518 Vali Loss: 3.394 Vali Acc: 0.342 Test Loss: 3.394 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5019948482513428
Epoch: 27, Steps: 17 | Train Loss: 1.104 Vali Loss: 3.506 Vali Acc: 0.297 Test Loss: 3.506 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5754060745239258
Epoch: 28, Steps: 17 | Train Loss: 0.672 Vali Loss: 3.370 Vali Acc: 0.338 Test Loss: 3.370 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.58184814453125
Epoch: 29, Steps: 17 | Train Loss: 0.430 Vali Loss: 2.937 Vali Acc: 0.338 Test Loss: 2.937 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.785651445388794
Epoch: 30, Steps: 17 | Train Loss: 0.805 Vali Loss: 2.971 Vali Acc: 0.331 Test Loss: 2.971 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3612167300380228
model parameter : 1890844
model size : 9.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5760786533355713
Epoch: 1, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.663 Vali Acc: 0.236 Test Loss: 1.663 Test Acc: 0.236
Validation loss decreased (inf --> -0.235725).  Saving model ...
Epoch: 2 cost time: 1.8182306289672852
Epoch: 2, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.768 Vali Acc: 0.236 Test Loss: 1.768 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6279489994049072
Epoch: 3, Steps: 17 | Train Loss: 1.728 Vali Loss: 1.883 Vali Acc: 0.259 Test Loss: 1.883 Test Acc: 0.259
Validation loss decreased (-0.235725 --> -0.258536).  Saving model ...
Epoch: 4 cost time: 1.6980717182159424
Epoch: 4, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.999 Vali Acc: 0.262 Test Loss: 1.999 Test Acc: 0.262
Validation loss decreased (-0.258536 --> -0.262337).  Saving model ...
Epoch: 5 cost time: 1.832580804824829
Epoch: 5, Steps: 17 | Train Loss: 1.866 Vali Loss: 2.720 Vali Acc: 0.255 Test Loss: 2.720 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4491662979125977
Epoch: 6, Steps: 17 | Train Loss: 2.188 Vali Loss: 2.255 Vali Acc: 0.247 Test Loss: 2.255 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.598865032196045
Epoch: 7, Steps: 17 | Train Loss: 1.692 Vali Loss: 2.010 Vali Acc: 0.316 Test Loss: 2.010 Test Acc: 0.316
Validation loss decreased (-0.262337 --> -0.315569).  Saving model ...
Epoch: 8 cost time: 1.7066774368286133
Epoch: 8, Steps: 17 | Train Loss: 1.599 Vali Loss: 2.658 Vali Acc: 0.247 Test Loss: 2.658 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4753968715667725
Epoch: 9, Steps: 17 | Train Loss: 2.564 Vali Loss: 2.580 Vali Acc: 0.304 Test Loss: 2.580 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7539749145507812
Epoch: 10, Steps: 17 | Train Loss: 2.068 Vali Loss: 2.896 Vali Acc: 0.243 Test Loss: 2.896 Test Acc: 0.243
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6204965114593506
Epoch: 11, Steps: 17 | Train Loss: 1.420 Vali Loss: 2.027 Vali Acc: 0.297 Test Loss: 2.027 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6233043670654297
Epoch: 12, Steps: 17 | Train Loss: 1.387 Vali Loss: 1.906 Vali Acc: 0.293 Test Loss: 1.906 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5875577926635742
Epoch: 13, Steps: 17 | Train Loss: 1.254 Vali Loss: 2.317 Vali Acc: 0.293 Test Loss: 2.317 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6843619346618652
Epoch: 14, Steps: 17 | Train Loss: 1.206 Vali Loss: 2.137 Vali Acc: 0.300 Test Loss: 2.137 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.7649097442626953
Epoch: 15, Steps: 17 | Train Loss: 1.025 Vali Loss: 2.728 Vali Acc: 0.262 Test Loss: 2.728 Test Acc: 0.262
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.843923568725586
Epoch: 16, Steps: 17 | Train Loss: 1.230 Vali Loss: 2.718 Vali Acc: 0.312 Test Loss: 2.718 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8678603172302246
Epoch: 17, Steps: 17 | Train Loss: 1.244 Vali Loss: 2.056 Vali Acc: 0.285 Test Loss: 2.056 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 1552156
model size : 8.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7243428230285645
Epoch: 1, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.959 Vali Acc: 0.255 Test Loss: 1.959 Test Acc: 0.255
Validation loss decreased (inf --> -0.254733).  Saving model ...
Epoch: 2 cost time: 1.794238805770874
Epoch: 2, Steps: 17 | Train Loss: 1.716 Vali Loss: 1.591 Vali Acc: 0.278 Test Loss: 1.591 Test Acc: 0.278
Validation loss decreased (-0.254733 --> -0.277551).  Saving model ...
Epoch: 3 cost time: 1.5943577289581299
Epoch: 3, Steps: 17 | Train Loss: 1.629 Vali Loss: 1.872 Vali Acc: 0.259 Test Loss: 1.872 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7276225090026855
Epoch: 4, Steps: 17 | Train Loss: 2.021 Vali Loss: 1.740 Vali Acc: 0.285 Test Loss: 1.740 Test Acc: 0.285
Validation loss decreased (-0.277551 --> -0.285154).  Saving model ...
Epoch: 5 cost time: 1.9494271278381348
Epoch: 5, Steps: 17 | Train Loss: 1.653 Vali Loss: 2.611 Vali Acc: 0.255 Test Loss: 2.611 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7952964305877686
Epoch: 6, Steps: 17 | Train Loss: 1.824 Vali Loss: 2.100 Vali Acc: 0.270 Test Loss: 2.100 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.8853766918182373
Epoch: 7, Steps: 17 | Train Loss: 1.565 Vali Loss: 2.059 Vali Acc: 0.293 Test Loss: 2.059 Test Acc: 0.293
Validation loss decreased (-0.285154 --> -0.292755).  Saving model ...
Epoch: 8 cost time: 1.7517077922821045
Epoch: 8, Steps: 17 | Train Loss: 1.415 Vali Loss: 2.006 Vali Acc: 0.304 Test Loss: 2.006 Test Acc: 0.304
Validation loss decreased (-0.292755 --> -0.304162).  Saving model ...
Epoch: 9 cost time: 1.8950862884521484
Epoch: 9, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.960 Vali Acc: 0.289 Test Loss: 1.960 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1699657440185547
Epoch: 10, Steps: 17 | Train Loss: 1.649 Vali Loss: 2.650 Vali Acc: 0.281 Test Loss: 2.650 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9843363761901855
Epoch: 11, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.767 Vali Acc: 0.316 Test Loss: 1.767 Test Acc: 0.316
Validation loss decreased (-0.304162 --> -0.315572).  Saving model ...
Epoch: 12 cost time: 1.673872470855713
Epoch: 12, Steps: 17 | Train Loss: 1.016 Vali Loss: 2.632 Vali Acc: 0.251 Test Loss: 2.632 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.0551342964172363
Epoch: 13, Steps: 17 | Train Loss: 1.439 Vali Loss: 2.321 Vali Acc: 0.289 Test Loss: 2.321 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9290785789489746
Epoch: 14, Steps: 17 | Train Loss: 1.021 Vali Loss: 2.521 Vali Acc: 0.281 Test Loss: 2.521 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8517849445343018
Epoch: 15, Steps: 17 | Train Loss: 1.240 Vali Loss: 2.356 Vali Acc: 0.335 Test Loss: 2.356 Test Acc: 0.335
Validation loss decreased (-0.315572 --> -0.334577).  Saving model ...
Epoch: 16 cost time: 1.8024981021881104
Epoch: 16, Steps: 17 | Train Loss: 1.029 Vali Loss: 2.190 Vali Acc: 0.300 Test Loss: 2.190 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8586511611938477
Epoch: 17, Steps: 17 | Train Loss: 0.889 Vali Loss: 2.363 Vali Acc: 0.319 Test Loss: 2.363 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7746250629425049
Epoch: 18, Steps: 17 | Train Loss: 0.742 Vali Loss: 2.704 Vali Acc: 0.308 Test Loss: 2.704 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7287399768829346
Epoch: 19, Steps: 17 | Train Loss: 0.767 Vali Loss: 2.301 Vali Acc: 0.346 Test Loss: 2.301 Test Acc: 0.346
Validation loss decreased (-0.334577 --> -0.345985).  Saving model ...
Epoch: 20 cost time: 1.5939559936523438
Epoch: 20, Steps: 17 | Train Loss: 0.895 Vali Loss: 2.705 Vali Acc: 0.304 Test Loss: 2.705 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4823269844055176
Epoch: 21, Steps: 17 | Train Loss: 0.771 Vali Loss: 2.565 Vali Acc: 0.308 Test Loss: 2.565 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8270549774169922
Epoch: 22, Steps: 17 | Train Loss: 0.615 Vali Loss: 2.748 Vali Acc: 0.304 Test Loss: 2.748 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.421180009841919
Epoch: 23, Steps: 17 | Train Loss: 0.772 Vali Loss: 3.068 Vali Acc: 0.319 Test Loss: 3.068 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4091756343841553
Epoch: 24, Steps: 17 | Train Loss: 0.646 Vali Loss: 2.918 Vali Acc: 0.331 Test Loss: 2.918 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.7658839225769043
Epoch: 25, Steps: 17 | Train Loss: 0.688 Vali Loss: 3.085 Vali Acc: 0.357 Test Loss: 3.085 Test Acc: 0.357
Validation loss decreased (-0.345985 --> -0.357384).  Saving model ...
Epoch: 26 cost time: 1.950920820236206
Epoch: 26, Steps: 17 | Train Loss: 0.670 Vali Loss: 3.187 Vali Acc: 0.323 Test Loss: 3.187 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3884081840515137
Epoch: 27, Steps: 17 | Train Loss: 0.624 Vali Loss: 2.706 Vali Acc: 0.308 Test Loss: 2.706 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4219956398010254
Epoch: 28, Steps: 17 | Train Loss: 0.447 Vali Loss: 2.906 Vali Acc: 0.354 Test Loss: 2.906 Test Acc: 0.354
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.532886028289795
Epoch: 29, Steps: 17 | Train Loss: 0.407 Vali Loss: 3.571 Vali Acc: 0.342 Test Loss: 3.571 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.415604591369629
Epoch: 30, Steps: 17 | Train Loss: 0.599 Vali Loss: 3.083 Vali Acc: 0.297 Test Loss: 3.083 Test Acc: 0.297
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7686598300933838
Epoch: 31, Steps: 17 | Train Loss: 0.572 Vali Loss: 3.442 Vali Acc: 0.293 Test Loss: 3.442 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.397446870803833
Epoch: 32, Steps: 17 | Train Loss: 0.503 Vali Loss: 3.660 Vali Acc: 0.312 Test Loss: 3.660 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.3965818881988525
Epoch: 33, Steps: 17 | Train Loss: 0.549 Vali Loss: 3.067 Vali Acc: 0.346 Test Loss: 3.067 Test Acc: 0.346
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.4073796272277832
Epoch: 34, Steps: 17 | Train Loss: 0.278 Vali Loss: 3.441 Vali Acc: 0.354 Test Loss: 3.441 Test Acc: 0.354
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5191259384155273
Epoch: 35, Steps: 17 | Train Loss: 0.482 Vali Loss: 3.831 Vali Acc: 0.323 Test Loss: 3.831 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3574144486692015
model parameter : 1533468
model size : 8.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.2544310092926025
Epoch: 1, Steps: 17 | Train Loss: 1.496 Vali Loss: 1.767 Vali Acc: 0.251 Test Loss: 1.767 Test Acc: 0.251
Validation loss decreased (inf --> -0.250933).  Saving model ...
Epoch: 2 cost time: 1.7754590511322021
Epoch: 2, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.609 Vali Acc: 0.232 Test Loss: 1.609 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8008944988250732
Epoch: 3, Steps: 17 | Train Loss: 1.596 Vali Loss: 2.554 Vali Acc: 0.251 Test Loss: 2.554 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.9507033824920654
Epoch: 4, Steps: 17 | Train Loss: 2.213 Vali Loss: 2.094 Vali Acc: 0.308 Test Loss: 2.094 Test Acc: 0.308
Validation loss decreased (-0.250933 --> -0.307964).  Saving model ...
Epoch: 5 cost time: 1.6987032890319824
Epoch: 5, Steps: 17 | Train Loss: 1.895 Vali Loss: 1.537 Vali Acc: 0.297 Test Loss: 1.537 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6575744152069092
Epoch: 6, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.934 Vali Acc: 0.262 Test Loss: 1.934 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5189182758331299
Epoch: 7, Steps: 17 | Train Loss: 1.848 Vali Loss: 2.981 Vali Acc: 0.262 Test Loss: 2.981 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4984774589538574
Epoch: 8, Steps: 17 | Train Loss: 1.730 Vali Loss: 1.793 Vali Acc: 0.262 Test Loss: 1.793 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8310449123382568
Epoch: 9, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.981 Vali Acc: 0.278 Test Loss: 1.981 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.67128586769104
Epoch: 10, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.865 Vali Acc: 0.278 Test Loss: 1.865 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.586073875427246
Epoch: 11, Steps: 17 | Train Loss: 1.296 Vali Loss: 2.832 Vali Acc: 0.266 Test Loss: 2.832 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8376374244689941
Epoch: 12, Steps: 17 | Train Loss: 1.617 Vali Loss: 2.587 Vali Acc: 0.289 Test Loss: 2.587 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.956726312637329
Epoch: 13, Steps: 17 | Train Loss: 1.878 Vali Loss: 3.355 Vali Acc: 0.278 Test Loss: 3.355 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6468641757965088
Epoch: 14, Steps: 17 | Train Loss: 1.514 Vali Loss: 2.467 Vali Acc: 0.289 Test Loss: 2.467 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 1514780
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.272770643234253
Epoch: 1, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.767 Vali Acc: 0.270 Test Loss: 1.767 Test Acc: 0.270
Validation loss decreased (inf --> -0.269944).  Saving model ...
Epoch: 2 cost time: 1.6473870277404785
Epoch: 2, Steps: 17 | Train Loss: 1.746 Vali Loss: 2.229 Vali Acc: 0.243 Test Loss: 2.229 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.8067419528961182
Epoch: 3, Steps: 17 | Train Loss: 1.766 Vali Loss: 2.368 Vali Acc: 0.251 Test Loss: 2.368 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6654322147369385
Epoch: 4, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.656 Vali Acc: 0.240 Test Loss: 1.656 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.602433443069458
Epoch: 5, Steps: 17 | Train Loss: 1.640 Vali Loss: 2.172 Vali Acc: 0.251 Test Loss: 2.172 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5376482009887695
Epoch: 6, Steps: 17 | Train Loss: 1.870 Vali Loss: 1.957 Vali Acc: 0.243 Test Loss: 1.957 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5185918807983398
Epoch: 7, Steps: 17 | Train Loss: 1.435 Vali Loss: 2.711 Vali Acc: 0.285 Test Loss: 2.711 Test Acc: 0.285
Validation loss decreased (-0.269944 --> -0.285144).  Saving model ...
Epoch: 8 cost time: 1.724297046661377
Epoch: 8, Steps: 17 | Train Loss: 1.602 Vali Loss: 2.026 Vali Acc: 0.266 Test Loss: 2.026 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.483335018157959
Epoch: 9, Steps: 17 | Train Loss: 1.459 Vali Loss: 2.088 Vali Acc: 0.259 Test Loss: 2.088 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6523525714874268
Epoch: 10, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.892 Vali Acc: 0.297 Test Loss: 1.892 Test Acc: 0.297
Validation loss decreased (-0.285144 --> -0.296559).  Saving model ...
Epoch: 11 cost time: 1.487854242324829
Epoch: 11, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.874 Vali Acc: 0.289 Test Loss: 1.874 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4139416217803955
Epoch: 12, Steps: 17 | Train Loss: 1.265 Vali Loss: 2.150 Vali Acc: 0.300 Test Loss: 2.150 Test Acc: 0.300
Validation loss decreased (-0.296559 --> -0.300359).  Saving model ...
Epoch: 13 cost time: 1.5247437953948975
Epoch: 13, Steps: 17 | Train Loss: 1.541 Vali Loss: 2.553 Vali Acc: 0.278 Test Loss: 2.553 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.517695426940918
Epoch: 14, Steps: 17 | Train Loss: 1.459 Vali Loss: 2.263 Vali Acc: 0.285 Test Loss: 2.263 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6240496635437012
Epoch: 15, Steps: 17 | Train Loss: 1.067 Vali Loss: 2.278 Vali Acc: 0.285 Test Loss: 2.278 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5102486610412598
Epoch: 16, Steps: 17 | Train Loss: 0.846 Vali Loss: 2.783 Vali Acc: 0.304 Test Loss: 2.783 Test Acc: 0.304
Validation loss decreased (-0.300359 --> -0.304155).  Saving model ...
Epoch: 17 cost time: 1.381598949432373
Epoch: 17, Steps: 17 | Train Loss: 1.211 Vali Loss: 2.525 Vali Acc: 0.316 Test Loss: 2.525 Test Acc: 0.316
Validation loss decreased (-0.304155 --> -0.315564).  Saving model ...
Epoch: 18 cost time: 1.5503530502319336
Epoch: 18, Steps: 17 | Train Loss: 0.988 Vali Loss: 2.397 Vali Acc: 0.289 Test Loss: 2.397 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.4289259910583496
Epoch: 19, Steps: 17 | Train Loss: 1.066 Vali Loss: 2.464 Vali Acc: 0.319 Test Loss: 2.464 Test Acc: 0.319
Validation loss decreased (-0.315564 --> -0.319367).  Saving model ...
Epoch: 20 cost time: 1.6563234329223633
Epoch: 20, Steps: 17 | Train Loss: 1.048 Vali Loss: 2.518 Vali Acc: 0.316 Test Loss: 2.518 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5538792610168457
Epoch: 21, Steps: 17 | Train Loss: 0.864 Vali Loss: 2.566 Vali Acc: 0.319 Test Loss: 2.566 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6974492073059082
Epoch: 22, Steps: 17 | Train Loss: 0.703 Vali Loss: 2.462 Vali Acc: 0.338 Test Loss: 2.462 Test Acc: 0.338
Validation loss decreased (-0.319367 --> -0.338378).  Saving model ...
Epoch: 23 cost time: 1.6664209365844727
Epoch: 23, Steps: 17 | Train Loss: 0.584 Vali Loss: 3.180 Vali Acc: 0.262 Test Loss: 3.180 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5304226875305176
Epoch: 24, Steps: 17 | Train Loss: 0.787 Vali Loss: 2.696 Vali Acc: 0.342 Test Loss: 2.696 Test Acc: 0.342
Validation loss decreased (-0.338378 --> -0.342178).  Saving model ...
Epoch: 25 cost time: 1.5859715938568115
Epoch: 25, Steps: 17 | Train Loss: 0.884 Vali Loss: 3.321 Vali Acc: 0.304 Test Loss: 3.321 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7417492866516113
Epoch: 26, Steps: 17 | Train Loss: 0.661 Vali Loss: 2.442 Vali Acc: 0.327 Test Loss: 2.442 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.5390920639038086
Epoch: 27, Steps: 17 | Train Loss: 0.787 Vali Loss: 2.944 Vali Acc: 0.319 Test Loss: 2.944 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7407727241516113
Epoch: 28, Steps: 17 | Train Loss: 0.530 Vali Loss: 3.329 Vali Acc: 0.361 Test Loss: 3.329 Test Acc: 0.361
Validation loss decreased (-0.342178 --> -0.361183).  Saving model ...
Epoch: 29 cost time: 1.7641446590423584
Epoch: 29, Steps: 17 | Train Loss: 0.875 Vali Loss: 3.144 Vali Acc: 0.327 Test Loss: 3.144 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.7134671211242676
Epoch: 30, Steps: 17 | Train Loss: 0.583 Vali Loss: 2.958 Vali Acc: 0.357 Test Loss: 2.958 Test Acc: 0.357
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.5745418071746826
Epoch: 31, Steps: 17 | Train Loss: 0.492 Vali Loss: 3.603 Vali Acc: 0.323 Test Loss: 3.603 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.53200101852417
Epoch: 32, Steps: 17 | Train Loss: 0.460 Vali Loss: 3.927 Vali Acc: 0.335 Test Loss: 3.927 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.5663959980010986
Epoch: 33, Steps: 17 | Train Loss: 0.681 Vali Loss: 3.057 Vali Acc: 0.342 Test Loss: 3.057 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.7569663524627686
Epoch: 34, Steps: 17 | Train Loss: 0.420 Vali Loss: 3.574 Vali Acc: 0.354 Test Loss: 3.574 Test Acc: 0.354
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.5559263229370117
Epoch: 35, Steps: 17 | Train Loss: 0.465 Vali Loss: 3.961 Vali Acc: 0.312 Test Loss: 3.961 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.694606065750122
Epoch: 36, Steps: 17 | Train Loss: 0.634 Vali Loss: 4.683 Vali Acc: 0.346 Test Loss: 4.683 Test Acc: 0.346
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.6288838386535645
Epoch: 37, Steps: 17 | Train Loss: 0.403 Vali Loss: 4.090 Vali Acc: 0.323 Test Loss: 4.090 Test Acc: 0.323
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.7199242115020752
Epoch: 38, Steps: 17 | Train Loss: 0.318 Vali Loss: 5.375 Vali Acc: 0.293 Test Loss: 5.375 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3612167300380228
model parameter : 1496092
model size : 8.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.206427574157715
Epoch: 1, Steps: 17 | Train Loss: 1.650 Vali Loss: 1.830 Vali Acc: 0.262 Test Loss: 1.830 Test Acc: 0.262
Validation loss decreased (inf --> -0.262339).  Saving model ...
Epoch: 2 cost time: 1.7074379920959473
Epoch: 2, Steps: 17 | Train Loss: 1.674 Vali Loss: 1.595 Vali Acc: 0.266 Test Loss: 1.595 Test Acc: 0.266
Validation loss decreased (-0.262339 --> -0.266144).  Saving model ...
Epoch: 3 cost time: 1.7314848899841309
Epoch: 3, Steps: 17 | Train Loss: 1.586 Vali Loss: 2.328 Vali Acc: 0.255 Test Loss: 2.328 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7281744480133057
Epoch: 4, Steps: 17 | Train Loss: 2.173 Vali Loss: 3.111 Vali Acc: 0.251 Test Loss: 3.111 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.679839849472046
Epoch: 5, Steps: 17 | Train Loss: 2.356 Vali Loss: 2.834 Vali Acc: 0.240 Test Loss: 2.834 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.7050979137420654
Epoch: 6, Steps: 17 | Train Loss: 2.014 Vali Loss: 1.964 Vali Acc: 0.308 Test Loss: 1.964 Test Acc: 0.308
Validation loss decreased (-0.266144 --> -0.307965).  Saving model ...
Epoch: 7 cost time: 1.7782742977142334
Epoch: 7, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.817 Vali Acc: 0.293 Test Loss: 1.817 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7349939346313477
Epoch: 8, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.842 Vali Acc: 0.247 Test Loss: 1.842 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8285188674926758
Epoch: 9, Steps: 17 | Train Loss: 2.179 Vali Loss: 2.619 Vali Acc: 0.247 Test Loss: 2.619 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7957231998443604
Epoch: 10, Steps: 17 | Train Loss: 1.693 Vali Loss: 2.421 Vali Acc: 0.281 Test Loss: 2.421 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8752539157867432
Epoch: 11, Steps: 17 | Train Loss: 1.471 Vali Loss: 2.083 Vali Acc: 0.308 Test Loss: 2.083 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6981046199798584
Epoch: 12, Steps: 17 | Train Loss: 1.310 Vali Loss: 2.106 Vali Acc: 0.278 Test Loss: 2.106 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7377195358276367
Epoch: 13, Steps: 17 | Train Loss: 1.387 Vali Loss: 2.366 Vali Acc: 0.266 Test Loss: 2.366 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5682480335235596
Epoch: 14, Steps: 17 | Train Loss: 1.187 Vali Loss: 2.257 Vali Acc: 0.278 Test Loss: 2.257 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.7883448600769043
Epoch: 15, Steps: 17 | Train Loss: 0.969 Vali Loss: 2.038 Vali Acc: 0.289 Test Loss: 2.038 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.7524821758270264
Epoch: 16, Steps: 17 | Train Loss: 1.044 Vali Loss: 2.290 Vali Acc: 0.297 Test Loss: 2.290 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.30798479087452474
model parameter : 1354780
model size : 7.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6674282550811768
Epoch: 1, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.482 Vali Acc: 0.262 Test Loss: 1.482 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.6184415817260742
Epoch: 2, Steps: 17 | Train Loss: 1.541 Vali Loss: 2.094 Vali Acc: 0.285 Test Loss: 2.094 Test Acc: 0.285
Validation loss decreased (-0.262343 --> -0.285150).  Saving model ...
Epoch: 3 cost time: 2.033449649810791
Epoch: 3, Steps: 17 | Train Loss: 1.990 Vali Loss: 2.042 Vali Acc: 0.262 Test Loss: 2.042 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9533555507659912
Epoch: 4, Steps: 17 | Train Loss: 1.855 Vali Loss: 2.102 Vali Acc: 0.285 Test Loss: 2.102 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6155238151550293
Epoch: 5, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.951 Vali Acc: 0.270 Test Loss: 1.951 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.6807503700256348
Epoch: 6, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.890 Vali Acc: 0.278 Test Loss: 1.890 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5826964378356934
Epoch: 7, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.817 Vali Acc: 0.266 Test Loss: 1.817 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.9068706035614014
Epoch: 8, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.928 Vali Acc: 0.278 Test Loss: 1.928 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.9339070320129395
Epoch: 9, Steps: 17 | Train Loss: 1.928 Vali Loss: 4.698 Vali Acc: 0.247 Test Loss: 4.698 Test Acc: 0.247
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.8813576698303223
Epoch: 10, Steps: 17 | Train Loss: 2.171 Vali Loss: 1.623 Vali Acc: 0.331 Test Loss: 1.623 Test Acc: 0.331
Validation loss decreased (-0.285150 --> -0.330782).  Saving model ...
Epoch: 11 cost time: 1.907590627670288
Epoch: 11, Steps: 17 | Train Loss: 1.516 Vali Loss: 2.560 Vali Acc: 0.247 Test Loss: 2.560 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2884087562561035
Epoch: 12, Steps: 17 | Train Loss: 1.591 Vali Loss: 2.688 Vali Acc: 0.278 Test Loss: 2.688 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8852269649505615
Epoch: 13, Steps: 17 | Train Loss: 1.672 Vali Loss: 3.466 Vali Acc: 0.247 Test Loss: 3.466 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8367199897766113
Epoch: 14, Steps: 17 | Train Loss: 1.546 Vali Loss: 2.522 Vali Acc: 0.331 Test Loss: 2.522 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7035505771636963
Epoch: 15, Steps: 17 | Train Loss: 1.540 Vali Loss: 2.632 Vali Acc: 0.289 Test Loss: 2.632 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9175300598144531
Epoch: 16, Steps: 17 | Train Loss: 0.942 Vali Loss: 1.938 Vali Acc: 0.331 Test Loss: 1.938 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9675049781799316
Epoch: 17, Steps: 17 | Train Loss: 1.098 Vali Loss: 2.142 Vali Acc: 0.308 Test Loss: 2.142 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.9072871208190918
Epoch: 18, Steps: 17 | Train Loss: 1.075 Vali Loss: 2.756 Vali Acc: 0.274 Test Loss: 2.756 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7355170249938965
Epoch: 19, Steps: 17 | Train Loss: 1.397 Vali Loss: 3.028 Vali Acc: 0.304 Test Loss: 3.028 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.9378297328948975
Epoch: 20, Steps: 17 | Train Loss: 0.933 Vali Loss: 2.814 Vali Acc: 0.278 Test Loss: 2.814 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33079847908745247
model parameter : 1336092
model size : 7.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4246273040771484
Epoch: 1, Steps: 17 | Train Loss: 1.712 Vali Loss: 2.055 Vali Acc: 0.243 Test Loss: 2.055 Test Acc: 0.243
Validation loss decreased (inf --> -0.243325).  Saving model ...
Epoch: 2 cost time: 1.7423231601715088
Epoch: 2, Steps: 17 | Train Loss: 2.056 Vali Loss: 1.696 Vali Acc: 0.285 Test Loss: 1.696 Test Acc: 0.285
Validation loss decreased (-0.243325 --> -0.285154).  Saving model ...
Epoch: 3 cost time: 1.796722173690796
Epoch: 3, Steps: 17 | Train Loss: 1.771 Vali Loss: 2.305 Vali Acc: 0.251 Test Loss: 2.305 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8763654232025146
Epoch: 4, Steps: 17 | Train Loss: 1.994 Vali Loss: 2.413 Vali Acc: 0.255 Test Loss: 2.413 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7641808986663818
Epoch: 5, Steps: 17 | Train Loss: 1.641 Vali Loss: 1.482 Vali Acc: 0.285 Test Loss: 1.482 Test Acc: 0.285
Validation loss decreased (-0.285154 --> -0.285156).  Saving model ...
Epoch: 6 cost time: 1.6446967124938965
Epoch: 6, Steps: 17 | Train Loss: 1.532 Vali Loss: 2.613 Vali Acc: 0.262 Test Loss: 2.613 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5452508926391602
Epoch: 7, Steps: 17 | Train Loss: 1.513 Vali Loss: 3.534 Vali Acc: 0.251 Test Loss: 3.534 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7659177780151367
Epoch: 8, Steps: 17 | Train Loss: 2.136 Vali Loss: 2.098 Vali Acc: 0.293 Test Loss: 2.098 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292755).  Saving model ...
Epoch: 9 cost time: 1.8145630359649658
Epoch: 9, Steps: 17 | Train Loss: 1.349 Vali Loss: 2.858 Vali Acc: 0.308 Test Loss: 2.858 Test Acc: 0.308
Validation loss decreased (-0.292755 --> -0.307956).  Saving model ...
Epoch: 10 cost time: 1.6765122413635254
Epoch: 10, Steps: 17 | Train Loss: 1.755 Vali Loss: 1.960 Vali Acc: 0.285 Test Loss: 1.960 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.478055477142334
Epoch: 11, Steps: 17 | Train Loss: 1.399 Vali Loss: 3.270 Vali Acc: 0.243 Test Loss: 3.270 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9081292152404785
Epoch: 12, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.811 Vali Acc: 0.304 Test Loss: 1.811 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6492576599121094
Epoch: 13, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.876 Vali Acc: 0.338 Test Loss: 1.876 Test Acc: 0.338
Validation loss decreased (-0.307956 --> -0.338384).  Saving model ...
Epoch: 14 cost time: 1.5197653770446777
Epoch: 14, Steps: 17 | Train Loss: 1.609 Vali Loss: 3.024 Vali Acc: 0.312 Test Loss: 3.024 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7060325145721436
Epoch: 15, Steps: 17 | Train Loss: 1.341 Vali Loss: 1.937 Vali Acc: 0.335 Test Loss: 1.937 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.912191390991211
Epoch: 16, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.938 Vali Acc: 0.338 Test Loss: 1.938 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.764904499053955
Epoch: 17, Steps: 17 | Train Loss: 1.074 Vali Loss: 2.681 Vali Acc: 0.327 Test Loss: 2.681 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.7220232486724854
Epoch: 18, Steps: 17 | Train Loss: 1.134 Vali Loss: 2.035 Vali Acc: 0.357 Test Loss: 2.035 Test Acc: 0.357
Validation loss decreased (-0.338384 --> -0.357394).  Saving model ...
Epoch: 19 cost time: 1.8671259880065918
Epoch: 19, Steps: 17 | Train Loss: 1.097 Vali Loss: 2.530 Vali Acc: 0.281 Test Loss: 2.530 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8137247562408447
Epoch: 20, Steps: 17 | Train Loss: 0.787 Vali Loss: 2.836 Vali Acc: 0.297 Test Loss: 2.836 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7306170463562012
Epoch: 21, Steps: 17 | Train Loss: 0.804 Vali Loss: 2.667 Vali Acc: 0.327 Test Loss: 2.667 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.8167169094085693
Epoch: 22, Steps: 17 | Train Loss: 0.938 Vali Loss: 2.824 Vali Acc: 0.278 Test Loss: 2.824 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7518744468688965
Epoch: 23, Steps: 17 | Train Loss: 0.870 Vali Loss: 2.380 Vali Acc: 0.327 Test Loss: 2.380 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8027236461639404
Epoch: 24, Steps: 17 | Train Loss: 0.656 Vali Loss: 2.192 Vali Acc: 0.338 Test Loss: 2.192 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6837248802185059
Epoch: 25, Steps: 17 | Train Loss: 0.665 Vali Loss: 3.581 Vali Acc: 0.308 Test Loss: 3.581 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5512075424194336
Epoch: 26, Steps: 17 | Train Loss: 1.075 Vali Loss: 2.639 Vali Acc: 0.361 Test Loss: 2.639 Test Acc: 0.361
Validation loss decreased (-0.357394 --> -0.361190).  Saving model ...
Epoch: 27 cost time: 1.5600271224975586
Epoch: 27, Steps: 17 | Train Loss: 0.718 Vali Loss: 2.636 Vali Acc: 0.293 Test Loss: 2.636 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.566702127456665
Epoch: 28, Steps: 17 | Train Loss: 0.470 Vali Loss: 2.660 Vali Acc: 0.316 Test Loss: 2.660 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6073932647705078
Epoch: 29, Steps: 17 | Train Loss: 0.447 Vali Loss: 3.232 Vali Acc: 0.316 Test Loss: 3.232 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.621950387954712
Epoch: 30, Steps: 17 | Train Loss: 0.502 Vali Loss: 2.948 Vali Acc: 0.338 Test Loss: 2.948 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.9012627601623535
Epoch: 31, Steps: 17 | Train Loss: 0.538 Vali Loss: 4.499 Vali Acc: 0.300 Test Loss: 4.499 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.710747480392456
Epoch: 32, Steps: 17 | Train Loss: 1.212 Vali Loss: 3.679 Vali Acc: 0.342 Test Loss: 3.679 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6457288265228271
Epoch: 33, Steps: 17 | Train Loss: 0.546 Vali Loss: 3.291 Vali Acc: 0.331 Test Loss: 3.291 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5544555187225342
Epoch: 34, Steps: 17 | Train Loss: 0.362 Vali Loss: 3.743 Vali Acc: 0.300 Test Loss: 3.743 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.8681704998016357
Epoch: 35, Steps: 17 | Train Loss: 0.316 Vali Loss: 3.332 Vali Acc: 0.323 Test Loss: 3.332 Test Acc: 0.323
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.6360995769500732
Epoch: 36, Steps: 17 | Train Loss: 0.251 Vali Loss: 4.289 Vali Acc: 0.289 Test Loss: 4.289 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3612167300380228
model parameter : 1317404
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5417184829711914
Epoch: 1, Steps: 17 | Train Loss: 1.609 Vali Loss: 1.932 Vali Acc: 0.262 Test Loss: 1.932 Test Acc: 0.262
Validation loss decreased (inf --> -0.262338).  Saving model ...
Epoch: 2 cost time: 1.8877124786376953
Epoch: 2, Steps: 17 | Train Loss: 1.721 Vali Loss: 2.075 Vali Acc: 0.251 Test Loss: 2.075 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3589248657226562
Epoch: 3, Steps: 17 | Train Loss: 1.561 Vali Loss: 2.457 Vali Acc: 0.251 Test Loss: 2.457 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3880462646484375
Epoch: 4, Steps: 17 | Train Loss: 1.869 Vali Loss: 2.084 Vali Acc: 0.259 Test Loss: 2.084 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6211085319519043
Epoch: 5, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.883 Vali Acc: 0.251 Test Loss: 1.883 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5433881282806396
Epoch: 6, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.753 Vali Acc: 0.289 Test Loss: 1.753 Test Acc: 0.289
Validation loss decreased (-0.262338 --> -0.288956).  Saving model ...
Epoch: 7 cost time: 1.7093300819396973
Epoch: 7, Steps: 17 | Train Loss: 1.400 Vali Loss: 2.155 Vali Acc: 0.255 Test Loss: 2.155 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.671734094619751
Epoch: 8, Steps: 17 | Train Loss: 1.755 Vali Loss: 2.085 Vali Acc: 0.247 Test Loss: 2.085 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3239638805389404
Epoch: 9, Steps: 17 | Train Loss: 1.373 Vali Loss: 2.885 Vali Acc: 0.278 Test Loss: 2.885 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6852548122406006
Epoch: 10, Steps: 17 | Train Loss: 1.857 Vali Loss: 2.967 Vali Acc: 0.255 Test Loss: 2.967 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.7039284706115723
Epoch: 11, Steps: 17 | Train Loss: 1.327 Vali Loss: 2.940 Vali Acc: 0.243 Test Loss: 2.940 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.336568832397461
Epoch: 12, Steps: 17 | Train Loss: 1.329 Vali Loss: 2.014 Vali Acc: 0.270 Test Loss: 2.014 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.694493055343628
Epoch: 13, Steps: 17 | Train Loss: 1.198 Vali Loss: 2.039 Vali Acc: 0.300 Test Loss: 2.039 Test Acc: 0.300
Validation loss decreased (-0.288956 --> -0.300360).  Saving model ...
Epoch: 14 cost time: 1.6313061714172363
Epoch: 14, Steps: 17 | Train Loss: 1.068 Vali Loss: 2.358 Vali Acc: 0.278 Test Loss: 2.358 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5768780708312988
Epoch: 15, Steps: 17 | Train Loss: 1.422 Vali Loss: 2.575 Vali Acc: 0.281 Test Loss: 2.575 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6867070198059082
Epoch: 16, Steps: 17 | Train Loss: 0.901 Vali Loss: 2.557 Vali Acc: 0.289 Test Loss: 2.557 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6229941844940186
Epoch: 17, Steps: 17 | Train Loss: 1.071 Vali Loss: 2.458 Vali Acc: 0.281 Test Loss: 2.458 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6034159660339355
Epoch: 18, Steps: 17 | Train Loss: 0.820 Vali Loss: 2.847 Vali Acc: 0.319 Test Loss: 2.847 Test Acc: 0.319
Validation loss decreased (-0.300360 --> -0.319363).  Saving model ...
Epoch: 19 cost time: 1.6345415115356445
Epoch: 19, Steps: 17 | Train Loss: 1.137 Vali Loss: 3.220 Vali Acc: 0.327 Test Loss: 3.220 Test Acc: 0.327
Validation loss decreased (-0.319363 --> -0.326964).  Saving model ...
Epoch: 20 cost time: 1.644486427307129
Epoch: 20, Steps: 17 | Train Loss: 0.859 Vali Loss: 2.454 Vali Acc: 0.338 Test Loss: 2.454 Test Acc: 0.338
Validation loss decreased (-0.326964 --> -0.338379).  Saving model ...
Epoch: 21 cost time: 1.4570636749267578
Epoch: 21, Steps: 17 | Train Loss: 1.218 Vali Loss: 2.600 Vali Acc: 0.312 Test Loss: 2.600 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.587306261062622
Epoch: 22, Steps: 17 | Train Loss: 0.834 Vali Loss: 2.543 Vali Acc: 0.335 Test Loss: 2.543 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.8779237270355225
Epoch: 23, Steps: 17 | Train Loss: 0.741 Vali Loss: 2.980 Vali Acc: 0.319 Test Loss: 2.980 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.67179536819458
Epoch: 24, Steps: 17 | Train Loss: 0.908 Vali Loss: 2.973 Vali Acc: 0.319 Test Loss: 2.973 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7487218379974365
Epoch: 25, Steps: 17 | Train Loss: 1.048 Vali Loss: 3.280 Vali Acc: 0.285 Test Loss: 3.280 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.52386474609375
Epoch: 26, Steps: 17 | Train Loss: 0.835 Vali Loss: 3.195 Vali Acc: 0.289 Test Loss: 3.195 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.2900094985961914
Epoch: 27, Steps: 17 | Train Loss: 0.562 Vali Loss: 2.607 Vali Acc: 0.323 Test Loss: 2.607 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5915966033935547
Epoch: 28, Steps: 17 | Train Loss: 0.598 Vali Loss: 2.956 Vali Acc: 0.331 Test Loss: 2.956 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6962080001831055
Epoch: 29, Steps: 17 | Train Loss: 0.657 Vali Loss: 3.371 Vali Acc: 0.308 Test Loss: 3.371 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.711777687072754
Epoch: 30, Steps: 17 | Train Loss: 0.600 Vali Loss: 3.314 Vali Acc: 0.327 Test Loss: 3.314 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33840304182509506
model parameter : 1298716
model size : 7.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.445918083190918
Epoch: 1, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.593 Vali Acc: 0.255 Test Loss: 1.593 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 1.9541711807250977
Epoch: 2, Steps: 17 | Train Loss: 1.697 Vali Loss: 1.530 Vali Acc: 0.243 Test Loss: 1.530 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.938445806503296
Epoch: 3, Steps: 17 | Train Loss: 1.671 Vali Loss: 1.883 Vali Acc: 0.243 Test Loss: 1.883 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.8843355178833008
Epoch: 4, Steps: 17 | Train Loss: 1.519 Vali Loss: 2.440 Vali Acc: 0.259 Test Loss: 2.440 Test Acc: 0.259
Validation loss decreased (-0.254737 --> -0.258531).  Saving model ...
Epoch: 5 cost time: 1.8972678184509277
Epoch: 5, Steps: 17 | Train Loss: 2.080 Vali Loss: 2.365 Vali Acc: 0.251 Test Loss: 2.365 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8385064601898193
Epoch: 6, Steps: 17 | Train Loss: 2.256 Vali Loss: 2.644 Vali Acc: 0.266 Test Loss: 2.644 Test Acc: 0.266
Validation loss decreased (-0.258531 --> -0.266133).  Saving model ...
Epoch: 7 cost time: 1.7139301300048828
Epoch: 7, Steps: 17 | Train Loss: 1.795 Vali Loss: 1.986 Vali Acc: 0.274 Test Loss: 1.986 Test Acc: 0.274
Validation loss decreased (-0.266133 --> -0.273744).  Saving model ...
Epoch: 8 cost time: 1.727280855178833
Epoch: 8, Steps: 17 | Train Loss: 1.622 Vali Loss: 2.329 Vali Acc: 0.243 Test Loss: 2.329 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9008939266204834
Epoch: 9, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.957 Vali Acc: 0.259 Test Loss: 1.957 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.8057150840759277
Epoch: 10, Steps: 17 | Train Loss: 1.533 Vali Loss: 2.380 Vali Acc: 0.262 Test Loss: 2.380 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.8505072593688965
Epoch: 11, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.935 Vali Acc: 0.300 Test Loss: 1.935 Test Acc: 0.300
Validation loss decreased (-0.273744 --> -0.300361).  Saving model ...
Epoch: 12 cost time: 1.9226109981536865
Epoch: 12, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.902 Vali Acc: 0.285 Test Loss: 1.902 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.815882682800293
Epoch: 13, Steps: 17 | Train Loss: 1.267 Vali Loss: 1.952 Vali Acc: 0.308 Test Loss: 1.952 Test Acc: 0.308
Validation loss decreased (-0.300361 --> -0.307965).  Saving model ...
Epoch: 14 cost time: 1.9654252529144287
Epoch: 14, Steps: 17 | Train Loss: 1.139 Vali Loss: 2.129 Vali Acc: 0.293 Test Loss: 2.129 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8960070610046387
Epoch: 15, Steps: 17 | Train Loss: 1.287 Vali Loss: 2.585 Vali Acc: 0.319 Test Loss: 2.585 Test Acc: 0.319
Validation loss decreased (-0.307965 --> -0.319366).  Saving model ...
Epoch: 16 cost time: 1.8115646839141846
Epoch: 16, Steps: 17 | Train Loss: 1.359 Vali Loss: 2.166 Vali Acc: 0.319 Test Loss: 2.166 Test Acc: 0.319
Validation loss decreased (-0.319366 --> -0.319370).  Saving model ...
Epoch: 17 cost time: 1.6749520301818848
Epoch: 17, Steps: 17 | Train Loss: 1.092 Vali Loss: 2.291 Vali Acc: 0.297 Test Loss: 2.291 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7662088871002197
Epoch: 18, Steps: 17 | Train Loss: 1.408 Vali Loss: 2.432 Vali Acc: 0.270 Test Loss: 2.432 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8464195728302002
Epoch: 19, Steps: 17 | Train Loss: 1.232 Vali Loss: 3.501 Vali Acc: 0.281 Test Loss: 3.501 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.99615478515625
Epoch: 20, Steps: 17 | Train Loss: 1.321 Vali Loss: 2.517 Vali Acc: 0.297 Test Loss: 2.517 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8554356098175049
Epoch: 21, Steps: 17 | Train Loss: 0.892 Vali Loss: 2.458 Vali Acc: 0.361 Test Loss: 2.458 Test Acc: 0.361
Validation loss decreased (-0.319370 --> -0.361192).  Saving model ...
Epoch: 22 cost time: 1.7969636917114258
Epoch: 22, Steps: 17 | Train Loss: 0.807 Vali Loss: 2.667 Vali Acc: 0.338 Test Loss: 2.667 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9041082859039307
Epoch: 23, Steps: 17 | Train Loss: 1.020 Vali Loss: 2.611 Vali Acc: 0.319 Test Loss: 2.611 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.9621217250823975
Epoch: 24, Steps: 17 | Train Loss: 0.739 Vali Loss: 2.460 Vali Acc: 0.338 Test Loss: 2.460 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.910628318786621
Epoch: 25, Steps: 17 | Train Loss: 0.771 Vali Loss: 2.450 Vali Acc: 0.361 Test Loss: 2.450 Test Acc: 0.361
Validation loss decreased (-0.361192 --> -0.361192).  Saving model ...
Epoch: 26 cost time: 1.5892226696014404
Epoch: 26, Steps: 17 | Train Loss: 0.776 Vali Loss: 3.204 Vali Acc: 0.331 Test Loss: 3.204 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7270317077636719
Epoch: 27, Steps: 17 | Train Loss: 0.902 Vali Loss: 2.958 Vali Acc: 0.297 Test Loss: 2.958 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.724022626876831
Epoch: 28, Steps: 17 | Train Loss: 0.789 Vali Loss: 3.123 Vali Acc: 0.346 Test Loss: 3.123 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.8823328018188477
Epoch: 29, Steps: 17 | Train Loss: 0.768 Vali Loss: 2.740 Vali Acc: 0.327 Test Loss: 2.740 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.8767178058624268
Epoch: 30, Steps: 17 | Train Loss: 0.570 Vali Loss: 3.578 Vali Acc: 0.316 Test Loss: 3.578 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.8528037071228027
Epoch: 31, Steps: 17 | Train Loss: 0.657 Vali Loss: 3.662 Vali Acc: 0.319 Test Loss: 3.662 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.7677891254425049
Epoch: 32, Steps: 17 | Train Loss: 0.589 Vali Loss: 3.726 Vali Acc: 0.300 Test Loss: 3.726 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.9003281593322754
Epoch: 33, Steps: 17 | Train Loss: 0.561 Vali Loss: 3.500 Vali Acc: 0.308 Test Loss: 3.500 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.808659553527832
Epoch: 34, Steps: 17 | Train Loss: 0.472 Vali Loss: 3.073 Vali Acc: 0.335 Test Loss: 3.073 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.8876535892486572
Epoch: 35, Steps: 17 | Train Loss: 0.469 Vali Loss: 3.394 Vali Acc: 0.342 Test Loss: 3.394 Test Acc: 0.342
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3612167300380228
model parameter : 1256092
model size : 7.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.114682197570801
Epoch: 1, Steps: 17 | Train Loss: 1.601 Vali Loss: 1.725 Vali Acc: 0.259 Test Loss: 1.725 Test Acc: 0.259
Validation loss decreased (inf --> -0.258538).  Saving model ...
Epoch: 2 cost time: 1.7677574157714844
Epoch: 2, Steps: 17 | Train Loss: 1.634 Vali Loss: 1.634 Vali Acc: 0.281 Test Loss: 1.634 Test Acc: 0.281
Validation loss decreased (-0.258538 --> -0.281352).  Saving model ...
Epoch: 3 cost time: 1.5400676727294922
Epoch: 3, Steps: 17 | Train Loss: 1.756 Vali Loss: 2.289 Vali Acc: 0.247 Test Loss: 2.289 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.925117015838623
Epoch: 4, Steps: 17 | Train Loss: 1.797 Vali Loss: 1.683 Vali Acc: 0.259 Test Loss: 1.683 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7114248275756836
Epoch: 5, Steps: 17 | Train Loss: 1.750 Vali Loss: 1.511 Vali Acc: 0.281 Test Loss: 1.511 Test Acc: 0.281
Validation loss decreased (-0.281352 --> -0.281354).  Saving model ...
Epoch: 6 cost time: 1.8763113021850586
Epoch: 6, Steps: 17 | Train Loss: 1.968 Vali Loss: 3.129 Vali Acc: 0.243 Test Loss: 3.129 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4791834354400635
Epoch: 7, Steps: 17 | Train Loss: 2.453 Vali Loss: 2.126 Vali Acc: 0.262 Test Loss: 2.126 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7542388439178467
Epoch: 8, Steps: 17 | Train Loss: 2.016 Vali Loss: 2.013 Vali Acc: 0.240 Test Loss: 2.013 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.8125009536743164
Epoch: 9, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.819 Vali Acc: 0.323 Test Loss: 1.819 Test Acc: 0.323
Validation loss decreased (-0.281354 --> -0.323176).  Saving model ...
Epoch: 10 cost time: 1.4777538776397705
Epoch: 10, Steps: 17 | Train Loss: 1.386 Vali Loss: 2.337 Vali Acc: 0.270 Test Loss: 2.337 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8872992992401123
Epoch: 11, Steps: 17 | Train Loss: 1.514 Vali Loss: 2.919 Vali Acc: 0.274 Test Loss: 2.919 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8730640411376953
Epoch: 12, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.982 Vali Acc: 0.262 Test Loss: 1.982 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4872500896453857
Epoch: 13, Steps: 17 | Train Loss: 1.298 Vali Loss: 1.828 Vali Acc: 0.297 Test Loss: 1.828 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7669601440429688
Epoch: 14, Steps: 17 | Train Loss: 1.273 Vali Loss: 2.015 Vali Acc: 0.308 Test Loss: 2.015 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7754747867584229
Epoch: 15, Steps: 17 | Train Loss: 1.247 Vali Loss: 2.197 Vali Acc: 0.350 Test Loss: 2.197 Test Acc: 0.350
Validation loss decreased (-0.323176 --> -0.349788).  Saving model ...
Epoch: 16 cost time: 1.8921589851379395
Epoch: 16, Steps: 17 | Train Loss: 1.159 Vali Loss: 2.005 Vali Acc: 0.304 Test Loss: 2.005 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.840528964996338
Epoch: 17, Steps: 17 | Train Loss: 1.038 Vali Loss: 2.230 Vali Acc: 0.297 Test Loss: 2.230 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.760460615158081
Epoch: 18, Steps: 17 | Train Loss: 0.858 Vali Loss: 2.438 Vali Acc: 0.312 Test Loss: 2.438 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9749526977539062
Epoch: 19, Steps: 17 | Train Loss: 1.241 Vali Loss: 2.176 Vali Acc: 0.312 Test Loss: 2.176 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6465823650360107
Epoch: 20, Steps: 17 | Train Loss: 1.074 Vali Loss: 2.725 Vali Acc: 0.346 Test Loss: 2.725 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8254706859588623
Epoch: 21, Steps: 17 | Train Loss: 0.979 Vali Loss: 2.402 Vali Acc: 0.331 Test Loss: 2.402 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8186359405517578
Epoch: 22, Steps: 17 | Train Loss: 1.073 Vali Loss: 2.767 Vali Acc: 0.304 Test Loss: 2.767 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.7094945907592773
Epoch: 23, Steps: 17 | Train Loss: 0.956 Vali Loss: 2.400 Vali Acc: 0.293 Test Loss: 2.400 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.6620147228240967
Epoch: 24, Steps: 17 | Train Loss: 0.809 Vali Loss: 2.670 Vali Acc: 0.327 Test Loss: 2.670 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3445172309875488
Epoch: 25, Steps: 17 | Train Loss: 0.802 Vali Loss: 3.401 Vali Acc: 0.289 Test Loss: 3.401 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34980988593155893
model parameter : 1237404
model size : 7.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.750838279724121
Epoch: 1, Steps: 17 | Train Loss: 1.547 Vali Loss: 1.456 Vali Acc: 0.281 Test Loss: 1.456 Test Acc: 0.281
Validation loss decreased (inf --> -0.281354).  Saving model ...
Epoch: 2 cost time: 1.7199580669403076
Epoch: 2, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.962 Vali Acc: 0.262 Test Loss: 1.962 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.778385877609253
Epoch: 3, Steps: 17 | Train Loss: 1.770 Vali Loss: 1.536 Vali Acc: 0.278 Test Loss: 1.536 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.765690803527832
Epoch: 4, Steps: 17 | Train Loss: 1.747 Vali Loss: 2.771 Vali Acc: 0.247 Test Loss: 2.771 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7046821117401123
Epoch: 5, Steps: 17 | Train Loss: 2.468 Vali Loss: 1.571 Vali Acc: 0.289 Test Loss: 1.571 Test Acc: 0.289
Validation loss decreased (-0.281354 --> -0.288958).  Saving model ...
Epoch: 6 cost time: 1.621633768081665
Epoch: 6, Steps: 17 | Train Loss: 1.744 Vali Loss: 3.094 Vali Acc: 0.236 Test Loss: 3.094 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6890840530395508
Epoch: 7, Steps: 17 | Train Loss: 1.757 Vali Loss: 1.579 Vali Acc: 0.270 Test Loss: 1.579 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6876842975616455
Epoch: 8, Steps: 17 | Train Loss: 1.597 Vali Loss: 1.637 Vali Acc: 0.327 Test Loss: 1.637 Test Acc: 0.327
Validation loss decreased (-0.288958 --> -0.326980).  Saving model ...
Epoch: 9 cost time: 1.7894973754882812
Epoch: 9, Steps: 17 | Train Loss: 1.692 Vali Loss: 2.996 Vali Acc: 0.247 Test Loss: 2.996 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6591002941131592
Epoch: 10, Steps: 17 | Train Loss: 1.859 Vali Loss: 2.110 Vali Acc: 0.289 Test Loss: 2.110 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6399428844451904
Epoch: 11, Steps: 17 | Train Loss: 1.668 Vali Loss: 2.660 Vali Acc: 0.270 Test Loss: 2.660 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.780371904373169
Epoch: 12, Steps: 17 | Train Loss: 1.487 Vali Loss: 4.273 Vali Acc: 0.240 Test Loss: 4.273 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.690974235534668
Epoch: 13, Steps: 17 | Train Loss: 2.313 Vali Loss: 3.403 Vali Acc: 0.255 Test Loss: 3.403 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3471040725708008
Epoch: 14, Steps: 17 | Train Loss: 1.297 Vali Loss: 2.013 Vali Acc: 0.327 Test Loss: 2.013 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5821044445037842
Epoch: 15, Steps: 17 | Train Loss: 1.414 Vali Loss: 2.111 Vali Acc: 0.308 Test Loss: 2.111 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7548613548278809
Epoch: 16, Steps: 17 | Train Loss: 1.169 Vali Loss: 2.039 Vali Acc: 0.316 Test Loss: 2.039 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.6834142208099365
Epoch: 17, Steps: 17 | Train Loss: 1.168 Vali Loss: 2.263 Vali Acc: 0.316 Test Loss: 2.263 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.5529825687408447
Epoch: 18, Steps: 17 | Train Loss: 1.269 Vali Loss: 2.707 Vali Acc: 0.289 Test Loss: 2.707 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3269961977186312
model parameter : 1218716
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3905434608459473
Epoch: 1, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.714 Vali Acc: 0.285 Test Loss: 1.714 Test Acc: 0.285
Validation loss decreased (inf --> -0.285154).  Saving model ...
Epoch: 2 cost time: 1.7477128505706787
Epoch: 2, Steps: 17 | Train Loss: 1.914 Vali Loss: 2.863 Vali Acc: 0.255 Test Loss: 2.863 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.726353406906128
Epoch: 3, Steps: 17 | Train Loss: 2.241 Vali Loss: 2.188 Vali Acc: 0.255 Test Loss: 2.188 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.815044641494751
Epoch: 4, Steps: 17 | Train Loss: 2.134 Vali Loss: 1.936 Vali Acc: 0.262 Test Loss: 1.936 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8161077499389648
Epoch: 5, Steps: 17 | Train Loss: 1.653 Vali Loss: 3.475 Vali Acc: 0.251 Test Loss: 3.475 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.7701451778411865
Epoch: 6, Steps: 17 | Train Loss: 2.105 Vali Loss: 2.821 Vali Acc: 0.251 Test Loss: 2.821 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.7340795993804932
Epoch: 7, Steps: 17 | Train Loss: 2.174 Vali Loss: 2.386 Vali Acc: 0.266 Test Loss: 2.386 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7878661155700684
Epoch: 8, Steps: 17 | Train Loss: 1.691 Vali Loss: 1.865 Vali Acc: 0.270 Test Loss: 1.865 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.770555019378662
Epoch: 9, Steps: 17 | Train Loss: 1.405 Vali Loss: 2.062 Vali Acc: 0.304 Test Loss: 2.062 Test Acc: 0.304
Validation loss decreased (-0.285154 --> -0.304162).  Saving model ...
Epoch: 10 cost time: 1.774456262588501
Epoch: 10, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.870 Vali Acc: 0.278 Test Loss: 1.870 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.821134328842163
Epoch: 11, Steps: 17 | Train Loss: 1.378 Vali Loss: 2.186 Vali Acc: 0.274 Test Loss: 2.186 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8315517902374268
Epoch: 12, Steps: 17 | Train Loss: 1.378 Vali Loss: 3.088 Vali Acc: 0.262 Test Loss: 3.088 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.6566226482391357
Epoch: 13, Steps: 17 | Train Loss: 2.057 Vali Loss: 2.038 Vali Acc: 0.281 Test Loss: 2.038 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6857993602752686
Epoch: 14, Steps: 17 | Train Loss: 1.101 Vali Loss: 2.146 Vali Acc: 0.285 Test Loss: 2.146 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.7764301300048828
Epoch: 15, Steps: 17 | Train Loss: 1.199 Vali Loss: 2.770 Vali Acc: 0.278 Test Loss: 2.770 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.6227104663848877
Epoch: 16, Steps: 17 | Train Loss: 1.037 Vali Loss: 2.125 Vali Acc: 0.304 Test Loss: 2.125 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6867287158966064
Epoch: 17, Steps: 17 | Train Loss: 0.976 Vali Loss: 2.865 Vali Acc: 0.312 Test Loss: 2.865 Test Acc: 0.312
Validation loss decreased (-0.304162 --> -0.311758).  Saving model ...
Epoch: 18 cost time: 1.6656744480133057
Epoch: 18, Steps: 17 | Train Loss: 1.115 Vali Loss: 2.332 Vali Acc: 0.285 Test Loss: 2.332 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5487442016601562
Epoch: 19, Steps: 17 | Train Loss: 0.918 Vali Loss: 2.653 Vali Acc: 0.289 Test Loss: 2.653 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6649022102355957
Epoch: 20, Steps: 17 | Train Loss: 1.007 Vali Loss: 2.869 Vali Acc: 0.304 Test Loss: 2.869 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.6181278228759766
Epoch: 21, Steps: 17 | Train Loss: 0.845 Vali Loss: 2.483 Vali Acc: 0.300 Test Loss: 2.483 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8373878002166748
Epoch: 22, Steps: 17 | Train Loss: 0.709 Vali Loss: 2.371 Vali Acc: 0.319 Test Loss: 2.371 Test Acc: 0.319
Validation loss decreased (-0.311758 --> -0.319368).  Saving model ...
Epoch: 23 cost time: 1.7690353393554688
Epoch: 23, Steps: 17 | Train Loss: 0.641 Vali Loss: 2.359 Vali Acc: 0.327 Test Loss: 2.359 Test Acc: 0.327
Validation loss decreased (-0.319368 --> -0.326973).  Saving model ...
Epoch: 24 cost time: 1.6458284854888916
Epoch: 24, Steps: 17 | Train Loss: 0.730 Vali Loss: 3.277 Vali Acc: 0.319 Test Loss: 3.277 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.6043357849121094
Epoch: 25, Steps: 17 | Train Loss: 0.824 Vali Loss: 2.687 Vali Acc: 0.327 Test Loss: 2.687 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.774989128112793
Epoch: 26, Steps: 17 | Train Loss: 0.538 Vali Loss: 3.602 Vali Acc: 0.304 Test Loss: 3.602 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6701080799102783
Epoch: 27, Steps: 17 | Train Loss: 0.650 Vali Loss: 3.298 Vali Acc: 0.316 Test Loss: 3.298 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7857348918914795
Epoch: 28, Steps: 17 | Train Loss: 0.663 Vali Loss: 3.321 Vali Acc: 0.335 Test Loss: 3.321 Test Acc: 0.335
Validation loss decreased (-0.326973 --> -0.334568).  Saving model ...
Epoch: 29 cost time: 1.7765254974365234
Epoch: 29, Steps: 17 | Train Loss: 0.472 Vali Loss: 3.266 Vali Acc: 0.361 Test Loss: 3.266 Test Acc: 0.361
Validation loss decreased (-0.334568 --> -0.361184).  Saving model ...
Epoch: 30 cost time: 1.55659818649292
Epoch: 30, Steps: 17 | Train Loss: 0.576 Vali Loss: 2.970 Vali Acc: 0.346 Test Loss: 2.970 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7965130805969238
Epoch: 31, Steps: 17 | Train Loss: 0.456 Vali Loss: 3.653 Vali Acc: 0.342 Test Loss: 3.653 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.806746482849121
Epoch: 32, Steps: 17 | Train Loss: 0.595 Vali Loss: 3.459 Vali Acc: 0.365 Test Loss: 3.459 Test Acc: 0.365
Validation loss decreased (-0.361184 --> -0.364984).  Saving model ...
Epoch: 33 cost time: 1.7953472137451172
Epoch: 33, Steps: 17 | Train Loss: 0.327 Vali Loss: 3.670 Vali Acc: 0.365 Test Loss: 3.670 Test Acc: 0.365
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.474902629852295
Epoch: 34, Steps: 17 | Train Loss: 0.447 Vali Loss: 3.788 Vali Acc: 0.323 Test Loss: 3.788 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7626595497131348
Epoch: 35, Steps: 17 | Train Loss: 0.275 Vali Loss: 4.006 Vali Acc: 0.327 Test Loss: 4.006 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.6724867820739746
Epoch: 36, Steps: 17 | Train Loss: 0.192 Vali Loss: 4.109 Vali Acc: 0.350 Test Loss: 4.109 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.7414042949676514
Epoch: 37, Steps: 17 | Train Loss: 0.312 Vali Loss: 4.458 Vali Acc: 0.312 Test Loss: 4.458 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.779597520828247
Epoch: 38, Steps: 17 | Train Loss: 0.351 Vali Loss: 4.450 Vali Acc: 0.312 Test Loss: 4.450 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.7347841262817383
Epoch: 39, Steps: 17 | Train Loss: 0.330 Vali Loss: 4.840 Vali Acc: 0.323 Test Loss: 4.840 Test Acc: 0.323
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.793609619140625
Epoch: 40, Steps: 17 | Train Loss: 0.278 Vali Loss: 4.384 Vali Acc: 0.331 Test Loss: 4.384 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.7213139533996582
Epoch: 41, Steps: 17 | Train Loss: 0.237 Vali Loss: 4.858 Vali Acc: 0.323 Test Loss: 4.858 Test Acc: 0.323
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.7394969463348389
Epoch: 42, Steps: 17 | Train Loss: 0.267 Vali Loss: 4.905 Vali Acc: 0.350 Test Loss: 4.905 Test Acc: 0.350
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3650190114068441
model parameter : 1200028
model size : 7.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2238450050354004
Epoch: 1, Steps: 17 | Train Loss: 1.483 Vali Loss: 1.475 Vali Acc: 0.243 Test Loss: 1.475 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 1.732841968536377
Epoch: 2, Steps: 17 | Train Loss: 1.542 Vali Loss: 1.589 Vali Acc: 0.266 Test Loss: 1.589 Test Acc: 0.266
Validation loss decreased (-0.243331 --> -0.266144).  Saving model ...
Epoch: 3 cost time: 1.4686477184295654
Epoch: 3, Steps: 17 | Train Loss: 1.522 Vali Loss: 1.509 Vali Acc: 0.278 Test Loss: 1.509 Test Acc: 0.278
Validation loss decreased (-0.266144 --> -0.277551).  Saving model ...
Epoch: 4 cost time: 1.7082850933074951
Epoch: 4, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.526 Vali Acc: 0.259 Test Loss: 1.526 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.342977523803711
Epoch: 5, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.653 Vali Acc: 0.251 Test Loss: 1.653 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.49029541015625
Epoch: 6, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.650 Vali Acc: 0.274 Test Loss: 1.650 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6821322441101074
Epoch: 7, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.646 Vali Acc: 0.281 Test Loss: 1.646 Test Acc: 0.281
Validation loss decreased (-0.277551 --> -0.281352).  Saving model ...
Epoch: 8 cost time: 1.563558578491211
Epoch: 8, Steps: 17 | Train Loss: 1.361 Vali Loss: 2.139 Vali Acc: 0.243 Test Loss: 2.139 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6307387351989746
Epoch: 9, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.769 Vali Acc: 0.293 Test Loss: 1.769 Test Acc: 0.293
Validation loss decreased (-0.281352 --> -0.292758).  Saving model ...
Epoch: 10 cost time: 1.6795964241027832
Epoch: 10, Steps: 17 | Train Loss: 1.316 Vali Loss: 1.760 Vali Acc: 0.266 Test Loss: 1.760 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6480815410614014
Epoch: 11, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.931 Vali Acc: 0.259 Test Loss: 1.931 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4606482982635498
Epoch: 12, Steps: 17 | Train Loss: 1.107 Vali Loss: 2.404 Vali Acc: 0.247 Test Loss: 2.404 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5616185665130615
Epoch: 13, Steps: 17 | Train Loss: 1.304 Vali Loss: 2.040 Vali Acc: 0.300 Test Loss: 2.040 Test Acc: 0.300
Validation loss decreased (-0.292758 --> -0.300360).  Saving model ...
Epoch: 14 cost time: 1.5129024982452393
Epoch: 14, Steps: 17 | Train Loss: 1.243 Vali Loss: 2.320 Vali Acc: 0.243 Test Loss: 2.320 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7064270973205566
Epoch: 15, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.895 Vali Acc: 0.274 Test Loss: 1.895 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3462951183319092
Epoch: 16, Steps: 17 | Train Loss: 0.985 Vali Loss: 2.468 Vali Acc: 0.266 Test Loss: 2.468 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5201950073242188
Epoch: 17, Steps: 17 | Train Loss: 1.133 Vali Loss: 2.765 Vali Acc: 0.297 Test Loss: 2.765 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.542717456817627
Epoch: 18, Steps: 17 | Train Loss: 0.896 Vali Loss: 2.274 Vali Acc: 0.312 Test Loss: 2.274 Test Acc: 0.312
Validation loss decreased (-0.300360 --> -0.311764).  Saving model ...
Epoch: 19 cost time: 1.5065572261810303
Epoch: 19, Steps: 17 | Train Loss: 0.866 Vali Loss: 2.357 Vali Acc: 0.293 Test Loss: 2.357 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5553290843963623
Epoch: 20, Steps: 17 | Train Loss: 0.992 Vali Loss: 2.183 Vali Acc: 0.316 Test Loss: 2.183 Test Acc: 0.316
Validation loss decreased (-0.311764 --> -0.315568).  Saving model ...
Epoch: 21 cost time: 1.4438862800598145
Epoch: 21, Steps: 17 | Train Loss: 0.848 Vali Loss: 2.687 Vali Acc: 0.270 Test Loss: 2.687 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3160650730133057
Epoch: 22, Steps: 17 | Train Loss: 0.820 Vali Loss: 2.188 Vali Acc: 0.312 Test Loss: 2.188 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.946573257446289
Epoch: 23, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.650 Vali Acc: 0.289 Test Loss: 2.650 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7077243328094482
Epoch: 24, Steps: 17 | Train Loss: 0.619 Vali Loss: 2.512 Vali Acc: 0.289 Test Loss: 2.512 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.6917736530303955
Epoch: 25, Steps: 17 | Train Loss: 0.710 Vali Loss: 2.316 Vali Acc: 0.350 Test Loss: 2.316 Test Acc: 0.350
Validation loss decreased (-0.315568 --> -0.349787).  Saving model ...
Epoch: 26 cost time: 1.3939127922058105
Epoch: 26, Steps: 17 | Train Loss: 0.587 Vali Loss: 2.572 Vali Acc: 0.342 Test Loss: 2.572 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.020763397216797
Epoch: 27, Steps: 17 | Train Loss: 0.615 Vali Loss: 2.866 Vali Acc: 0.304 Test Loss: 2.866 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.9356040954589844
Epoch: 28, Steps: 17 | Train Loss: 0.598 Vali Loss: 2.425 Vali Acc: 0.331 Test Loss: 2.425 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.382460594177246
Epoch: 29, Steps: 17 | Train Loss: 0.480 Vali Loss: 2.725 Vali Acc: 0.323 Test Loss: 2.725 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.5027556419372559
Epoch: 30, Steps: 17 | Train Loss: 0.467 Vali Loss: 2.857 Vali Acc: 0.323 Test Loss: 2.857 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3985722064971924
Epoch: 31, Steps: 17 | Train Loss: 0.509 Vali Loss: 3.116 Vali Acc: 0.338 Test Loss: 3.116 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.407496452331543
Epoch: 32, Steps: 17 | Train Loss: 0.464 Vali Loss: 3.045 Vali Acc: 0.304 Test Loss: 3.045 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.378849983215332
Epoch: 33, Steps: 17 | Train Loss: 0.412 Vali Loss: 3.006 Vali Acc: 0.331 Test Loss: 3.006 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.2997856140136719
Epoch: 34, Steps: 17 | Train Loss: 0.465 Vali Loss: 3.443 Vali Acc: 0.300 Test Loss: 3.443 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.3685660362243652
Epoch: 35, Steps: 17 | Train Loss: 0.469 Vali Loss: 3.092 Vali Acc: 0.308 Test Loss: 3.092 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34980988593155893
model parameter : 778396
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.415940999984741
Epoch: 1, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.455 Vali Acc: 0.240 Test Loss: 1.455 Test Acc: 0.240
Validation loss decreased (inf --> -0.239529).  Saving model ...
Epoch: 2 cost time: 1.4411444664001465
Epoch: 2, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.456 Vali Acc: 0.274 Test Loss: 1.456 Test Acc: 0.274
Validation loss decreased (-0.239529 --> -0.273750).  Saving model ...
Epoch: 3 cost time: 1.4869661331176758
Epoch: 3, Steps: 17 | Train Loss: 1.632 Vali Loss: 1.862 Vali Acc: 0.266 Test Loss: 1.862 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.761747121810913
Epoch: 4, Steps: 17 | Train Loss: 1.555 Vali Loss: 2.131 Vali Acc: 0.319 Test Loss: 2.131 Test Acc: 0.319
Validation loss decreased (-0.273750 --> -0.319370).  Saving model ...
Epoch: 5 cost time: 1.667102575302124
Epoch: 5, Steps: 17 | Train Loss: 1.666 Vali Loss: 1.596 Vali Acc: 0.251 Test Loss: 1.596 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5881547927856445
Epoch: 6, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.825 Vali Acc: 0.274 Test Loss: 1.825 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.678572416305542
Epoch: 7, Steps: 17 | Train Loss: 1.620 Vali Loss: 1.514 Vali Acc: 0.266 Test Loss: 1.514 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6686108112335205
Epoch: 8, Steps: 17 | Train Loss: 1.693 Vali Loss: 2.599 Vali Acc: 0.255 Test Loss: 2.599 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7070960998535156
Epoch: 9, Steps: 17 | Train Loss: 1.719 Vali Loss: 1.679 Vali Acc: 0.293 Test Loss: 1.679 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6096415519714355
Epoch: 10, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.960 Vali Acc: 0.266 Test Loss: 1.960 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6768887042999268
Epoch: 11, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.566 Vali Acc: 0.327 Test Loss: 1.566 Test Acc: 0.327
Validation loss decreased (-0.319370 --> -0.326981).  Saving model ...
Epoch: 12 cost time: 1.6576573848724365
Epoch: 12, Steps: 17 | Train Loss: 1.074 Vali Loss: 2.071 Vali Acc: 0.255 Test Loss: 2.071 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6653070449829102
Epoch: 13, Steps: 17 | Train Loss: 1.245 Vali Loss: 2.000 Vali Acc: 0.274 Test Loss: 2.000 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7943475246429443
Epoch: 14, Steps: 17 | Train Loss: 1.150 Vali Loss: 2.005 Vali Acc: 0.316 Test Loss: 2.005 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.6268713474273682
Epoch: 15, Steps: 17 | Train Loss: 1.287 Vali Loss: 2.117 Vali Acc: 0.281 Test Loss: 2.117 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6802423000335693
Epoch: 16, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.962 Vali Acc: 0.289 Test Loss: 1.962 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6404392719268799
Epoch: 17, Steps: 17 | Train Loss: 1.041 Vali Loss: 2.432 Vali Acc: 0.270 Test Loss: 2.432 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.7440130710601807
Epoch: 18, Steps: 17 | Train Loss: 1.118 Vali Loss: 2.393 Vali Acc: 0.289 Test Loss: 2.393 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.8531765937805176
Epoch: 19, Steps: 17 | Train Loss: 0.893 Vali Loss: 2.112 Vali Acc: 0.323 Test Loss: 2.112 Test Acc: 0.323
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6974561214447021
Epoch: 20, Steps: 17 | Train Loss: 0.818 Vali Loss: 2.185 Vali Acc: 0.285 Test Loss: 2.185 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.6708509922027588
Epoch: 21, Steps: 17 | Train Loss: 0.837 Vali Loss: 2.358 Vali Acc: 0.297 Test Loss: 2.358 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3269961977186312
model parameter : 769052
model size : 4.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.488307237625122
Epoch: 1, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.447 Vali Acc: 0.278 Test Loss: 1.447 Test Acc: 0.278
Validation loss decreased (inf --> -0.277552).  Saving model ...
Epoch: 2 cost time: 1.6184792518615723
Epoch: 2, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.781 Vali Acc: 0.270 Test Loss: 1.781 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4767746925354004
Epoch: 3, Steps: 17 | Train Loss: 1.682 Vali Loss: 1.620 Vali Acc: 0.255 Test Loss: 1.620 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4866576194763184
Epoch: 4, Steps: 17 | Train Loss: 1.605 Vali Loss: 1.744 Vali Acc: 0.259 Test Loss: 1.744 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5231785774230957
Epoch: 5, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.828 Vali Acc: 0.251 Test Loss: 1.828 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5921735763549805
Epoch: 6, Steps: 17 | Train Loss: 1.402 Vali Loss: 1.493 Vali Acc: 0.289 Test Loss: 1.493 Test Acc: 0.289
Validation loss decreased (-0.277552 --> -0.288958).  Saving model ...
Epoch: 7 cost time: 1.6318573951721191
Epoch: 7, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.880 Vali Acc: 0.255 Test Loss: 1.880 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4949243068695068
Epoch: 8, Steps: 17 | Train Loss: 1.210 Vali Loss: 1.637 Vali Acc: 0.270 Test Loss: 1.637 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.766836166381836
Epoch: 9, Steps: 17 | Train Loss: 1.230 Vali Loss: 2.031 Vali Acc: 0.266 Test Loss: 2.031 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6284966468811035
Epoch: 10, Steps: 17 | Train Loss: 1.259 Vali Loss: 1.678 Vali Acc: 0.278 Test Loss: 1.678 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6739675998687744
Epoch: 11, Steps: 17 | Train Loss: 1.171 Vali Loss: 1.714 Vali Acc: 0.293 Test Loss: 1.714 Test Acc: 0.293
Validation loss decreased (-0.288958 --> -0.292759).  Saving model ...
Epoch: 12 cost time: 1.646942138671875
Epoch: 12, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.872 Vali Acc: 0.281 Test Loss: 1.872 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.8206794261932373
Epoch: 13, Steps: 17 | Train Loss: 1.194 Vali Loss: 2.436 Vali Acc: 0.259 Test Loss: 2.436 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.660555124282837
Epoch: 14, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.971 Vali Acc: 0.278 Test Loss: 1.971 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8003089427947998
Epoch: 15, Steps: 17 | Train Loss: 1.100 Vali Loss: 2.081 Vali Acc: 0.262 Test Loss: 2.081 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4884724617004395
Epoch: 16, Steps: 17 | Train Loss: 0.966 Vali Loss: 1.834 Vali Acc: 0.335 Test Loss: 1.834 Test Acc: 0.335
Validation loss decreased (-0.292759 --> -0.334582).  Saving model ...
Epoch: 17 cost time: 1.4941952228546143
Epoch: 17, Steps: 17 | Train Loss: 0.831 Vali Loss: 2.333 Vali Acc: 0.312 Test Loss: 2.333 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6536860466003418
Epoch: 18, Steps: 17 | Train Loss: 0.962 Vali Loss: 2.080 Vali Acc: 0.293 Test Loss: 2.080 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5731334686279297
Epoch: 19, Steps: 17 | Train Loss: 0.907 Vali Loss: 2.330 Vali Acc: 0.300 Test Loss: 2.330 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6064956188201904
Epoch: 20, Steps: 17 | Train Loss: 0.903 Vali Loss: 2.119 Vali Acc: 0.331 Test Loss: 2.119 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.7864136695861816
Epoch: 21, Steps: 17 | Train Loss: 0.713 Vali Loss: 2.718 Vali Acc: 0.281 Test Loss: 2.718 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.2028326988220215
Epoch: 22, Steps: 17 | Train Loss: 0.851 Vali Loss: 2.186 Vali Acc: 0.350 Test Loss: 2.186 Test Acc: 0.350
Validation loss decreased (-0.334582 --> -0.349788).  Saving model ...
Epoch: 23 cost time: 1.8400990962982178
Epoch: 23, Steps: 17 | Train Loss: 0.878 Vali Loss: 2.362 Vali Acc: 0.323 Test Loss: 2.362 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8550045490264893
Epoch: 24, Steps: 17 | Train Loss: 0.710 Vali Loss: 2.457 Vali Acc: 0.285 Test Loss: 2.457 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.6768779754638672
Epoch: 25, Steps: 17 | Train Loss: 1.024 Vali Loss: 2.207 Vali Acc: 0.327 Test Loss: 2.207 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.847463846206665
Epoch: 26, Steps: 17 | Train Loss: 0.776 Vali Loss: 3.537 Vali Acc: 0.266 Test Loss: 3.537 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6957805156707764
Epoch: 27, Steps: 17 | Train Loss: 1.178 Vali Loss: 2.473 Vali Acc: 0.346 Test Loss: 2.473 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6325547695159912
Epoch: 28, Steps: 17 | Train Loss: 0.726 Vali Loss: 2.888 Vali Acc: 0.308 Test Loss: 2.888 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9117138385772705
Epoch: 29, Steps: 17 | Train Loss: 0.656 Vali Loss: 2.848 Vali Acc: 0.327 Test Loss: 2.848 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.7841625213623047
Epoch: 30, Steps: 17 | Train Loss: 0.428 Vali Loss: 2.744 Vali Acc: 0.308 Test Loss: 2.744 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.7260839939117432
Epoch: 31, Steps: 17 | Train Loss: 0.512 Vali Loss: 3.016 Vali Acc: 0.289 Test Loss: 3.016 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.6384966373443604
Epoch: 32, Steps: 17 | Train Loss: 0.558 Vali Loss: 2.938 Vali Acc: 0.316 Test Loss: 2.938 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34980988593155893
model parameter : 759708
model size : 4.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5541152954101562
Epoch: 1, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.524 Vali Acc: 0.274 Test Loss: 1.524 Test Acc: 0.274
Validation loss decreased (inf --> -0.273749).  Saving model ...
Epoch: 2 cost time: 1.7909653186798096
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.622 Vali Acc: 0.240 Test Loss: 1.622 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4456696510314941
Epoch: 3, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.536 Vali Acc: 0.236 Test Loss: 1.536 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5696594715118408
Epoch: 4, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.816 Vali Acc: 0.232 Test Loss: 1.816 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.7292683124542236
Epoch: 5, Steps: 17 | Train Loss: 1.568 Vali Loss: 1.552 Vali Acc: 0.251 Test Loss: 1.552 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5943257808685303
Epoch: 6, Steps: 17 | Train Loss: 1.589 Vali Loss: 1.455 Vali Acc: 0.289 Test Loss: 1.455 Test Acc: 0.289
Validation loss decreased (-0.273749 --> -0.288959).  Saving model ...
Epoch: 7 cost time: 1.5365188121795654
Epoch: 7, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.917 Vali Acc: 0.289 Test Loss: 1.917 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7670910358428955
Epoch: 8, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.932 Vali Acc: 0.270 Test Loss: 1.932 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4704275131225586
Epoch: 9, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.712 Vali Acc: 0.274 Test Loss: 1.712 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6657161712646484
Epoch: 10, Steps: 17 | Train Loss: 1.428 Vali Loss: 2.341 Vali Acc: 0.262 Test Loss: 2.341 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.5576539039611816
Epoch: 11, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.990 Vali Acc: 0.289 Test Loss: 1.990 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4354100227355957
Epoch: 12, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.658 Vali Acc: 0.289 Test Loss: 1.658 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.733964443206787
Epoch: 13, Steps: 17 | Train Loss: 1.187 Vali Loss: 2.668 Vali Acc: 0.281 Test Loss: 2.668 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6443815231323242
Epoch: 14, Steps: 17 | Train Loss: 1.273 Vali Loss: 1.897 Vali Acc: 0.300 Test Loss: 1.897 Test Acc: 0.300
Validation loss decreased (-0.288959 --> -0.300361).  Saving model ...
Epoch: 15 cost time: 1.6153769493103027
Epoch: 15, Steps: 17 | Train Loss: 1.065 Vali Loss: 2.036 Vali Acc: 0.281 Test Loss: 2.036 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4309990406036377
Epoch: 16, Steps: 17 | Train Loss: 1.011 Vali Loss: 2.196 Vali Acc: 0.274 Test Loss: 2.196 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7725601196289062
Epoch: 17, Steps: 17 | Train Loss: 0.943 Vali Loss: 1.960 Vali Acc: 0.316 Test Loss: 1.960 Test Acc: 0.316
Validation loss decreased (-0.300361 --> -0.315570).  Saving model ...
Epoch: 18 cost time: 1.7520408630371094
Epoch: 18, Steps: 17 | Train Loss: 1.048 Vali Loss: 2.210 Vali Acc: 0.289 Test Loss: 2.210 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7722582817077637
Epoch: 19, Steps: 17 | Train Loss: 0.864 Vali Loss: 1.939 Vali Acc: 0.312 Test Loss: 1.939 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6367363929748535
Epoch: 20, Steps: 17 | Train Loss: 0.819 Vali Loss: 2.352 Vali Acc: 0.293 Test Loss: 2.352 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5296039581298828
Epoch: 21, Steps: 17 | Train Loss: 0.976 Vali Loss: 2.474 Vali Acc: 0.259 Test Loss: 2.474 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.8740477561950684
Epoch: 22, Steps: 17 | Train Loss: 0.698 Vali Loss: 1.996 Vali Acc: 0.308 Test Loss: 1.996 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6920747756958008
Epoch: 23, Steps: 17 | Train Loss: 0.676 Vali Loss: 2.191 Vali Acc: 0.289 Test Loss: 2.191 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.956681728363037
Epoch: 24, Steps: 17 | Train Loss: 0.660 Vali Loss: 2.467 Vali Acc: 0.297 Test Loss: 2.467 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.4494397640228271
Epoch: 25, Steps: 17 | Train Loss: 0.631 Vali Loss: 2.510 Vali Acc: 0.300 Test Loss: 2.510 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.861314296722412
Epoch: 26, Steps: 17 | Train Loss: 0.479 Vali Loss: 3.541 Vali Acc: 0.285 Test Loss: 3.541 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.824357509613037
Epoch: 27, Steps: 17 | Train Loss: 0.811 Vali Loss: 2.342 Vali Acc: 0.312 Test Loss: 2.342 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 750364
model size : 4.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4585342407226562
Epoch: 1, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.540 Vali Acc: 0.266 Test Loss: 1.540 Test Acc: 0.266
Validation loss decreased (inf --> -0.266144).  Saving model ...
Epoch: 2 cost time: 1.5988264083862305
Epoch: 2, Steps: 17 | Train Loss: 1.771 Vali Loss: 2.024 Vali Acc: 0.255 Test Loss: 2.024 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6279423236846924
Epoch: 3, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.457 Vali Acc: 0.304 Test Loss: 1.457 Test Acc: 0.304
Validation loss decreased (-0.266144 --> -0.304168).  Saving model ...
Epoch: 4 cost time: 1.1342720985412598
Epoch: 4, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.884 Vali Acc: 0.270 Test Loss: 1.884 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.779165506362915
Epoch: 5, Steps: 17 | Train Loss: 1.533 Vali Loss: 1.615 Vali Acc: 0.255 Test Loss: 1.615 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5954999923706055
Epoch: 6, Steps: 17 | Train Loss: 1.713 Vali Loss: 2.141 Vali Acc: 0.281 Test Loss: 2.141 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.648841142654419
Epoch: 7, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.512 Vali Acc: 0.297 Test Loss: 1.512 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.704221248626709
Epoch: 8, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.714 Vali Acc: 0.274 Test Loss: 1.714 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.669464349746704
Epoch: 9, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.714 Vali Acc: 0.293 Test Loss: 1.714 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5647151470184326
Epoch: 10, Steps: 17 | Train Loss: 1.267 Vali Loss: 2.049 Vali Acc: 0.274 Test Loss: 2.049 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6677005290985107
Epoch: 11, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.611 Vali Acc: 0.289 Test Loss: 1.611 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.422459363937378
Epoch: 12, Steps: 17 | Train Loss: 1.136 Vali Loss: 2.274 Vali Acc: 0.289 Test Loss: 2.274 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.6662189960479736
Epoch: 13, Steps: 17 | Train Loss: 1.291 Vali Loss: 2.559 Vali Acc: 0.266 Test Loss: 2.559 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 580252
model size : 3.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2095324993133545
Epoch: 1, Steps: 17 | Train Loss: 1.563 Vali Loss: 1.410 Vali Acc: 0.255 Test Loss: 1.410 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.741408348083496
Epoch: 2, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.803 Vali Acc: 0.262 Test Loss: 1.803 Test Acc: 0.262
Validation loss decreased (-0.254739 --> -0.262339).  Saving model ...
Epoch: 3 cost time: 1.7026855945587158
Epoch: 3, Steps: 17 | Train Loss: 1.730 Vali Loss: 1.501 Vali Acc: 0.278 Test Loss: 1.501 Test Acc: 0.278
Validation loss decreased (-0.262339 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 1.6839478015899658
Epoch: 4, Steps: 17 | Train Loss: 1.970 Vali Loss: 2.487 Vali Acc: 0.259 Test Loss: 2.487 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7724144458770752
Epoch: 5, Steps: 17 | Train Loss: 1.474 Vali Loss: 2.396 Vali Acc: 0.255 Test Loss: 2.396 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.689741611480713
Epoch: 6, Steps: 17 | Train Loss: 1.762 Vali Loss: 1.684 Vali Acc: 0.259 Test Loss: 1.684 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7783305644989014
Epoch: 7, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.752 Vali Acc: 0.270 Test Loss: 1.752 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8171899318695068
Epoch: 8, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.845 Vali Acc: 0.240 Test Loss: 1.845 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5917987823486328
Epoch: 9, Steps: 17 | Train Loss: 1.397 Vali Loss: 2.025 Vali Acc: 0.243 Test Loss: 2.025 Test Acc: 0.243
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.560349702835083
Epoch: 10, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.978 Vali Acc: 0.259 Test Loss: 1.978 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5744450092315674
Epoch: 11, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.881 Vali Acc: 0.259 Test Loss: 1.881 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.8204429149627686
Epoch: 12, Steps: 17 | Train Loss: 1.149 Vali Loss: 2.357 Vali Acc: 0.243 Test Loss: 2.357 Test Acc: 0.243
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.753610372543335
Epoch: 13, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.734 Vali Acc: 0.278 Test Loss: 1.734 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.27756653992395436
model parameter : 570908
model size : 3.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2482073307037354
Epoch: 1, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.550 Vali Acc: 0.236 Test Loss: 1.550 Test Acc: 0.236
Validation loss decreased (inf --> -0.235726).  Saving model ...
Epoch: 2 cost time: 1.3546741008758545
Epoch: 2, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.502 Vali Acc: 0.278 Test Loss: 1.502 Test Acc: 0.278
Validation loss decreased (-0.235726 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 1.6782612800598145
Epoch: 3, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.614 Vali Acc: 0.259 Test Loss: 1.614 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6875765323638916
Epoch: 4, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.660 Vali Acc: 0.255 Test Loss: 1.660 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5796360969543457
Epoch: 5, Steps: 17 | Train Loss: 1.489 Vali Loss: 1.521 Vali Acc: 0.255 Test Loss: 1.521 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.661900520324707
Epoch: 6, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.870 Vali Acc: 0.251 Test Loss: 1.870 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7168376445770264
Epoch: 7, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.823 Vali Acc: 0.251 Test Loss: 1.823 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.0671796798706055
Epoch: 8, Steps: 17 | Train Loss: 1.712 Vali Loss: 1.750 Vali Acc: 0.278 Test Loss: 1.750 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.7815499305725098
Epoch: 9, Steps: 17 | Train Loss: 1.356 Vali Loss: 2.198 Vali Acc: 0.274 Test Loss: 2.198 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6089885234832764
Epoch: 10, Steps: 17 | Train Loss: 1.486 Vali Loss: 2.128 Vali Acc: 0.274 Test Loss: 2.128 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5123565196990967
Epoch: 11, Steps: 17 | Train Loss: 1.279 Vali Loss: 2.044 Vali Acc: 0.300 Test Loss: 2.044 Test Acc: 0.300
Validation loss decreased (-0.277552 --> -0.300360).  Saving model ...
Epoch: 12 cost time: 1.6758017539978027
Epoch: 12, Steps: 17 | Train Loss: 1.081 Vali Loss: 2.084 Vali Acc: 0.281 Test Loss: 2.084 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7484571933746338
Epoch: 13, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.745 Vali Acc: 0.281 Test Loss: 1.745 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.471498727798462
Epoch: 14, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.851 Vali Acc: 0.300 Test Loss: 1.851 Test Acc: 0.300
Validation loss decreased (-0.300360 --> -0.300362).  Saving model ...
Epoch: 15 cost time: 1.526092767715454
Epoch: 15, Steps: 17 | Train Loss: 0.916 Vali Loss: 2.131 Vali Acc: 0.270 Test Loss: 2.131 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8892803192138672
Epoch: 16, Steps: 17 | Train Loss: 1.228 Vali Loss: 2.024 Vali Acc: 0.278 Test Loss: 2.024 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4897410869598389
Epoch: 17, Steps: 17 | Train Loss: 0.941 Vali Loss: 2.357 Vali Acc: 0.316 Test Loss: 2.357 Test Acc: 0.316
Validation loss decreased (-0.300362 --> -0.315566).  Saving model ...
Epoch: 18 cost time: 1.7920331954956055
Epoch: 18, Steps: 17 | Train Loss: 1.064 Vali Loss: 2.037 Vali Acc: 0.300 Test Loss: 2.037 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.729081392288208
Epoch: 19, Steps: 17 | Train Loss: 0.931 Vali Loss: 2.318 Vali Acc: 0.285 Test Loss: 2.318 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8416647911071777
Epoch: 20, Steps: 17 | Train Loss: 0.946 Vali Loss: 2.358 Vali Acc: 0.293 Test Loss: 2.358 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9104249477386475
Epoch: 21, Steps: 17 | Train Loss: 0.952 Vali Loss: 2.352 Vali Acc: 0.327 Test Loss: 2.352 Test Acc: 0.327
Validation loss decreased (-0.315566 --> -0.326973).  Saving model ...
Epoch: 22 cost time: 1.4361860752105713
Epoch: 22, Steps: 17 | Train Loss: 0.939 Vali Loss: 2.527 Vali Acc: 0.338 Test Loss: 2.527 Test Acc: 0.338
Validation loss decreased (-0.326973 --> -0.338378).  Saving model ...
Epoch: 23 cost time: 1.6769146919250488
Epoch: 23, Steps: 17 | Train Loss: 0.795 Vali Loss: 2.118 Vali Acc: 0.319 Test Loss: 2.118 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.5540852546691895
Epoch: 24, Steps: 17 | Train Loss: 0.782 Vali Loss: 3.339 Vali Acc: 0.278 Test Loss: 3.339 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.5452868938446045
Epoch: 25, Steps: 17 | Train Loss: 0.812 Vali Loss: 2.541 Vali Acc: 0.331 Test Loss: 2.541 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.6296656131744385
Epoch: 26, Steps: 17 | Train Loss: 0.700 Vali Loss: 2.528 Vali Acc: 0.323 Test Loss: 2.528 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.488523244857788
Epoch: 27, Steps: 17 | Train Loss: 0.730 Vali Loss: 2.435 Vali Acc: 0.350 Test Loss: 2.435 Test Acc: 0.350
Validation loss decreased (-0.338378 --> -0.349786).  Saving model ...
Epoch: 28 cost time: 1.5980947017669678
Epoch: 28, Steps: 17 | Train Loss: 0.735 Vali Loss: 2.426 Vali Acc: 0.335 Test Loss: 2.426 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4843099117279053
Epoch: 29, Steps: 17 | Train Loss: 0.544 Vali Loss: 3.378 Vali Acc: 0.308 Test Loss: 3.378 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.5489301681518555
Epoch: 30, Steps: 17 | Train Loss: 0.957 Vali Loss: 2.784 Vali Acc: 0.327 Test Loss: 2.784 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8008568286895752
Epoch: 31, Steps: 17 | Train Loss: 0.746 Vali Loss: 2.965 Vali Acc: 0.342 Test Loss: 2.965 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.4467768669128418
Epoch: 32, Steps: 17 | Train Loss: 0.622 Vali Loss: 3.238 Vali Acc: 0.300 Test Loss: 3.238 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2773454189300537
Epoch: 33, Steps: 17 | Train Loss: 0.672 Vali Loss: 2.717 Vali Acc: 0.342 Test Loss: 2.717 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.8809638023376465
Epoch: 34, Steps: 17 | Train Loss: 0.574 Vali Loss: 2.958 Vali Acc: 0.316 Test Loss: 2.958 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.5226168632507324
Epoch: 35, Steps: 17 | Train Loss: 0.478 Vali Loss: 3.092 Vali Acc: 0.289 Test Loss: 3.092 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4980790615081787
Epoch: 36, Steps: 17 | Train Loss: 0.476 Vali Loss: 3.280 Vali Acc: 0.335 Test Loss: 3.280 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.624967098236084
Epoch: 37, Steps: 17 | Train Loss: 0.486 Vali Loss: 3.472 Vali Acc: 0.327 Test Loss: 3.472 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34980988593155893
model parameter : 561564
model size : 3.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.111616373062134
Epoch: 1, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.622 Vali Acc: 0.255 Test Loss: 1.622 Test Acc: 0.255
Validation loss decreased (inf --> -0.254737).  Saving model ...
Epoch: 2 cost time: 1.4405508041381836
Epoch: 2, Steps: 17 | Train Loss: 1.614 Vali Loss: 1.584 Vali Acc: 0.270 Test Loss: 1.584 Test Acc: 0.270
Validation loss decreased (-0.254737 --> -0.269946).  Saving model ...
Epoch: 3 cost time: 1.5381910800933838
Epoch: 3, Steps: 17 | Train Loss: 1.476 Vali Loss: 1.476 Vali Acc: 0.278 Test Loss: 1.476 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277552).  Saving model ...
Epoch: 4 cost time: 1.2583882808685303
Epoch: 4, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.834 Vali Acc: 0.251 Test Loss: 1.834 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.55989670753479
Epoch: 5, Steps: 17 | Train Loss: 1.581 Vali Loss: 1.621 Vali Acc: 0.243 Test Loss: 1.621 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.509653091430664
Epoch: 6, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.550 Vali Acc: 0.274 Test Loss: 1.550 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.889237642288208
Epoch: 7, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.904 Vali Acc: 0.247 Test Loss: 1.904 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8787622451782227
Epoch: 8, Steps: 17 | Train Loss: 1.589 Vali Loss: 1.637 Vali Acc: 0.289 Test Loss: 1.637 Test Acc: 0.289
Validation loss decreased (-0.277552 --> -0.288957).  Saving model ...
Epoch: 9 cost time: 1.4267640113830566
Epoch: 9, Steps: 17 | Train Loss: 1.344 Vali Loss: 2.928 Vali Acc: 0.251 Test Loss: 2.928 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1711525917053223
Epoch: 10, Steps: 17 | Train Loss: 1.729 Vali Loss: 2.071 Vali Acc: 0.243 Test Loss: 2.071 Test Acc: 0.243
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6453773975372314
Epoch: 11, Steps: 17 | Train Loss: 1.449 Vali Loss: 2.413 Vali Acc: 0.247 Test Loss: 2.413 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5561332702636719
Epoch: 12, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.696 Vali Acc: 0.289 Test Loss: 1.696 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.702012538909912
Epoch: 13, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.988 Vali Acc: 0.266 Test Loss: 1.988 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.545776128768921
Epoch: 14, Steps: 17 | Train Loss: 1.105 Vali Loss: 2.185 Vali Acc: 0.270 Test Loss: 2.185 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6239795684814453
Epoch: 15, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.979 Vali Acc: 0.270 Test Loss: 1.979 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.4137272834777832
Epoch: 16, Steps: 17 | Train Loss: 0.944 Vali Loss: 3.344 Vali Acc: 0.251 Test Loss: 3.344 Test Acc: 0.251
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4864587783813477
Epoch: 17, Steps: 17 | Train Loss: 1.505 Vali Loss: 2.152 Vali Acc: 0.293 Test Loss: 2.152 Test Acc: 0.293
Validation loss decreased (-0.288957 --> -0.292754).  Saving model ...
Epoch: 18 cost time: 1.6120872497558594
Epoch: 18, Steps: 17 | Train Loss: 0.942 Vali Loss: 2.824 Vali Acc: 0.274 Test Loss: 2.824 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.807800054550171
Epoch: 19, Steps: 17 | Train Loss: 1.128 Vali Loss: 2.095 Vali Acc: 0.285 Test Loss: 2.095 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4765453338623047
Epoch: 20, Steps: 17 | Train Loss: 0.888 Vali Loss: 2.877 Vali Acc: 0.262 Test Loss: 2.877 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.62577223777771
Epoch: 21, Steps: 17 | Train Loss: 0.962 Vali Loss: 2.104 Vali Acc: 0.308 Test Loss: 2.104 Test Acc: 0.308
Validation loss decreased (-0.292754 --> -0.307964).  Saving model ...
Epoch: 22 cost time: 1.4659531116485596
Epoch: 22, Steps: 17 | Train Loss: 0.734 Vali Loss: 2.104 Vali Acc: 0.289 Test Loss: 2.104 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4920272827148438
Epoch: 23, Steps: 17 | Train Loss: 0.802 Vali Loss: 2.763 Vali Acc: 0.289 Test Loss: 2.763 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.544076681137085
Epoch: 24, Steps: 17 | Train Loss: 0.732 Vali Loss: 2.433 Vali Acc: 0.289 Test Loss: 2.433 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4300241470336914
Epoch: 25, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.313 Vali Acc: 0.300 Test Loss: 2.313 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5041582584381104
Epoch: 26, Steps: 17 | Train Loss: 0.743 Vali Loss: 2.321 Vali Acc: 0.327 Test Loss: 2.321 Test Acc: 0.327
Validation loss decreased (-0.307964 --> -0.326973).  Saving model ...
Epoch: 27 cost time: 1.4861319065093994
Epoch: 27, Steps: 17 | Train Loss: 0.614 Vali Loss: 2.730 Vali Acc: 0.312 Test Loss: 2.730 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.6846978664398193
Epoch: 28, Steps: 17 | Train Loss: 0.727 Vali Loss: 2.768 Vali Acc: 0.316 Test Loss: 2.768 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.6907684803009033
Epoch: 29, Steps: 17 | Train Loss: 0.608 Vali Loss: 3.338 Vali Acc: 0.293 Test Loss: 3.338 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.505591630935669
Epoch: 30, Steps: 17 | Train Loss: 0.834 Vali Loss: 2.821 Vali Acc: 0.281 Test Loss: 2.821 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.4460060596466064
Epoch: 31, Steps: 17 | Train Loss: 0.463 Vali Loss: 2.727 Vali Acc: 0.331 Test Loss: 2.727 Test Acc: 0.331
Validation loss decreased (-0.326973 --> -0.330771).  Saving model ...
Epoch: 32 cost time: 1.444185495376587
Epoch: 32, Steps: 17 | Train Loss: 0.767 Vali Loss: 2.989 Vali Acc: 0.316 Test Loss: 2.989 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2213208675384521
Epoch: 33, Steps: 17 | Train Loss: 0.591 Vali Loss: 2.874 Vali Acc: 0.380 Test Loss: 2.874 Test Acc: 0.380
Validation loss decreased (-0.330771 --> -0.380199).  Saving model ...
Epoch: 34 cost time: 1.4221382141113281
Epoch: 34, Steps: 17 | Train Loss: 0.352 Vali Loss: 2.797 Vali Acc: 0.373 Test Loss: 2.797 Test Acc: 0.373
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.5004949569702148
Epoch: 35, Steps: 17 | Train Loss: 0.432 Vali Loss: 3.494 Vali Acc: 0.293 Test Loss: 3.494 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.5162122249603271
Epoch: 36, Steps: 17 | Train Loss: 0.569 Vali Loss: 3.812 Vali Acc: 0.323 Test Loss: 3.812 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.5105903148651123
Epoch: 37, Steps: 17 | Train Loss: 0.545 Vali Loss: 3.821 Vali Acc: 0.319 Test Loss: 3.821 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.4190845489501953
Epoch: 38, Steps: 17 | Train Loss: 0.678 Vali Loss: 3.222 Vali Acc: 0.312 Test Loss: 3.222 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.6000421047210693
Epoch: 39, Steps: 17 | Train Loss: 0.398 Vali Loss: 3.436 Vali Acc: 0.327 Test Loss: 3.436 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.564659833908081
Epoch: 40, Steps: 17 | Train Loss: 0.324 Vali Loss: 3.742 Vali Acc: 0.293 Test Loss: 3.742 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.5907385349273682
Epoch: 41, Steps: 17 | Train Loss: 0.351 Vali Loss: 3.371 Vali Acc: 0.354 Test Loss: 3.371 Test Acc: 0.354
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.6593308448791504
Epoch: 42, Steps: 17 | Train Loss: 0.196 Vali Loss: 4.534 Vali Acc: 0.308 Test Loss: 4.534 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.527899980545044
Epoch: 43, Steps: 17 | Train Loss: 0.320 Vali Loss: 4.774 Vali Acc: 0.323 Test Loss: 4.774 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38022813688212925
model parameter : 552220
model size : 3.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4528417587280273
Epoch: 1, Steps: 17 | Train Loss: 1.614 Vali Loss: 1.570 Vali Acc: 0.266 Test Loss: 1.570 Test Acc: 0.266
Validation loss decreased (inf --> -0.266144).  Saving model ...
Epoch: 2 cost time: 1.611271619796753
Epoch: 2, Steps: 17 | Train Loss: 1.551 Vali Loss: 1.567 Vali Acc: 0.262 Test Loss: 1.567 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.772813320159912
Epoch: 3, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.594 Vali Acc: 0.270 Test Loss: 1.594 Test Acc: 0.270
Validation loss decreased (-0.266144 --> -0.269946).  Saving model ...
Epoch: 4 cost time: 1.778756856918335
Epoch: 4, Steps: 17 | Train Loss: 1.436 Vali Loss: 1.615 Vali Acc: 0.270 Test Loss: 1.615 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.807030439376831
Epoch: 5, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.843 Vali Acc: 0.259 Test Loss: 1.843 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6329526901245117
Epoch: 6, Steps: 17 | Train Loss: 1.611 Vali Loss: 1.924 Vali Acc: 0.251 Test Loss: 1.924 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5677378177642822
Epoch: 7, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.804 Vali Acc: 0.285 Test Loss: 1.804 Test Acc: 0.285
Validation loss decreased (-0.269946 --> -0.285153).  Saving model ...
Epoch: 8 cost time: 1.8412504196166992
Epoch: 8, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.562 Vali Acc: 0.304 Test Loss: 1.562 Test Acc: 0.304
Validation loss decreased (-0.285153 --> -0.304167).  Saving model ...
Epoch: 9 cost time: 1.65287184715271
Epoch: 9, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.731 Vali Acc: 0.236 Test Loss: 1.731 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.586517333984375
Epoch: 10, Steps: 17 | Train Loss: 1.415 Vali Loss: 1.705 Vali Acc: 0.262 Test Loss: 1.705 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7408387660980225
Epoch: 11, Steps: 17 | Train Loss: 1.346 Vali Loss: 2.041 Vali Acc: 0.278 Test Loss: 2.041 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6247384548187256
Epoch: 12, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.802 Vali Acc: 0.255 Test Loss: 1.802 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5915982723236084
Epoch: 13, Steps: 17 | Train Loss: 1.198 Vali Loss: 1.849 Vali Acc: 0.247 Test Loss: 1.849 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.707632303237915
Epoch: 14, Steps: 17 | Train Loss: 1.261 Vali Loss: 2.085 Vali Acc: 0.278 Test Loss: 2.085 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6335077285766602
Epoch: 15, Steps: 17 | Train Loss: 1.038 Vali Loss: 2.021 Vali Acc: 0.270 Test Loss: 2.021 Test Acc: 0.270
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.6360528469085693
Epoch: 16, Steps: 17 | Train Loss: 1.054 Vali Loss: 2.349 Vali Acc: 0.274 Test Loss: 2.349 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5983846187591553
Epoch: 17, Steps: 17 | Train Loss: 1.012 Vali Loss: 2.093 Vali Acc: 0.300 Test Loss: 2.093 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.839524745941162
Epoch: 18, Steps: 17 | Train Loss: 0.947 Vali Loss: 2.288 Vali Acc: 0.297 Test Loss: 2.288 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 481180
model size : 3.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.9427504539489746
Epoch: 1, Steps: 17 | Train Loss: 1.513 Vali Loss: 1.818 Vali Acc: 0.255 Test Loss: 1.818 Test Acc: 0.255
Validation loss decreased (inf --> -0.254735).  Saving model ...
Epoch: 2 cost time: 1.7630949020385742
Epoch: 2, Steps: 17 | Train Loss: 1.803 Vali Loss: 1.959 Vali Acc: 0.247 Test Loss: 1.959 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.70772385597229
Epoch: 3, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.573 Vali Acc: 0.270 Test Loss: 1.573 Test Acc: 0.270
Validation loss decreased (-0.254735 --> -0.269946).  Saving model ...
Epoch: 4 cost time: 1.6134936809539795
Epoch: 4, Steps: 17 | Train Loss: 1.463 Vali Loss: 1.582 Vali Acc: 0.274 Test Loss: 1.582 Test Acc: 0.274
Validation loss decreased (-0.269946 --> -0.273748).  Saving model ...
Epoch: 5 cost time: 1.8842623233795166
Epoch: 5, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.491 Vali Acc: 0.278 Test Loss: 1.491 Test Acc: 0.278
Validation loss decreased (-0.273748 --> -0.277552).  Saving model ...
Epoch: 6 cost time: 1.8822245597839355
Epoch: 6, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.861 Vali Acc: 0.259 Test Loss: 1.861 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6896491050720215
Epoch: 7, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.924 Vali Acc: 0.266 Test Loss: 1.924 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.8524928092956543
Epoch: 8, Steps: 17 | Train Loss: 1.346 Vali Loss: 1.730 Vali Acc: 0.304 Test Loss: 1.730 Test Acc: 0.304
Validation loss decreased (-0.277552 --> -0.304165).  Saving model ...
Epoch: 9 cost time: 1.62900972366333
Epoch: 9, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.534 Vali Acc: 0.281 Test Loss: 1.534 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.5627059936523438
Epoch: 10, Steps: 17 | Train Loss: 1.311 Vali Loss: 2.277 Vali Acc: 0.255 Test Loss: 2.277 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5566580295562744
Epoch: 11, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.648 Vali Acc: 0.278 Test Loss: 1.648 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3766121864318848
Epoch: 12, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.737 Vali Acc: 0.331 Test Loss: 1.737 Test Acc: 0.331
Validation loss decreased (-0.304165 --> -0.330781).  Saving model ...
Epoch: 13 cost time: 1.390629768371582
Epoch: 13, Steps: 17 | Train Loss: 1.335 Vali Loss: 2.084 Vali Acc: 0.289 Test Loss: 2.084 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4174151420593262
Epoch: 14, Steps: 17 | Train Loss: 1.270 Vali Loss: 2.024 Vali Acc: 0.281 Test Loss: 2.024 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5131874084472656
Epoch: 15, Steps: 17 | Train Loss: 1.023 Vali Loss: 2.234 Vali Acc: 0.255 Test Loss: 2.234 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5191915035247803
Epoch: 16, Steps: 17 | Train Loss: 1.015 Vali Loss: 2.387 Vali Acc: 0.259 Test Loss: 2.387 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5461609363555908
Epoch: 17, Steps: 17 | Train Loss: 1.157 Vali Loss: 2.324 Vali Acc: 0.278 Test Loss: 2.324 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.5490903854370117
Epoch: 18, Steps: 17 | Train Loss: 1.011 Vali Loss: 2.010 Vali Acc: 0.327 Test Loss: 2.010 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.478257179260254
Epoch: 19, Steps: 17 | Train Loss: 0.864 Vali Loss: 2.131 Vali Acc: 0.308 Test Loss: 2.131 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.387105941772461
Epoch: 20, Steps: 17 | Train Loss: 0.857 Vali Loss: 2.027 Vali Acc: 0.338 Test Loss: 2.027 Test Acc: 0.338
Validation loss decreased (-0.330781 --> -0.338383).  Saving model ...
Epoch: 21 cost time: 1.5442073345184326
Epoch: 21, Steps: 17 | Train Loss: 0.901 Vali Loss: 2.433 Vali Acc: 0.297 Test Loss: 2.433 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.6835603713989258
Epoch: 22, Steps: 17 | Train Loss: 0.774 Vali Loss: 2.693 Vali Acc: 0.251 Test Loss: 2.693 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4431788921356201
Epoch: 23, Steps: 17 | Train Loss: 0.969 Vali Loss: 2.487 Vali Acc: 0.293 Test Loss: 2.487 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4504172801971436
Epoch: 24, Steps: 17 | Train Loss: 0.930 Vali Loss: 2.910 Vali Acc: 0.266 Test Loss: 2.910 Test Acc: 0.266
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5876789093017578
Epoch: 25, Steps: 17 | Train Loss: 0.876 Vali Loss: 2.400 Vali Acc: 0.312 Test Loss: 2.400 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4075467586517334
Epoch: 26, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.720 Vali Acc: 0.293 Test Loss: 2.720 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5428543090820312
Epoch: 27, Steps: 17 | Train Loss: 0.728 Vali Loss: 2.878 Vali Acc: 0.297 Test Loss: 2.878 Test Acc: 0.297
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5222680568695068
Epoch: 28, Steps: 17 | Train Loss: 0.635 Vali Loss: 2.764 Vali Acc: 0.316 Test Loss: 2.764 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.499518871307373
Epoch: 29, Steps: 17 | Train Loss: 0.647 Vali Loss: 3.087 Vali Acc: 0.327 Test Loss: 3.087 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.661428689956665
Epoch: 30, Steps: 17 | Train Loss: 0.755 Vali Loss: 3.027 Vali Acc: 0.316 Test Loss: 3.027 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33840304182509506
model parameter : 471836
model size : 3.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.288437843322754
Epoch: 1, Steps: 17 | Train Loss: 1.525 Vali Loss: 1.528 Vali Acc: 0.259 Test Loss: 1.528 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 1.5874924659729004
Epoch: 2, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.589 Vali Acc: 0.259 Test Loss: 1.589 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6768264770507812
Epoch: 3, Steps: 17 | Train Loss: 1.470 Vali Loss: 1.797 Vali Acc: 0.259 Test Loss: 1.797 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.737657070159912
Epoch: 4, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.465 Vali Acc: 0.297 Test Loss: 1.465 Test Acc: 0.297
Validation loss decreased (-0.258540 --> -0.296563).  Saving model ...
Epoch: 5 cost time: 1.7769229412078857
Epoch: 5, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.510 Vali Acc: 0.304 Test Loss: 1.510 Test Acc: 0.304
Validation loss decreased (-0.296563 --> -0.304167).  Saving model ...
Epoch: 6 cost time: 1.6171116828918457
Epoch: 6, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.822 Vali Acc: 0.259 Test Loss: 1.822 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6841814517974854
Epoch: 7, Steps: 17 | Train Loss: 1.465 Vali Loss: 1.770 Vali Acc: 0.236 Test Loss: 1.770 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7813773155212402
Epoch: 8, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.797 Vali Acc: 0.251 Test Loss: 1.797 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6167550086975098
Epoch: 9, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.618 Vali Acc: 0.274 Test Loss: 1.618 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7071208953857422
Epoch: 10, Steps: 17 | Train Loss: 1.605 Vali Loss: 2.169 Vali Acc: 0.262 Test Loss: 2.169 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4869837760925293
Epoch: 11, Steps: 17 | Train Loss: 1.444 Vali Loss: 2.149 Vali Acc: 0.262 Test Loss: 2.149 Test Acc: 0.262
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5789380073547363
Epoch: 12, Steps: 17 | Train Loss: 1.267 Vali Loss: 2.444 Vali Acc: 0.251 Test Loss: 2.444 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7563090324401855
Epoch: 13, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.857 Vali Acc: 0.293 Test Loss: 1.857 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.5289511680603027
Epoch: 14, Steps: 17 | Train Loss: 1.078 Vali Loss: 2.182 Vali Acc: 0.274 Test Loss: 2.182 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.589376449584961
Epoch: 15, Steps: 17 | Train Loss: 1.341 Vali Loss: 2.198 Vali Acc: 0.278 Test Loss: 2.198 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 462492
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 4.170009613037109
Epoch: 1, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.856 Vali Acc: 0.262 Test Loss: 1.856 Test Acc: 0.262
Validation loss decreased (inf --> -0.262339).  Saving model ...
Epoch: 2 cost time: 1.764265775680542
Epoch: 2, Steps: 17 | Train Loss: 1.695 Vali Loss: 1.733 Vali Acc: 0.266 Test Loss: 1.733 Test Acc: 0.266
Validation loss decreased (-0.262339 --> -0.266142).  Saving model ...
Epoch: 3 cost time: 1.3545992374420166
Epoch: 3, Steps: 17 | Train Loss: 1.630 Vali Loss: 1.917 Vali Acc: 0.270 Test Loss: 1.917 Test Acc: 0.270
Validation loss decreased (-0.266142 --> -0.269943).  Saving model ...
Epoch: 4 cost time: 1.4325542449951172
Epoch: 4, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.697 Vali Acc: 0.251 Test Loss: 1.697 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3432848453521729
Epoch: 5, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.595 Vali Acc: 0.300 Test Loss: 1.595 Test Acc: 0.300
Validation loss decreased (-0.269943 --> -0.300364).  Saving model ...
Epoch: 6 cost time: 1.5233709812164307
Epoch: 6, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.922 Vali Acc: 0.240 Test Loss: 1.922 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.583390474319458
Epoch: 7, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.848 Vali Acc: 0.236 Test Loss: 1.848 Test Acc: 0.236
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6337385177612305
Epoch: 8, Steps: 17 | Train Loss: 1.460 Vali Loss: 1.583 Vali Acc: 0.297 Test Loss: 1.583 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.6456685066223145
Epoch: 9, Steps: 17 | Train Loss: 1.337 Vali Loss: 1.815 Vali Acc: 0.259 Test Loss: 1.815 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6312594413757324
Epoch: 10, Steps: 17 | Train Loss: 1.536 Vali Loss: 2.120 Vali Acc: 0.262 Test Loss: 2.120 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5041418075561523
Epoch: 11, Steps: 17 | Train Loss: 1.376 Vali Loss: 2.209 Vali Acc: 0.297 Test Loss: 2.209 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5499944686889648
Epoch: 12, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.801 Vali Acc: 0.274 Test Loss: 1.801 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7636692523956299
Epoch: 13, Steps: 17 | Train Loss: 1.102 Vali Loss: 2.010 Vali Acc: 0.243 Test Loss: 2.010 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4573850631713867
Epoch: 14, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.907 Vali Acc: 0.304 Test Loss: 1.907 Test Acc: 0.304
Validation loss decreased (-0.300364 --> -0.304163).  Saving model ...
Epoch: 15 cost time: 1.1988418102264404
Epoch: 15, Steps: 17 | Train Loss: 1.014 Vali Loss: 2.039 Vali Acc: 0.281 Test Loss: 2.039 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5104706287384033
Epoch: 16, Steps: 17 | Train Loss: 1.005 Vali Loss: 2.225 Vali Acc: 0.297 Test Loss: 2.225 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7849583625793457
Epoch: 17, Steps: 17 | Train Loss: 0.863 Vali Loss: 2.598 Vali Acc: 0.278 Test Loss: 2.598 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.610645055770874
Epoch: 18, Steps: 17 | Train Loss: 0.966 Vali Loss: 2.676 Vali Acc: 0.278 Test Loss: 2.676 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.559406042098999
Epoch: 19, Steps: 17 | Train Loss: 1.023 Vali Loss: 2.264 Vali Acc: 0.293 Test Loss: 2.264 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5139071941375732
Epoch: 20, Steps: 17 | Train Loss: 0.885 Vali Loss: 2.144 Vali Acc: 0.350 Test Loss: 2.144 Test Acc: 0.350
Validation loss decreased (-0.304163 --> -0.349788).  Saving model ...
Epoch: 21 cost time: 1.5070991516113281
Epoch: 21, Steps: 17 | Train Loss: 0.773 Vali Loss: 2.602 Vali Acc: 0.335 Test Loss: 2.602 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.5551247596740723
Epoch: 22, Steps: 17 | Train Loss: 0.874 Vali Loss: 2.481 Vali Acc: 0.270 Test Loss: 2.481 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.500154972076416
Epoch: 23, Steps: 17 | Train Loss: 0.810 Vali Loss: 2.290 Vali Acc: 0.312 Test Loss: 2.290 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.6734287738800049
Epoch: 24, Steps: 17 | Train Loss: 0.687 Vali Loss: 2.423 Vali Acc: 0.312 Test Loss: 2.423 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.598980188369751
Epoch: 25, Steps: 17 | Train Loss: 0.629 Vali Loss: 2.481 Vali Acc: 0.300 Test Loss: 2.481 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.4991822242736816
Epoch: 26, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.807 Vali Acc: 0.323 Test Loss: 2.807 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.463456392288208
Epoch: 27, Steps: 17 | Train Loss: 0.807 Vali Loss: 2.727 Vali Acc: 0.293 Test Loss: 2.727 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5906217098236084
Epoch: 28, Steps: 17 | Train Loss: 0.692 Vali Loss: 2.591 Vali Acc: 0.308 Test Loss: 2.591 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6306869983673096
Epoch: 29, Steps: 17 | Train Loss: 0.670 Vali Loss: 2.926 Vali Acc: 0.312 Test Loss: 2.926 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.578028678894043
Epoch: 30, Steps: 17 | Train Loss: 0.493 Vali Loss: 2.983 Vali Acc: 0.312 Test Loss: 2.983 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34980988593155893
model parameter : 453148
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.308906316757202
Epoch: 1, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.486 Vali Acc: 0.243 Test Loss: 1.486 Test Acc: 0.243
Validation loss decreased (inf --> -0.243331).  Saving model ...
Epoch: 2 cost time: 1.4806537628173828
Epoch: 2, Steps: 17 | Train Loss: 1.450 Vali Loss: 1.480 Vali Acc: 0.247 Test Loss: 1.480 Test Acc: 0.247
Validation loss decreased (-0.243331 --> -0.247133).  Saving model ...
Epoch: 3 cost time: 1.662111520767212
Epoch: 3, Steps: 17 | Train Loss: 1.447 Vali Loss: 1.534 Vali Acc: 0.247 Test Loss: 1.534 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5198347568511963
Epoch: 4, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.608 Vali Acc: 0.323 Test Loss: 1.608 Test Acc: 0.323
Validation loss decreased (-0.247133 --> -0.323178).  Saving model ...
Epoch: 5 cost time: 1.6158473491668701
Epoch: 5, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.694 Vali Acc: 0.266 Test Loss: 1.694 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.250854253768921
Epoch: 6, Steps: 17 | Train Loss: 1.437 Vali Loss: 1.821 Vali Acc: 0.262 Test Loss: 1.821 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3813886642456055
Epoch: 7, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.567 Vali Acc: 0.289 Test Loss: 1.567 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5820324420928955
Epoch: 8, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.486 Vali Acc: 0.312 Test Loss: 1.486 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.747790813446045
Epoch: 9, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.725 Vali Acc: 0.266 Test Loss: 1.725 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.547663688659668
Epoch: 10, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.753 Vali Acc: 0.255 Test Loss: 1.753 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6524343490600586
Epoch: 11, Steps: 17 | Train Loss: 1.519 Vali Loss: 2.872 Vali Acc: 0.266 Test Loss: 2.872 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.667484998703003
Epoch: 12, Steps: 17 | Train Loss: 1.606 Vali Loss: 2.244 Vali Acc: 0.281 Test Loss: 2.244 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.660590648651123
Epoch: 13, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.863 Vali Acc: 0.289 Test Loss: 1.863 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6731746196746826
Epoch: 14, Steps: 17 | Train Loss: 1.248 Vali Loss: 2.077 Vali Acc: 0.236 Test Loss: 2.077 Test Acc: 0.236
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3231939163498099
model parameter : 431644
model size : 2.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.7620837688446045
Epoch: 1, Steps: 17 | Train Loss: 1.529 Vali Loss: 1.633 Vali Acc: 0.251 Test Loss: 1.633 Test Acc: 0.251
Validation loss decreased (inf --> -0.250934).  Saving model ...
Epoch: 2 cost time: 1.7273800373077393
Epoch: 2, Steps: 17 | Train Loss: 1.664 Vali Loss: 1.729 Vali Acc: 0.255 Test Loss: 1.729 Test Acc: 0.255
Validation loss decreased (-0.250934 --> -0.254736).  Saving model ...
Epoch: 3 cost time: 1.3866829872131348
Epoch: 3, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.623 Vali Acc: 0.293 Test Loss: 1.623 Test Acc: 0.293
Validation loss decreased (-0.254736 --> -0.292759).  Saving model ...
Epoch: 4 cost time: 1.2748453617095947
Epoch: 4, Steps: 17 | Train Loss: 1.582 Vali Loss: 1.565 Vali Acc: 0.274 Test Loss: 1.565 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.576298713684082
Epoch: 5, Steps: 17 | Train Loss: 1.607 Vali Loss: 1.859 Vali Acc: 0.262 Test Loss: 1.859 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2620644569396973
Epoch: 6, Steps: 17 | Train Loss: 1.624 Vali Loss: 2.822 Vali Acc: 0.251 Test Loss: 2.822 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6219940185546875
Epoch: 7, Steps: 17 | Train Loss: 2.035 Vali Loss: 1.577 Vali Acc: 0.289 Test Loss: 1.577 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.543403148651123
Epoch: 8, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.716 Vali Acc: 0.270 Test Loss: 1.716 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4330697059631348
Epoch: 9, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.728 Vali Acc: 0.293 Test Loss: 1.728 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.554098129272461
Epoch: 10, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.840 Vali Acc: 0.278 Test Loss: 1.840 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4057188034057617
Epoch: 11, Steps: 17 | Train Loss: 1.425 Vali Loss: 2.134 Vali Acc: 0.278 Test Loss: 2.134 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4839599132537842
Epoch: 12, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.703 Vali Acc: 0.278 Test Loss: 1.703 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4973657131195068
Epoch: 13, Steps: 17 | Train Loss: 1.252 Vali Loss: 2.552 Vali Acc: 0.240 Test Loss: 2.552 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.29277566539923955
model parameter : 422300
model size : 2.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4646849632263184
Epoch: 1, Steps: 17 | Train Loss: 1.499 Vali Loss: 1.487 Vali Acc: 0.262 Test Loss: 1.487 Test Acc: 0.262
Validation loss decreased (inf --> -0.262343).  Saving model ...
Epoch: 2 cost time: 1.4637455940246582
Epoch: 2, Steps: 17 | Train Loss: 1.473 Vali Loss: 1.763 Vali Acc: 0.274 Test Loss: 1.763 Test Acc: 0.274
Validation loss decreased (-0.262343 --> -0.273747).  Saving model ...
Epoch: 3 cost time: 1.3872723579406738
Epoch: 3, Steps: 17 | Train Loss: 1.575 Vali Loss: 1.619 Vali Acc: 0.266 Test Loss: 1.619 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4669950008392334
Epoch: 4, Steps: 17 | Train Loss: 1.724 Vali Loss: 1.621 Vali Acc: 0.266 Test Loss: 1.621 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5137746334075928
Epoch: 5, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.696 Vali Acc: 0.266 Test Loss: 1.696 Test Acc: 0.266
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.672229528427124
Epoch: 6, Steps: 17 | Train Loss: 1.408 Vali Loss: 1.534 Vali Acc: 0.281 Test Loss: 1.534 Test Acc: 0.281
Validation loss decreased (-0.273747 --> -0.281353).  Saving model ...
Epoch: 7 cost time: 1.594515085220337
Epoch: 7, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.933 Vali Acc: 0.247 Test Loss: 1.933 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5796000957489014
Epoch: 8, Steps: 17 | Train Loss: 1.585 Vali Loss: 1.840 Vali Acc: 0.281 Test Loss: 1.840 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.375709056854248
Epoch: 9, Steps: 17 | Train Loss: 1.408 Vali Loss: 2.295 Vali Acc: 0.270 Test Loss: 2.295 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9893627166748047
Epoch: 10, Steps: 17 | Train Loss: 1.309 Vali Loss: 2.211 Vali Acc: 0.243 Test Loss: 2.211 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.705549955368042
Epoch: 11, Steps: 17 | Train Loss: 1.413 Vali Loss: 2.179 Vali Acc: 0.247 Test Loss: 2.179 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5290045738220215
Epoch: 12, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.637 Vali Acc: 0.289 Test Loss: 1.637 Test Acc: 0.289
Validation loss decreased (-0.281353 --> -0.288957).  Saving model ...
Epoch: 13 cost time: 1.3321797847747803
Epoch: 13, Steps: 17 | Train Loss: 1.017 Vali Loss: 2.015 Vali Acc: 0.247 Test Loss: 2.015 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2252123355865479
Epoch: 14, Steps: 17 | Train Loss: 1.113 Vali Loss: 2.144 Vali Acc: 0.270 Test Loss: 2.144 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.225759744644165
Epoch: 15, Steps: 17 | Train Loss: 1.008 Vali Loss: 1.996 Vali Acc: 0.270 Test Loss: 1.996 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.307713270187378
Epoch: 16, Steps: 17 | Train Loss: 1.105 Vali Loss: 2.302 Vali Acc: 0.274 Test Loss: 2.302 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2752931118011475
Epoch: 17, Steps: 17 | Train Loss: 0.971 Vali Loss: 2.193 Vali Acc: 0.262 Test Loss: 2.193 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3145813941955566
Epoch: 18, Steps: 17 | Train Loss: 0.984 Vali Loss: 3.073 Vali Acc: 0.255 Test Loss: 3.073 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5018248558044434
Epoch: 19, Steps: 17 | Train Loss: 1.154 Vali Loss: 2.494 Vali Acc: 0.285 Test Loss: 2.494 Test Acc: 0.285
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.322697401046753
Epoch: 20, Steps: 17 | Train Loss: 0.800 Vali Loss: 2.543 Vali Acc: 0.274 Test Loss: 2.543 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6891016960144043
Epoch: 21, Steps: 17 | Train Loss: 0.923 Vali Loss: 3.251 Vali Acc: 0.262 Test Loss: 3.251 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.610382318496704
Epoch: 22, Steps: 17 | Train Loss: 1.049 Vali Loss: 2.605 Vali Acc: 0.281 Test Loss: 2.605 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2889733840304182
model parameter : 412956
model size : 2.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.0396323204040527
Epoch: 1, Steps: 17 | Train Loss: 1.538 Vali Loss: 1.690 Vali Acc: 0.224 Test Loss: 1.690 Test Acc: 0.224
Validation loss decreased (inf --> -0.224318).  Saving model ...
Epoch: 2 cost time: 1.6348049640655518
Epoch: 2, Steps: 17 | Train Loss: 1.539 Vali Loss: 1.411 Vali Acc: 0.278 Test Loss: 1.411 Test Acc: 0.278
Validation loss decreased (-0.224318 --> -0.277552).  Saving model ...
Epoch: 3 cost time: 1.6102395057678223
Epoch: 3, Steps: 17 | Train Loss: 1.453 Vali Loss: 1.434 Vali Acc: 0.274 Test Loss: 1.434 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5190744400024414
Epoch: 4, Steps: 17 | Train Loss: 1.605 Vali Loss: 1.561 Vali Acc: 0.270 Test Loss: 1.561 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.526827096939087
Epoch: 5, Steps: 17 | Train Loss: 1.564 Vali Loss: 1.799 Vali Acc: 0.262 Test Loss: 1.799 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4894726276397705
Epoch: 6, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.902 Vali Acc: 0.251 Test Loss: 1.902 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.6045212745666504
Epoch: 7, Steps: 17 | Train Loss: 1.381 Vali Loss: 1.996 Vali Acc: 0.262 Test Loss: 1.996 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4218025207519531
Epoch: 8, Steps: 17 | Train Loss: 1.588 Vali Loss: 1.623 Vali Acc: 0.255 Test Loss: 1.623 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5183167457580566
Epoch: 9, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.561 Vali Acc: 0.297 Test Loss: 1.561 Test Acc: 0.297
Validation loss decreased (-0.277552 --> -0.296562).  Saving model ...
Epoch: 10 cost time: 1.385347604751587
Epoch: 10, Steps: 17 | Train Loss: 1.370 Vali Loss: 1.946 Vali Acc: 0.319 Test Loss: 1.946 Test Acc: 0.319
Validation loss decreased (-0.296562 --> -0.319372).  Saving model ...
Epoch: 11 cost time: 1.41636061668396
Epoch: 11, Steps: 17 | Train Loss: 1.533 Vali Loss: 2.096 Vali Acc: 0.270 Test Loss: 2.096 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3911278247833252
Epoch: 12, Steps: 17 | Train Loss: 1.579 Vali Loss: 2.355 Vali Acc: 0.289 Test Loss: 2.355 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5432593822479248
Epoch: 13, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.681 Vali Acc: 0.319 Test Loss: 1.681 Test Acc: 0.319
Validation loss decreased (-0.319372 --> -0.319375).  Saving model ...
Epoch: 14 cost time: 1.638185739517212
Epoch: 14, Steps: 17 | Train Loss: 1.247 Vali Loss: 2.101 Vali Acc: 0.293 Test Loss: 2.101 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3100461959838867
Epoch: 15, Steps: 17 | Train Loss: 1.236 Vali Loss: 1.833 Vali Acc: 0.300 Test Loss: 1.833 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5115625858306885
Epoch: 16, Steps: 17 | Train Loss: 1.066 Vali Loss: 2.031 Vali Acc: 0.285 Test Loss: 2.031 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4405224323272705
Epoch: 17, Steps: 17 | Train Loss: 1.034 Vali Loss: 2.377 Vali Acc: 0.281 Test Loss: 2.377 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.573469638824463
Epoch: 18, Steps: 17 | Train Loss: 1.230 Vali Loss: 2.220 Vali Acc: 0.274 Test Loss: 2.220 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.412846565246582
Epoch: 19, Steps: 17 | Train Loss: 1.017 Vali Loss: 2.233 Vali Acc: 0.270 Test Loss: 2.233 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4043235778808594
Epoch: 20, Steps: 17 | Train Loss: 0.872 Vali Loss: 2.241 Vali Acc: 0.346 Test Loss: 2.241 Test Acc: 0.346
Validation loss decreased (-0.319375 --> -0.345985).  Saving model ...
Epoch: 21 cost time: 1.6586310863494873
Epoch: 21, Steps: 17 | Train Loss: 1.085 Vali Loss: 2.374 Vali Acc: 0.297 Test Loss: 2.374 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4478163719177246
Epoch: 22, Steps: 17 | Train Loss: 0.941 Vali Loss: 2.561 Vali Acc: 0.274 Test Loss: 2.561 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.5889630317687988
Epoch: 23, Steps: 17 | Train Loss: 1.071 Vali Loss: 2.524 Vali Acc: 0.281 Test Loss: 2.524 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4500670433044434
Epoch: 24, Steps: 17 | Train Loss: 1.109 Vali Loss: 2.410 Vali Acc: 0.297 Test Loss: 2.410 Test Acc: 0.297
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.5303912162780762
Epoch: 25, Steps: 17 | Train Loss: 1.007 Vali Loss: 2.287 Vali Acc: 0.316 Test Loss: 2.287 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5830142498016357
Epoch: 26, Steps: 17 | Train Loss: 0.801 Vali Loss: 2.810 Vali Acc: 0.308 Test Loss: 2.810 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.3959755897521973
Epoch: 27, Steps: 17 | Train Loss: 0.822 Vali Loss: 2.255 Vali Acc: 0.319 Test Loss: 2.255 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.3886833190917969
Epoch: 28, Steps: 17 | Train Loss: 0.691 Vali Loss: 2.661 Vali Acc: 0.281 Test Loss: 2.661 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.7383801937103271
Epoch: 29, Steps: 17 | Train Loss: 0.785 Vali Loss: 3.106 Vali Acc: 0.289 Test Loss: 3.106 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7297792434692383
Epoch: 30, Steps: 17 | Train Loss: 0.801 Vali Loss: 2.816 Vali Acc: 0.327 Test Loss: 2.816 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34600760456273766
model parameter : 403612
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.875465154647827
Epoch: 1, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.399 Vali Acc: 0.266 Test Loss: 1.399 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.4537997245788574
Epoch: 2, Steps: 17 | Train Loss: 1.467 Vali Loss: 1.485 Vali Acc: 0.262 Test Loss: 1.485 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6238033771514893
Epoch: 3, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.621 Vali Acc: 0.262 Test Loss: 1.621 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.72566819190979
Epoch: 4, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.659 Vali Acc: 0.232 Test Loss: 1.659 Test Acc: 0.232
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.9023993015289307
Epoch: 5, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.501 Vali Acc: 0.285 Test Loss: 1.501 Test Acc: 0.285
Validation loss decreased (-0.266146 --> -0.285156).  Saving model ...
Epoch: 6 cost time: 1.5947153568267822
Epoch: 6, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.483 Vali Acc: 0.270 Test Loss: 1.483 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4425592422485352
Epoch: 7, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.444 Vali Acc: 0.281 Test Loss: 1.444 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6266188621520996
Epoch: 8, Steps: 17 | Train Loss: 1.434 Vali Loss: 1.471 Vali Acc: 0.293 Test Loss: 1.471 Test Acc: 0.293
Validation loss decreased (-0.285156 --> -0.292761).  Saving model ...
Epoch: 9 cost time: 1.4254791736602783
Epoch: 9, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.694 Vali Acc: 0.274 Test Loss: 1.694 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6877734661102295
Epoch: 10, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.489 Vali Acc: 0.270 Test Loss: 1.489 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4652845859527588
Epoch: 11, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.632 Vali Acc: 0.270 Test Loss: 1.632 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.639134407043457
Epoch: 12, Steps: 17 | Train Loss: 1.339 Vali Loss: 1.929 Vali Acc: 0.278 Test Loss: 1.929 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.528484582901001
Epoch: 13, Steps: 17 | Train Loss: 1.216 Vali Loss: 1.649 Vali Acc: 0.308 Test Loss: 1.649 Test Acc: 0.308
Validation loss decreased (-0.292761 --> -0.307968).  Saving model ...
Epoch: 14 cost time: 1.8194410800933838
Epoch: 14, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.734 Vali Acc: 0.259 Test Loss: 1.734 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.6537153720855713
Epoch: 15, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.887 Vali Acc: 0.266 Test Loss: 1.887 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.597691535949707
Epoch: 16, Steps: 17 | Train Loss: 1.201 Vali Loss: 1.600 Vali Acc: 0.285 Test Loss: 1.600 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6826436519622803
Epoch: 17, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.901 Vali Acc: 0.300 Test Loss: 1.901 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6783654689788818
Epoch: 18, Steps: 17 | Train Loss: 1.012 Vali Loss: 2.098 Vali Acc: 0.262 Test Loss: 2.098 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3223025798797607
Epoch: 19, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.900 Vali Acc: 0.278 Test Loss: 1.900 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6476507186889648
Epoch: 20, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.825 Vali Acc: 0.304 Test Loss: 1.825 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4215121269226074
Epoch: 21, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.826 Vali Acc: 0.342 Test Loss: 1.826 Test Acc: 0.342
Validation loss decreased (-0.307968 --> -0.342187).  Saving model ...
Epoch: 22 cost time: 1.4912261962890625
Epoch: 22, Steps: 17 | Train Loss: 0.824 Vali Loss: 2.428 Vali Acc: 0.289 Test Loss: 2.428 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.718665361404419
Epoch: 23, Steps: 17 | Train Loss: 1.010 Vali Loss: 2.041 Vali Acc: 0.308 Test Loss: 2.041 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3771007061004639
Epoch: 24, Steps: 17 | Train Loss: 0.975 Vali Loss: 2.064 Vali Acc: 0.297 Test Loss: 2.064 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8712193965911865
Epoch: 25, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.824 Vali Acc: 0.342 Test Loss: 1.824 Test Acc: 0.342
Validation loss decreased (-0.342187 --> -0.342187).  Saving model ...
Epoch: 26 cost time: 1.7430658340454102
Epoch: 26, Steps: 17 | Train Loss: 0.763 Vali Loss: 2.285 Vali Acc: 0.281 Test Loss: 2.285 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7771580219268799
Epoch: 27, Steps: 17 | Train Loss: 0.714 Vali Loss: 2.186 Vali Acc: 0.281 Test Loss: 2.186 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.586395502090454
Epoch: 28, Steps: 17 | Train Loss: 0.715 Vali Loss: 1.940 Vali Acc: 0.346 Test Loss: 1.940 Test Acc: 0.346
Validation loss decreased (-0.342187 --> -0.345988).  Saving model ...
Epoch: 29 cost time: 1.2127478122711182
Epoch: 29, Steps: 17 | Train Loss: 0.668 Vali Loss: 1.934 Vali Acc: 0.346 Test Loss: 1.934 Test Acc: 0.346
Validation loss decreased (-0.345988 --> -0.345988).  Saving model ...
Epoch: 30 cost time: 1.6376378536224365
Epoch: 30, Steps: 17 | Train Loss: 0.626 Vali Loss: 2.669 Vali Acc: 0.316 Test Loss: 2.669 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.0818588733673096
Epoch: 31, Steps: 17 | Train Loss: 0.707 Vali Loss: 2.299 Vali Acc: 0.376 Test Loss: 2.299 Test Acc: 0.376
Validation loss decreased (-0.345988 --> -0.376403).  Saving model ...
Epoch: 32 cost time: 1.5606865882873535
Epoch: 32, Steps: 17 | Train Loss: 0.639 Vali Loss: 2.539 Vali Acc: 0.338 Test Loss: 2.539 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.8445754051208496
Epoch: 33, Steps: 17 | Train Loss: 0.562 Vali Loss: 2.151 Vali Acc: 0.361 Test Loss: 2.151 Test Acc: 0.361
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7241270542144775
Epoch: 34, Steps: 17 | Train Loss: 0.457 Vali Loss: 2.321 Vali Acc: 0.346 Test Loss: 2.321 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.5460247993469238
Epoch: 35, Steps: 17 | Train Loss: 0.449 Vali Loss: 2.431 Vali Acc: 0.365 Test Loss: 2.431 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.5263028144836426
Epoch: 36, Steps: 17 | Train Loss: 0.607 Vali Loss: 2.417 Vali Acc: 0.376 Test Loss: 2.417 Test Acc: 0.376
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.5007655620574951
Epoch: 37, Steps: 17 | Train Loss: 0.362 Vali Loss: 2.881 Vali Acc: 0.308 Test Loss: 2.881 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.5667896270751953
Epoch: 38, Steps: 17 | Train Loss: 0.686 Vali Loss: 2.472 Vali Acc: 0.369 Test Loss: 2.472 Test Acc: 0.369
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.6511871814727783
Epoch: 39, Steps: 17 | Train Loss: 0.416 Vali Loss: 2.559 Vali Acc: 0.342 Test Loss: 2.559 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.624725341796875
Epoch: 40, Steps: 17 | Train Loss: 0.345 Vali Loss: 2.569 Vali Acc: 0.354 Test Loss: 2.569 Test Acc: 0.354
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.8847200870513916
Epoch: 41, Steps: 17 | Train Loss: 0.356 Vali Loss: 2.891 Vali Acc: 0.384 Test Loss: 2.891 Test Acc: 0.384
Validation loss decreased (-0.376403 --> -0.384002).  Saving model ...
Epoch: 42 cost time: 1.864267349243164
Epoch: 42, Steps: 17 | Train Loss: 0.392 Vali Loss: 2.746 Vali Acc: 0.335 Test Loss: 2.746 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.926135778427124
Epoch: 43, Steps: 17 | Train Loss: 0.273 Vali Loss: 3.168 Vali Acc: 0.338 Test Loss: 3.168 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.690551519393921
Epoch: 44, Steps: 17 | Train Loss: 0.354 Vali Loss: 3.011 Vali Acc: 0.327 Test Loss: 3.011 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 2.0911502838134766
Epoch: 45, Steps: 17 | Train Loss: 0.277 Vali Loss: 3.413 Vali Acc: 0.289 Test Loss: 3.413 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.831167459487915
Epoch: 46, Steps: 17 | Train Loss: 0.321 Vali Loss: 3.107 Vali Acc: 0.350 Test Loss: 3.107 Test Acc: 0.350
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.4624035358428955
Epoch: 47, Steps: 17 | Train Loss: 0.228 Vali Loss: 2.977 Vali Acc: 0.338 Test Loss: 2.977 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 2.1088643074035645
Epoch: 48, Steps: 17 | Train Loss: 0.188 Vali Loss: 3.281 Vali Acc: 0.361 Test Loss: 3.281 Test Acc: 0.361
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.7701263427734375
Epoch: 49, Steps: 17 | Train Loss: 0.193 Vali Loss: 3.301 Vali Acc: 0.361 Test Loss: 3.301 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.587937593460083
Epoch: 50, Steps: 17 | Train Loss: 0.186 Vali Loss: 3.834 Vali Acc: 0.312 Test Loss: 3.834 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.9136126041412354
Epoch: 51, Steps: 17 | Train Loss: 0.205 Vali Loss: 3.476 Vali Acc: 0.342 Test Loss: 3.476 Test Acc: 0.342
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3840304182509506
model parameter : 341596
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.857950210571289
Epoch: 1, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.603 Vali Acc: 0.247 Test Loss: 1.603 Test Acc: 0.247
Validation loss decreased (inf --> -0.247132).  Saving model ...
Epoch: 2 cost time: 1.328648567199707
Epoch: 2, Steps: 17 | Train Loss: 1.597 Vali Loss: 1.427 Vali Acc: 0.243 Test Loss: 1.427 Test Acc: 0.243
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3018300533294678
Epoch: 3, Steps: 17 | Train Loss: 1.391 Vali Loss: 1.460 Vali Acc: 0.270 Test Loss: 1.460 Test Acc: 0.270
Validation loss decreased (-0.247132 --> -0.269947).  Saving model ...
Epoch: 4 cost time: 1.3088366985321045
Epoch: 4, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.654 Vali Acc: 0.221 Test Loss: 1.654 Test Acc: 0.221
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.607391357421875
Epoch: 5, Steps: 17 | Train Loss: 1.559 Vali Loss: 1.679 Vali Acc: 0.247 Test Loss: 1.679 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.671555757522583
Epoch: 6, Steps: 17 | Train Loss: 1.590 Vali Loss: 1.818 Vali Acc: 0.247 Test Loss: 1.818 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.7703378200531006
Epoch: 7, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.409 Vali Acc: 0.304 Test Loss: 1.409 Test Acc: 0.304
Validation loss decreased (-0.269947 --> -0.304168).  Saving model ...
Epoch: 8 cost time: 1.593163013458252
Epoch: 8, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.555 Vali Acc: 0.262 Test Loss: 1.555 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4630482196807861
Epoch: 9, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.477 Vali Acc: 0.266 Test Loss: 1.477 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5973036289215088
Epoch: 10, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.590 Vali Acc: 0.262 Test Loss: 1.590 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6043598651885986
Epoch: 11, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.625 Vali Acc: 0.262 Test Loss: 1.625 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5136656761169434
Epoch: 12, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.845 Vali Acc: 0.281 Test Loss: 1.845 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.637861728668213
Epoch: 13, Steps: 17 | Train Loss: 1.204 Vali Loss: 1.665 Vali Acc: 0.255 Test Loss: 1.665 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6456048488616943
Epoch: 14, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.911 Vali Acc: 0.278 Test Loss: 1.911 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5842175483703613
Epoch: 15, Steps: 17 | Train Loss: 1.095 Vali Loss: 1.737 Vali Acc: 0.312 Test Loss: 1.737 Test Acc: 0.312
Validation loss decreased (-0.304168 --> -0.311770).  Saving model ...
Epoch: 16 cost time: 1.5534539222717285
Epoch: 16, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.785 Vali Acc: 0.323 Test Loss: 1.785 Test Acc: 0.323
Validation loss decreased (-0.311770 --> -0.323176).  Saving model ...
Epoch: 17 cost time: 1.4603009223937988
Epoch: 17, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.874 Vali Acc: 0.319 Test Loss: 1.874 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.6080896854400635
Epoch: 18, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.868 Vali Acc: 0.304 Test Loss: 1.868 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5551128387451172
Epoch: 19, Steps: 17 | Train Loss: 0.830 Vali Loss: 1.877 Vali Acc: 0.335 Test Loss: 1.877 Test Acc: 0.335
Validation loss decreased (-0.323176 --> -0.334582).  Saving model ...
Epoch: 20 cost time: 1.6683955192565918
Epoch: 20, Steps: 17 | Train Loss: 0.893 Vali Loss: 2.016 Vali Acc: 0.300 Test Loss: 2.016 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8223371505737305
Epoch: 21, Steps: 17 | Train Loss: 0.962 Vali Loss: 1.896 Vali Acc: 0.300 Test Loss: 1.896 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.583500623703003
Epoch: 22, Steps: 17 | Train Loss: 0.746 Vali Loss: 2.727 Vali Acc: 0.274 Test Loss: 2.727 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6772205829620361
Epoch: 23, Steps: 17 | Train Loss: 0.894 Vali Loss: 2.432 Vali Acc: 0.285 Test Loss: 2.432 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6242542266845703
Epoch: 24, Steps: 17 | Train Loss: 0.867 Vali Loss: 1.973 Vali Acc: 0.323 Test Loss: 1.973 Test Acc: 0.323
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3334462642669678
Epoch: 25, Steps: 17 | Train Loss: 0.671 Vali Loss: 2.000 Vali Acc: 0.297 Test Loss: 2.000 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3747811317443848
Epoch: 26, Steps: 17 | Train Loss: 0.622 Vali Loss: 2.435 Vali Acc: 0.316 Test Loss: 2.435 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.424379825592041
Epoch: 27, Steps: 17 | Train Loss: 0.661 Vali Loss: 2.162 Vali Acc: 0.338 Test Loss: 2.162 Test Acc: 0.338
Validation loss decreased (-0.334582 --> -0.338381).  Saving model ...
Epoch: 28 cost time: 1.6451356410980225
Epoch: 28, Steps: 17 | Train Loss: 0.658 Vali Loss: 2.308 Vali Acc: 0.357 Test Loss: 2.308 Test Acc: 0.357
Validation loss decreased (-0.338381 --> -0.357391).  Saving model ...
Epoch: 29 cost time: 1.7025392055511475
Epoch: 29, Steps: 17 | Train Loss: 0.595 Vali Loss: 2.023 Vali Acc: 0.331 Test Loss: 2.023 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.372603178024292
Epoch: 30, Steps: 17 | Train Loss: 0.536 Vali Loss: 2.123 Vali Acc: 0.357 Test Loss: 2.123 Test Acc: 0.357
Validation loss decreased (-0.357391 --> -0.357393).  Saving model ...
Epoch: 31 cost time: 1.4790380001068115
Epoch: 31, Steps: 17 | Train Loss: 0.562 Vali Loss: 2.403 Vali Acc: 0.338 Test Loss: 2.403 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.614989995956421
Epoch: 32, Steps: 17 | Train Loss: 0.538 Vali Loss: 2.399 Vali Acc: 0.308 Test Loss: 2.399 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4064655303955078
Epoch: 33, Steps: 17 | Train Loss: 0.367 Vali Loss: 2.398 Vali Acc: 0.346 Test Loss: 2.398 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.606837272644043
Epoch: 34, Steps: 17 | Train Loss: 0.444 Vali Loss: 2.333 Vali Acc: 0.361 Test Loss: 2.333 Test Acc: 0.361
Validation loss decreased (-0.357393 --> -0.361193).  Saving model ...
Epoch: 35 cost time: 1.634361982345581
Epoch: 35, Steps: 17 | Train Loss: 0.460 Vali Loss: 2.470 Vali Acc: 0.342 Test Loss: 2.470 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6013834476470947
Epoch: 36, Steps: 17 | Train Loss: 0.369 Vali Loss: 2.658 Vali Acc: 0.373 Test Loss: 2.658 Test Acc: 0.373
Validation loss decreased (-0.361193 --> -0.372597).  Saving model ...
Epoch: 37 cost time: 1.4977097511291504
Epoch: 37, Steps: 17 | Train Loss: 0.366 Vali Loss: 2.734 Vali Acc: 0.338 Test Loss: 2.734 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6452112197875977
Epoch: 38, Steps: 17 | Train Loss: 0.519 Vali Loss: 3.288 Vali Acc: 0.342 Test Loss: 3.288 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7885446548461914
Epoch: 39, Steps: 17 | Train Loss: 0.603 Vali Loss: 2.825 Vali Acc: 0.289 Test Loss: 2.825 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.7110068798065186
Epoch: 40, Steps: 17 | Train Loss: 0.443 Vali Loss: 2.719 Vali Acc: 0.354 Test Loss: 2.719 Test Acc: 0.354
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.7299392223358154
Epoch: 41, Steps: 17 | Train Loss: 0.377 Vali Loss: 2.762 Vali Acc: 0.342 Test Loss: 2.762 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.646604299545288
Epoch: 42, Steps: 17 | Train Loss: 0.385 Vali Loss: 2.945 Vali Acc: 0.323 Test Loss: 2.945 Test Acc: 0.323
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.3627161979675293
Epoch: 43, Steps: 17 | Train Loss: 0.302 Vali Loss: 3.107 Vali Acc: 0.335 Test Loss: 3.107 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.520031213760376
Epoch: 44, Steps: 17 | Train Loss: 0.304 Vali Loss: 3.195 Vali Acc: 0.335 Test Loss: 3.195 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.8047993183135986
Epoch: 45, Steps: 17 | Train Loss: 0.297 Vali Loss: 2.938 Vali Acc: 0.338 Test Loss: 2.938 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.4421756267547607
Epoch: 46, Steps: 17 | Train Loss: 0.191 Vali Loss: 2.969 Vali Acc: 0.365 Test Loss: 2.969 Test Acc: 0.365
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3726235741444867
model parameter : 336924
model size : 1.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.1801912784576416
Epoch: 1, Steps: 17 | Train Loss: 1.461 Vali Loss: 1.408 Vali Acc: 0.266 Test Loss: 1.408 Test Acc: 0.266
Validation loss decreased (inf --> -0.266146).  Saving model ...
Epoch: 2 cost time: 1.3772063255310059
Epoch: 2, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.428 Vali Acc: 0.270 Test Loss: 1.428 Test Acc: 0.270
Validation loss decreased (-0.266146 --> -0.269948).  Saving model ...
Epoch: 3 cost time: 1.3084602355957031
Epoch: 3, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.471 Vali Acc: 0.281 Test Loss: 1.471 Test Acc: 0.281
Validation loss decreased (-0.269948 --> -0.281354).  Saving model ...
Epoch: 4 cost time: 1.3836188316345215
Epoch: 4, Steps: 17 | Train Loss: 1.517 Vali Loss: 1.588 Vali Acc: 0.274 Test Loss: 1.588 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6448185443878174
Epoch: 5, Steps: 17 | Train Loss: 1.494 Vali Loss: 1.555 Vali Acc: 0.270 Test Loss: 1.555 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4393155574798584
Epoch: 6, Steps: 17 | Train Loss: 1.347 Vali Loss: 1.608 Vali Acc: 0.316 Test Loss: 1.608 Test Acc: 0.316
Validation loss decreased (-0.281354 --> -0.315573).  Saving model ...
Epoch: 7 cost time: 1.5157032012939453
Epoch: 7, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.666 Vali Acc: 0.232 Test Loss: 1.666 Test Acc: 0.232
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6442630290985107
Epoch: 8, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.726 Vali Acc: 0.251 Test Loss: 1.726 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.6951911449432373
Epoch: 9, Steps: 17 | Train Loss: 1.355 Vali Loss: 1.482 Vali Acc: 0.278 Test Loss: 1.482 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5582001209259033
Epoch: 10, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.494 Vali Acc: 0.308 Test Loss: 1.494 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6052112579345703
Epoch: 11, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.568 Vali Acc: 0.278 Test Loss: 1.568 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.6683626174926758
Epoch: 12, Steps: 17 | Train Loss: 1.226 Vali Loss: 2.037 Vali Acc: 0.255 Test Loss: 2.037 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4268417358398438
Epoch: 13, Steps: 17 | Train Loss: 1.507 Vali Loss: 1.854 Vali Acc: 0.262 Test Loss: 1.854 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4977467060089111
Epoch: 14, Steps: 17 | Train Loss: 1.202 Vali Loss: 1.849 Vali Acc: 0.259 Test Loss: 1.849 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.5876779556274414
Epoch: 15, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.667 Vali Acc: 0.262 Test Loss: 1.667 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4855029582977295
Epoch: 16, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.991 Vali Acc: 0.270 Test Loss: 1.991 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3155893536121673
model parameter : 332252
model size : 1.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.4671504497528076
Epoch: 1, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.559 Vali Acc: 0.274 Test Loss: 1.559 Test Acc: 0.274
Validation loss decreased (inf --> -0.273749).  Saving model ...
Epoch: 2 cost time: 1.6755621433258057
Epoch: 2, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.891 Vali Acc: 0.281 Test Loss: 1.891 Test Acc: 0.281
Validation loss decreased (-0.273749 --> -0.281350).  Saving model ...
Epoch: 3 cost time: 1.5613725185394287
Epoch: 3, Steps: 17 | Train Loss: 1.826 Vali Loss: 1.448 Vali Acc: 0.274 Test Loss: 1.448 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4578709602355957
Epoch: 4, Steps: 17 | Train Loss: 1.717 Vali Loss: 1.442 Vali Acc: 0.281 Test Loss: 1.442 Test Acc: 0.281
Validation loss decreased (-0.281350 --> -0.281354).  Saving model ...
Epoch: 5 cost time: 1.4892964363098145
Epoch: 5, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.534 Vali Acc: 0.259 Test Loss: 1.534 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3751122951507568
Epoch: 6, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.605 Vali Acc: 0.262 Test Loss: 1.605 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5260365009307861
Epoch: 7, Steps: 17 | Train Loss: 1.362 Vali Loss: 1.489 Vali Acc: 0.240 Test Loss: 1.489 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5349769592285156
Epoch: 8, Steps: 17 | Train Loss: 1.349 Vali Loss: 1.674 Vali Acc: 0.255 Test Loss: 1.674 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7182493209838867
Epoch: 9, Steps: 17 | Train Loss: 1.357 Vali Loss: 1.494 Vali Acc: 0.247 Test Loss: 1.494 Test Acc: 0.247
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.560913324356079
Epoch: 10, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.745 Vali Acc: 0.266 Test Loss: 1.745 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.701050043106079
Epoch: 11, Steps: 17 | Train Loss: 1.274 Vali Loss: 1.659 Vali Acc: 0.278 Test Loss: 1.659 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3575305938720703
Epoch: 12, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.662 Vali Acc: 0.266 Test Loss: 1.662 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3679027557373047
Epoch: 13, Steps: 17 | Train Loss: 1.253 Vali Loss: 1.666 Vali Acc: 0.281 Test Loss: 1.666 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.6626989841461182
Epoch: 14, Steps: 17 | Train Loss: 1.056 Vali Loss: 1.716 Vali Acc: 0.297 Test Loss: 1.716 Test Acc: 0.297
Validation loss decreased (-0.281354 --> -0.296561).  Saving model ...
Epoch: 15 cost time: 1.3480443954467773
Epoch: 15, Steps: 17 | Train Loss: 1.121 Vali Loss: 2.098 Vali Acc: 0.278 Test Loss: 2.098 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5097620487213135
Epoch: 16, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.728 Vali Acc: 0.274 Test Loss: 1.728 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6346242427825928
Epoch: 17, Steps: 17 | Train Loss: 0.962 Vali Loss: 1.960 Vali Acc: 0.262 Test Loss: 1.960 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.465545415878296
Epoch: 18, Steps: 17 | Train Loss: 1.099 Vali Loss: 2.413 Vali Acc: 0.281 Test Loss: 2.413 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.619159460067749
Epoch: 19, Steps: 17 | Train Loss: 1.004 Vali Loss: 2.243 Vali Acc: 0.285 Test Loss: 2.243 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.350076675415039
Epoch: 20, Steps: 17 | Train Loss: 1.036 Vali Loss: 2.216 Vali Acc: 0.281 Test Loss: 2.216 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3657057285308838
Epoch: 21, Steps: 17 | Train Loss: 0.863 Vali Loss: 1.910 Vali Acc: 0.304 Test Loss: 1.910 Test Acc: 0.304
Validation loss decreased (-0.296561 --> -0.304163).  Saving model ...
Epoch: 22 cost time: 1.548177719116211
Epoch: 22, Steps: 17 | Train Loss: 0.789 Vali Loss: 2.128 Vali Acc: 0.281 Test Loss: 2.128 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.529902696609497
Epoch: 23, Steps: 17 | Train Loss: 1.028 Vali Loss: 2.109 Vali Acc: 0.304 Test Loss: 2.109 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.6472606658935547
Epoch: 24, Steps: 17 | Train Loss: 0.955 Vali Loss: 2.304 Vali Acc: 0.300 Test Loss: 2.304 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5777392387390137
Epoch: 25, Steps: 17 | Train Loss: 0.934 Vali Loss: 2.199 Vali Acc: 0.289 Test Loss: 2.199 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4428935050964355
Epoch: 26, Steps: 17 | Train Loss: 0.675 Vali Loss: 2.057 Vali Acc: 0.335 Test Loss: 2.057 Test Acc: 0.335
Validation loss decreased (-0.304163 --> -0.334580).  Saving model ...
Epoch: 27 cost time: 1.3882355690002441
Epoch: 27, Steps: 17 | Train Loss: 0.599 Vali Loss: 2.355 Vali Acc: 0.297 Test Loss: 2.355 Test Acc: 0.297
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4467339515686035
Epoch: 28, Steps: 17 | Train Loss: 0.566 Vali Loss: 2.128 Vali Acc: 0.312 Test Loss: 2.128 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.307021141052246
Epoch: 29, Steps: 17 | Train Loss: 0.555 Vali Loss: 2.189 Vali Acc: 0.319 Test Loss: 2.189 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.394270420074463
Epoch: 30, Steps: 17 | Train Loss: 0.583 Vali Loss: 2.460 Vali Acc: 0.342 Test Loss: 2.460 Test Acc: 0.342
Validation loss decreased (-0.334580 --> -0.342181).  Saving model ...
Epoch: 31 cost time: 1.4019083976745605
Epoch: 31, Steps: 17 | Train Loss: 0.794 Vali Loss: 2.168 Vali Acc: 0.331 Test Loss: 2.168 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2884464263916016
Epoch: 32, Steps: 17 | Train Loss: 0.596 Vali Loss: 2.380 Vali Acc: 0.312 Test Loss: 2.380 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4385340213775635
Epoch: 33, Steps: 17 | Train Loss: 0.509 Vali Loss: 2.615 Vali Acc: 0.300 Test Loss: 2.615 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.4646389484405518
Epoch: 34, Steps: 17 | Train Loss: 0.470 Vali Loss: 2.676 Vali Acc: 0.354 Test Loss: 2.676 Test Acc: 0.354
Validation loss decreased (-0.342181 --> -0.353585).  Saving model ...
Epoch: 35 cost time: 1.4270331859588623
Epoch: 35, Steps: 17 | Train Loss: 0.737 Vali Loss: 3.122 Vali Acc: 0.308 Test Loss: 3.122 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7218124866485596
Epoch: 36, Steps: 17 | Train Loss: 0.578 Vali Loss: 2.845 Vali Acc: 0.346 Test Loss: 2.845 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.4444129467010498
Epoch: 37, Steps: 17 | Train Loss: 0.499 Vali Loss: 2.439 Vali Acc: 0.338 Test Loss: 2.439 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.4155476093292236
Epoch: 38, Steps: 17 | Train Loss: 0.335 Vali Loss: 2.484 Vali Acc: 0.316 Test Loss: 2.484 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.3895320892333984
Epoch: 39, Steps: 17 | Train Loss: 0.378 Vali Loss: 3.114 Vali Acc: 0.316 Test Loss: 3.114 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.5540964603424072
Epoch: 40, Steps: 17 | Train Loss: 0.414 Vali Loss: 2.546 Vali Acc: 0.376 Test Loss: 2.546 Test Acc: 0.376
Validation loss decreased (-0.353585 --> -0.376400).  Saving model ...
Epoch: 41 cost time: 1.4489004611968994
Epoch: 41, Steps: 17 | Train Loss: 0.366 Vali Loss: 2.742 Vali Acc: 0.331 Test Loss: 2.742 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.5090198516845703
Epoch: 42, Steps: 17 | Train Loss: 0.275 Vali Loss: 3.048 Vali Acc: 0.316 Test Loss: 3.048 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.4355974197387695
Epoch: 43, Steps: 17 | Train Loss: 0.285 Vali Loss: 3.086 Vali Acc: 0.395 Test Loss: 3.086 Test Acc: 0.395
Validation loss decreased (-0.376400 --> -0.395406).  Saving model ...
Epoch: 44 cost time: 1.489927053451538
Epoch: 44, Steps: 17 | Train Loss: 0.441 Vali Loss: 3.036 Vali Acc: 0.346 Test Loss: 3.036 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.402916669845581
Epoch: 45, Steps: 17 | Train Loss: 0.320 Vali Loss: 3.148 Vali Acc: 0.316 Test Loss: 3.148 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.439208745956421
Epoch: 46, Steps: 17 | Train Loss: 0.257 Vali Loss: 3.144 Vali Acc: 0.346 Test Loss: 3.144 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.5849347114562988
Epoch: 47, Steps: 17 | Train Loss: 0.239 Vali Loss: 3.498 Vali Acc: 0.335 Test Loss: 3.498 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.1938657760620117
Epoch: 48, Steps: 17 | Train Loss: 0.293 Vali Loss: 3.422 Vali Acc: 0.335 Test Loss: 3.422 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.4379734992980957
Epoch: 49, Steps: 17 | Train Loss: 0.244 Vali Loss: 3.324 Vali Acc: 0.342 Test Loss: 3.324 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.3543119430541992
Epoch: 50, Steps: 17 | Train Loss: 0.220 Vali Loss: 3.462 Vali Acc: 0.354 Test Loss: 3.462 Test Acc: 0.354
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.585418701171875
Epoch: 51, Steps: 17 | Train Loss: 0.263 Vali Loss: 4.045 Vali Acc: 0.293 Test Loss: 4.045 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.3986024856567383
Epoch: 52, Steps: 17 | Train Loss: 0.217 Vali Loss: 3.559 Vali Acc: 0.350 Test Loss: 3.559 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.7224931716918945
Epoch: 53, Steps: 17 | Train Loss: 0.273 Vali Loss: 3.682 Vali Acc: 0.316 Test Loss: 3.682 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.39543726235741444
model parameter : 327580
model size : 1.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.65771222114563
Epoch: 1, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.488 Vali Acc: 0.255 Test Loss: 1.488 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 1.565150499343872
Epoch: 2, Steps: 17 | Train Loss: 1.458 Vali Loss: 1.591 Vali Acc: 0.247 Test Loss: 1.591 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7502291202545166
Epoch: 3, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.637 Vali Acc: 0.266 Test Loss: 1.637 Test Acc: 0.266
Validation loss decreased (-0.254738 --> -0.266143).  Saving model ...
Epoch: 4 cost time: 1.6552586555480957
Epoch: 4, Steps: 17 | Train Loss: 1.528 Vali Loss: 1.605 Vali Acc: 0.270 Test Loss: 1.605 Test Acc: 0.270
Validation loss decreased (-0.266143 --> -0.269946).  Saving model ...
Epoch: 5 cost time: 1.5864613056182861
Epoch: 5, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.452 Vali Acc: 0.259 Test Loss: 1.452 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6553754806518555
Epoch: 6, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.486 Vali Acc: 0.278 Test Loss: 1.486 Test Acc: 0.278
Validation loss decreased (-0.269946 --> -0.277552).  Saving model ...
Epoch: 7 cost time: 1.554224967956543
Epoch: 7, Steps: 17 | Train Loss: 1.510 Vali Loss: 2.065 Vali Acc: 0.262 Test Loss: 2.065 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6283786296844482
Epoch: 8, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.563 Vali Acc: 0.274 Test Loss: 1.563 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4537649154663086
Epoch: 9, Steps: 17 | Train Loss: 1.452 Vali Loss: 1.688 Vali Acc: 0.316 Test Loss: 1.688 Test Acc: 0.316
Validation loss decreased (-0.277552 --> -0.315572).  Saving model ...
Epoch: 10 cost time: 1.8986077308654785
Epoch: 10, Steps: 17 | Train Loss: 1.425 Vali Loss: 1.707 Vali Acc: 0.266 Test Loss: 1.707 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.842505931854248
Epoch: 11, Steps: 17 | Train Loss: 1.432 Vali Loss: 1.484 Vali Acc: 0.285 Test Loss: 1.484 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.416522741317749
Epoch: 12, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.544 Vali Acc: 0.293 Test Loss: 1.544 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.4776089191436768
Epoch: 13, Steps: 17 | Train Loss: 1.168 Vali Loss: 1.754 Vali Acc: 0.270 Test Loss: 1.754 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.7196428775787354
Epoch: 14, Steps: 17 | Train Loss: 1.310 Vali Loss: 1.645 Vali Acc: 0.274 Test Loss: 1.645 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6738474369049072
Epoch: 15, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.637 Vali Acc: 0.335 Test Loss: 1.637 Test Acc: 0.335
Validation loss decreased (-0.315572 --> -0.334584).  Saving model ...
Epoch: 16 cost time: 1.7205746173858643
Epoch: 16, Steps: 17 | Train Loss: 1.135 Vali Loss: 2.095 Vali Acc: 0.251 Test Loss: 2.095 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4232747554779053
Epoch: 17, Steps: 17 | Train Loss: 1.156 Vali Loss: 2.178 Vali Acc: 0.255 Test Loss: 2.178 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7003734111785889
Epoch: 18, Steps: 17 | Train Loss: 1.065 Vali Loss: 2.257 Vali Acc: 0.255 Test Loss: 2.257 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5486383438110352
Epoch: 19, Steps: 17 | Train Loss: 1.055 Vali Loss: 1.892 Vali Acc: 0.281 Test Loss: 1.892 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7726705074310303
Epoch: 20, Steps: 17 | Train Loss: 1.049 Vali Loss: 1.931 Vali Acc: 0.304 Test Loss: 1.931 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5839922428131104
Epoch: 21, Steps: 17 | Train Loss: 0.897 Vali Loss: 1.881 Vali Acc: 0.300 Test Loss: 1.881 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.5941596031188965
Epoch: 22, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.810 Vali Acc: 0.293 Test Loss: 1.810 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5395357608795166
Epoch: 23, Steps: 17 | Train Loss: 0.837 Vali Loss: 2.154 Vali Acc: 0.259 Test Loss: 2.154 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5550744533538818
Epoch: 24, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.872 Vali Acc: 0.335 Test Loss: 1.872 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.649366855621338
Epoch: 25, Steps: 17 | Train Loss: 0.763 Vali Loss: 2.445 Vali Acc: 0.270 Test Loss: 2.445 Test Acc: 0.270
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.33460076045627374
model parameter : 241756
model size : 1.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5688908100128174
Epoch: 1, Steps: 17 | Train Loss: 1.531 Vali Loss: 1.411 Vali Acc: 0.251 Test Loss: 1.411 Test Acc: 0.251
Validation loss decreased (inf --> -0.250936).  Saving model ...
Epoch: 2 cost time: 1.411229133605957
Epoch: 2, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.420 Vali Acc: 0.240 Test Loss: 1.420 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3338632583618164
Epoch: 3, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.392 Vali Acc: 0.293 Test Loss: 1.392 Test Acc: 0.293
Validation loss decreased (-0.250936 --> -0.292762).  Saving model ...
Epoch: 4 cost time: 1.4719185829162598
Epoch: 4, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.713 Vali Acc: 0.281 Test Loss: 1.713 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5708212852478027
Epoch: 5, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.464 Vali Acc: 0.251 Test Loss: 1.464 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7779510021209717
Epoch: 6, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.737 Vali Acc: 0.259 Test Loss: 1.737 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.6960599422454834
Epoch: 7, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.677 Vali Acc: 0.270 Test Loss: 1.677 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.8436379432678223
Epoch: 8, Steps: 17 | Train Loss: 1.344 Vali Loss: 1.620 Vali Acc: 0.289 Test Loss: 1.620 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.685136079788208
Epoch: 9, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.493 Vali Acc: 0.297 Test Loss: 1.493 Test Acc: 0.297
Validation loss decreased (-0.292762 --> -0.296563).  Saving model ...
Epoch: 10 cost time: 1.618870735168457
Epoch: 10, Steps: 17 | Train Loss: 1.220 Vali Loss: 1.600 Vali Acc: 0.285 Test Loss: 1.600 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7347753047943115
Epoch: 11, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.772 Vali Acc: 0.266 Test Loss: 1.772 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0930144786834717
Epoch: 12, Steps: 17 | Train Loss: 1.223 Vali Loss: 1.860 Vali Acc: 0.259 Test Loss: 1.860 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8197789192199707
Epoch: 13, Steps: 17 | Train Loss: 1.099 Vali Loss: 1.683 Vali Acc: 0.262 Test Loss: 1.683 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6154203414916992
Epoch: 14, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.879 Vali Acc: 0.300 Test Loss: 1.879 Test Acc: 0.300
Validation loss decreased (-0.296563 --> -0.300361).  Saving model ...
Epoch: 15 cost time: 1.6415364742279053
Epoch: 15, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.859 Vali Acc: 0.285 Test Loss: 1.859 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7904973030090332
Epoch: 16, Steps: 17 | Train Loss: 1.003 Vali Loss: 1.919 Vali Acc: 0.281 Test Loss: 1.919 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4946651458740234
Epoch: 17, Steps: 17 | Train Loss: 1.167 Vali Loss: 1.920 Vali Acc: 0.262 Test Loss: 1.920 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.61385178565979
Epoch: 18, Steps: 17 | Train Loss: 0.971 Vali Loss: 2.212 Vali Acc: 0.281 Test Loss: 2.212 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6235251426696777
Epoch: 19, Steps: 17 | Train Loss: 1.033 Vali Loss: 2.225 Vali Acc: 0.285 Test Loss: 2.225 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.608269214630127
Epoch: 20, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.981 Vali Acc: 0.274 Test Loss: 1.981 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5746145248413086
Epoch: 21, Steps: 17 | Train Loss: 1.112 Vali Loss: 2.325 Vali Acc: 0.262 Test Loss: 2.325 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6148004531860352
Epoch: 22, Steps: 17 | Train Loss: 0.892 Vali Loss: 2.218 Vali Acc: 0.308 Test Loss: 2.218 Test Acc: 0.308
Validation loss decreased (-0.300361 --> -0.307963).  Saving model ...
Epoch: 23 cost time: 1.6305813789367676
Epoch: 23, Steps: 17 | Train Loss: 0.872 Vali Loss: 2.074 Vali Acc: 0.278 Test Loss: 2.074 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6105425357818604
Epoch: 24, Steps: 17 | Train Loss: 0.907 Vali Loss: 2.058 Vali Acc: 0.308 Test Loss: 2.058 Test Acc: 0.308
Validation loss decreased (-0.307963 --> -0.307964).  Saving model ...
Epoch: 25 cost time: 1.5512549877166748
Epoch: 25, Steps: 17 | Train Loss: 0.750 Vali Loss: 2.034 Vali Acc: 0.312 Test Loss: 2.034 Test Acc: 0.312
Validation loss decreased (-0.307964 --> -0.311767).  Saving model ...
Epoch: 26 cost time: 1.595179557800293
Epoch: 26, Steps: 17 | Train Loss: 0.775 Vali Loss: 2.549 Vali Acc: 0.289 Test Loss: 2.549 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5817010402679443
Epoch: 27, Steps: 17 | Train Loss: 0.790 Vali Loss: 2.452 Vali Acc: 0.312 Test Loss: 2.452 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5266203880310059
Epoch: 28, Steps: 17 | Train Loss: 0.640 Vali Loss: 2.321 Vali Acc: 0.281 Test Loss: 2.321 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.609255075454712
Epoch: 29, Steps: 17 | Train Loss: 0.669 Vali Loss: 2.185 Vali Acc: 0.342 Test Loss: 2.185 Test Acc: 0.342
Validation loss decreased (-0.311767 --> -0.342183).  Saving model ...
Epoch: 30 cost time: 1.5254440307617188
Epoch: 30, Steps: 17 | Train Loss: 0.558 Vali Loss: 2.294 Vali Acc: 0.316 Test Loss: 2.294 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.7081701755523682
Epoch: 31, Steps: 17 | Train Loss: 0.525 Vali Loss: 2.221 Vali Acc: 0.331 Test Loss: 2.221 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.873340368270874
Epoch: 32, Steps: 17 | Train Loss: 0.489 Vali Loss: 2.221 Vali Acc: 0.346 Test Loss: 2.221 Test Acc: 0.346
Validation loss decreased (-0.342183 --> -0.345985).  Saving model ...
Epoch: 33 cost time: 1.5143966674804688
Epoch: 33, Steps: 17 | Train Loss: 0.479 Vali Loss: 2.375 Vali Acc: 0.338 Test Loss: 2.375 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.5788846015930176
Epoch: 34, Steps: 17 | Train Loss: 0.508 Vali Loss: 2.420 Vali Acc: 0.323 Test Loss: 2.420 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.405287265777588
Epoch: 35, Steps: 17 | Train Loss: 0.476 Vali Loss: 2.489 Vali Acc: 0.346 Test Loss: 2.489 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.328942060470581
Epoch: 36, Steps: 17 | Train Loss: 0.598 Vali Loss: 2.525 Vali Acc: 0.335 Test Loss: 2.525 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.595623254776001
Epoch: 37, Steps: 17 | Train Loss: 0.572 Vali Loss: 2.771 Vali Acc: 0.357 Test Loss: 2.771 Test Acc: 0.357
Validation loss decreased (-0.345985 --> -0.357387).  Saving model ...
Epoch: 38 cost time: 1.7081191539764404
Epoch: 38, Steps: 17 | Train Loss: 0.438 Vali Loss: 2.652 Vali Acc: 0.369 Test Loss: 2.652 Test Acc: 0.369
Validation loss decreased (-0.357387 --> -0.368795).  Saving model ...
Epoch: 39 cost time: 1.4661717414855957
Epoch: 39, Steps: 17 | Train Loss: 0.429 Vali Loss: 2.830 Vali Acc: 0.323 Test Loss: 2.830 Test Acc: 0.323
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6753668785095215
Epoch: 40, Steps: 17 | Train Loss: 0.368 Vali Loss: 2.821 Vali Acc: 0.327 Test Loss: 2.821 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.720266580581665
Epoch: 41, Steps: 17 | Train Loss: 0.358 Vali Loss: 2.725 Vali Acc: 0.335 Test Loss: 2.725 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.664693832397461
Epoch: 42, Steps: 17 | Train Loss: 0.464 Vali Loss: 3.177 Vali Acc: 0.323 Test Loss: 3.177 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.6703832149505615
Epoch: 43, Steps: 17 | Train Loss: 0.307 Vali Loss: 2.816 Vali Acc: 0.376 Test Loss: 2.816 Test Acc: 0.376
Validation loss decreased (-0.368795 --> -0.376398).  Saving model ...
Epoch: 44 cost time: 1.6190330982208252
Epoch: 44, Steps: 17 | Train Loss: 0.353 Vali Loss: 3.217 Vali Acc: 0.338 Test Loss: 3.217 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.6709020137786865
Epoch: 45, Steps: 17 | Train Loss: 0.405 Vali Loss: 3.113 Vali Acc: 0.323 Test Loss: 3.113 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.6724932193756104
Epoch: 46, Steps: 17 | Train Loss: 0.368 Vali Loss: 2.882 Vali Acc: 0.312 Test Loss: 2.882 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.6104931831359863
Epoch: 47, Steps: 17 | Train Loss: 0.209 Vali Loss: 3.052 Vali Acc: 0.346 Test Loss: 3.052 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.5370757579803467
Epoch: 48, Steps: 17 | Train Loss: 0.200 Vali Loss: 2.989 Vali Acc: 0.346 Test Loss: 2.989 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.5449564456939697
Epoch: 49, Steps: 17 | Train Loss: 0.231 Vali Loss: 3.132 Vali Acc: 0.350 Test Loss: 3.132 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.4986822605133057
Epoch: 50, Steps: 17 | Train Loss: 0.192 Vali Loss: 3.402 Vali Acc: 0.376 Test Loss: 3.402 Test Acc: 0.376
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 1.5097205638885498
Epoch: 51, Steps: 17 | Train Loss: 0.208 Vali Loss: 3.406 Vali Acc: 0.342 Test Loss: 3.406 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 1.4078648090362549
Epoch: 52, Steps: 17 | Train Loss: 0.191 Vali Loss: 3.343 Vali Acc: 0.342 Test Loss: 3.343 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.5587637424468994
Epoch: 53, Steps: 17 | Train Loss: 0.220 Vali Loss: 3.379 Vali Acc: 0.338 Test Loss: 3.379 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.376425855513308
model parameter : 237084
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.364384651184082
Epoch: 1, Steps: 17 | Train Loss: 1.558 Vali Loss: 1.570 Vali Acc: 0.247 Test Loss: 1.570 Test Acc: 0.247
Validation loss decreased (inf --> -0.247133).  Saving model ...
Epoch: 2 cost time: 1.761430263519287
Epoch: 2, Steps: 17 | Train Loss: 1.537 Vali Loss: 1.602 Vali Acc: 0.247 Test Loss: 1.602 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.686645269393921
Epoch: 3, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.594 Vali Acc: 0.255 Test Loss: 1.594 Test Acc: 0.255
Validation loss decreased (-0.247133 --> -0.254737).  Saving model ...
Epoch: 4 cost time: 1.4914515018463135
Epoch: 4, Steps: 17 | Train Loss: 1.396 Vali Loss: 1.424 Vali Acc: 0.259 Test Loss: 1.424 Test Acc: 0.259
Validation loss decreased (-0.254737 --> -0.258541).  Saving model ...
Epoch: 5 cost time: 1.437178373336792
Epoch: 5, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.518 Vali Acc: 0.259 Test Loss: 1.518 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6120452880859375
Epoch: 6, Steps: 17 | Train Loss: 1.438 Vali Loss: 1.448 Vali Acc: 0.266 Test Loss: 1.448 Test Acc: 0.266
Validation loss decreased (-0.258541 --> -0.266145).  Saving model ...
Epoch: 7 cost time: 1.4580268859863281
Epoch: 7, Steps: 17 | Train Loss: 1.412 Vali Loss: 1.453 Vali Acc: 0.274 Test Loss: 1.453 Test Acc: 0.274
Validation loss decreased (-0.266145 --> -0.273750).  Saving model ...
Epoch: 8 cost time: 1.5839436054229736
Epoch: 8, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.510 Vali Acc: 0.266 Test Loss: 1.510 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5108213424682617
Epoch: 9, Steps: 17 | Train Loss: 1.404 Vali Loss: 1.445 Vali Acc: 0.274 Test Loss: 1.445 Test Acc: 0.274
Validation loss decreased (-0.273750 --> -0.273750).  Saving model ...
Epoch: 10 cost time: 1.588789939880371
Epoch: 10, Steps: 17 | Train Loss: 1.286 Vali Loss: 1.472 Vali Acc: 0.289 Test Loss: 1.472 Test Acc: 0.289
Validation loss decreased (-0.273750 --> -0.288959).  Saving model ...
Epoch: 11 cost time: 1.6171338558197021
Epoch: 11, Steps: 17 | Train Loss: 1.576 Vali Loss: 1.955 Vali Acc: 0.259 Test Loss: 1.955 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5095326900482178
Epoch: 12, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.819 Vali Acc: 0.259 Test Loss: 1.819 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7521109580993652
Epoch: 13, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.821 Vali Acc: 0.259 Test Loss: 1.821 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5780112743377686
Epoch: 14, Steps: 17 | Train Loss: 1.147 Vali Loss: 1.629 Vali Acc: 0.312 Test Loss: 1.629 Test Acc: 0.312
Validation loss decreased (-0.288959 --> -0.311771).  Saving model ...
Epoch: 15 cost time: 1.674858570098877
Epoch: 15, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.602 Vali Acc: 0.300 Test Loss: 1.602 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7602384090423584
Epoch: 16, Steps: 17 | Train Loss: 1.202 Vali Loss: 2.295 Vali Acc: 0.251 Test Loss: 2.295 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.049307107925415
Epoch: 17, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.774 Vali Acc: 0.274 Test Loss: 1.774 Test Acc: 0.274
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6457865238189697
Epoch: 18, Steps: 17 | Train Loss: 1.032 Vali Loss: 1.737 Vali Acc: 0.308 Test Loss: 1.737 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6743652820587158
Epoch: 19, Steps: 17 | Train Loss: 1.001 Vali Loss: 1.908 Vali Acc: 0.278 Test Loss: 1.908 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.622448205947876
Epoch: 20, Steps: 17 | Train Loss: 0.948 Vali Loss: 2.158 Vali Acc: 0.255 Test Loss: 2.158 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.4746828079223633
Epoch: 21, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.799 Vali Acc: 0.319 Test Loss: 1.799 Test Acc: 0.319
Validation loss decreased (-0.311771 --> -0.319374).  Saving model ...
Epoch: 22 cost time: 1.4574298858642578
Epoch: 22, Steps: 17 | Train Loss: 0.840 Vali Loss: 2.287 Vali Acc: 0.274 Test Loss: 2.287 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3992860317230225
Epoch: 23, Steps: 17 | Train Loss: 0.800 Vali Loss: 2.163 Vali Acc: 0.285 Test Loss: 2.163 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4084587097167969
Epoch: 24, Steps: 17 | Train Loss: 0.755 Vali Loss: 2.073 Vali Acc: 0.319 Test Loss: 2.073 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5332422256469727
Epoch: 25, Steps: 17 | Train Loss: 0.797 Vali Loss: 2.054 Vali Acc: 0.342 Test Loss: 2.054 Test Acc: 0.342
Validation loss decreased (-0.319374 --> -0.342185).  Saving model ...
Epoch: 26 cost time: 1.4119234085083008
Epoch: 26, Steps: 17 | Train Loss: 0.737 Vali Loss: 2.007 Vali Acc: 0.319 Test Loss: 2.007 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.589968204498291
Epoch: 27, Steps: 17 | Train Loss: 0.654 Vali Loss: 2.140 Vali Acc: 0.323 Test Loss: 2.140 Test Acc: 0.323
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5829129219055176
Epoch: 28, Steps: 17 | Train Loss: 0.661 Vali Loss: 2.109 Vali Acc: 0.304 Test Loss: 2.109 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5346925258636475
Epoch: 29, Steps: 17 | Train Loss: 0.809 Vali Loss: 2.350 Vali Acc: 0.331 Test Loss: 2.350 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.6286699771881104
Epoch: 30, Steps: 17 | Train Loss: 0.697 Vali Loss: 2.653 Vali Acc: 0.304 Test Loss: 2.653 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.59967041015625
Epoch: 31, Steps: 17 | Train Loss: 0.604 Vali Loss: 2.863 Vali Acc: 0.293 Test Loss: 2.863 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.6652274131774902
Epoch: 32, Steps: 17 | Train Loss: 0.793 Vali Loss: 2.141 Vali Acc: 0.331 Test Loss: 2.141 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.436729907989502
Epoch: 33, Steps: 17 | Train Loss: 0.627 Vali Loss: 2.381 Vali Acc: 0.304 Test Loss: 2.381 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.32248854637146
Epoch: 34, Steps: 17 | Train Loss: 0.551 Vali Loss: 2.558 Vali Acc: 0.338 Test Loss: 2.558 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.311781644821167
Epoch: 35, Steps: 17 | Train Loss: 0.637 Vali Loss: 2.746 Vali Acc: 0.331 Test Loss: 2.746 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.34220532319391633
model parameter : 232412
model size : 1.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 2.6583092212677
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.482 Vali Acc: 0.259 Test Loss: 1.482 Test Acc: 0.259
Validation loss decreased (inf --> -0.258540).  Saving model ...
Epoch: 2 cost time: 1.115138053894043
Epoch: 2, Steps: 17 | Train Loss: 1.521 Vali Loss: 1.711 Vali Acc: 0.247 Test Loss: 1.711 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.273099660873413
Epoch: 3, Steps: 17 | Train Loss: 1.503 Vali Loss: 1.472 Vali Acc: 0.255 Test Loss: 1.472 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.407301902770996
Epoch: 4, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.799 Vali Acc: 0.251 Test Loss: 1.799 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4275612831115723
Epoch: 5, Steps: 17 | Train Loss: 1.516 Vali Loss: 1.533 Vali Acc: 0.251 Test Loss: 1.533 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3998126983642578
Epoch: 6, Steps: 17 | Train Loss: 1.395 Vali Loss: 1.454 Vali Acc: 0.270 Test Loss: 1.454 Test Acc: 0.270
Validation loss decreased (-0.258540 --> -0.269947).  Saving model ...
Epoch: 7 cost time: 1.4041049480438232
Epoch: 7, Steps: 17 | Train Loss: 1.368 Vali Loss: 1.550 Vali Acc: 0.262 Test Loss: 1.550 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.399341106414795
Epoch: 8, Steps: 17 | Train Loss: 1.722 Vali Loss: 1.573 Vali Acc: 0.247 Test Loss: 1.573 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5254700183868408
Epoch: 9, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.580 Vali Acc: 0.285 Test Loss: 1.580 Test Acc: 0.285
Validation loss decreased (-0.269947 --> -0.285155).  Saving model ...
Epoch: 10 cost time: 1.406787633895874
Epoch: 10, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.586 Vali Acc: 0.274 Test Loss: 1.586 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2754316329956055
Epoch: 11, Steps: 17 | Train Loss: 1.338 Vali Loss: 1.487 Vali Acc: 0.285 Test Loss: 1.487 Test Acc: 0.285
Validation loss decreased (-0.285155 --> -0.285156).  Saving model ...
Epoch: 12 cost time: 1.5142631530761719
Epoch: 12, Steps: 17 | Train Loss: 1.146 Vali Loss: 1.523 Vali Acc: 0.278 Test Loss: 1.523 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5233523845672607
Epoch: 13, Steps: 17 | Train Loss: 1.333 Vali Loss: 2.303 Vali Acc: 0.259 Test Loss: 2.303 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7467081546783447
Epoch: 14, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.665 Vali Acc: 0.247 Test Loss: 1.665 Test Acc: 0.247
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5475068092346191
Epoch: 15, Steps: 17 | Train Loss: 1.198 Vali Loss: 2.192 Vali Acc: 0.259 Test Loss: 2.192 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4767062664031982
Epoch: 16, Steps: 17 | Train Loss: 1.129 Vali Loss: 1.988 Vali Acc: 0.243 Test Loss: 1.988 Test Acc: 0.243
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.4344613552093506
Epoch: 17, Steps: 17 | Train Loss: 1.156 Vali Loss: 2.255 Vali Acc: 0.247 Test Loss: 2.255 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.1951086521148682
Epoch: 18, Steps: 17 | Train Loss: 1.094 Vali Loss: 2.175 Vali Acc: 0.262 Test Loss: 2.175 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4581408500671387
Epoch: 19, Steps: 17 | Train Loss: 1.132 Vali Loss: 1.804 Vali Acc: 0.274 Test Loss: 1.804 Test Acc: 0.274
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4121906757354736
Epoch: 20, Steps: 17 | Train Loss: 1.072 Vali Loss: 1.944 Vali Acc: 0.281 Test Loss: 1.944 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3429486751556396
Epoch: 21, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.898 Vali Acc: 0.289 Test Loss: 1.898 Test Acc: 0.289
Validation loss decreased (-0.285156 --> -0.288954).  Saving model ...
Epoch: 22 cost time: 1.3817622661590576
Epoch: 22, Steps: 17 | Train Loss: 0.924 Vali Loss: 1.902 Vali Acc: 0.270 Test Loss: 1.902 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5403358936309814
Epoch: 23, Steps: 17 | Train Loss: 0.847 Vali Loss: 1.953 Vali Acc: 0.293 Test Loss: 1.953 Test Acc: 0.293
Validation loss decreased (-0.288954 --> -0.292756).  Saving model ...
Epoch: 24 cost time: 1.5351688861846924
Epoch: 24, Steps: 17 | Train Loss: 0.767 Vali Loss: 2.724 Vali Acc: 0.262 Test Loss: 2.724 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.3869540691375732
Epoch: 25, Steps: 17 | Train Loss: 0.899 Vali Loss: 2.034 Vali Acc: 0.300 Test Loss: 2.034 Test Acc: 0.300
Validation loss decreased (-0.292756 --> -0.300360).  Saving model ...
Epoch: 26 cost time: 1.3569743633270264
Epoch: 26, Steps: 17 | Train Loss: 0.850 Vali Loss: 1.939 Vali Acc: 0.323 Test Loss: 1.939 Test Acc: 0.323
Validation loss decreased (-0.300360 --> -0.323175).  Saving model ...
Epoch: 27 cost time: 1.4726171493530273
Epoch: 27, Steps: 17 | Train Loss: 0.744 Vali Loss: 2.032 Vali Acc: 0.335 Test Loss: 2.032 Test Acc: 0.335
Validation loss decreased (-0.323175 --> -0.334580).  Saving model ...
Epoch: 28 cost time: 1.3417747020721436
Epoch: 28, Steps: 17 | Train Loss: 0.774 Vali Loss: 2.328 Vali Acc: 0.331 Test Loss: 2.328 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5449914932250977
Epoch: 29, Steps: 17 | Train Loss: 0.674 Vali Loss: 2.402 Vali Acc: 0.297 Test Loss: 2.402 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.316065788269043
Epoch: 30, Steps: 17 | Train Loss: 0.812 Vali Loss: 2.166 Vali Acc: 0.327 Test Loss: 2.166 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.490558385848999
Epoch: 31, Steps: 17 | Train Loss: 0.739 Vali Loss: 2.367 Vali Acc: 0.304 Test Loss: 2.367 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.610469102859497
Epoch: 32, Steps: 17 | Train Loss: 0.663 Vali Loss: 2.112 Vali Acc: 0.354 Test Loss: 2.112 Test Acc: 0.354
Validation loss decreased (-0.334580 --> -0.353591).  Saving model ...
Epoch: 33 cost time: 1.5986332893371582
Epoch: 33, Steps: 17 | Train Loss: 0.548 Vali Loss: 2.308 Vali Acc: 0.361 Test Loss: 2.308 Test Acc: 0.361
Validation loss decreased (-0.353591 --> -0.361194).  Saving model ...
Epoch: 34 cost time: 1.4154021739959717
Epoch: 34, Steps: 17 | Train Loss: 0.549 Vali Loss: 2.452 Vali Acc: 0.350 Test Loss: 2.452 Test Acc: 0.350
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4459567070007324
Epoch: 35, Steps: 17 | Train Loss: 0.580 Vali Loss: 2.256 Vali Acc: 0.342 Test Loss: 2.256 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.4305996894836426
Epoch: 36, Steps: 17 | Train Loss: 0.451 Vali Loss: 2.457 Vali Acc: 0.331 Test Loss: 2.457 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.4487519264221191
Epoch: 37, Steps: 17 | Train Loss: 0.457 Vali Loss: 2.471 Vali Acc: 0.350 Test Loss: 2.471 Test Acc: 0.350
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.2441797256469727
Epoch: 38, Steps: 17 | Train Loss: 0.522 Vali Loss: 3.138 Vali Acc: 0.319 Test Loss: 3.138 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.3422048091888428
Epoch: 39, Steps: 17 | Train Loss: 0.507 Vali Loss: 2.711 Vali Acc: 0.335 Test Loss: 2.711 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.449772834777832
Epoch: 40, Steps: 17 | Train Loss: 0.335 Vali Loss: 2.556 Vali Acc: 0.346 Test Loss: 2.556 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.336768388748169
Epoch: 41, Steps: 17 | Train Loss: 0.461 Vali Loss: 2.750 Vali Acc: 0.365 Test Loss: 2.750 Test Acc: 0.365
Validation loss decreased (-0.361194 --> -0.364992).  Saving model ...
Epoch: 42 cost time: 1.4370574951171875
Epoch: 42, Steps: 17 | Train Loss: 0.349 Vali Loss: 2.720 Vali Acc: 0.338 Test Loss: 2.720 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.7317705154418945
Epoch: 43, Steps: 17 | Train Loss: 0.306 Vali Loss: 2.978 Vali Acc: 0.331 Test Loss: 2.978 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.136749029159546
Epoch: 44, Steps: 17 | Train Loss: 0.444 Vali Loss: 2.960 Vali Acc: 0.323 Test Loss: 2.960 Test Acc: 0.323
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2584035396575928
Epoch: 45, Steps: 17 | Train Loss: 0.281 Vali Loss: 2.868 Vali Acc: 0.365 Test Loss: 2.868 Test Acc: 0.365
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.1348235607147217
Epoch: 46, Steps: 17 | Train Loss: 0.308 Vali Loss: 3.022 Vali Acc: 0.346 Test Loss: 3.022 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2428779602050781
Epoch: 47, Steps: 17 | Train Loss: 0.307 Vali Loss: 3.099 Vali Acc: 0.350 Test Loss: 3.099 Test Acc: 0.350
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.4084529876708984
Epoch: 48, Steps: 17 | Train Loss: 0.238 Vali Loss: 3.859 Vali Acc: 0.308 Test Loss: 3.859 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.3462798595428467
Epoch: 49, Steps: 17 | Train Loss: 0.370 Vali Loss: 3.567 Vali Acc: 0.319 Test Loss: 3.567 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.159264087677002
Epoch: 50, Steps: 17 | Train Loss: 0.317 Vali Loss: 3.591 Vali Acc: 0.342 Test Loss: 3.591 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.317617416381836
Epoch: 51, Steps: 17 | Train Loss: 0.279 Vali Loss: 3.353 Vali Acc: 0.331 Test Loss: 3.353 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3650190114068441
model parameter : 227740
model size : 1.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.2048633098602295
Epoch: 1, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.580 Vali Acc: 0.251 Test Loss: 1.580 Test Acc: 0.251
Validation loss decreased (inf --> -0.250935).  Saving model ...
Epoch: 2 cost time: 1.7161788940429688
Epoch: 2, Steps: 17 | Train Loss: 1.445 Vali Loss: 1.393 Vali Acc: 0.312 Test Loss: 1.393 Test Acc: 0.312
Validation loss decreased (-0.250935 --> -0.311773).  Saving model ...
Epoch: 3 cost time: 1.4485578536987305
Epoch: 3, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.398 Vali Acc: 0.285 Test Loss: 1.398 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6353371143341064
Epoch: 4, Steps: 17 | Train Loss: 1.448 Vali Loss: 1.644 Vali Acc: 0.255 Test Loss: 1.644 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.7405366897583008
Epoch: 5, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.425 Vali Acc: 0.293 Test Loss: 1.425 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5428965091705322
Epoch: 6, Steps: 17 | Train Loss: 1.418 Vali Loss: 1.624 Vali Acc: 0.247 Test Loss: 1.624 Test Acc: 0.247
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5661814212799072
Epoch: 7, Steps: 17 | Train Loss: 1.379 Vali Loss: 1.461 Vali Acc: 0.293 Test Loss: 1.461 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5493755340576172
Epoch: 8, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.689 Vali Acc: 0.270 Test Loss: 1.689 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.443995475769043
Epoch: 9, Steps: 17 | Train Loss: 1.354 Vali Loss: 1.721 Vali Acc: 0.262 Test Loss: 1.721 Test Acc: 0.262
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.466010332107544
Epoch: 10, Steps: 17 | Train Loss: 1.385 Vali Loss: 2.117 Vali Acc: 0.243 Test Loss: 2.117 Test Acc: 0.243
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4959983825683594
Epoch: 11, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.650 Vali Acc: 0.255 Test Loss: 1.650 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.5987627506256104
Epoch: 12, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.625 Vali Acc: 0.297 Test Loss: 1.625 Test Acc: 0.297
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 191836
model size : 1.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.5785531997680664
Epoch: 1, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.409 Vali Acc: 0.274 Test Loss: 1.409 Test Acc: 0.274
Validation loss decreased (inf --> -0.273750).  Saving model ...
Epoch: 2 cost time: 1.499802589416504
Epoch: 2, Steps: 17 | Train Loss: 1.442 Vali Loss: 1.393 Vali Acc: 0.300 Test Loss: 1.393 Test Acc: 0.300
Validation loss decreased (-0.273750 --> -0.300366).  Saving model ...
Epoch: 3 cost time: 1.7406625747680664
Epoch: 3, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.699 Vali Acc: 0.270 Test Loss: 1.699 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4507074356079102
Epoch: 4, Steps: 17 | Train Loss: 1.562 Vali Loss: 1.720 Vali Acc: 0.262 Test Loss: 1.720 Test Acc: 0.262
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6028785705566406
Epoch: 5, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.585 Vali Acc: 0.278 Test Loss: 1.585 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5771098136901855
Epoch: 6, Steps: 17 | Train Loss: 1.405 Vali Loss: 1.590 Vali Acc: 0.243 Test Loss: 1.590 Test Acc: 0.243
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.7474894523620605
Epoch: 7, Steps: 17 | Train Loss: 1.367 Vali Loss: 1.506 Vali Acc: 0.278 Test Loss: 1.506 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7713136672973633
Epoch: 8, Steps: 17 | Train Loss: 1.336 Vali Loss: 1.518 Vali Acc: 0.259 Test Loss: 1.518 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6081492900848389
Epoch: 9, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.846 Vali Acc: 0.251 Test Loss: 1.846 Test Acc: 0.251
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6708483695983887
Epoch: 10, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.489 Vali Acc: 0.308 Test Loss: 1.489 Test Acc: 0.308
Validation loss decreased (-0.300366 --> -0.307970).  Saving model ...
Epoch: 11 cost time: 1.37095308303833
Epoch: 11, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.529 Vali Acc: 0.323 Test Loss: 1.529 Test Acc: 0.323
Validation loss decreased (-0.307970 --> -0.323179).  Saving model ...
Epoch: 12 cost time: 1.732208490371704
Epoch: 12, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.576 Vali Acc: 0.304 Test Loss: 1.576 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7190759181976318
Epoch: 13, Steps: 17 | Train Loss: 1.184 Vali Loss: 1.657 Vali Acc: 0.247 Test Loss: 1.657 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1871423721313477
Epoch: 14, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.903 Vali Acc: 0.259 Test Loss: 1.903 Test Acc: 0.259
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4680519104003906
Epoch: 15, Steps: 17 | Train Loss: 1.300 Vali Loss: 1.705 Vali Acc: 0.289 Test Loss: 1.705 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.575056791305542
Epoch: 16, Steps: 17 | Train Loss: 1.105 Vali Loss: 1.764 Vali Acc: 0.300 Test Loss: 1.764 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.71970534324646
Epoch: 17, Steps: 17 | Train Loss: 1.145 Vali Loss: 2.079 Vali Acc: 0.270 Test Loss: 2.079 Test Acc: 0.270
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6266939640045166
Epoch: 18, Steps: 17 | Train Loss: 1.170 Vali Loss: 2.289 Vali Acc: 0.266 Test Loss: 2.289 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.5555577278137207
Epoch: 19, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.958 Vali Acc: 0.293 Test Loss: 1.958 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.6496331691741943
Epoch: 20, Steps: 17 | Train Loss: 0.971 Vali Loss: 2.074 Vali Acc: 0.274 Test Loss: 2.074 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.5030403137207031
Epoch: 21, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.787 Vali Acc: 0.285 Test Loss: 1.787 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3231939163498099
model parameter : 187164
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.936809778213501
Epoch: 1, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.454 Vali Acc: 0.255 Test Loss: 1.454 Test Acc: 0.255
Validation loss decreased (inf --> -0.254738).  Saving model ...
Epoch: 2 cost time: 1.6275660991668701
Epoch: 2, Steps: 17 | Train Loss: 1.454 Vali Loss: 1.524 Vali Acc: 0.278 Test Loss: 1.524 Test Acc: 0.278
Validation loss decreased (-0.254738 --> -0.277551).  Saving model ...
Epoch: 3 cost time: 1.3512639999389648
Epoch: 3, Steps: 17 | Train Loss: 1.560 Vali Loss: 1.552 Vali Acc: 0.262 Test Loss: 1.552 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7445704936981201
Epoch: 4, Steps: 17 | Train Loss: 1.386 Vali Loss: 1.491 Vali Acc: 0.259 Test Loss: 1.491 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6902868747711182
Epoch: 5, Steps: 17 | Train Loss: 1.485 Vali Loss: 1.560 Vali Acc: 0.262 Test Loss: 1.560 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5034542083740234
Epoch: 6, Steps: 17 | Train Loss: 1.439 Vali Loss: 1.823 Vali Acc: 0.251 Test Loss: 1.823 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5950322151184082
Epoch: 7, Steps: 17 | Train Loss: 1.555 Vali Loss: 1.591 Vali Acc: 0.262 Test Loss: 1.591 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4653599262237549
Epoch: 8, Steps: 17 | Train Loss: 1.444 Vali Loss: 1.657 Vali Acc: 0.266 Test Loss: 1.657 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.723970651626587
Epoch: 9, Steps: 17 | Train Loss: 1.441 Vali Loss: 1.517 Vali Acc: 0.266 Test Loss: 1.517 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.596144676208496
Epoch: 10, Steps: 17 | Train Loss: 1.303 Vali Loss: 1.507 Vali Acc: 0.255 Test Loss: 1.507 Test Acc: 0.255
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.6273419857025146
Epoch: 11, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.527 Vali Acc: 0.289 Test Loss: 1.527 Test Acc: 0.289
Validation loss decreased (-0.277551 --> -0.288958).  Saving model ...
Epoch: 12 cost time: 1.842991590499878
Epoch: 12, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.891 Vali Acc: 0.247 Test Loss: 1.891 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4257721900939941
Epoch: 13, Steps: 17 | Train Loss: 1.218 Vali Loss: 1.748 Vali Acc: 0.266 Test Loss: 1.748 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4878342151641846
Epoch: 14, Steps: 17 | Train Loss: 1.385 Vali Loss: 2.017 Vali Acc: 0.270 Test Loss: 2.017 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4286653995513916
Epoch: 15, Steps: 17 | Train Loss: 1.299 Vali Loss: 1.731 Vali Acc: 0.255 Test Loss: 1.731 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0279197692871094
Epoch: 16, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.622 Vali Acc: 0.308 Test Loss: 1.622 Test Acc: 0.308
Validation loss decreased (-0.288958 --> -0.307969).  Saving model ...
Epoch: 17 cost time: 1.3160948753356934
Epoch: 17, Steps: 17 | Train Loss: 1.036 Vali Loss: 1.628 Vali Acc: 0.304 Test Loss: 1.628 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5946345329284668
Epoch: 18, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.702 Vali Acc: 0.293 Test Loss: 1.702 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5226590633392334
Epoch: 19, Steps: 17 | Train Loss: 1.061 Vali Loss: 1.844 Vali Acc: 0.297 Test Loss: 1.844 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.4801335334777832
Epoch: 20, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.960 Vali Acc: 0.327 Test Loss: 1.960 Test Acc: 0.327
Validation loss decreased (-0.307969 --> -0.326977).  Saving model ...
Epoch: 21 cost time: 1.6077370643615723
Epoch: 21, Steps: 17 | Train Loss: 1.109 Vali Loss: 2.242 Vali Acc: 0.259 Test Loss: 2.242 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3653883934020996
Epoch: 22, Steps: 17 | Train Loss: 0.957 Vali Loss: 2.107 Vali Acc: 0.270 Test Loss: 2.107 Test Acc: 0.270
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.975374698638916
Epoch: 23, Steps: 17 | Train Loss: 0.911 Vali Loss: 2.096 Vali Acc: 0.281 Test Loss: 2.096 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8889329433441162
Epoch: 24, Steps: 17 | Train Loss: 0.790 Vali Loss: 1.939 Vali Acc: 0.312 Test Loss: 1.939 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.375422477722168
Epoch: 25, Steps: 17 | Train Loss: 0.774 Vali Loss: 2.105 Vali Acc: 0.285 Test Loss: 2.105 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.5254573822021484
Epoch: 26, Steps: 17 | Train Loss: 0.868 Vali Loss: 2.154 Vali Acc: 0.266 Test Loss: 2.154 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5066235065460205
Epoch: 27, Steps: 17 | Train Loss: 0.810 Vali Loss: 2.228 Vali Acc: 0.293 Test Loss: 2.228 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.4678382873535156
Epoch: 28, Steps: 17 | Train Loss: 0.772 Vali Loss: 2.242 Vali Acc: 0.297 Test Loss: 2.242 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.611628770828247
Epoch: 29, Steps: 17 | Train Loss: 0.694 Vali Loss: 2.301 Vali Acc: 0.278 Test Loss: 2.301 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.922579288482666
Epoch: 30, Steps: 17 | Train Loss: 0.800 Vali Loss: 2.189 Vali Acc: 0.357 Test Loss: 2.189 Test Acc: 0.357
Validation loss decreased (-0.326977 --> -0.357393).  Saving model ...
Epoch: 31 cost time: 1.572127103805542
Epoch: 31, Steps: 17 | Train Loss: 0.699 Vali Loss: 2.409 Vali Acc: 0.304 Test Loss: 2.409 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.5276620388031006
Epoch: 32, Steps: 17 | Train Loss: 0.617 Vali Loss: 2.249 Vali Acc: 0.342 Test Loss: 2.249 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.4938437938690186
Epoch: 33, Steps: 17 | Train Loss: 0.630 Vali Loss: 2.392 Vali Acc: 0.308 Test Loss: 2.392 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.463637351989746
Epoch: 34, Steps: 17 | Train Loss: 0.665 Vali Loss: 2.440 Vali Acc: 0.308 Test Loss: 2.440 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.5919270515441895
Epoch: 35, Steps: 17 | Train Loss: 0.481 Vali Loss: 2.366 Vali Acc: 0.354 Test Loss: 2.366 Test Acc: 0.354
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.516700029373169
Epoch: 36, Steps: 17 | Train Loss: 0.494 Vali Loss: 2.492 Vali Acc: 0.319 Test Loss: 2.492 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5453808307647705
Epoch: 37, Steps: 17 | Train Loss: 0.627 Vali Loss: 3.024 Vali Acc: 0.293 Test Loss: 3.024 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.623103141784668
Epoch: 38, Steps: 17 | Train Loss: 0.594 Vali Loss: 2.443 Vali Acc: 0.346 Test Loss: 2.443 Test Acc: 0.346
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.5184707641601562
Epoch: 39, Steps: 17 | Train Loss: 0.591 Vali Loss: 2.649 Vali Acc: 0.350 Test Loss: 2.649 Test Acc: 0.350
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6218781471252441
Epoch: 40, Steps: 17 | Train Loss: 0.594 Vali Loss: 2.484 Vali Acc: 0.323 Test Loss: 2.484 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3574144486692015
model parameter : 182492
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.524570941925049
Epoch: 1, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.452 Vali Acc: 0.285 Test Loss: 1.452 Test Acc: 0.285
Validation loss decreased (inf --> -0.285157).  Saving model ...
Epoch: 2 cost time: 1.3648707866668701
Epoch: 2, Steps: 17 | Train Loss: 1.477 Vali Loss: 1.503 Vali Acc: 0.270 Test Loss: 1.503 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3583219051361084
Epoch: 3, Steps: 17 | Train Loss: 1.495 Vali Loss: 1.474 Vali Acc: 0.266 Test Loss: 1.474 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6228020191192627
Epoch: 4, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.440 Vali Acc: 0.236 Test Loss: 1.440 Test Acc: 0.236
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3678998947143555
Epoch: 5, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.777 Vali Acc: 0.304 Test Loss: 1.777 Test Acc: 0.304
Validation loss decreased (-0.285157 --> -0.304165).  Saving model ...
Epoch: 6 cost time: 1.3681461811065674
Epoch: 6, Steps: 17 | Train Loss: 1.504 Vali Loss: 2.017 Vali Acc: 0.270 Test Loss: 2.017 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4972014427185059
Epoch: 7, Steps: 17 | Train Loss: 1.567 Vali Loss: 1.668 Vali Acc: 0.281 Test Loss: 1.668 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4121816158294678
Epoch: 8, Steps: 17 | Train Loss: 1.532 Vali Loss: 1.726 Vali Acc: 0.262 Test Loss: 1.726 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4655060768127441
Epoch: 9, Steps: 17 | Train Loss: 1.321 Vali Loss: 1.998 Vali Acc: 0.251 Test Loss: 1.998 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3993499279022217
Epoch: 10, Steps: 17 | Train Loss: 1.623 Vali Loss: 1.864 Vali Acc: 0.251 Test Loss: 1.864 Test Acc: 0.251
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4953014850616455
Epoch: 11, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.515 Vali Acc: 0.259 Test Loss: 1.515 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3176774978637695
Epoch: 12, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.687 Vali Acc: 0.259 Test Loss: 1.687 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.530494213104248
Epoch: 13, Steps: 17 | Train Loss: 1.246 Vali Loss: 1.620 Vali Acc: 0.308 Test Loss: 1.620 Test Acc: 0.308
Validation loss decreased (-0.304165 --> -0.307969).  Saving model ...
Epoch: 14 cost time: 1.394273281097412
Epoch: 14, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.683 Vali Acc: 0.262 Test Loss: 1.683 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3443942070007324
Epoch: 15, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.577 Vali Acc: 0.285 Test Loss: 1.577 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4619097709655762
Epoch: 16, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.653 Vali Acc: 0.281 Test Loss: 1.653 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4841434955596924
Epoch: 17, Steps: 17 | Train Loss: 1.231 Vali Loss: 1.867 Vali Acc: 0.285 Test Loss: 1.867 Test Acc: 0.285
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3864829540252686
Epoch: 18, Steps: 17 | Train Loss: 1.277 Vali Loss: 1.967 Vali Acc: 0.278 Test Loss: 1.967 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5248379707336426
Epoch: 19, Steps: 17 | Train Loss: 1.281 Vali Loss: 2.593 Vali Acc: 0.247 Test Loss: 2.593 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5053150653839111
Epoch: 20, Steps: 17 | Train Loss: 1.099 Vali Loss: 2.060 Vali Acc: 0.259 Test Loss: 2.060 Test Acc: 0.259
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.429368495941162
Epoch: 21, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.852 Vali Acc: 0.312 Test Loss: 1.852 Test Acc: 0.312
Validation loss decreased (-0.307969 --> -0.311769).  Saving model ...
Epoch: 22 cost time: 1.390807867050171
Epoch: 22, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.948 Vali Acc: 0.285 Test Loss: 1.948 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6313109397888184
Epoch: 23, Steps: 17 | Train Loss: 0.882 Vali Loss: 1.897 Vali Acc: 0.289 Test Loss: 1.897 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.3980927467346191
Epoch: 24, Steps: 17 | Train Loss: 0.857 Vali Loss: 2.108 Vali Acc: 0.300 Test Loss: 2.108 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.4235200881958008
Epoch: 25, Steps: 17 | Train Loss: 0.972 Vali Loss: 2.135 Vali Acc: 0.270 Test Loss: 2.135 Test Acc: 0.270
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5424962043762207
Epoch: 26, Steps: 17 | Train Loss: 0.945 Vali Loss: 1.975 Vali Acc: 0.274 Test Loss: 1.975 Test Acc: 0.274
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6585452556610107
Epoch: 27, Steps: 17 | Train Loss: 0.814 Vali Loss: 1.991 Vali Acc: 0.331 Test Loss: 1.991 Test Acc: 0.331
Validation loss decreased (-0.311769 --> -0.330779).  Saving model ...
Epoch: 28 cost time: 1.4032871723175049
Epoch: 28, Steps: 17 | Train Loss: 0.683 Vali Loss: 1.989 Vali Acc: 0.289 Test Loss: 1.989 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4226748943328857
Epoch: 29, Steps: 17 | Train Loss: 0.941 Vali Loss: 2.479 Vali Acc: 0.304 Test Loss: 2.479 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.2511217594146729
Epoch: 30, Steps: 17 | Train Loss: 0.803 Vali Loss: 2.056 Vali Acc: 0.285 Test Loss: 2.056 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3056657314300537
Epoch: 31, Steps: 17 | Train Loss: 0.726 Vali Loss: 2.106 Vali Acc: 0.342 Test Loss: 2.106 Test Acc: 0.342
Validation loss decreased (-0.330779 --> -0.342184).  Saving model ...
Epoch: 32 cost time: 1.3135921955108643
Epoch: 32, Steps: 17 | Train Loss: 0.711 Vali Loss: 2.246 Vali Acc: 0.319 Test Loss: 2.246 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.4698874950408936
Epoch: 33, Steps: 17 | Train Loss: 0.654 Vali Loss: 2.374 Vali Acc: 0.327 Test Loss: 2.374 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.3766772747039795
Epoch: 34, Steps: 17 | Train Loss: 0.546 Vali Loss: 2.420 Vali Acc: 0.319 Test Loss: 2.420 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.436309814453125
Epoch: 35, Steps: 17 | Train Loss: 0.752 Vali Loss: 2.235 Vali Acc: 0.323 Test Loss: 2.235 Test Acc: 0.323
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.4748246669769287
Epoch: 36, Steps: 17 | Train Loss: 0.514 Vali Loss: 2.644 Vali Acc: 0.316 Test Loss: 2.644 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.57706880569458
Epoch: 37, Steps: 17 | Train Loss: 0.634 Vali Loss: 2.426 Vali Acc: 0.312 Test Loss: 2.426 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.4743850231170654
Epoch: 38, Steps: 17 | Train Loss: 0.597 Vali Loss: 2.249 Vali Acc: 0.350 Test Loss: 2.249 Test Acc: 0.350
Validation loss decreased (-0.342184 --> -0.349787).  Saving model ...
Epoch: 39 cost time: 1.740034818649292
Epoch: 39, Steps: 17 | Train Loss: 0.531 Vali Loss: 2.474 Vali Acc: 0.316 Test Loss: 2.474 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.6282360553741455
Epoch: 40, Steps: 17 | Train Loss: 0.470 Vali Loss: 2.427 Vali Acc: 0.338 Test Loss: 2.427 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.5262539386749268
Epoch: 41, Steps: 17 | Train Loss: 0.360 Vali Loss: 2.436 Vali Acc: 0.388 Test Loss: 2.436 Test Acc: 0.388
Validation loss decreased (-0.349787 --> -0.387808).  Saving model ...
Epoch: 42 cost time: 1.5335571765899658
Epoch: 42, Steps: 17 | Train Loss: 0.453 Vali Loss: 2.526 Vali Acc: 0.319 Test Loss: 2.526 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1461079120635986
Epoch: 43, Steps: 17 | Train Loss: 0.353 Vali Loss: 2.726 Vali Acc: 0.331 Test Loss: 2.726 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.231712818145752
Epoch: 44, Steps: 17 | Train Loss: 0.394 Vali Loss: 2.702 Vali Acc: 0.331 Test Loss: 2.702 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.6462202072143555
Epoch: 45, Steps: 17 | Train Loss: 0.383 Vali Loss: 2.801 Vali Acc: 0.319 Test Loss: 2.801 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.725252389907837
Epoch: 46, Steps: 17 | Train Loss: 0.313 Vali Loss: 3.234 Vali Acc: 0.300 Test Loss: 3.234 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.5562024116516113
Epoch: 47, Steps: 17 | Train Loss: 0.349 Vali Loss: 2.647 Vali Acc: 0.342 Test Loss: 2.647 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.439387559890747
Epoch: 48, Steps: 17 | Train Loss: 0.397 Vali Loss: 3.135 Vali Acc: 0.319 Test Loss: 3.135 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.5107777118682861
Epoch: 49, Steps: 17 | Train Loss: 0.425 Vali Loss: 3.284 Vali Acc: 0.361 Test Loss: 3.284 Test Acc: 0.361
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.6245746612548828
Epoch: 50, Steps: 17 | Train Loss: 0.503 Vali Loss: 3.174 Vali Acc: 0.335 Test Loss: 3.174 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.4910752773284912
Epoch: 51, Steps: 17 | Train Loss: 0.270 Vali Loss: 3.239 Vali Acc: 0.323 Test Loss: 3.239 Test Acc: 0.323
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.38783269961977185
model parameter : 177820
model size : 1.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3185856342315674
Epoch: 1, Steps: 17 | Train Loss: 1.424 Vali Loss: 1.415 Vali Acc: 0.255 Test Loss: 1.415 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.5617363452911377
Epoch: 2, Steps: 17 | Train Loss: 1.449 Vali Loss: 1.627 Vali Acc: 0.247 Test Loss: 1.627 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4310741424560547
Epoch: 3, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.745 Vali Acc: 0.247 Test Loss: 1.745 Test Acc: 0.247
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2932119369506836
Epoch: 4, Steps: 17 | Train Loss: 1.480 Vali Loss: 1.614 Vali Acc: 0.255 Test Loss: 1.614 Test Acc: 0.255
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6668736934661865
Epoch: 5, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.488 Vali Acc: 0.270 Test Loss: 1.488 Test Acc: 0.270
Validation loss decreased (-0.254739 --> -0.269947).  Saving model ...
Epoch: 6 cost time: 1.493168592453003
Epoch: 6, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.942 Vali Acc: 0.255 Test Loss: 1.942 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5932278633117676
Epoch: 7, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.521 Vali Acc: 0.259 Test Loss: 1.521 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6846163272857666
Epoch: 8, Steps: 17 | Train Loss: 1.393 Vali Loss: 1.773 Vali Acc: 0.262 Test Loss: 1.773 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4916355609893799
Epoch: 9, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.692 Vali Acc: 0.255 Test Loss: 1.692 Test Acc: 0.255
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5185058116912842
Epoch: 10, Steps: 17 | Train Loss: 1.540 Vali Loss: 1.482 Vali Acc: 0.278 Test Loss: 1.482 Test Acc: 0.278
Validation loss decreased (-0.269947 --> -0.277552).  Saving model ...
Epoch: 11 cost time: 1.6578736305236816
Epoch: 11, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.808 Vali Acc: 0.274 Test Loss: 1.808 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7271461486816406
Epoch: 12, Steps: 17 | Train Loss: 1.506 Vali Loss: 1.539 Vali Acc: 0.297 Test Loss: 1.539 Test Acc: 0.297
Validation loss decreased (-0.277552 --> -0.296563).  Saving model ...
Epoch: 13 cost time: 1.3887526988983154
Epoch: 13, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.868 Vali Acc: 0.266 Test Loss: 1.868 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5219342708587646
Epoch: 14, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.597 Vali Acc: 0.259 Test Loss: 1.597 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4898638725280762
Epoch: 15, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.636 Vali Acc: 0.278 Test Loss: 1.636 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.751734972000122
Epoch: 16, Steps: 17 | Train Loss: 1.148 Vali Loss: 1.889 Vali Acc: 0.278 Test Loss: 1.889 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5558290481567383
Epoch: 17, Steps: 17 | Train Loss: 1.156 Vali Loss: 1.824 Vali Acc: 0.262 Test Loss: 1.824 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.605128526687622
Epoch: 18, Steps: 17 | Train Loss: 1.026 Vali Loss: 1.901 Vali Acc: 0.266 Test Loss: 1.901 Test Acc: 0.266
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5982205867767334
Epoch: 19, Steps: 17 | Train Loss: 1.136 Vali Loss: 2.131 Vali Acc: 0.255 Test Loss: 2.131 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.3290953636169434
Epoch: 20, Steps: 17 | Train Loss: 1.006 Vali Loss: 1.811 Vali Acc: 0.297 Test Loss: 1.811 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6223864555358887
Epoch: 21, Steps: 17 | Train Loss: 0.860 Vali Loss: 1.883 Vali Acc: 0.266 Test Loss: 1.883 Test Acc: 0.266
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4237117767333984
Epoch: 22, Steps: 17 | Train Loss: 0.941 Vali Loss: 1.943 Vali Acc: 0.278 Test Loss: 1.943 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.2965779467680608
model parameter : 166876
model size : 1.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.6385042667388916
Epoch: 1, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.409 Vali Acc: 0.247 Test Loss: 1.409 Test Acc: 0.247
Validation loss decreased (inf --> -0.247134).  Saving model ...
Epoch: 2 cost time: 1.4107537269592285
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.620 Vali Acc: 0.255 Test Loss: 1.620 Test Acc: 0.255
Validation loss decreased (-0.247134 --> -0.254737).  Saving model ...
Epoch: 3 cost time: 1.6487770080566406
Epoch: 3, Steps: 17 | Train Loss: 1.512 Vali Loss: 1.824 Vali Acc: 0.266 Test Loss: 1.824 Test Acc: 0.266
Validation loss decreased (-0.254737 --> -0.266141).  Saving model ...
Epoch: 4 cost time: 1.365177869796753
Epoch: 4, Steps: 17 | Train Loss: 1.518 Vali Loss: 1.414 Vali Acc: 0.278 Test Loss: 1.414 Test Acc: 0.278
Validation loss decreased (-0.266141 --> -0.277552).  Saving model ...
Epoch: 5 cost time: 1.5296871662139893
Epoch: 5, Steps: 17 | Train Loss: 1.492 Vali Loss: 1.475 Vali Acc: 0.270 Test Loss: 1.475 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4654185771942139
Epoch: 6, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.650 Vali Acc: 0.251 Test Loss: 1.650 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4985671043395996
Epoch: 7, Steps: 17 | Train Loss: 1.422 Vali Loss: 1.680 Vali Acc: 0.270 Test Loss: 1.680 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.59395170211792
Epoch: 8, Steps: 17 | Train Loss: 1.479 Vali Loss: 1.484 Vali Acc: 0.304 Test Loss: 1.484 Test Acc: 0.304
Validation loss decreased (-0.277552 --> -0.304168).  Saving model ...
Epoch: 9 cost time: 1.5158066749572754
Epoch: 9, Steps: 17 | Train Loss: 1.478 Vali Loss: 2.179 Vali Acc: 0.259 Test Loss: 2.179 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4039089679718018
Epoch: 10, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.605 Vali Acc: 0.297 Test Loss: 1.605 Test Acc: 0.297
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6733896732330322
Epoch: 11, Steps: 17 | Train Loss: 1.343 Vali Loss: 1.521 Vali Acc: 0.304 Test Loss: 1.521 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5082979202270508
Epoch: 12, Steps: 17 | Train Loss: 1.187 Vali Loss: 2.208 Vali Acc: 0.251 Test Loss: 2.208 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.6047871112823486
Epoch: 13, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.600 Vali Acc: 0.281 Test Loss: 1.600 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5926580429077148
Epoch: 14, Steps: 17 | Train Loss: 1.243 Vali Loss: 1.690 Vali Acc: 0.289 Test Loss: 1.690 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5637798309326172
Epoch: 15, Steps: 17 | Train Loss: 1.319 Vali Loss: 1.582 Vali Acc: 0.281 Test Loss: 1.582 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2820415496826172
Epoch: 16, Steps: 17 | Train Loss: 1.227 Vali Loss: 1.603 Vali Acc: 0.297 Test Loss: 1.603 Test Acc: 0.297
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.527130126953125
Epoch: 17, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.819 Vali Acc: 0.281 Test Loss: 1.819 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.4162054061889648
Epoch: 18, Steps: 17 | Train Loss: 1.043 Vali Loss: 2.407 Vali Acc: 0.281 Test Loss: 2.407 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 162204
model size : 1.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.3613553047180176
Epoch: 1, Steps: 17 | Train Loss: 1.462 Vali Loss: 1.418 Vali Acc: 0.255 Test Loss: 1.418 Test Acc: 0.255
Validation loss decreased (inf --> -0.254739).  Saving model ...
Epoch: 2 cost time: 1.4949612617492676
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.492 Vali Acc: 0.266 Test Loss: 1.492 Test Acc: 0.266
Validation loss decreased (-0.254739 --> -0.266145).  Saving model ...
Epoch: 3 cost time: 1.5073468685150146
Epoch: 3, Steps: 17 | Train Loss: 1.413 Vali Loss: 1.416 Vali Acc: 0.247 Test Loss: 1.416 Test Acc: 0.247
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6049506664276123
Epoch: 4, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.597 Vali Acc: 0.289 Test Loss: 1.597 Test Acc: 0.289
Validation loss decreased (-0.266145 --> -0.288957).  Saving model ...
Epoch: 5 cost time: 1.3435020446777344
Epoch: 5, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.504 Vali Acc: 0.293 Test Loss: 1.504 Test Acc: 0.293
Validation loss decreased (-0.288957 --> -0.292761).  Saving model ...
Epoch: 6 cost time: 1.4526493549346924
Epoch: 6, Steps: 17 | Train Loss: 1.382 Vali Loss: 1.454 Vali Acc: 0.278 Test Loss: 1.454 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9760065078735352
Epoch: 7, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.588 Vali Acc: 0.312 Test Loss: 1.588 Test Acc: 0.312
Validation loss decreased (-0.292761 --> -0.311771).  Saving model ...
Epoch: 8 cost time: 1.669877290725708
Epoch: 8, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.565 Vali Acc: 0.251 Test Loss: 1.565 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8062775135040283
Epoch: 9, Steps: 17 | Train Loss: 1.565 Vali Loss: 1.689 Vali Acc: 0.293 Test Loss: 1.689 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3669326305389404
Epoch: 10, Steps: 17 | Train Loss: 1.400 Vali Loss: 1.462 Vali Acc: 0.297 Test Loss: 1.462 Test Acc: 0.297
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5508713722229004
Epoch: 11, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.471 Vali Acc: 0.304 Test Loss: 1.471 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6836249828338623
Epoch: 12, Steps: 17 | Train Loss: 1.188 Vali Loss: 1.789 Vali Acc: 0.266 Test Loss: 1.789 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.40702223777771
Epoch: 13, Steps: 17 | Train Loss: 1.314 Vali Loss: 1.958 Vali Acc: 0.259 Test Loss: 1.958 Test Acc: 0.259
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.837130069732666
Epoch: 14, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.701 Vali Acc: 0.266 Test Loss: 1.701 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5785112380981445
Epoch: 15, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.868 Vali Acc: 0.278 Test Loss: 1.868 Test Acc: 0.278
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.2059741020202637
Epoch: 16, Steps: 17 | Train Loss: 1.273 Vali Loss: 2.073 Vali Acc: 0.255 Test Loss: 2.073 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.431518793106079
Epoch: 17, Steps: 17 | Train Loss: 1.229 Vali Loss: 1.666 Vali Acc: 0.285 Test Loss: 1.666 Test Acc: 0.285
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.311787072243346
model parameter : 157532
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_EthanolConcentrationModel:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/EthanolConcentration
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

261
263
>>>>>>>start training : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
261
263
263
Epoch: 1 cost time: 3.101580858230591
Epoch: 1, Steps: 17 | Train Loss: 1.423 Vali Loss: 1.516 Vali Acc: 0.289 Test Loss: 1.516 Test Acc: 0.289
Validation loss decreased (inf --> -0.288958).  Saving model ...
Epoch: 2 cost time: 1.277482509613037
Epoch: 2, Steps: 17 | Train Loss: 1.566 Vali Loss: 1.398 Vali Acc: 0.281 Test Loss: 1.398 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.17323637008667
Epoch: 3, Steps: 17 | Train Loss: 1.416 Vali Loss: 1.701 Vali Acc: 0.251 Test Loss: 1.701 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3187458515167236
Epoch: 4, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.527 Vali Acc: 0.251 Test Loss: 1.527 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5314128398895264
Epoch: 5, Steps: 17 | Train Loss: 1.426 Vali Loss: 1.680 Vali Acc: 0.251 Test Loss: 1.680 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5141892433166504
Epoch: 6, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.592 Vali Acc: 0.259 Test Loss: 1.592 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5712904930114746
Epoch: 7, Steps: 17 | Train Loss: 1.527 Vali Loss: 1.442 Vali Acc: 0.293 Test Loss: 1.442 Test Acc: 0.293
Validation loss decreased (-0.288958 --> -0.292761).  Saving model ...
Epoch: 8 cost time: 1.4207277297973633
Epoch: 8, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.721 Vali Acc: 0.304 Test Loss: 1.721 Test Acc: 0.304
Validation loss decreased (-0.292761 --> -0.304165).  Saving model ...
Epoch: 9 cost time: 1.5857930183410645
Epoch: 9, Steps: 17 | Train Loss: 1.380 Vali Loss: 1.425 Vali Acc: 0.289 Test Loss: 1.425 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4439036846160889
Epoch: 10, Steps: 17 | Train Loss: 1.217 Vali Loss: 1.578 Vali Acc: 0.274 Test Loss: 1.578 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.521298885345459
Epoch: 11, Steps: 17 | Train Loss: 1.269 Vali Loss: 2.053 Vali Acc: 0.251 Test Loss: 2.053 Test Acc: 0.251
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4905204772949219
Epoch: 12, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.747 Vali Acc: 0.251 Test Loss: 1.747 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3892996311187744
Epoch: 13, Steps: 17 | Train Loss: 1.261 Vali Loss: 1.759 Vali Acc: 0.270 Test Loss: 1.759 Test Acc: 0.270
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5414423942565918
Epoch: 14, Steps: 17 | Train Loss: 1.170 Vali Loss: 1.583 Vali Acc: 0.297 Test Loss: 1.583 Test Acc: 0.297
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6314313411712646
Epoch: 15, Steps: 17 | Train Loss: 1.228 Vali Loss: 1.661 Vali Acc: 0.274 Test Loss: 1.661 Test Acc: 0.274
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.7623395919799805
Epoch: 16, Steps: 17 | Train Loss: 1.283 Vali Loss: 1.759 Vali Acc: 0.300 Test Loss: 1.759 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4779767990112305
Epoch: 17, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.768 Vali Acc: 0.259 Test Loss: 1.768 Test Acc: 0.259
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3708720207214355
Epoch: 18, Steps: 17 | Train Loss: 1.024 Vali Loss: 1.660 Vali Acc: 0.289 Test Loss: 1.660 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_EthanolConcentration_Crossformer_UEA_ftM_sl1751_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
263
test shape: torch.Size([263, 4]) torch.Size([263, 1])
accuracy:0.3041825095057034
model parameter : 152860
model size : 1.26MB
