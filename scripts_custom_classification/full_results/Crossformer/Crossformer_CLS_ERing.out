Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5163450241088867
Epoch: 1, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.846 Vali Acc: 0.122 Test Loss: 1.846 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 0.614905834197998
Epoch: 2, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.792 Vali Acc: 0.107 Test Loss: 1.792 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7068240642547607
Epoch: 3, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.671 Vali Acc: 0.415 Test Loss: 1.671 Test Acc: 0.415
Validation loss decreased (-0.122204 --> -0.414798).  Saving model ...
Epoch: 4 cost time: 0.5741651058197021
Epoch: 4, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.511 Vali Acc: 0.596 Test Loss: 1.511 Test Acc: 0.596
Validation loss decreased (-0.414798 --> -0.596281).  Saving model ...
Epoch: 5 cost time: 0.5340073108673096
Epoch: 5, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.352 Vali Acc: 0.670 Test Loss: 1.352 Test Acc: 0.670
Validation loss decreased (-0.596281 --> -0.670357).  Saving model ...
Epoch: 6 cost time: 0.5728979110717773
Epoch: 6, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.107 Vali Acc: 0.752 Test Loss: 1.107 Test Acc: 0.752
Validation loss decreased (-0.670357 --> -0.751841).  Saving model ...
Epoch: 7 cost time: 0.6484479904174805
Epoch: 7, Steps: 2 | Train Loss: 0.996 Vali Loss: 0.855 Vali Acc: 0.826 Test Loss: 0.855 Test Acc: 0.826
Validation loss decreased (-0.751841 --> -0.825917).  Saving model ...
Epoch: 8 cost time: 0.5830581188201904
Epoch: 8, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.753 Vali Acc: 0.781 Test Loss: 0.753 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6294245719909668
Epoch: 9, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.584 Vali Acc: 0.881 Test Loss: 0.584 Test Acc: 0.881
Validation loss decreased (-0.825917 --> -0.881476).  Saving model ...
Epoch: 10 cost time: 0.590357780456543
Epoch: 10, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.440 Vali Acc: 0.926 Test Loss: 0.440 Test Acc: 0.926
Validation loss decreased (-0.881476 --> -0.925922).  Saving model ...
Epoch: 11 cost time: 0.5465095043182373
Epoch: 11, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.361 Vali Acc: 0.926 Test Loss: 0.361 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 12 cost time: 0.5961482524871826
Epoch: 12, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937034).  Saving model ...
Epoch: 13 cost time: 0.6530001163482666
Epoch: 13, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6967833042144775
Epoch: 14, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 15 cost time: 0.5704116821289062
Epoch: 15, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5617671012878418
Epoch: 16, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6537001132965088
Epoch: 17, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (-0.937034 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.6309938430786133
Epoch: 18, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5579614639282227
Epoch: 19, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5542006492614746
Epoch: 20, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5845687389373779
Epoch: 21, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.574183464050293
Epoch: 22, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.7086086273193359
Epoch: 23, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6079392433166504
Epoch: 24, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5662071704864502
Epoch: 25, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5493454933166504
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6160569190979004
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7002809047698975
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7151699066162109
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.8310177326202393
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.629633903503418
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5974807739257812
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.6009254455566406
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.60927414894104
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.6536087989807129
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.6560590267181396
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6265134811401367
Epoch: 37, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5532491207122803
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.510094165802002
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6434953212738037
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.6622941493988037
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6711010932922363
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6774277687072754
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6340587139129639
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5379226207733154
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 14275906
model size : 59.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4578323364257812
Epoch: 1, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.742 Vali Acc: 0.170 Test Loss: 1.742 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.6409034729003906
Epoch: 2, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.702 Vali Acc: 0.222 Test Loss: 1.702 Test Acc: 0.222
Validation loss decreased (-0.170353 --> -0.222205).  Saving model ...
Epoch: 3 cost time: 0.6278278827667236
Epoch: 3, Steps: 2 | Train Loss: 1.964 Vali Loss: 1.617 Vali Acc: 0.422 Test Loss: 1.617 Test Acc: 0.422
Validation loss decreased (-0.222205 --> -0.422206).  Saving model ...
Epoch: 4 cost time: 0.8489573001861572
Epoch: 4, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.549 Vali Acc: 0.652 Test Loss: 1.549 Test Acc: 0.652
Validation loss decreased (-0.422206 --> -0.651836).  Saving model ...
Epoch: 5 cost time: 0.658576488494873
Epoch: 5, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.395 Vali Acc: 0.700 Test Loss: 1.395 Test Acc: 0.700
Validation loss decreased (-0.651836 --> -0.699986).  Saving model ...
Epoch: 6 cost time: 0.6442911624908447
Epoch: 6, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.141 Vali Acc: 0.774 Test Loss: 1.141 Test Acc: 0.774
Validation loss decreased (-0.699986 --> -0.774063).  Saving model ...
Epoch: 7 cost time: 0.6419394016265869
Epoch: 7, Steps: 2 | Train Loss: 1.034 Vali Loss: 0.925 Vali Acc: 0.837 Test Loss: 0.925 Test Acc: 0.837
Validation loss decreased (-0.774063 --> -0.837028).  Saving model ...
Epoch: 8 cost time: 0.5912718772888184
Epoch: 8, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.764 Vali Acc: 0.852 Test Loss: 0.764 Test Acc: 0.852
Validation loss decreased (-0.837028 --> -0.851844).  Saving model ...
Epoch: 9 cost time: 0.6454439163208008
Epoch: 9, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.612 Vali Acc: 0.907 Test Loss: 0.612 Test Acc: 0.907
Validation loss decreased (-0.851844 --> -0.907401).  Saving model ...
Epoch: 10 cost time: 0.6843218803405762
Epoch: 10, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.477 Vali Acc: 0.915 Test Loss: 0.477 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914810).  Saving model ...
Epoch: 11 cost time: 0.7061111927032471
Epoch: 11, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.368 Vali Acc: 0.930 Test Loss: 0.368 Test Acc: 0.930
Validation loss decreased (-0.914810 --> -0.929626).  Saving model ...
Epoch: 12 cost time: 0.7273824214935303
Epoch: 12, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 13 cost time: 0.6592364311218262
Epoch: 13, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 14 cost time: 0.6213231086730957
Epoch: 14, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.282 Vali Acc: 0.919 Test Loss: 0.282 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7242221832275391
Epoch: 15, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7292423248291016
Epoch: 16, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.940738 --> -0.955554).  Saving model ...
Epoch: 17 cost time: 0.7370145320892334
Epoch: 17, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 18 cost time: 0.6306958198547363
Epoch: 18, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 19 cost time: 0.7394146919250488
Epoch: 19, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.814119815826416
Epoch: 20, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.270 Vali Acc: 0.915 Test Loss: 0.270 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7613160610198975
Epoch: 21, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6465744972229004
Epoch: 22, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7187137603759766
Epoch: 23, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.967 Test Loss: 0.176 Test Acc: 0.967
Validation loss decreased (-0.955554 --> -0.966665).  Saving model ...
Epoch: 24 cost time: 0.9029755592346191
Epoch: 24, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.765211820602417
Epoch: 25, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8085298538208008
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7345788478851318
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7893707752227783
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8879725933074951
Epoch: 29, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9915637969970703
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7613866329193115
Epoch: 31, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6332204341888428
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8956565856933594
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 14272834
model size : 59.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.624868392944336
Epoch: 1, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.939 Vali Acc: 0.167 Test Loss: 1.939 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.7441914081573486
Epoch: 2, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.845 Vali Acc: 0.178 Test Loss: 1.845 Test Acc: 0.178
Validation loss decreased (-0.166647 --> -0.177759).  Saving model ...
Epoch: 3 cost time: 0.7203972339630127
Epoch: 3, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.671 Vali Acc: 0.281 Test Loss: 1.671 Test Acc: 0.281
Validation loss decreased (-0.177759 --> -0.281465).  Saving model ...
Epoch: 4 cost time: 0.8062481880187988
Epoch: 4, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.630 Vali Acc: 0.470 Test Loss: 1.630 Test Acc: 0.470
Validation loss decreased (-0.281465 --> -0.470354).  Saving model ...
Epoch: 5 cost time: 0.7646245956420898
Epoch: 5, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.547 Vali Acc: 0.474 Test Loss: 1.547 Test Acc: 0.474
Validation loss decreased (-0.470354 --> -0.474059).  Saving model ...
Epoch: 6 cost time: 0.7513077259063721
Epoch: 6, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.286 Vali Acc: 0.630 Test Loss: 1.286 Test Acc: 0.630
Validation loss decreased (-0.474059 --> -0.629617).  Saving model ...
Epoch: 7 cost time: 0.7352602481842041
Epoch: 7, Steps: 2 | Train Loss: 1.135 Vali Loss: 0.929 Vali Acc: 0.737 Test Loss: 0.929 Test Acc: 0.737
Validation loss decreased (-0.629617 --> -0.737028).  Saving model ...
Epoch: 8 cost time: 0.8560764789581299
Epoch: 8, Steps: 2 | Train Loss: 0.752 Vali Loss: 0.737 Vali Acc: 0.785 Test Loss: 0.737 Test Acc: 0.785
Validation loss decreased (-0.737028 --> -0.785178).  Saving model ...
Epoch: 9 cost time: 0.7754292488098145
Epoch: 9, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.629 Vali Acc: 0.785 Test Loss: 0.629 Test Acc: 0.785
Validation loss decreased (-0.785178 --> -0.785179).  Saving model ...
Epoch: 10 cost time: 0.691662073135376
Epoch: 10, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.454 Vali Acc: 0.922 Test Loss: 0.454 Test Acc: 0.922
Validation loss decreased (-0.785179 --> -0.922218).  Saving model ...
Epoch: 11 cost time: 1.0356230735778809
Epoch: 11, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.377 Vali Acc: 0.937 Test Loss: 0.377 Test Acc: 0.937
Validation loss decreased (-0.922218 --> -0.937033).  Saving model ...
Epoch: 12 cost time: 0.8709478378295898
Epoch: 12, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 13 cost time: 0.8900856971740723
Epoch: 13, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.328 Vali Acc: 0.900 Test Loss: 0.328 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7774877548217773
Epoch: 14, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.317 Vali Acc: 0.893 Test Loss: 0.317 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.663844108581543
Epoch: 15, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.8469610214233398
Epoch: 16, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.219 Vali Acc: 0.952 Test Loss: 0.219 Test Acc: 0.952
Validation loss decreased (-0.944442 --> -0.951850).  Saving model ...
Epoch: 17 cost time: 0.8689098358154297
Epoch: 17, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
Validation loss decreased (-0.951850 --> -0.962961).  Saving model ...
Epoch: 18 cost time: 0.849989652633667
Epoch: 18, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7312238216400146
Epoch: 19, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.740243673324585
Epoch: 20, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9035487174987793
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6598305702209473
Epoch: 22, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8857114315032959
Epoch: 23, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8157603740692139
Epoch: 24, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966665).  Saving model ...
Epoch: 25 cost time: 0.7190518379211426
Epoch: 25, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7255740165710449
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8324272632598877
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.904449462890625
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8181734085083008
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7809200286865234
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8601951599121094
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7168383598327637
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8877923488616943
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9381933212280273
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 14269762
model size : 59.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.75689435005188
Epoch: 1, Steps: 2 | Train Loss: 1.988 Vali Loss: 1.877 Vali Acc: 0.059 Test Loss: 1.877 Test Acc: 0.059
Validation loss decreased (inf --> -0.059240).  Saving model ...
Epoch: 2 cost time: 0.703317403793335
Epoch: 2, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.836 Vali Acc: 0.085 Test Loss: 1.836 Test Acc: 0.085
Validation loss decreased (-0.059240 --> -0.085167).  Saving model ...
Epoch: 3 cost time: 0.6973414421081543
Epoch: 3, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.723 Vali Acc: 0.307 Test Loss: 1.723 Test Acc: 0.307
Validation loss decreased (-0.085167 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 0.7365450859069824
Epoch: 4, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.591 Vali Acc: 0.489 Test Loss: 1.591 Test Acc: 0.489
Validation loss decreased (-0.307390 --> -0.488873).  Saving model ...
Epoch: 5 cost time: 0.872124433517456
Epoch: 5, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.428 Vali Acc: 0.600 Test Loss: 1.428 Test Acc: 0.600
Validation loss decreased (-0.488873 --> -0.599986).  Saving model ...
Epoch: 6 cost time: 0.7610557079315186
Epoch: 6, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.173 Vali Acc: 0.644 Test Loss: 1.173 Test Acc: 0.644
Validation loss decreased (-0.599986 --> -0.644433).  Saving model ...
Epoch: 7 cost time: 0.6848056316375732
Epoch: 7, Steps: 2 | Train Loss: 1.077 Vali Loss: 0.923 Vali Acc: 0.878 Test Loss: 0.923 Test Acc: 0.878
Validation loss decreased (-0.644433 --> -0.877769).  Saving model ...
Epoch: 8 cost time: 0.782463788986206
Epoch: 8, Steps: 2 | Train Loss: 0.901 Vali Loss: 0.748 Vali Acc: 0.859 Test Loss: 0.748 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6727778911590576
Epoch: 9, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.594 Vali Acc: 0.915 Test Loss: 0.594 Test Acc: 0.915
Validation loss decreased (-0.877769 --> -0.914809).  Saving model ...
Epoch: 10 cost time: 0.8001866340637207
Epoch: 10, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.481 Vali Acc: 0.896 Test Loss: 0.481 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7649450302124023
Epoch: 11, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.467 Vali Acc: 0.837 Test Loss: 0.467 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8350069522857666
Epoch: 12, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.345 Vali Acc: 0.922 Test Loss: 0.345 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922219).  Saving model ...
Epoch: 13 cost time: 0.7437996864318848
Epoch: 13, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.922219 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.6743414402008057
Epoch: 14, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7076330184936523
Epoch: 15, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8137526512145996
Epoch: 16, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7411336898803711
Epoch: 17, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6712448596954346
Epoch: 18, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7668306827545166
Epoch: 19, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8808503150939941
Epoch: 20, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7976827621459961
Epoch: 21, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (-0.944442 --> -0.955554).  Saving model ...
Epoch: 22 cost time: 0.7334702014923096
Epoch: 22, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7655270099639893
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 24 cost time: 0.7125775814056396
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6823000907897949
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6796584129333496
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7316434383392334
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.927290678024292
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7627127170562744
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6032638549804688
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.728945255279541
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7430257797241211
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8219394683837891
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 14266690
model size : 59.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8168911933898926
Epoch: 1, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.743 Vali Acc: 0.159 Test Loss: 1.743 Test Acc: 0.159
Validation loss decreased (inf --> -0.159242).  Saving model ...
Epoch: 2 cost time: 0.7984471321105957
Epoch: 2, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.705 Vali Acc: 0.281 Test Loss: 1.705 Test Acc: 0.281
Validation loss decreased (-0.159242 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 0.7892055511474609
Epoch: 3, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.611 Vali Acc: 0.400 Test Loss: 1.611 Test Acc: 0.400
Validation loss decreased (-0.281464 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 0.790867805480957
Epoch: 4, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.472 Vali Acc: 0.378 Test Loss: 1.472 Test Acc: 0.378
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.138655424118042
Epoch: 5, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.329 Vali Acc: 0.422 Test Loss: 1.329 Test Acc: 0.422
Validation loss decreased (-0.399984 --> -0.422209).  Saving model ...
Epoch: 6 cost time: 0.8389770984649658
Epoch: 6, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.107 Vali Acc: 0.641 Test Loss: 1.107 Test Acc: 0.641
Validation loss decreased (-0.422209 --> -0.640730).  Saving model ...
Epoch: 7 cost time: 0.8259174823760986
Epoch: 7, Steps: 2 | Train Loss: 0.987 Vali Loss: 0.893 Vali Acc: 0.811 Test Loss: 0.893 Test Acc: 0.811
Validation loss decreased (-0.640730 --> -0.811102).  Saving model ...
Epoch: 8 cost time: 0.8734631538391113
Epoch: 8, Steps: 2 | Train Loss: 0.804 Vali Loss: 0.773 Vali Acc: 0.737 Test Loss: 0.773 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7814116477966309
Epoch: 9, Steps: 2 | Train Loss: 0.640 Vali Loss: 0.622 Vali Acc: 0.867 Test Loss: 0.622 Test Acc: 0.867
Validation loss decreased (-0.811102 --> -0.866660).  Saving model ...
Epoch: 10 cost time: 0.8591387271881104
Epoch: 10, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
Validation loss decreased (-0.866660 --> -0.899995).  Saving model ...
Epoch: 11 cost time: 0.9436588287353516
Epoch: 11, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.425 Vali Acc: 0.911 Test Loss: 0.425 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911107).  Saving model ...
Epoch: 12 cost time: 0.8971922397613525
Epoch: 12, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.367 Vali Acc: 0.900 Test Loss: 0.367 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8247013092041016
Epoch: 13, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.318 Vali Acc: 0.933 Test Loss: 0.318 Test Acc: 0.933
Validation loss decreased (-0.911107 --> -0.933330).  Saving model ...
Epoch: 14 cost time: 0.7570500373840332
Epoch: 14, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.303 Vali Acc: 0.904 Test Loss: 0.303 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9997608661651611
Epoch: 15, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.288 Vali Acc: 0.915 Test Loss: 0.288 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0238215923309326
Epoch: 16, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8402979373931885
Epoch: 17, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7901301383972168
Epoch: 18, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9698448181152344
Epoch: 19, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.8741607666015625
Epoch: 20, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.9505939483642578
Epoch: 21, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7094123363494873
Epoch: 22, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.7911508083343506
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8955235481262207
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9472362995147705
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8630506992340088
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7747097015380859
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.8388690948486328
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.941321849822998
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.8526182174682617
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 1.1258456707000732
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9945821762084961
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8313808441162109
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9223809242248535
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9653239250183105
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9063277244567871
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.1048674583435059
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8150484561920166
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.857201099395752
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.9734325408935547
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 11912002
model size : 50.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6073756217956543
Epoch: 1, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.986 Vali Acc: 0.081 Test Loss: 1.986 Test Acc: 0.081
Validation loss decreased (inf --> -0.081462).  Saving model ...
Epoch: 2 cost time: 0.8403768539428711
Epoch: 2, Steps: 2 | Train Loss: 1.963 Vali Loss: 1.928 Vali Acc: 0.100 Test Loss: 1.928 Test Acc: 0.100
Validation loss decreased (-0.081462 --> -0.099981).  Saving model ...
Epoch: 3 cost time: 0.8281233310699463
Epoch: 3, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.787 Vali Acc: 0.152 Test Loss: 1.787 Test Acc: 0.152
Validation loss decreased (-0.099981 --> -0.151834).  Saving model ...
Epoch: 4 cost time: 0.7351770401000977
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.624 Vali Acc: 0.359 Test Loss: 1.624 Test Acc: 0.359
Validation loss decreased (-0.151834 --> -0.359243).  Saving model ...
Epoch: 5 cost time: 0.7606558799743652
Epoch: 5, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.532 Vali Acc: 0.393 Test Loss: 1.532 Test Acc: 0.393
Validation loss decreased (-0.359243 --> -0.392577).  Saving model ...
Epoch: 6 cost time: 0.8732109069824219
Epoch: 6, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.301 Vali Acc: 0.504 Test Loss: 1.301 Test Acc: 0.504
Validation loss decreased (-0.392577 --> -0.503691).  Saving model ...
Epoch: 7 cost time: 0.7131843566894531
Epoch: 7, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.047 Vali Acc: 0.844 Test Loss: 1.047 Test Acc: 0.844
Validation loss decreased (-0.503691 --> -0.844434).  Saving model ...
Epoch: 8 cost time: 0.6429955959320068
Epoch: 8, Steps: 2 | Train Loss: 0.953 Vali Loss: 0.912 Vali Acc: 0.793 Test Loss: 0.912 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6790981292724609
Epoch: 9, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.766 Vali Acc: 0.889 Test Loss: 0.766 Test Acc: 0.889
Validation loss decreased (-0.844434 --> -0.888881).  Saving model ...
Epoch: 10 cost time: 0.8151342868804932
Epoch: 10, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.623 Vali Acc: 0.881 Test Loss: 0.623 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7161610126495361
Epoch: 11, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.495 Vali Acc: 0.896 Test Loss: 0.495 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896291).  Saving model ...
Epoch: 12 cost time: 0.8758714199066162
Epoch: 12, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899996).  Saving model ...
Epoch: 13 cost time: 0.794788122177124
Epoch: 13, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.337 Vali Acc: 0.915 Test Loss: 0.337 Test Acc: 0.915
Validation loss decreased (-0.899996 --> -0.914811).  Saving model ...
Epoch: 14 cost time: 0.876248836517334
Epoch: 14, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.308 Vali Acc: 0.907 Test Loss: 0.308 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.758913516998291
Epoch: 15, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922220).  Saving model ...
Epoch: 16 cost time: 0.6278107166290283
Epoch: 16, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 0.7081208229064941
Epoch: 17, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.764094352722168
Epoch: 18, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.648827075958252
Epoch: 19, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.6560111045837402
Epoch: 20, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.6339304447174072
Epoch: 21, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.8000893592834473
Epoch: 22, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.8318967819213867
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9168219566345215
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7716929912567139
Epoch: 25, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8326268196105957
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.68310546875
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7088150978088379
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7714357376098633
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7530760765075684
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.717583417892456
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.8065526485443115
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7007632255554199
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8640942573547363
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.7089977264404297
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6724591255187988
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7447583675384521
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.845634937286377
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7798819541931152
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7650227546691895
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7351467609405518
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9001564979553223
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7939271926879883
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6896967887878418
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 11908930
model size : 50.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4376981258392334
Epoch: 1, Steps: 2 | Train Loss: 2.007 Vali Loss: 1.959 Vali Acc: 0.174 Test Loss: 1.959 Test Acc: 0.174
Validation loss decreased (inf --> -0.174054).  Saving model ...
Epoch: 2 cost time: 0.9281117916107178
Epoch: 2, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.900 Vali Acc: 0.148 Test Loss: 1.900 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1323966979980469
Epoch: 3, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.774 Vali Acc: 0.215 Test Loss: 1.774 Test Acc: 0.215
Validation loss decreased (-0.174054 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 0.8198957443237305
Epoch: 4, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.635 Vali Acc: 0.281 Test Loss: 1.635 Test Acc: 0.281
Validation loss decreased (-0.214797 --> -0.281465).  Saving model ...
Epoch: 5 cost time: 0.6948070526123047
Epoch: 5, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.523 Vali Acc: 0.230 Test Loss: 1.523 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.912050724029541
Epoch: 6, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.264 Vali Acc: 0.552 Test Loss: 1.264 Test Acc: 0.552
Validation loss decreased (-0.281465 --> -0.551839).  Saving model ...
Epoch: 7 cost time: 0.7515003681182861
Epoch: 7, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.013 Vali Acc: 0.893 Test Loss: 1.013 Test Acc: 0.893
Validation loss decreased (-0.551839 --> -0.892582).  Saving model ...
Epoch: 8 cost time: 0.8932185173034668
Epoch: 8, Steps: 2 | Train Loss: 0.936 Vali Loss: 0.918 Vali Acc: 0.641 Test Loss: 0.918 Test Acc: 0.641
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8389322757720947
Epoch: 9, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.749 Vali Acc: 0.800 Test Loss: 0.749 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.788499116897583
Epoch: 10, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.579 Vali Acc: 0.907 Test Loss: 0.579 Test Acc: 0.907
Validation loss decreased (-0.892582 --> -0.907402).  Saving model ...
Epoch: 11 cost time: 0.8940980434417725
Epoch: 11, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.483 Vali Acc: 0.922 Test Loss: 0.483 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922217).  Saving model ...
Epoch: 12 cost time: 0.8830509185791016
Epoch: 12, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.413 Vali Acc: 0.922 Test Loss: 0.413 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 13 cost time: 0.833916425704956
Epoch: 13, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.349 Vali Acc: 0.941 Test Loss: 0.349 Test Acc: 0.941
Validation loss decreased (-0.922218 --> -0.940737).  Saving model ...
Epoch: 14 cost time: 0.8413741588592529
Epoch: 14, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.331 Vali Acc: 0.896 Test Loss: 0.331 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7823936939239502
Epoch: 15, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.295 Vali Acc: 0.907 Test Loss: 0.295 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6679527759552002
Epoch: 16, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.7843763828277588
Epoch: 17, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8123042583465576
Epoch: 18, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9614124298095703
Epoch: 19, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7486400604248047
Epoch: 20, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0335819721221924
Epoch: 21, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8589468002319336
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
Validation loss decreased (-0.940738 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.9185812473297119
Epoch: 23, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.762275218963623
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7348790168762207
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8627629280090332
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8177578449249268
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7749443054199219
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8788542747497559
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7958798408508301
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8346879482269287
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.7767436504364014
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 1.0297820568084717
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.8931224346160889
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 1.0340607166290283
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7770810127258301
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8618779182434082
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 1.0665242671966553
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7608993053436279
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0552008152008057
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7927002906799316
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8981733322143555
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8681991100311279
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9176280498504639
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.742358922958374
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8472483158111572
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8866169452667236
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 11905858
model size : 50.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7409965991973877
Epoch: 1, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.825 Vali Acc: 0.141 Test Loss: 1.825 Test Acc: 0.141
Validation loss decreased (inf --> -0.140722).  Saving model ...
Epoch: 2 cost time: 0.7283482551574707
Epoch: 2, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.782 Vali Acc: 0.181 Test Loss: 1.782 Test Acc: 0.181
Validation loss decreased (-0.140722 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.7738676071166992
Epoch: 3, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.677 Vali Acc: 0.319 Test Loss: 1.677 Test Acc: 0.319
Validation loss decreased (-0.181464 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.8325488567352295
Epoch: 4, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.523 Vali Acc: 0.581 Test Loss: 1.523 Test Acc: 0.581
Validation loss decreased (-0.318502 --> -0.581466).  Saving model ...
Epoch: 5 cost time: 0.7919092178344727
Epoch: 5, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.380 Vali Acc: 0.604 Test Loss: 1.380 Test Acc: 0.604
Validation loss decreased (-0.581466 --> -0.603690).  Saving model ...
Epoch: 6 cost time: 0.8089087009429932
Epoch: 6, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.166 Vali Acc: 0.700 Test Loss: 1.166 Test Acc: 0.700
Validation loss decreased (-0.603690 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 0.8210744857788086
Epoch: 7, Steps: 2 | Train Loss: 1.051 Vali Loss: 0.956 Vali Acc: 0.830 Test Loss: 0.956 Test Acc: 0.830
Validation loss decreased (-0.699988 --> -0.829620).  Saving model ...
Epoch: 8 cost time: 0.9553461074829102
Epoch: 8, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.790 Vali Acc: 0.915 Test Loss: 0.790 Test Acc: 0.915
Validation loss decreased (-0.829620 --> -0.914807).  Saving model ...
Epoch: 9 cost time: 0.843902587890625
Epoch: 9, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.622 Vali Acc: 0.919 Test Loss: 0.622 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918512).  Saving model ...
Epoch: 10 cost time: 1.0361735820770264
Epoch: 10, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.536 Vali Acc: 0.841 Test Loss: 0.536 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8127944469451904
Epoch: 11, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.412 Vali Acc: 0.907 Test Loss: 0.412 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7717604637145996
Epoch: 12, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.330 Vali Acc: 0.948 Test Loss: 0.330 Test Acc: 0.948
Validation loss decreased (-0.918512 --> -0.948145).  Saving model ...
Epoch: 13 cost time: 0.8019669055938721
Epoch: 13, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.298 Vali Acc: 0.915 Test Loss: 0.298 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8945682048797607
Epoch: 14, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.288 Vali Acc: 0.915 Test Loss: 0.288 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9234113693237305
Epoch: 15, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.772531270980835
Epoch: 16, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7512528896331787
Epoch: 17, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.789445161819458
Epoch: 18, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.948146 --> -0.955554).  Saving model ...
Epoch: 19 cost time: 0.7580265998840332
Epoch: 19, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7946887016296387
Epoch: 20, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8720395565032959
Epoch: 21, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 22 cost time: 0.8154592514038086
Epoch: 22, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7427914142608643
Epoch: 23, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9148459434509277
Epoch: 24, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.977968692779541
Epoch: 25, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7636852264404297
Epoch: 26, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8326125144958496
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6564266681671143
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7413761615753174
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8931329250335693
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.8817617893218994
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.754568338394165
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.876030683517456
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.956 Test Loss: 0.194 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.80653977394104
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6858139038085938
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.758857250213623
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.706017255783081
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.971174955368042
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7596597671508789
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7689108848571777
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 11902786
model size : 50.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5686275959014893
Epoch: 1, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.789 Vali Acc: 0.270 Test Loss: 1.789 Test Acc: 0.270
Validation loss decreased (inf --> -0.270352).  Saving model ...
Epoch: 2 cost time: 0.9237737655639648
Epoch: 2, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.764 Vali Acc: 0.278 Test Loss: 1.764 Test Acc: 0.278
Validation loss decreased (-0.270352 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.8986294269561768
Epoch: 3, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.692 Vali Acc: 0.374 Test Loss: 1.692 Test Acc: 0.374
Validation loss decreased (-0.277760 --> -0.374057).  Saving model ...
Epoch: 4 cost time: 0.8536999225616455
Epoch: 4, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.549 Vali Acc: 0.604 Test Loss: 1.549 Test Acc: 0.604
Validation loss decreased (-0.374057 --> -0.603688).  Saving model ...
Epoch: 5 cost time: 0.7785544395446777
Epoch: 5, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.374 Vali Acc: 0.781 Test Loss: 1.374 Test Acc: 0.781
Validation loss decreased (-0.603688 --> -0.781468).  Saving model ...
Epoch: 6 cost time: 0.7293646335601807
Epoch: 6, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.190 Vali Acc: 0.859 Test Loss: 1.190 Test Acc: 0.859
Validation loss decreased (-0.781468 --> -0.859247).  Saving model ...
Epoch: 7 cost time: 0.8702404499053955
Epoch: 7, Steps: 2 | Train Loss: 1.133 Vali Loss: 0.991 Vali Acc: 0.870 Test Loss: 0.991 Test Acc: 0.870
Validation loss decreased (-0.859247 --> -0.870360).  Saving model ...
Epoch: 8 cost time: 1.047229290008545
Epoch: 8, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.807 Vali Acc: 0.878 Test Loss: 0.807 Test Acc: 0.878
Validation loss decreased (-0.870360 --> -0.877770).  Saving model ...
Epoch: 9 cost time: 1.0568809509277344
Epoch: 9, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.643 Vali Acc: 0.896 Test Loss: 0.643 Test Acc: 0.896
Validation loss decreased (-0.877770 --> -0.896290).  Saving model ...
Epoch: 10 cost time: 0.788017749786377
Epoch: 10, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.514 Vali Acc: 0.941 Test Loss: 0.514 Test Acc: 0.941
Validation loss decreased (-0.896290 --> -0.940736).  Saving model ...
Epoch: 11 cost time: 0.8300960063934326
Epoch: 11, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.422 Vali Acc: 0.948 Test Loss: 0.422 Test Acc: 0.948
Validation loss decreased (-0.940736 --> -0.948144).  Saving model ...
Epoch: 12 cost time: 1.040602445602417
Epoch: 12, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.374 Vali Acc: 0.900 Test Loss: 0.374 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.128873348236084
Epoch: 13, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.353 Vali Acc: 0.878 Test Loss: 0.353 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7647483348846436
Epoch: 14, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7796099185943604
Epoch: 15, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8870363235473633
Epoch: 16, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9170775413513184
Epoch: 17, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.765955924987793
Epoch: 18, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.265 Vali Acc: 0.900 Test Loss: 0.265 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9071810245513916
Epoch: 19, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.086137294769287
Epoch: 20, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.8976635932922363
Epoch: 21, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
Validation loss decreased (-0.948144 --> -0.962961).  Saving model ...
Epoch: 22 cost time: 0.801964521408081
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 23 cost time: 0.844001293182373
Epoch: 23, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7090809345245361
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8220884799957275
Epoch: 25, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7969894409179688
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7649648189544678
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.241 Vali Acc: 0.919 Test Loss: 0.241 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9341068267822266
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7410082817077637
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0704498291015625
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0304250717163086
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8203589916229248
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 10730050
model size : 46.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.760077714920044
Epoch: 1, Steps: 2 | Train Loss: 1.957 Vali Loss: 1.903 Vali Acc: 0.163 Test Loss: 1.903 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.8267712593078613
Epoch: 2, Steps: 2 | Train Loss: 1.931 Vali Loss: 1.850 Vali Acc: 0.167 Test Loss: 1.850 Test Acc: 0.167
Validation loss decreased (-0.162944 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.8453733921051025
Epoch: 3, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.735 Vali Acc: 0.337 Test Loss: 1.735 Test Acc: 0.337
Validation loss decreased (-0.166648 --> -0.337020).  Saving model ...
Epoch: 4 cost time: 0.892449140548706
Epoch: 4, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.606 Vali Acc: 0.444 Test Loss: 1.606 Test Acc: 0.444
Validation loss decreased (-0.337020 --> -0.444428).  Saving model ...
Epoch: 5 cost time: 0.8450961112976074
Epoch: 5, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.514 Vali Acc: 0.507 Test Loss: 1.514 Test Acc: 0.507
Validation loss decreased (-0.444428 --> -0.507392).  Saving model ...
Epoch: 6 cost time: 0.6924905776977539
Epoch: 6, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.341 Vali Acc: 0.596 Test Loss: 1.341 Test Acc: 0.596
Validation loss decreased (-0.507392 --> -0.596283).  Saving model ...
Epoch: 7 cost time: 0.8220314979553223
Epoch: 7, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.116 Vali Acc: 0.737 Test Loss: 1.116 Test Acc: 0.737
Validation loss decreased (-0.596283 --> -0.737026).  Saving model ...
Epoch: 8 cost time: 0.8754673004150391
Epoch: 8, Steps: 2 | Train Loss: 1.007 Vali Loss: 0.898 Vali Acc: 0.878 Test Loss: 0.898 Test Acc: 0.878
Validation loss decreased (-0.737026 --> -0.877769).  Saving model ...
Epoch: 9 cost time: 0.8293282985687256
Epoch: 9, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.748 Vali Acc: 0.896 Test Loss: 0.748 Test Acc: 0.896
Validation loss decreased (-0.877769 --> -0.896289).  Saving model ...
Epoch: 10 cost time: 0.8994350433349609
Epoch: 10, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.614 Vali Acc: 0.904 Test Loss: 0.614 Test Acc: 0.904
Validation loss decreased (-0.896289 --> -0.903698).  Saving model ...
Epoch: 11 cost time: 0.8701519966125488
Epoch: 11, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.510 Vali Acc: 0.881 Test Loss: 0.510 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9535431861877441
Epoch: 12, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.434 Vali Acc: 0.915 Test Loss: 0.434 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914810).  Saving model ...
Epoch: 13 cost time: 0.9309678077697754
Epoch: 13, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.371 Vali Acc: 0.926 Test Loss: 0.371 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925922).  Saving model ...
Epoch: 14 cost time: 0.8085856437683105
Epoch: 14, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.323 Vali Acc: 0.922 Test Loss: 0.323 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9556910991668701
Epoch: 15, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.306 Vali Acc: 0.915 Test Loss: 0.306 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7770302295684814
Epoch: 16, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.286 Vali Acc: 0.915 Test Loss: 0.286 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7878439426422119
Epoch: 17, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.8960671424865723
Epoch: 18, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9515771865844727
Epoch: 19, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9466240406036377
Epoch: 20, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.257 Vali Acc: 0.915 Test Loss: 0.257 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.899127721786499
Epoch: 21, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7967832088470459
Epoch: 22, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.247 Vali Acc: 0.911 Test Loss: 0.247 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8384394645690918
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7440354824066162
Epoch: 24, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.7952284812927246
Epoch: 25, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.8696048259735107
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.7373144626617432
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7830116748809814
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7569129467010498
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6858747005462646
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1143946647644043
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.242 Vali Acc: 0.915 Test Loss: 0.242 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7693996429443359
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.241 Vali Acc: 0.915 Test Loss: 0.241 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7734968662261963
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.907 Test Loss: 0.237 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8800191879272461
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.900 Test Loss: 0.235 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8019602298736572
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.233 Vali Acc: 0.907 Test Loss: 0.233 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7843079566955566
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.915 Test Loss: 0.229 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 10726978
model size : 45.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7932825088500977
Epoch: 1, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.773 Vali Acc: 0.122 Test Loss: 1.773 Test Acc: 0.122
Validation loss decreased (inf --> -0.122204).  Saving model ...
Epoch: 2 cost time: 0.8475708961486816
Epoch: 2, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.736 Vali Acc: 0.178 Test Loss: 1.736 Test Acc: 0.178
Validation loss decreased (-0.122204 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.9050359725952148
Epoch: 3, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.654 Vali Acc: 0.293 Test Loss: 1.654 Test Acc: 0.293
Validation loss decreased (-0.177760 --> -0.292576).  Saving model ...
Epoch: 4 cost time: 0.9508023262023926
Epoch: 4, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.533 Vali Acc: 0.463 Test Loss: 1.533 Test Acc: 0.463
Validation loss decreased (-0.292576 --> -0.462948).  Saving model ...
Epoch: 5 cost time: 0.850914716720581
Epoch: 5, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.403 Vali Acc: 0.511 Test Loss: 1.403 Test Acc: 0.511
Validation loss decreased (-0.462948 --> -0.511097).  Saving model ...
Epoch: 6 cost time: 0.9293744564056396
Epoch: 6, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.214 Vali Acc: 0.637 Test Loss: 1.214 Test Acc: 0.637
Validation loss decreased (-0.511097 --> -0.637025).  Saving model ...
Epoch: 7 cost time: 0.8763265609741211
Epoch: 7, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.006 Vali Acc: 0.819 Test Loss: 1.006 Test Acc: 0.819
Validation loss decreased (-0.637025 --> -0.818508).  Saving model ...
Epoch: 8 cost time: 0.9448647499084473
Epoch: 8, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.841 Vali Acc: 0.830 Test Loss: 0.841 Test Acc: 0.830
Validation loss decreased (-0.818508 --> -0.829621).  Saving model ...
Epoch: 9 cost time: 0.7699804306030273
Epoch: 9, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.695 Vali Acc: 0.896 Test Loss: 0.695 Test Acc: 0.896
Validation loss decreased (-0.829621 --> -0.896289).  Saving model ...
Epoch: 10 cost time: 0.8824152946472168
Epoch: 10, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 1.036170244216919
Epoch: 11, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.487 Vali Acc: 0.911 Test Loss: 0.487 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911106).  Saving model ...
Epoch: 12 cost time: 0.8989369869232178
Epoch: 12, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.401 Vali Acc: 0.922 Test Loss: 0.401 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922218).  Saving model ...
Epoch: 13 cost time: 0.7886247634887695
Epoch: 13, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.345 Vali Acc: 0.933 Test Loss: 0.345 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933330).  Saving model ...
Epoch: 14 cost time: 1.0528082847595215
Epoch: 14, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.302 Vali Acc: 0.948 Test Loss: 0.302 Test Acc: 0.948
Validation loss decreased (-0.933330 --> -0.948145).  Saving model ...
Epoch: 15 cost time: 0.9196982383728027
Epoch: 15, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.270 Vali Acc: 0.952 Test Loss: 0.270 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 16 cost time: 0.8169934749603271
Epoch: 16, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1788499355316162
Epoch: 17, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9812755584716797
Epoch: 18, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0607798099517822
Epoch: 19, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 20 cost time: 0.9302189350128174
Epoch: 20, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.951850 --> -0.959257).  Saving model ...
Epoch: 21 cost time: 0.7898473739624023
Epoch: 21, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.184786319732666
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8960127830505371
Epoch: 23, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7618691921234131
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9298379421234131
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8327653408050537
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8832781314849854
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7640986442565918
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8473589420318604
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8444318771362305
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 10723906
model size : 45.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.712693452835083
Epoch: 1, Steps: 2 | Train Loss: 1.961 Vali Loss: 1.904 Vali Acc: 0.096 Test Loss: 1.904 Test Acc: 0.096
Validation loss decreased (inf --> -0.096277).  Saving model ...
Epoch: 2 cost time: 0.9275639057159424
Epoch: 2, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.865 Vali Acc: 0.115 Test Loss: 1.865 Test Acc: 0.115
Validation loss decreased (-0.096277 --> -0.114796).  Saving model ...
Epoch: 3 cost time: 0.953125
Epoch: 3, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.771 Vali Acc: 0.148 Test Loss: 1.771 Test Acc: 0.148
Validation loss decreased (-0.114796 --> -0.148130).  Saving model ...
Epoch: 4 cost time: 0.8964860439300537
Epoch: 4, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.638 Vali Acc: 0.407 Test Loss: 1.638 Test Acc: 0.407
Validation loss decreased (-0.148130 --> -0.407391).  Saving model ...
Epoch: 5 cost time: 0.9199445247650146
Epoch: 5, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.508 Vali Acc: 0.600 Test Loss: 1.508 Test Acc: 0.600
Validation loss decreased (-0.407391 --> -0.599985).  Saving model ...
Epoch: 6 cost time: 0.911553144454956
Epoch: 6, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.332 Vali Acc: 0.674 Test Loss: 1.332 Test Acc: 0.674
Validation loss decreased (-0.599985 --> -0.674061).  Saving model ...
Epoch: 7 cost time: 0.8740832805633545
Epoch: 7, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.111 Vali Acc: 0.763 Test Loss: 1.111 Test Acc: 0.763
Validation loss decreased (-0.674061 --> -0.762952).  Saving model ...
Epoch: 8 cost time: 1.0997555255889893
Epoch: 8, Steps: 2 | Train Loss: 1.017 Vali Loss: 0.948 Vali Acc: 0.804 Test Loss: 0.948 Test Acc: 0.804
Validation loss decreased (-0.762952 --> -0.803694).  Saving model ...
Epoch: 9 cost time: 0.7550737857818604
Epoch: 9, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.838 Vali Acc: 0.700 Test Loss: 0.838 Test Acc: 0.700
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1318995952606201
Epoch: 10, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.658 Vali Acc: 0.893 Test Loss: 0.658 Test Acc: 0.893
Validation loss decreased (-0.803694 --> -0.892586).  Saving model ...
Epoch: 11 cost time: 0.8934922218322754
Epoch: 11, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.512 Vali Acc: 0.926 Test Loss: 0.512 Test Acc: 0.926
Validation loss decreased (-0.892586 --> -0.925921).  Saving model ...
Epoch: 12 cost time: 0.861621618270874
Epoch: 12, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.417 Vali Acc: 0.919 Test Loss: 0.417 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8216102123260498
Epoch: 13, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.360 Vali Acc: 0.930 Test Loss: 0.360 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929626).  Saving model ...
Epoch: 14 cost time: 1.0709593296051025
Epoch: 14, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.360 Vali Acc: 0.885 Test Loss: 0.360 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0575106143951416
Epoch: 15, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.269 Vali Acc: 0.933 Test Loss: 0.269 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933331).  Saving model ...
Epoch: 16 cost time: 0.9392173290252686
Epoch: 16, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9031548500061035
Epoch: 17, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.8480956554412842
Epoch: 18, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8385684490203857
Epoch: 19, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9591381549835205
Epoch: 20, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9920523166656494
Epoch: 21, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.933290958404541
Epoch: 22, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.8417460918426514
Epoch: 23, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8868844509124756
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.9297666549682617
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.7350103855133057
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.728806734085083
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.949650764465332
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9323678016662598
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.846228837966919
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9434614181518555
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9123716354370117
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.820298433303833
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.7834477424621582
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.1943607330322266
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 10720834
model size : 45.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5962066650390625
Epoch: 1, Steps: 2 | Train Loss: 2.126 Vali Loss: 2.026 Vali Acc: 0.115 Test Loss: 2.026 Test Acc: 0.115
Validation loss decreased (inf --> -0.114795).  Saving model ...
Epoch: 2 cost time: 0.709460973739624
Epoch: 2, Steps: 2 | Train Loss: 2.088 Vali Loss: 1.946 Vali Acc: 0.189 Test Loss: 1.946 Test Acc: 0.189
Validation loss decreased (-0.114795 --> -0.188869).  Saving model ...
Epoch: 3 cost time: 0.8915205001831055
Epoch: 3, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.780 Vali Acc: 0.278 Test Loss: 1.780 Test Acc: 0.278
Validation loss decreased (-0.188869 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 1.0078060626983643
Epoch: 4, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.615 Vali Acc: 0.559 Test Loss: 1.615 Test Acc: 0.559
Validation loss decreased (-0.277760 --> -0.559243).  Saving model ...
Epoch: 5 cost time: 0.9029240608215332
Epoch: 5, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.595 Vali Acc: 0.463 Test Loss: 1.595 Test Acc: 0.463
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7576251029968262
Epoch: 6, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.489 Vali Acc: 0.478 Test Loss: 1.489 Test Acc: 0.478
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0388286113739014
Epoch: 7, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.209 Vali Acc: 0.637 Test Loss: 1.209 Test Acc: 0.637
Validation loss decreased (-0.559243 --> -0.637025).  Saving model ...
Epoch: 8 cost time: 0.8155567646026611
Epoch: 8, Steps: 2 | Train Loss: 1.121 Vali Loss: 0.983 Vali Acc: 0.844 Test Loss: 0.983 Test Acc: 0.844
Validation loss decreased (-0.637025 --> -0.844435).  Saving model ...
Epoch: 9 cost time: 1.144798755645752
Epoch: 9, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.894 Vali Acc: 0.719 Test Loss: 0.894 Test Acc: 0.719
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0605871677398682
Epoch: 10, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.776 Vali Acc: 0.722 Test Loss: 0.776 Test Acc: 0.722
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8821337223052979
Epoch: 11, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.586 Vali Acc: 0.870 Test Loss: 0.586 Test Acc: 0.870
Validation loss decreased (-0.844435 --> -0.870365).  Saving model ...
Epoch: 12 cost time: 0.66815185546875
Epoch: 12, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.499 Vali Acc: 0.870 Test Loss: 0.499 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 13 cost time: 0.833514928817749
Epoch: 13, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.421 Vali Acc: 0.885 Test Loss: 0.421 Test Acc: 0.885
Validation loss decreased (-0.870365 --> -0.885181).  Saving model ...
Epoch: 14 cost time: 0.9334962368011475
Epoch: 14, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.360 Vali Acc: 0.944 Test Loss: 0.360 Test Acc: 0.944
Validation loss decreased (-0.885181 --> -0.944441).  Saving model ...
Epoch: 15 cost time: 0.7166221141815186
Epoch: 15, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.362 Vali Acc: 0.874 Test Loss: 0.362 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9637191295623779
Epoch: 16, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.308 Vali Acc: 0.926 Test Loss: 0.308 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0446052551269531
Epoch: 17, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.273 Vali Acc: 0.933 Test Loss: 0.273 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8650939464569092
Epoch: 18, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.240 Vali Acc: 0.948 Test Loss: 0.240 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.7639226913452148
Epoch: 19, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.881201982498169
Epoch: 20, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.288 Vali Acc: 0.900 Test Loss: 0.288 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9344155788421631
Epoch: 21, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0100765228271484
Epoch: 22, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.771242618560791
Epoch: 23, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6994280815124512
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.723447322845459
Epoch: 25, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.7584588527679443
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8521900177001953
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7405006885528564
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7359509468078613
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.956 Test Loss: 0.214 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 30 cost time: 0.6865189075469971
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.7784285545349121
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 32 cost time: 0.8950152397155762
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9716639518737793
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.934755802154541
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9005248546600342
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.758007287979126
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8276488780975342
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9170503616333008
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7925951480865479
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9570441246032715
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8948776721954346
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 10139074
model size : 43.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8399362564086914
Epoch: 1, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.816 Vali Acc: 0.174 Test Loss: 1.816 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.9271399974822998
Epoch: 2, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.778 Vali Acc: 0.207 Test Loss: 1.778 Test Acc: 0.207
Validation loss decreased (-0.174056 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.7703070640563965
Epoch: 3, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.703 Vali Acc: 0.307 Test Loss: 1.703 Test Acc: 0.307
Validation loss decreased (-0.207390 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 1.0393311977386475
Epoch: 4, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.597 Vali Acc: 0.370 Test Loss: 1.597 Test Acc: 0.370
Validation loss decreased (-0.307390 --> -0.370354).  Saving model ...
Epoch: 5 cost time: 0.8718640804290771
Epoch: 5, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.469 Vali Acc: 0.433 Test Loss: 1.469 Test Acc: 0.433
Validation loss decreased (-0.370354 --> -0.433319).  Saving model ...
Epoch: 6 cost time: 1.0208418369293213
Epoch: 6, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.307 Vali Acc: 0.626 Test Loss: 1.307 Test Acc: 0.626
Validation loss decreased (-0.433319 --> -0.625913).  Saving model ...
Epoch: 7 cost time: 0.9386310577392578
Epoch: 7, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.127 Vali Acc: 0.722 Test Loss: 1.127 Test Acc: 0.722
Validation loss decreased (-0.625913 --> -0.722211).  Saving model ...
Epoch: 8 cost time: 0.8242745399475098
Epoch: 8, Steps: 2 | Train Loss: 1.129 Vali Loss: 0.967 Vali Acc: 0.878 Test Loss: 0.967 Test Acc: 0.878
Validation loss decreased (-0.722211 --> -0.877768).  Saving model ...
Epoch: 9 cost time: 0.9282841682434082
Epoch: 9, Steps: 2 | Train Loss: 0.901 Vali Loss: 0.844 Vali Acc: 0.789 Test Loss: 0.844 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.932518720626831
Epoch: 10, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.699 Vali Acc: 0.863 Test Loss: 0.699 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7817704677581787
Epoch: 11, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.573 Vali Acc: 0.937 Test Loss: 0.573 Test Acc: 0.937
Validation loss decreased (-0.877768 --> -0.937031).  Saving model ...
Epoch: 12 cost time: 0.8517563343048096
Epoch: 12, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.493 Vali Acc: 0.915 Test Loss: 0.493 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9166216850280762
Epoch: 13, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.412 Vali Acc: 0.919 Test Loss: 0.412 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2136375904083252
Epoch: 14, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7755146026611328
Epoch: 15, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.310 Vali Acc: 0.933 Test Loss: 0.310 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8484094142913818
Epoch: 16, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937034).  Saving model ...
Epoch: 17 cost time: 0.941030740737915
Epoch: 17, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9614567756652832
Epoch: 18, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9531469345092773
Epoch: 19, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8922989368438721
Epoch: 20, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9194943904876709
Epoch: 21, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.9748055934906006
Epoch: 22, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8773403167724609
Epoch: 23, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8779032230377197
Epoch: 24, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.271 Vali Acc: 0.915 Test Loss: 0.271 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.935692548751831
Epoch: 25, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.288 Vali Acc: 0.907 Test Loss: 0.288 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.070918083190918
Epoch: 26, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.255 Vali Acc: 0.911 Test Loss: 0.255 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8928928375244141
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9434926509857178
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.937035 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 1.0768153667449951
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 1.1991922855377197
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.7880475521087646
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.7326607704162598
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8938508033752441
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.098020315170288
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1209797859191895
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8427529335021973
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.086212158203125
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9735760688781738
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.13822340965271
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0857267379760742
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8503475189208984
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 10136002
model size : 43.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.075658082962036
Epoch: 1, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.812 Vali Acc: 0.226 Test Loss: 1.812 Test Acc: 0.226
Validation loss decreased (inf --> -0.225908).  Saving model ...
Epoch: 2 cost time: 0.8457560539245605
Epoch: 2, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.772 Vali Acc: 0.259 Test Loss: 1.772 Test Acc: 0.259
Validation loss decreased (-0.225908 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 1.0570628643035889
Epoch: 3, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.691 Vali Acc: 0.356 Test Loss: 1.691 Test Acc: 0.356
Validation loss decreased (-0.259242 --> -0.355539).  Saving model ...
Epoch: 4 cost time: 0.9550380706787109
Epoch: 4, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.585 Vali Acc: 0.433 Test Loss: 1.585 Test Acc: 0.433
Validation loss decreased (-0.355539 --> -0.433317).  Saving model ...
Epoch: 5 cost time: 1.0351533889770508
Epoch: 5, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.458 Vali Acc: 0.456 Test Loss: 1.458 Test Acc: 0.456
Validation loss decreased (-0.433317 --> -0.455541).  Saving model ...
Epoch: 6 cost time: 0.7751398086547852
Epoch: 6, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.298 Vali Acc: 0.637 Test Loss: 1.298 Test Acc: 0.637
Validation loss decreased (-0.455541 --> -0.637024).  Saving model ...
Epoch: 7 cost time: 0.9505710601806641
Epoch: 7, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.105 Vali Acc: 0.719 Test Loss: 1.105 Test Acc: 0.719
Validation loss decreased (-0.637024 --> -0.718507).  Saving model ...
Epoch: 8 cost time: 0.9741635322570801
Epoch: 8, Steps: 2 | Train Loss: 1.018 Vali Loss: 0.929 Vali Acc: 0.804 Test Loss: 0.929 Test Acc: 0.804
Validation loss decreased (-0.718507 --> -0.803694).  Saving model ...
Epoch: 9 cost time: 0.7975928783416748
Epoch: 9, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.804 Vali Acc: 0.863 Test Loss: 0.804 Test Acc: 0.863
Validation loss decreased (-0.803694 --> -0.862955).  Saving model ...
Epoch: 10 cost time: 0.9537980556488037
Epoch: 10, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.662 Vali Acc: 0.900 Test Loss: 0.662 Test Acc: 0.900
Validation loss decreased (-0.862955 --> -0.899993).  Saving model ...
Epoch: 11 cost time: 0.8404223918914795
Epoch: 11, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.531 Vali Acc: 0.922 Test Loss: 0.531 Test Acc: 0.922
Validation loss decreased (-0.899993 --> -0.922217).  Saving model ...
Epoch: 12 cost time: 0.9189226627349854
Epoch: 12, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8656582832336426
Epoch: 13, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.389 Vali Acc: 0.926 Test Loss: 0.389 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925922).  Saving model ...
Epoch: 14 cost time: 1.083974838256836
Epoch: 14, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.370 Vali Acc: 0.904 Test Loss: 0.370 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.898430585861206
Epoch: 15, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 1.0124123096466064
Epoch: 16, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 17 cost time: 0.9122068881988525
Epoch: 17, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.9445645809173584
Epoch: 18, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0688261985778809
Epoch: 19, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9467947483062744
Epoch: 20, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1187050342559814
Epoch: 21, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8427555561065674
Epoch: 22, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.7588801383972168
Epoch: 23, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.9530529975891113
Epoch: 24, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0242950916290283
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9326632022857666
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9470405578613281
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0555851459503174
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8562757968902588
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0751862525939941
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.2402567863464355
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9902791976928711
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.0902273654937744
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 10132930
model size : 43.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.460005760192871
Epoch: 1, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.810 Vali Acc: 0.215 Test Loss: 1.810 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.9179730415344238
Epoch: 2, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.770 Vali Acc: 0.256 Test Loss: 1.770 Test Acc: 0.256
Validation loss decreased (-0.214797 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 0.8440864086151123
Epoch: 3, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.685 Vali Acc: 0.352 Test Loss: 1.685 Test Acc: 0.352
Validation loss decreased (-0.255538 --> -0.351835).  Saving model ...
Epoch: 4 cost time: 0.9141371250152588
Epoch: 4, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.557 Vali Acc: 0.622 Test Loss: 1.557 Test Acc: 0.622
Validation loss decreased (-0.351835 --> -0.622207).  Saving model ...
Epoch: 5 cost time: 0.8621177673339844
Epoch: 5, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.415 Vali Acc: 0.659 Test Loss: 1.415 Test Acc: 0.659
Validation loss decreased (-0.622207 --> -0.659245).  Saving model ...
Epoch: 6 cost time: 1.084202766418457
Epoch: 6, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.236 Vali Acc: 0.744 Test Loss: 1.236 Test Acc: 0.744
Validation loss decreased (-0.659245 --> -0.744432).  Saving model ...
Epoch: 7 cost time: 0.9992482662200928
Epoch: 7, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.030 Vali Acc: 0.785 Test Loss: 1.030 Test Acc: 0.785
Validation loss decreased (-0.744432 --> -0.785175).  Saving model ...
Epoch: 8 cost time: 0.9594516754150391
Epoch: 8, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.840 Vali Acc: 0.874 Test Loss: 0.840 Test Acc: 0.874
Validation loss decreased (-0.785175 --> -0.874066).  Saving model ...
Epoch: 9 cost time: 1.0450515747070312
Epoch: 9, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.695 Vali Acc: 0.881 Test Loss: 0.695 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881475).  Saving model ...
Epoch: 10 cost time: 0.985821008682251
Epoch: 10, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.589 Vali Acc: 0.896 Test Loss: 0.589 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896290).  Saving model ...
Epoch: 11 cost time: 1.0098381042480469
Epoch: 11, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.477 Vali Acc: 0.937 Test Loss: 0.477 Test Acc: 0.937
Validation loss decreased (-0.896290 --> -0.937032).  Saving model ...
Epoch: 12 cost time: 0.8033771514892578
Epoch: 12, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.414 Vali Acc: 0.896 Test Loss: 0.414 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9528801441192627
Epoch: 13, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.342 Vali Acc: 0.926 Test Loss: 0.342 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.145618200302124
Epoch: 14, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8820438385009766
Epoch: 15, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.266 Vali Acc: 0.926 Test Loss: 0.266 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0298149585723877
Epoch: 16, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9255402088165283
Epoch: 17, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7854478359222412
Epoch: 18, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1873197555541992
Epoch: 19, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8517844676971436
Epoch: 20, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.7910420894622803
Epoch: 21, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.937035 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.9900214672088623
Epoch: 22, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.948146 --> -0.955554).  Saving model ...
Epoch: 23 cost time: 1.1026980876922607
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 24 cost time: 0.9876151084899902
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0126709938049316
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0047597885131836
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.813878059387207
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8974754810333252
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9260108470916748
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 0.8847482204437256
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
Validation loss decreased (-0.955554 --> -0.962961).  Saving model ...
Epoch: 31 cost time: 0.9021925926208496
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0331103801727295
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966665).  Saving model ...
Epoch: 33 cost time: 0.8080618381500244
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 34 cost time: 1.0831596851348877
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9228308200836182
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7696428298950195
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.069591999053955
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9368956089019775
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.1033148765563965
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.8841989040374756
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.139683723449707
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8753130435943604
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.745943546295166
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 10129858
model size : 43.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7090036869049072
Epoch: 1, Steps: 2 | Train Loss: 2.007 Vali Loss: 1.962 Vali Acc: 0.159 Test Loss: 1.962 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.7408802509307861
Epoch: 2, Steps: 2 | Train Loss: 2.107 Vali Loss: 1.924 Vali Acc: 0.159 Test Loss: 1.924 Test Acc: 0.159
Validation loss decreased (-0.159240 --> -0.159240).  Saving model ...
Epoch: 3 cost time: 0.9254698753356934
Epoch: 3, Steps: 2 | Train Loss: 1.911 Vali Loss: 1.852 Vali Acc: 0.152 Test Loss: 1.852 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0939359664916992
Epoch: 4, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.741 Vali Acc: 0.141 Test Loss: 1.741 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7348020076751709
Epoch: 5, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.654 Vali Acc: 0.426 Test Loss: 1.654 Test Acc: 0.426
Validation loss decreased (-0.159240 --> -0.425909).  Saving model ...
Epoch: 6 cost time: 0.7040407657623291
Epoch: 6, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.569 Vali Acc: 0.470 Test Loss: 1.569 Test Acc: 0.470
Validation loss decreased (-0.425909 --> -0.470355).  Saving model ...
Epoch: 7 cost time: 0.8126621246337891
Epoch: 7, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.463 Vali Acc: 0.493 Test Loss: 1.463 Test Acc: 0.493
Validation loss decreased (-0.470355 --> -0.492578).  Saving model ...
Epoch: 8 cost time: 0.9332418441772461
Epoch: 8, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.310 Vali Acc: 0.615 Test Loss: 1.310 Test Acc: 0.615
Validation loss decreased (-0.492578 --> -0.614802).  Saving model ...
Epoch: 9 cost time: 1.036787748336792
Epoch: 9, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.148 Vali Acc: 0.737 Test Loss: 1.148 Test Acc: 0.737
Validation loss decreased (-0.614802 --> -0.737026).  Saving model ...
Epoch: 10 cost time: 0.6664667129516602
Epoch: 10, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.002 Vali Acc: 0.837 Test Loss: 1.002 Test Acc: 0.837
Validation loss decreased (-0.737026 --> -0.837027).  Saving model ...
Epoch: 11 cost time: 0.8883106708526611
Epoch: 11, Steps: 2 | Train Loss: 0.953 Vali Loss: 0.864 Vali Acc: 0.889 Test Loss: 0.864 Test Acc: 0.889
Validation loss decreased (-0.837027 --> -0.888880).  Saving model ...
Epoch: 12 cost time: 0.993840217590332
Epoch: 12, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.740 Vali Acc: 0.904 Test Loss: 0.740 Test Acc: 0.904
Validation loss decreased (-0.888880 --> -0.903696).  Saving model ...
Epoch: 13 cost time: 0.6799085140228271
Epoch: 13, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.619 Vali Acc: 0.919 Test Loss: 0.619 Test Acc: 0.919
Validation loss decreased (-0.903696 --> -0.918512).  Saving model ...
Epoch: 14 cost time: 0.802072286605835
Epoch: 14, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.526 Vali Acc: 0.926 Test Loss: 0.526 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925921).  Saving model ...
Epoch: 15 cost time: 0.8334581851959229
Epoch: 15, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.465 Vali Acc: 0.919 Test Loss: 0.465 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8316347599029541
Epoch: 16, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.408 Vali Acc: 0.907 Test Loss: 0.408 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7800803184509277
Epoch: 17, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.358 Vali Acc: 0.937 Test Loss: 0.358 Test Acc: 0.937
Validation loss decreased (-0.925921 --> -0.937033).  Saving model ...
Epoch: 18 cost time: 0.798546552658081
Epoch: 18, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.327 Vali Acc: 0.933 Test Loss: 0.327 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7565197944641113
Epoch: 19, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.304 Vali Acc: 0.919 Test Loss: 0.304 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8288655281066895
Epoch: 20, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7777321338653564
Epoch: 21, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.253 Vali Acc: 0.956 Test Loss: 0.253 Test Acc: 0.956
Validation loss decreased (-0.944442 --> -0.955553).  Saving model ...
Epoch: 22 cost time: 0.8103079795837402
Epoch: 22, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.241 Vali Acc: 0.956 Test Loss: 0.241 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 23 cost time: 0.691981315612793
Epoch: 23, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.234 Vali Acc: 0.952 Test Loss: 0.234 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9604616165161133
Epoch: 24, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7482497692108154
Epoch: 25, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.733339786529541
Epoch: 26, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8260068893432617
Epoch: 27, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8359606266021729
Epoch: 28, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0042736530303955
Epoch: 29, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7303242683410645
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8555083274841309
Epoch: 31, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.7439975738525391
Epoch: 32, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 1.0257751941680908
Epoch: 33, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959258).  Saving model ...
Epoch: 34 cost time: 1.2463405132293701
Epoch: 34, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.959 Test Loss: 0.166 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 35 cost time: 1.04134202003479
Epoch: 35, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8209843635559082
Epoch: 36, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.167 Vali Acc: 0.963 Test Loss: 0.167 Test Acc: 0.963
Validation loss decreased (-0.959258 --> -0.962961).  Saving model ...
Epoch: 37 cost time: 0.9018287658691406
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9116568565368652
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7987728118896484
Epoch: 39, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.76904296875
Epoch: 40, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9013717174530029
Epoch: 41, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0335040092468262
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.156 Vali Acc: 0.959 Test Loss: 0.156 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8812751770019531
Epoch: 43, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 44 cost time: 0.8220207691192627
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7254855632781982
Epoch: 45, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8841941356658936
Epoch: 46, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7296717166900635
Epoch: 47, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8394098281860352
Epoch: 48, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7512829303741455
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7958343029022217
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.8294284343719482
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.9056751728057861
Epoch: 52, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.9746854305267334
Epoch: 53, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 4783298
model size : 20.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8144898414611816
Epoch: 1, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.780 Vali Acc: 0.344 Test Loss: 1.780 Test Acc: 0.344
Validation loss decreased (inf --> -0.344427).  Saving model ...
Epoch: 2 cost time: 0.8075361251831055
Epoch: 2, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.752 Vali Acc: 0.356 Test Loss: 1.752 Test Acc: 0.356
Validation loss decreased (-0.344427 --> -0.355538).  Saving model ...
Epoch: 3 cost time: 0.6862633228302002
Epoch: 3, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.690 Vali Acc: 0.374 Test Loss: 1.690 Test Acc: 0.374
Validation loss decreased (-0.355538 --> -0.374057).  Saving model ...
Epoch: 4 cost time: 0.8254597187042236
Epoch: 4, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.590 Vali Acc: 0.559 Test Loss: 1.590 Test Acc: 0.559
Validation loss decreased (-0.374057 --> -0.559243).  Saving model ...
Epoch: 5 cost time: 0.8246963024139404
Epoch: 5, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.510 Vali Acc: 0.633 Test Loss: 1.510 Test Acc: 0.633
Validation loss decreased (-0.559243 --> -0.633318).  Saving model ...
Epoch: 6 cost time: 0.9229178428649902
Epoch: 6, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.423 Vali Acc: 0.656 Test Loss: 1.423 Test Acc: 0.656
Validation loss decreased (-0.633318 --> -0.655541).  Saving model ...
Epoch: 7 cost time: 1.0674679279327393
Epoch: 7, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.285 Vali Acc: 0.715 Test Loss: 1.285 Test Acc: 0.715
Validation loss decreased (-0.655541 --> -0.714802).  Saving model ...
Epoch: 8 cost time: 0.7451601028442383
Epoch: 8, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.132 Vali Acc: 0.796 Test Loss: 1.132 Test Acc: 0.796
Validation loss decreased (-0.714802 --> -0.796285).  Saving model ...
Epoch: 9 cost time: 0.8177697658538818
Epoch: 9, Steps: 2 | Train Loss: 1.070 Vali Loss: 0.985 Vali Acc: 0.822 Test Loss: 0.985 Test Acc: 0.822
Validation loss decreased (-0.796285 --> -0.822212).  Saving model ...
Epoch: 10 cost time: 0.9456734657287598
Epoch: 10, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.868 Vali Acc: 0.811 Test Loss: 0.868 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8045032024383545
Epoch: 11, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.748 Vali Acc: 0.833 Test Loss: 0.748 Test Acc: 0.833
Validation loss decreased (-0.822212 --> -0.833326).  Saving model ...
Epoch: 12 cost time: 0.7940254211425781
Epoch: 12, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.633 Vali Acc: 0.870 Test Loss: 0.633 Test Acc: 0.870
Validation loss decreased (-0.833326 --> -0.870364).  Saving model ...
Epoch: 13 cost time: 0.7867774963378906
Epoch: 13, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.534 Vali Acc: 0.911 Test Loss: 0.534 Test Acc: 0.911
Validation loss decreased (-0.870364 --> -0.911106).  Saving model ...
Epoch: 14 cost time: 0.8211464881896973
Epoch: 14, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.470 Vali Acc: 0.907 Test Loss: 0.470 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8857424259185791
Epoch: 15, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7742924690246582
Epoch: 16, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.421 Vali Acc: 0.885 Test Loss: 0.421 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8647713661193848
Epoch: 17, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.382 Vali Acc: 0.896 Test Loss: 0.382 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0470302104949951
Epoch: 18, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.332 Vali Acc: 0.926 Test Loss: 0.332 Test Acc: 0.926
Validation loss decreased (-0.911106 --> -0.925923).  Saving model ...
Epoch: 19 cost time: 0.9304525852203369
Epoch: 19, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8469851016998291
Epoch: 20, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.317 Vali Acc: 0.922 Test Loss: 0.317 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8284902572631836
Epoch: 21, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.348 Vali Acc: 0.893 Test Loss: 0.348 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9881997108459473
Epoch: 22, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.343 Vali Acc: 0.893 Test Loss: 0.343 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.01711106300354
Epoch: 23, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8057601451873779
Epoch: 24, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.265 Vali Acc: 0.907 Test Loss: 0.265 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.74324631690979
Epoch: 25, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.255 Vali Acc: 0.915 Test Loss: 0.255 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.98665452003479
Epoch: 26, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.253 Vali Acc: 0.919 Test Loss: 0.253 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0418283939361572
Epoch: 27, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.258 Vali Acc: 0.915 Test Loss: 0.258 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8853812217712402
Epoch: 28, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.266 Vali Acc: 0.915 Test Loss: 0.266 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 4781762
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.462785005569458
Epoch: 1, Steps: 2 | Train Loss: 2.008 Vali Loss: 1.904 Vali Acc: 0.311 Test Loss: 1.904 Test Acc: 0.311
Validation loss decreased (inf --> -0.311092).  Saving model ...
Epoch: 2 cost time: 0.888099193572998
Epoch: 2, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.870 Vali Acc: 0.363 Test Loss: 1.870 Test Acc: 0.363
Validation loss decreased (-0.311092 --> -0.362944).  Saving model ...
Epoch: 3 cost time: 0.890190601348877
Epoch: 3, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.800 Vali Acc: 0.378 Test Loss: 1.800 Test Acc: 0.378
Validation loss decreased (-0.362944 --> -0.377760).  Saving model ...
Epoch: 4 cost time: 0.7301120758056641
Epoch: 4, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.681 Vali Acc: 0.344 Test Loss: 1.681 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0702250003814697
Epoch: 5, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.584 Vali Acc: 0.341 Test Loss: 1.584 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9941413402557373
Epoch: 6, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.494 Vali Acc: 0.378 Test Loss: 1.494 Test Acc: 0.378
Validation loss decreased (-0.377760 --> -0.377763).  Saving model ...
Epoch: 7 cost time: 0.75579833984375
Epoch: 7, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.382 Vali Acc: 0.519 Test Loss: 1.382 Test Acc: 0.519
Validation loss decreased (-0.377763 --> -0.518505).  Saving model ...
Epoch: 8 cost time: 0.7953677177429199
Epoch: 8, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.223 Vali Acc: 0.715 Test Loss: 1.223 Test Acc: 0.715
Validation loss decreased (-0.518505 --> -0.714803).  Saving model ...
Epoch: 9 cost time: 0.911290168762207
Epoch: 9, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.061 Vali Acc: 0.815 Test Loss: 1.061 Test Acc: 0.815
Validation loss decreased (-0.714803 --> -0.814804).  Saving model ...
Epoch: 10 cost time: 1.0321450233459473
Epoch: 10, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.934 Vali Acc: 0.819 Test Loss: 0.934 Test Acc: 0.819
Validation loss decreased (-0.814804 --> -0.818509).  Saving model ...
Epoch: 11 cost time: 0.8059823513031006
Epoch: 11, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.821 Vali Acc: 0.819 Test Loss: 0.821 Test Acc: 0.819
Validation loss decreased (-0.818509 --> -0.818510).  Saving model ...
Epoch: 12 cost time: 0.7372972965240479
Epoch: 12, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.707 Vali Acc: 0.852 Test Loss: 0.707 Test Acc: 0.852
Validation loss decreased (-0.818510 --> -0.851845).  Saving model ...
Epoch: 13 cost time: 0.8823609352111816
Epoch: 13, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.608 Vali Acc: 0.863 Test Loss: 0.608 Test Acc: 0.863
Validation loss decreased (-0.851845 --> -0.862957).  Saving model ...
Epoch: 14 cost time: 0.8066070079803467
Epoch: 14, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.523 Vali Acc: 0.911 Test Loss: 0.523 Test Acc: 0.911
Validation loss decreased (-0.862957 --> -0.911106).  Saving model ...
Epoch: 15 cost time: 0.748488187789917
Epoch: 15, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.463 Vali Acc: 0.919 Test Loss: 0.463 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 16 cost time: 0.9302384853363037
Epoch: 16, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.429 Vali Acc: 0.893 Test Loss: 0.429 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7897758483886719
Epoch: 17, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7997939586639404
Epoch: 18, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.363 Vali Acc: 0.907 Test Loss: 0.363 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.879457950592041
Epoch: 19, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.328 Vali Acc: 0.907 Test Loss: 0.328 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.783066987991333
Epoch: 20, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0715432167053223
Epoch: 21, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918516).  Saving model ...
Epoch: 22 cost time: 0.9011034965515137
Epoch: 22, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922219).  Saving model ...
Epoch: 23 cost time: 0.9595391750335693
Epoch: 23, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.276 Vali Acc: 0.915 Test Loss: 0.276 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.840712308883667
Epoch: 24, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.274 Vali Acc: 0.919 Test Loss: 0.274 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8944017887115479
Epoch: 25, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.263 Vali Acc: 0.919 Test Loss: 0.263 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8342154026031494
Epoch: 26, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 27 cost time: 0.7833755016326904
Epoch: 27, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.8655109405517578
Epoch: 28, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.9899311065673828
Epoch: 29, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8168015480041504
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.8132026195526123
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.937035 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 0.9703917503356934
Epoch: 32, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.929091215133667
Epoch: 33, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8097918033599854
Epoch: 34, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8400938510894775
Epoch: 35, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8631396293640137
Epoch: 36, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9148132801055908
Epoch: 37, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.877424955368042
Epoch: 38, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.9494905471801758
Epoch: 39, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.8233389854431152
Epoch: 40, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.9651908874511719
Epoch: 41, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.8457574844360352
Epoch: 42, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9512627124786377
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9005870819091797
Epoch: 44, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9196898937225342
Epoch: 45, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8155205249786377
Epoch: 46, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7474744319915771
Epoch: 47, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7970399856567383
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9256002902984619
Epoch: 49, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.846848726272583
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.890927791595459
Epoch: 51, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 4780226
model size : 20.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2007532119750977
Epoch: 1, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.909 Vali Acc: 0.163 Test Loss: 1.909 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.7776005268096924
Epoch: 2, Steps: 2 | Train Loss: 1.970 Vali Loss: 1.869 Vali Acc: 0.163 Test Loss: 1.869 Test Acc: 0.163
Validation loss decreased (-0.162944 --> -0.162944).  Saving model ...
Epoch: 3 cost time: 0.8120284080505371
Epoch: 3, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.799 Vali Acc: 0.174 Test Loss: 1.799 Test Acc: 0.174
Validation loss decreased (-0.162944 --> -0.174056).  Saving model ...
Epoch: 4 cost time: 0.7891402244567871
Epoch: 4, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.706 Vali Acc: 0.185 Test Loss: 1.706 Test Acc: 0.185
Validation loss decreased (-0.174056 --> -0.185168).  Saving model ...
Epoch: 5 cost time: 0.7011756896972656
Epoch: 5, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.634 Vali Acc: 0.341 Test Loss: 1.634 Test Acc: 0.341
Validation loss decreased (-0.185168 --> -0.340724).  Saving model ...
Epoch: 6 cost time: 0.8178200721740723
Epoch: 6, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.540 Vali Acc: 0.419 Test Loss: 1.540 Test Acc: 0.419
Validation loss decreased (-0.340724 --> -0.418503).  Saving model ...
Epoch: 7 cost time: 0.8058538436889648
Epoch: 7, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.395 Vali Acc: 0.630 Test Loss: 1.395 Test Acc: 0.630
Validation loss decreased (-0.418503 --> -0.629616).  Saving model ...
Epoch: 8 cost time: 0.6886105537414551
Epoch: 8, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.239 Vali Acc: 0.685 Test Loss: 1.239 Test Acc: 0.685
Validation loss decreased (-0.629616 --> -0.685173).  Saving model ...
Epoch: 9 cost time: 0.7508161067962646
Epoch: 9, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.095 Vali Acc: 0.763 Test Loss: 1.095 Test Acc: 0.763
Validation loss decreased (-0.685173 --> -0.762952).  Saving model ...
Epoch: 10 cost time: 0.8056511878967285
Epoch: 10, Steps: 2 | Train Loss: 1.010 Vali Loss: 0.961 Vali Acc: 0.870 Test Loss: 0.961 Test Acc: 0.870
Validation loss decreased (-0.762952 --> -0.870361).  Saving model ...
Epoch: 11 cost time: 0.8315086364746094
Epoch: 11, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.823 Vali Acc: 0.915 Test Loss: 0.823 Test Acc: 0.915
Validation loss decreased (-0.870361 --> -0.914807).  Saving model ...
Epoch: 12 cost time: 0.8490679264068604
Epoch: 12, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.709 Vali Acc: 0.889 Test Loss: 0.709 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6784365177154541
Epoch: 13, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.615 Vali Acc: 0.896 Test Loss: 0.615 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6708230972290039
Epoch: 14, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.533 Vali Acc: 0.922 Test Loss: 0.533 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922217).  Saving model ...
Epoch: 15 cost time: 0.771979570388794
Epoch: 15, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.466 Vali Acc: 0.937 Test Loss: 0.466 Test Acc: 0.937
Validation loss decreased (-0.922217 --> -0.937032).  Saving model ...
Epoch: 16 cost time: 0.8154404163360596
Epoch: 16, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.417 Vali Acc: 0.937 Test Loss: 0.417 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 17 cost time: 0.8769006729125977
Epoch: 17, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.379 Vali Acc: 0.930 Test Loss: 0.379 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7537031173706055
Epoch: 18, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7950410842895508
Epoch: 19, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.332 Vali Acc: 0.922 Test Loss: 0.332 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7238154411315918
Epoch: 20, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.313 Vali Acc: 0.930 Test Loss: 0.313 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6542294025421143
Epoch: 21, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.285 Vali Acc: 0.948 Test Loss: 0.285 Test Acc: 0.948
Validation loss decreased (-0.937033 --> -0.948145).  Saving model ...
Epoch: 22 cost time: 0.9103589057922363
Epoch: 22, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.263 Vali Acc: 0.952 Test Loss: 0.263 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 23 cost time: 0.8113033771514893
Epoch: 23, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.258 Vali Acc: 0.952 Test Loss: 0.258 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 24 cost time: 0.8425595760345459
Epoch: 24, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8385403156280518
Epoch: 25, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7730445861816406
Epoch: 26, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.239 Vali Acc: 0.952 Test Loss: 0.239 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 27 cost time: 0.9214730262756348
Epoch: 27, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7871823310852051
Epoch: 28, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8176653385162354
Epoch: 29, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.957406759262085
Epoch: 30, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.830157995223999
Epoch: 31, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9117276668548584
Epoch: 32, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7972934246063232
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.749377965927124
Epoch: 34, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8430445194244385
Epoch: 35, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8282225131988525
Epoch: 36, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 4778690
model size : 20.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.541311740875244
Epoch: 1, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.712 Vali Acc: 0.315 Test Loss: 1.712 Test Acc: 0.315
Validation loss decreased (inf --> -0.314798).  Saving model ...
Epoch: 2 cost time: 0.7134594917297363
Epoch: 2, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.685 Vali Acc: 0.326 Test Loss: 1.685 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325909).  Saving model ...
Epoch: 3 cost time: 0.7307925224304199
Epoch: 3, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.628 Vali Acc: 0.415 Test Loss: 1.628 Test Acc: 0.415
Validation loss decreased (-0.325909 --> -0.414799).  Saving model ...
Epoch: 4 cost time: 0.8152103424072266
Epoch: 4, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.539 Vali Acc: 0.619 Test Loss: 1.539 Test Acc: 0.619
Validation loss decreased (-0.414799 --> -0.618503).  Saving model ...
Epoch: 5 cost time: 1.0607616901397705
Epoch: 5, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.465 Vali Acc: 0.622 Test Loss: 1.465 Test Acc: 0.622
Validation loss decreased (-0.618503 --> -0.622208).  Saving model ...
Epoch: 6 cost time: 0.9879484176635742
Epoch: 6, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.383 Vali Acc: 0.556 Test Loss: 1.383 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0058374404907227
Epoch: 7, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.263 Vali Acc: 0.652 Test Loss: 1.263 Test Acc: 0.652
Validation loss decreased (-0.622208 --> -0.651839).  Saving model ...
Epoch: 8 cost time: 1.04398512840271
Epoch: 8, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.125 Vali Acc: 0.826 Test Loss: 1.125 Test Acc: 0.826
Validation loss decreased (-0.651839 --> -0.825915).  Saving model ...
Epoch: 9 cost time: 0.8030385971069336
Epoch: 9, Steps: 2 | Train Loss: 1.075 Vali Loss: 0.996 Vali Acc: 0.881 Test Loss: 0.996 Test Acc: 0.881
Validation loss decreased (-0.825915 --> -0.881472).  Saving model ...
Epoch: 10 cost time: 0.9098830223083496
Epoch: 10, Steps: 2 | Train Loss: 0.939 Vali Loss: 0.883 Vali Acc: 0.893 Test Loss: 0.883 Test Acc: 0.893
Validation loss decreased (-0.881472 --> -0.892584).  Saving model ...
Epoch: 11 cost time: 0.9687373638153076
Epoch: 11, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.768 Vali Acc: 0.907 Test Loss: 0.768 Test Acc: 0.907
Validation loss decreased (-0.892584 --> -0.907400).  Saving model ...
Epoch: 12 cost time: 0.9678013324737549
Epoch: 12, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.670 Vali Acc: 0.926 Test Loss: 0.670 Test Acc: 0.926
Validation loss decreased (-0.907400 --> -0.925919).  Saving model ...
Epoch: 13 cost time: 0.8330323696136475
Epoch: 13, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.600 Vali Acc: 0.907 Test Loss: 0.600 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8507814407348633
Epoch: 14, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.537 Vali Acc: 0.907 Test Loss: 0.537 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7797145843505859
Epoch: 15, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.471 Vali Acc: 0.926 Test Loss: 0.471 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925921).  Saving model ...
Epoch: 16 cost time: 1.025071382522583
Epoch: 16, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.422 Vali Acc: 0.930 Test Loss: 0.422 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 17 cost time: 1.0074870586395264
Epoch: 17, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.382 Vali Acc: 0.930 Test Loss: 0.382 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 18 cost time: 1.0231270790100098
Epoch: 18, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.354 Vali Acc: 0.911 Test Loss: 0.354 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9210669994354248
Epoch: 19, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.336 Vali Acc: 0.904 Test Loss: 0.336 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9912552833557129
Epoch: 20, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9147050380706787
Epoch: 21, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2059462070465088
Epoch: 22, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940738).  Saving model ...
Epoch: 23 cost time: 0.9774277210235596
Epoch: 23, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.265 Vali Acc: 0.948 Test Loss: 0.265 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948145).  Saving model ...
Epoch: 24 cost time: 0.8978595733642578
Epoch: 24, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 25 cost time: 1.0198891162872314
Epoch: 25, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0974328517913818
Epoch: 26, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9104909896850586
Epoch: 27, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8302693367004395
Epoch: 28, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0185167789459229
Epoch: 29, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.952610969543457
Epoch: 30, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.952 Test Loss: 0.223 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.7922687530517578
Epoch: 31, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.7748723030090332
Epoch: 32, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.211 Vali Acc: 0.952 Test Loss: 0.211 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 33 cost time: 0.94795823097229
Epoch: 33, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.952 Test Loss: 0.209 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 34 cost time: 1.0717604160308838
Epoch: 34, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.209 Vali Acc: 0.952 Test Loss: 0.209 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 1.0348179340362549
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.952 Test Loss: 0.211 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8114988803863525
Epoch: 36, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8918168544769287
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9546711444854736
Epoch: 38, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8120474815368652
Epoch: 39, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.207 Vali Acc: 0.952 Test Loss: 0.207 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.8488428592681885
Epoch: 40, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 41 cost time: 1.1324927806854248
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.202 Vali Acc: 0.956 Test Loss: 0.202 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 42 cost time: 0.7498922348022461
Epoch: 42, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9214217662811279
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.843306303024292
Epoch: 44, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9865427017211914
Epoch: 45, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.229341745376587
Epoch: 46, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2278616428375244
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.76723313331604
Epoch: 48, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.846062421798706
Epoch: 49, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.989365816116333
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.0250728130340576
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 3599042
model size : 16.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.476227283477783
Epoch: 1, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.827 Vali Acc: 0.196 Test Loss: 1.827 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.8172421455383301
Epoch: 2, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.795 Vali Acc: 0.200 Test Loss: 1.795 Test Acc: 0.200
Validation loss decreased (-0.196278 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.804893970489502
Epoch: 3, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.743 Vali Acc: 0.274 Test Loss: 1.743 Test Acc: 0.274
Validation loss decreased (-0.199982 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 0.8302292823791504
Epoch: 4, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.663 Vali Acc: 0.385 Test Loss: 1.663 Test Acc: 0.385
Validation loss decreased (-0.274057 --> -0.385169).  Saving model ...
Epoch: 5 cost time: 0.913769006729126
Epoch: 5, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.591 Vali Acc: 0.511 Test Loss: 1.591 Test Acc: 0.511
Validation loss decreased (-0.385169 --> -0.511095).  Saving model ...
Epoch: 6 cost time: 0.8154036998748779
Epoch: 6, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.530 Vali Acc: 0.500 Test Loss: 1.530 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9932079315185547
Epoch: 7, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.433 Vali Acc: 0.541 Test Loss: 1.433 Test Acc: 0.541
Validation loss decreased (-0.511095 --> -0.540726).  Saving model ...
Epoch: 8 cost time: 0.7266795635223389
Epoch: 8, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.303 Vali Acc: 0.633 Test Loss: 1.303 Test Acc: 0.633
Validation loss decreased (-0.540726 --> -0.633320).  Saving model ...
Epoch: 9 cost time: 0.7986769676208496
Epoch: 9, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.169 Vali Acc: 0.778 Test Loss: 1.169 Test Acc: 0.778
Validation loss decreased (-0.633320 --> -0.777766).  Saving model ...
Epoch: 10 cost time: 0.9356634616851807
Epoch: 10, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.037 Vali Acc: 0.867 Test Loss: 1.037 Test Acc: 0.867
Validation loss decreased (-0.777766 --> -0.866656).  Saving model ...
Epoch: 11 cost time: 0.9659569263458252
Epoch: 11, Steps: 2 | Train Loss: 0.929 Vali Loss: 0.913 Vali Acc: 0.867 Test Loss: 0.913 Test Acc: 0.867
Validation loss decreased (-0.866656 --> -0.866658).  Saving model ...
Epoch: 12 cost time: 0.9929540157318115
Epoch: 12, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.796 Vali Acc: 0.870 Test Loss: 0.796 Test Acc: 0.870
Validation loss decreased (-0.866658 --> -0.870362).  Saving model ...
Epoch: 13 cost time: 0.8268918991088867
Epoch: 13, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.696 Vali Acc: 0.852 Test Loss: 0.696 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.904212236404419
Epoch: 14, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.618 Vali Acc: 0.878 Test Loss: 0.618 Test Acc: 0.878
Validation loss decreased (-0.870362 --> -0.877772).  Saving model ...
Epoch: 15 cost time: 1.004807710647583
Epoch: 15, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.548 Vali Acc: 0.893 Test Loss: 0.548 Test Acc: 0.893
Validation loss decreased (-0.877772 --> -0.892587).  Saving model ...
Epoch: 16 cost time: 1.0269298553466797
Epoch: 16, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.478 Vali Acc: 0.922 Test Loss: 0.478 Test Acc: 0.922
Validation loss decreased (-0.892587 --> -0.922217).  Saving model ...
Epoch: 17 cost time: 1.0601439476013184
Epoch: 17, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.434 Vali Acc: 0.926 Test Loss: 0.434 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925922).  Saving model ...
Epoch: 18 cost time: 1.066974401473999
Epoch: 18, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.397 Vali Acc: 0.922 Test Loss: 0.397 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8386819362640381
Epoch: 19, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.373 Vali Acc: 0.926 Test Loss: 0.373 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 20 cost time: 0.8451969623565674
Epoch: 20, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.369 Vali Acc: 0.907 Test Loss: 0.369 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8878862857818604
Epoch: 21, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.352 Vali Acc: 0.926 Test Loss: 0.352 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.8402516841888428
Epoch: 22, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.326 Vali Acc: 0.933 Test Loss: 0.326 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 23 cost time: 0.9680314064025879
Epoch: 23, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7132830619812012
Epoch: 24, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.284 Vali Acc: 0.937 Test Loss: 0.284 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 25 cost time: 0.8038246631622314
Epoch: 25, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 26 cost time: 1.0122196674346924
Epoch: 26, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 27 cost time: 0.8215999603271484
Epoch: 27, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.060671329498291
Epoch: 28, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.184788465499878
Epoch: 29, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8395476341247559
Epoch: 30, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7997615337371826
Epoch: 31, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 1.0559704303741455
Epoch: 32, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.225 Vali Acc: 0.948 Test Loss: 0.225 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 1.3414051532745361
Epoch: 33, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 1.0205397605895996
Epoch: 34, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7975168228149414
Epoch: 35, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.784254789352417
Epoch: 36, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0553648471832275
Epoch: 37, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1107561588287354
Epoch: 38, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.9355669021606445
Epoch: 39, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.0620338916778564
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.1096000671386719
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.8870141506195068
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 1.0042650699615479
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.786461591720581
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.8639051914215088
Epoch: 45, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.8642528057098389
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0667383670806885
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9088854789733887
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7526121139526367
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8968460559844971
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8837423324584961
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.8597819805145264
Epoch: 52, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.7785568237304688
Epoch: 53, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.8370237350463867
Epoch: 54, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9355018138885498
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 3597506
model size : 16.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2955267429351807
Epoch: 1, Steps: 2 | Train Loss: 1.957 Vali Loss: 1.859 Vali Acc: 0.185 Test Loss: 1.859 Test Acc: 0.185
Validation loss decreased (inf --> -0.185167).  Saving model ...
Epoch: 2 cost time: 0.8587934970855713
Epoch: 2, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.822 Vali Acc: 0.256 Test Loss: 1.822 Test Acc: 0.256
Validation loss decreased (-0.185167 --> -0.255537).  Saving model ...
Epoch: 3 cost time: 0.8633248805999756
Epoch: 3, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.765 Vali Acc: 0.311 Test Loss: 1.765 Test Acc: 0.311
Validation loss decreased (-0.255537 --> -0.311093).  Saving model ...
Epoch: 4 cost time: 0.8368618488311768
Epoch: 4, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.671 Vali Acc: 0.485 Test Loss: 1.671 Test Acc: 0.485
Validation loss decreased (-0.311093 --> -0.485168).  Saving model ...
Epoch: 5 cost time: 0.9762160778045654
Epoch: 5, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.599 Vali Acc: 0.541 Test Loss: 1.599 Test Acc: 0.541
Validation loss decreased (-0.485168 --> -0.540725).  Saving model ...
Epoch: 6 cost time: 0.973196268081665
Epoch: 6, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.546 Vali Acc: 0.400 Test Loss: 1.546 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9434518814086914
Epoch: 7, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.462 Vali Acc: 0.507 Test Loss: 1.462 Test Acc: 0.507
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.000281572341919
Epoch: 8, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.347 Vali Acc: 0.615 Test Loss: 1.347 Test Acc: 0.615
Validation loss decreased (-0.540725 --> -0.614801).  Saving model ...
Epoch: 9 cost time: 0.7309894561767578
Epoch: 9, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.225 Vali Acc: 0.744 Test Loss: 1.225 Test Acc: 0.744
Validation loss decreased (-0.614801 --> -0.744432).  Saving model ...
Epoch: 10 cost time: 0.7224869728088379
Epoch: 10, Steps: 2 | Train Loss: 1.171 Vali Loss: 1.108 Vali Acc: 0.804 Test Loss: 1.108 Test Acc: 0.804
Validation loss decreased (-0.744432 --> -0.803693).  Saving model ...
Epoch: 11 cost time: 0.8630805015563965
Epoch: 11, Steps: 2 | Train Loss: 1.016 Vali Loss: 0.996 Vali Acc: 0.800 Test Loss: 0.996 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9073679447174072
Epoch: 12, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.871 Vali Acc: 0.833 Test Loss: 0.871 Test Acc: 0.833
Validation loss decreased (-0.803693 --> -0.833325).  Saving model ...
Epoch: 13 cost time: 0.8139591217041016
Epoch: 13, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.752 Vali Acc: 0.863 Test Loss: 0.752 Test Acc: 0.863
Validation loss decreased (-0.833325 --> -0.862955).  Saving model ...
Epoch: 14 cost time: 0.7446908950805664
Epoch: 14, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.656 Vali Acc: 0.889 Test Loss: 0.656 Test Acc: 0.889
Validation loss decreased (-0.862955 --> -0.888882).  Saving model ...
Epoch: 15 cost time: 0.8716340065002441
Epoch: 15, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.578 Vali Acc: 0.885 Test Loss: 0.578 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.957871675491333
Epoch: 16, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.504 Vali Acc: 0.919 Test Loss: 0.504 Test Acc: 0.919
Validation loss decreased (-0.888882 --> -0.918513).  Saving model ...
Epoch: 17 cost time: 0.7504448890686035
Epoch: 17, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.448 Vali Acc: 0.937 Test Loss: 0.448 Test Acc: 0.937
Validation loss decreased (-0.918513 --> -0.937033).  Saving model ...
Epoch: 18 cost time: 0.8038475513458252
Epoch: 18, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.414 Vali Acc: 0.937 Test Loss: 0.414 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 19 cost time: 1.0193078517913818
Epoch: 19, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.387 Vali Acc: 0.933 Test Loss: 0.387 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8391373157501221
Epoch: 20, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.357 Vali Acc: 0.933 Test Loss: 0.357 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0929312705993652
Epoch: 21, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.333 Vali Acc: 0.937 Test Loss: 0.333 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 0.8606867790222168
Epoch: 22, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.311 Vali Acc: 0.933 Test Loss: 0.311 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7830216884613037
Epoch: 23, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 24 cost time: 0.9707541465759277
Epoch: 24, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 25 cost time: 0.8154637813568115
Epoch: 25, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.278 Vali Acc: 0.937 Test Loss: 0.278 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9705278873443604
Epoch: 26, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9948627948760986
Epoch: 27, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7420270442962646
Epoch: 28, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7706851959228516
Epoch: 29, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7282669544219971
Epoch: 30, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 31 cost time: 0.8088474273681641
Epoch: 31, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8798506259918213
Epoch: 32, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7822599411010742
Epoch: 33, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7551102638244629
Epoch: 34, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.7808411121368408
Epoch: 35, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.8701841831207275
Epoch: 36, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.790203332901001
Epoch: 37, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7248861789703369
Epoch: 38, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7974424362182617
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8196728229522705
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7409350872039795
Epoch: 41, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8014676570892334
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.7451894283294678
Epoch: 43, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.8438758850097656
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.8369400501251221
Epoch: 45, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.9033839702606201
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.800203800201416
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.783888578414917
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8968629837036133
Epoch: 49, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.085972785949707
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.9001874923706055
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9840750694274902
Epoch: 52, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 53 cost time: 0.6969730854034424
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.731597900390625
Epoch: 54, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7595083713531494
Epoch: 55, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.878957986831665
Epoch: 56, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9220855236053467
Epoch: 57, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.3984746932983398
Epoch: 58, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.8765356540679932
Epoch: 59, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.9405219554901123
Epoch: 60, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.704033613204956
Epoch: 61, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.9594378471374512
Epoch: 62, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 3595970
model size : 16.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.970378875732422
Epoch: 1, Steps: 2 | Train Loss: 2.097 Vali Loss: 2.028 Vali Acc: 0.167 Test Loss: 2.028 Test Acc: 0.167
Validation loss decreased (inf --> -0.166646).  Saving model ...
Epoch: 2 cost time: 0.982964038848877
Epoch: 2, Steps: 2 | Train Loss: 2.097 Vali Loss: 1.976 Vali Acc: 0.167 Test Loss: 1.976 Test Acc: 0.167
Validation loss decreased (-0.166646 --> -0.166647).  Saving model ...
Epoch: 3 cost time: 0.8406322002410889
Epoch: 3, Steps: 2 | Train Loss: 2.053 Vali Loss: 1.894 Vali Acc: 0.163 Test Loss: 1.894 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8882184028625488
Epoch: 4, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.774 Vali Acc: 0.259 Test Loss: 1.774 Test Acc: 0.259
Validation loss decreased (-0.166647 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 0.9484474658966064
Epoch: 5, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.688 Vali Acc: 0.237 Test Loss: 1.688 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8756258487701416
Epoch: 6, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.629 Vali Acc: 0.363 Test Loss: 1.629 Test Acc: 0.363
Validation loss decreased (-0.259242 --> -0.362947).  Saving model ...
Epoch: 7 cost time: 0.8578011989593506
Epoch: 7, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.549 Vali Acc: 0.448 Test Loss: 1.549 Test Acc: 0.448
Validation loss decreased (-0.362947 --> -0.448133).  Saving model ...
Epoch: 8 cost time: 0.7910451889038086
Epoch: 8, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.433 Vali Acc: 0.648 Test Loss: 1.433 Test Acc: 0.648
Validation loss decreased (-0.448133 --> -0.648134).  Saving model ...
Epoch: 9 cost time: 1.0317342281341553
Epoch: 9, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.303 Vali Acc: 0.752 Test Loss: 1.303 Test Acc: 0.752
Validation loss decreased (-0.648134 --> -0.751839).  Saving model ...
Epoch: 10 cost time: 0.8440811634063721
Epoch: 10, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.172 Vali Acc: 0.807 Test Loss: 1.172 Test Acc: 0.807
Validation loss decreased (-0.751839 --> -0.807396).  Saving model ...
Epoch: 11 cost time: 0.7368283271789551
Epoch: 11, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.061 Vali Acc: 0.770 Test Loss: 1.061 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9848029613494873
Epoch: 12, Steps: 2 | Train Loss: 0.982 Vali Loss: 0.953 Vali Acc: 0.789 Test Loss: 0.953 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8420932292938232
Epoch: 13, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.843 Vali Acc: 0.844 Test Loss: 0.843 Test Acc: 0.844
Validation loss decreased (-0.807396 --> -0.844436).  Saving model ...
Epoch: 14 cost time: 0.9210705757141113
Epoch: 14, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.737 Vali Acc: 0.904 Test Loss: 0.737 Test Acc: 0.904
Validation loss decreased (-0.844436 --> -0.903696).  Saving model ...
Epoch: 15 cost time: 0.7126727104187012
Epoch: 15, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.640 Vali Acc: 0.907 Test Loss: 0.640 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907401).  Saving model ...
Epoch: 16 cost time: 0.8640129566192627
Epoch: 16, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.559 Vali Acc: 0.919 Test Loss: 0.559 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 17 cost time: 1.0487902164459229
Epoch: 17, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.513 Vali Acc: 0.896 Test Loss: 0.513 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9136300086975098
Epoch: 18, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.443 Vali Acc: 0.907 Test Loss: 0.443 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0779330730438232
Epoch: 19, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.396 Vali Acc: 0.915 Test Loss: 0.396 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7294332981109619
Epoch: 20, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.365 Vali Acc: 0.926 Test Loss: 0.365 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 1.0140092372894287
Epoch: 21, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 22 cost time: 0.9244723320007324
Epoch: 22, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.298 Vali Acc: 0.941 Test Loss: 0.298 Test Acc: 0.941
Validation loss decreased (-0.925923 --> -0.940738).  Saving model ...
Epoch: 23 cost time: 0.9755268096923828
Epoch: 23, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.293 Vali Acc: 0.926 Test Loss: 0.293 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8525335788726807
Epoch: 24, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.797673225402832
Epoch: 25, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 26 cost time: 0.8065917491912842
Epoch: 26, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 27 cost time: 0.83860182762146
Epoch: 27, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
Validation loss decreased (-0.944442 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.9876039028167725
Epoch: 28, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.215 Vali Acc: 0.952 Test Loss: 0.215 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 1.0382912158966064
Epoch: 29, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7516264915466309
Epoch: 30, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.232 Vali Acc: 0.952 Test Loss: 0.232 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9469518661499023
Epoch: 31, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.229 Vali Acc: 0.952 Test Loss: 0.229 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8858778476715088
Epoch: 32, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.011307716369629
Epoch: 33, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8658418655395508
Epoch: 34, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9014451503753662
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 1.2118775844573975
Epoch: 36, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.9208667278289795
Epoch: 37, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 38 cost time: 1.014423131942749
Epoch: 38, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8294112682342529
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8837652206420898
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8160700798034668
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8605988025665283
Epoch: 42, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8619430065155029
Epoch: 43, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0144374370574951
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.96708083152771
Epoch: 45, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9306581020355225
Epoch: 46, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8981523513793945
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 3594434
model size : 16.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3791146278381348
Epoch: 1, Steps: 2 | Train Loss: 2.114 Vali Loss: 2.147 Vali Acc: 0.089 Test Loss: 2.147 Test Acc: 0.089
Validation loss decreased (inf --> -0.088867).  Saving model ...
Epoch: 2 cost time: 1.0031790733337402
Epoch: 2, Steps: 2 | Train Loss: 2.097 Vali Loss: 2.104 Vali Acc: 0.107 Test Loss: 2.104 Test Acc: 0.107
Validation loss decreased (-0.088867 --> -0.107386).  Saving model ...
Epoch: 3 cost time: 0.7000217437744141
Epoch: 3, Steps: 2 | Train Loss: 2.183 Vali Loss: 2.035 Vali Acc: 0.111 Test Loss: 2.035 Test Acc: 0.111
Validation loss decreased (-0.107386 --> -0.111091).  Saving model ...
Epoch: 4 cost time: 0.9590911865234375
Epoch: 4, Steps: 2 | Train Loss: 2.009 Vali Loss: 1.922 Vali Acc: 0.093 Test Loss: 1.922 Test Acc: 0.093
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8934760093688965
Epoch: 5, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.822 Vali Acc: 0.096 Test Loss: 1.822 Test Acc: 0.096
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8396060466766357
Epoch: 6, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.745 Vali Acc: 0.185 Test Loss: 1.745 Test Acc: 0.185
Validation loss decreased (-0.111091 --> -0.185168).  Saving model ...
Epoch: 7 cost time: 1.113312005996704
Epoch: 7, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.679 Vali Acc: 0.267 Test Loss: 1.679 Test Acc: 0.267
Validation loss decreased (-0.185168 --> -0.266650).  Saving model ...
Epoch: 8 cost time: 0.8706469535827637
Epoch: 8, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.592 Vali Acc: 0.326 Test Loss: 1.592 Test Acc: 0.326
Validation loss decreased (-0.266650 --> -0.325910).  Saving model ...
Epoch: 9 cost time: 0.7911746501922607
Epoch: 9, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.474 Vali Acc: 0.533 Test Loss: 1.474 Test Acc: 0.533
Validation loss decreased (-0.325910 --> -0.533319).  Saving model ...
Epoch: 10 cost time: 0.9621469974517822
Epoch: 10, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.360 Vali Acc: 0.752 Test Loss: 1.360 Test Acc: 0.752
Validation loss decreased (-0.533319 --> -0.751838).  Saving model ...
Epoch: 11 cost time: 0.8351471424102783
Epoch: 11, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.264 Vali Acc: 0.726 Test Loss: 1.264 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9643363952636719
Epoch: 12, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.174 Vali Acc: 0.741 Test Loss: 1.174 Test Acc: 0.741
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8750596046447754
Epoch: 13, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.063 Vali Acc: 0.759 Test Loss: 1.063 Test Acc: 0.759
Validation loss decreased (-0.751838 --> -0.759249).  Saving model ...
Epoch: 14 cost time: 1.0192224979400635
Epoch: 14, Steps: 2 | Train Loss: 0.922 Vali Loss: 0.938 Vali Acc: 0.815 Test Loss: 0.938 Test Acc: 0.815
Validation loss decreased (-0.759249 --> -0.814805).  Saving model ...
Epoch: 15 cost time: 0.8516921997070312
Epoch: 15, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.807 Vali Acc: 0.874 Test Loss: 0.807 Test Acc: 0.874
Validation loss decreased (-0.814805 --> -0.874066).  Saving model ...
Epoch: 16 cost time: 0.973355770111084
Epoch: 16, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.691 Vali Acc: 0.904 Test Loss: 0.691 Test Acc: 0.904
Validation loss decreased (-0.874066 --> -0.903697).  Saving model ...
Epoch: 17 cost time: 0.8130209445953369
Epoch: 17, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.594 Vali Acc: 0.919 Test Loss: 0.594 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918513).  Saving model ...
Epoch: 18 cost time: 0.8996016979217529
Epoch: 18, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.517 Vali Acc: 0.907 Test Loss: 0.517 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.076040506362915
Epoch: 19, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.478 Vali Acc: 0.911 Test Loss: 0.478 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1477797031402588
Epoch: 20, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.441 Vali Acc: 0.911 Test Loss: 0.441 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9627909660339355
Epoch: 21, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.404 Vali Acc: 0.919 Test Loss: 0.404 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 22 cost time: 0.8069088459014893
Epoch: 22, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.353 Vali Acc: 0.926 Test Loss: 0.353 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 23 cost time: 1.0793986320495605
Epoch: 23, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.324 Vali Acc: 0.937 Test Loss: 0.324 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937034).  Saving model ...
Epoch: 24 cost time: 0.9079034328460693
Epoch: 24, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.313 Vali Acc: 0.915 Test Loss: 0.313 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9619753360748291
Epoch: 25, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.301 Vali Acc: 0.926 Test Loss: 0.301 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9281163215637207
Epoch: 26, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 27 cost time: 1.1036810874938965
Epoch: 27, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.296 Vali Acc: 0.937 Test Loss: 0.296 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1418519020080566
Epoch: 28, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0818297863006592
Epoch: 29, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 30 cost time: 0.9458279609680176
Epoch: 30, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 31 cost time: 0.8932116031646729
Epoch: 31, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.889451265335083
Epoch: 32, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 33 cost time: 0.816650390625
Epoch: 33, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9163877964019775
Epoch: 34, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.8319590091705322
Epoch: 35, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.3145396709442139
Epoch: 36, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9219632148742676
Epoch: 37, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8789980411529541
Epoch: 38, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0034987926483154
Epoch: 39, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 40 cost time: 0.8009653091430664
Epoch: 40, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 41 cost time: 0.8034393787384033
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 42 cost time: 0.9841818809509277
Epoch: 42, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.7397489547729492
Epoch: 43, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.9604730606079102
Epoch: 44, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8064539432525635
Epoch: 45, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 1.3792335987091064
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0274159908294678
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9270055294036865
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.1792032718658447
Epoch: 49, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8517005443572998
Epoch: 50, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.8278205394744873
Epoch: 51, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.9112212657928467
Epoch: 52, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.854670524597168
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.3337600231170654
Epoch: 54, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.90616774559021
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 3006914
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.71946382522583
Epoch: 1, Steps: 2 | Train Loss: 2.072 Vali Loss: 1.890 Vali Acc: 0.226 Test Loss: 1.890 Test Acc: 0.226
Validation loss decreased (inf --> -0.225907).  Saving model ...
Epoch: 2 cost time: 0.8855865001678467
Epoch: 2, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.844 Vali Acc: 0.215 Test Loss: 1.844 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9061868190765381
Epoch: 3, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.775 Vali Acc: 0.189 Test Loss: 1.775 Test Acc: 0.189
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8209700584411621
Epoch: 4, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.678 Vali Acc: 0.256 Test Loss: 1.678 Test Acc: 0.256
Validation loss decreased (-0.225907 --> -0.255539).  Saving model ...
Epoch: 5 cost time: 0.9829380512237549
Epoch: 5, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.591 Vali Acc: 0.504 Test Loss: 1.591 Test Acc: 0.504
Validation loss decreased (-0.255539 --> -0.503688).  Saving model ...
Epoch: 6 cost time: 0.7804744243621826
Epoch: 6, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.519 Vali Acc: 0.500 Test Loss: 1.519 Test Acc: 0.500
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9213154315948486
Epoch: 7, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.432 Vali Acc: 0.559 Test Loss: 1.432 Test Acc: 0.559
Validation loss decreased (-0.503688 --> -0.559245).  Saving model ...
Epoch: 8 cost time: 1.092299222946167
Epoch: 8, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.322 Vali Acc: 0.511 Test Loss: 1.322 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9061377048492432
Epoch: 9, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.199 Vali Acc: 0.637 Test Loss: 1.199 Test Acc: 0.637
Validation loss decreased (-0.559245 --> -0.637025).  Saving model ...
Epoch: 10 cost time: 0.9522120952606201
Epoch: 10, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.085 Vali Acc: 0.789 Test Loss: 1.085 Test Acc: 0.789
Validation loss decreased (-0.637025 --> -0.788878).  Saving model ...
Epoch: 11 cost time: 0.9818015098571777
Epoch: 11, Steps: 2 | Train Loss: 1.015 Vali Loss: 0.989 Vali Acc: 0.863 Test Loss: 0.989 Test Acc: 0.863
Validation loss decreased (-0.788878 --> -0.862953).  Saving model ...
Epoch: 12 cost time: 1.0808045864105225
Epoch: 12, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.886 Vali Acc: 0.867 Test Loss: 0.886 Test Acc: 0.867
Validation loss decreased (-0.862953 --> -0.866658).  Saving model ...
Epoch: 13 cost time: 0.9542694091796875
Epoch: 13, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.786 Vali Acc: 0.848 Test Loss: 0.786 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9512209892272949
Epoch: 14, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.689 Vali Acc: 0.878 Test Loss: 0.689 Test Acc: 0.878
Validation loss decreased (-0.866658 --> -0.877771).  Saving model ...
Epoch: 15 cost time: 0.9279899597167969
Epoch: 15, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.603 Vali Acc: 0.881 Test Loss: 0.603 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 16 cost time: 0.7861199378967285
Epoch: 16, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.523 Vali Acc: 0.933 Test Loss: 0.523 Test Acc: 0.933
Validation loss decreased (-0.881475 --> -0.933328).  Saving model ...
Epoch: 17 cost time: 0.8410758972167969
Epoch: 17, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.466 Vali Acc: 0.922 Test Loss: 0.466 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.850304126739502
Epoch: 18, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.424 Vali Acc: 0.919 Test Loss: 0.424 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8218715190887451
Epoch: 19, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.384 Vali Acc: 0.926 Test Loss: 0.384 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9078021049499512
Epoch: 20, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.354 Vali Acc: 0.933 Test Loss: 0.354 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933330).  Saving model ...
Epoch: 21 cost time: 0.8676447868347168
Epoch: 21, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.339 Vali Acc: 0.933 Test Loss: 0.339 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 22 cost time: 0.8679077625274658
Epoch: 22, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.339 Vali Acc: 0.919 Test Loss: 0.339 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8791909217834473
Epoch: 23, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.313 Vali Acc: 0.930 Test Loss: 0.313 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8824379444122314
Epoch: 24, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.279 Vali Acc: 0.937 Test Loss: 0.279 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 25 cost time: 0.8109216690063477
Epoch: 25, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.260 Vali Acc: 0.952 Test Loss: 0.260 Test Acc: 0.952
Validation loss decreased (-0.937034 --> -0.951849).  Saving model ...
Epoch: 26 cost time: 0.8560481071472168
Epoch: 26, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.246 Vali Acc: 0.959 Test Loss: 0.246 Test Acc: 0.959
Validation loss decreased (-0.951849 --> -0.959257).  Saving model ...
Epoch: 27 cost time: 0.8551082611083984
Epoch: 27, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8703789710998535
Epoch: 28, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.239 Vali Acc: 0.952 Test Loss: 0.239 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0668761730194092
Epoch: 29, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9801905155181885
Epoch: 30, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.230 Vali Acc: 0.952 Test Loss: 0.230 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9496572017669678
Epoch: 31, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.218 Vali Acc: 0.956 Test Loss: 0.218 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9198079109191895
Epoch: 32, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.207 Vali Acc: 0.963 Test Loss: 0.207 Test Acc: 0.963
Validation loss decreased (-0.959257 --> -0.962961).  Saving model ...
Epoch: 33 cost time: 0.8456389904022217
Epoch: 33, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
Validation loss decreased (-0.962961 --> -0.966665).  Saving model ...
Epoch: 34 cost time: 0.9563865661621094
Epoch: 34, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.197 Vali Acc: 0.967 Test Loss: 0.197 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 35 cost time: 1.1772541999816895
Epoch: 35, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1348881721496582
Epoch: 36, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.963 Test Loss: 0.204 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0651302337646484
Epoch: 37, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.93572998046875
Epoch: 38, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8676464557647705
Epoch: 39, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8871397972106934
Epoch: 40, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.201 Vali Acc: 0.963 Test Loss: 0.201 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0557725429534912
Epoch: 41, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.9476668834686279
Epoch: 42, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 43 cost time: 0.9439337253570557
Epoch: 43, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 44 cost time: 0.9918379783630371
Epoch: 44, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.967 Test Loss: 0.182 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 45 cost time: 0.9618308544158936
Epoch: 45, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 46 cost time: 0.8648824691772461
Epoch: 46, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9849855899810791
Epoch: 47, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.1162786483764648
Epoch: 48, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.3078949451446533
Epoch: 49, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8757643699645996
Epoch: 50, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.963 Test Loss: 0.181 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9084343910217285
Epoch: 51, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.180 Vali Acc: 0.963 Test Loss: 0.180 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.080035924911499
Epoch: 52, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.950176477432251
Epoch: 53, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.963 Test Loss: 0.178 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.9720478057861328
Epoch: 54, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.8105039596557617
Epoch: 55, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.963 Test Loss: 0.176 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 3005378
model size : 14.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7837588787078857
Epoch: 1, Steps: 2 | Train Loss: 2.008 Vali Loss: 1.907 Vali Acc: 0.167 Test Loss: 1.907 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.8817400932312012
Epoch: 2, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.852 Vali Acc: 0.167 Test Loss: 1.852 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.8677911758422852
Epoch: 3, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.777 Vali Acc: 0.233 Test Loss: 1.777 Test Acc: 0.233
Validation loss decreased (-0.166648 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 0.9567313194274902
Epoch: 4, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.690 Vali Acc: 0.411 Test Loss: 1.690 Test Acc: 0.411
Validation loss decreased (-0.233316 --> -0.411094).  Saving model ...
Epoch: 5 cost time: 0.9892046451568604
Epoch: 5, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.629 Vali Acc: 0.404 Test Loss: 1.629 Test Acc: 0.404
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.953228235244751
Epoch: 6, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.578 Vali Acc: 0.430 Test Loss: 1.578 Test Acc: 0.430
Validation loss decreased (-0.411094 --> -0.429614).  Saving model ...
Epoch: 7 cost time: 0.7398266792297363
Epoch: 7, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.506 Vali Acc: 0.485 Test Loss: 1.506 Test Acc: 0.485
Validation loss decreased (-0.429614 --> -0.485170).  Saving model ...
Epoch: 8 cost time: 0.9121692180633545
Epoch: 8, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.393 Vali Acc: 0.522 Test Loss: 1.393 Test Acc: 0.522
Validation loss decreased (-0.485170 --> -0.522208).  Saving model ...
Epoch: 9 cost time: 0.833101749420166
Epoch: 9, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.257 Vali Acc: 0.678 Test Loss: 1.257 Test Acc: 0.678
Validation loss decreased (-0.522208 --> -0.677765).  Saving model ...
Epoch: 10 cost time: 1.0518057346343994
Epoch: 10, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.138 Vali Acc: 0.789 Test Loss: 1.138 Test Acc: 0.789
Validation loss decreased (-0.677765 --> -0.788878).  Saving model ...
Epoch: 11 cost time: 0.9339163303375244
Epoch: 11, Steps: 2 | Train Loss: 1.057 Vali Loss: 1.040 Vali Acc: 0.741 Test Loss: 1.040 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2340867519378662
Epoch: 12, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.931 Vali Acc: 0.793 Test Loss: 0.931 Test Acc: 0.793
Validation loss decreased (-0.788878 --> -0.792583).  Saving model ...
Epoch: 13 cost time: 1.2888538837432861
Epoch: 13, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.822 Vali Acc: 0.841 Test Loss: 0.822 Test Acc: 0.841
Validation loss decreased (-0.792583 --> -0.840733).  Saving model ...
Epoch: 14 cost time: 0.8575863838195801
Epoch: 14, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.726 Vali Acc: 0.889 Test Loss: 0.726 Test Acc: 0.889
Validation loss decreased (-0.840733 --> -0.888882).  Saving model ...
Epoch: 15 cost time: 0.8244237899780273
Epoch: 15, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.655 Vali Acc: 0.893 Test Loss: 0.655 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 16 cost time: 0.9893355369567871
Epoch: 16, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.589 Vali Acc: 0.893 Test Loss: 0.589 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 17 cost time: 1.1013612747192383
Epoch: 17, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.509 Vali Acc: 0.930 Test Loss: 0.509 Test Acc: 0.930
Validation loss decreased (-0.892587 --> -0.929625).  Saving model ...
Epoch: 18 cost time: 0.789879560470581
Epoch: 18, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.444 Vali Acc: 0.937 Test Loss: 0.444 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 19 cost time: 1.047034502029419
Epoch: 19, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.395 Vali Acc: 0.933 Test Loss: 0.395 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8567166328430176
Epoch: 20, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.357 Vali Acc: 0.930 Test Loss: 0.357 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9454083442687988
Epoch: 21, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.330 Vali Acc: 0.937 Test Loss: 0.330 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 0.8642196655273438
Epoch: 22, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2155303955078125
Epoch: 23, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.297 Vali Acc: 0.926 Test Loss: 0.297 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9427773952484131
Epoch: 24, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9384608268737793
Epoch: 25, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.250 Vali Acc: 0.952 Test Loss: 0.250 Test Acc: 0.952
Validation loss decreased (-0.937034 --> -0.951849).  Saving model ...
Epoch: 26 cost time: 0.8450345993041992
Epoch: 26, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9863104820251465
Epoch: 27, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.226 Vali Acc: 0.956 Test Loss: 0.226 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.7980599403381348
Epoch: 28, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9278464317321777
Epoch: 29, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9218382835388184
Epoch: 30, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9923431873321533
Epoch: 31, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9550971984863281
Epoch: 32, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9713218212127686
Epoch: 33, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9755730628967285
Epoch: 34, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0829174518585205
Epoch: 35, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7412748336791992
Epoch: 36, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8392565250396729
Epoch: 37, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 3003842
model size : 14.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.62207293510437
Epoch: 1, Steps: 2 | Train Loss: 2.016 Vali Loss: 1.898 Vali Acc: 0.111 Test Loss: 1.898 Test Acc: 0.111
Validation loss decreased (inf --> -0.111092).  Saving model ...
Epoch: 2 cost time: 0.9005105495452881
Epoch: 2, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.877 Vali Acc: 0.100 Test Loss: 1.877 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9290287494659424
Epoch: 3, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.845 Vali Acc: 0.081 Test Loss: 1.845 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.04426908493042
Epoch: 4, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.790 Vali Acc: 0.193 Test Loss: 1.790 Test Acc: 0.193
Validation loss decreased (-0.111092 --> -0.192575).  Saving model ...
Epoch: 5 cost time: 0.8958532810211182
Epoch: 5, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.723 Vali Acc: 0.322 Test Loss: 1.723 Test Acc: 0.322
Validation loss decreased (-0.192575 --> -0.322205).  Saving model ...
Epoch: 6 cost time: 0.9311134815216064
Epoch: 6, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.647 Vali Acc: 0.437 Test Loss: 1.647 Test Acc: 0.437
Validation loss decreased (-0.322205 --> -0.437021).  Saving model ...
Epoch: 7 cost time: 1.10933256149292
Epoch: 7, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.562 Vali Acc: 0.515 Test Loss: 1.562 Test Acc: 0.515
Validation loss decreased (-0.437021 --> -0.514799).  Saving model ...
Epoch: 8 cost time: 0.7463424205780029
Epoch: 8, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.473 Vali Acc: 0.559 Test Loss: 1.473 Test Acc: 0.559
Validation loss decreased (-0.514799 --> -0.559245).  Saving model ...
Epoch: 9 cost time: 0.911144495010376
Epoch: 9, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.380 Vali Acc: 0.596 Test Loss: 1.380 Test Acc: 0.596
Validation loss decreased (-0.559245 --> -0.596283).  Saving model ...
Epoch: 10 cost time: 0.9949183464050293
Epoch: 10, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.276 Vali Acc: 0.674 Test Loss: 1.276 Test Acc: 0.674
Validation loss decreased (-0.596283 --> -0.674061).  Saving model ...
Epoch: 11 cost time: 0.9947307109832764
Epoch: 11, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.169 Vali Acc: 0.719 Test Loss: 1.169 Test Acc: 0.719
Validation loss decreased (-0.674061 --> -0.718507).  Saving model ...
Epoch: 12 cost time: 0.8512217998504639
Epoch: 12, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.065 Vali Acc: 0.748 Test Loss: 1.065 Test Acc: 0.748
Validation loss decreased (-0.718507 --> -0.748137).  Saving model ...
Epoch: 13 cost time: 1.0893158912658691
Epoch: 13, Steps: 2 | Train Loss: 0.904 Vali Loss: 0.958 Vali Acc: 0.789 Test Loss: 0.958 Test Acc: 0.789
Validation loss decreased (-0.748137 --> -0.788879).  Saving model ...
Epoch: 14 cost time: 0.7027475833892822
Epoch: 14, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.860 Vali Acc: 0.796 Test Loss: 0.860 Test Acc: 0.796
Validation loss decreased (-0.788879 --> -0.796288).  Saving model ...
Epoch: 15 cost time: 1.0040900707244873
Epoch: 15, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.769 Vali Acc: 0.830 Test Loss: 0.769 Test Acc: 0.830
Validation loss decreased (-0.796288 --> -0.829622).  Saving model ...
Epoch: 16 cost time: 0.7294423580169678
Epoch: 16, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.689 Vali Acc: 0.863 Test Loss: 0.689 Test Acc: 0.863
Validation loss decreased (-0.829622 --> -0.862956).  Saving model ...
Epoch: 17 cost time: 0.8327233791351318
Epoch: 17, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.616 Vali Acc: 0.870 Test Loss: 0.616 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870364).  Saving model ...
Epoch: 18 cost time: 0.949669599533081
Epoch: 18, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.561 Vali Acc: 0.867 Test Loss: 0.561 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1920065879821777
Epoch: 19, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.520 Vali Acc: 0.867 Test Loss: 0.520 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1790554523468018
Epoch: 20, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870366).  Saving model ...
Epoch: 21 cost time: 0.8599255084991455
Epoch: 21, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.423 Vali Acc: 0.904 Test Loss: 0.423 Test Acc: 0.904
Validation loss decreased (-0.870366 --> -0.903699).  Saving model ...
Epoch: 22 cost time: 0.8209819793701172
Epoch: 22, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.381 Vali Acc: 0.907 Test Loss: 0.381 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907404).  Saving model ...
Epoch: 23 cost time: 0.8493640422821045
Epoch: 23, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.348 Vali Acc: 0.907 Test Loss: 0.348 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 24 cost time: 1.1145093441009521
Epoch: 24, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.323 Vali Acc: 0.915 Test Loss: 0.323 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 25 cost time: 1.0820949077606201
Epoch: 25, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918515).  Saving model ...
Epoch: 26 cost time: 0.8800480365753174
Epoch: 26, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9095311164855957
Epoch: 27, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 28 cost time: 0.9159610271453857
Epoch: 28, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.8195385932922363
Epoch: 29, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.9137587547302246
Epoch: 30, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.9026341438293457
Epoch: 31, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8143250942230225
Epoch: 32, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.026061773300171
Epoch: 33, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.9697792530059814
Epoch: 34, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 1.0050432682037354
Epoch: 35, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.152874231338501
Epoch: 36, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.9298322200775146
Epoch: 37, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.9444143772125244
Epoch: 38, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8487358093261719
Epoch: 39, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8759250640869141
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.315340518951416
Epoch: 41, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1053283214569092
Epoch: 42, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.0092346668243408
Epoch: 43, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9346191883087158
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9928193092346191
Epoch: 45, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9962403774261475
Epoch: 46, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9760010242462158
Epoch: 47, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 3002306
model size : 14.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.3442254066467285
Epoch: 1, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.894 Vali Acc: 0.037 Test Loss: 1.894 Test Acc: 0.037
Validation loss decreased (inf --> -0.037018).  Saving model ...
Epoch: 2 cost time: 0.858039140701294
Epoch: 2, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.876 Vali Acc: 0.041 Test Loss: 1.876 Test Acc: 0.041
Validation loss decreased (-0.037018 --> -0.040722).  Saving model ...
Epoch: 3 cost time: 1.1091406345367432
Epoch: 3, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.846 Vali Acc: 0.063 Test Loss: 1.846 Test Acc: 0.063
Validation loss decreased (-0.040722 --> -0.062945).  Saving model ...
Epoch: 4 cost time: 0.9622421264648438
Epoch: 4, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.794 Vali Acc: 0.267 Test Loss: 1.794 Test Acc: 0.267
Validation loss decreased (-0.062945 --> -0.266649).  Saving model ...
Epoch: 5 cost time: 0.9548027515411377
Epoch: 5, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.740 Vali Acc: 0.304 Test Loss: 1.740 Test Acc: 0.304
Validation loss decreased (-0.266649 --> -0.303686).  Saving model ...
Epoch: 6 cost time: 1.005727767944336
Epoch: 6, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.678 Vali Acc: 0.319 Test Loss: 1.678 Test Acc: 0.319
Validation loss decreased (-0.303686 --> -0.318502).  Saving model ...
Epoch: 7 cost time: 1.2685565948486328
Epoch: 7, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.607 Vali Acc: 0.385 Test Loss: 1.607 Test Acc: 0.385
Validation loss decreased (-0.318502 --> -0.385169).  Saving model ...
Epoch: 8 cost time: 0.913428544998169
Epoch: 8, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.521 Vali Acc: 0.463 Test Loss: 1.521 Test Acc: 0.463
Validation loss decreased (-0.385169 --> -0.462948).  Saving model ...
Epoch: 9 cost time: 0.9346153736114502
Epoch: 9, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.428 Vali Acc: 0.585 Test Loss: 1.428 Test Acc: 0.585
Validation loss decreased (-0.462948 --> -0.585171).  Saving model ...
Epoch: 10 cost time: 1.1409242153167725
Epoch: 10, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.341 Vali Acc: 0.607 Test Loss: 1.341 Test Acc: 0.607
Validation loss decreased (-0.585171 --> -0.607394).  Saving model ...
Epoch: 11 cost time: 0.9892165660858154
Epoch: 11, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.247 Vali Acc: 0.656 Test Loss: 1.247 Test Acc: 0.656
Validation loss decreased (-0.607394 --> -0.655543).  Saving model ...
Epoch: 12 cost time: 1.1587579250335693
Epoch: 12, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.145 Vali Acc: 0.715 Test Loss: 1.145 Test Acc: 0.715
Validation loss decreased (-0.655543 --> -0.714803).  Saving model ...
Epoch: 13 cost time: 1.0927269458770752
Epoch: 13, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.044 Vali Acc: 0.715 Test Loss: 1.044 Test Acc: 0.715
Validation loss decreased (-0.714803 --> -0.714804).  Saving model ...
Epoch: 14 cost time: 0.9946339130401611
Epoch: 14, Steps: 2 | Train Loss: 0.936 Vali Loss: 0.948 Vali Acc: 0.737 Test Loss: 0.948 Test Acc: 0.737
Validation loss decreased (-0.714804 --> -0.737028).  Saving model ...
Epoch: 15 cost time: 0.879910945892334
Epoch: 15, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.856 Vali Acc: 0.756 Test Loss: 0.856 Test Acc: 0.756
Validation loss decreased (-0.737028 --> -0.755547).  Saving model ...
Epoch: 16 cost time: 1.2142062187194824
Epoch: 16, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.768 Vali Acc: 0.781 Test Loss: 0.768 Test Acc: 0.781
Validation loss decreased (-0.755547 --> -0.781474).  Saving model ...
Epoch: 17 cost time: 1.4163906574249268
Epoch: 17, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.690 Vali Acc: 0.844 Test Loss: 0.690 Test Acc: 0.844
Validation loss decreased (-0.781474 --> -0.844438).  Saving model ...
Epoch: 18 cost time: 0.9826629161834717
Epoch: 18, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.629 Vali Acc: 0.874 Test Loss: 0.629 Test Acc: 0.874
Validation loss decreased (-0.844438 --> -0.874068).  Saving model ...
Epoch: 19 cost time: 1.0725445747375488
Epoch: 19, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.563 Vali Acc: 0.885 Test Loss: 0.563 Test Acc: 0.885
Validation loss decreased (-0.874068 --> -0.885180).  Saving model ...
Epoch: 20 cost time: 1.0624902248382568
Epoch: 20, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9752557277679443
Epoch: 21, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.490 Vali Acc: 0.844 Test Loss: 0.490 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1399333477020264
Epoch: 22, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.441 Vali Acc: 0.893 Test Loss: 0.441 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892588).  Saving model ...
Epoch: 23 cost time: 1.1192188262939453
Epoch: 23, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.407 Vali Acc: 0.915 Test Loss: 0.407 Test Acc: 0.915
Validation loss decreased (-0.892588 --> -0.914811).  Saving model ...
Epoch: 24 cost time: 1.4248850345611572
Epoch: 24, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.388 Vali Acc: 0.922 Test Loss: 0.388 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922218).  Saving model ...
Epoch: 25 cost time: 0.8183798789978027
Epoch: 25, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.365 Vali Acc: 0.922 Test Loss: 0.365 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 26 cost time: 1.0634357929229736
Epoch: 26, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.359 Vali Acc: 0.904 Test Loss: 0.359 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8342928886413574
Epoch: 27, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.349 Vali Acc: 0.907 Test Loss: 0.349 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0809037685394287
Epoch: 28, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929626).  Saving model ...
Epoch: 29 cost time: 1.092893362045288
Epoch: 29, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 30 cost time: 1.3475115299224854
Epoch: 30, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1545426845550537
Epoch: 31, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.321 Vali Acc: 0.911 Test Loss: 0.321 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.3598904609680176
Epoch: 32, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.321 Vali Acc: 0.911 Test Loss: 0.321 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2007956504821777
Epoch: 33, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.297 Vali Acc: 0.915 Test Loss: 0.297 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1809093952178955
Epoch: 34, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9253761768341064
Epoch: 35, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1482212543487549
Epoch: 36, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.270 Vali Acc: 0.926 Test Loss: 0.270 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.5060479640960693
Epoch: 37, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.3036322593688965
Epoch: 38, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.1305394172668457
Epoch: 39, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 1.0339417457580566
Epoch: 40, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 1.2153234481811523
Epoch: 41, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 42 cost time: 0.86142897605896
Epoch: 42, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.260 Vali Acc: 0.926 Test Loss: 0.260 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.1670868396759033
Epoch: 43, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.2281975746154785
Epoch: 44, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.263 Vali Acc: 0.919 Test Loss: 0.263 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.4381740093231201
Epoch: 45, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.2587463855743408
Epoch: 46, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.3111815452575684
Epoch: 47, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.2995505332946777
Epoch: 48, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 1.1137559413909912
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.1319761276245117
Epoch: 50, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.005929946899414
Epoch: 51, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.915 Test Loss: 0.261 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.2244536876678467
Epoch: 52, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.264 Vali Acc: 0.907 Test Loss: 0.264 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.2529199123382568
Epoch: 53, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.258 Vali Acc: 0.915 Test Loss: 0.258 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.1736061573028564
Epoch: 54, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.915 Test Loss: 0.250 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.3649733066558838
Epoch: 55, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.919872522354126
Epoch: 56, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 1.3070087432861328
Epoch: 57, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 58 cost time: 1.0891697406768799
Epoch: 58, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 59 cost time: 1.119581699371338
Epoch: 59, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.139686107635498
Epoch: 60, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.1810166835784912
Epoch: 61, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.9424965381622314
Epoch: 62, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 1.1664414405822754
Epoch: 63, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 1.0548272132873535
Epoch: 64, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 1.1308457851409912
Epoch: 65, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 1.2944352626800537
Epoch: 66, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 1.212548017501831
Epoch: 67, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 1.1040105819702148
Epoch: 68, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 2710850
model size : 12.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7575345039367676
Epoch: 1, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.918 Vali Acc: 0.170 Test Loss: 1.918 Test Acc: 0.170
Validation loss decreased (inf --> -0.170351).  Saving model ...
Epoch: 2 cost time: 1.0210201740264893
Epoch: 2, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.890 Vali Acc: 0.159 Test Loss: 1.890 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0011615753173828
Epoch: 3, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.850 Vali Acc: 0.163 Test Loss: 1.850 Test Acc: 0.163
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8282620906829834
Epoch: 4, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.785 Vali Acc: 0.204 Test Loss: 1.785 Test Acc: 0.204
Validation loss decreased (-0.170351 --> -0.203686).  Saving model ...
Epoch: 5 cost time: 0.8991062641143799
Epoch: 5, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.716 Vali Acc: 0.330 Test Loss: 1.716 Test Acc: 0.330
Validation loss decreased (-0.203686 --> -0.329612).  Saving model ...
Epoch: 6 cost time: 0.9873034954071045
Epoch: 6, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.641 Vali Acc: 0.400 Test Loss: 1.641 Test Acc: 0.400
Validation loss decreased (-0.329612 --> -0.399984).  Saving model ...
Epoch: 7 cost time: 0.7529940605163574
Epoch: 7, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.551 Vali Acc: 0.456 Test Loss: 1.551 Test Acc: 0.456
Validation loss decreased (-0.399984 --> -0.455540).  Saving model ...
Epoch: 8 cost time: 0.8456151485443115
Epoch: 8, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.457 Vali Acc: 0.500 Test Loss: 1.457 Test Acc: 0.500
Validation loss decreased (-0.455540 --> -0.499985).  Saving model ...
Epoch: 9 cost time: 0.9361014366149902
Epoch: 9, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.358 Vali Acc: 0.563 Test Loss: 1.358 Test Acc: 0.563
Validation loss decreased (-0.499985 --> -0.562949).  Saving model ...
Epoch: 10 cost time: 0.8503830432891846
Epoch: 10, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.257 Vali Acc: 0.674 Test Loss: 1.257 Test Acc: 0.674
Validation loss decreased (-0.562949 --> -0.674062).  Saving model ...
Epoch: 11 cost time: 0.806248664855957
Epoch: 11, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.150 Vali Acc: 0.733 Test Loss: 1.150 Test Acc: 0.733
Validation loss decreased (-0.674062 --> -0.733322).  Saving model ...
Epoch: 12 cost time: 1.0441803932189941
Epoch: 12, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.044 Vali Acc: 0.763 Test Loss: 1.044 Test Acc: 0.763
Validation loss decreased (-0.733322 --> -0.762953).  Saving model ...
Epoch: 13 cost time: 0.8506760597229004
Epoch: 13, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.942 Vali Acc: 0.811 Test Loss: 0.942 Test Acc: 0.811
Validation loss decreased (-0.762953 --> -0.811102).  Saving model ...
Epoch: 14 cost time: 0.9637417793273926
Epoch: 14, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.850 Vali Acc: 0.844 Test Loss: 0.850 Test Acc: 0.844
Validation loss decreased (-0.811102 --> -0.844436).  Saving model ...
Epoch: 15 cost time: 0.8893368244171143
Epoch: 15, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.767 Vali Acc: 0.856 Test Loss: 0.767 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855548).  Saving model ...
Epoch: 16 cost time: 0.7922418117523193
Epoch: 16, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.697 Vali Acc: 0.844 Test Loss: 0.697 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8437809944152832
Epoch: 17, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.626 Vali Acc: 0.870 Test Loss: 0.626 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870364).  Saving model ...
Epoch: 18 cost time: 0.8562562465667725
Epoch: 18, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.560 Vali Acc: 0.859 Test Loss: 0.560 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8418138027191162
Epoch: 19, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.502 Vali Acc: 0.896 Test Loss: 0.502 Test Acc: 0.896
Validation loss decreased (-0.870364 --> -0.896291).  Saving model ...
Epoch: 20 cost time: 0.6378612518310547
Epoch: 20, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.464 Vali Acc: 0.893 Test Loss: 0.464 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8410639762878418
Epoch: 21, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.468 Vali Acc: 0.874 Test Loss: 0.468 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8827953338623047
Epoch: 22, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.448 Vali Acc: 0.856 Test Loss: 0.448 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0501320362091064
Epoch: 23, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.413 Vali Acc: 0.867 Test Loss: 0.413 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9274709224700928
Epoch: 24, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.381 Vali Acc: 0.885 Test Loss: 0.381 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7628610134124756
Epoch: 25, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.338 Vali Acc: 0.915 Test Loss: 0.338 Test Acc: 0.915
Validation loss decreased (-0.896291 --> -0.914811).  Saving model ...
Epoch: 26 cost time: 0.8782014846801758
Epoch: 26, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8639628887176514
Epoch: 27, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.326 Vali Acc: 0.904 Test Loss: 0.326 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1315743923187256
Epoch: 28, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.336 Vali Acc: 0.907 Test Loss: 0.336 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.063171625137329
Epoch: 29, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.335 Vali Acc: 0.904 Test Loss: 0.335 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8189456462860107
Epoch: 30, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.329 Vali Acc: 0.893 Test Loss: 0.329 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0477674007415771
Epoch: 31, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.310 Vali Acc: 0.904 Test Loss: 0.310 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8594577312469482
Epoch: 32, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.299 Vali Acc: 0.919 Test Loss: 0.299 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918516).  Saving model ...
Epoch: 33 cost time: 0.8809940814971924
Epoch: 33, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.293 Vali Acc: 0.919 Test Loss: 0.293 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 34 cost time: 1.045814037322998
Epoch: 34, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.804936408996582
Epoch: 35, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 36 cost time: 1.1660542488098145
Epoch: 36, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 37 cost time: 1.1761765480041504
Epoch: 37, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.271 Vali Acc: 0.919 Test Loss: 0.271 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 38 cost time: 0.8081870079040527
Epoch: 38, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.266 Vali Acc: 0.919 Test Loss: 0.266 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 39 cost time: 0.9422807693481445
Epoch: 39, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.259 Vali Acc: 0.915 Test Loss: 0.259 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8864083290100098
Epoch: 40, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.261 Vali Acc: 0.915 Test Loss: 0.261 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9010546207427979
Epoch: 41, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9218597412109375
Epoch: 42, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.284 Vali Acc: 0.915 Test Loss: 0.284 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9501380920410156
Epoch: 43, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9190394878387451
Epoch: 44, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.289 Vali Acc: 0.907 Test Loss: 0.289 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7372117042541504
Epoch: 45, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.284 Vali Acc: 0.911 Test Loss: 0.284 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.9726481437683105
Epoch: 46, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.279 Vali Acc: 0.915 Test Loss: 0.279 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.9118573665618896
Epoch: 47, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.271 Vali Acc: 0.915 Test Loss: 0.271 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8645377159118652
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.267 Vali Acc: 0.915 Test Loss: 0.267 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 2709314
model size : 12.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.560570478439331
Epoch: 1, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.831 Vali Acc: 0.211 Test Loss: 1.831 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 1.1426353454589844
Epoch: 2, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.812 Vali Acc: 0.226 Test Loss: 1.812 Test Acc: 0.226
Validation loss decreased (-0.211093 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.8993589878082275
Epoch: 3, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.780 Vali Acc: 0.226 Test Loss: 1.780 Test Acc: 0.226
Validation loss decreased (-0.225908 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 1.244734525680542
Epoch: 4, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.727 Vali Acc: 0.293 Test Loss: 1.727 Test Acc: 0.293
Validation loss decreased (-0.225908 --> -0.292575).  Saving model ...
Epoch: 5 cost time: 0.8609704971313477
Epoch: 5, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.675 Vali Acc: 0.396 Test Loss: 1.675 Test Acc: 0.396
Validation loss decreased (-0.292575 --> -0.396280).  Saving model ...
Epoch: 6 cost time: 0.8659555912017822
Epoch: 6, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.615 Vali Acc: 0.430 Test Loss: 1.615 Test Acc: 0.430
Validation loss decreased (-0.396280 --> -0.429613).  Saving model ...
Epoch: 7 cost time: 0.932253360748291
Epoch: 7, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.543 Vali Acc: 0.507 Test Loss: 1.543 Test Acc: 0.507
Validation loss decreased (-0.429613 --> -0.507392).  Saving model ...
Epoch: 8 cost time: 1.1709771156311035
Epoch: 8, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.463 Vali Acc: 0.615 Test Loss: 1.463 Test Acc: 0.615
Validation loss decreased (-0.507392 --> -0.614800).  Saving model ...
Epoch: 9 cost time: 0.9094974994659424
Epoch: 9, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.369 Vali Acc: 0.730 Test Loss: 1.369 Test Acc: 0.730
Validation loss decreased (-0.614800 --> -0.729616).  Saving model ...
Epoch: 10 cost time: 0.9423706531524658
Epoch: 10, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.269 Vali Acc: 0.752 Test Loss: 1.269 Test Acc: 0.752
Validation loss decreased (-0.729616 --> -0.751839).  Saving model ...
Epoch: 11 cost time: 0.9927282333374023
Epoch: 11, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.161 Vali Acc: 0.793 Test Loss: 1.161 Test Acc: 0.793
Validation loss decreased (-0.751839 --> -0.792581).  Saving model ...
Epoch: 12 cost time: 0.8493161201477051
Epoch: 12, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.053 Vali Acc: 0.826 Test Loss: 1.053 Test Acc: 0.826
Validation loss decreased (-0.792581 --> -0.825915).  Saving model ...
Epoch: 13 cost time: 0.8953354358673096
Epoch: 13, Steps: 2 | Train Loss: 0.953 Vali Loss: 0.948 Vali Acc: 0.830 Test Loss: 0.948 Test Acc: 0.830
Validation loss decreased (-0.825915 --> -0.829620).  Saving model ...
Epoch: 14 cost time: 0.9016609191894531
Epoch: 14, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.851 Vali Acc: 0.822 Test Loss: 0.851 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9391758441925049
Epoch: 15, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.762 Vali Acc: 0.859 Test Loss: 0.762 Test Acc: 0.859
Validation loss decreased (-0.829620 --> -0.859252).  Saving model ...
Epoch: 16 cost time: 1.6554594039916992
Epoch: 16, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.674 Vali Acc: 0.889 Test Loss: 0.674 Test Acc: 0.889
Validation loss decreased (-0.859252 --> -0.888882).  Saving model ...
Epoch: 17 cost time: 0.9701273441314697
Epoch: 17, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.594 Vali Acc: 0.889 Test Loss: 0.594 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888883).  Saving model ...
Epoch: 18 cost time: 0.8799762725830078
Epoch: 18, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.523 Vali Acc: 0.907 Test Loss: 0.523 Test Acc: 0.907
Validation loss decreased (-0.888883 --> -0.907402).  Saving model ...
Epoch: 19 cost time: 1.0592882633209229
Epoch: 19, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.466 Vali Acc: 0.926 Test Loss: 0.466 Test Acc: 0.926
Validation loss decreased (-0.907402 --> -0.925921).  Saving model ...
Epoch: 20 cost time: 1.0405218601226807
Epoch: 20, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.430 Vali Acc: 0.926 Test Loss: 0.430 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 0.973743200302124
Epoch: 21, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.395 Vali Acc: 0.919 Test Loss: 0.395 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0262000560760498
Epoch: 22, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.370 Vali Acc: 0.904 Test Loss: 0.370 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0830085277557373
Epoch: 23, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0121269226074219
Epoch: 24, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.307 Vali Acc: 0.952 Test Loss: 0.307 Test Acc: 0.952
Validation loss decreased (-0.925922 --> -0.951849).  Saving model ...
Epoch: 25 cost time: 1.197967290878296
Epoch: 25, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.290 Vali Acc: 0.948 Test Loss: 0.290 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1183712482452393
Epoch: 26, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.276 Vali Acc: 0.959 Test Loss: 0.276 Test Acc: 0.959
Validation loss decreased (-0.951849 --> -0.959257).  Saving model ...
Epoch: 27 cost time: 0.9526574611663818
Epoch: 27, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.272 Vali Acc: 0.948 Test Loss: 0.272 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0235579013824463
Epoch: 28, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9725344181060791
Epoch: 29, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9752068519592285
Epoch: 30, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8632433414459229
Epoch: 31, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.403393030166626
Epoch: 32, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.0595507621765137
Epoch: 33, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.932013750076294
Epoch: 34, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.212 Vali Acc: 0.952 Test Loss: 0.212 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2649965286254883
Epoch: 35, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2331500053405762
Epoch: 36, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 2707778
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.24218487739563
Epoch: 1, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.812 Vali Acc: 0.178 Test Loss: 1.812 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.9623169898986816
Epoch: 2, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.786 Vali Acc: 0.181 Test Loss: 1.786 Test Acc: 0.181
Validation loss decreased (-0.177760 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 1.0140538215637207
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.746 Vali Acc: 0.207 Test Loss: 1.746 Test Acc: 0.207
Validation loss decreased (-0.181464 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.8672313690185547
Epoch: 4, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.686 Vali Acc: 0.385 Test Loss: 1.686 Test Acc: 0.385
Validation loss decreased (-0.207390 --> -0.385168).  Saving model ...
Epoch: 5 cost time: 0.8292477130889893
Epoch: 5, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.629 Vali Acc: 0.511 Test Loss: 1.629 Test Acc: 0.511
Validation loss decreased (-0.385168 --> -0.511095).  Saving model ...
Epoch: 6 cost time: 1.07084059715271
Epoch: 6, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.567 Vali Acc: 0.578 Test Loss: 1.567 Test Acc: 0.578
Validation loss decreased (-0.511095 --> -0.577762).  Saving model ...
Epoch: 7 cost time: 0.858055830001831
Epoch: 7, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.491 Vali Acc: 0.611 Test Loss: 1.491 Test Acc: 0.611
Validation loss decreased (-0.577762 --> -0.611096).  Saving model ...
Epoch: 8 cost time: 0.9502279758453369
Epoch: 8, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.406 Vali Acc: 0.637 Test Loss: 1.406 Test Acc: 0.637
Validation loss decreased (-0.611096 --> -0.637023).  Saving model ...
Epoch: 9 cost time: 1.3024706840515137
Epoch: 9, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.308 Vali Acc: 0.693 Test Loss: 1.308 Test Acc: 0.693
Validation loss decreased (-0.637023 --> -0.692580).  Saving model ...
Epoch: 10 cost time: 1.0158216953277588
Epoch: 10, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.218 Vali Acc: 0.763 Test Loss: 1.218 Test Acc: 0.763
Validation loss decreased (-0.692580 --> -0.762951).  Saving model ...
Epoch: 11 cost time: 0.919114351272583
Epoch: 11, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.125 Vali Acc: 0.781 Test Loss: 1.125 Test Acc: 0.781
Validation loss decreased (-0.762951 --> -0.781470).  Saving model ...
Epoch: 12 cost time: 0.9868144989013672
Epoch: 12, Steps: 2 | Train Loss: 1.049 Vali Loss: 1.031 Vali Acc: 0.815 Test Loss: 1.031 Test Acc: 0.815
Validation loss decreased (-0.781470 --> -0.814805).  Saving model ...
Epoch: 13 cost time: 0.8564167022705078
Epoch: 13, Steps: 2 | Train Loss: 1.002 Vali Loss: 0.938 Vali Acc: 0.837 Test Loss: 0.938 Test Acc: 0.837
Validation loss decreased (-0.814805 --> -0.837028).  Saving model ...
Epoch: 14 cost time: 0.9132435321807861
Epoch: 14, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.852 Vali Acc: 0.867 Test Loss: 0.852 Test Acc: 0.867
Validation loss decreased (-0.837028 --> -0.866658).  Saving model ...
Epoch: 15 cost time: 1.0409560203552246
Epoch: 15, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.771 Vali Acc: 0.870 Test Loss: 0.771 Test Acc: 0.870
Validation loss decreased (-0.866658 --> -0.870363).  Saving model ...
Epoch: 16 cost time: 1.1699440479278564
Epoch: 16, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.695 Vali Acc: 0.856 Test Loss: 0.695 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.129584550857544
Epoch: 17, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.624 Vali Acc: 0.889 Test Loss: 0.624 Test Acc: 0.889
Validation loss decreased (-0.870363 --> -0.888883).  Saving model ...
Epoch: 18 cost time: 1.1088457107543945
Epoch: 18, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.559 Vali Acc: 0.904 Test Loss: 0.559 Test Acc: 0.904
Validation loss decreased (-0.888883 --> -0.903698).  Saving model ...
Epoch: 19 cost time: 0.7919967174530029
Epoch: 19, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.502 Vali Acc: 0.919 Test Loss: 0.502 Test Acc: 0.919
Validation loss decreased (-0.903698 --> -0.918513).  Saving model ...
Epoch: 20 cost time: 0.9461359977722168
Epoch: 20, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.451 Vali Acc: 0.919 Test Loss: 0.451 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 21 cost time: 1.131572961807251
Epoch: 21, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.411 Vali Acc: 0.922 Test Loss: 0.411 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 22 cost time: 1.0381324291229248
Epoch: 22, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.376 Vali Acc: 0.926 Test Loss: 0.376 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 23 cost time: 1.1489732265472412
Epoch: 23, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.357 Vali Acc: 0.915 Test Loss: 0.357 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.234520435333252
Epoch: 24, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.323 Vali Acc: 0.933 Test Loss: 0.323 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 25 cost time: 0.9663586616516113
Epoch: 25, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.091334581375122
Epoch: 26, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 1.0407886505126953
Epoch: 27, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 1.3334357738494873
Epoch: 28, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.261 Vali Acc: 0.933 Test Loss: 0.261 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.9490749835968018
Epoch: 29, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.9603555202484131
Epoch: 30, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.902202844619751
Epoch: 31, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.173008680343628
Epoch: 32, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0443074703216553
Epoch: 33, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9910507202148438
Epoch: 34, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0591623783111572
Epoch: 35, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.924950122833252
Epoch: 36, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.9154937267303467
Epoch: 37, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 1.0937137603759766
Epoch: 38, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.8922021389007568
Epoch: 39, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 40 cost time: 0.8730068206787109
Epoch: 40, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.166712760925293
Epoch: 41, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1236038208007812
Epoch: 42, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.042989730834961
Epoch: 43, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9205164909362793
Epoch: 44, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.000685214996338
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.9710779190063477
Epoch: 46, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.0694527626037598
Epoch: 47, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.1467869281768799
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.9910554885864258
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 2706242
model size : 12.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.371973752975464
Epoch: 1, Steps: 2 | Train Loss: 2.005 Vali Loss: 1.929 Vali Acc: 0.230 Test Loss: 1.929 Test Acc: 0.230
Validation loss decreased (inf --> -0.229610).  Saving model ...
Epoch: 2 cost time: 0.993912935256958
Epoch: 2, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.906 Vali Acc: 0.252 Test Loss: 1.906 Test Acc: 0.252
Validation loss decreased (-0.229610 --> -0.251833).  Saving model ...
Epoch: 3 cost time: 0.9397284984588623
Epoch: 3, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.869 Vali Acc: 0.300 Test Loss: 1.869 Test Acc: 0.300
Validation loss decreased (-0.251833 --> -0.299981).  Saving model ...
Epoch: 4 cost time: 1.0660600662231445
Epoch: 4, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.812 Vali Acc: 0.363 Test Loss: 1.812 Test Acc: 0.363
Validation loss decreased (-0.299981 --> -0.362945).  Saving model ...
Epoch: 5 cost time: 1.2362439632415771
Epoch: 5, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.752 Vali Acc: 0.341 Test Loss: 1.752 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2824130058288574
Epoch: 6, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.693 Vali Acc: 0.352 Test Loss: 1.693 Test Acc: 0.352
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3534057140350342
Epoch: 7, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.634 Vali Acc: 0.389 Test Loss: 1.634 Test Acc: 0.389
Validation loss decreased (-0.362945 --> -0.388873).  Saving model ...
Epoch: 8 cost time: 0.9070498943328857
Epoch: 8, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.565 Vali Acc: 0.404 Test Loss: 1.565 Test Acc: 0.404
Validation loss decreased (-0.388873 --> -0.403688).  Saving model ...
Epoch: 9 cost time: 1.0757746696472168
Epoch: 9, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.485 Vali Acc: 0.567 Test Loss: 1.485 Test Acc: 0.567
Validation loss decreased (-0.403688 --> -0.566652).  Saving model ...
Epoch: 10 cost time: 0.7350680828094482
Epoch: 10, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.399 Vali Acc: 0.711 Test Loss: 1.399 Test Acc: 0.711
Validation loss decreased (-0.566652 --> -0.711097).  Saving model ...
Epoch: 11 cost time: 1.1697466373443604
Epoch: 11, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.304 Vali Acc: 0.756 Test Loss: 1.304 Test Acc: 0.756
Validation loss decreased (-0.711097 --> -0.755543).  Saving model ...
Epoch: 12 cost time: 0.8436312675476074
Epoch: 12, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.206 Vali Acc: 0.778 Test Loss: 1.206 Test Acc: 0.778
Validation loss decreased (-0.755543 --> -0.777766).  Saving model ...
Epoch: 13 cost time: 0.9226303100585938
Epoch: 13, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.102 Vali Acc: 0.785 Test Loss: 1.102 Test Acc: 0.785
Validation loss decreased (-0.777766 --> -0.785174).  Saving model ...
Epoch: 14 cost time: 1.1060941219329834
Epoch: 14, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.003 Vali Acc: 0.778 Test Loss: 1.003 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.003643274307251
Epoch: 15, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.908 Vali Acc: 0.800 Test Loss: 0.908 Test Acc: 0.800
Validation loss decreased (-0.785174 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 1.3687689304351807
Epoch: 16, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.819 Vali Acc: 0.830 Test Loss: 0.819 Test Acc: 0.830
Validation loss decreased (-0.799991 --> -0.829621).  Saving model ...
Epoch: 17 cost time: 0.7764627933502197
Epoch: 17, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.747 Vali Acc: 0.837 Test Loss: 0.747 Test Acc: 0.837
Validation loss decreased (-0.829621 --> -0.837030).  Saving model ...
Epoch: 18 cost time: 1.053318977355957
Epoch: 18, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.688 Vali Acc: 0.826 Test Loss: 0.688 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9699819087982178
Epoch: 19, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.629 Vali Acc: 0.837 Test Loss: 0.629 Test Acc: 0.837
Validation loss decreased (-0.837030 --> -0.837031).  Saving model ...
Epoch: 20 cost time: 0.9574382305145264
Epoch: 20, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.574 Vali Acc: 0.856 Test Loss: 0.574 Test Acc: 0.856
Validation loss decreased (-0.837031 --> -0.855550).  Saving model ...
Epoch: 21 cost time: 1.0254511833190918
Epoch: 21, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.534 Vali Acc: 0.889 Test Loss: 0.534 Test Acc: 0.889
Validation loss decreased (-0.855550 --> -0.888884).  Saving model ...
Epoch: 22 cost time: 1.094499111175537
Epoch: 22, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.514 Vali Acc: 0.885 Test Loss: 0.514 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.243462085723877
Epoch: 23, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.479 Vali Acc: 0.896 Test Loss: 0.479 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896292).  Saving model ...
Epoch: 24 cost time: 1.1439087390899658
Epoch: 24, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.448 Vali Acc: 0.900 Test Loss: 0.448 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 25 cost time: 1.1330349445343018
Epoch: 25, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.416 Vali Acc: 0.907 Test Loss: 0.416 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907403).  Saving model ...
Epoch: 26 cost time: 0.9237289428710938
Epoch: 26, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.405 Vali Acc: 0.907 Test Loss: 0.405 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 27 cost time: 1.008951187133789
Epoch: 27, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.397 Vali Acc: 0.896 Test Loss: 0.397 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.4160735607147217
Epoch: 28, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.2739660739898682
Epoch: 29, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8152976036071777
Epoch: 30, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.361 Vali Acc: 0.900 Test Loss: 0.361 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9033780097961426
Epoch: 31, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911108).  Saving model ...
Epoch: 32 cost time: 1.0770361423492432
Epoch: 32, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.322 Vali Acc: 0.919 Test Loss: 0.322 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918515).  Saving model ...
Epoch: 33 cost time: 0.8692946434020996
Epoch: 33, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 34 cost time: 0.9840784072875977
Epoch: 34, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8971438407897949
Epoch: 35, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.91835618019104
Epoch: 36, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.330 Vali Acc: 0.904 Test Loss: 0.330 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0970842838287354
Epoch: 37, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.320 Vali Acc: 0.907 Test Loss: 0.320 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1836578845977783
Epoch: 38, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.304 Vali Acc: 0.911 Test Loss: 0.304 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.020033359527588
Epoch: 39, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.296 Vali Acc: 0.915 Test Loss: 0.296 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.387728214263916
Epoch: 40, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 41 cost time: 1.013972520828247
Epoch: 41, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 42 cost time: 1.1929471492767334
Epoch: 42, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.2643420696258545
Epoch: 43, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.286 Vali Acc: 0.915 Test Loss: 0.286 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1578788757324219
Epoch: 44, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.285 Vali Acc: 0.919 Test Loss: 0.285 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.877608060836792
Epoch: 45, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.282 Vali Acc: 0.915 Test Loss: 0.282 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9102871417999268
Epoch: 46, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.282 Vali Acc: 0.919 Test Loss: 0.282 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.7889759540557861
Epoch: 47, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.287 Vali Acc: 0.915 Test Loss: 0.287 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.0609369277954102
Epoch: 48, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.286 Vali Acc: 0.907 Test Loss: 0.286 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9829437732696533
Epoch: 49, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.277 Vali Acc: 0.915 Test Loss: 0.277 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.9832029342651367
Epoch: 50, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.185730218887329
Epoch: 51, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 52 cost time: 0.894629716873169
Epoch: 52, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 53 cost time: 0.9282629489898682
Epoch: 53, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.3398799896240234
Epoch: 54, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9231178760528564
Epoch: 55, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.278 Vali Acc: 0.904 Test Loss: 0.278 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8644094467163086
Epoch: 56, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.273 Vali Acc: 0.907 Test Loss: 0.273 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0377216339111328
Epoch: 57, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.262 Vali Acc: 0.915 Test Loss: 0.262 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9260880947113037
Epoch: 58, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 1.1381328105926514
Epoch: 59, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 60 cost time: 0.8607161045074463
Epoch: 60, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.103520393371582
Epoch: 61, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.1287338733673096
Epoch: 62, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.254 Vali Acc: 0.919 Test Loss: 0.254 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.0213301181793213
Epoch: 63, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.262 Vali Acc: 0.915 Test Loss: 0.262 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.808021068572998
Epoch: 64, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.987187385559082
Epoch: 65, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 1.1451880931854248
Epoch: 66, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 1.2359309196472168
Epoch: 67, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 1.1760237216949463
Epoch: 68, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.8684430122375488
Epoch: 69, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 1806466
model size : 8.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.96271014213562
Epoch: 1, Steps: 2 | Train Loss: 1.910 Vali Loss: 1.883 Vali Acc: 0.144 Test Loss: 1.883 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.9575881958007812
Epoch: 2, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.858 Vali Acc: 0.119 Test Loss: 1.858 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2450556755065918
Epoch: 3, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.818 Vali Acc: 0.107 Test Loss: 1.818 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0055625438690186
Epoch: 4, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.758 Vali Acc: 0.200 Test Loss: 1.758 Test Acc: 0.200
Validation loss decreased (-0.144426 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 0.9672701358795166
Epoch: 5, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.703 Vali Acc: 0.393 Test Loss: 1.703 Test Acc: 0.393
Validation loss decreased (-0.199982 --> -0.392576).  Saving model ...
Epoch: 6 cost time: 1.082292079925537
Epoch: 6, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.654 Vali Acc: 0.507 Test Loss: 1.654 Test Acc: 0.507
Validation loss decreased (-0.392576 --> -0.507391).  Saving model ...
Epoch: 7 cost time: 1.0916972160339355
Epoch: 7, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.606 Vali Acc: 0.515 Test Loss: 1.606 Test Acc: 0.515
Validation loss decreased (-0.507391 --> -0.514799).  Saving model ...
Epoch: 8 cost time: 0.8240046501159668
Epoch: 8, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.552 Vali Acc: 0.515 Test Loss: 1.552 Test Acc: 0.515
Validation loss decreased (-0.514799 --> -0.514799).  Saving model ...
Epoch: 9 cost time: 1.1113340854644775
Epoch: 9, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.481 Vali Acc: 0.567 Test Loss: 1.481 Test Acc: 0.567
Validation loss decreased (-0.514799 --> -0.566652).  Saving model ...
Epoch: 10 cost time: 1.0782394409179688
Epoch: 10, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.388 Vali Acc: 0.652 Test Loss: 1.388 Test Acc: 0.652
Validation loss decreased (-0.566652 --> -0.651838).  Saving model ...
Epoch: 11 cost time: 1.1215479373931885
Epoch: 11, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.290 Vali Acc: 0.733 Test Loss: 1.290 Test Acc: 0.733
Validation loss decreased (-0.651838 --> -0.733320).  Saving model ...
Epoch: 12 cost time: 1.2596344947814941
Epoch: 12, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.197 Vali Acc: 0.804 Test Loss: 1.197 Test Acc: 0.804
Validation loss decreased (-0.733320 --> -0.803692).  Saving model ...
Epoch: 13 cost time: 1.2105259895324707
Epoch: 13, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.100 Vali Acc: 0.800 Test Loss: 1.100 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3197734355926514
Epoch: 14, Steps: 2 | Train Loss: 1.003 Vali Loss: 0.998 Vali Acc: 0.830 Test Loss: 0.998 Test Acc: 0.830
Validation loss decreased (-0.803692 --> -0.829620).  Saving model ...
Epoch: 15 cost time: 0.9793281555175781
Epoch: 15, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.898 Vali Acc: 0.852 Test Loss: 0.898 Test Acc: 0.852
Validation loss decreased (-0.829620 --> -0.851843).  Saving model ...
Epoch: 16 cost time: 1.213686227798462
Epoch: 16, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.807 Vali Acc: 0.856 Test Loss: 0.807 Test Acc: 0.856
Validation loss decreased (-0.851843 --> -0.855547).  Saving model ...
Epoch: 17 cost time: 1.1179654598236084
Epoch: 17, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.732 Vali Acc: 0.859 Test Loss: 0.732 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859252).  Saving model ...
Epoch: 18 cost time: 1.1434688568115234
Epoch: 18, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.675 Vali Acc: 0.856 Test Loss: 0.675 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8587753772735596
Epoch: 19, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.618 Vali Acc: 0.881 Test Loss: 0.618 Test Acc: 0.881
Validation loss decreased (-0.859252 --> -0.881475).  Saving model ...
Epoch: 20 cost time: 1.1301846504211426
Epoch: 20, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.575 Vali Acc: 0.900 Test Loss: 0.575 Test Acc: 0.900
Validation loss decreased (-0.881475 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 1.3575093746185303
Epoch: 21, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 22 cost time: 1.0061817169189453
Epoch: 22, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 1.1807587146759033
Epoch: 23, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.467 Vali Acc: 0.911 Test Loss: 0.467 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911106).  Saving model ...
Epoch: 24 cost time: 0.9456658363342285
Epoch: 24, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.438 Vali Acc: 0.907 Test Loss: 0.438 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.669865369796753
Epoch: 25, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.421 Vali Acc: 0.904 Test Loss: 0.421 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0001957416534424
Epoch: 26, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.400 Vali Acc: 0.896 Test Loss: 0.400 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.1126487255096436
Epoch: 27, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.380 Vali Acc: 0.904 Test Loss: 0.380 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1782417297363281
Epoch: 28, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.362 Vali Acc: 0.922 Test Loss: 0.362 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922219).  Saving model ...
Epoch: 29 cost time: 0.9183125495910645
Epoch: 29, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.350 Vali Acc: 0.922 Test Loss: 0.350 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 30 cost time: 1.1211910247802734
Epoch: 30, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 31 cost time: 1.2020668983459473
Epoch: 31, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.339 Vali Acc: 0.915 Test Loss: 0.339 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.069237470626831
Epoch: 32, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.335 Vali Acc: 0.907 Test Loss: 0.335 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0166146755218506
Epoch: 33, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 34 cost time: 1.0022716522216797
Epoch: 34, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.320 Vali Acc: 0.926 Test Loss: 0.320 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 35 cost time: 1.0364789962768555
Epoch: 35, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.313 Vali Acc: 0.926 Test Loss: 0.313 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 36 cost time: 1.0042455196380615
Epoch: 36, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 37 cost time: 0.8896975517272949
Epoch: 37, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 38 cost time: 0.8992412090301514
Epoch: 38, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.290 Vali Acc: 0.926 Test Loss: 0.290 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 39 cost time: 1.5244345664978027
Epoch: 39, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 40 cost time: 1.0887060165405273
Epoch: 40, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 41 cost time: 1.1591713428497314
Epoch: 41, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.272 Vali Acc: 0.926 Test Loss: 0.272 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 42 cost time: 0.9799339771270752
Epoch: 42, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0896730422973633
Epoch: 43, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.285 Vali Acc: 0.926 Test Loss: 0.285 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1531758308410645
Epoch: 44, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.2795979976654053
Epoch: 45, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.281 Vali Acc: 0.926 Test Loss: 0.281 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0915186405181885
Epoch: 46, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.2155463695526123
Epoch: 47, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.020768404006958
Epoch: 48, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.262 Vali Acc: 0.930 Test Loss: 0.262 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 49 cost time: 0.9171075820922852
Epoch: 49, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.120208501815796
Epoch: 50, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 51 cost time: 1.0233752727508545
Epoch: 51, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 52 cost time: 1.39577317237854
Epoch: 52, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 53 cost time: 1.182375192642212
Epoch: 53, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.0185928344726562
Epoch: 54, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8476557731628418
Epoch: 55, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.0634715557098389
Epoch: 56, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9721822738647461
Epoch: 57, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.00496506690979
Epoch: 58, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9207711219787598
Epoch: 59, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.9980592727661133
Epoch: 60, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.4856767654418945
Epoch: 61, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.353283405303955
Epoch: 62, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 63 cost time: 1.3781323432922363
Epoch: 63, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 64 cost time: 0.9325644969940186
Epoch: 64, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 65 cost time: 1.0927245616912842
Epoch: 65, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.374054193496704
Epoch: 66, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.1472423076629639
Epoch: 67, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.9591553211212158
Epoch: 68, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.1572139263153076
Epoch: 69, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.1957106590270996
Epoch: 70, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.189197063446045
Epoch: 71, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 1.4410147666931152
Epoch: 72, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 1.2372970581054688
Epoch: 73, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 1.1784343719482422
Epoch: 74, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 1805698
model size : 8.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.183379650115967
Epoch: 1, Steps: 2 | Train Loss: 1.977 Vali Loss: 1.921 Vali Acc: 0.178 Test Loss: 1.921 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 1.1046695709228516
Epoch: 2, Steps: 2 | Train Loss: 2.030 Vali Loss: 1.899 Vali Acc: 0.174 Test Loss: 1.899 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9094052314758301
Epoch: 3, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.866 Vali Acc: 0.163 Test Loss: 1.866 Test Acc: 0.163
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.084409475326538
Epoch: 4, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.812 Vali Acc: 0.207 Test Loss: 1.812 Test Acc: 0.207
Validation loss decreased (-0.177759 --> -0.207389).  Saving model ...
Epoch: 5 cost time: 1.0760560035705566
Epoch: 5, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.756 Vali Acc: 0.219 Test Loss: 1.756 Test Acc: 0.219
Validation loss decreased (-0.207389 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 0.9953835010528564
Epoch: 6, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.704 Vali Acc: 0.274 Test Loss: 1.704 Test Acc: 0.274
Validation loss decreased (-0.218501 --> -0.274057).  Saving model ...
Epoch: 7 cost time: 0.9370989799499512
Epoch: 7, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.653 Vali Acc: 0.319 Test Loss: 1.653 Test Acc: 0.319
Validation loss decreased (-0.274057 --> -0.318502).  Saving model ...
Epoch: 8 cost time: 1.0581746101379395
Epoch: 8, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.593 Vali Acc: 0.437 Test Loss: 1.593 Test Acc: 0.437
Validation loss decreased (-0.318502 --> -0.437021).  Saving model ...
Epoch: 9 cost time: 1.106863260269165
Epoch: 9, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.529 Vali Acc: 0.544 Test Loss: 1.529 Test Acc: 0.544
Validation loss decreased (-0.437021 --> -0.544429).  Saving model ...
Epoch: 10 cost time: 1.0398075580596924
Epoch: 10, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.450 Vali Acc: 0.711 Test Loss: 1.450 Test Acc: 0.711
Validation loss decreased (-0.544429 --> -0.711097).  Saving model ...
Epoch: 11 cost time: 0.9527721405029297
Epoch: 11, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.364 Vali Acc: 0.759 Test Loss: 1.364 Test Acc: 0.759
Validation loss decreased (-0.711097 --> -0.759246).  Saving model ...
Epoch: 12 cost time: 1.124983549118042
Epoch: 12, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.272 Vali Acc: 0.759 Test Loss: 1.272 Test Acc: 0.759
Validation loss decreased (-0.759246 --> -0.759247).  Saving model ...
Epoch: 13 cost time: 0.8796849250793457
Epoch: 13, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.174 Vali Acc: 0.811 Test Loss: 1.174 Test Acc: 0.811
Validation loss decreased (-0.759247 --> -0.811099).  Saving model ...
Epoch: 14 cost time: 1.2036223411560059
Epoch: 14, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.076 Vali Acc: 0.856 Test Loss: 1.076 Test Acc: 0.856
Validation loss decreased (-0.811099 --> -0.855545).  Saving model ...
Epoch: 15 cost time: 1.0518443584442139
Epoch: 15, Steps: 2 | Train Loss: 0.972 Vali Loss: 0.979 Vali Acc: 0.889 Test Loss: 0.979 Test Acc: 0.889
Validation loss decreased (-0.855545 --> -0.888879).  Saving model ...
Epoch: 16 cost time: 0.9606022834777832
Epoch: 16, Steps: 2 | Train Loss: 0.963 Vali Loss: 0.888 Vali Acc: 0.878 Test Loss: 0.888 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9815659523010254
Epoch: 17, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.808 Vali Acc: 0.874 Test Loss: 0.808 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.002927303314209
Epoch: 18, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.731 Vali Acc: 0.911 Test Loss: 0.731 Test Acc: 0.911
Validation loss decreased (-0.888879 --> -0.911104).  Saving model ...
Epoch: 19 cost time: 0.9043409824371338
Epoch: 19, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.667 Vali Acc: 0.911 Test Loss: 0.667 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911104).  Saving model ...
Epoch: 20 cost time: 1.0161550045013428
Epoch: 20, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.610 Vali Acc: 0.919 Test Loss: 0.610 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 21 cost time: 1.3691868782043457
Epoch: 21, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.562 Vali Acc: 0.919 Test Loss: 0.562 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 22 cost time: 1.2177166938781738
Epoch: 22, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.524 Vali Acc: 0.937 Test Loss: 0.524 Test Acc: 0.937
Validation loss decreased (-0.918513 --> -0.937032).  Saving model ...
Epoch: 23 cost time: 1.0617940425872803
Epoch: 23, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.496 Vali Acc: 0.930 Test Loss: 0.496 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9370145797729492
Epoch: 24, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.475 Vali Acc: 0.930 Test Loss: 0.475 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.055415153503418
Epoch: 25, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.459 Vali Acc: 0.911 Test Loss: 0.459 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0420210361480713
Epoch: 26, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.444 Vali Acc: 0.911 Test Loss: 0.444 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.076751708984375
Epoch: 27, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.427 Vali Acc: 0.907 Test Loss: 0.427 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8904399871826172
Epoch: 28, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.412 Vali Acc: 0.907 Test Loss: 0.412 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1888024806976318
Epoch: 29, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.389 Vali Acc: 0.915 Test Loss: 0.389 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.070854663848877
Epoch: 30, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.376 Vali Acc: 0.904 Test Loss: 0.376 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4767448902130127
Epoch: 31, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.370 Vali Acc: 0.896 Test Loss: 0.370 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.101304054260254
Epoch: 32, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.363 Vali Acc: 0.904 Test Loss: 0.363 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 1804930
model size : 8.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.5618021488189697
Epoch: 1, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.811 Vali Acc: 0.170 Test Loss: 1.811 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 1.157170057296753
Epoch: 2, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.780 Vali Acc: 0.200 Test Loss: 1.780 Test Acc: 0.200
Validation loss decreased (-0.170352 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.9519073963165283
Epoch: 3, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.741 Vali Acc: 0.289 Test Loss: 1.741 Test Acc: 0.289
Validation loss decreased (-0.199982 --> -0.288871).  Saving model ...
Epoch: 4 cost time: 0.8812940120697021
Epoch: 4, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.683 Vali Acc: 0.381 Test Loss: 1.683 Test Acc: 0.381
Validation loss decreased (-0.288871 --> -0.381465).  Saving model ...
Epoch: 5 cost time: 1.6253948211669922
Epoch: 5, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.626 Vali Acc: 0.411 Test Loss: 1.626 Test Acc: 0.411
Validation loss decreased (-0.381465 --> -0.411095).  Saving model ...
Epoch: 6 cost time: 1.4033381938934326
Epoch: 6, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.565 Vali Acc: 0.500 Test Loss: 1.565 Test Acc: 0.500
Validation loss decreased (-0.411095 --> -0.499984).  Saving model ...
Epoch: 7 cost time: 1.0232551097869873
Epoch: 7, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.499 Vali Acc: 0.585 Test Loss: 1.499 Test Acc: 0.585
Validation loss decreased (-0.499984 --> -0.585170).  Saving model ...
Epoch: 8 cost time: 0.935142993927002
Epoch: 8, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.426 Vali Acc: 0.630 Test Loss: 1.426 Test Acc: 0.630
Validation loss decreased (-0.585170 --> -0.629615).  Saving model ...
Epoch: 9 cost time: 0.9417769908905029
Epoch: 9, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.341 Vali Acc: 0.656 Test Loss: 1.341 Test Acc: 0.656
Validation loss decreased (-0.629615 --> -0.655542).  Saving model ...
Epoch: 10 cost time: 1.2515037059783936
Epoch: 10, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.240 Vali Acc: 0.689 Test Loss: 1.240 Test Acc: 0.689
Validation loss decreased (-0.655542 --> -0.688876).  Saving model ...
Epoch: 11 cost time: 1.2441520690917969
Epoch: 11, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.134 Vali Acc: 0.744 Test Loss: 1.134 Test Acc: 0.744
Validation loss decreased (-0.688876 --> -0.744433).  Saving model ...
Epoch: 12 cost time: 1.1798505783081055
Epoch: 12, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.037 Vali Acc: 0.778 Test Loss: 1.037 Test Acc: 0.778
Validation loss decreased (-0.744433 --> -0.777767).  Saving model ...
Epoch: 13 cost time: 1.0321228504180908
Epoch: 13, Steps: 2 | Train Loss: 0.996 Vali Loss: 0.948 Vali Acc: 0.759 Test Loss: 0.948 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9647676944732666
Epoch: 14, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.860 Vali Acc: 0.781 Test Loss: 0.860 Test Acc: 0.781
Validation loss decreased (-0.777767 --> -0.781473).  Saving model ...
Epoch: 15 cost time: 1.0932538509368896
Epoch: 15, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.775 Vali Acc: 0.819 Test Loss: 0.775 Test Acc: 0.819
Validation loss decreased (-0.781473 --> -0.818511).  Saving model ...
Epoch: 16 cost time: 1.0182178020477295
Epoch: 16, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.702 Vali Acc: 0.848 Test Loss: 0.702 Test Acc: 0.848
Validation loss decreased (-0.818511 --> -0.848141).  Saving model ...
Epoch: 17 cost time: 0.9121432304382324
Epoch: 17, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.651 Vali Acc: 0.870 Test Loss: 0.651 Test Acc: 0.870
Validation loss decreased (-0.848141 --> -0.870364).  Saving model ...
Epoch: 18 cost time: 0.8993339538574219
Epoch: 18, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.613 Vali Acc: 0.870 Test Loss: 0.613 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 19 cost time: 0.8888709545135498
Epoch: 19, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.577 Vali Acc: 0.867 Test Loss: 0.577 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.331394910812378
Epoch: 20, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.544 Vali Acc: 0.870 Test Loss: 0.544 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870365).  Saving model ...
Epoch: 21 cost time: 0.9607653617858887
Epoch: 21, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.511 Vali Acc: 0.881 Test Loss: 0.511 Test Acc: 0.881
Validation loss decreased (-0.870365 --> -0.881476).  Saving model ...
Epoch: 22 cost time: 1.0110888481140137
Epoch: 22, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.482 Vali Acc: 0.893 Test Loss: 0.482 Test Acc: 0.893
Validation loss decreased (-0.881476 --> -0.892588).  Saving model ...
Epoch: 23 cost time: 0.9441373348236084
Epoch: 23, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.096604824066162
Epoch: 24, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.450 Vali Acc: 0.896 Test Loss: 0.450 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 25 cost time: 1.0899600982666016
Epoch: 25, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.433 Vali Acc: 0.900 Test Loss: 0.433 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 26 cost time: 0.9929425716400146
Epoch: 26, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.428 Vali Acc: 0.907 Test Loss: 0.428 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907403).  Saving model ...
Epoch: 27 cost time: 0.9326431751251221
Epoch: 27, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.424 Vali Acc: 0.896 Test Loss: 0.424 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1918866634368896
Epoch: 28, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.412 Vali Acc: 0.896 Test Loss: 0.412 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.4603145122528076
Epoch: 29, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9851462841033936
Epoch: 30, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0326042175292969
Epoch: 31, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.377 Vali Acc: 0.907 Test Loss: 0.377 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 32 cost time: 0.9005472660064697
Epoch: 32, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.368 Vali Acc: 0.911 Test Loss: 0.368 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911107).  Saving model ...
Epoch: 33 cost time: 1.2795729637145996
Epoch: 33, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.373 Vali Acc: 0.911 Test Loss: 0.373 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9420814514160156
Epoch: 34, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.390 Vali Acc: 0.893 Test Loss: 0.390 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9733014106750488
Epoch: 35, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.381 Vali Acc: 0.896 Test Loss: 0.381 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.326216459274292
Epoch: 36, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.350 Vali Acc: 0.907 Test Loss: 0.350 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1229629516601562
Epoch: 37, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.329 Vali Acc: 0.926 Test Loss: 0.329 Test Acc: 0.926
Validation loss decreased (-0.911107 --> -0.925923).  Saving model ...
Epoch: 38 cost time: 0.9663033485412598
Epoch: 38, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.323 Vali Acc: 0.915 Test Loss: 0.323 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1167802810668945
Epoch: 39, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.316 Vali Acc: 0.930 Test Loss: 0.316 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929626).  Saving model ...
Epoch: 40 cost time: 0.9708852767944336
Epoch: 40, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.6615099906921387
Epoch: 41, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.338 Vali Acc: 0.911 Test Loss: 0.338 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1809587478637695
Epoch: 42, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3070323467254639
Epoch: 43, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.339 Vali Acc: 0.904 Test Loss: 0.339 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9247832298278809
Epoch: 44, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9966921806335449
Epoch: 45, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.304 Vali Acc: 0.915 Test Loss: 0.304 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2027523517608643
Epoch: 46, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.300 Vali Acc: 0.926 Test Loss: 0.300 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.2400214672088623
Epoch: 47, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.0310823917388916
Epoch: 48, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.318 Vali Acc: 0.907 Test Loss: 0.318 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.0209376811981201
Epoch: 49, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.337 Vali Acc: 0.896 Test Loss: 0.337 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 1804162
model size : 8.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4930741786956787
Epoch: 1, Steps: 2 | Train Loss: 1.970 Vali Loss: 1.854 Vali Acc: 0.167 Test Loss: 1.854 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.9753406047821045
Epoch: 2, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.817 Vali Acc: 0.174 Test Loss: 1.817 Test Acc: 0.174
Validation loss decreased (-0.166648 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 1.1226239204406738
Epoch: 3, Steps: 2 | Train Loss: 1.910 Vali Loss: 1.775 Vali Acc: 0.200 Test Loss: 1.775 Test Acc: 0.200
Validation loss decreased (-0.174056 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 1.017549991607666
Epoch: 4, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.715 Vali Acc: 0.267 Test Loss: 1.715 Test Acc: 0.267
Validation loss decreased (-0.199982 --> -0.266650).  Saving model ...
Epoch: 5 cost time: 1.1018133163452148
Epoch: 5, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.668 Vali Acc: 0.400 Test Loss: 1.668 Test Acc: 0.400
Validation loss decreased (-0.266650 --> -0.399983).  Saving model ...
Epoch: 6 cost time: 0.8202469348907471
Epoch: 6, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.635 Vali Acc: 0.300 Test Loss: 1.635 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.927985668182373
Epoch: 7, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.603 Vali Acc: 0.289 Test Loss: 1.603 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1368341445922852
Epoch: 8, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.558 Vali Acc: 0.341 Test Loss: 1.558 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9331917762756348
Epoch: 9, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.499 Vali Acc: 0.419 Test Loss: 1.499 Test Acc: 0.419
Validation loss decreased (-0.399983 --> -0.418504).  Saving model ...
Epoch: 10 cost time: 1.0366616249084473
Epoch: 10, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.426 Vali Acc: 0.641 Test Loss: 1.426 Test Acc: 0.641
Validation loss decreased (-0.418504 --> -0.640726).  Saving model ...
Epoch: 11 cost time: 0.8021080493927002
Epoch: 11, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.344 Vali Acc: 0.741 Test Loss: 1.344 Test Acc: 0.741
Validation loss decreased (-0.640726 --> -0.740727).  Saving model ...
Epoch: 12 cost time: 0.8580491542816162
Epoch: 12, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.264 Vali Acc: 0.781 Test Loss: 1.264 Test Acc: 0.781
Validation loss decreased (-0.740727 --> -0.781469).  Saving model ...
Epoch: 13 cost time: 0.7397472858428955
Epoch: 13, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.189 Vali Acc: 0.822 Test Loss: 1.189 Test Acc: 0.822
Validation loss decreased (-0.781469 --> -0.822210).  Saving model ...
Epoch: 14 cost time: 0.9003157615661621
Epoch: 14, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.110 Vali Acc: 0.856 Test Loss: 1.110 Test Acc: 0.856
Validation loss decreased (-0.822210 --> -0.855544).  Saving model ...
Epoch: 15 cost time: 0.8277106285095215
Epoch: 15, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.027 Vali Acc: 0.885 Test Loss: 1.027 Test Acc: 0.885
Validation loss decreased (-0.855544 --> -0.885175).  Saving model ...
Epoch: 16 cost time: 0.8843770027160645
Epoch: 16, Steps: 2 | Train Loss: 0.993 Vali Loss: 0.944 Vali Acc: 0.878 Test Loss: 0.944 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2450592517852783
Epoch: 17, Steps: 2 | Train Loss: 0.904 Vali Loss: 0.875 Vali Acc: 0.878 Test Loss: 0.875 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7327525615692139
Epoch: 18, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.816 Vali Acc: 0.889 Test Loss: 0.816 Test Acc: 0.889
Validation loss decreased (-0.885175 --> -0.888881).  Saving model ...
Epoch: 19 cost time: 0.9635119438171387
Epoch: 19, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.765 Vali Acc: 0.878 Test Loss: 0.765 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.3180251121520996
Epoch: 20, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.714 Vali Acc: 0.870 Test Loss: 0.714 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9714672565460205
Epoch: 21, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.669 Vali Acc: 0.870 Test Loss: 0.669 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0004851818084717
Epoch: 22, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.615 Vali Acc: 0.889 Test Loss: 0.615 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888883).  Saving model ...
Epoch: 23 cost time: 1.1734519004821777
Epoch: 23, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.566 Vali Acc: 0.919 Test Loss: 0.566 Test Acc: 0.919
Validation loss decreased (-0.888883 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 1.0104734897613525
Epoch: 24, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.532 Vali Acc: 0.911 Test Loss: 0.532 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0088720321655273
Epoch: 25, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.502 Vali Acc: 0.919 Test Loss: 0.502 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 26 cost time: 0.9799861907958984
Epoch: 26, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.488 Vali Acc: 0.915 Test Loss: 0.488 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.22874116897583
Epoch: 27, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.482 Vali Acc: 0.896 Test Loss: 0.482 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.4408650398254395
Epoch: 28, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.476 Vali Acc: 0.885 Test Loss: 0.476 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8462178707122803
Epoch: 29, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.451 Vali Acc: 0.893 Test Loss: 0.451 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9122312068939209
Epoch: 30, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9386842250823975
Epoch: 31, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.411 Vali Acc: 0.907 Test Loss: 0.411 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1105339527130127
Epoch: 32, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.396 Vali Acc: 0.900 Test Loss: 0.396 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0259370803833008
Epoch: 33, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.392 Vali Acc: 0.900 Test Loss: 0.392 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.997530460357666
Epoch: 34, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.378 Vali Acc: 0.907 Test Loss: 0.378 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.821413516998291
Epoch: 35, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.361 Vali Acc: 0.926 Test Loss: 0.361 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925922).  Saving model ...
Epoch: 36 cost time: 0.9190289974212646
Epoch: 36, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.340 Vali Acc: 0.930 Test Loss: 0.340 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 37 cost time: 0.9307446479797363
Epoch: 37, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.332 Vali Acc: 0.930 Test Loss: 0.332 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 38 cost time: 0.9010522365570068
Epoch: 38, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.331 Vali Acc: 0.933 Test Loss: 0.331 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 39 cost time: 1.1900453567504883
Epoch: 39, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.331 Vali Acc: 0.930 Test Loss: 0.331 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8573470115661621
Epoch: 40, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.333 Vali Acc: 0.919 Test Loss: 0.333 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.1694362163543701
Epoch: 41, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.332 Vali Acc: 0.919 Test Loss: 0.332 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0862863063812256
Epoch: 42, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9018316268920898
Epoch: 43, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.313 Vali Acc: 0.926 Test Loss: 0.313 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.1654222011566162
Epoch: 44, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.306 Vali Acc: 0.930 Test Loss: 0.306 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.048727035522461
Epoch: 45, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.302 Vali Acc: 0.926 Test Loss: 0.302 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0030498504638672
Epoch: 46, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 1.0487160682678223
Epoch: 47, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.295 Vali Acc: 0.926 Test Loss: 0.295 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.1571214199066162
Epoch: 48, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 1212034
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.886686325073242
Epoch: 1, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.862 Vali Acc: 0.100 Test Loss: 1.862 Test Acc: 0.100
Validation loss decreased (inf --> -0.099981).  Saving model ...
Epoch: 2 cost time: 1.0587680339813232
Epoch: 2, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.841 Vali Acc: 0.096 Test Loss: 1.841 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9716153144836426
Epoch: 3, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.812 Vali Acc: 0.081 Test Loss: 1.812 Test Acc: 0.081
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1471025943756104
Epoch: 4, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.766 Vali Acc: 0.093 Test Loss: 1.766 Test Acc: 0.093
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.083423376083374
Epoch: 5, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.717 Vali Acc: 0.259 Test Loss: 1.717 Test Acc: 0.259
Validation loss decreased (-0.099981 --> -0.259242).  Saving model ...
Epoch: 6 cost time: 0.8371405601501465
Epoch: 6, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.668 Vali Acc: 0.370 Test Loss: 1.668 Test Acc: 0.370
Validation loss decreased (-0.259242 --> -0.370354).  Saving model ...
Epoch: 7 cost time: 1.171154260635376
Epoch: 7, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.615 Vali Acc: 0.441 Test Loss: 1.615 Test Acc: 0.441
Validation loss decreased (-0.370354 --> -0.440725).  Saving model ...
Epoch: 8 cost time: 0.8102076053619385
Epoch: 8, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.560 Vali Acc: 0.470 Test Loss: 1.560 Test Acc: 0.470
Validation loss decreased (-0.440725 --> -0.470355).  Saving model ...
Epoch: 9 cost time: 0.8385512828826904
Epoch: 9, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.500 Vali Acc: 0.496 Test Loss: 1.500 Test Acc: 0.496
Validation loss decreased (-0.470355 --> -0.496281).  Saving model ...
Epoch: 10 cost time: 1.0965821743011475
Epoch: 10, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.427 Vali Acc: 0.522 Test Loss: 1.427 Test Acc: 0.522
Validation loss decreased (-0.496281 --> -0.522208).  Saving model ...
Epoch: 11 cost time: 1.0200870037078857
Epoch: 11, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.345 Vali Acc: 0.659 Test Loss: 1.345 Test Acc: 0.659
Validation loss decreased (-0.522208 --> -0.659246).  Saving model ...
Epoch: 12 cost time: 1.0133531093597412
Epoch: 12, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.260 Vali Acc: 0.763 Test Loss: 1.260 Test Acc: 0.763
Validation loss decreased (-0.659246 --> -0.762950).  Saving model ...
Epoch: 13 cost time: 0.9900648593902588
Epoch: 13, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.175 Vali Acc: 0.793 Test Loss: 1.175 Test Acc: 0.793
Validation loss decreased (-0.762950 --> -0.792581).  Saving model ...
Epoch: 14 cost time: 0.9377460479736328
Epoch: 14, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.086 Vali Acc: 0.804 Test Loss: 1.086 Test Acc: 0.804
Validation loss decreased (-0.792581 --> -0.803693).  Saving model ...
Epoch: 15 cost time: 0.9699859619140625
Epoch: 15, Steps: 2 | Train Loss: 0.965 Vali Loss: 1.002 Vali Acc: 0.822 Test Loss: 1.002 Test Acc: 0.822
Validation loss decreased (-0.803693 --> -0.822212).  Saving model ...
Epoch: 16 cost time: 1.0046982765197754
Epoch: 16, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.920 Vali Acc: 0.844 Test Loss: 0.920 Test Acc: 0.844
Validation loss decreased (-0.822212 --> -0.844435).  Saving model ...
Epoch: 17 cost time: 0.9844627380371094
Epoch: 17, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.838 Vali Acc: 0.893 Test Loss: 0.838 Test Acc: 0.893
Validation loss decreased (-0.844435 --> -0.892584).  Saving model ...
Epoch: 18 cost time: 0.9428300857543945
Epoch: 18, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.767 Vali Acc: 0.919 Test Loss: 0.767 Test Acc: 0.919
Validation loss decreased (-0.892584 --> -0.918511).  Saving model ...
Epoch: 19 cost time: 0.9190654754638672
Epoch: 19, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.719 Vali Acc: 0.896 Test Loss: 0.719 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0380148887634277
Epoch: 20, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.679 Vali Acc: 0.896 Test Loss: 0.679 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.15354585647583
Epoch: 21, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.629 Vali Acc: 0.904 Test Loss: 0.629 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.2096614837646484
Epoch: 22, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.584 Vali Acc: 0.893 Test Loss: 0.584 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.6510727405548096
Epoch: 23, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.534 Vali Acc: 0.915 Test Loss: 0.534 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3476934432983398
Epoch: 24, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.501 Vali Acc: 0.915 Test Loss: 0.501 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1468164920806885
Epoch: 25, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.475 Vali Acc: 0.922 Test Loss: 0.475 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922217).  Saving model ...
Epoch: 26 cost time: 0.9843301773071289
Epoch: 26, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.461 Vali Acc: 0.915 Test Loss: 0.461 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8571922779083252
Epoch: 27, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.450 Vali Acc: 0.919 Test Loss: 0.450 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9521999359130859
Epoch: 28, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.437 Vali Acc: 0.919 Test Loss: 0.437 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.1625401973724365
Epoch: 29, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.424 Vali Acc: 0.926 Test Loss: 0.424 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 1.0390801429748535
Epoch: 30, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.406 Vali Acc: 0.926 Test Loss: 0.406 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 31 cost time: 0.9881441593170166
Epoch: 31, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.388 Vali Acc: 0.922 Test Loss: 0.388 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.2044742107391357
Epoch: 32, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.372 Vali Acc: 0.919 Test Loss: 0.372 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0283372402191162
Epoch: 33, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.072441816329956
Epoch: 34, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.356 Vali Acc: 0.926 Test Loss: 0.356 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 35 cost time: 0.9404408931732178
Epoch: 35, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.362 Vali Acc: 0.922 Test Loss: 0.362 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9112920761108398
Epoch: 36, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.362 Vali Acc: 0.915 Test Loss: 0.362 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8766300678253174
Epoch: 37, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.351 Vali Acc: 0.922 Test Loss: 0.351 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9579048156738281
Epoch: 38, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.341 Vali Acc: 0.919 Test Loss: 0.341 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0477409362792969
Epoch: 39, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.323 Vali Acc: 0.926 Test Loss: 0.323 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 40 cost time: 0.9598569869995117
Epoch: 40, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.310 Vali Acc: 0.922 Test Loss: 0.310 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.3583943843841553
Epoch: 41, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.300 Vali Acc: 0.926 Test Loss: 0.300 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 42 cost time: 1.0331811904907227
Epoch: 42, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.8166983127593994
Epoch: 43, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1359012126922607
Epoch: 44, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.1305427551269531
Epoch: 45, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.309 Vali Acc: 0.919 Test Loss: 0.309 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8884072303771973
Epoch: 46, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.308 Vali Acc: 0.915 Test Loss: 0.308 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.0094120502471924
Epoch: 47, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9715471267700195
Epoch: 48, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.2458384037017822
Epoch: 49, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 50 cost time: 1.0233371257781982
Epoch: 50, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 51 cost time: 1.073122262954712
Epoch: 51, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.9889297485351562
Epoch: 52, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.286 Vali Acc: 0.919 Test Loss: 0.286 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1248440742492676
Epoch: 53, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1351966857910156
Epoch: 54, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.0556035041809082
Epoch: 55, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.281 Vali Acc: 0.922 Test Loss: 0.281 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.2459032535552979
Epoch: 56, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.2487561702728271
Epoch: 57, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.261 Vali Acc: 0.922 Test Loss: 0.261 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.0867326259613037
Epoch: 58, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.260 Vali Acc: 0.919 Test Loss: 0.260 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.0369300842285156
Epoch: 59, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.262 Vali Acc: 0.915 Test Loss: 0.262 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.163508653640747
Epoch: 60, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.265 Vali Acc: 0.915 Test Loss: 0.265 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 1211266
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.677469253540039
Epoch: 1, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.870 Vali Acc: 0.237 Test Loss: 1.870 Test Acc: 0.237
Validation loss decreased (inf --> -0.237018).  Saving model ...
Epoch: 2 cost time: 0.7846453189849854
Epoch: 2, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.857 Vali Acc: 0.248 Test Loss: 1.857 Test Acc: 0.248
Validation loss decreased (-0.237018 --> -0.248130).  Saving model ...
Epoch: 3 cost time: 0.8338010311126709
Epoch: 3, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.834 Vali Acc: 0.263 Test Loss: 1.834 Test Acc: 0.263
Validation loss decreased (-0.248130 --> -0.262945).  Saving model ...
Epoch: 4 cost time: 0.9005000591278076
Epoch: 4, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.793 Vali Acc: 0.304 Test Loss: 1.793 Test Acc: 0.304
Validation loss decreased (-0.262945 --> -0.303686).  Saving model ...
Epoch: 5 cost time: 1.1272664070129395
Epoch: 5, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.743 Vali Acc: 0.330 Test Loss: 1.743 Test Acc: 0.330
Validation loss decreased (-0.303686 --> -0.329612).  Saving model ...
Epoch: 6 cost time: 0.9535171985626221
Epoch: 6, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.690 Vali Acc: 0.330 Test Loss: 1.690 Test Acc: 0.330
Validation loss decreased (-0.329612 --> -0.329613).  Saving model ...
Epoch: 7 cost time: 0.9153733253479004
Epoch: 7, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.637 Vali Acc: 0.359 Test Loss: 1.637 Test Acc: 0.359
Validation loss decreased (-0.329613 --> -0.359243).  Saving model ...
Epoch: 8 cost time: 0.7086136341094971
Epoch: 8, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.582 Vali Acc: 0.433 Test Loss: 1.582 Test Acc: 0.433
Validation loss decreased (-0.359243 --> -0.433318).  Saving model ...
Epoch: 9 cost time: 1.0837664604187012
Epoch: 9, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.522 Vali Acc: 0.522 Test Loss: 1.522 Test Acc: 0.522
Validation loss decreased (-0.433318 --> -0.522207).  Saving model ...
Epoch: 10 cost time: 0.9412007331848145
Epoch: 10, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.450 Vali Acc: 0.607 Test Loss: 1.450 Test Acc: 0.607
Validation loss decreased (-0.522207 --> -0.607393).  Saving model ...
Epoch: 11 cost time: 0.7673003673553467
Epoch: 11, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.371 Vali Acc: 0.685 Test Loss: 1.371 Test Acc: 0.685
Validation loss decreased (-0.607393 --> -0.685171).  Saving model ...
Epoch: 12 cost time: 0.8196811676025391
Epoch: 12, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.287 Vali Acc: 0.719 Test Loss: 1.287 Test Acc: 0.719
Validation loss decreased (-0.685171 --> -0.718506).  Saving model ...
Epoch: 13 cost time: 0.8545713424682617
Epoch: 13, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.195 Vali Acc: 0.770 Test Loss: 1.195 Test Acc: 0.770
Validation loss decreased (-0.718506 --> -0.770358).  Saving model ...
Epoch: 14 cost time: 0.8648974895477295
Epoch: 14, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.105 Vali Acc: 0.804 Test Loss: 1.105 Test Acc: 0.804
Validation loss decreased (-0.770358 --> -0.803693).  Saving model ...
Epoch: 15 cost time: 0.9038865566253662
Epoch: 15, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.016 Vali Acc: 0.807 Test Loss: 1.016 Test Acc: 0.807
Validation loss decreased (-0.803693 --> -0.807397).  Saving model ...
Epoch: 16 cost time: 0.8439412117004395
Epoch: 16, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.931 Vali Acc: 0.819 Test Loss: 0.931 Test Acc: 0.819
Validation loss decreased (-0.807397 --> -0.818509).  Saving model ...
Epoch: 17 cost time: 0.9320826530456543
Epoch: 17, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.853 Vali Acc: 0.833 Test Loss: 0.853 Test Acc: 0.833
Validation loss decreased (-0.818509 --> -0.833325).  Saving model ...
Epoch: 18 cost time: 1.0447666645050049
Epoch: 18, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.784 Vali Acc: 0.830 Test Loss: 0.784 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9230668544769287
Epoch: 19, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.725 Vali Acc: 0.830 Test Loss: 0.725 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2112059593200684
Epoch: 20, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.679 Vali Acc: 0.826 Test Loss: 0.679 Test Acc: 0.826
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7723054885864258
Epoch: 21, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.630 Vali Acc: 0.863 Test Loss: 0.630 Test Acc: 0.863
Validation loss decreased (-0.833325 --> -0.862957).  Saving model ...
Epoch: 22 cost time: 1.1508243083953857
Epoch: 22, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.589 Vali Acc: 0.870 Test Loss: 0.589 Test Acc: 0.870
Validation loss decreased (-0.862957 --> -0.870364).  Saving model ...
Epoch: 23 cost time: 1.1004209518432617
Epoch: 23, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.552 Vali Acc: 0.889 Test Loss: 0.552 Test Acc: 0.889
Validation loss decreased (-0.870364 --> -0.888883).  Saving model ...
Epoch: 24 cost time: 0.9886531829833984
Epoch: 24, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.517 Vali Acc: 0.907 Test Loss: 0.517 Test Acc: 0.907
Validation loss decreased (-0.888883 --> -0.907402).  Saving model ...
Epoch: 25 cost time: 0.9867222309112549
Epoch: 25, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.492 Vali Acc: 0.889 Test Loss: 0.492 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0326085090637207
Epoch: 26, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9352550506591797
Epoch: 27, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.445 Vali Acc: 0.911 Test Loss: 0.445 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911107).  Saving model ...
Epoch: 28 cost time: 0.9457964897155762
Epoch: 28, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.425 Vali Acc: 0.911 Test Loss: 0.425 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 29 cost time: 0.7706811428070068
Epoch: 29, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.406 Vali Acc: 0.907 Test Loss: 0.406 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.002661943435669
Epoch: 30, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.392 Vali Acc: 0.907 Test Loss: 0.392 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0027215480804443
Epoch: 31, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.382 Vali Acc: 0.922 Test Loss: 0.382 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922218).  Saving model ...
Epoch: 32 cost time: 1.0966639518737793
Epoch: 32, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.376 Vali Acc: 0.911 Test Loss: 0.376 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9139318466186523
Epoch: 33, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.369 Vali Acc: 0.911 Test Loss: 0.369 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8327710628509521
Epoch: 34, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.346 Vali Acc: 0.926 Test Loss: 0.346 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 35 cost time: 1.01906156539917
Epoch: 35, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.328 Vali Acc: 0.919 Test Loss: 0.328 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8839778900146484
Epoch: 36, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9508366584777832
Epoch: 37, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.311 Vali Acc: 0.926 Test Loss: 0.311 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 38 cost time: 0.9707400798797607
Epoch: 38, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.312 Vali Acc: 0.930 Test Loss: 0.312 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 1.1095702648162842
Epoch: 39, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.322 Vali Acc: 0.922 Test Loss: 0.322 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.380537509918213
Epoch: 40, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.325 Vali Acc: 0.919 Test Loss: 0.325 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9713690280914307
Epoch: 41, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.319 Vali Acc: 0.922 Test Loss: 0.319 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.0035197734832764
Epoch: 42, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.301 Vali Acc: 0.930 Test Loss: 0.301 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.8534529209136963
Epoch: 43, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 44 cost time: 1.2112336158752441
Epoch: 44, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.286 Vali Acc: 0.933 Test Loss: 0.286 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 45 cost time: 1.0321288108825684
Epoch: 45, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.87811279296875
Epoch: 46, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0960502624511719
Epoch: 47, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0641837120056152
Epoch: 48, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.550938367843628
Epoch: 49, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 50 cost time: 0.9122414588928223
Epoch: 50, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 51 cost time: 0.8268229961395264
Epoch: 51, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.262 Vali Acc: 0.937 Test Loss: 0.262 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 52 cost time: 1.126828670501709
Epoch: 52, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 53 cost time: 0.915757417678833
Epoch: 53, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 54 cost time: 0.9982972145080566
Epoch: 54, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.1808497905731201
Epoch: 55, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 56 cost time: 0.870572566986084
Epoch: 56, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1330256462097168
Epoch: 57, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.909332275390625
Epoch: 58, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 1.201470136642456
Epoch: 59, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.9612770080566406
Epoch: 60, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.9731738567352295
Epoch: 61, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.0137524604797363
Epoch: 62, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.0717546939849854
Epoch: 63, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 1.23103666305542
Epoch: 64, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.3090753555297852
Epoch: 65, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.96224045753479
Epoch: 66, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.0502431392669678
Epoch: 67, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.0502429008483887
Epoch: 68, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.2099692821502686
Epoch: 69, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.3146977424621582
Epoch: 70, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.2710046768188477
Epoch: 71, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.2224969863891602
Epoch: 72, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.083092212677002
Epoch: 73, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1210498
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9583327770233154
Epoch: 1, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.844 Vali Acc: 0.133 Test Loss: 1.844 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 0.9298439025878906
Epoch: 2, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.831 Vali Acc: 0.133 Test Loss: 1.831 Test Acc: 0.133
Validation loss decreased (-0.133315 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 1.0725617408752441
Epoch: 3, Steps: 2 | Train Loss: 1.947 Vali Loss: 1.812 Vali Acc: 0.152 Test Loss: 1.812 Test Acc: 0.152
Validation loss decreased (-0.133315 --> -0.151834).  Saving model ...
Epoch: 4 cost time: 1.2153189182281494
Epoch: 4, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.783 Vali Acc: 0.159 Test Loss: 1.783 Test Acc: 0.159
Validation loss decreased (-0.151834 --> -0.159241).  Saving model ...
Epoch: 5 cost time: 0.9922037124633789
Epoch: 5, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.752 Vali Acc: 0.204 Test Loss: 1.752 Test Acc: 0.204
Validation loss decreased (-0.159241 --> -0.203686).  Saving model ...
Epoch: 6 cost time: 0.8324658870697021
Epoch: 6, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.720 Vali Acc: 0.278 Test Loss: 1.720 Test Acc: 0.278
Validation loss decreased (-0.203686 --> -0.277761).  Saving model ...
Epoch: 7 cost time: 0.8983254432678223
Epoch: 7, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.686 Vali Acc: 0.319 Test Loss: 1.686 Test Acc: 0.319
Validation loss decreased (-0.277761 --> -0.318502).  Saving model ...
Epoch: 8 cost time: 1.0301082134246826
Epoch: 8, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.647 Vali Acc: 0.452 Test Loss: 1.647 Test Acc: 0.452
Validation loss decreased (-0.318502 --> -0.451835).  Saving model ...
Epoch: 9 cost time: 1.0035929679870605
Epoch: 9, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.604 Vali Acc: 0.500 Test Loss: 1.604 Test Acc: 0.500
Validation loss decreased (-0.451835 --> -0.499984).  Saving model ...
Epoch: 10 cost time: 1.1247920989990234
Epoch: 10, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.554 Vali Acc: 0.574 Test Loss: 1.554 Test Acc: 0.574
Validation loss decreased (-0.499984 --> -0.574059).  Saving model ...
Epoch: 11 cost time: 0.8089220523834229
Epoch: 11, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.500 Vali Acc: 0.622 Test Loss: 1.500 Test Acc: 0.622
Validation loss decreased (-0.574059 --> -0.622207).  Saving model ...
Epoch: 12 cost time: 0.8357136249542236
Epoch: 12, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.439 Vali Acc: 0.685 Test Loss: 1.439 Test Acc: 0.685
Validation loss decreased (-0.622207 --> -0.685171).  Saving model ...
Epoch: 13 cost time: 0.8341577053070068
Epoch: 13, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.373 Vali Acc: 0.726 Test Loss: 1.373 Test Acc: 0.726
Validation loss decreased (-0.685171 --> -0.725912).  Saving model ...
Epoch: 14 cost time: 0.8446934223175049
Epoch: 14, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.302 Vali Acc: 0.778 Test Loss: 1.302 Test Acc: 0.778
Validation loss decreased (-0.725912 --> -0.777765).  Saving model ...
Epoch: 15 cost time: 0.8685407638549805
Epoch: 15, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.229 Vali Acc: 0.796 Test Loss: 1.229 Test Acc: 0.796
Validation loss decreased (-0.777765 --> -0.796284).  Saving model ...
Epoch: 16 cost time: 0.9826309680938721
Epoch: 16, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.148 Vali Acc: 0.778 Test Loss: 1.148 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0420093536376953
Epoch: 17, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.066 Vali Acc: 0.822 Test Loss: 1.066 Test Acc: 0.822
Validation loss decreased (-0.796284 --> -0.822212).  Saving model ...
Epoch: 18 cost time: 0.9556610584259033
Epoch: 18, Steps: 2 | Train Loss: 1.037 Vali Loss: 0.983 Vali Acc: 0.830 Test Loss: 0.983 Test Acc: 0.830
Validation loss decreased (-0.822212 --> -0.829620).  Saving model ...
Epoch: 19 cost time: 0.9665846824645996
Epoch: 19, Steps: 2 | Train Loss: 0.910 Vali Loss: 0.902 Vali Acc: 0.841 Test Loss: 0.902 Test Acc: 0.841
Validation loss decreased (-0.829620 --> -0.840732).  Saving model ...
Epoch: 20 cost time: 0.8624207973480225
Epoch: 20, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.827 Vali Acc: 0.837 Test Loss: 0.827 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1436750888824463
Epoch: 21, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.756 Vali Acc: 0.848 Test Loss: 0.756 Test Acc: 0.848
Validation loss decreased (-0.840732 --> -0.848141).  Saving model ...
Epoch: 22 cost time: 1.0561864376068115
Epoch: 22, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.698 Vali Acc: 0.852 Test Loss: 0.698 Test Acc: 0.852
Validation loss decreased (-0.848141 --> -0.851845).  Saving model ...
Epoch: 23 cost time: 0.9723522663116455
Epoch: 23, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.641 Vali Acc: 0.867 Test Loss: 0.641 Test Acc: 0.867
Validation loss decreased (-0.851845 --> -0.866660).  Saving model ...
Epoch: 24 cost time: 1.1449975967407227
Epoch: 24, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.591 Vali Acc: 0.878 Test Loss: 0.591 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 25 cost time: 1.079427719116211
Epoch: 25, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.559 Vali Acc: 0.874 Test Loss: 0.559 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0215258598327637
Epoch: 26, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.530 Vali Acc: 0.874 Test Loss: 0.530 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0954716205596924
Epoch: 27, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.505 Vali Acc: 0.874 Test Loss: 0.505 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.218308448791504
Epoch: 28, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.478 Vali Acc: 0.874 Test Loss: 0.478 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9615392684936523
Epoch: 29, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.452 Vali Acc: 0.881 Test Loss: 0.452 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881477).  Saving model ...
Epoch: 30 cost time: 1.2308709621429443
Epoch: 30, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.434 Vali Acc: 0.885 Test Loss: 0.434 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885181).  Saving model ...
Epoch: 31 cost time: 1.184941053390503
Epoch: 31, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.412 Vali Acc: 0.885 Test Loss: 0.412 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 32 cost time: 1.0557987689971924
Epoch: 32, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.399 Vali Acc: 0.893 Test Loss: 0.399 Test Acc: 0.893
Validation loss decreased (-0.885181 --> -0.892589).  Saving model ...
Epoch: 33 cost time: 0.9380531311035156
Epoch: 33, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.379 Vali Acc: 0.893 Test Loss: 0.379 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 34 cost time: 1.161848545074463
Epoch: 34, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.350 Vali Acc: 0.907 Test Loss: 0.350 Test Acc: 0.907
Validation loss decreased (-0.892589 --> -0.907404).  Saving model ...
Epoch: 35 cost time: 1.1415410041809082
Epoch: 35, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
Validation loss decreased (-0.907404 --> -0.922219).  Saving model ...
Epoch: 36 cost time: 0.7610988616943359
Epoch: 36, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 37 cost time: 0.7936241626739502
Epoch: 37, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.304 Vali Acc: 0.926 Test Loss: 0.304 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 38 cost time: 0.7972862720489502
Epoch: 38, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 1.0459632873535156
Epoch: 39, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8409810066223145
Epoch: 40, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.292 Vali Acc: 0.919 Test Loss: 0.292 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9415726661682129
Epoch: 41, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.290 Vali Acc: 0.919 Test Loss: 0.290 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9877541065216064
Epoch: 42, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7447178363800049
Epoch: 43, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9398126602172852
Epoch: 44, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.9002511501312256
Epoch: 45, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.7805488109588623
Epoch: 46, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.823822021484375
Epoch: 47, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 1.0008862018585205
Epoch: 48, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 49 cost time: 1.0831201076507568
Epoch: 49, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.7899923324584961
Epoch: 50, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7844958305358887
Epoch: 51, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9316833019256592
Epoch: 52, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.203622817993164
Epoch: 53, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9467356204986572
Epoch: 54, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.8032615184783936
Epoch: 55, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.0214099884033203
Epoch: 56, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 1.1093144416809082
Epoch: 57, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 1.1219089031219482
Epoch: 58, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 59 cost time: 1.0627658367156982
Epoch: 59, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 60 cost time: 0.9926795959472656
Epoch: 60, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 61 cost time: 0.811042070388794
Epoch: 61, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9774377346038818
Epoch: 62, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.3154864311218262
Epoch: 63, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.0973553657531738
Epoch: 64, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.969348669052124
Epoch: 65, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.003816843032837
Epoch: 66, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.8992495536804199
Epoch: 67, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.7566051483154297
Epoch: 68, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.8638696670532227
Epoch: 69, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.1925461292266846
Epoch: 70, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 1209730
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8068883419036865
Epoch: 1, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.877 Vali Acc: 0.185 Test Loss: 1.877 Test Acc: 0.185
Validation loss decreased (inf --> -0.185166).  Saving model ...
Epoch: 2 cost time: 1.0411512851715088
Epoch: 2, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.852 Vali Acc: 0.196 Test Loss: 1.852 Test Acc: 0.196
Validation loss decreased (-0.185166 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.8430721759796143
Epoch: 3, Steps: 2 | Train Loss: 1.975 Vali Loss: 1.824 Vali Acc: 0.204 Test Loss: 1.824 Test Acc: 0.204
Validation loss decreased (-0.196278 --> -0.203685).  Saving model ...
Epoch: 4 cost time: 1.0882129669189453
Epoch: 4, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.782 Vali Acc: 0.222 Test Loss: 1.782 Test Acc: 0.222
Validation loss decreased (-0.203685 --> -0.222204).  Saving model ...
Epoch: 5 cost time: 0.9232990741729736
Epoch: 5, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.732 Vali Acc: 0.259 Test Loss: 1.732 Test Acc: 0.259
Validation loss decreased (-0.222204 --> -0.259242).  Saving model ...
Epoch: 6 cost time: 0.7787048816680908
Epoch: 6, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.681 Vali Acc: 0.333 Test Loss: 1.681 Test Acc: 0.333
Validation loss decreased (-0.259242 --> -0.333317).  Saving model ...
Epoch: 7 cost time: 0.7246530055999756
Epoch: 7, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.629 Vali Acc: 0.448 Test Loss: 1.629 Test Acc: 0.448
Validation loss decreased (-0.333317 --> -0.448132).  Saving model ...
Epoch: 8 cost time: 0.8774542808532715
Epoch: 8, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.577 Vali Acc: 0.556 Test Loss: 1.577 Test Acc: 0.556
Validation loss decreased (-0.448132 --> -0.555540).  Saving model ...
Epoch: 9 cost time: 0.9118475914001465
Epoch: 9, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.528 Vali Acc: 0.644 Test Loss: 1.528 Test Acc: 0.644
Validation loss decreased (-0.555540 --> -0.644429).  Saving model ...
Epoch: 10 cost time: 1.0259742736816406
Epoch: 10, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.479 Vali Acc: 0.626 Test Loss: 1.479 Test Acc: 0.626
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8998229503631592
Epoch: 11, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.425 Vali Acc: 0.604 Test Loss: 1.425 Test Acc: 0.604
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7821855545043945
Epoch: 12, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.367 Vali Acc: 0.622 Test Loss: 1.367 Test Acc: 0.622
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9230608940124512
Epoch: 13, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.303 Vali Acc: 0.656 Test Loss: 1.303 Test Acc: 0.656
Validation loss decreased (-0.644429 --> -0.655543).  Saving model ...
Epoch: 14 cost time: 0.9327223300933838
Epoch: 14, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.231 Vali Acc: 0.685 Test Loss: 1.231 Test Acc: 0.685
Validation loss decreased (-0.655543 --> -0.685173).  Saving model ...
Epoch: 15 cost time: 1.0616788864135742
Epoch: 15, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.155 Vali Acc: 0.756 Test Loss: 1.155 Test Acc: 0.756
Validation loss decreased (-0.685173 --> -0.755544).  Saving model ...
Epoch: 16 cost time: 0.7556107044219971
Epoch: 16, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.085 Vali Acc: 0.781 Test Loss: 1.085 Test Acc: 0.781
Validation loss decreased (-0.755544 --> -0.781471).  Saving model ...
Epoch: 17 cost time: 0.8721168041229248
Epoch: 17, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.015 Vali Acc: 0.778 Test Loss: 1.015 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8526360988616943
Epoch: 18, Steps: 2 | Train Loss: 1.014 Vali Loss: 0.952 Vali Acc: 0.789 Test Loss: 0.952 Test Acc: 0.789
Validation loss decreased (-0.781471 --> -0.788879).  Saving model ...
Epoch: 19 cost time: 1.023841142654419
Epoch: 19, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.892 Vali Acc: 0.800 Test Loss: 0.892 Test Acc: 0.800
Validation loss decreased (-0.788879 --> -0.799991).  Saving model ...
Epoch: 20 cost time: 1.146524429321289
Epoch: 20, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.834 Vali Acc: 0.826 Test Loss: 0.834 Test Acc: 0.826
Validation loss decreased (-0.799991 --> -0.825918).  Saving model ...
Epoch: 21 cost time: 0.907952070236206
Epoch: 21, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.782 Vali Acc: 0.830 Test Loss: 0.782 Test Acc: 0.830
Validation loss decreased (-0.825918 --> -0.829622).  Saving model ...
Epoch: 22 cost time: 1.1512234210968018
Epoch: 22, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.733 Vali Acc: 0.841 Test Loss: 0.733 Test Acc: 0.841
Validation loss decreased (-0.829622 --> -0.840733).  Saving model ...
Epoch: 23 cost time: 0.9573862552642822
Epoch: 23, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.687 Vali Acc: 0.852 Test Loss: 0.687 Test Acc: 0.852
Validation loss decreased (-0.840733 --> -0.851845).  Saving model ...
Epoch: 24 cost time: 0.9324567317962646
Epoch: 24, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.646 Vali Acc: 0.848 Test Loss: 0.646 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1508424282073975
Epoch: 25, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.610 Vali Acc: 0.863 Test Loss: 0.610 Test Acc: 0.863
Validation loss decreased (-0.851845 --> -0.862957).  Saving model ...
Epoch: 26 cost time: 0.9632930755615234
Epoch: 26, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.574 Vali Acc: 0.874 Test Loss: 0.574 Test Acc: 0.874
Validation loss decreased (-0.862957 --> -0.874068).  Saving model ...
Epoch: 27 cost time: 1.2570421695709229
Epoch: 27, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.545 Vali Acc: 0.885 Test Loss: 0.545 Test Acc: 0.885
Validation loss decreased (-0.874068 --> -0.885180).  Saving model ...
Epoch: 28 cost time: 0.9851946830749512
Epoch: 28, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.516 Vali Acc: 0.907 Test Loss: 0.516 Test Acc: 0.907
Validation loss decreased (-0.885180 --> -0.907402).  Saving model ...
Epoch: 29 cost time: 1.0549025535583496
Epoch: 29, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.493 Vali Acc: 0.915 Test Loss: 0.493 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 30 cost time: 1.1042590141296387
Epoch: 30, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.473 Vali Acc: 0.919 Test Loss: 0.473 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 31 cost time: 0.9322359561920166
Epoch: 31, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.451 Vali Acc: 0.915 Test Loss: 0.451 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.952068567276001
Epoch: 32, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7916009426116943
Epoch: 33, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.436 Vali Acc: 0.881 Test Loss: 0.436 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.266324520111084
Epoch: 34, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.423 Vali Acc: 0.896 Test Loss: 0.423 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.908588171005249
Epoch: 35, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.397 Vali Acc: 0.919 Test Loss: 0.397 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 36 cost time: 0.9106335639953613
Epoch: 36, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.378 Vali Acc: 0.922 Test Loss: 0.378 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922218).  Saving model ...
Epoch: 37 cost time: 1.0424704551696777
Epoch: 37, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.361 Vali Acc: 0.930 Test Loss: 0.361 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 38 cost time: 0.9075736999511719
Epoch: 38, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.350 Vali Acc: 0.937 Test Loss: 0.350 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 39 cost time: 1.0391809940338135
Epoch: 39, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.340 Vali Acc: 0.937 Test Loss: 0.340 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 0.9912889003753662
Epoch: 40, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.335 Vali Acc: 0.926 Test Loss: 0.335 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1477327346801758
Epoch: 41, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1655631065368652
Epoch: 42, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.340 Vali Acc: 0.922 Test Loss: 0.340 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9106500148773193
Epoch: 43, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.329 Vali Acc: 0.926 Test Loss: 0.329 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.992856502532959
Epoch: 44, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.314 Vali Acc: 0.930 Test Loss: 0.314 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2879445552825928
Epoch: 45, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2895286083221436
Epoch: 46, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.301 Vali Acc: 0.926 Test Loss: 0.301 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8488500118255615
Epoch: 47, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9368336200714111
Epoch: 48, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 1.0539073944091797
Epoch: 49, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.297 Vali Acc: 0.933 Test Loss: 0.297 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 914818
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.9353182315826416
Epoch: 1, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.817 Vali Acc: 0.211 Test Loss: 1.817 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.9536745548248291
Epoch: 2, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.799 Vali Acc: 0.252 Test Loss: 1.799 Test Acc: 0.252
Validation loss decreased (-0.211093 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.9437181949615479
Epoch: 3, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.777 Vali Acc: 0.289 Test Loss: 1.777 Test Acc: 0.289
Validation loss decreased (-0.251834 --> -0.288871).  Saving model ...
Epoch: 4 cost time: 1.2237107753753662
Epoch: 4, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.744 Vali Acc: 0.333 Test Loss: 1.744 Test Acc: 0.333
Validation loss decreased (-0.288871 --> -0.333316).  Saving model ...
Epoch: 5 cost time: 0.9481873512268066
Epoch: 5, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.708 Vali Acc: 0.315 Test Loss: 1.708 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2027125358581543
Epoch: 6, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.669 Vali Acc: 0.359 Test Loss: 1.669 Test Acc: 0.359
Validation loss decreased (-0.333316 --> -0.359243).  Saving model ...
Epoch: 7 cost time: 0.9600996971130371
Epoch: 7, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.628 Vali Acc: 0.504 Test Loss: 1.628 Test Acc: 0.504
Validation loss decreased (-0.359243 --> -0.503687).  Saving model ...
Epoch: 8 cost time: 1.136624813079834
Epoch: 8, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.586 Vali Acc: 0.526 Test Loss: 1.586 Test Acc: 0.526
Validation loss decreased (-0.503687 --> -0.525910).  Saving model ...
Epoch: 9 cost time: 0.789832592010498
Epoch: 9, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.542 Vali Acc: 0.522 Test Loss: 1.542 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1138525009155273
Epoch: 10, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.492 Vali Acc: 0.570 Test Loss: 1.492 Test Acc: 0.570
Validation loss decreased (-0.525910 --> -0.570355).  Saving model ...
Epoch: 11 cost time: 1.0642216205596924
Epoch: 11, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.437 Vali Acc: 0.644 Test Loss: 1.437 Test Acc: 0.644
Validation loss decreased (-0.570355 --> -0.644430).  Saving model ...
Epoch: 12 cost time: 1.2927846908569336
Epoch: 12, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.377 Vali Acc: 0.678 Test Loss: 1.377 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677764).  Saving model ...
Epoch: 13 cost time: 1.0965862274169922
Epoch: 13, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.309 Vali Acc: 0.737 Test Loss: 1.309 Test Acc: 0.737
Validation loss decreased (-0.677764 --> -0.737024).  Saving model ...
Epoch: 14 cost time: 1.017977237701416
Epoch: 14, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.236 Vali Acc: 0.770 Test Loss: 1.236 Test Acc: 0.770
Validation loss decreased (-0.737024 --> -0.770358).  Saving model ...
Epoch: 15 cost time: 1.1522600650787354
Epoch: 15, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.164 Vali Acc: 0.789 Test Loss: 1.164 Test Acc: 0.789
Validation loss decreased (-0.770358 --> -0.788877).  Saving model ...
Epoch: 16 cost time: 1.1810388565063477
Epoch: 16, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.093 Vali Acc: 0.804 Test Loss: 1.093 Test Acc: 0.804
Validation loss decreased (-0.788877 --> -0.803693).  Saving model ...
Epoch: 17 cost time: 1.0678484439849854
Epoch: 17, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.025 Vali Acc: 0.833 Test Loss: 1.025 Test Acc: 0.833
Validation loss decreased (-0.803693 --> -0.833323).  Saving model ...
Epoch: 18 cost time: 0.9032635688781738
Epoch: 18, Steps: 2 | Train Loss: 0.915 Vali Loss: 0.957 Vali Acc: 0.841 Test Loss: 0.957 Test Acc: 0.841
Validation loss decreased (-0.833323 --> -0.840731).  Saving model ...
Epoch: 19 cost time: 1.0724797248840332
Epoch: 19, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.893 Vali Acc: 0.833 Test Loss: 0.893 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0909404754638672
Epoch: 20, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.835 Vali Acc: 0.848 Test Loss: 0.835 Test Acc: 0.848
Validation loss decreased (-0.840731 --> -0.848140).  Saving model ...
Epoch: 21 cost time: 0.9045484066009521
Epoch: 21, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.785 Vali Acc: 0.881 Test Loss: 0.785 Test Acc: 0.881
Validation loss decreased (-0.848140 --> -0.881474).  Saving model ...
Epoch: 22 cost time: 0.8083233833312988
Epoch: 22, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.738 Vali Acc: 0.885 Test Loss: 0.738 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 23 cost time: 0.9709005355834961
Epoch: 23, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.691 Vali Acc: 0.889 Test Loss: 0.691 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 24 cost time: 1.1546895503997803
Epoch: 24, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.647 Vali Acc: 0.893 Test Loss: 0.647 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 25 cost time: 1.1120188236236572
Epoch: 25, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.608 Vali Acc: 0.904 Test Loss: 0.608 Test Acc: 0.904
Validation loss decreased (-0.892586 --> -0.903698).  Saving model ...
Epoch: 26 cost time: 0.9855613708496094
Epoch: 26, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.572 Vali Acc: 0.904 Test Loss: 0.572 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 27 cost time: 1.082519292831421
Epoch: 27, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.540 Vali Acc: 0.911 Test Loss: 0.540 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 28 cost time: 1.1213014125823975
Epoch: 28, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.513 Vali Acc: 0.911 Test Loss: 0.513 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 29 cost time: 0.9800701141357422
Epoch: 29, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.490 Vali Acc: 0.904 Test Loss: 0.490 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.3909499645233154
Epoch: 30, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.465 Vali Acc: 0.907 Test Loss: 0.465 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0647599697113037
Epoch: 31, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.443 Vali Acc: 0.919 Test Loss: 0.443 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 32 cost time: 0.9661133289337158
Epoch: 32, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.426 Vali Acc: 0.919 Test Loss: 0.426 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 33 cost time: 1.214820146560669
Epoch: 33, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.410 Vali Acc: 0.922 Test Loss: 0.410 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 34 cost time: 1.241673469543457
Epoch: 34, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.398 Vali Acc: 0.926 Test Loss: 0.398 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 35 cost time: 1.0168626308441162
Epoch: 35, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.390 Vali Acc: 0.922 Test Loss: 0.390 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0895001888275146
Epoch: 36, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.383 Vali Acc: 0.919 Test Loss: 0.383 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.158647060394287
Epoch: 37, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.378 Vali Acc: 0.919 Test Loss: 0.378 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2368953227996826
Epoch: 38, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.371 Vali Acc: 0.919 Test Loss: 0.371 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1054949760437012
Epoch: 39, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.362 Vali Acc: 0.915 Test Loss: 0.362 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.165158748626709
Epoch: 40, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.354 Vali Acc: 0.919 Test Loss: 0.354 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3760170936584473
Epoch: 41, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.337 Vali Acc: 0.915 Test Loss: 0.337 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.140953779220581
Epoch: 42, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.326 Vali Acc: 0.930 Test Loss: 0.326 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 43 cost time: 0.9825918674468994
Epoch: 43, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.321 Vali Acc: 0.922 Test Loss: 0.321 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.044351577758789
Epoch: 44, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.0040950775146484
Epoch: 45, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.335 Vali Acc: 0.911 Test Loss: 0.335 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.019472599029541
Epoch: 46, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.334 Vali Acc: 0.907 Test Loss: 0.334 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.998779296875
Epoch: 47, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.321 Vali Acc: 0.907 Test Loss: 0.321 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1808979511260986
Epoch: 48, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.312 Vali Acc: 0.919 Test Loss: 0.312 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.3017356395721436
Epoch: 49, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.302 Vali Acc: 0.911 Test Loss: 0.302 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.0361957550048828
Epoch: 50, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.298 Vali Acc: 0.915 Test Loss: 0.298 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.8949353694915771
Epoch: 51, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.9822821617126465
Epoch: 52, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 914050
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1370534896850586
Epoch: 1, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.811 Vali Acc: 0.204 Test Loss: 1.811 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.9934463500976562
Epoch: 2, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.782 Vali Acc: 0.230 Test Loss: 1.782 Test Acc: 0.230
Validation loss decreased (-0.203686 --> -0.229612).  Saving model ...
Epoch: 3 cost time: 1.118872880935669
Epoch: 3, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.750 Vali Acc: 0.252 Test Loss: 1.750 Test Acc: 0.252
Validation loss decreased (-0.229612 --> -0.251834).  Saving model ...
Epoch: 4 cost time: 0.9235684871673584
Epoch: 4, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.705 Vali Acc: 0.296 Test Loss: 1.705 Test Acc: 0.296
Validation loss decreased (-0.251834 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 1.1058440208435059
Epoch: 5, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.652 Vali Acc: 0.374 Test Loss: 1.652 Test Acc: 0.374
Validation loss decreased (-0.296279 --> -0.374058).  Saving model ...
Epoch: 6 cost time: 0.8893747329711914
Epoch: 6, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.599 Vali Acc: 0.467 Test Loss: 1.599 Test Acc: 0.467
Validation loss decreased (-0.374058 --> -0.466651).  Saving model ...
Epoch: 7 cost time: 1.0823438167572021
Epoch: 7, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.549 Vali Acc: 0.526 Test Loss: 1.549 Test Acc: 0.526
Validation loss decreased (-0.466651 --> -0.525910).  Saving model ...
Epoch: 8 cost time: 1.2626593112945557
Epoch: 8, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.500 Vali Acc: 0.578 Test Loss: 1.500 Test Acc: 0.578
Validation loss decreased (-0.525910 --> -0.577763).  Saving model ...
Epoch: 9 cost time: 1.3226933479309082
Epoch: 9, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.450 Vali Acc: 0.604 Test Loss: 1.450 Test Acc: 0.604
Validation loss decreased (-0.577763 --> -0.603689).  Saving model ...
Epoch: 10 cost time: 0.9001572132110596
Epoch: 10, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.390 Vali Acc: 0.615 Test Loss: 1.390 Test Acc: 0.615
Validation loss decreased (-0.603689 --> -0.614801).  Saving model ...
Epoch: 11 cost time: 1.0770421028137207
Epoch: 11, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.320 Vali Acc: 0.648 Test Loss: 1.320 Test Acc: 0.648
Validation loss decreased (-0.614801 --> -0.648135).  Saving model ...
Epoch: 12 cost time: 0.9958405494689941
Epoch: 12, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.246 Vali Acc: 0.689 Test Loss: 1.246 Test Acc: 0.689
Validation loss decreased (-0.648135 --> -0.688876).  Saving model ...
Epoch: 13 cost time: 1.0033888816833496
Epoch: 13, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.168 Vali Acc: 0.793 Test Loss: 1.168 Test Acc: 0.793
Validation loss decreased (-0.688876 --> -0.792581).  Saving model ...
Epoch: 14 cost time: 0.9439671039581299
Epoch: 14, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.091 Vali Acc: 0.844 Test Loss: 1.091 Test Acc: 0.844
Validation loss decreased (-0.792581 --> -0.844434).  Saving model ...
Epoch: 15 cost time: 0.8735246658325195
Epoch: 15, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.019 Vali Acc: 0.844 Test Loss: 1.019 Test Acc: 0.844
Validation loss decreased (-0.844434 --> -0.844434).  Saving model ...
Epoch: 16 cost time: 0.8511300086975098
Epoch: 16, Steps: 2 | Train Loss: 0.945 Vali Loss: 0.950 Vali Acc: 0.837 Test Loss: 0.950 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.020787000656128
Epoch: 17, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.885 Vali Acc: 0.859 Test Loss: 0.885 Test Acc: 0.859
Validation loss decreased (-0.844434 --> -0.859250).  Saving model ...
Epoch: 18 cost time: 0.9724164009094238
Epoch: 18, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.825 Vali Acc: 0.867 Test Loss: 0.825 Test Acc: 0.867
Validation loss decreased (-0.859250 --> -0.866658).  Saving model ...
Epoch: 19 cost time: 1.3704917430877686
Epoch: 19, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.767 Vali Acc: 0.889 Test Loss: 0.767 Test Acc: 0.889
Validation loss decreased (-0.866658 --> -0.888881).  Saving model ...
Epoch: 20 cost time: 1.3222789764404297
Epoch: 20, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.717 Vali Acc: 0.885 Test Loss: 0.717 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.102449893951416
Epoch: 21, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.669 Vali Acc: 0.900 Test Loss: 0.669 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899993).  Saving model ...
Epoch: 22 cost time: 0.8838164806365967
Epoch: 22, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.624 Vali Acc: 0.911 Test Loss: 0.624 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.911105).  Saving model ...
Epoch: 23 cost time: 1.0814993381500244
Epoch: 23, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.581 Vali Acc: 0.922 Test Loss: 0.581 Test Acc: 0.922
Validation loss decreased (-0.911105 --> -0.922216).  Saving model ...
Epoch: 24 cost time: 1.190755844116211
Epoch: 24, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.545 Vali Acc: 0.922 Test Loss: 0.545 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 1.2369511127471924
Epoch: 25, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.515 Vali Acc: 0.907 Test Loss: 0.515 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0030171871185303
Epoch: 26, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.487 Vali Acc: 0.907 Test Loss: 0.487 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9107303619384766
Epoch: 27, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.466 Vali Acc: 0.900 Test Loss: 0.466 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0265867710113525
Epoch: 28, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.438 Vali Acc: 0.911 Test Loss: 0.438 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0180349349975586
Epoch: 29, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.402 Vali Acc: 0.933 Test Loss: 0.402 Test Acc: 0.933
Validation loss decreased (-0.922217 --> -0.933329).  Saving model ...
Epoch: 30 cost time: 1.3131871223449707
Epoch: 30, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.376 Vali Acc: 0.956 Test Loss: 0.376 Test Acc: 0.956
Validation loss decreased (-0.933329 --> -0.955552).  Saving model ...
Epoch: 31 cost time: 1.0405919551849365
Epoch: 31, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.361 Vali Acc: 0.952 Test Loss: 0.361 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.274512529373169
Epoch: 32, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.348 Vali Acc: 0.952 Test Loss: 0.348 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9927563667297363
Epoch: 33, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.340 Vali Acc: 0.933 Test Loss: 0.340 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0302512645721436
Epoch: 34, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.335 Vali Acc: 0.930 Test Loss: 0.335 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.950664758682251
Epoch: 35, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.143484354019165
Epoch: 36, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.315 Vali Acc: 0.941 Test Loss: 0.315 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.0307130813598633
Epoch: 37, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.307 Vali Acc: 0.937 Test Loss: 0.307 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.0430192947387695
Epoch: 38, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.0552513599395752
Epoch: 39, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.297 Vali Acc: 0.937 Test Loss: 0.297 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0806667804718018
Epoch: 40, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 913282
model size : 4.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5568342208862305
Epoch: 1, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.823 Vali Acc: 0.263 Test Loss: 1.823 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 1.0359599590301514
Epoch: 2, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.804 Vali Acc: 0.263 Test Loss: 1.804 Test Acc: 0.263
Validation loss decreased (-0.262945 --> -0.262945).  Saving model ...
Epoch: 3 cost time: 1.0502171516418457
Epoch: 3, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.781 Vali Acc: 0.274 Test Loss: 1.781 Test Acc: 0.274
Validation loss decreased (-0.262945 --> -0.274056).  Saving model ...
Epoch: 4 cost time: 0.8769338130950928
Epoch: 4, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.744 Vali Acc: 0.285 Test Loss: 1.744 Test Acc: 0.285
Validation loss decreased (-0.274056 --> -0.285168).  Saving model ...
Epoch: 5 cost time: 1.0679419040679932
Epoch: 5, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.701 Vali Acc: 0.356 Test Loss: 1.701 Test Acc: 0.356
Validation loss decreased (-0.285168 --> -0.355539).  Saving model ...
Epoch: 6 cost time: 0.9698333740234375
Epoch: 6, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.656 Vali Acc: 0.393 Test Loss: 1.656 Test Acc: 0.393
Validation loss decreased (-0.355539 --> -0.392576).  Saving model ...
Epoch: 7 cost time: 0.9886040687561035
Epoch: 7, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.611 Vali Acc: 0.507 Test Loss: 1.611 Test Acc: 0.507
Validation loss decreased (-0.392576 --> -0.507391).  Saving model ...
Epoch: 8 cost time: 0.8218543529510498
Epoch: 8, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.565 Vali Acc: 0.604 Test Loss: 1.565 Test Acc: 0.604
Validation loss decreased (-0.507391 --> -0.603688).  Saving model ...
Epoch: 9 cost time: 1.2705278396606445
Epoch: 9, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.513 Vali Acc: 0.637 Test Loss: 1.513 Test Acc: 0.637
Validation loss decreased (-0.603688 --> -0.637022).  Saving model ...
Epoch: 10 cost time: 1.0501396656036377
Epoch: 10, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.454 Vali Acc: 0.659 Test Loss: 1.454 Test Acc: 0.659
Validation loss decreased (-0.637022 --> -0.659245).  Saving model ...
Epoch: 11 cost time: 0.8124825954437256
Epoch: 11, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.387 Vali Acc: 0.719 Test Loss: 1.387 Test Acc: 0.719
Validation loss decreased (-0.659245 --> -0.718505).  Saving model ...
Epoch: 12 cost time: 0.9727919101715088
Epoch: 12, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.315 Vali Acc: 0.785 Test Loss: 1.315 Test Acc: 0.785
Validation loss decreased (-0.718505 --> -0.785172).  Saving model ...
Epoch: 13 cost time: 0.8526146411895752
Epoch: 13, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.237 Vali Acc: 0.807 Test Loss: 1.237 Test Acc: 0.807
Validation loss decreased (-0.785172 --> -0.807395).  Saving model ...
Epoch: 14 cost time: 1.0540130138397217
Epoch: 14, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.158 Vali Acc: 0.807 Test Loss: 1.158 Test Acc: 0.807
Validation loss decreased (-0.807395 --> -0.807396).  Saving model ...
Epoch: 15 cost time: 1.473895788192749
Epoch: 15, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.079 Vali Acc: 0.811 Test Loss: 1.079 Test Acc: 0.811
Validation loss decreased (-0.807396 --> -0.811100).  Saving model ...
Epoch: 16 cost time: 1.1044578552246094
Epoch: 16, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.000 Vali Acc: 0.819 Test Loss: 1.000 Test Acc: 0.819
Validation loss decreased (-0.811100 --> -0.818509).  Saving model ...
Epoch: 17 cost time: 0.7610297203063965
Epoch: 17, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.925 Vali Acc: 0.826 Test Loss: 0.925 Test Acc: 0.826
Validation loss decreased (-0.818509 --> -0.825917).  Saving model ...
Epoch: 18 cost time: 0.9185440540313721
Epoch: 18, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.850 Vali Acc: 0.848 Test Loss: 0.850 Test Acc: 0.848
Validation loss decreased (-0.825917 --> -0.848140).  Saving model ...
Epoch: 19 cost time: 0.8773055076599121
Epoch: 19, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.782 Vali Acc: 0.837 Test Loss: 0.782 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9466772079467773
Epoch: 20, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.723 Vali Acc: 0.856 Test Loss: 0.723 Test Acc: 0.856
Validation loss decreased (-0.848140 --> -0.855548).  Saving model ...
Epoch: 21 cost time: 0.9183971881866455
Epoch: 21, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.674 Vali Acc: 0.870 Test Loss: 0.674 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870364).  Saving model ...
Epoch: 22 cost time: 0.8825578689575195
Epoch: 22, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.634 Vali Acc: 0.878 Test Loss: 0.634 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877771).  Saving model ...
Epoch: 23 cost time: 0.8010785579681396
Epoch: 23, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.603 Vali Acc: 0.881 Test Loss: 0.603 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 24 cost time: 0.9029088020324707
Epoch: 24, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.572 Vali Acc: 0.896 Test Loss: 0.572 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896291).  Saving model ...
Epoch: 25 cost time: 0.8407819271087646
Epoch: 25, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.543 Vali Acc: 0.889 Test Loss: 0.543 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9848268032073975
Epoch: 26, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.515 Vali Acc: 0.900 Test Loss: 0.515 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 1.013641119003296
Epoch: 27, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.487 Vali Acc: 0.885 Test Loss: 0.487 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.058440923690796
Epoch: 28, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.465 Vali Acc: 0.889 Test Loss: 0.465 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8361766338348389
Epoch: 29, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.444 Vali Acc: 0.893 Test Loss: 0.444 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.033250331878662
Epoch: 30, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0294692516326904
Epoch: 31, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.416 Vali Acc: 0.889 Test Loss: 0.416 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0653302669525146
Epoch: 32, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.403 Vali Acc: 0.889 Test Loss: 0.403 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8683314323425293
Epoch: 33, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.391 Vali Acc: 0.900 Test Loss: 0.391 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 34 cost time: 0.8912136554718018
Epoch: 34, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.380 Vali Acc: 0.911 Test Loss: 0.380 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911107).  Saving model ...
Epoch: 35 cost time: 0.907557487487793
Epoch: 35, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.370 Vali Acc: 0.915 Test Loss: 0.370 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 36 cost time: 0.9827947616577148
Epoch: 36, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 37 cost time: 0.8348441123962402
Epoch: 37, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.354 Vali Acc: 0.926 Test Loss: 0.354 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925922).  Saving model ...
Epoch: 38 cost time: 0.9329273700714111
Epoch: 38, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7948563098907471
Epoch: 39, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0660297870635986
Epoch: 40, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.339 Vali Acc: 0.911 Test Loss: 0.339 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0452327728271484
Epoch: 41, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.332 Vali Acc: 0.907 Test Loss: 0.332 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9364697933197021
Epoch: 42, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.326 Vali Acc: 0.907 Test Loss: 0.326 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9904196262359619
Epoch: 43, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.321 Vali Acc: 0.911 Test Loss: 0.321 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.093928337097168
Epoch: 44, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.317 Vali Acc: 0.915 Test Loss: 0.317 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.2312138080596924
Epoch: 45, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.317 Vali Acc: 0.919 Test Loss: 0.317 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9341959953308105
Epoch: 46, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.9691057205200195
Epoch: 47, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.321 Vali Acc: 0.911 Test Loss: 0.321 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 912514
model size : 4.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.3736374378204346
Epoch: 1, Steps: 2 | Train Loss: 1.985 Vali Loss: 1.965 Vali Acc: 0.078 Test Loss: 1.965 Test Acc: 0.078
Validation loss decreased (inf --> -0.077758).  Saving model ...
Epoch: 2 cost time: 0.9207005500793457
Epoch: 2, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.933 Vali Acc: 0.085 Test Loss: 1.933 Test Acc: 0.085
Validation loss decreased (-0.077758 --> -0.085166).  Saving model ...
Epoch: 3 cost time: 1.0502891540527344
Epoch: 3, Steps: 2 | Train Loss: 1.968 Vali Loss: 1.901 Vali Acc: 0.089 Test Loss: 1.901 Test Acc: 0.089
Validation loss decreased (-0.085166 --> -0.088870).  Saving model ...
Epoch: 4 cost time: 1.1185956001281738
Epoch: 4, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.858 Vali Acc: 0.115 Test Loss: 1.858 Test Acc: 0.115
Validation loss decreased (-0.088870 --> -0.114796).  Saving model ...
Epoch: 5 cost time: 0.8481960296630859
Epoch: 5, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.812 Vali Acc: 0.141 Test Loss: 1.812 Test Acc: 0.141
Validation loss decreased (-0.114796 --> -0.140723).  Saving model ...
Epoch: 6 cost time: 1.0493414402008057
Epoch: 6, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.771 Vali Acc: 0.207 Test Loss: 1.771 Test Acc: 0.207
Validation loss decreased (-0.140723 --> -0.207390).  Saving model ...
Epoch: 7 cost time: 1.0916919708251953
Epoch: 7, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.733 Vali Acc: 0.304 Test Loss: 1.733 Test Acc: 0.304
Validation loss decreased (-0.207390 --> -0.303686).  Saving model ...
Epoch: 8 cost time: 1.1700854301452637
Epoch: 8, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.696 Vali Acc: 0.381 Test Loss: 1.696 Test Acc: 0.381
Validation loss decreased (-0.303686 --> -0.381465).  Saving model ...
Epoch: 9 cost time: 1.148726224899292
Epoch: 9, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.656 Vali Acc: 0.444 Test Loss: 1.656 Test Acc: 0.444
Validation loss decreased (-0.381465 --> -0.444428).  Saving model ...
Epoch: 10 cost time: 0.9255626201629639
Epoch: 10, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.613 Vali Acc: 0.548 Test Loss: 1.613 Test Acc: 0.548
Validation loss decreased (-0.444428 --> -0.548132).  Saving model ...
Epoch: 11 cost time: 1.0500948429107666
Epoch: 11, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.566 Vali Acc: 0.611 Test Loss: 1.566 Test Acc: 0.611
Validation loss decreased (-0.548132 --> -0.611095).  Saving model ...
Epoch: 12 cost time: 1.1982717514038086
Epoch: 12, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.514 Vali Acc: 0.648 Test Loss: 1.514 Test Acc: 0.648
Validation loss decreased (-0.611095 --> -0.648133).  Saving model ...
Epoch: 13 cost time: 1.0197465419769287
Epoch: 13, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.458 Vali Acc: 0.648 Test Loss: 1.458 Test Acc: 0.648
Validation loss decreased (-0.648133 --> -0.648134).  Saving model ...
Epoch: 14 cost time: 0.9298789501190186
Epoch: 14, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.397 Vali Acc: 0.644 Test Loss: 1.397 Test Acc: 0.644
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.048530101776123
Epoch: 15, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.329 Vali Acc: 0.685 Test Loss: 1.329 Test Acc: 0.685
Validation loss decreased (-0.648134 --> -0.685172).  Saving model ...
Epoch: 16 cost time: 1.0690345764160156
Epoch: 16, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.264 Vali Acc: 0.693 Test Loss: 1.264 Test Acc: 0.693
Validation loss decreased (-0.685172 --> -0.692580).  Saving model ...
Epoch: 17 cost time: 0.8707113265991211
Epoch: 17, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.192 Vali Acc: 0.726 Test Loss: 1.192 Test Acc: 0.726
Validation loss decreased (-0.692580 --> -0.725914).  Saving model ...
Epoch: 18 cost time: 1.020017385482788
Epoch: 18, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.117 Vali Acc: 0.781 Test Loss: 1.117 Test Acc: 0.781
Validation loss decreased (-0.725914 --> -0.781470).  Saving model ...
Epoch: 19 cost time: 0.9560773372650146
Epoch: 19, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.038 Vali Acc: 0.796 Test Loss: 1.038 Test Acc: 0.796
Validation loss decreased (-0.781470 --> -0.796286).  Saving model ...
Epoch: 20 cost time: 1.073533058166504
Epoch: 20, Steps: 2 | Train Loss: 0.961 Vali Loss: 0.961 Vali Acc: 0.819 Test Loss: 0.961 Test Acc: 0.819
Validation loss decreased (-0.796286 --> -0.818509).  Saving model ...
Epoch: 21 cost time: 1.2648851871490479
Epoch: 21, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.891 Vali Acc: 0.856 Test Loss: 0.891 Test Acc: 0.856
Validation loss decreased (-0.818509 --> -0.855547).  Saving model ...
Epoch: 22 cost time: 0.9973208904266357
Epoch: 22, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.824 Vali Acc: 0.859 Test Loss: 0.824 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859251).  Saving model ...
Epoch: 23 cost time: 1.019728660583496
Epoch: 23, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.763 Vali Acc: 0.889 Test Loss: 0.763 Test Acc: 0.889
Validation loss decreased (-0.859251 --> -0.888881).  Saving model ...
Epoch: 24 cost time: 1.150951862335205
Epoch: 24, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.711 Vali Acc: 0.896 Test Loss: 0.711 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896289).  Saving model ...
Epoch: 25 cost time: 0.9962918758392334
Epoch: 25, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.667 Vali Acc: 0.893 Test Loss: 0.667 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0055499076843262
Epoch: 26, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.630 Vali Acc: 0.896 Test Loss: 0.630 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896290).  Saving model ...
Epoch: 27 cost time: 1.0803747177124023
Epoch: 27, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.593 Vali Acc: 0.911 Test Loss: 0.593 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911105).  Saving model ...
Epoch: 28 cost time: 1.0302128791809082
Epoch: 28, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.565 Vali Acc: 0.919 Test Loss: 0.565 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 29 cost time: 0.9752247333526611
Epoch: 29, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.538 Vali Acc: 0.922 Test Loss: 0.538 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 30 cost time: 1.114192247390747
Epoch: 30, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.514 Vali Acc: 0.904 Test Loss: 0.514 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0925800800323486
Epoch: 31, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.490 Vali Acc: 0.900 Test Loss: 0.490 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1727869510650635
Epoch: 32, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.469 Vali Acc: 0.907 Test Loss: 0.469 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.2630188465118408
Epoch: 33, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.447 Vali Acc: 0.915 Test Loss: 0.447 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9795949459075928
Epoch: 34, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.429 Vali Acc: 0.919 Test Loss: 0.429 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.915907621383667
Epoch: 35, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.413 Vali Acc: 0.930 Test Loss: 0.413 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 36 cost time: 0.98641037940979
Epoch: 36, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.403 Vali Acc: 0.922 Test Loss: 0.403 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.398212194442749
Epoch: 37, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.401 Vali Acc: 0.922 Test Loss: 0.401 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8821737766265869
Epoch: 38, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.398 Vali Acc: 0.911 Test Loss: 0.398 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.3438775539398193
Epoch: 39, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.391 Vali Acc: 0.911 Test Loss: 0.391 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.1191494464874268
Epoch: 40, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.373 Vali Acc: 0.915 Test Loss: 0.373 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.3506906032562256
Epoch: 41, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9254593849182129
Epoch: 42, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.344 Vali Acc: 0.930 Test Loss: 0.344 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 43 cost time: 0.851050853729248
Epoch: 43, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.332 Vali Acc: 0.937 Test Loss: 0.332 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 44 cost time: 0.8504912853240967
Epoch: 44, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.325 Vali Acc: 0.933 Test Loss: 0.325 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8651680946350098
Epoch: 45, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.324 Vali Acc: 0.930 Test Loss: 0.324 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8402252197265625
Epoch: 46, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.333 Vali Acc: 0.919 Test Loss: 0.333 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9340074062347412
Epoch: 47, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.337 Vali Acc: 0.904 Test Loss: 0.337 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.9961953163146973
Epoch: 48, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.0055973529815674
Epoch: 49, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.323 Vali Acc: 0.911 Test Loss: 0.323 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.2481293678283691
Epoch: 50, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.9762232303619385
Epoch: 51, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.305 Vali Acc: 0.907 Test Loss: 0.305 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.8598771095275879
Epoch: 52, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0297393798828125
Epoch: 53, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 54 cost time: 1.2184851169586182
Epoch: 54, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 55 cost time: 0.8064651489257812
Epoch: 55, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.031644582748413
Epoch: 56, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.4202361106872559
Epoch: 57, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.288 Vali Acc: 0.904 Test Loss: 0.288 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.1874058246612549
Epoch: 58, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.283 Vali Acc: 0.904 Test Loss: 0.283 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.9732296466827393
Epoch: 59, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.275 Vali Acc: 0.907 Test Loss: 0.275 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.8764374256134033
Epoch: 60, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.0725891590118408
Epoch: 61, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.0931899547576904
Epoch: 62, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.0866892337799072
Epoch: 63, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.000014066696167
Epoch: 64, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.264 Vali Acc: 0.904 Test Loss: 0.264 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 766210
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.322272777557373
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.860 Vali Acc: 0.193 Test Loss: 1.860 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.9277799129486084
Epoch: 2, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.832 Vali Acc: 0.200 Test Loss: 1.832 Test Acc: 0.200
Validation loss decreased (-0.192574 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.9421975612640381
Epoch: 3, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.802 Vali Acc: 0.211 Test Loss: 1.802 Test Acc: 0.211
Validation loss decreased (-0.199982 --> -0.211093).  Saving model ...
Epoch: 4 cost time: 1.008469581604004
Epoch: 4, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.760 Vali Acc: 0.204 Test Loss: 1.760 Test Acc: 0.204
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8941864967346191
Epoch: 5, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.716 Vali Acc: 0.248 Test Loss: 1.716 Test Acc: 0.248
Validation loss decreased (-0.211093 --> -0.248131).  Saving model ...
Epoch: 6 cost time: 0.9726858139038086
Epoch: 6, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.674 Vali Acc: 0.400 Test Loss: 1.674 Test Acc: 0.400
Validation loss decreased (-0.248131 --> -0.399983).  Saving model ...
Epoch: 7 cost time: 1.1462187767028809
Epoch: 7, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.639 Vali Acc: 0.448 Test Loss: 1.639 Test Acc: 0.448
Validation loss decreased (-0.399983 --> -0.448132).  Saving model ...
Epoch: 8 cost time: 0.9127633571624756
Epoch: 8, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.603 Vali Acc: 0.507 Test Loss: 1.603 Test Acc: 0.507
Validation loss decreased (-0.448132 --> -0.507391).  Saving model ...
Epoch: 9 cost time: 1.300447702407837
Epoch: 9, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.564 Vali Acc: 0.544 Test Loss: 1.564 Test Acc: 0.544
Validation loss decreased (-0.507391 --> -0.544429).  Saving model ...
Epoch: 10 cost time: 1.199399471282959
Epoch: 10, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.516 Vali Acc: 0.578 Test Loss: 1.516 Test Acc: 0.578
Validation loss decreased (-0.544429 --> -0.577763).  Saving model ...
Epoch: 11 cost time: 1.095046043395996
Epoch: 11, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.456 Vali Acc: 0.644 Test Loss: 1.456 Test Acc: 0.644
Validation loss decreased (-0.577763 --> -0.644430).  Saving model ...
Epoch: 12 cost time: 0.9293348789215088
Epoch: 12, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.389 Vali Acc: 0.707 Test Loss: 1.389 Test Acc: 0.707
Validation loss decreased (-0.644430 --> -0.707394).  Saving model ...
Epoch: 13 cost time: 1.00274658203125
Epoch: 13, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.316 Vali Acc: 0.737 Test Loss: 1.316 Test Acc: 0.737
Validation loss decreased (-0.707394 --> -0.737024).  Saving model ...
Epoch: 14 cost time: 1.1554110050201416
Epoch: 14, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.240 Vali Acc: 0.796 Test Loss: 1.240 Test Acc: 0.796
Validation loss decreased (-0.737024 --> -0.796284).  Saving model ...
Epoch: 15 cost time: 1.060966968536377
Epoch: 15, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.165 Vali Acc: 0.848 Test Loss: 1.165 Test Acc: 0.848
Validation loss decreased (-0.796284 --> -0.848137).  Saving model ...
Epoch: 16 cost time: 1.0934832096099854
Epoch: 16, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.091 Vali Acc: 0.859 Test Loss: 1.091 Test Acc: 0.859
Validation loss decreased (-0.848137 --> -0.859248).  Saving model ...
Epoch: 17 cost time: 1.1741878986358643
Epoch: 17, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.018 Vali Acc: 0.867 Test Loss: 1.018 Test Acc: 0.867
Validation loss decreased (-0.859248 --> -0.866656).  Saving model ...
Epoch: 18 cost time: 1.0817780494689941
Epoch: 18, Steps: 2 | Train Loss: 0.983 Vali Loss: 0.946 Vali Acc: 0.881 Test Loss: 0.946 Test Acc: 0.881
Validation loss decreased (-0.866656 --> -0.881472).  Saving model ...
Epoch: 19 cost time: 1.0065360069274902
Epoch: 19, Steps: 2 | Train Loss: 0.955 Vali Loss: 0.880 Vali Acc: 0.885 Test Loss: 0.880 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 20 cost time: 0.765225887298584
Epoch: 20, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.819 Vali Acc: 0.904 Test Loss: 0.819 Test Acc: 0.904
Validation loss decreased (-0.885176 --> -0.903696).  Saving model ...
Epoch: 21 cost time: 1.094892978668213
Epoch: 21, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.766 Vali Acc: 0.885 Test Loss: 0.766 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2244937419891357
Epoch: 22, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.717 Vali Acc: 0.896 Test Loss: 0.717 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.276987075805664
Epoch: 23, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.669 Vali Acc: 0.911 Test Loss: 0.669 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 24 cost time: 0.9991440773010254
Epoch: 24, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.626 Vali Acc: 0.922 Test Loss: 0.626 Test Acc: 0.922
Validation loss decreased (-0.911104 --> -0.922216).  Saving model ...
Epoch: 25 cost time: 1.0238158702850342
Epoch: 25, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.587 Vali Acc: 0.926 Test Loss: 0.587 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 26 cost time: 1.0225918292999268
Epoch: 26, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.553 Vali Acc: 0.922 Test Loss: 0.553 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2212307453155518
Epoch: 27, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.522 Vali Acc: 0.926 Test Loss: 0.522 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 28 cost time: 1.5539965629577637
Epoch: 28, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.497 Vali Acc: 0.930 Test Loss: 0.497 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 29 cost time: 1.0791783332824707
Epoch: 29, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.475 Vali Acc: 0.926 Test Loss: 0.475 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.043621301651001
Epoch: 30, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.457 Vali Acc: 0.922 Test Loss: 0.457 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0797040462493896
Epoch: 31, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.443 Vali Acc: 0.915 Test Loss: 0.443 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9840197563171387
Epoch: 32, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.427 Vali Acc: 0.915 Test Loss: 0.427 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9213318824768066
Epoch: 33, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.408 Vali Acc: 0.922 Test Loss: 0.408 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1619582176208496
Epoch: 34, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.394 Vali Acc: 0.919 Test Loss: 0.394 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0192515850067139
Epoch: 35, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.385 Vali Acc: 0.926 Test Loss: 0.385 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.1119709014892578
Epoch: 36, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.377 Vali Acc: 0.926 Test Loss: 0.377 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.859175443649292
Epoch: 37, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1006126403808594
Epoch: 38, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 765442
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.569697141647339
Epoch: 1, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.946 Vali Acc: 0.178 Test Loss: 1.946 Test Acc: 0.178
Validation loss decreased (inf --> -0.177758).  Saving model ...
Epoch: 2 cost time: 0.9740841388702393
Epoch: 2, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.917 Vali Acc: 0.189 Test Loss: 1.917 Test Acc: 0.189
Validation loss decreased (-0.177758 --> -0.188870).  Saving model ...
Epoch: 3 cost time: 0.8564968109130859
Epoch: 3, Steps: 2 | Train Loss: 2.000 Vali Loss: 1.888 Vali Acc: 0.211 Test Loss: 1.888 Test Acc: 0.211
Validation loss decreased (-0.188870 --> -0.211092).  Saving model ...
Epoch: 4 cost time: 0.8839609622955322
Epoch: 4, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.850 Vali Acc: 0.241 Test Loss: 1.850 Test Acc: 0.241
Validation loss decreased (-0.211092 --> -0.240722).  Saving model ...
Epoch: 5 cost time: 1.2260982990264893
Epoch: 5, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.806 Vali Acc: 0.244 Test Loss: 1.806 Test Acc: 0.244
Validation loss decreased (-0.240722 --> -0.244426).  Saving model ...
Epoch: 6 cost time: 1.2188265323638916
Epoch: 6, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.762 Vali Acc: 0.233 Test Loss: 1.762 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9644796848297119
Epoch: 7, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.722 Vali Acc: 0.281 Test Loss: 1.722 Test Acc: 0.281
Validation loss decreased (-0.244426 --> -0.281464).  Saving model ...
Epoch: 8 cost time: 1.0665686130523682
Epoch: 8, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.683 Vali Acc: 0.311 Test Loss: 1.683 Test Acc: 0.311
Validation loss decreased (-0.281464 --> -0.311094).  Saving model ...
Epoch: 9 cost time: 0.7797966003417969
Epoch: 9, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.644 Vali Acc: 0.363 Test Loss: 1.644 Test Acc: 0.363
Validation loss decreased (-0.311094 --> -0.362947).  Saving model ...
Epoch: 10 cost time: 1.0027287006378174
Epoch: 10, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.602 Vali Acc: 0.500 Test Loss: 1.602 Test Acc: 0.500
Validation loss decreased (-0.362947 --> -0.499984).  Saving model ...
Epoch: 11 cost time: 0.993140459060669
Epoch: 11, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.554 Vali Acc: 0.522 Test Loss: 1.554 Test Acc: 0.522
Validation loss decreased (-0.499984 --> -0.522207).  Saving model ...
Epoch: 12 cost time: 0.7979874610900879
Epoch: 12, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.498 Vali Acc: 0.563 Test Loss: 1.498 Test Acc: 0.563
Validation loss decreased (-0.522207 --> -0.562948).  Saving model ...
Epoch: 13 cost time: 0.9913017749786377
Epoch: 13, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.436 Vali Acc: 0.604 Test Loss: 1.436 Test Acc: 0.604
Validation loss decreased (-0.562948 --> -0.603689).  Saving model ...
Epoch: 14 cost time: 0.9591526985168457
Epoch: 14, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.372 Vali Acc: 0.656 Test Loss: 1.372 Test Acc: 0.656
Validation loss decreased (-0.603689 --> -0.655542).  Saving model ...
Epoch: 15 cost time: 0.9772970676422119
Epoch: 15, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.305 Vali Acc: 0.681 Test Loss: 1.305 Test Acc: 0.681
Validation loss decreased (-0.655542 --> -0.681468).  Saving model ...
Epoch: 16 cost time: 0.8185105323791504
Epoch: 16, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.233 Vali Acc: 0.719 Test Loss: 1.233 Test Acc: 0.719
Validation loss decreased (-0.681468 --> -0.718506).  Saving model ...
Epoch: 17 cost time: 0.8113656044006348
Epoch: 17, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.158 Vali Acc: 0.767 Test Loss: 1.158 Test Acc: 0.767
Validation loss decreased (-0.718506 --> -0.766655).  Saving model ...
Epoch: 18 cost time: 0.8653852939605713
Epoch: 18, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.084 Vali Acc: 0.796 Test Loss: 1.084 Test Acc: 0.796
Validation loss decreased (-0.766655 --> -0.796285).  Saving model ...
Epoch: 19 cost time: 0.8564584255218506
Epoch: 19, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.013 Vali Acc: 0.815 Test Loss: 1.013 Test Acc: 0.815
Validation loss decreased (-0.796285 --> -0.814805).  Saving model ...
Epoch: 20 cost time: 0.929760217666626
Epoch: 20, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.945 Vali Acc: 0.859 Test Loss: 0.945 Test Acc: 0.859
Validation loss decreased (-0.814805 --> -0.859250).  Saving model ...
Epoch: 21 cost time: 0.8655543327331543
Epoch: 21, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.883 Vali Acc: 0.848 Test Loss: 0.883 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.954474687576294
Epoch: 22, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.826 Vali Acc: 0.826 Test Loss: 0.826 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.274329662322998
Epoch: 23, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.775 Vali Acc: 0.822 Test Loss: 0.775 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8188362121582031
Epoch: 24, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.726 Vali Acc: 0.826 Test Loss: 0.726 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9361569881439209
Epoch: 25, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.681 Vali Acc: 0.852 Test Loss: 0.681 Test Acc: 0.852
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8347175121307373
Epoch: 26, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.640 Vali Acc: 0.859 Test Loss: 0.640 Test Acc: 0.859
Validation loss decreased (-0.859250 --> -0.859253).  Saving model ...
Epoch: 27 cost time: 1.0547630786895752
Epoch: 27, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.607 Vali Acc: 0.863 Test Loss: 0.607 Test Acc: 0.863
Validation loss decreased (-0.859253 --> -0.862957).  Saving model ...
Epoch: 28 cost time: 0.9972903728485107
Epoch: 28, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.570 Vali Acc: 0.885 Test Loss: 0.570 Test Acc: 0.885
Validation loss decreased (-0.862957 --> -0.885179).  Saving model ...
Epoch: 29 cost time: 0.87679123878479
Epoch: 29, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.529 Vali Acc: 0.919 Test Loss: 0.529 Test Acc: 0.919
Validation loss decreased (-0.885179 --> -0.918513).  Saving model ...
Epoch: 30 cost time: 0.9681038856506348
Epoch: 30, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.496 Vali Acc: 0.937 Test Loss: 0.496 Test Acc: 0.937
Validation loss decreased (-0.918513 --> -0.937032).  Saving model ...
Epoch: 31 cost time: 1.1264803409576416
Epoch: 31, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.467 Vali Acc: 0.937 Test Loss: 0.467 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 32 cost time: 0.7771024703979492
Epoch: 32, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.445 Vali Acc: 0.930 Test Loss: 0.445 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.113506555557251
Epoch: 33, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.431 Vali Acc: 0.926 Test Loss: 0.431 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7818465232849121
Epoch: 34, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.410 Vali Acc: 0.933 Test Loss: 0.410 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9168694019317627
Epoch: 35, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.389 Vali Acc: 0.937 Test Loss: 0.389 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 36 cost time: 1.0307135581970215
Epoch: 36, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.374 Vali Acc: 0.941 Test Loss: 0.374 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 37 cost time: 0.9424533843994141
Epoch: 37, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.361 Vali Acc: 0.933 Test Loss: 0.361 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9974446296691895
Epoch: 38, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.347 Vali Acc: 0.937 Test Loss: 0.347 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8191158771514893
Epoch: 39, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 40 cost time: 0.9389147758483887
Epoch: 40, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.331 Vali Acc: 0.933 Test Loss: 0.331 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.0199065208435059
Epoch: 41, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.0950100421905518
Epoch: 42, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.309 Vali Acc: 0.937 Test Loss: 0.309 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8939604759216309
Epoch: 43, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0103654861450195
Epoch: 44, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.1243178844451904
Epoch: 45, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.2208774089813232
Epoch: 46, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.9112226963043213
Epoch: 47, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 1.0233607292175293
Epoch: 48, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.276 Vali Acc: 0.926 Test Loss: 0.276 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9186811447143555
Epoch: 49, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9773886203765869
Epoch: 50, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8778367042541504
Epoch: 51, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.269 Vali Acc: 0.926 Test Loss: 0.269 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0778391361236572
Epoch: 52, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.260 Vali Acc: 0.926 Test Loss: 0.260 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.8249876499176025
Epoch: 53, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 1.0751376152038574
Epoch: 54, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.843346118927002
Epoch: 55, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8437283039093018
Epoch: 56, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9485232830047607
Epoch: 57, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.2729716300964355
Epoch: 58, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8591411113739014
Epoch: 59, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.8763458728790283
Epoch: 60, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.9721252918243408
Epoch: 61, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.0152969360351562
Epoch: 62, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.0147037506103516
Epoch: 63, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 64 cost time: 1.07132887840271
Epoch: 64, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.0285544395446777
Epoch: 65, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.0892345905303955
Epoch: 66, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.1890463829040527
Epoch: 67, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.1159896850585938
Epoch: 68, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.258 Vali Acc: 0.926 Test Loss: 0.258 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.0037448406219482
Epoch: 69, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.1839385032653809
Epoch: 70, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.259230613708496
Epoch: 71, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.112597942352295
Epoch: 72, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.9102401733398438
Epoch: 73, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 764674
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.825268268585205
Epoch: 1, Steps: 2 | Train Loss: 1.977 Vali Loss: 1.952 Vali Acc: 0.207 Test Loss: 1.952 Test Acc: 0.207
Validation loss decreased (inf --> -0.207388).  Saving model ...
Epoch: 2 cost time: 1.0199525356292725
Epoch: 2, Steps: 2 | Train Loss: 1.949 Vali Loss: 1.904 Vali Acc: 0.215 Test Loss: 1.904 Test Acc: 0.215
Validation loss decreased (-0.207388 --> -0.214796).  Saving model ...
Epoch: 3 cost time: 1.1865324974060059
Epoch: 3, Steps: 2 | Train Loss: 1.894 Vali Loss: 1.853 Vali Acc: 0.230 Test Loss: 1.853 Test Acc: 0.230
Validation loss decreased (-0.214796 --> -0.229611).  Saving model ...
Epoch: 4 cost time: 0.9994494915008545
Epoch: 4, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.785 Vali Acc: 0.296 Test Loss: 1.785 Test Acc: 0.296
Validation loss decreased (-0.229611 --> -0.296278).  Saving model ...
Epoch: 5 cost time: 0.8154685497283936
Epoch: 5, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.715 Vali Acc: 0.352 Test Loss: 1.715 Test Acc: 0.352
Validation loss decreased (-0.296278 --> -0.351835).  Saving model ...
Epoch: 6 cost time: 0.9695107936859131
Epoch: 6, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.651 Vali Acc: 0.444 Test Loss: 1.651 Test Acc: 0.444
Validation loss decreased (-0.351835 --> -0.444428).  Saving model ...
Epoch: 7 cost time: 0.9149422645568848
Epoch: 7, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.600 Vali Acc: 0.441 Test Loss: 1.600 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9141325950622559
Epoch: 8, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.558 Vali Acc: 0.474 Test Loss: 1.558 Test Acc: 0.474
Validation loss decreased (-0.444428 --> -0.474058).  Saving model ...
Epoch: 9 cost time: 0.8548941612243652
Epoch: 9, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.523 Vali Acc: 0.604 Test Loss: 1.523 Test Acc: 0.604
Validation loss decreased (-0.474058 --> -0.603688).  Saving model ...
Epoch: 10 cost time: 1.0602607727050781
Epoch: 10, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.486 Vali Acc: 0.611 Test Loss: 1.486 Test Acc: 0.611
Validation loss decreased (-0.603688 --> -0.611096).  Saving model ...
Epoch: 11 cost time: 1.1341521739959717
Epoch: 11, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.447 Vali Acc: 0.600 Test Loss: 1.447 Test Acc: 0.600
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9905967712402344
Epoch: 12, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.397 Vali Acc: 0.619 Test Loss: 1.397 Test Acc: 0.619
Validation loss decreased (-0.611096 --> -0.618505).  Saving model ...
Epoch: 13 cost time: 0.9004740715026855
Epoch: 13, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.332 Vali Acc: 0.644 Test Loss: 1.332 Test Acc: 0.644
Validation loss decreased (-0.618505 --> -0.644431).  Saving model ...
Epoch: 14 cost time: 1.3191993236541748
Epoch: 14, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.263 Vali Acc: 0.726 Test Loss: 1.263 Test Acc: 0.726
Validation loss decreased (-0.644431 --> -0.725913).  Saving model ...
Epoch: 15 cost time: 0.9526481628417969
Epoch: 15, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.196 Vali Acc: 0.826 Test Loss: 1.196 Test Acc: 0.826
Validation loss decreased (-0.725913 --> -0.825914).  Saving model ...
Epoch: 16 cost time: 1.517317771911621
Epoch: 16, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.133 Vali Acc: 0.856 Test Loss: 1.133 Test Acc: 0.856
Validation loss decreased (-0.825914 --> -0.855544).  Saving model ...
Epoch: 17 cost time: 1.2107329368591309
Epoch: 17, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.069 Vali Acc: 0.863 Test Loss: 1.069 Test Acc: 0.863
Validation loss decreased (-0.855544 --> -0.862952).  Saving model ...
Epoch: 18 cost time: 1.2700066566467285
Epoch: 18, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.000 Vali Acc: 0.870 Test Loss: 1.000 Test Acc: 0.870
Validation loss decreased (-0.862952 --> -0.870360).  Saving model ...
Epoch: 19 cost time: 1.2059731483459473
Epoch: 19, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.931 Vali Acc: 0.863 Test Loss: 0.931 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0195024013519287
Epoch: 20, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.871 Vali Acc: 0.837 Test Loss: 0.871 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.56913161277771
Epoch: 21, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.815 Vali Acc: 0.844 Test Loss: 0.815 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2651050090789795
Epoch: 22, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.760 Vali Acc: 0.867 Test Loss: 0.760 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0392868518829346
Epoch: 23, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.710 Vali Acc: 0.889 Test Loss: 0.710 Test Acc: 0.889
Validation loss decreased (-0.870360 --> -0.888882).  Saving model ...
Epoch: 24 cost time: 1.3189866542816162
Epoch: 24, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.665 Vali Acc: 0.907 Test Loss: 0.665 Test Acc: 0.907
Validation loss decreased (-0.888882 --> -0.907401).  Saving model ...
Epoch: 25 cost time: 0.9619319438934326
Epoch: 25, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.625 Vali Acc: 0.911 Test Loss: 0.625 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 26 cost time: 1.1483087539672852
Epoch: 26, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.586 Vali Acc: 0.911 Test Loss: 0.586 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 27 cost time: 1.0925929546356201
Epoch: 27, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.551 Vali Acc: 0.911 Test Loss: 0.551 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 28 cost time: 1.291839361190796
Epoch: 28, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.525 Vali Acc: 0.915 Test Loss: 0.525 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 29 cost time: 1.0643129348754883
Epoch: 29, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.502 Vali Acc: 0.904 Test Loss: 0.502 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0231947898864746
Epoch: 30, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.483 Vali Acc: 0.896 Test Loss: 0.483 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.4398481845855713
Epoch: 31, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.462 Vali Acc: 0.907 Test Loss: 0.462 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1380817890167236
Epoch: 32, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.440 Vali Acc: 0.911 Test Loss: 0.440 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.2354223728179932
Epoch: 33, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.422 Vali Acc: 0.922 Test Loss: 0.422 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 34 cost time: 1.276350975036621
Epoch: 34, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.406 Vali Acc: 0.922 Test Loss: 0.406 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 35 cost time: 1.0699546337127686
Epoch: 35, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.393 Vali Acc: 0.919 Test Loss: 0.393 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.289459466934204
Epoch: 36, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.383 Vali Acc: 0.915 Test Loss: 0.383 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1674003601074219
Epoch: 37, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.370 Vali Acc: 0.915 Test Loss: 0.370 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0768921375274658
Epoch: 38, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.358 Vali Acc: 0.919 Test Loss: 0.358 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.681581735610962
Epoch: 39, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.347 Vali Acc: 0.922 Test Loss: 0.347 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 40 cost time: 1.1233634948730469
Epoch: 40, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.333 Vali Acc: 0.930 Test Loss: 0.333 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929626).  Saving model ...
Epoch: 41 cost time: 0.9203376770019531
Epoch: 41, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.322 Vali Acc: 0.930 Test Loss: 0.322 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 42 cost time: 0.8746938705444336
Epoch: 42, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 43 cost time: 0.8502755165100098
Epoch: 43, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 44 cost time: 1.0884480476379395
Epoch: 44, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.297 Vali Acc: 0.937 Test Loss: 0.297 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 45 cost time: 1.2962887287139893
Epoch: 45, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 46 cost time: 1.2351033687591553
Epoch: 46, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.289 Vali Acc: 0.944 Test Loss: 0.289 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 1.1101553440093994
Epoch: 47, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.284 Vali Acc: 0.941 Test Loss: 0.284 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.1058096885681152
Epoch: 48, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.9008491039276123
Epoch: 49, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9724292755126953
Epoch: 50, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.477060317993164
Epoch: 51, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.012131929397583
Epoch: 52, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.2278954982757568
Epoch: 53, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.0035977363586426
Epoch: 54, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.058720350265503
Epoch: 55, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.1404695510864258
Epoch: 56, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 763906
model size : 4.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.3306617736816406
Epoch: 1, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.877 Vali Acc: 0.163 Test Loss: 1.877 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.9835624694824219
Epoch: 2, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.860 Vali Acc: 0.163 Test Loss: 1.860 Test Acc: 0.163
Validation loss decreased (-0.162944 --> -0.162944).  Saving model ...
Epoch: 3 cost time: 1.201709508895874
Epoch: 3, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.836 Vali Acc: 0.156 Test Loss: 1.836 Test Acc: 0.156
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8835325241088867
Epoch: 4, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.797 Vali Acc: 0.159 Test Loss: 1.797 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9898421764373779
Epoch: 5, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.755 Vali Acc: 0.185 Test Loss: 1.755 Test Acc: 0.185
Validation loss decreased (-0.162944 --> -0.185168).  Saving model ...
Epoch: 6 cost time: 1.0346660614013672
Epoch: 6, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.714 Vali Acc: 0.226 Test Loss: 1.714 Test Acc: 0.226
Validation loss decreased (-0.185168 --> -0.225909).  Saving model ...
Epoch: 7 cost time: 0.980994462966919
Epoch: 7, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.674 Vali Acc: 0.244 Test Loss: 1.674 Test Acc: 0.244
Validation loss decreased (-0.225909 --> -0.244428).  Saving model ...
Epoch: 8 cost time: 1.021623134613037
Epoch: 8, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.633 Vali Acc: 0.337 Test Loss: 1.633 Test Acc: 0.337
Validation loss decreased (-0.244428 --> -0.337021).  Saving model ...
Epoch: 9 cost time: 1.2815287113189697
Epoch: 9, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.592 Vali Acc: 0.448 Test Loss: 1.592 Test Acc: 0.448
Validation loss decreased (-0.337021 --> -0.448132).  Saving model ...
Epoch: 10 cost time: 0.8213436603546143
Epoch: 10, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.545 Vali Acc: 0.522 Test Loss: 1.545 Test Acc: 0.522
Validation loss decreased (-0.448132 --> -0.522207).  Saving model ...
Epoch: 11 cost time: 0.9976894855499268
Epoch: 11, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.492 Vali Acc: 0.578 Test Loss: 1.492 Test Acc: 0.578
Validation loss decreased (-0.522207 --> -0.577763).  Saving model ...
Epoch: 12 cost time: 1.0889482498168945
Epoch: 12, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.431 Vali Acc: 0.615 Test Loss: 1.431 Test Acc: 0.615
Validation loss decreased (-0.577763 --> -0.614801).  Saving model ...
Epoch: 13 cost time: 1.2058937549591064
Epoch: 13, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.369 Vali Acc: 0.652 Test Loss: 1.369 Test Acc: 0.652
Validation loss decreased (-0.614801 --> -0.651838).  Saving model ...
Epoch: 14 cost time: 0.8146843910217285
Epoch: 14, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.307 Vali Acc: 0.681 Test Loss: 1.307 Test Acc: 0.681
Validation loss decreased (-0.651838 --> -0.681468).  Saving model ...
Epoch: 15 cost time: 1.0059893131256104
Epoch: 15, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.244 Vali Acc: 0.707 Test Loss: 1.244 Test Acc: 0.707
Validation loss decreased (-0.681468 --> -0.707395).  Saving model ...
Epoch: 16 cost time: 1.0592238903045654
Epoch: 16, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.181 Vali Acc: 0.711 Test Loss: 1.181 Test Acc: 0.711
Validation loss decreased (-0.707395 --> -0.711099).  Saving model ...
Epoch: 17 cost time: 1.026043176651001
Epoch: 17, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.121 Vali Acc: 0.707 Test Loss: 1.121 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.867563009262085
Epoch: 18, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.062 Vali Acc: 0.737 Test Loss: 1.062 Test Acc: 0.737
Validation loss decreased (-0.711099 --> -0.737026).  Saving model ...
Epoch: 19 cost time: 0.8316326141357422
Epoch: 19, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.008 Vali Acc: 0.767 Test Loss: 1.008 Test Acc: 0.767
Validation loss decreased (-0.737026 --> -0.766657).  Saving model ...
Epoch: 20 cost time: 0.9930737018585205
Epoch: 20, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.963 Vali Acc: 0.770 Test Loss: 0.963 Test Acc: 0.770
Validation loss decreased (-0.766657 --> -0.770361).  Saving model ...
Epoch: 21 cost time: 0.8759148120880127
Epoch: 21, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.918 Vali Acc: 0.785 Test Loss: 0.918 Test Acc: 0.785
Validation loss decreased (-0.770361 --> -0.785176).  Saving model ...
Epoch: 22 cost time: 0.8703727722167969
Epoch: 22, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.876 Vali Acc: 0.789 Test Loss: 0.876 Test Acc: 0.789
Validation loss decreased (-0.785176 --> -0.788880).  Saving model ...
Epoch: 23 cost time: 0.9075212478637695
Epoch: 23, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.840 Vali Acc: 0.796 Test Loss: 0.840 Test Acc: 0.796
Validation loss decreased (-0.788880 --> -0.796288).  Saving model ...
Epoch: 24 cost time: 0.9438824653625488
Epoch: 24, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.806 Vali Acc: 0.811 Test Loss: 0.806 Test Acc: 0.811
Validation loss decreased (-0.796288 --> -0.811103).  Saving model ...
Epoch: 25 cost time: 1.0310869216918945
Epoch: 25, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.777 Vali Acc: 0.811 Test Loss: 0.777 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 26 cost time: 1.000572919845581
Epoch: 26, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.748 Vali Acc: 0.819 Test Loss: 0.748 Test Acc: 0.819
Validation loss decreased (-0.811103 --> -0.818511).  Saving model ...
Epoch: 27 cost time: 1.0349185466766357
Epoch: 27, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.722 Vali Acc: 0.826 Test Loss: 0.722 Test Acc: 0.826
Validation loss decreased (-0.818511 --> -0.825919).  Saving model ...
Epoch: 28 cost time: 0.9132344722747803
Epoch: 28, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.695 Vali Acc: 0.837 Test Loss: 0.695 Test Acc: 0.837
Validation loss decreased (-0.825919 --> -0.837030).  Saving model ...
Epoch: 29 cost time: 1.0949182510375977
Epoch: 29, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.678 Vali Acc: 0.841 Test Loss: 0.678 Test Acc: 0.841
Validation loss decreased (-0.837030 --> -0.840734).  Saving model ...
Epoch: 30 cost time: 1.2476985454559326
Epoch: 30, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.657 Vali Acc: 0.852 Test Loss: 0.657 Test Acc: 0.852
Validation loss decreased (-0.840734 --> -0.851845).  Saving model ...
Epoch: 31 cost time: 1.1517181396484375
Epoch: 31, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.636 Vali Acc: 0.856 Test Loss: 0.636 Test Acc: 0.856
Validation loss decreased (-0.851845 --> -0.855549).  Saving model ...
Epoch: 32 cost time: 0.9239981174468994
Epoch: 32, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.618 Vali Acc: 0.863 Test Loss: 0.618 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862957).  Saving model ...
Epoch: 33 cost time: 0.8934755325317383
Epoch: 33, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.603 Vali Acc: 0.874 Test Loss: 0.603 Test Acc: 0.874
Validation loss decreased (-0.862957 --> -0.874068).  Saving model ...
Epoch: 34 cost time: 0.912905216217041
Epoch: 34, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0679845809936523
Epoch: 35, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9380772113800049
Epoch: 36, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.565 Vali Acc: 0.870 Test Loss: 0.565 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.056875467300415
Epoch: 37, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.550 Vali Acc: 0.870 Test Loss: 0.550 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8934929370880127
Epoch: 38, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.537 Vali Acc: 0.874 Test Loss: 0.537 Test Acc: 0.874
Validation loss decreased (-0.874068 --> -0.874069).  Saving model ...
Epoch: 39 cost time: 1.1073322296142578
Epoch: 39, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.526 Vali Acc: 0.881 Test Loss: 0.526 Test Acc: 0.881
Validation loss decreased (-0.874069 --> -0.881476).  Saving model ...
Epoch: 40 cost time: 0.9580273628234863
Epoch: 40, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.513 Vali Acc: 0.878 Test Loss: 0.513 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8459126949310303
Epoch: 41, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.502 Vali Acc: 0.878 Test Loss: 0.502 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.886843204498291
Epoch: 42, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9530880451202393
Epoch: 43, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.487 Vali Acc: 0.878 Test Loss: 0.487 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.0695133209228516
Epoch: 44, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.478 Vali Acc: 0.878 Test Loss: 0.478 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0431458950042725
Epoch: 45, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.467 Vali Acc: 0.878 Test Loss: 0.467 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0371148586273193
Epoch: 46, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.455 Vali Acc: 0.885 Test Loss: 0.455 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885181).  Saving model ...
Epoch: 47 cost time: 0.8961117267608643
Epoch: 47, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.449 Vali Acc: 0.885 Test Loss: 0.449 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 48 cost time: 1.722283124923706
Epoch: 48, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.443 Vali Acc: 0.885 Test Loss: 0.443 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 49 cost time: 1.112776517868042
Epoch: 49, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.434 Vali Acc: 0.893 Test Loss: 0.434 Test Acc: 0.893
Validation loss decreased (-0.885181 --> -0.892588).  Saving model ...
Epoch: 50 cost time: 0.9439177513122559
Epoch: 50, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.437 Vali Acc: 0.881 Test Loss: 0.437 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9275121688842773
Epoch: 51, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.433 Vali Acc: 0.881 Test Loss: 0.433 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9590883255004883
Epoch: 52, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.417 Vali Acc: 0.896 Test Loss: 0.417 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 53 cost time: 0.8511555194854736
Epoch: 53, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.406 Vali Acc: 0.904 Test Loss: 0.406 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903700).  Saving model ...
Epoch: 54 cost time: 0.9638454914093018
Epoch: 54, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.407 Vali Acc: 0.904 Test Loss: 0.407 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.9011104106903076
Epoch: 55, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8416321277618408
Epoch: 56, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.411 Vali Acc: 0.893 Test Loss: 0.411 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.0737133026123047
Epoch: 57, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.419 Vali Acc: 0.893 Test Loss: 0.419 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.8906595706939697
Epoch: 58, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.420 Vali Acc: 0.889 Test Loss: 0.420 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.802109956741333
Epoch: 59, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.411 Vali Acc: 0.896 Test Loss: 0.411 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.9289495944976807
Epoch: 60, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.394 Vali Acc: 0.896 Test Loss: 0.394 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.9559080600738525
Epoch: 61, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.385 Vali Acc: 0.893 Test Loss: 0.385 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.9479861259460449
Epoch: 62, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.380 Vali Acc: 0.893 Test Loss: 0.380 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.802757740020752
Epoch: 63, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.386 Vali Acc: 0.896 Test Loss: 0.386 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 760418
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1068646907806396
Epoch: 1, Steps: 2 | Train Loss: 2.069 Vali Loss: 1.948 Vali Acc: 0.174 Test Loss: 1.948 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 1.1202342510223389
Epoch: 2, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.923 Vali Acc: 0.189 Test Loss: 1.923 Test Acc: 0.189
Validation loss decreased (-0.174055 --> -0.188870).  Saving model ...
Epoch: 3 cost time: 1.238856315612793
Epoch: 3, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.893 Vali Acc: 0.207 Test Loss: 1.893 Test Acc: 0.207
Validation loss decreased (-0.188870 --> -0.207388).  Saving model ...
Epoch: 4 cost time: 1.209251880645752
Epoch: 4, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.847 Vali Acc: 0.270 Test Loss: 1.847 Test Acc: 0.270
Validation loss decreased (-0.207388 --> -0.270352).  Saving model ...
Epoch: 5 cost time: 1.045717716217041
Epoch: 5, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.799 Vali Acc: 0.304 Test Loss: 1.799 Test Acc: 0.304
Validation loss decreased (-0.270352 --> -0.303686).  Saving model ...
Epoch: 6 cost time: 0.8815310001373291
Epoch: 6, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.757 Vali Acc: 0.300 Test Loss: 1.757 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.929152250289917
Epoch: 7, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.723 Vali Acc: 0.341 Test Loss: 1.723 Test Acc: 0.341
Validation loss decreased (-0.303686 --> -0.340724).  Saving model ...
Epoch: 8 cost time: 0.7742655277252197
Epoch: 8, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.695 Vali Acc: 0.367 Test Loss: 1.695 Test Acc: 0.367
Validation loss decreased (-0.340724 --> -0.366650).  Saving model ...
Epoch: 9 cost time: 0.9225122928619385
Epoch: 9, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.669 Vali Acc: 0.359 Test Loss: 1.669 Test Acc: 0.359
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9485337734222412
Epoch: 10, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.631 Vali Acc: 0.341 Test Loss: 1.631 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1199157238006592
Epoch: 11, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.583 Vali Acc: 0.478 Test Loss: 1.583 Test Acc: 0.478
Validation loss decreased (-0.366650 --> -0.477762).  Saving model ...
Epoch: 12 cost time: 1.1285665035247803
Epoch: 12, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.529 Vali Acc: 0.511 Test Loss: 1.529 Test Acc: 0.511
Validation loss decreased (-0.477762 --> -0.511096).  Saving model ...
Epoch: 13 cost time: 1.068234920501709
Epoch: 13, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.471 Vali Acc: 0.559 Test Loss: 1.471 Test Acc: 0.559
Validation loss decreased (-0.511096 --> -0.559245).  Saving model ...
Epoch: 14 cost time: 1.1068944931030273
Epoch: 14, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.411 Vali Acc: 0.604 Test Loss: 1.411 Test Acc: 0.604
Validation loss decreased (-0.559245 --> -0.603690).  Saving model ...
Epoch: 15 cost time: 0.980097770690918
Epoch: 15, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.350 Vali Acc: 0.619 Test Loss: 1.350 Test Acc: 0.619
Validation loss decreased (-0.603690 --> -0.618505).  Saving model ...
Epoch: 16 cost time: 0.9712884426116943
Epoch: 16, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.284 Vali Acc: 0.648 Test Loss: 1.284 Test Acc: 0.648
Validation loss decreased (-0.618505 --> -0.648135).  Saving model ...
Epoch: 17 cost time: 0.978020191192627
Epoch: 17, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.214 Vali Acc: 0.681 Test Loss: 1.214 Test Acc: 0.681
Validation loss decreased (-0.648135 --> -0.681469).  Saving model ...
Epoch: 18 cost time: 1.1341733932495117
Epoch: 18, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.143 Vali Acc: 0.711 Test Loss: 1.143 Test Acc: 0.711
Validation loss decreased (-0.681469 --> -0.711100).  Saving model ...
Epoch: 19 cost time: 0.9097425937652588
Epoch: 19, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.075 Vali Acc: 0.719 Test Loss: 1.075 Test Acc: 0.719
Validation loss decreased (-0.711100 --> -0.718508).  Saving model ...
Epoch: 20 cost time: 0.8438825607299805
Epoch: 20, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.012 Vali Acc: 0.733 Test Loss: 1.012 Test Acc: 0.733
Validation loss decreased (-0.718508 --> -0.733323).  Saving model ...
Epoch: 21 cost time: 0.8873372077941895
Epoch: 21, Steps: 2 | Train Loss: 0.928 Vali Loss: 0.952 Vali Acc: 0.767 Test Loss: 0.952 Test Acc: 0.767
Validation loss decreased (-0.733323 --> -0.766657).  Saving model ...
Epoch: 22 cost time: 0.8907053470611572
Epoch: 22, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.898 Vali Acc: 0.807 Test Loss: 0.898 Test Acc: 0.807
Validation loss decreased (-0.766657 --> -0.807398).  Saving model ...
Epoch: 23 cost time: 1.4337949752807617
Epoch: 23, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.851 Vali Acc: 0.796 Test Loss: 0.851 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9913327693939209
Epoch: 24, Steps: 2 | Train Loss: 0.742 Vali Loss: 0.813 Vali Acc: 0.785 Test Loss: 0.813 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0828351974487305
Epoch: 25, Steps: 2 | Train Loss: 0.726 Vali Loss: 0.778 Vali Acc: 0.793 Test Loss: 0.778 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9313769340515137
Epoch: 26, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.744 Vali Acc: 0.807 Test Loss: 0.744 Test Acc: 0.807
Validation loss decreased (-0.807398 --> -0.807400).  Saving model ...
Epoch: 27 cost time: 1.1551856994628906
Epoch: 27, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.709 Vali Acc: 0.833 Test Loss: 0.709 Test Acc: 0.833
Validation loss decreased (-0.807400 --> -0.833326).  Saving model ...
Epoch: 28 cost time: 0.9778990745544434
Epoch: 28, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.679 Vali Acc: 0.863 Test Loss: 0.679 Test Acc: 0.863
Validation loss decreased (-0.833326 --> -0.862956).  Saving model ...
Epoch: 29 cost time: 1.0093467235565186
Epoch: 29, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.655 Vali Acc: 0.896 Test Loss: 0.655 Test Acc: 0.896
Validation loss decreased (-0.862956 --> -0.896290).  Saving model ...
Epoch: 30 cost time: 0.9981818199157715
Epoch: 30, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.633 Vali Acc: 0.907 Test Loss: 0.633 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907401).  Saving model ...
Epoch: 31 cost time: 0.9212231636047363
Epoch: 31, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.608 Vali Acc: 0.904 Test Loss: 0.608 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0652008056640625
Epoch: 32, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.585 Vali Acc: 0.893 Test Loss: 0.585 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9837491512298584
Epoch: 33, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.561 Vali Acc: 0.907 Test Loss: 0.561 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 34 cost time: 0.8965799808502197
Epoch: 34, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.537 Vali Acc: 0.915 Test Loss: 0.537 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914809).  Saving model ...
Epoch: 35 cost time: 0.8984754085540771
Epoch: 35, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.512 Vali Acc: 0.930 Test Loss: 0.512 Test Acc: 0.930
Validation loss decreased (-0.914809 --> -0.929625).  Saving model ...
Epoch: 36 cost time: 1.0207839012145996
Epoch: 36, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.492 Vali Acc: 0.926 Test Loss: 0.492 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0849547386169434
Epoch: 37, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.478 Vali Acc: 0.933 Test Loss: 0.478 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 38 cost time: 1.0624032020568848
Epoch: 38, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.470 Vali Acc: 0.922 Test Loss: 0.470 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9857563972473145
Epoch: 39, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.453 Vali Acc: 0.926 Test Loss: 0.453 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.0889005661010742
Epoch: 40, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.439 Vali Acc: 0.919 Test Loss: 0.439 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.2600829601287842
Epoch: 41, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.432 Vali Acc: 0.915 Test Loss: 0.432 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.1471076011657715
Epoch: 42, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.409 Vali Acc: 0.926 Test Loss: 0.409 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9967770576477051
Epoch: 43, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.386 Vali Acc: 0.933 Test Loss: 0.386 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 44 cost time: 1.084855318069458
Epoch: 44, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.371 Vali Acc: 0.926 Test Loss: 0.371 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8415896892547607
Epoch: 45, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.364 Vali Acc: 0.930 Test Loss: 0.364 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.0054800510406494
Epoch: 46, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.359 Vali Acc: 0.926 Test Loss: 0.359 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 1.1826114654541016
Epoch: 47, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.357 Vali Acc: 0.926 Test Loss: 0.357 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.6000957489013672
Epoch: 48, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.353 Vali Acc: 0.930 Test Loss: 0.353 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.8546161651611328
Epoch: 49, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.345 Vali Acc: 0.933 Test Loss: 0.345 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 50 cost time: 1.0875051021575928
Epoch: 50, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.332 Vali Acc: 0.941 Test Loss: 0.332 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940737).  Saving model ...
Epoch: 51 cost time: 1.2079341411590576
Epoch: 51, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.321 Vali Acc: 0.937 Test Loss: 0.321 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.2229351997375488
Epoch: 52, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.306 Vali Acc: 0.933 Test Loss: 0.306 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.2203235626220703
Epoch: 53, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.296 Vali Acc: 0.933 Test Loss: 0.296 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.9740755558013916
Epoch: 54, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.295 Vali Acc: 0.933 Test Loss: 0.295 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.0679922103881836
Epoch: 55, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.9688739776611328
Epoch: 56, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.0869734287261963
Epoch: 57, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.301 Vali Acc: 0.926 Test Loss: 0.301 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.1892433166503906
Epoch: 58, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.291 Vali Acc: 0.926 Test Loss: 0.291 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.17600417137146
Epoch: 59, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.278 Vali Acc: 0.937 Test Loss: 0.278 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.1831755638122559
Epoch: 60, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 0.8372960090637207
Epoch: 61, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.111400842666626
Epoch: 62, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9291079044342041
Epoch: 63, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.9472990036010742
Epoch: 64, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.2221274375915527
Epoch: 65, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.2786571979522705
Epoch: 66, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 1.313840627670288
Epoch: 67, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.9685578346252441
Epoch: 68, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 1.0549180507659912
Epoch: 69, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 1.1066982746124268
Epoch: 70, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 760034
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.03967022895813
Epoch: 1, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.963 Vali Acc: 0.081 Test Loss: 1.963 Test Acc: 0.081
Validation loss decreased (inf --> -0.081462).  Saving model ...
Epoch: 2 cost time: 0.9118173122406006
Epoch: 2, Steps: 2 | Train Loss: 1.987 Vali Loss: 1.944 Vali Acc: 0.081 Test Loss: 1.944 Test Acc: 0.081
Validation loss decreased (-0.081462 --> -0.081462).  Saving model ...
Epoch: 3 cost time: 0.8020420074462891
Epoch: 3, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.918 Vali Acc: 0.081 Test Loss: 1.918 Test Acc: 0.081
Validation loss decreased (-0.081462 --> -0.081462).  Saving model ...
Epoch: 4 cost time: 1.0657691955566406
Epoch: 4, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.876 Vali Acc: 0.100 Test Loss: 1.876 Test Acc: 0.100
Validation loss decreased (-0.081462 --> -0.099981).  Saving model ...
Epoch: 5 cost time: 0.908698558807373
Epoch: 5, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.827 Vali Acc: 0.133 Test Loss: 1.827 Test Acc: 0.133
Validation loss decreased (-0.099981 --> -0.133315).  Saving model ...
Epoch: 6 cost time: 1.023991346359253
Epoch: 6, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.774 Vali Acc: 0.170 Test Loss: 1.774 Test Acc: 0.170
Validation loss decreased (-0.133315 --> -0.170353).  Saving model ...
Epoch: 7 cost time: 1.1326544284820557
Epoch: 7, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.720 Vali Acc: 0.230 Test Loss: 1.720 Test Acc: 0.230
Validation loss decreased (-0.170353 --> -0.229612).  Saving model ...
Epoch: 8 cost time: 1.3908531665802002
Epoch: 8, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.666 Vali Acc: 0.285 Test Loss: 1.666 Test Acc: 0.285
Validation loss decreased (-0.229612 --> -0.285169).  Saving model ...
Epoch: 9 cost time: 1.122007131576538
Epoch: 9, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.607 Vali Acc: 0.374 Test Loss: 1.607 Test Acc: 0.374
Validation loss decreased (-0.285169 --> -0.374058).  Saving model ...
Epoch: 10 cost time: 0.9476299285888672
Epoch: 10, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.542 Vali Acc: 0.474 Test Loss: 1.542 Test Acc: 0.474
Validation loss decreased (-0.374058 --> -0.474059).  Saving model ...
Epoch: 11 cost time: 0.9730064868927002
Epoch: 11, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.470 Vali Acc: 0.593 Test Loss: 1.470 Test Acc: 0.593
Validation loss decreased (-0.474059 --> -0.592578).  Saving model ...
Epoch: 12 cost time: 1.2057397365570068
Epoch: 12, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.396 Vali Acc: 0.681 Test Loss: 1.396 Test Acc: 0.681
Validation loss decreased (-0.592578 --> -0.681468).  Saving model ...
Epoch: 13 cost time: 1.0641109943389893
Epoch: 13, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.323 Vali Acc: 0.711 Test Loss: 1.323 Test Acc: 0.711
Validation loss decreased (-0.681468 --> -0.711098).  Saving model ...
Epoch: 14 cost time: 1.260066270828247
Epoch: 14, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.256 Vali Acc: 0.704 Test Loss: 1.256 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0961387157440186
Epoch: 15, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.188 Vali Acc: 0.726 Test Loss: 1.188 Test Acc: 0.726
Validation loss decreased (-0.711098 --> -0.725914).  Saving model ...
Epoch: 16 cost time: 1.1287798881530762
Epoch: 16, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.124 Vali Acc: 0.744 Test Loss: 1.124 Test Acc: 0.744
Validation loss decreased (-0.725914 --> -0.744433).  Saving model ...
Epoch: 17 cost time: 1.1343677043914795
Epoch: 17, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.064 Vali Acc: 0.759 Test Loss: 1.064 Test Acc: 0.759
Validation loss decreased (-0.744433 --> -0.759249).  Saving model ...
Epoch: 18 cost time: 1.2119555473327637
Epoch: 18, Steps: 2 | Train Loss: 0.902 Vali Loss: 1.008 Vali Acc: 0.793 Test Loss: 1.008 Test Acc: 0.793
Validation loss decreased (-0.759249 --> -0.792583).  Saving model ...
Epoch: 19 cost time: 0.941572904586792
Epoch: 19, Steps: 2 | Train Loss: 0.863 Vali Loss: 0.958 Vali Acc: 0.811 Test Loss: 0.958 Test Acc: 0.811
Validation loss decreased (-0.792583 --> -0.811102).  Saving model ...
Epoch: 20 cost time: 0.978961706161499
Epoch: 20, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.912 Vali Acc: 0.822 Test Loss: 0.912 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822213).  Saving model ...
Epoch: 21 cost time: 0.9696402549743652
Epoch: 21, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.868 Vali Acc: 0.833 Test Loss: 0.868 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833325).  Saving model ...
Epoch: 22 cost time: 0.9165821075439453
Epoch: 22, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.827 Vali Acc: 0.844 Test Loss: 0.827 Test Acc: 0.844
Validation loss decreased (-0.833325 --> -0.844436).  Saving model ...
Epoch: 23 cost time: 1.0951881408691406
Epoch: 23, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.787 Vali Acc: 0.859 Test Loss: 0.787 Test Acc: 0.859
Validation loss decreased (-0.844436 --> -0.859251).  Saving model ...
Epoch: 24 cost time: 1.0209476947784424
Epoch: 24, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.752 Vali Acc: 0.841 Test Loss: 0.752 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9472620487213135
Epoch: 25, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.719 Vali Acc: 0.852 Test Loss: 0.719 Test Acc: 0.852
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9927592277526855
Epoch: 26, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.689 Vali Acc: 0.867 Test Loss: 0.689 Test Acc: 0.867
Validation loss decreased (-0.859251 --> -0.866660).  Saving model ...
Epoch: 27 cost time: 0.868257999420166
Epoch: 27, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.661 Vali Acc: 0.870 Test Loss: 0.661 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 28 cost time: 1.0329420566558838
Epoch: 28, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.635 Vali Acc: 0.878 Test Loss: 0.635 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877771).  Saving model ...
Epoch: 29 cost time: 1.0610544681549072
Epoch: 29, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.612 Vali Acc: 0.874 Test Loss: 0.612 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9786717891693115
Epoch: 30, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.590 Vali Acc: 0.881 Test Loss: 0.590 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881476).  Saving model ...
Epoch: 31 cost time: 1.0629968643188477
Epoch: 31, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.569 Vali Acc: 0.881 Test Loss: 0.569 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 32 cost time: 1.1904809474945068
Epoch: 32, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.550 Vali Acc: 0.885 Test Loss: 0.550 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 33 cost time: 1.2137713432312012
Epoch: 33, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.532 Vali Acc: 0.896 Test Loss: 0.532 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896291).  Saving model ...
Epoch: 34 cost time: 1.1875498294830322
Epoch: 34, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.517 Vali Acc: 0.885 Test Loss: 0.517 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1844596862792969
Epoch: 35, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 36 cost time: 1.1687400341033936
Epoch: 36, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.475 Vali Acc: 0.915 Test Loss: 0.475 Test Acc: 0.915
Validation loss decreased (-0.899995 --> -0.914810).  Saving model ...
Epoch: 37 cost time: 0.8529810905456543
Epoch: 37, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.455 Vali Acc: 0.930 Test Loss: 0.455 Test Acc: 0.930
Validation loss decreased (-0.914810 --> -0.929625).  Saving model ...
Epoch: 38 cost time: 0.9819552898406982
Epoch: 38, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.438 Vali Acc: 0.926 Test Loss: 0.438 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.236025094985962
Epoch: 39, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.427 Vali Acc: 0.930 Test Loss: 0.427 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 40 cost time: 1.0224859714508057
Epoch: 40, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.421 Vali Acc: 0.926 Test Loss: 0.421 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.1350064277648926
Epoch: 41, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.412 Vali Acc: 0.926 Test Loss: 0.412 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.185467004776001
Epoch: 42, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.393 Vali Acc: 0.930 Test Loss: 0.393 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 43 cost time: 0.8797397613525391
Epoch: 43, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.374 Vali Acc: 0.933 Test Loss: 0.374 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 44 cost time: 1.010472059249878
Epoch: 44, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.364 Vali Acc: 0.933 Test Loss: 0.364 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 45 cost time: 0.8443148136138916
Epoch: 45, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.353 Vali Acc: 0.941 Test Loss: 0.353 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940737).  Saving model ...
Epoch: 46 cost time: 1.0114223957061768
Epoch: 46, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.344 Vali Acc: 0.948 Test Loss: 0.344 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 47 cost time: 0.8953537940979004
Epoch: 47, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.339 Vali Acc: 0.944 Test Loss: 0.339 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0329279899597168
Epoch: 48, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.335 Vali Acc: 0.937 Test Loss: 0.335 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2008936405181885
Epoch: 49, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.325 Vali Acc: 0.937 Test Loss: 0.325 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9815950393676758
Epoch: 50, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.314 Vali Acc: 0.937 Test Loss: 0.314 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.996025562286377
Epoch: 51, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.0509560108184814
Epoch: 52, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.302 Vali Acc: 0.937 Test Loss: 0.302 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.8457520008087158
Epoch: 53, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.0837225914001465
Epoch: 54, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.300 Vali Acc: 0.941 Test Loss: 0.300 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.1398124694824219
Epoch: 55, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.294 Vali Acc: 0.937 Test Loss: 0.294 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.1021294593811035
Epoch: 56, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.282 Vali Acc: 0.941 Test Loss: 0.282 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 759650
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1116600036621094
Epoch: 1, Steps: 2 | Train Loss: 1.978 Vali Loss: 1.955 Vali Acc: 0.148 Test Loss: 1.955 Test Acc: 0.148
Validation loss decreased (inf --> -0.148129).  Saving model ...
Epoch: 2 cost time: 1.0376830101013184
Epoch: 2, Steps: 2 | Train Loss: 2.031 Vali Loss: 1.925 Vali Acc: 0.137 Test Loss: 1.925 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4589862823486328
Epoch: 3, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.891 Vali Acc: 0.141 Test Loss: 1.891 Test Acc: 0.141
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1853978633880615
Epoch: 4, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.843 Vali Acc: 0.144 Test Loss: 1.843 Test Acc: 0.144
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4018373489379883
Epoch: 5, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.794 Vali Acc: 0.159 Test Loss: 1.794 Test Acc: 0.159
Validation loss decreased (-0.148129 --> -0.159241).  Saving model ...
Epoch: 6 cost time: 1.1254661083221436
Epoch: 6, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.749 Vali Acc: 0.222 Test Loss: 1.749 Test Acc: 0.222
Validation loss decreased (-0.159241 --> -0.222205).  Saving model ...
Epoch: 7 cost time: 0.935976505279541
Epoch: 7, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.708 Vali Acc: 0.307 Test Loss: 1.708 Test Acc: 0.307
Validation loss decreased (-0.222205 --> -0.307390).  Saving model ...
Epoch: 8 cost time: 1.022639274597168
Epoch: 8, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.666 Vali Acc: 0.407 Test Loss: 1.666 Test Acc: 0.407
Validation loss decreased (-0.307390 --> -0.407391).  Saving model ...
Epoch: 9 cost time: 0.9229490756988525
Epoch: 9, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.623 Vali Acc: 0.467 Test Loss: 1.623 Test Acc: 0.467
Validation loss decreased (-0.407391 --> -0.466650).  Saving model ...
Epoch: 10 cost time: 0.9846291542053223
Epoch: 10, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.577 Vali Acc: 0.541 Test Loss: 1.577 Test Acc: 0.541
Validation loss decreased (-0.466650 --> -0.540725).  Saving model ...
Epoch: 11 cost time: 0.7813401222229004
Epoch: 11, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.532 Vali Acc: 0.570 Test Loss: 1.532 Test Acc: 0.570
Validation loss decreased (-0.540725 --> -0.570355).  Saving model ...
Epoch: 12 cost time: 1.0956153869628906
Epoch: 12, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.480 Vali Acc: 0.626 Test Loss: 1.480 Test Acc: 0.626
Validation loss decreased (-0.570355 --> -0.625911).  Saving model ...
Epoch: 13 cost time: 1.038313388824463
Epoch: 13, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.428 Vali Acc: 0.681 Test Loss: 1.428 Test Acc: 0.681
Validation loss decreased (-0.625911 --> -0.681467).  Saving model ...
Epoch: 14 cost time: 0.9955048561096191
Epoch: 14, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.367 Vali Acc: 0.719 Test Loss: 1.367 Test Acc: 0.719
Validation loss decreased (-0.681467 --> -0.718505).  Saving model ...
Epoch: 15 cost time: 1.0779740810394287
Epoch: 15, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.299 Vali Acc: 0.807 Test Loss: 1.299 Test Acc: 0.807
Validation loss decreased (-0.718505 --> -0.807394).  Saving model ...
Epoch: 16 cost time: 1.0026943683624268
Epoch: 16, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.231 Vali Acc: 0.822 Test Loss: 1.231 Test Acc: 0.822
Validation loss decreased (-0.807394 --> -0.822210).  Saving model ...
Epoch: 17 cost time: 1.1321544647216797
Epoch: 17, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.166 Vali Acc: 0.830 Test Loss: 1.166 Test Acc: 0.830
Validation loss decreased (-0.822210 --> -0.829618).  Saving model ...
Epoch: 18 cost time: 0.8870463371276855
Epoch: 18, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.105 Vali Acc: 0.844 Test Loss: 1.105 Test Acc: 0.844
Validation loss decreased (-0.829618 --> -0.844433).  Saving model ...
Epoch: 19 cost time: 1.2395391464233398
Epoch: 19, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.051 Vali Acc: 0.837 Test Loss: 1.051 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0902302265167236
Epoch: 20, Steps: 2 | Train Loss: 1.000 Vali Loss: 1.000 Vali Acc: 0.859 Test Loss: 1.000 Test Acc: 0.859
Validation loss decreased (-0.844433 --> -0.859249).  Saving model ...
Epoch: 21 cost time: 1.4840991497039795
Epoch: 21, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.951 Vali Acc: 0.870 Test Loss: 0.951 Test Acc: 0.870
Validation loss decreased (-0.859249 --> -0.870361).  Saving model ...
Epoch: 22 cost time: 0.9757170677185059
Epoch: 22, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.903 Vali Acc: 0.885 Test Loss: 0.903 Test Acc: 0.885
Validation loss decreased (-0.870361 --> -0.885176).  Saving model ...
Epoch: 23 cost time: 1.6355459690093994
Epoch: 23, Steps: 2 | Train Loss: 0.806 Vali Loss: 0.860 Vali Acc: 0.878 Test Loss: 0.860 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.016627550125122
Epoch: 24, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.818 Vali Acc: 0.889 Test Loss: 0.818 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888881).  Saving model ...
Epoch: 25 cost time: 0.9993441104888916
Epoch: 25, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.779 Vali Acc: 0.896 Test Loss: 0.779 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896289).  Saving model ...
Epoch: 26 cost time: 0.9979937076568604
Epoch: 26, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.742 Vali Acc: 0.904 Test Loss: 0.742 Test Acc: 0.904
Validation loss decreased (-0.896289 --> -0.903696).  Saving model ...
Epoch: 27 cost time: 0.9602792263031006
Epoch: 27, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.710 Vali Acc: 0.907 Test Loss: 0.710 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 28 cost time: 0.9346559047698975
Epoch: 28, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.682 Vali Acc: 0.907 Test Loss: 0.682 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 29 cost time: 0.9912540912628174
Epoch: 29, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.655 Vali Acc: 0.907 Test Loss: 0.655 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 30 cost time: 0.8006794452667236
Epoch: 30, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.631 Vali Acc: 0.904 Test Loss: 0.631 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1729071140289307
Epoch: 31, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.608 Vali Acc: 0.915 Test Loss: 0.608 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 32 cost time: 1.0956506729125977
Epoch: 32, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.588 Vali Acc: 0.907 Test Loss: 0.588 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.9727282524108887
Epoch: 33, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.571 Vali Acc: 0.900 Test Loss: 0.571 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9374442100524902
Epoch: 34, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9071612358093262
Epoch: 35, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.542 Vali Acc: 0.911 Test Loss: 0.542 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.9434103965759277
Epoch: 36, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.525 Vali Acc: 0.907 Test Loss: 0.525 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2758285999298096
Epoch: 37, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.511 Vali Acc: 0.915 Test Loss: 0.511 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 38 cost time: 1.025181531906128
Epoch: 38, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.499 Vali Acc: 0.915 Test Loss: 0.499 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 39 cost time: 0.9602279663085938
Epoch: 39, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.485 Vali Acc: 0.919 Test Loss: 0.485 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 40 cost time: 0.8146390914916992
Epoch: 40, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.477 Vali Acc: 0.919 Test Loss: 0.477 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 41 cost time: 1.175112247467041
Epoch: 41, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.468 Vali Acc: 0.915 Test Loss: 0.468 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8232877254486084
Epoch: 42, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.455 Vali Acc: 0.915 Test Loss: 0.455 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.128753900527954
Epoch: 43, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.444 Vali Acc: 0.915 Test Loss: 0.444 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3484046459197998
Epoch: 44, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.436 Vali Acc: 0.915 Test Loss: 0.436 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.017310380935669
Epoch: 45, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.427 Vali Acc: 0.926 Test Loss: 0.427 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 46 cost time: 0.8017876148223877
Epoch: 46, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.418 Vali Acc: 0.926 Test Loss: 0.418 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 47 cost time: 0.8497223854064941
Epoch: 47, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.409 Vali Acc: 0.926 Test Loss: 0.409 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 48 cost time: 1.3153197765350342
Epoch: 48, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.410 Vali Acc: 0.930 Test Loss: 0.410 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 49 cost time: 0.8679790496826172
Epoch: 49, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.404 Vali Acc: 0.930 Test Loss: 0.404 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 50 cost time: 1.133847951889038
Epoch: 50, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.394 Vali Acc: 0.922 Test Loss: 0.394 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0442771911621094
Epoch: 51, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.382 Vali Acc: 0.922 Test Loss: 0.382 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.9181668758392334
Epoch: 52, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.375 Vali Acc: 0.919 Test Loss: 0.375 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 1.2698264122009277
Epoch: 53, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.371 Vali Acc: 0.919 Test Loss: 0.371 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.060678482055664
Epoch: 54, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.367 Vali Acc: 0.926 Test Loss: 0.367 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.9827249050140381
Epoch: 55, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.364 Vali Acc: 0.937 Test Loss: 0.364 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937033).  Saving model ...
Epoch: 56 cost time: 1.050771951675415
Epoch: 56, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.363 Vali Acc: 0.941 Test Loss: 0.363 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 57 cost time: 1.27079176902771
Epoch: 57, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.360 Vali Acc: 0.941 Test Loss: 0.360 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 58 cost time: 0.9004836082458496
Epoch: 58, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.352 Vali Acc: 0.944 Test Loss: 0.352 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 59 cost time: 1.0411360263824463
Epoch: 59, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.343 Vali Acc: 0.944 Test Loss: 0.343 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 60 cost time: 1.0853261947631836
Epoch: 60, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.334 Vali Acc: 0.937 Test Loss: 0.334 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 1.2139837741851807
Epoch: 61, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.326 Vali Acc: 0.941 Test Loss: 0.326 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 1.0897340774536133
Epoch: 62, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.320 Vali Acc: 0.937 Test Loss: 0.320 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 1.1044747829437256
Epoch: 63, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.315 Vali Acc: 0.937 Test Loss: 0.315 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.2815592288970947
Epoch: 64, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.311 Vali Acc: 0.937 Test Loss: 0.311 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.0363924503326416
Epoch: 65, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.311 Vali Acc: 0.948 Test Loss: 0.311 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 66 cost time: 1.1446723937988281
Epoch: 66, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.310 Vali Acc: 0.948 Test Loss: 0.310 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 67 cost time: 1.374253511428833
Epoch: 67, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.308 Vali Acc: 0.944 Test Loss: 0.308 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.0346741676330566
Epoch: 68, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.306 Vali Acc: 0.944 Test Loss: 0.306 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.2102875709533691
Epoch: 69, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.306 Vali Acc: 0.941 Test Loss: 0.306 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.1992583274841309
Epoch: 70, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.306 Vali Acc: 0.933 Test Loss: 0.306 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.1286625862121582
Epoch: 71, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.3653380870819092
Epoch: 72, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.953045129776001
Epoch: 73, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.0553882122039795
Epoch: 74, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 1.4413418769836426
Epoch: 75, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 1.1090991497039795
Epoch: 76, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.288 Vali Acc: 0.933 Test Loss: 0.288 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 759266
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5431344509124756
Epoch: 1, Steps: 2 | Train Loss: 2.122 Vali Loss: 2.105 Vali Acc: 0.174 Test Loss: 2.105 Test Acc: 0.174
Validation loss decreased (inf --> -0.174053).  Saving model ...
Epoch: 2 cost time: 0.8669366836547852
Epoch: 2, Steps: 2 | Train Loss: 2.063 Vali Loss: 2.068 Vali Acc: 0.178 Test Loss: 2.068 Test Acc: 0.178
Validation loss decreased (-0.174053 --> -0.177757).  Saving model ...
Epoch: 3 cost time: 0.9152255058288574
Epoch: 3, Steps: 2 | Train Loss: 1.997 Vali Loss: 2.034 Vali Acc: 0.174 Test Loss: 2.034 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8304951190948486
Epoch: 4, Steps: 2 | Train Loss: 2.070 Vali Loss: 1.988 Vali Acc: 0.170 Test Loss: 1.988 Test Acc: 0.170
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.049922227859497
Epoch: 5, Steps: 2 | Train Loss: 1.947 Vali Loss: 1.936 Vali Acc: 0.170 Test Loss: 1.936 Test Acc: 0.170
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0922062397003174
Epoch: 6, Steps: 2 | Train Loss: 1.940 Vali Loss: 1.881 Vali Acc: 0.170 Test Loss: 1.881 Test Acc: 0.170
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8071229457855225
Epoch: 7, Steps: 2 | Train Loss: 1.910 Vali Loss: 1.829 Vali Acc: 0.167 Test Loss: 1.829 Test Acc: 0.167
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.233856439590454
Epoch: 8, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.784 Vali Acc: 0.170 Test Loss: 1.784 Test Acc: 0.170
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8415944576263428
Epoch: 9, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.749 Vali Acc: 0.181 Test Loss: 1.749 Test Acc: 0.181
Validation loss decreased (-0.177757 --> -0.181464).  Saving model ...
Epoch: 10 cost time: 0.9349865913391113
Epoch: 10, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.724 Vali Acc: 0.396 Test Loss: 1.724 Test Acc: 0.396
Validation loss decreased (-0.181464 --> -0.396279).  Saving model ...
Epoch: 11 cost time: 0.8599569797515869
Epoch: 11, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.703 Vali Acc: 0.463 Test Loss: 1.703 Test Acc: 0.463
Validation loss decreased (-0.396279 --> -0.462946).  Saving model ...
Epoch: 12 cost time: 1.14988112449646
Epoch: 12, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.683 Vali Acc: 0.426 Test Loss: 1.683 Test Acc: 0.426
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.203333854675293
Epoch: 13, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.661 Vali Acc: 0.404 Test Loss: 1.661 Test Acc: 0.404
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8760504722595215
Epoch: 14, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.635 Vali Acc: 0.441 Test Loss: 1.635 Test Acc: 0.441
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8649122714996338
Epoch: 15, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.605 Vali Acc: 0.511 Test Loss: 1.605 Test Acc: 0.511
Validation loss decreased (-0.462946 --> -0.511095).  Saving model ...
Epoch: 16 cost time: 1.0741181373596191
Epoch: 16, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.568 Vali Acc: 0.615 Test Loss: 1.568 Test Acc: 0.615
Validation loss decreased (-0.511095 --> -0.614799).  Saving model ...
Epoch: 17 cost time: 0.9320931434631348
Epoch: 17, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.527 Vali Acc: 0.644 Test Loss: 1.527 Test Acc: 0.644
Validation loss decreased (-0.614799 --> -0.644429).  Saving model ...
Epoch: 18 cost time: 0.8182172775268555
Epoch: 18, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.478 Vali Acc: 0.630 Test Loss: 1.478 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0952818393707275
Epoch: 19, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.422 Vali Acc: 0.644 Test Loss: 1.422 Test Acc: 0.644
Validation loss decreased (-0.644429 --> -0.644430).  Saving model ...
Epoch: 20 cost time: 0.8973650932312012
Epoch: 20, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.362 Vali Acc: 0.633 Test Loss: 1.362 Test Acc: 0.633
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2526373863220215
Epoch: 21, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.295 Vali Acc: 0.678 Test Loss: 1.295 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677765).  Saving model ...
Epoch: 22 cost time: 0.9852714538574219
Epoch: 22, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.226 Vali Acc: 0.726 Test Loss: 1.226 Test Acc: 0.726
Validation loss decreased (-0.677765 --> -0.725914).  Saving model ...
Epoch: 23 cost time: 0.8881886005401611
Epoch: 23, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.155 Vali Acc: 0.767 Test Loss: 1.155 Test Acc: 0.767
Validation loss decreased (-0.725914 --> -0.766655).  Saving model ...
Epoch: 24 cost time: 0.7627518177032471
Epoch: 24, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.091 Vali Acc: 0.793 Test Loss: 1.091 Test Acc: 0.793
Validation loss decreased (-0.766655 --> -0.792582).  Saving model ...
Epoch: 25 cost time: 0.830369234085083
Epoch: 25, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.038 Vali Acc: 0.763 Test Loss: 1.038 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.028961181640625
Epoch: 26, Steps: 2 | Train Loss: 0.986 Vali Loss: 0.987 Vali Acc: 0.781 Test Loss: 0.987 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8157608509063721
Epoch: 27, Steps: 2 | Train Loss: 0.943 Vali Loss: 0.939 Vali Acc: 0.811 Test Loss: 0.939 Test Acc: 0.811
Validation loss decreased (-0.792582 --> -0.811102).  Saving model ...
Epoch: 28 cost time: 0.8222112655639648
Epoch: 28, Steps: 2 | Train Loss: 0.899 Vali Loss: 0.892 Vali Acc: 0.837 Test Loss: 0.892 Test Acc: 0.837
Validation loss decreased (-0.811102 --> -0.837028).  Saving model ...
Epoch: 29 cost time: 0.8524816036224365
Epoch: 29, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.853 Vali Acc: 0.837 Test Loss: 0.853 Test Acc: 0.837
Validation loss decreased (-0.837028 --> -0.837029).  Saving model ...
Epoch: 30 cost time: 0.8800890445709229
Epoch: 30, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.819 Vali Acc: 0.830 Test Loss: 0.819 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.1540937423706055
Epoch: 31, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.780 Vali Acc: 0.848 Test Loss: 0.780 Test Acc: 0.848
Validation loss decreased (-0.837029 --> -0.848140).  Saving model ...
Epoch: 32 cost time: 0.8376343250274658
Epoch: 32, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.744 Vali Acc: 0.870 Test Loss: 0.744 Test Acc: 0.870
Validation loss decreased (-0.848140 --> -0.870363).  Saving model ...
Epoch: 33 cost time: 1.119936466217041
Epoch: 33, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.713 Vali Acc: 0.874 Test Loss: 0.713 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 34 cost time: 1.0048189163208008
Epoch: 34, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.685 Vali Acc: 0.874 Test Loss: 0.685 Test Acc: 0.874
Validation loss decreased (-0.874067 --> -0.874067).  Saving model ...
Epoch: 35 cost time: 0.8119170665740967
Epoch: 35, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.658 Vali Acc: 0.885 Test Loss: 0.658 Test Acc: 0.885
Validation loss decreased (-0.874067 --> -0.885179).  Saving model ...
Epoch: 36 cost time: 0.8345303535461426
Epoch: 36, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.634 Vali Acc: 0.893 Test Loss: 0.634 Test Acc: 0.893
Validation loss decreased (-0.885179 --> -0.892586).  Saving model ...
Epoch: 37 cost time: 0.9040610790252686
Epoch: 37, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.976243257522583
Epoch: 38, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.602 Vali Acc: 0.874 Test Loss: 0.602 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8636112213134766
Epoch: 39, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.583 Vali Acc: 0.878 Test Loss: 0.583 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8596742153167725
Epoch: 40, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.561 Vali Acc: 0.885 Test Loss: 0.561 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8019542694091797
Epoch: 41, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.540 Vali Acc: 0.911 Test Loss: 0.540 Test Acc: 0.911
Validation loss decreased (-0.892586 --> -0.911106).  Saving model ...
Epoch: 42 cost time: 0.9994151592254639
Epoch: 42, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.528 Vali Acc: 0.915 Test Loss: 0.528 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 43 cost time: 0.8975608348846436
Epoch: 43, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.518 Vali Acc: 0.893 Test Loss: 0.518 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9365816116333008
Epoch: 44, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.506 Vali Acc: 0.904 Test Loss: 0.506 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9717342853546143
Epoch: 45, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.496 Vali Acc: 0.904 Test Loss: 0.496 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.115577220916748
Epoch: 46, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.492 Vali Acc: 0.896 Test Loss: 0.492 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9450218677520752
Epoch: 47, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.470 Vali Acc: 0.893 Test Loss: 0.470 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0617637634277344
Epoch: 48, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.450 Vali Acc: 0.919 Test Loss: 0.450 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 49 cost time: 1.0008964538574219
Epoch: 49, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.435 Vali Acc: 0.919 Test Loss: 0.435 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 50 cost time: 0.9920423030853271
Epoch: 50, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.424 Vali Acc: 0.922 Test Loss: 0.424 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 51 cost time: 0.8492887020111084
Epoch: 51, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.421 Vali Acc: 0.904 Test Loss: 0.421 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8446273803710938
Epoch: 52, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.421 Vali Acc: 0.907 Test Loss: 0.421 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.8632967472076416
Epoch: 53, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.411 Vali Acc: 0.904 Test Loss: 0.411 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1218562126159668
Epoch: 54, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.405 Vali Acc: 0.904 Test Loss: 0.405 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.7701539993286133
Epoch: 55, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.395 Vali Acc: 0.900 Test Loss: 0.395 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.0003833770751953
Epoch: 56, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.389 Vali Acc: 0.904 Test Loss: 0.389 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.8667747974395752
Epoch: 57, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.384 Vali Acc: 0.907 Test Loss: 0.384 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.9009044170379639
Epoch: 58, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.989997148513794
Epoch: 59, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.389 Vali Acc: 0.896 Test Loss: 0.389 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.9420685768127441
Epoch: 60, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.373 Vali Acc: 0.900 Test Loss: 0.373 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 460898
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.3212714195251465
Epoch: 1, Steps: 2 | Train Loss: 2.005 Vali Loss: 1.999 Vali Acc: 0.167 Test Loss: 1.999 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 1.2275657653808594
Epoch: 2, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.970 Vali Acc: 0.152 Test Loss: 1.970 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3691043853759766
Epoch: 3, Steps: 2 | Train Loss: 1.979 Vali Loss: 1.943 Vali Acc: 0.148 Test Loss: 1.943 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8522622585296631
Epoch: 4, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.908 Vali Acc: 0.130 Test Loss: 1.908 Test Acc: 0.130
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9196827411651611
Epoch: 5, Steps: 2 | Train Loss: 1.993 Vali Loss: 1.876 Vali Acc: 0.096 Test Loss: 1.876 Test Acc: 0.096
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1220014095306396
Epoch: 6, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.847 Vali Acc: 0.059 Test Loss: 1.847 Test Acc: 0.059
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9792525768280029
Epoch: 7, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.823 Vali Acc: 0.052 Test Loss: 1.823 Test Acc: 0.052
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4881865978240967
Epoch: 8, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.802 Vali Acc: 0.107 Test Loss: 1.802 Test Acc: 0.107
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2264792919158936
Epoch: 9, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.786 Vali Acc: 0.200 Test Loss: 1.786 Test Acc: 0.200
Validation loss decreased (-0.166647 --> -0.199982).  Saving model ...
Epoch: 10 cost time: 0.7974853515625
Epoch: 10, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.774 Vali Acc: 0.304 Test Loss: 1.774 Test Acc: 0.304
Validation loss decreased (-0.199982 --> -0.303686).  Saving model ...
Epoch: 11 cost time: 0.9629786014556885
Epoch: 11, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.762 Vali Acc: 0.374 Test Loss: 1.762 Test Acc: 0.374
Validation loss decreased (-0.303686 --> -0.374056).  Saving model ...
Epoch: 12 cost time: 0.8808615207672119
Epoch: 12, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.746 Vali Acc: 0.381 Test Loss: 1.746 Test Acc: 0.381
Validation loss decreased (-0.374056 --> -0.381464).  Saving model ...
Epoch: 13 cost time: 0.9832572937011719
Epoch: 13, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.728 Vali Acc: 0.389 Test Loss: 1.728 Test Acc: 0.389
Validation loss decreased (-0.381464 --> -0.388872).  Saving model ...
Epoch: 14 cost time: 1.0633761882781982
Epoch: 14, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.703 Vali Acc: 0.393 Test Loss: 1.703 Test Acc: 0.393
Validation loss decreased (-0.388872 --> -0.392576).  Saving model ...
Epoch: 15 cost time: 0.9933717250823975
Epoch: 15, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.677 Vali Acc: 0.407 Test Loss: 1.677 Test Acc: 0.407
Validation loss decreased (-0.392576 --> -0.407391).  Saving model ...
Epoch: 16 cost time: 1.1047263145446777
Epoch: 16, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.648 Vali Acc: 0.441 Test Loss: 1.648 Test Acc: 0.441
Validation loss decreased (-0.407391 --> -0.440724).  Saving model ...
Epoch: 17 cost time: 0.9314954280853271
Epoch: 17, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.618 Vali Acc: 0.478 Test Loss: 1.618 Test Acc: 0.478
Validation loss decreased (-0.440724 --> -0.477762).  Saving model ...
Epoch: 18 cost time: 0.9535906314849854
Epoch: 18, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.586 Vali Acc: 0.522 Test Loss: 1.586 Test Acc: 0.522
Validation loss decreased (-0.477762 --> -0.522206).  Saving model ...
Epoch: 19 cost time: 0.993584156036377
Epoch: 19, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.551 Vali Acc: 0.570 Test Loss: 1.551 Test Acc: 0.570
Validation loss decreased (-0.522206 --> -0.570355).  Saving model ...
Epoch: 20 cost time: 1.128922939300537
Epoch: 20, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.514 Vali Acc: 0.581 Test Loss: 1.514 Test Acc: 0.581
Validation loss decreased (-0.570355 --> -0.581466).  Saving model ...
Epoch: 21 cost time: 1.0030486583709717
Epoch: 21, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.471 Vali Acc: 0.593 Test Loss: 1.471 Test Acc: 0.593
Validation loss decreased (-0.581466 --> -0.592578).  Saving model ...
Epoch: 22 cost time: 1.3221697807312012
Epoch: 22, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.423 Vali Acc: 0.659 Test Loss: 1.423 Test Acc: 0.659
Validation loss decreased (-0.592578 --> -0.659245).  Saving model ...
Epoch: 23 cost time: 0.9060852527618408
Epoch: 23, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.371 Vali Acc: 0.685 Test Loss: 1.371 Test Acc: 0.685
Validation loss decreased (-0.659245 --> -0.685171).  Saving model ...
Epoch: 24 cost time: 1.3096601963043213
Epoch: 24, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.315 Vali Acc: 0.700 Test Loss: 1.315 Test Acc: 0.700
Validation loss decreased (-0.685171 --> -0.699987).  Saving model ...
Epoch: 25 cost time: 1.1751000881195068
Epoch: 25, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.258 Vali Acc: 0.726 Test Loss: 1.258 Test Acc: 0.726
Validation loss decreased (-0.699987 --> -0.725913).  Saving model ...
Epoch: 26 cost time: 1.5677008628845215
Epoch: 26, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.202 Vali Acc: 0.733 Test Loss: 1.202 Test Acc: 0.733
Validation loss decreased (-0.725913 --> -0.733321).  Saving model ...
Epoch: 27 cost time: 1.0257673263549805
Epoch: 27, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.149 Vali Acc: 0.752 Test Loss: 1.149 Test Acc: 0.752
Validation loss decreased (-0.733321 --> -0.751840).  Saving model ...
Epoch: 28 cost time: 1.0477535724639893
Epoch: 28, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.095 Vali Acc: 0.752 Test Loss: 1.095 Test Acc: 0.752
Validation loss decreased (-0.751840 --> -0.751841).  Saving model ...
Epoch: 29 cost time: 1.1021969318389893
Epoch: 29, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.042 Vali Acc: 0.778 Test Loss: 1.042 Test Acc: 0.778
Validation loss decreased (-0.751841 --> -0.777767).  Saving model ...
Epoch: 30 cost time: 0.9734551906585693
Epoch: 30, Steps: 2 | Train Loss: 0.963 Vali Loss: 0.995 Vali Acc: 0.800 Test Loss: 0.995 Test Acc: 0.800
Validation loss decreased (-0.777767 --> -0.799990).  Saving model ...
Epoch: 31 cost time: 1.1043674945831299
Epoch: 31, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.945 Vali Acc: 0.841 Test Loss: 0.945 Test Acc: 0.841
Validation loss decreased (-0.799990 --> -0.840731).  Saving model ...
Epoch: 32 cost time: 1.1075325012207031
Epoch: 32, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.898 Vali Acc: 0.856 Test Loss: 0.898 Test Acc: 0.856
Validation loss decreased (-0.840731 --> -0.855547).  Saving model ...
Epoch: 33 cost time: 0.9652941226959229
Epoch: 33, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.854 Vali Acc: 0.856 Test Loss: 0.854 Test Acc: 0.856
Validation loss decreased (-0.855547 --> -0.855547).  Saving model ...
Epoch: 34 cost time: 1.1709117889404297
Epoch: 34, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.818 Vali Acc: 0.852 Test Loss: 0.818 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.3417630195617676
Epoch: 35, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.781 Vali Acc: 0.878 Test Loss: 0.781 Test Acc: 0.878
Validation loss decreased (-0.855547 --> -0.877770).  Saving model ...
Epoch: 36 cost time: 1.1353299617767334
Epoch: 36, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.746 Vali Acc: 0.889 Test Loss: 0.746 Test Acc: 0.889
Validation loss decreased (-0.877770 --> -0.888881).  Saving model ...
Epoch: 37 cost time: 1.0872740745544434
Epoch: 37, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.709 Vali Acc: 0.904 Test Loss: 0.709 Test Acc: 0.904
Validation loss decreased (-0.888881 --> -0.903697).  Saving model ...
Epoch: 38 cost time: 1.147148847579956
Epoch: 38, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.677 Vali Acc: 0.911 Test Loss: 0.677 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911104).  Saving model ...
Epoch: 39 cost time: 1.1728615760803223
Epoch: 39, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.653 Vali Acc: 0.911 Test Loss: 0.653 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911105).  Saving model ...
Epoch: 40 cost time: 1.0057868957519531
Epoch: 40, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.631 Vali Acc: 0.919 Test Loss: 0.631 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918512).  Saving model ...
Epoch: 41 cost time: 0.8256433010101318
Epoch: 41, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.600 Vali Acc: 0.937 Test Loss: 0.600 Test Acc: 0.937
Validation loss decreased (-0.918512 --> -0.937031).  Saving model ...
Epoch: 42 cost time: 1.2083287239074707
Epoch: 42, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.577 Vali Acc: 0.937 Test Loss: 0.577 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937031).  Saving model ...
Epoch: 43 cost time: 0.8984172344207764
Epoch: 43, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.558 Vali Acc: 0.941 Test Loss: 0.558 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 44 cost time: 0.9733679294586182
Epoch: 44, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.543 Vali Acc: 0.937 Test Loss: 0.543 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.0596749782562256
Epoch: 45, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.530 Vali Acc: 0.941 Test Loss: 0.530 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940735).  Saving model ...
Epoch: 46 cost time: 0.8524689674377441
Epoch: 46, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.521 Vali Acc: 0.937 Test Loss: 0.521 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.1936304569244385
Epoch: 47, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.509 Vali Acc: 0.941 Test Loss: 0.509 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 48 cost time: 1.2292096614837646
Epoch: 48, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.495 Vali Acc: 0.937 Test Loss: 0.495 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9012868404388428
Epoch: 49, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.482 Vali Acc: 0.941 Test Loss: 0.482 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 50 cost time: 0.877638578414917
Epoch: 50, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.473 Vali Acc: 0.941 Test Loss: 0.473 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 51 cost time: 0.9486219882965088
Epoch: 51, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.460 Vali Acc: 0.941 Test Loss: 0.460 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 52 cost time: 1.196087121963501
Epoch: 52, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.450 Vali Acc: 0.937 Test Loss: 0.450 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.3401854038238525
Epoch: 53, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.439 Vali Acc: 0.941 Test Loss: 0.439 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 54 cost time: 0.9199349880218506
Epoch: 54, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.431 Vali Acc: 0.941 Test Loss: 0.431 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 55 cost time: 1.0316317081451416
Epoch: 55, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.424 Vali Acc: 0.930 Test Loss: 0.424 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.5053448677062988
Epoch: 56, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.420 Vali Acc: 0.933 Test Loss: 0.420 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.553074836730957
Epoch: 57, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.414 Vali Acc: 0.930 Test Loss: 0.414 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.0781621932983398
Epoch: 58, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.409 Vali Acc: 0.933 Test Loss: 0.409 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.2816836833953857
Epoch: 59, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.408 Vali Acc: 0.933 Test Loss: 0.408 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.9958617687225342
Epoch: 60, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.410 Vali Acc: 0.930 Test Loss: 0.410 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.2401373386383057
Epoch: 61, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.391 Vali Acc: 0.937 Test Loss: 0.391 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.4442949295043945
Epoch: 62, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.375 Vali Acc: 0.944 Test Loss: 0.375 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944441).  Saving model ...
Epoch: 63 cost time: 1.2954511642456055
Epoch: 63, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.372 Vali Acc: 0.944 Test Loss: 0.372 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 64 cost time: 1.2880070209503174
Epoch: 64, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.368 Vali Acc: 0.937 Test Loss: 0.368 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.3868300914764404
Epoch: 65, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.367 Vali Acc: 0.937 Test Loss: 0.367 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.9193699359893799
Epoch: 66, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.374 Vali Acc: 0.937 Test Loss: 0.374 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.0204808712005615
Epoch: 67, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.377 Vali Acc: 0.930 Test Loss: 0.377 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 1.0831284523010254
Epoch: 68, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.372 Vali Acc: 0.933 Test Loss: 0.372 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 1.3438999652862549
Epoch: 69, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.356 Vali Acc: 0.937 Test Loss: 0.356 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.2535483837127686
Epoch: 70, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.348 Vali Acc: 0.937 Test Loss: 0.348 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.1219050884246826
Epoch: 71, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.345 Vali Acc: 0.941 Test Loss: 0.345 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.1807167530059814
Epoch: 72, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.346 Vali Acc: 0.937 Test Loss: 0.346 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.8685472011566162
Epoch: 73, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.350 Vali Acc: 0.941 Test Loss: 0.350 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 460514
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6782009601593018
Epoch: 1, Steps: 2 | Train Loss: 1.961 Vali Loss: 2.045 Vali Acc: 0.167 Test Loss: 2.045 Test Acc: 0.167
Validation loss decreased (inf --> -0.166646).  Saving model ...
Epoch: 2 cost time: 0.9770584106445312
Epoch: 2, Steps: 2 | Train Loss: 2.061 Vali Loss: 2.015 Vali Acc: 0.167 Test Loss: 2.015 Test Acc: 0.167
Validation loss decreased (-0.166646 --> -0.166647).  Saving model ...
Epoch: 3 cost time: 0.9122335910797119
Epoch: 3, Steps: 2 | Train Loss: 2.045 Vali Loss: 1.987 Vali Acc: 0.163 Test Loss: 1.987 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8788101673126221
Epoch: 4, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.952 Vali Acc: 0.163 Test Loss: 1.952 Test Acc: 0.163
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0879015922546387
Epoch: 5, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.911 Vali Acc: 0.159 Test Loss: 1.911 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0479836463928223
Epoch: 6, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.871 Vali Acc: 0.163 Test Loss: 1.871 Test Acc: 0.163
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9682753086090088
Epoch: 7, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.835 Vali Acc: 0.204 Test Loss: 1.835 Test Acc: 0.204
Validation loss decreased (-0.166647 --> -0.203685).  Saving model ...
Epoch: 8 cost time: 1.030839204788208
Epoch: 8, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.799 Vali Acc: 0.244 Test Loss: 1.799 Test Acc: 0.244
Validation loss decreased (-0.203685 --> -0.244426).  Saving model ...
Epoch: 9 cost time: 0.82627272605896
Epoch: 9, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.766 Vali Acc: 0.267 Test Loss: 1.766 Test Acc: 0.267
Validation loss decreased (-0.244426 --> -0.266649).  Saving model ...
Epoch: 10 cost time: 0.9961168766021729
Epoch: 10, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.735 Vali Acc: 0.270 Test Loss: 1.735 Test Acc: 0.270
Validation loss decreased (-0.266649 --> -0.270353).  Saving model ...
Epoch: 11 cost time: 0.9577832221984863
Epoch: 11, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.707 Vali Acc: 0.274 Test Loss: 1.707 Test Acc: 0.274
Validation loss decreased (-0.270353 --> -0.274057).  Saving model ...
Epoch: 12 cost time: 0.8948097229003906
Epoch: 12, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.682 Vali Acc: 0.352 Test Loss: 1.682 Test Acc: 0.352
Validation loss decreased (-0.274057 --> -0.351835).  Saving model ...
Epoch: 13 cost time: 0.9214510917663574
Epoch: 13, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.657 Vali Acc: 0.326 Test Loss: 1.657 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8169777393341064
Epoch: 14, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.628 Vali Acc: 0.322 Test Loss: 1.628 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8585538864135742
Epoch: 15, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.593 Vali Acc: 0.370 Test Loss: 1.593 Test Acc: 0.370
Validation loss decreased (-0.351835 --> -0.370354).  Saving model ...
Epoch: 16 cost time: 0.8871626853942871
Epoch: 16, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.557 Vali Acc: 0.430 Test Loss: 1.557 Test Acc: 0.430
Validation loss decreased (-0.370354 --> -0.429614).  Saving model ...
Epoch: 17 cost time: 0.993586540222168
Epoch: 17, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.518 Vali Acc: 0.504 Test Loss: 1.518 Test Acc: 0.504
Validation loss decreased (-0.429614 --> -0.503689).  Saving model ...
Epoch: 18 cost time: 0.9079434871673584
Epoch: 18, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.476 Vali Acc: 0.530 Test Loss: 1.476 Test Acc: 0.530
Validation loss decreased (-0.503689 --> -0.529615).  Saving model ...
Epoch: 19 cost time: 0.8855600357055664
Epoch: 19, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.434 Vali Acc: 0.559 Test Loss: 1.434 Test Acc: 0.559
Validation loss decreased (-0.529615 --> -0.559245).  Saving model ...
Epoch: 20 cost time: 0.9885265827178955
Epoch: 20, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.390 Vali Acc: 0.600 Test Loss: 1.390 Test Acc: 0.600
Validation loss decreased (-0.559245 --> -0.599986).  Saving model ...
Epoch: 21 cost time: 0.9477512836456299
Epoch: 21, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.346 Vali Acc: 0.626 Test Loss: 1.346 Test Acc: 0.626
Validation loss decreased (-0.599986 --> -0.625912).  Saving model ...
Epoch: 22 cost time: 0.8926761150360107
Epoch: 22, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.300 Vali Acc: 0.663 Test Loss: 1.300 Test Acc: 0.663
Validation loss decreased (-0.625912 --> -0.662950).  Saving model ...
Epoch: 23 cost time: 1.0485870838165283
Epoch: 23, Steps: 2 | Train Loss: 1.241 Vali Loss: 1.254 Vali Acc: 0.667 Test Loss: 1.254 Test Acc: 0.667
Validation loss decreased (-0.662950 --> -0.666654).  Saving model ...
Epoch: 24 cost time: 1.0527637004852295
Epoch: 24, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.207 Vali Acc: 0.674 Test Loss: 1.207 Test Acc: 0.674
Validation loss decreased (-0.666654 --> -0.674062).  Saving model ...
Epoch: 25 cost time: 0.7158172130584717
Epoch: 25, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.166 Vali Acc: 0.693 Test Loss: 1.166 Test Acc: 0.693
Validation loss decreased (-0.674062 --> -0.692581).  Saving model ...
Epoch: 26 cost time: 1.0657002925872803
Epoch: 26, Steps: 2 | Train Loss: 0.936 Vali Loss: 1.123 Vali Acc: 0.700 Test Loss: 1.123 Test Acc: 0.700
Validation loss decreased (-0.692581 --> -0.699989).  Saving model ...
Epoch: 27 cost time: 0.8303844928741455
Epoch: 27, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.081 Vali Acc: 0.719 Test Loss: 1.081 Test Acc: 0.719
Validation loss decreased (-0.699989 --> -0.718508).  Saving model ...
Epoch: 28 cost time: 1.1243622303009033
Epoch: 28, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.037 Vali Acc: 0.719 Test Loss: 1.037 Test Acc: 0.719
Validation loss decreased (-0.718508 --> -0.718508).  Saving model ...
Epoch: 29 cost time: 0.8862111568450928
Epoch: 29, Steps: 2 | Train Loss: 0.918 Vali Loss: 0.996 Vali Acc: 0.730 Test Loss: 0.996 Test Acc: 0.730
Validation loss decreased (-0.718508 --> -0.729620).  Saving model ...
Epoch: 30 cost time: 0.8815739154815674
Epoch: 30, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.957 Vali Acc: 0.741 Test Loss: 0.957 Test Acc: 0.741
Validation loss decreased (-0.729620 --> -0.740731).  Saving model ...
Epoch: 31 cost time: 0.7978682518005371
Epoch: 31, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.926 Vali Acc: 0.737 Test Loss: 0.926 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9253008365631104
Epoch: 32, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.890 Vali Acc: 0.744 Test Loss: 0.890 Test Acc: 0.744
Validation loss decreased (-0.740731 --> -0.744436).  Saving model ...
Epoch: 33 cost time: 0.8992354869842529
Epoch: 33, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.859 Vali Acc: 0.759 Test Loss: 0.859 Test Acc: 0.759
Validation loss decreased (-0.744436 --> -0.759251).  Saving model ...
Epoch: 34 cost time: 1.1928038597106934
Epoch: 34, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.826 Vali Acc: 0.767 Test Loss: 0.826 Test Acc: 0.767
Validation loss decreased (-0.759251 --> -0.766658).  Saving model ...
Epoch: 35 cost time: 1.037611484527588
Epoch: 35, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.799 Vali Acc: 0.774 Test Loss: 0.799 Test Acc: 0.774
Validation loss decreased (-0.766658 --> -0.774066).  Saving model ...
Epoch: 36 cost time: 0.8031349182128906
Epoch: 36, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.773 Vali Acc: 0.796 Test Loss: 0.773 Test Acc: 0.796
Validation loss decreased (-0.774066 --> -0.796289).  Saving model ...
Epoch: 37 cost time: 0.8000688552856445
Epoch: 37, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.752 Vali Acc: 0.819 Test Loss: 0.752 Test Acc: 0.819
Validation loss decreased (-0.796289 --> -0.818511).  Saving model ...
Epoch: 38 cost time: 0.7705509662628174
Epoch: 38, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.730 Vali Acc: 0.811 Test Loss: 0.730 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.267961025238037
Epoch: 39, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.712 Vali Acc: 0.819 Test Loss: 0.712 Test Acc: 0.819
Validation loss decreased (-0.818511 --> -0.818511).  Saving model ...
Epoch: 40 cost time: 0.941885232925415
Epoch: 40, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.692 Vali Acc: 0.844 Test Loss: 0.692 Test Acc: 0.844
Validation loss decreased (-0.818511 --> -0.844438).  Saving model ...
Epoch: 41 cost time: 1.0414390563964844
Epoch: 41, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.675 Vali Acc: 0.844 Test Loss: 0.675 Test Acc: 0.844
Validation loss decreased (-0.844438 --> -0.844438).  Saving model ...
Epoch: 42 cost time: 1.033900499343872
Epoch: 42, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.656 Vali Acc: 0.863 Test Loss: 0.656 Test Acc: 0.863
Validation loss decreased (-0.844438 --> -0.862956).  Saving model ...
Epoch: 43 cost time: 0.8264491558074951
Epoch: 43, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.635 Vali Acc: 0.874 Test Loss: 0.635 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874068).  Saving model ...
Epoch: 44 cost time: 0.9202697277069092
Epoch: 44, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.615 Vali Acc: 0.878 Test Loss: 0.615 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 45 cost time: 0.9855234622955322
Epoch: 45, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.596 Vali Acc: 0.878 Test Loss: 0.596 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 46 cost time: 1.0686275959014893
Epoch: 46, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.582 Vali Acc: 0.878 Test Loss: 0.582 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 47 cost time: 1.176724910736084
Epoch: 47, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 48 cost time: 1.0889770984649658
Epoch: 48, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.568 Vali Acc: 0.878 Test Loss: 0.568 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 49 cost time: 0.9718470573425293
Epoch: 49, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.544 Vali Acc: 0.896 Test Loss: 0.544 Test Acc: 0.896
Validation loss decreased (-0.877772 --> -0.896291).  Saving model ...
Epoch: 50 cost time: 0.997424840927124
Epoch: 50, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.524 Vali Acc: 0.893 Test Loss: 0.524 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8988192081451416
Epoch: 51, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.515 Vali Acc: 0.881 Test Loss: 0.515 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0295803546905518
Epoch: 52, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.508 Vali Acc: 0.874 Test Loss: 0.508 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.9479970932006836
Epoch: 53, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.513 Vali Acc: 0.870 Test Loss: 0.513 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 1.162506103515625
Epoch: 54, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.526 Vali Acc: 0.863 Test Loss: 0.526 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 1.2018749713897705
Epoch: 55, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.505 Vali Acc: 0.874 Test Loss: 0.505 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 1.0527002811431885
Epoch: 56, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.471 Vali Acc: 0.896 Test Loss: 0.471 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 57 cost time: 1.064535140991211
Epoch: 57, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.454 Vali Acc: 0.904 Test Loss: 0.454 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903699).  Saving model ...
Epoch: 58 cost time: 0.9516701698303223
Epoch: 58, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.446 Vali Acc: 0.904 Test Loss: 0.446 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 59 cost time: 0.935781717300415
Epoch: 59, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.439 Vali Acc: 0.904 Test Loss: 0.439 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 60 cost time: 1.0213124752044678
Epoch: 60, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.437 Vali Acc: 0.904 Test Loss: 0.437 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 61 cost time: 0.806708812713623
Epoch: 61, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.437 Vali Acc: 0.904 Test Loss: 0.437 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.1980526447296143
Epoch: 62, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.428 Vali Acc: 0.889 Test Loss: 0.428 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.021946668624878
Epoch: 63, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.420 Vali Acc: 0.896 Test Loss: 0.420 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 1.0853044986724854
Epoch: 64, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.413 Vali Acc: 0.896 Test Loss: 0.413 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.1270194053649902
Epoch: 65, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.9170870780944824
Epoch: 66, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.402 Vali Acc: 0.907 Test Loss: 0.402 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 67 cost time: 0.9632000923156738
Epoch: 67, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.403 Vali Acc: 0.896 Test Loss: 0.403 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.0771453380584717
Epoch: 68, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.406 Vali Acc: 0.900 Test Loss: 0.406 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8368279933929443
Epoch: 69, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.401 Vali Acc: 0.900 Test Loss: 0.401 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8017067909240723
Epoch: 70, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.385 Vali Acc: 0.900 Test Loss: 0.385 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.9958140850067139
Epoch: 71, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.377 Vali Acc: 0.904 Test Loss: 0.377 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.8481121063232422
Epoch: 72, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.373 Vali Acc: 0.904 Test Loss: 0.373 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.963850736618042
Epoch: 73, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.369 Vali Acc: 0.907 Test Loss: 0.369 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 74 cost time: 0.7997121810913086
Epoch: 74, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.369 Vali Acc: 0.907 Test Loss: 0.369 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 75 cost time: 0.8679165840148926
Epoch: 75, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.371 Vali Acc: 0.907 Test Loss: 0.371 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.1173861026763916
Epoch: 76, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.369 Vali Acc: 0.907 Test Loss: 0.369 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.3433244228363037
Epoch: 77, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.364 Vali Acc: 0.911 Test Loss: 0.364 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911107).  Saving model ...
Epoch: 78 cost time: 0.8359315395355225
Epoch: 78, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.362 Vali Acc: 0.911 Test Loss: 0.362 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 79 cost time: 0.8644349575042725
Epoch: 79, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.357 Vali Acc: 0.911 Test Loss: 0.357 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 80 cost time: 1.0185492038726807
Epoch: 80, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.346 Vali Acc: 0.907 Test Loss: 0.346 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.0351221561431885
Epoch: 81, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.344 Vali Acc: 0.904 Test Loss: 0.344 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.9387767314910889
Epoch: 82, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.342 Vali Acc: 0.900 Test Loss: 0.342 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.9589183330535889
Epoch: 83, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.8411126136779785
Epoch: 84, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.349 Vali Acc: 0.896 Test Loss: 0.349 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.8700268268585205
Epoch: 85, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.8049576282501221
Epoch: 86, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.335 Vali Acc: 0.907 Test Loss: 0.335 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 1.1748402118682861
Epoch: 87, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 88 cost time: 0.9975664615631104
Epoch: 88, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.329 Vali Acc: 0.919 Test Loss: 0.329 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918515).  Saving model ...
Epoch: 89 cost time: 0.7444157600402832
Epoch: 89, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.326 Vali Acc: 0.915 Test Loss: 0.326 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.9025154113769531
Epoch: 90, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.324 Vali Acc: 0.904 Test Loss: 0.324 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 1.0519216060638428
Epoch: 91, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.325 Vali Acc: 0.904 Test Loss: 0.325 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 1.1564099788665771
Epoch: 92, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.330 Vali Acc: 0.907 Test Loss: 0.330 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.9189414978027344
Epoch: 93, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.329 Vali Acc: 0.907 Test Loss: 0.329 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 0.990227460861206
Epoch: 94, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.315 Vali Acc: 0.907 Test Loss: 0.315 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 0.962822437286377
Epoch: 95, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.308 Vali Acc: 0.900 Test Loss: 0.308 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.9721076488494873
Epoch: 96, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.307 Vali Acc: 0.915 Test Loss: 0.307 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 1.0590384006500244
Epoch: 97, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 98 cost time: 1.3889837265014648
Epoch: 98, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.311 Vali Acc: 0.915 Test Loss: 0.311 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 1.0875205993652344
Epoch: 99, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.319 Vali Acc: 0.907 Test Loss: 0.319 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.9925034046173096
Epoch: 100, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.320 Vali Acc: 0.900 Test Loss: 0.320 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 460130
model size : 2.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8221969604492188
Epoch: 1, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.852 Vali Acc: 0.348 Test Loss: 1.852 Test Acc: 0.348
Validation loss decreased (inf --> -0.348130).  Saving model ...
Epoch: 2 cost time: 1.1298081874847412
Epoch: 2, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.831 Vali Acc: 0.389 Test Loss: 1.831 Test Acc: 0.389
Validation loss decreased (-0.348130 --> -0.388871).  Saving model ...
Epoch: 3 cost time: 0.9506921768188477
Epoch: 3, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.808 Vali Acc: 0.400 Test Loss: 1.808 Test Acc: 0.400
Validation loss decreased (-0.388871 --> -0.399982).  Saving model ...
Epoch: 4 cost time: 1.196610927581787
Epoch: 4, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.777 Vali Acc: 0.426 Test Loss: 1.777 Test Acc: 0.426
Validation loss decreased (-0.399982 --> -0.425908).  Saving model ...
Epoch: 5 cost time: 1.1755225658416748
Epoch: 5, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.744 Vali Acc: 0.430 Test Loss: 1.744 Test Acc: 0.430
Validation loss decreased (-0.425908 --> -0.429612).  Saving model ...
Epoch: 6 cost time: 0.7446937561035156
Epoch: 6, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.711 Vali Acc: 0.448 Test Loss: 1.711 Test Acc: 0.448
Validation loss decreased (-0.429612 --> -0.448131).  Saving model ...
Epoch: 7 cost time: 0.8443167209625244
Epoch: 7, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.679 Vali Acc: 0.441 Test Loss: 1.679 Test Acc: 0.441
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.116826057434082
Epoch: 8, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.651 Vali Acc: 0.430 Test Loss: 1.651 Test Acc: 0.430
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0600078105926514
Epoch: 9, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.625 Vali Acc: 0.393 Test Loss: 1.625 Test Acc: 0.393
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2364697456359863
Epoch: 10, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.600 Vali Acc: 0.378 Test Loss: 1.600 Test Acc: 0.378
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9868552684783936
Epoch: 11, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.576 Vali Acc: 0.381 Test Loss: 1.576 Test Acc: 0.381
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.8779556751251221
Epoch: 12, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.549 Vali Acc: 0.385 Test Loss: 1.549 Test Acc: 0.385
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.8691046237945557
Epoch: 13, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.517 Vali Acc: 0.441 Test Loss: 1.517 Test Acc: 0.441
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.025010347366333
Epoch: 14, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.480 Vali Acc: 0.474 Test Loss: 1.480 Test Acc: 0.474
Validation loss decreased (-0.448131 --> -0.474059).  Saving model ...
Epoch: 15 cost time: 1.1340279579162598
Epoch: 15, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.439 Vali Acc: 0.489 Test Loss: 1.439 Test Acc: 0.489
Validation loss decreased (-0.474059 --> -0.488874).  Saving model ...
Epoch: 16 cost time: 0.8059768676757812
Epoch: 16, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.393 Vali Acc: 0.563 Test Loss: 1.393 Test Acc: 0.563
Validation loss decreased (-0.488874 --> -0.562949).  Saving model ...
Epoch: 17 cost time: 1.029655933380127
Epoch: 17, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.343 Vali Acc: 0.596 Test Loss: 1.343 Test Acc: 0.596
Validation loss decreased (-0.562949 --> -0.596283).  Saving model ...
Epoch: 18 cost time: 1.0264277458190918
Epoch: 18, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.290 Vali Acc: 0.644 Test Loss: 1.290 Test Acc: 0.644
Validation loss decreased (-0.596283 --> -0.644432).  Saving model ...
Epoch: 19 cost time: 1.128051519393921
Epoch: 19, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.238 Vali Acc: 0.648 Test Loss: 1.238 Test Acc: 0.648
Validation loss decreased (-0.644432 --> -0.648136).  Saving model ...
Epoch: 20 cost time: 0.9058670997619629
Epoch: 20, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.186 Vali Acc: 0.670 Test Loss: 1.186 Test Acc: 0.670
Validation loss decreased (-0.648136 --> -0.670359).  Saving model ...
Epoch: 21 cost time: 0.8540709018707275
Epoch: 21, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.134 Vali Acc: 0.693 Test Loss: 1.134 Test Acc: 0.693
Validation loss decreased (-0.670359 --> -0.692581).  Saving model ...
Epoch: 22 cost time: 0.9468123912811279
Epoch: 22, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.086 Vali Acc: 0.704 Test Loss: 1.086 Test Acc: 0.704
Validation loss decreased (-0.692581 --> -0.703693).  Saving model ...
Epoch: 23 cost time: 1.1952753067016602
Epoch: 23, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.038 Vali Acc: 0.715 Test Loss: 1.038 Test Acc: 0.715
Validation loss decreased (-0.703693 --> -0.714804).  Saving model ...
Epoch: 24 cost time: 1.2068884372711182
Epoch: 24, Steps: 2 | Train Loss: 0.944 Vali Loss: 0.993 Vali Acc: 0.711 Test Loss: 0.993 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9827218055725098
Epoch: 25, Steps: 2 | Train Loss: 0.977 Vali Loss: 0.948 Vali Acc: 0.733 Test Loss: 0.948 Test Acc: 0.733
Validation loss decreased (-0.714804 --> -0.733324).  Saving model ...
Epoch: 26 cost time: 1.338498830795288
Epoch: 26, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.908 Vali Acc: 0.767 Test Loss: 0.908 Test Acc: 0.767
Validation loss decreased (-0.733324 --> -0.766658).  Saving model ...
Epoch: 27 cost time: 1.307978630065918
Epoch: 27, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.872 Vali Acc: 0.785 Test Loss: 0.872 Test Acc: 0.785
Validation loss decreased (-0.766658 --> -0.785176).  Saving model ...
Epoch: 28 cost time: 1.1010823249816895
Epoch: 28, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.840 Vali Acc: 0.793 Test Loss: 0.840 Test Acc: 0.793
Validation loss decreased (-0.785176 --> -0.792584).  Saving model ...
Epoch: 29 cost time: 1.0822093486785889
Epoch: 29, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.811 Vali Acc: 0.804 Test Loss: 0.811 Test Acc: 0.804
Validation loss decreased (-0.792584 --> -0.803696).  Saving model ...
Epoch: 30 cost time: 1.12127685546875
Epoch: 30, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.784 Vali Acc: 0.807 Test Loss: 0.784 Test Acc: 0.807
Validation loss decreased (-0.803696 --> -0.807400).  Saving model ...
Epoch: 31 cost time: 0.899787425994873
Epoch: 31, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.760 Vali Acc: 0.822 Test Loss: 0.760 Test Acc: 0.822
Validation loss decreased (-0.807400 --> -0.822215).  Saving model ...
Epoch: 32 cost time: 0.9524726867675781
Epoch: 32, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.738 Vali Acc: 0.830 Test Loss: 0.738 Test Acc: 0.830
Validation loss decreased (-0.822215 --> -0.829622).  Saving model ...
Epoch: 33 cost time: 1.195770502090454
Epoch: 33, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.716 Vali Acc: 0.826 Test Loss: 0.716 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9704060554504395
Epoch: 34, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.699 Vali Acc: 0.837 Test Loss: 0.699 Test Acc: 0.837
Validation loss decreased (-0.829622 --> -0.837030).  Saving model ...
Epoch: 35 cost time: 1.1278607845306396
Epoch: 35, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.683 Vali Acc: 0.859 Test Loss: 0.683 Test Acc: 0.859
Validation loss decreased (-0.837030 --> -0.859252).  Saving model ...
Epoch: 36 cost time: 1.058427333831787
Epoch: 36, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.668 Vali Acc: 0.848 Test Loss: 0.668 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9905145168304443
Epoch: 37, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.651 Vali Acc: 0.856 Test Loss: 0.651 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.2297720909118652
Epoch: 38, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.635 Vali Acc: 0.859 Test Loss: 0.635 Test Acc: 0.859
Validation loss decreased (-0.859252 --> -0.859253).  Saving model ...
Epoch: 39 cost time: 1.0186119079589844
Epoch: 39, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.618 Vali Acc: 0.867 Test Loss: 0.618 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866660).  Saving model ...
Epoch: 40 cost time: 1.2079317569732666
Epoch: 40, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.602 Vali Acc: 0.870 Test Loss: 0.602 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 41 cost time: 1.0363616943359375
Epoch: 41, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.588 Vali Acc: 0.870 Test Loss: 0.588 Test Acc: 0.870
Validation loss decreased (-0.870364 --> -0.870364).  Saving model ...
Epoch: 42 cost time: 1.090212345123291
Epoch: 42, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.577 Vali Acc: 0.881 Test Loss: 0.577 Test Acc: 0.881
Validation loss decreased (-0.870364 --> -0.881476).  Saving model ...
Epoch: 43 cost time: 1.2460999488830566
Epoch: 43, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.094350814819336
Epoch: 44, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.558 Vali Acc: 0.885 Test Loss: 0.558 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 45 cost time: 0.8756937980651855
Epoch: 45, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.547 Vali Acc: 0.881 Test Loss: 0.547 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1419377326965332
Epoch: 46, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.536 Vali Acc: 0.881 Test Loss: 0.536 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0576725006103516
Epoch: 47, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.528 Vali Acc: 0.889 Test Loss: 0.528 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 48 cost time: 1.3900375366210938
Epoch: 48, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.517 Vali Acc: 0.889 Test Loss: 0.517 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 49 cost time: 0.8942904472351074
Epoch: 49, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.508 Vali Acc: 0.889 Test Loss: 0.508 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 50 cost time: 0.9981074333190918
Epoch: 50, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 51 cost time: 0.8347949981689453
Epoch: 51, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 52 cost time: 0.9994375705718994
Epoch: 52, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.485 Vali Acc: 0.896 Test Loss: 0.485 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896291).  Saving model ...
Epoch: 53 cost time: 1.0321145057678223
Epoch: 53, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.480 Vali Acc: 0.896 Test Loss: 0.480 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 54 cost time: 1.2038509845733643
Epoch: 54, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899995).  Saving model ...
Epoch: 55 cost time: 1.055396318435669
Epoch: 55, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.476 Vali Acc: 0.896 Test Loss: 0.476 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.1008212566375732
Epoch: 56, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.472 Vali Acc: 0.896 Test Loss: 0.472 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.168149471282959
Epoch: 57, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.468 Vali Acc: 0.889 Test Loss: 0.468 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8928766250610352
Epoch: 58, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.464 Vali Acc: 0.885 Test Loss: 0.464 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.9859085083007812
Epoch: 59, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.455 Vali Acc: 0.904 Test Loss: 0.455 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 60 cost time: 1.1179986000061035
Epoch: 60, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.447 Vali Acc: 0.907 Test Loss: 0.447 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 61 cost time: 0.8584260940551758
Epoch: 61, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.438 Vali Acc: 0.907 Test Loss: 0.438 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 62 cost time: 1.040942668914795
Epoch: 62, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.427 Vali Acc: 0.907 Test Loss: 0.427 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 63 cost time: 0.9538929462432861
Epoch: 63, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.420 Vali Acc: 0.907 Test Loss: 0.420 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 64 cost time: 0.8954291343688965
Epoch: 64, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.422 Vali Acc: 0.904 Test Loss: 0.422 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.2293365001678467
Epoch: 65, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.417 Vali Acc: 0.907 Test Loss: 0.417 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 66 cost time: 1.2959439754486084
Epoch: 66, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.412 Vali Acc: 0.911 Test Loss: 0.412 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 67 cost time: 1.1792323589324951
Epoch: 67, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.400 Vali Acc: 0.907 Test Loss: 0.400 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.9405100345611572
Epoch: 68, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.391 Vali Acc: 0.911 Test Loss: 0.391 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 69 cost time: 1.3603851795196533
Epoch: 69, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.383 Vali Acc: 0.915 Test Loss: 0.383 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 70 cost time: 1.0240728855133057
Epoch: 70, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.377 Vali Acc: 0.915 Test Loss: 0.377 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 71 cost time: 0.9977848529815674
Epoch: 71, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.380 Vali Acc: 0.911 Test Loss: 0.380 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.0683000087738037
Epoch: 72, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.385 Vali Acc: 0.904 Test Loss: 0.385 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.9292197227478027
Epoch: 73, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.384 Vali Acc: 0.911 Test Loss: 0.384 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.9633755683898926
Epoch: 74, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.376 Vali Acc: 0.904 Test Loss: 0.376 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.913776159286499
Epoch: 75, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.363 Vali Acc: 0.911 Test Loss: 0.363 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.8603994846343994
Epoch: 76, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.356 Vali Acc: 0.915 Test Loss: 0.356 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 77 cost time: 1.3365514278411865
Epoch: 77, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.356 Vali Acc: 0.911 Test Loss: 0.356 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 1.126955509185791
Epoch: 78, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.357 Vali Acc: 0.915 Test Loss: 0.357 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.9294700622558594
Epoch: 79, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.350 Vali Acc: 0.919 Test Loss: 0.350 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 80 cost time: 0.8783612251281738
Epoch: 80, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.336 Vali Acc: 0.919 Test Loss: 0.336 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 81 cost time: 1.0058104991912842
Epoch: 81, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 82 cost time: 0.9864130020141602
Epoch: 82, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929626).  Saving model ...
Epoch: 83 cost time: 1.1266937255859375
Epoch: 83, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.320 Vali Acc: 0.926 Test Loss: 0.320 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 1.0122003555297852
Epoch: 84, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.329 Vali Acc: 0.926 Test Loss: 0.329 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 1.2101805210113525
Epoch: 85, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.351 Vali Acc: 0.904 Test Loss: 0.351 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 1.2378926277160645
Epoch: 86, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.355 Vali Acc: 0.900 Test Loss: 0.355 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.0589635372161865
Epoch: 87, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.342 Vali Acc: 0.907 Test Loss: 0.342 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 1.6702394485473633
Epoch: 88, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.318 Vali Acc: 0.919 Test Loss: 0.318 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 1.2893049716949463
Epoch: 89, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.304 Vali Acc: 0.926 Test Loss: 0.304 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.8198239803314209
Epoch: 90, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.301 Vali Acc: 0.926 Test Loss: 0.301 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.963249921798706
Epoch: 91, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 1.0291903018951416
Epoch: 92, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.319 Vali Acc: 0.915 Test Loss: 0.319 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 459746
model size : 2.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.721973180770874
Epoch: 1, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.934 Vali Acc: 0.222 Test Loss: 1.934 Test Acc: 0.222
Validation loss decreased (inf --> -0.222203).  Saving model ...
Epoch: 2 cost time: 0.9490633010864258
Epoch: 2, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.915 Vali Acc: 0.226 Test Loss: 1.915 Test Acc: 0.226
Validation loss decreased (-0.222203 --> -0.225907).  Saving model ...
Epoch: 3 cost time: 0.8382937908172607
Epoch: 3, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.898 Vali Acc: 0.230 Test Loss: 1.898 Test Acc: 0.230
Validation loss decreased (-0.225907 --> -0.229611).  Saving model ...
Epoch: 4 cost time: 1.1465446949005127
Epoch: 4, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.878 Vali Acc: 0.230 Test Loss: 1.878 Test Acc: 0.230
Validation loss decreased (-0.229611 --> -0.229611).  Saving model ...
Epoch: 5 cost time: 1.0393569469451904
Epoch: 5, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.854 Vali Acc: 0.241 Test Loss: 1.854 Test Acc: 0.241
Validation loss decreased (-0.229611 --> -0.240722).  Saving model ...
Epoch: 6 cost time: 0.9871678352355957
Epoch: 6, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.828 Vali Acc: 0.237 Test Loss: 1.828 Test Acc: 0.237
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9405961036682129
Epoch: 7, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.802 Vali Acc: 0.307 Test Loss: 1.802 Test Acc: 0.307
Validation loss decreased (-0.240722 --> -0.307389).  Saving model ...
Epoch: 8 cost time: 0.840399980545044
Epoch: 8, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.778 Vali Acc: 0.344 Test Loss: 1.778 Test Acc: 0.344
Validation loss decreased (-0.307389 --> -0.344427).  Saving model ...
Epoch: 9 cost time: 0.8555757999420166
Epoch: 9, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.755 Vali Acc: 0.337 Test Loss: 1.755 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8518097400665283
Epoch: 10, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.733 Vali Acc: 0.330 Test Loss: 1.733 Test Acc: 0.330
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7952234745025635
Epoch: 11, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.711 Vali Acc: 0.326 Test Loss: 1.711 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.8318033218383789
Epoch: 12, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.687 Vali Acc: 0.356 Test Loss: 1.687 Test Acc: 0.356
Validation loss decreased (-0.344427 --> -0.355539).  Saving model ...
Epoch: 13 cost time: 0.9082043170928955
Epoch: 13, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.660 Vali Acc: 0.359 Test Loss: 1.660 Test Acc: 0.359
Validation loss decreased (-0.355539 --> -0.359243).  Saving model ...
Epoch: 14 cost time: 0.8715298175811768
Epoch: 14, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.629 Vali Acc: 0.385 Test Loss: 1.629 Test Acc: 0.385
Validation loss decreased (-0.359243 --> -0.385169).  Saving model ...
Epoch: 15 cost time: 0.997081995010376
Epoch: 15, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.596 Vali Acc: 0.404 Test Loss: 1.596 Test Acc: 0.404
Validation loss decreased (-0.385169 --> -0.403688).  Saving model ...
Epoch: 16 cost time: 0.724449872970581
Epoch: 16, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.560 Vali Acc: 0.448 Test Loss: 1.560 Test Acc: 0.448
Validation loss decreased (-0.403688 --> -0.448133).  Saving model ...
Epoch: 17 cost time: 0.9044387340545654
Epoch: 17, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.522 Vali Acc: 0.493 Test Loss: 1.522 Test Acc: 0.493
Validation loss decreased (-0.448133 --> -0.492577).  Saving model ...
Epoch: 18 cost time: 1.0587172508239746
Epoch: 18, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.482 Vali Acc: 0.537 Test Loss: 1.482 Test Acc: 0.537
Validation loss decreased (-0.492577 --> -0.537022).  Saving model ...
Epoch: 19 cost time: 0.6823482513427734
Epoch: 19, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.442 Vali Acc: 0.578 Test Loss: 1.442 Test Acc: 0.578
Validation loss decreased (-0.537022 --> -0.577763).  Saving model ...
Epoch: 20 cost time: 0.8936700820922852
Epoch: 20, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.397 Vali Acc: 0.667 Test Loss: 1.397 Test Acc: 0.667
Validation loss decreased (-0.577763 --> -0.666653).  Saving model ...
Epoch: 21 cost time: 0.9855625629425049
Epoch: 21, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.351 Vali Acc: 0.719 Test Loss: 1.351 Test Acc: 0.719
Validation loss decreased (-0.666653 --> -0.718505).  Saving model ...
Epoch: 22 cost time: 1.0411343574523926
Epoch: 22, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.304 Vali Acc: 0.770 Test Loss: 1.304 Test Acc: 0.770
Validation loss decreased (-0.718505 --> -0.770357).  Saving model ...
Epoch: 23 cost time: 1.0955891609191895
Epoch: 23, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.256 Vali Acc: 0.796 Test Loss: 1.256 Test Acc: 0.796
Validation loss decreased (-0.770357 --> -0.796284).  Saving model ...
Epoch: 24 cost time: 1.1614766120910645
Epoch: 24, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.208 Vali Acc: 0.811 Test Loss: 1.208 Test Acc: 0.811
Validation loss decreased (-0.796284 --> -0.811099).  Saving model ...
Epoch: 25 cost time: 0.8744635581970215
Epoch: 25, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.162 Vali Acc: 0.804 Test Loss: 1.162 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.2152938842773438
Epoch: 26, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.115 Vali Acc: 0.819 Test Loss: 1.115 Test Acc: 0.819
Validation loss decreased (-0.811099 --> -0.818507).  Saving model ...
Epoch: 27 cost time: 0.9804234504699707
Epoch: 27, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.071 Vali Acc: 0.819 Test Loss: 1.071 Test Acc: 0.819
Validation loss decreased (-0.818507 --> -0.818508).  Saving model ...
Epoch: 28 cost time: 0.8088161945343018
Epoch: 28, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.028 Vali Acc: 0.815 Test Loss: 1.028 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8717827796936035
Epoch: 29, Steps: 2 | Train Loss: 0.926 Vali Loss: 0.985 Vali Acc: 0.826 Test Loss: 0.985 Test Acc: 0.826
Validation loss decreased (-0.818508 --> -0.825916).  Saving model ...
Epoch: 30 cost time: 0.8633663654327393
Epoch: 30, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.944 Vali Acc: 0.830 Test Loss: 0.944 Test Acc: 0.830
Validation loss decreased (-0.825916 --> -0.829620).  Saving model ...
Epoch: 31 cost time: 0.9641177654266357
Epoch: 31, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.903 Vali Acc: 0.844 Test Loss: 0.903 Test Acc: 0.844
Validation loss decreased (-0.829620 --> -0.844435).  Saving model ...
Epoch: 32 cost time: 0.9744462966918945
Epoch: 32, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.865 Vali Acc: 0.856 Test Loss: 0.865 Test Acc: 0.856
Validation loss decreased (-0.844435 --> -0.855547).  Saving model ...
Epoch: 33 cost time: 0.8737037181854248
Epoch: 33, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.829 Vali Acc: 0.881 Test Loss: 0.829 Test Acc: 0.881
Validation loss decreased (-0.855547 --> -0.881473).  Saving model ...
Epoch: 34 cost time: 0.9200575351715088
Epoch: 34, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.798 Vali Acc: 0.893 Test Loss: 0.798 Test Acc: 0.893
Validation loss decreased (-0.881473 --> -0.892585).  Saving model ...
Epoch: 35 cost time: 0.8848698139190674
Epoch: 35, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.769 Vali Acc: 0.893 Test Loss: 0.769 Test Acc: 0.893
Validation loss decreased (-0.892585 --> -0.892585).  Saving model ...
Epoch: 36 cost time: 0.986783504486084
Epoch: 36, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.743 Vali Acc: 0.896 Test Loss: 0.743 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896289).  Saving model ...
Epoch: 37 cost time: 0.974452018737793
Epoch: 37, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.719 Vali Acc: 0.900 Test Loss: 0.719 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 38 cost time: 0.8597095012664795
Epoch: 38, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.701 Vali Acc: 0.874 Test Loss: 0.701 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.1311373710632324
Epoch: 39, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.689 Vali Acc: 0.874 Test Loss: 0.689 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9084362983703613
Epoch: 40, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.681 Vali Acc: 0.867 Test Loss: 0.681 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7330515384674072
Epoch: 41, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.661 Vali Acc: 0.863 Test Loss: 0.661 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8598682880401611
Epoch: 42, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.637 Vali Acc: 0.870 Test Loss: 0.637 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8645904064178467
Epoch: 43, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.615 Vali Acc: 0.896 Test Loss: 0.615 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.0151376724243164
Epoch: 44, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.596 Vali Acc: 0.907 Test Loss: 0.596 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907401).  Saving model ...
Epoch: 45 cost time: 0.7218165397644043
Epoch: 45, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.581 Vali Acc: 0.919 Test Loss: 0.581 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 46 cost time: 0.6757264137268066
Epoch: 46, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.566 Vali Acc: 0.919 Test Loss: 0.566 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 47 cost time: 0.9797637462615967
Epoch: 47, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.553 Vali Acc: 0.911 Test Loss: 0.553 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0410242080688477
Epoch: 48, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.548 Vali Acc: 0.907 Test Loss: 0.548 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.786494255065918
Epoch: 49, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.545 Vali Acc: 0.889 Test Loss: 0.545 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0111956596374512
Epoch: 50, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0753939151763916
Epoch: 51, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.526 Vali Acc: 0.893 Test Loss: 0.526 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8469762802124023
Epoch: 52, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.517 Vali Acc: 0.900 Test Loss: 0.517 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9281463623046875
Epoch: 53, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.505 Vali Acc: 0.896 Test Loss: 0.505 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.9046423435211182
Epoch: 54, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.493 Vali Acc: 0.904 Test Loss: 0.493 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.7959377765655518
Epoch: 55, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.479 Vali Acc: 0.907 Test Loss: 0.479 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.8617603778839111
Epoch: 56, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.473 Vali Acc: 0.907 Test Loss: 0.473 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 311138
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.3809473514556885
Epoch: 1, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.875 Vali Acc: 0.244 Test Loss: 1.875 Test Acc: 0.244
Validation loss decreased (inf --> -0.244426).  Saving model ...
Epoch: 2 cost time: 1.159635305404663
Epoch: 2, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.853 Vali Acc: 0.248 Test Loss: 1.853 Test Acc: 0.248
Validation loss decreased (-0.244426 --> -0.248130).  Saving model ...
Epoch: 3 cost time: 1.1366832256317139
Epoch: 3, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.835 Vali Acc: 0.256 Test Loss: 1.835 Test Acc: 0.256
Validation loss decreased (-0.248130 --> -0.255537).  Saving model ...
Epoch: 4 cost time: 0.9579758644104004
Epoch: 4, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.810 Vali Acc: 0.256 Test Loss: 1.810 Test Acc: 0.256
Validation loss decreased (-0.255537 --> -0.255537).  Saving model ...
Epoch: 5 cost time: 0.9447104930877686
Epoch: 5, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.780 Vali Acc: 0.259 Test Loss: 1.780 Test Acc: 0.259
Validation loss decreased (-0.255537 --> -0.259241).  Saving model ...
Epoch: 6 cost time: 0.8605270385742188
Epoch: 6, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.751 Vali Acc: 0.267 Test Loss: 1.751 Test Acc: 0.267
Validation loss decreased (-0.259241 --> -0.266649).  Saving model ...
Epoch: 7 cost time: 0.9583911895751953
Epoch: 7, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.722 Vali Acc: 0.356 Test Loss: 1.722 Test Acc: 0.356
Validation loss decreased (-0.266649 --> -0.355538).  Saving model ...
Epoch: 8 cost time: 0.953427791595459
Epoch: 8, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.695 Vali Acc: 0.404 Test Loss: 1.695 Test Acc: 0.404
Validation loss decreased (-0.355538 --> -0.403687).  Saving model ...
Epoch: 9 cost time: 0.8920614719390869
Epoch: 9, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.670 Vali Acc: 0.396 Test Loss: 1.670 Test Acc: 0.396
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9987053871154785
Epoch: 10, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.646 Vali Acc: 0.393 Test Loss: 1.646 Test Acc: 0.393
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0467910766601562
Epoch: 11, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.623 Vali Acc: 0.452 Test Loss: 1.623 Test Acc: 0.452
Validation loss decreased (-0.403687 --> -0.451836).  Saving model ...
Epoch: 12 cost time: 1.0278851985931396
Epoch: 12, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.598 Vali Acc: 0.459 Test Loss: 1.598 Test Acc: 0.459
Validation loss decreased (-0.451836 --> -0.459243).  Saving model ...
Epoch: 13 cost time: 1.2816529273986816
Epoch: 13, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.570 Vali Acc: 0.478 Test Loss: 1.570 Test Acc: 0.478
Validation loss decreased (-0.459243 --> -0.477762).  Saving model ...
Epoch: 14 cost time: 0.9386963844299316
Epoch: 14, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.540 Vali Acc: 0.470 Test Loss: 1.540 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3309824466705322
Epoch: 15, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.505 Vali Acc: 0.504 Test Loss: 1.505 Test Acc: 0.504
Validation loss decreased (-0.477762 --> -0.503689).  Saving model ...
Epoch: 16 cost time: 1.0632171630859375
Epoch: 16, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.469 Vali Acc: 0.530 Test Loss: 1.469 Test Acc: 0.530
Validation loss decreased (-0.503689 --> -0.529615).  Saving model ...
Epoch: 17 cost time: 1.143707513809204
Epoch: 17, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.432 Vali Acc: 0.570 Test Loss: 1.432 Test Acc: 0.570
Validation loss decreased (-0.529615 --> -0.570356).  Saving model ...
Epoch: 18 cost time: 1.039377212524414
Epoch: 18, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.394 Vali Acc: 0.596 Test Loss: 1.394 Test Acc: 0.596
Validation loss decreased (-0.570356 --> -0.596282).  Saving model ...
Epoch: 19 cost time: 1.1769676208496094
Epoch: 19, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.352 Vali Acc: 0.633 Test Loss: 1.352 Test Acc: 0.633
Validation loss decreased (-0.596282 --> -0.633320).  Saving model ...
Epoch: 20 cost time: 0.9073960781097412
Epoch: 20, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.309 Vali Acc: 0.641 Test Loss: 1.309 Test Acc: 0.641
Validation loss decreased (-0.633320 --> -0.640728).  Saving model ...
Epoch: 21 cost time: 0.8663160800933838
Epoch: 21, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.264 Vali Acc: 0.667 Test Loss: 1.264 Test Acc: 0.667
Validation loss decreased (-0.640728 --> -0.666654).  Saving model ...
Epoch: 22 cost time: 1.0488128662109375
Epoch: 22, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.220 Vali Acc: 0.696 Test Loss: 1.220 Test Acc: 0.696
Validation loss decreased (-0.666654 --> -0.696284).  Saving model ...
Epoch: 23 cost time: 0.9060184955596924
Epoch: 23, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.179 Vali Acc: 0.700 Test Loss: 1.179 Test Acc: 0.700
Validation loss decreased (-0.696284 --> -0.699988).  Saving model ...
Epoch: 24 cost time: 0.8758218288421631
Epoch: 24, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.138 Vali Acc: 0.733 Test Loss: 1.138 Test Acc: 0.733
Validation loss decreased (-0.699988 --> -0.733322).  Saving model ...
Epoch: 25 cost time: 1.1327590942382812
Epoch: 25, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.097 Vali Acc: 0.741 Test Loss: 1.097 Test Acc: 0.741
Validation loss decreased (-0.733322 --> -0.740730).  Saving model ...
Epoch: 26 cost time: 0.8609070777893066
Epoch: 26, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.054 Vali Acc: 0.752 Test Loss: 1.054 Test Acc: 0.752
Validation loss decreased (-0.740730 --> -0.751841).  Saving model ...
Epoch: 27 cost time: 0.8267679214477539
Epoch: 27, Steps: 2 | Train Loss: 0.937 Vali Loss: 1.014 Vali Acc: 0.763 Test Loss: 1.014 Test Acc: 0.763
Validation loss decreased (-0.751841 --> -0.762953).  Saving model ...
Epoch: 28 cost time: 0.9266297817230225
Epoch: 28, Steps: 2 | Train Loss: 0.916 Vali Loss: 0.974 Vali Acc: 0.789 Test Loss: 0.974 Test Acc: 0.789
Validation loss decreased (-0.762953 --> -0.788879).  Saving model ...
Epoch: 29 cost time: 0.9229824542999268
Epoch: 29, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.936 Vali Acc: 0.796 Test Loss: 0.936 Test Acc: 0.796
Validation loss decreased (-0.788879 --> -0.796287).  Saving model ...
Epoch: 30 cost time: 0.809471607208252
Epoch: 30, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.903 Vali Acc: 0.811 Test Loss: 0.903 Test Acc: 0.811
Validation loss decreased (-0.796287 --> -0.811102).  Saving model ...
Epoch: 31 cost time: 0.923975944519043
Epoch: 31, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.873 Vali Acc: 0.822 Test Loss: 0.873 Test Acc: 0.822
Validation loss decreased (-0.811102 --> -0.822213).  Saving model ...
Epoch: 32 cost time: 0.8964962959289551
Epoch: 32, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.846 Vali Acc: 0.822 Test Loss: 0.846 Test Acc: 0.822
Validation loss decreased (-0.822213 --> -0.822214).  Saving model ...
Epoch: 33 cost time: 0.7740135192871094
Epoch: 33, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.823 Vali Acc: 0.796 Test Loss: 0.823 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.0235450267791748
Epoch: 34, Steps: 2 | Train Loss: 0.712 Vali Loss: 0.802 Vali Acc: 0.785 Test Loss: 0.802 Test Acc: 0.785
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.2261252403259277
Epoch: 35, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.783 Vali Acc: 0.789 Test Loss: 0.783 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9456889629364014
Epoch: 36, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.765 Vali Acc: 0.778 Test Loss: 0.765 Test Acc: 0.778
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.0385503768920898
Epoch: 37, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.744 Vali Acc: 0.789 Test Loss: 0.744 Test Acc: 0.789
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9440774917602539
Epoch: 38, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.724 Vali Acc: 0.796 Test Loss: 0.724 Test Acc: 0.796
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8391594886779785
Epoch: 39, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.706 Vali Acc: 0.807 Test Loss: 0.706 Test Acc: 0.807
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.9025347232818604
Epoch: 40, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.687 Vali Acc: 0.815 Test Loss: 0.687 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.4064514636993408
Epoch: 41, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.669 Vali Acc: 0.830 Test Loss: 0.669 Test Acc: 0.830
Validation loss decreased (-0.822214 --> -0.829623).  Saving model ...
Epoch: 42 cost time: 0.9082074165344238
Epoch: 42, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.652 Vali Acc: 0.848 Test Loss: 0.652 Test Acc: 0.848
Validation loss decreased (-0.829623 --> -0.848142).  Saving model ...
Epoch: 43 cost time: 0.9813148975372314
Epoch: 43, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.637 Vali Acc: 0.852 Test Loss: 0.637 Test Acc: 0.852
Validation loss decreased (-0.848142 --> -0.851845).  Saving model ...
Epoch: 44 cost time: 0.9053878784179688
Epoch: 44, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.626 Vali Acc: 0.841 Test Loss: 0.626 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.941983699798584
Epoch: 45, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.617 Vali Acc: 0.819 Test Loss: 0.617 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8657557964324951
Epoch: 46, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.606 Vali Acc: 0.822 Test Loss: 0.606 Test Acc: 0.822
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9850208759307861
Epoch: 47, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.599 Vali Acc: 0.826 Test Loss: 0.599 Test Acc: 0.826
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 1.0314545631408691
Epoch: 48, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.588 Vali Acc: 0.830 Test Loss: 0.588 Test Acc: 0.830
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 1.104353427886963
Epoch: 49, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.572 Vali Acc: 0.848 Test Loss: 0.572 Test Acc: 0.848
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 1.1334874629974365
Epoch: 50, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.557 Vali Acc: 0.863 Test Loss: 0.557 Test Acc: 0.863
Validation loss decreased (-0.851845 --> -0.862957).  Saving model ...
Epoch: 51 cost time: 1.1935818195343018
Epoch: 51, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.544 Vali Acc: 0.870 Test Loss: 0.544 Test Acc: 0.870
Validation loss decreased (-0.862957 --> -0.870365).  Saving model ...
Epoch: 52 cost time: 0.8131735324859619
Epoch: 52, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.531 Vali Acc: 0.878 Test Loss: 0.531 Test Acc: 0.878
Validation loss decreased (-0.870365 --> -0.877772).  Saving model ...
Epoch: 53 cost time: 0.8599057197570801
Epoch: 53, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.522 Vali Acc: 0.885 Test Loss: 0.522 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885180).  Saving model ...
Epoch: 54 cost time: 1.0322320461273193
Epoch: 54, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.515 Vali Acc: 0.881 Test Loss: 0.515 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 1.093155860900879
Epoch: 55, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.508 Vali Acc: 0.874 Test Loss: 0.508 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.0996999740600586
Epoch: 56, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.503 Vali Acc: 0.867 Test Loss: 0.503 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.9768216609954834
Epoch: 57, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.496 Vali Acc: 0.874 Test Loss: 0.496 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 1.3883986473083496
Epoch: 58, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.488 Vali Acc: 0.885 Test Loss: 0.488 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 59 cost time: 1.2148356437683105
Epoch: 59, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.480 Vali Acc: 0.870 Test Loss: 0.480 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8840548992156982
Epoch: 60, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.472 Vali Acc: 0.874 Test Loss: 0.472 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 1.2949438095092773
Epoch: 61, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.459 Vali Acc: 0.878 Test Loss: 0.459 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.986656665802002
Epoch: 62, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.447 Vali Acc: 0.893 Test Loss: 0.447 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892588).  Saving model ...
Epoch: 63 cost time: 0.797696590423584
Epoch: 63, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.437 Vali Acc: 0.896 Test Loss: 0.437 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 64 cost time: 1.3311643600463867
Epoch: 64, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.428 Vali Acc: 0.907 Test Loss: 0.428 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907403).  Saving model ...
Epoch: 65 cost time: 1.2686591148376465
Epoch: 65, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.427 Vali Acc: 0.904 Test Loss: 0.427 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9332263469696045
Epoch: 66, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.428 Vali Acc: 0.904 Test Loss: 0.428 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.906489372253418
Epoch: 67, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.426 Vali Acc: 0.904 Test Loss: 0.426 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.8926055431365967
Epoch: 68, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.0049662590026855
Epoch: 69, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.420 Vali Acc: 0.896 Test Loss: 0.420 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.8909990787506104
Epoch: 70, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.415 Vali Acc: 0.900 Test Loss: 0.415 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 1.1358320713043213
Epoch: 71, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.403 Vali Acc: 0.907 Test Loss: 0.403 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 72 cost time: 1.1792325973510742
Epoch: 72, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.388 Vali Acc: 0.904 Test Loss: 0.388 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 1.0121979713439941
Epoch: 73, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.377 Vali Acc: 0.907 Test Loss: 0.377 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 74 cost time: 0.8944716453552246
Epoch: 74, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.370 Vali Acc: 0.915 Test Loss: 0.370 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914811).  Saving model ...
Epoch: 75 cost time: 0.821925163269043
Epoch: 75, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.362 Vali Acc: 0.919 Test Loss: 0.362 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 76 cost time: 1.031268835067749
Epoch: 76, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.358 Vali Acc: 0.911 Test Loss: 0.358 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.1074588298797607
Epoch: 77, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.357 Vali Acc: 0.911 Test Loss: 0.357 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.8467659950256348
Epoch: 78, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.357 Vali Acc: 0.911 Test Loss: 0.357 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.0903983116149902
Epoch: 79, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.354 Vali Acc: 0.919 Test Loss: 0.354 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 80 cost time: 1.385847568511963
Epoch: 80, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.347 Vali Acc: 0.919 Test Loss: 0.347 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 81 cost time: 0.9399147033691406
Epoch: 81, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.338 Vali Acc: 0.933 Test Loss: 0.338 Test Acc: 0.933
Validation loss decreased (-0.918515 --> -0.933330).  Saving model ...
Epoch: 82 cost time: 1.0445225238800049
Epoch: 82, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.332 Vali Acc: 0.926 Test Loss: 0.332 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.1988134384155273
Epoch: 83, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.329 Vali Acc: 0.930 Test Loss: 0.329 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.9432992935180664
Epoch: 84, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.325 Vali Acc: 0.930 Test Loss: 0.325 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.8359756469726562
Epoch: 85, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 1.0717573165893555
Epoch: 86, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 1.0197043418884277
Epoch: 87, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 1.1553175449371338
Epoch: 88, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.9652962684631348
Epoch: 89, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.314 Vali Acc: 0.933 Test Loss: 0.314 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 90 cost time: 0.9015898704528809
Epoch: 90, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 91 cost time: 0.9583930969238281
Epoch: 91, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.304 Vali Acc: 0.933 Test Loss: 0.304 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 92 cost time: 1.0031712055206299
Epoch: 92, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 93 cost time: 1.1598529815673828
Epoch: 93, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 94 cost time: 1.1845479011535645
Epoch: 94, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 1.0062363147735596
Epoch: 95, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 96 cost time: 0.8789019584655762
Epoch: 96, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 97 cost time: 1.0169651508331299
Epoch: 97, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 98 cost time: 0.9493210315704346
Epoch: 98, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.283 Vali Acc: 0.952 Test Loss: 0.283 Test Acc: 0.952
Validation loss decreased (-0.944442 --> -0.951849).  Saving model ...
Epoch: 99 cost time: 0.9928672313690186
Epoch: 99, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.279 Vali Acc: 0.952 Test Loss: 0.279 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 100 cost time: 1.3089473247528076
Epoch: 100, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.279 Vali Acc: 0.952 Test Loss: 0.279 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 310754
model size : 1.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.178316593170166
Epoch: 1, Steps: 2 | Train Loss: 1.964 Vali Loss: 1.833 Vali Acc: 0.174 Test Loss: 1.833 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.9699292182922363
Epoch: 2, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.820 Vali Acc: 0.178 Test Loss: 1.820 Test Acc: 0.178
Validation loss decreased (-0.174056 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.9098379611968994
Epoch: 3, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.807 Vali Acc: 0.178 Test Loss: 1.807 Test Acc: 0.178
Validation loss decreased (-0.177760 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 0.8379876613616943
Epoch: 4, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.790 Vali Acc: 0.181 Test Loss: 1.790 Test Acc: 0.181
Validation loss decreased (-0.177760 --> -0.181464).  Saving model ...
Epoch: 5 cost time: 1.0270545482635498
Epoch: 5, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.771 Vali Acc: 0.181 Test Loss: 1.771 Test Acc: 0.181
Validation loss decreased (-0.181464 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.8345539569854736
Epoch: 6, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.750 Vali Acc: 0.211 Test Loss: 1.750 Test Acc: 0.211
Validation loss decreased (-0.181464 --> -0.211094).  Saving model ...
Epoch: 7 cost time: 1.0829575061798096
Epoch: 7, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.729 Vali Acc: 0.267 Test Loss: 1.729 Test Acc: 0.267
Validation loss decreased (-0.211094 --> -0.266649).  Saving model ...
Epoch: 8 cost time: 1.0999443531036377
Epoch: 8, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.708 Vali Acc: 0.281 Test Loss: 1.708 Test Acc: 0.281
Validation loss decreased (-0.266649 --> -0.281464).  Saving model ...
Epoch: 9 cost time: 1.1945278644561768
Epoch: 9, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.689 Vali Acc: 0.278 Test Loss: 1.689 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0842955112457275
Epoch: 10, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.668 Vali Acc: 0.344 Test Loss: 1.668 Test Acc: 0.344
Validation loss decreased (-0.281464 --> -0.344428).  Saving model ...
Epoch: 11 cost time: 0.8438069820404053
Epoch: 11, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.645 Vali Acc: 0.396 Test Loss: 1.645 Test Acc: 0.396
Validation loss decreased (-0.344428 --> -0.396280).  Saving model ...
Epoch: 12 cost time: 1.0114498138427734
Epoch: 12, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.622 Vali Acc: 0.441 Test Loss: 1.622 Test Acc: 0.441
Validation loss decreased (-0.396280 --> -0.440725).  Saving model ...
Epoch: 13 cost time: 0.9856634140014648
Epoch: 13, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.596 Vali Acc: 0.485 Test Loss: 1.596 Test Acc: 0.485
Validation loss decreased (-0.440725 --> -0.485169).  Saving model ...
Epoch: 14 cost time: 0.9461095333099365
Epoch: 14, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.569 Vali Acc: 0.552 Test Loss: 1.569 Test Acc: 0.552
Validation loss decreased (-0.485169 --> -0.551836).  Saving model ...
Epoch: 15 cost time: 0.9626407623291016
Epoch: 15, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.539 Vali Acc: 0.585 Test Loss: 1.539 Test Acc: 0.585
Validation loss decreased (-0.551836 --> -0.585170).  Saving model ...
Epoch: 16 cost time: 1.0902502536773682
Epoch: 16, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.505 Vali Acc: 0.622 Test Loss: 1.505 Test Acc: 0.622
Validation loss decreased (-0.585170 --> -0.622207).  Saving model ...
Epoch: 17 cost time: 1.0947985649108887
Epoch: 17, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.468 Vali Acc: 0.648 Test Loss: 1.468 Test Acc: 0.648
Validation loss decreased (-0.622207 --> -0.648133).  Saving model ...
Epoch: 18 cost time: 0.8834190368652344
Epoch: 18, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.428 Vali Acc: 0.670 Test Loss: 1.428 Test Acc: 0.670
Validation loss decreased (-0.648133 --> -0.670356).  Saving model ...
Epoch: 19 cost time: 1.0078437328338623
Epoch: 19, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.386 Vali Acc: 0.704 Test Loss: 1.386 Test Acc: 0.704
Validation loss decreased (-0.670356 --> -0.703690).  Saving model ...
Epoch: 20 cost time: 0.8237082958221436
Epoch: 20, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.340 Vali Acc: 0.730 Test Loss: 1.340 Test Acc: 0.730
Validation loss decreased (-0.703690 --> -0.729616).  Saving model ...
Epoch: 21 cost time: 0.7943689823150635
Epoch: 21, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.294 Vali Acc: 0.767 Test Loss: 1.294 Test Acc: 0.767
Validation loss decreased (-0.729616 --> -0.766654).  Saving model ...
Epoch: 22 cost time: 0.8370652198791504
Epoch: 22, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.247 Vali Acc: 0.767 Test Loss: 1.247 Test Acc: 0.767
Validation loss decreased (-0.766654 --> -0.766654).  Saving model ...
Epoch: 23 cost time: 0.9294471740722656
Epoch: 23, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.200 Vali Acc: 0.774 Test Loss: 1.200 Test Acc: 0.774
Validation loss decreased (-0.766654 --> -0.774062).  Saving model ...
Epoch: 24 cost time: 0.9431443214416504
Epoch: 24, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.154 Vali Acc: 0.774 Test Loss: 1.154 Test Acc: 0.774
Validation loss decreased (-0.774062 --> -0.774063).  Saving model ...
Epoch: 25 cost time: 0.9983303546905518
Epoch: 25, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.109 Vali Acc: 0.778 Test Loss: 1.109 Test Acc: 0.778
Validation loss decreased (-0.774063 --> -0.777767).  Saving model ...
Epoch: 26 cost time: 0.8090829849243164
Epoch: 26, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.065 Vali Acc: 0.774 Test Loss: 1.065 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.968397855758667
Epoch: 27, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.023 Vali Acc: 0.781 Test Loss: 1.023 Test Acc: 0.781
Validation loss decreased (-0.777767 --> -0.781471).  Saving model ...
Epoch: 28 cost time: 0.8492569923400879
Epoch: 28, Steps: 2 | Train Loss: 0.939 Vali Loss: 0.983 Vali Acc: 0.785 Test Loss: 0.983 Test Acc: 0.785
Validation loss decreased (-0.781471 --> -0.785175).  Saving model ...
Epoch: 29 cost time: 1.0880389213562012
Epoch: 29, Steps: 2 | Train Loss: 0.986 Vali Loss: 0.944 Vali Acc: 0.819 Test Loss: 0.944 Test Acc: 0.819
Validation loss decreased (-0.785175 --> -0.818509).  Saving model ...
Epoch: 30 cost time: 0.9205899238586426
Epoch: 30, Steps: 2 | Train Loss: 0.959 Vali Loss: 0.907 Vali Acc: 0.830 Test Loss: 0.907 Test Acc: 0.830
Validation loss decreased (-0.818509 --> -0.829621).  Saving model ...
Epoch: 31 cost time: 0.8187189102172852
Epoch: 31, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.874 Vali Acc: 0.833 Test Loss: 0.874 Test Acc: 0.833
Validation loss decreased (-0.829621 --> -0.833325).  Saving model ...
Epoch: 32 cost time: 0.9092521667480469
Epoch: 32, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.842 Vali Acc: 0.841 Test Loss: 0.842 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840732).  Saving model ...
Epoch: 33 cost time: 0.8333287239074707
Epoch: 33, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.814 Vali Acc: 0.848 Test Loss: 0.814 Test Acc: 0.848
Validation loss decreased (-0.840732 --> -0.848140).  Saving model ...
Epoch: 34 cost time: 0.9430701732635498
Epoch: 34, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.787 Vali Acc: 0.863 Test Loss: 0.787 Test Acc: 0.863
Validation loss decreased (-0.848140 --> -0.862955).  Saving model ...
Epoch: 35 cost time: 0.932356595993042
Epoch: 35, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.760 Vali Acc: 0.859 Test Loss: 0.760 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7675266265869141
Epoch: 36, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.735 Vali Acc: 0.863 Test Loss: 0.735 Test Acc: 0.863
Validation loss decreased (-0.862955 --> -0.862956).  Saving model ...
Epoch: 37 cost time: 1.0718600749969482
Epoch: 37, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.712 Vali Acc: 0.863 Test Loss: 0.712 Test Acc: 0.863
Validation loss decreased (-0.862956 --> -0.862956).  Saving model ...
Epoch: 38 cost time: 0.7886674404144287
Epoch: 38, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.690 Vali Acc: 0.870 Test Loss: 0.690 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870363).  Saving model ...
Epoch: 39 cost time: 0.9503958225250244
Epoch: 39, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.670 Vali Acc: 0.870 Test Loss: 0.670 Test Acc: 0.870
Validation loss decreased (-0.870363 --> -0.870364).  Saving model ...
Epoch: 40 cost time: 0.9112474918365479
Epoch: 40, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.652 Vali Acc: 0.874 Test Loss: 0.652 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 41 cost time: 0.9391462802886963
Epoch: 41, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.636 Vali Acc: 0.870 Test Loss: 0.636 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.9953737258911133
Epoch: 42, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.623 Vali Acc: 0.885 Test Loss: 0.623 Test Acc: 0.885
Validation loss decreased (-0.874068 --> -0.885179).  Saving model ...
Epoch: 43 cost time: 0.8521206378936768
Epoch: 43, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.612 Vali Acc: 0.881 Test Loss: 0.612 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.3261547088623047
Epoch: 44, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.599 Vali Acc: 0.881 Test Loss: 0.599 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9503135681152344
Epoch: 45, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.588 Vali Acc: 0.874 Test Loss: 0.588 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0379674434661865
Epoch: 46, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.575 Vali Acc: 0.867 Test Loss: 0.575 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9363677501678467
Epoch: 47, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.562 Vali Acc: 0.867 Test Loss: 0.562 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0238025188446045
Epoch: 48, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.549 Vali Acc: 0.889 Test Loss: 0.549 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 49 cost time: 1.0871915817260742
Epoch: 49, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.541 Vali Acc: 0.885 Test Loss: 0.541 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.835991621017456
Epoch: 50, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.533 Vali Acc: 0.885 Test Loss: 0.533 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.810976505279541
Epoch: 51, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.521 Vali Acc: 0.889 Test Loss: 0.521 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 52 cost time: 0.9955170154571533
Epoch: 52, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.510 Vali Acc: 0.896 Test Loss: 0.510 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896291).  Saving model ...
Epoch: 53 cost time: 0.9631381034851074
Epoch: 53, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.504 Vali Acc: 0.893 Test Loss: 0.504 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8846747875213623
Epoch: 54, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.500 Vali Acc: 0.889 Test Loss: 0.500 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8928639888763428
Epoch: 55, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9459202289581299
Epoch: 56, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.506 Vali Acc: 0.870 Test Loss: 0.506 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9062573909759521
Epoch: 57, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.496 Vali Acc: 0.878 Test Loss: 0.496 Test Acc: 0.878
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.0542514324188232
Epoch: 58, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.476 Vali Acc: 0.900 Test Loss: 0.476 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 59 cost time: 0.9526751041412354
Epoch: 59, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.460 Vali Acc: 0.911 Test Loss: 0.460 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911107).  Saving model ...
Epoch: 60 cost time: 0.8775203227996826
Epoch: 60, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.451 Vali Acc: 0.911 Test Loss: 0.451 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 61 cost time: 0.9115149974822998
Epoch: 61, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.447 Vali Acc: 0.896 Test Loss: 0.447 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9711828231811523
Epoch: 62, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.447 Vali Acc: 0.893 Test Loss: 0.447 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.0671205520629883
Epoch: 63, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.454 Vali Acc: 0.881 Test Loss: 0.454 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8203375339508057
Epoch: 64, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.444 Vali Acc: 0.889 Test Loss: 0.444 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.8351860046386719
Epoch: 65, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.9764370918273926
Epoch: 66, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.434 Vali Acc: 0.893 Test Loss: 0.434 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.968735933303833
Epoch: 67, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.431 Vali Acc: 0.896 Test Loss: 0.431 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.8468728065490723
Epoch: 68, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.7437114715576172
Epoch: 69, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.428 Vali Acc: 0.896 Test Loss: 0.428 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.9999830722808838
Epoch: 70, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 310370
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5066397190093994
Epoch: 1, Steps: 2 | Train Loss: 2.127 Vali Loss: 2.090 Vali Acc: 0.185 Test Loss: 2.090 Test Acc: 0.185
Validation loss decreased (inf --> -0.185164).  Saving model ...
Epoch: 2 cost time: 0.8198187351226807
Epoch: 2, Steps: 2 | Train Loss: 2.084 Vali Loss: 2.065 Vali Acc: 0.193 Test Loss: 2.065 Test Acc: 0.193
Validation loss decreased (-0.185164 --> -0.192572).  Saving model ...
Epoch: 3 cost time: 0.8876099586486816
Epoch: 3, Steps: 2 | Train Loss: 2.061 Vali Loss: 2.042 Vali Acc: 0.196 Test Loss: 2.042 Test Acc: 0.196
Validation loss decreased (-0.192572 --> -0.196276).  Saving model ...
Epoch: 4 cost time: 0.8303329944610596
Epoch: 4, Steps: 2 | Train Loss: 2.113 Vali Loss: 2.012 Vali Acc: 0.207 Test Loss: 2.012 Test Acc: 0.207
Validation loss decreased (-0.196276 --> -0.207387).  Saving model ...
Epoch: 5 cost time: 0.8540389537811279
Epoch: 5, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.976 Vali Acc: 0.219 Test Loss: 1.976 Test Acc: 0.219
Validation loss decreased (-0.207387 --> -0.218499).  Saving model ...
Epoch: 6 cost time: 0.9691786766052246
Epoch: 6, Steps: 2 | Train Loss: 2.079 Vali Loss: 1.936 Vali Acc: 0.237 Test Loss: 1.936 Test Acc: 0.237
Validation loss decreased (-0.218499 --> -0.237018).  Saving model ...
Epoch: 7 cost time: 0.9099812507629395
Epoch: 7, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.894 Vali Acc: 0.241 Test Loss: 1.894 Test Acc: 0.241
Validation loss decreased (-0.237018 --> -0.240722).  Saving model ...
Epoch: 8 cost time: 0.9493362903594971
Epoch: 8, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.852 Vali Acc: 0.219 Test Loss: 1.852 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0214555263519287
Epoch: 9, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.812 Vali Acc: 0.263 Test Loss: 1.812 Test Acc: 0.263
Validation loss decreased (-0.240722 --> -0.262945).  Saving model ...
Epoch: 10 cost time: 1.0019416809082031
Epoch: 10, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.775 Vali Acc: 0.363 Test Loss: 1.775 Test Acc: 0.363
Validation loss decreased (-0.262945 --> -0.362945).  Saving model ...
Epoch: 11 cost time: 0.8040707111358643
Epoch: 11, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.743 Vali Acc: 0.411 Test Loss: 1.743 Test Acc: 0.411
Validation loss decreased (-0.362945 --> -0.411094).  Saving model ...
Epoch: 12 cost time: 1.0044660568237305
Epoch: 12, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.715 Vali Acc: 0.404 Test Loss: 1.715 Test Acc: 0.404
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0616235733032227
Epoch: 13, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.690 Vali Acc: 0.415 Test Loss: 1.690 Test Acc: 0.415
Validation loss decreased (-0.411094 --> -0.414798).  Saving model ...
Epoch: 14 cost time: 0.9581358432769775
Epoch: 14, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.665 Vali Acc: 0.419 Test Loss: 1.665 Test Acc: 0.419
Validation loss decreased (-0.414798 --> -0.418502).  Saving model ...
Epoch: 15 cost time: 0.9237220287322998
Epoch: 15, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.639 Vali Acc: 0.415 Test Loss: 1.639 Test Acc: 0.415
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9805552959442139
Epoch: 16, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.613 Vali Acc: 0.448 Test Loss: 1.613 Test Acc: 0.448
Validation loss decreased (-0.418502 --> -0.448132).  Saving model ...
Epoch: 17 cost time: 0.9940361976623535
Epoch: 17, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.586 Vali Acc: 0.478 Test Loss: 1.586 Test Acc: 0.478
Validation loss decreased (-0.448132 --> -0.477762).  Saving model ...
Epoch: 18 cost time: 0.7644343376159668
Epoch: 18, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.555 Vali Acc: 0.522 Test Loss: 1.555 Test Acc: 0.522
Validation loss decreased (-0.477762 --> -0.522207).  Saving model ...
Epoch: 19 cost time: 0.9165489673614502
Epoch: 19, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.522 Vali Acc: 0.530 Test Loss: 1.522 Test Acc: 0.530
Validation loss decreased (-0.522207 --> -0.529614).  Saving model ...
Epoch: 20 cost time: 0.9254879951477051
Epoch: 20, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.486 Vali Acc: 0.537 Test Loss: 1.486 Test Acc: 0.537
Validation loss decreased (-0.529614 --> -0.537022).  Saving model ...
Epoch: 21 cost time: 0.8988680839538574
Epoch: 21, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.450 Vali Acc: 0.563 Test Loss: 1.450 Test Acc: 0.563
Validation loss decreased (-0.537022 --> -0.562948).  Saving model ...
Epoch: 22 cost time: 0.7498927116394043
Epoch: 22, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.411 Vali Acc: 0.607 Test Loss: 1.411 Test Acc: 0.607
Validation loss decreased (-0.562948 --> -0.607393).  Saving model ...
Epoch: 23 cost time: 0.8359854221343994
Epoch: 23, Steps: 2 | Train Loss: 1.389 Vali Loss: 1.369 Vali Acc: 0.641 Test Loss: 1.369 Test Acc: 0.641
Validation loss decreased (-0.607393 --> -0.640727).  Saving model ...
Epoch: 24 cost time: 0.8523204326629639
Epoch: 24, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.326 Vali Acc: 0.689 Test Loss: 1.326 Test Acc: 0.689
Validation loss decreased (-0.640727 --> -0.688876).  Saving model ...
Epoch: 25 cost time: 0.7872004508972168
Epoch: 25, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.280 Vali Acc: 0.711 Test Loss: 1.280 Test Acc: 0.711
Validation loss decreased (-0.688876 --> -0.711098).  Saving model ...
Epoch: 26 cost time: 0.9417786598205566
Epoch: 26, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.234 Vali Acc: 0.707 Test Loss: 1.234 Test Acc: 0.707
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9579265117645264
Epoch: 27, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.189 Vali Acc: 0.707 Test Loss: 1.189 Test Acc: 0.707
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9227790832519531
Epoch: 28, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.143 Vali Acc: 0.715 Test Loss: 1.143 Test Acc: 0.715
Validation loss decreased (-0.711098 --> -0.714803).  Saving model ...
Epoch: 29 cost time: 0.9177408218383789
Epoch: 29, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.098 Vali Acc: 0.722 Test Loss: 1.098 Test Acc: 0.722
Validation loss decreased (-0.714803 --> -0.722211).  Saving model ...
Epoch: 30 cost time: 0.8574602603912354
Epoch: 30, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.058 Vali Acc: 0.733 Test Loss: 1.058 Test Acc: 0.733
Validation loss decreased (-0.722211 --> -0.733323).  Saving model ...
Epoch: 31 cost time: 0.7705698013305664
Epoch: 31, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.021 Vali Acc: 0.744 Test Loss: 1.021 Test Acc: 0.744
Validation loss decreased (-0.733323 --> -0.744434).  Saving model ...
Epoch: 32 cost time: 0.8939857482910156
Epoch: 32, Steps: 2 | Train Loss: 0.929 Vali Loss: 0.985 Vali Acc: 0.770 Test Loss: 0.985 Test Acc: 0.770
Validation loss decreased (-0.744434 --> -0.770361).  Saving model ...
Epoch: 33 cost time: 0.7827458381652832
Epoch: 33, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.951 Vali Acc: 0.785 Test Loss: 0.951 Test Acc: 0.785
Validation loss decreased (-0.770361 --> -0.785176).  Saving model ...
Epoch: 34 cost time: 1.0656604766845703
Epoch: 34, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.919 Vali Acc: 0.796 Test Loss: 0.919 Test Acc: 0.796
Validation loss decreased (-0.785176 --> -0.796287).  Saving model ...
Epoch: 35 cost time: 0.8250977993011475
Epoch: 35, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.889 Vali Acc: 0.800 Test Loss: 0.889 Test Acc: 0.800
Validation loss decreased (-0.796287 --> -0.799991).  Saving model ...
Epoch: 36 cost time: 0.7323498725891113
Epoch: 36, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.859 Vali Acc: 0.811 Test Loss: 0.859 Test Acc: 0.811
Validation loss decreased (-0.799991 --> -0.811103).  Saving model ...
Epoch: 37 cost time: 0.9205305576324463
Epoch: 37, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.832 Vali Acc: 0.811 Test Loss: 0.832 Test Acc: 0.811
Validation loss decreased (-0.811103 --> -0.811103).  Saving model ...
Epoch: 38 cost time: 1.0140292644500732
Epoch: 38, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.806 Vali Acc: 0.819 Test Loss: 0.806 Test Acc: 0.819
Validation loss decreased (-0.811103 --> -0.818510).  Saving model ...
Epoch: 39 cost time: 0.823448657989502
Epoch: 39, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.781 Vali Acc: 0.826 Test Loss: 0.781 Test Acc: 0.826
Validation loss decreased (-0.818510 --> -0.825918).  Saving model ...
Epoch: 40 cost time: 0.8234429359436035
Epoch: 40, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.759 Vali Acc: 0.830 Test Loss: 0.759 Test Acc: 0.830
Validation loss decreased (-0.825918 --> -0.829622).  Saving model ...
Epoch: 41 cost time: 0.7955009937286377
Epoch: 41, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.737 Vali Acc: 0.837 Test Loss: 0.737 Test Acc: 0.837
Validation loss decreased (-0.829622 --> -0.837030).  Saving model ...
Epoch: 42 cost time: 0.8818790912628174
Epoch: 42, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.713 Vali Acc: 0.848 Test Loss: 0.713 Test Acc: 0.848
Validation loss decreased (-0.837030 --> -0.848141).  Saving model ...
Epoch: 43 cost time: 0.7672684192657471
Epoch: 43, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.691 Vali Acc: 0.852 Test Loss: 0.691 Test Acc: 0.852
Validation loss decreased (-0.848141 --> -0.851845).  Saving model ...
Epoch: 44 cost time: 1.0198256969451904
Epoch: 44, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.669 Vali Acc: 0.852 Test Loss: 0.669 Test Acc: 0.852
Validation loss decreased (-0.851845 --> -0.851845).  Saving model ...
Epoch: 45 cost time: 1.0618252754211426
Epoch: 45, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.651 Vali Acc: 0.867 Test Loss: 0.651 Test Acc: 0.867
Validation loss decreased (-0.851845 --> -0.866660).  Saving model ...
Epoch: 46 cost time: 1.000694751739502
Epoch: 46, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.630 Vali Acc: 0.870 Test Loss: 0.630 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 47 cost time: 0.9357342720031738
Epoch: 47, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.610 Vali Acc: 0.874 Test Loss: 0.610 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 48 cost time: 0.8247058391571045
Epoch: 48, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.596 Vali Acc: 0.885 Test Loss: 0.596 Test Acc: 0.885
Validation loss decreased (-0.874068 --> -0.885179).  Saving model ...
Epoch: 49 cost time: 0.773996114730835
Epoch: 49, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.584 Vali Acc: 0.885 Test Loss: 0.584 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 50 cost time: 1.195131540298462
Epoch: 50, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.575 Vali Acc: 0.885 Test Loss: 0.575 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 51 cost time: 0.9543464183807373
Epoch: 51, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.560 Vali Acc: 0.881 Test Loss: 0.560 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8391122817993164
Epoch: 52, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.544 Vali Acc: 0.885 Test Loss: 0.544 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885180).  Saving model ...
Epoch: 53 cost time: 0.9099793434143066
Epoch: 53, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.535 Vali Acc: 0.878 Test Loss: 0.535 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.068638563156128
Epoch: 54, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.526 Vali Acc: 0.885 Test Loss: 0.526 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 55 cost time: 0.85414719581604
Epoch: 55, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.509 Vali Acc: 0.896 Test Loss: 0.509 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896291).  Saving model ...
Epoch: 56 cost time: 0.9791638851165771
Epoch: 56, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.493 Vali Acc: 0.911 Test Loss: 0.493 Test Acc: 0.911
Validation loss decreased (-0.896291 --> -0.911106).  Saving model ...
Epoch: 57 cost time: 0.8616302013397217
Epoch: 57, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.480 Vali Acc: 0.911 Test Loss: 0.480 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 58 cost time: 1.0242629051208496
Epoch: 58, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.469 Vali Acc: 0.911 Test Loss: 0.469 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 59 cost time: 1.2566587924957275
Epoch: 59, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.460 Vali Acc: 0.919 Test Loss: 0.460 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 60 cost time: 1.193676233291626
Epoch: 60, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.452 Vali Acc: 0.922 Test Loss: 0.452 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 61 cost time: 0.8346643447875977
Epoch: 61, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.444 Vali Acc: 0.915 Test Loss: 0.444 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 1.0151426792144775
Epoch: 62, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.438 Vali Acc: 0.915 Test Loss: 0.438 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.9142653942108154
Epoch: 63, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.431 Vali Acc: 0.915 Test Loss: 0.431 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.9364287853240967
Epoch: 64, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.425 Vali Acc: 0.915 Test Loss: 0.425 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 1.0525531768798828
Epoch: 65, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.413 Vali Acc: 0.915 Test Loss: 0.413 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.8281309604644775
Epoch: 66, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.399 Vali Acc: 0.922 Test Loss: 0.399 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 67 cost time: 0.9556879997253418
Epoch: 67, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.391 Vali Acc: 0.930 Test Loss: 0.391 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 68 cost time: 0.826777458190918
Epoch: 68, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.390 Vali Acc: 0.922 Test Loss: 0.390 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.1189589500427246
Epoch: 69, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.387 Vali Acc: 0.922 Test Loss: 0.387 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.9692866802215576
Epoch: 70, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.380 Vali Acc: 0.930 Test Loss: 0.380 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 71 cost time: 0.8744354248046875
Epoch: 71, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.375 Vali Acc: 0.922 Test Loss: 0.375 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.8814692497253418
Epoch: 72, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.368 Vali Acc: 0.926 Test Loss: 0.368 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.8745436668395996
Epoch: 73, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.362 Vali Acc: 0.933 Test Loss: 0.362 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 74 cost time: 0.9194672107696533
Epoch: 74, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.357 Vali Acc: 0.933 Test Loss: 0.357 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 75 cost time: 1.1128385066986084
Epoch: 75, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8230307102203369
Epoch: 76, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.350 Vali Acc: 0.922 Test Loss: 0.350 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.8192696571350098
Epoch: 77, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.345 Vali Acc: 0.926 Test Loss: 0.345 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.829326868057251
Epoch: 78, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.337 Vali Acc: 0.930 Test Loss: 0.337 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.7536020278930664
Epoch: 79, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.333 Vali Acc: 0.930 Test Loss: 0.333 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.7842679023742676
Epoch: 80, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.333 Vali Acc: 0.930 Test Loss: 0.333 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.8251631259918213
Epoch: 81, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.330 Vali Acc: 0.930 Test Loss: 0.330 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 1.0337574481964111
Epoch: 82, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.327 Vali Acc: 0.933 Test Loss: 0.327 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 83 cost time: 1.1418616771697998
Epoch: 83, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.325 Vali Acc: 0.937 Test Loss: 0.325 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 84 cost time: 0.8553197383880615
Epoch: 84, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.327 Vali Acc: 0.933 Test Loss: 0.327 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 1.0238919258117676
Epoch: 85, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.326 Vali Acc: 0.930 Test Loss: 0.326 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.8285911083221436
Epoch: 86, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.318 Vali Acc: 0.933 Test Loss: 0.318 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.9211435317993164
Epoch: 87, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 1.1141574382781982
Epoch: 88, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 1.0173447132110596
Epoch: 89, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.298 Vali Acc: 0.937 Test Loss: 0.298 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 90 cost time: 0.8638918399810791
Epoch: 90, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.9219937324523926
Epoch: 91, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.310 Vali Acc: 0.933 Test Loss: 0.310 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 1.0409417152404785
Epoch: 92, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.313 Vali Acc: 0.926 Test Loss: 0.313 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.9584894180297852
Epoch: 93, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.9938211441040039
Epoch: 94, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.300 Vali Acc: 0.941 Test Loss: 0.300 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 95 cost time: 0.8854148387908936
Epoch: 95, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.290 Vali Acc: 0.937 Test Loss: 0.290 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.9192140102386475
Epoch: 96, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 97 cost time: 0.906658411026001
Epoch: 97, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 98 cost time: 1.1175479888916016
Epoch: 98, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 99 cost time: 0.8596165180206299
Epoch: 99, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 100 cost time: 0.7584006786346436
Epoch: 100, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.288 Vali Acc: 0.933 Test Loss: 0.288 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 309986
model size : 1.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9085166454315186
Epoch: 1, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.888 Vali Acc: 0.167 Test Loss: 1.888 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.7521374225616455
Epoch: 2, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.865 Vali Acc: 0.167 Test Loss: 1.865 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.9662256240844727
Epoch: 3, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.849 Vali Acc: 0.167 Test Loss: 1.849 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 4 cost time: 1.016035795211792
Epoch: 4, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.830 Vali Acc: 0.163 Test Loss: 1.830 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9124562740325928
Epoch: 5, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.809 Vali Acc: 0.159 Test Loss: 1.809 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.9735848903656006
Epoch: 6, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.788 Vali Acc: 0.159 Test Loss: 1.788 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.891082763671875
Epoch: 7, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.768 Vali Acc: 0.170 Test Loss: 1.768 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170353).  Saving model ...
Epoch: 8 cost time: 0.843531608581543
Epoch: 8, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.748 Vali Acc: 0.267 Test Loss: 1.748 Test Acc: 0.267
Validation loss decreased (-0.170353 --> -0.266649).  Saving model ...
Epoch: 9 cost time: 0.9811522960662842
Epoch: 9, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.728 Vali Acc: 0.315 Test Loss: 1.728 Test Acc: 0.315
Validation loss decreased (-0.266649 --> -0.314798).  Saving model ...
Epoch: 10 cost time: 0.9425225257873535
Epoch: 10, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.709 Vali Acc: 0.330 Test Loss: 1.709 Test Acc: 0.330
Validation loss decreased (-0.314798 --> -0.329613).  Saving model ...
Epoch: 11 cost time: 0.7376558780670166
Epoch: 11, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.689 Vali Acc: 0.348 Test Loss: 1.689 Test Acc: 0.348
Validation loss decreased (-0.329613 --> -0.348131).  Saving model ...
Epoch: 12 cost time: 0.8443973064422607
Epoch: 12, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.667 Vali Acc: 0.370 Test Loss: 1.667 Test Acc: 0.370
Validation loss decreased (-0.348131 --> -0.370354).  Saving model ...
Epoch: 13 cost time: 1.041501760482788
Epoch: 13, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.644 Vali Acc: 0.404 Test Loss: 1.644 Test Acc: 0.404
Validation loss decreased (-0.370354 --> -0.403687).  Saving model ...
Epoch: 14 cost time: 0.8560531139373779
Epoch: 14, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.618 Vali Acc: 0.433 Test Loss: 1.618 Test Acc: 0.433
Validation loss decreased (-0.403687 --> -0.433317).  Saving model ...
Epoch: 15 cost time: 1.0819408893585205
Epoch: 15, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.591 Vali Acc: 0.496 Test Loss: 1.591 Test Acc: 0.496
Validation loss decreased (-0.433317 --> -0.496280).  Saving model ...
Epoch: 16 cost time: 0.8165910243988037
Epoch: 16, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.564 Vali Acc: 0.544 Test Loss: 1.564 Test Acc: 0.544
Validation loss decreased (-0.496280 --> -0.544429).  Saving model ...
Epoch: 17 cost time: 0.9432797431945801
Epoch: 17, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.534 Vali Acc: 0.604 Test Loss: 1.534 Test Acc: 0.604
Validation loss decreased (-0.544429 --> -0.603688).  Saving model ...
Epoch: 18 cost time: 1.3007214069366455
Epoch: 18, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.502 Vali Acc: 0.637 Test Loss: 1.502 Test Acc: 0.637
Validation loss decreased (-0.603688 --> -0.637022).  Saving model ...
Epoch: 19 cost time: 0.8273577690124512
Epoch: 19, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.468 Vali Acc: 0.681 Test Loss: 1.468 Test Acc: 0.681
Validation loss decreased (-0.637022 --> -0.681467).  Saving model ...
Epoch: 20 cost time: 1.0679824352264404
Epoch: 20, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.431 Vali Acc: 0.704 Test Loss: 1.431 Test Acc: 0.704
Validation loss decreased (-0.681467 --> -0.703689).  Saving model ...
Epoch: 21 cost time: 1.1512227058410645
Epoch: 21, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.391 Vali Acc: 0.730 Test Loss: 1.391 Test Acc: 0.730
Validation loss decreased (-0.703689 --> -0.729616).  Saving model ...
Epoch: 22 cost time: 1.0316524505615234
Epoch: 22, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.349 Vali Acc: 0.730 Test Loss: 1.349 Test Acc: 0.730
Validation loss decreased (-0.729616 --> -0.729616).  Saving model ...
Epoch: 23 cost time: 0.9032409191131592
Epoch: 23, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.307 Vali Acc: 0.730 Test Loss: 1.307 Test Acc: 0.730
Validation loss decreased (-0.729616 --> -0.729617).  Saving model ...
Epoch: 24 cost time: 0.8937175273895264
Epoch: 24, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.264 Vali Acc: 0.744 Test Loss: 1.264 Test Acc: 0.744
Validation loss decreased (-0.729617 --> -0.744432).  Saving model ...
Epoch: 25 cost time: 0.8288125991821289
Epoch: 25, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.224 Vali Acc: 0.741 Test Loss: 1.224 Test Acc: 0.741
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0921058654785156
Epoch: 26, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.183 Vali Acc: 0.733 Test Loss: 1.183 Test Acc: 0.733
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8686869144439697
Epoch: 27, Steps: 2 | Train Loss: 1.204 Vali Loss: 1.144 Vali Acc: 0.744 Test Loss: 1.144 Test Acc: 0.744
Validation loss decreased (-0.744432 --> -0.744433).  Saving model ...
Epoch: 28 cost time: 0.8040244579315186
Epoch: 28, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.106 Vali Acc: 0.756 Test Loss: 1.106 Test Acc: 0.756
Validation loss decreased (-0.744433 --> -0.755544).  Saving model ...
Epoch: 29 cost time: 0.8306276798248291
Epoch: 29, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.069 Vali Acc: 0.756 Test Loss: 1.069 Test Acc: 0.756
Validation loss decreased (-0.755544 --> -0.755545).  Saving model ...
Epoch: 30 cost time: 1.044858455657959
Epoch: 30, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.034 Vali Acc: 0.774 Test Loss: 1.034 Test Acc: 0.774
Validation loss decreased (-0.755545 --> -0.774064).  Saving model ...
Epoch: 31 cost time: 1.0675835609436035
Epoch: 31, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.001 Vali Acc: 0.793 Test Loss: 1.001 Test Acc: 0.793
Validation loss decreased (-0.774064 --> -0.792583).  Saving model ...
Epoch: 32 cost time: 1.1896419525146484
Epoch: 32, Steps: 2 | Train Loss: 0.863 Vali Loss: 0.970 Vali Acc: 0.841 Test Loss: 0.970 Test Acc: 0.841
Validation loss decreased (-0.792583 --> -0.840731).  Saving model ...
Epoch: 33 cost time: 0.8618876934051514
Epoch: 33, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.939 Vali Acc: 0.844 Test Loss: 0.939 Test Acc: 0.844
Validation loss decreased (-0.840731 --> -0.844435).  Saving model ...
Epoch: 34 cost time: 1.1518135070800781
Epoch: 34, Steps: 2 | Train Loss: 0.946 Vali Loss: 0.910 Vali Acc: 0.852 Test Loss: 0.910 Test Acc: 0.852
Validation loss decreased (-0.844435 --> -0.851843).  Saving model ...
Epoch: 35 cost time: 1.2066872119903564
Epoch: 35, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.883 Vali Acc: 0.848 Test Loss: 0.883 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2179558277130127
Epoch: 36, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.857 Vali Acc: 0.848 Test Loss: 0.857 Test Acc: 0.848
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8593535423278809
Epoch: 37, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.834 Vali Acc: 0.833 Test Loss: 0.834 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.260589838027954
Epoch: 38, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.811 Vali Acc: 0.844 Test Loss: 0.811 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.1216826438903809
Epoch: 39, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.790 Vali Acc: 0.848 Test Loss: 0.790 Test Acc: 0.848
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8986170291900635
Epoch: 40, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.769 Vali Acc: 0.841 Test Loss: 0.769 Test Acc: 0.841
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.0861034393310547
Epoch: 41, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.749 Vali Acc: 0.844 Test Loss: 0.749 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8007535934448242
Epoch: 42, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.730 Vali Acc: 0.841 Test Loss: 0.730 Test Acc: 0.841
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.9184455871582031
Epoch: 43, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.712 Vali Acc: 0.844 Test Loss: 0.712 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.9157726764678955
Epoch: 44, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.696 Vali Acc: 0.844 Test Loss: 0.696 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8518518518518519
model parameter : 236258
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4403228759765625
Epoch: 1, Steps: 2 | Train Loss: 2.096 Vali Loss: 2.022 Vali Acc: 0.152 Test Loss: 2.022 Test Acc: 0.152
Validation loss decreased (inf --> -0.151832).  Saving model ...
Epoch: 2 cost time: 0.9155533313751221
Epoch: 2, Steps: 2 | Train Loss: 2.081 Vali Loss: 1.992 Vali Acc: 0.152 Test Loss: 1.992 Test Acc: 0.152
Validation loss decreased (-0.151832 --> -0.151832).  Saving model ...
Epoch: 3 cost time: 0.8871185779571533
Epoch: 3, Steps: 2 | Train Loss: 2.024 Vali Loss: 1.969 Vali Acc: 0.152 Test Loss: 1.969 Test Acc: 0.152
Validation loss decreased (-0.151832 --> -0.151832).  Saving model ...
Epoch: 4 cost time: 0.8099737167358398
Epoch: 4, Steps: 2 | Train Loss: 2.014 Vali Loss: 1.942 Vali Acc: 0.148 Test Loss: 1.942 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9103286266326904
Epoch: 5, Steps: 2 | Train Loss: 2.076 Vali Loss: 1.910 Vali Acc: 0.144 Test Loss: 1.910 Test Acc: 0.144
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8071649074554443
Epoch: 6, Steps: 2 | Train Loss: 1.898 Vali Loss: 1.877 Vali Acc: 0.141 Test Loss: 1.877 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9332177639007568
Epoch: 7, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.845 Vali Acc: 0.141 Test Loss: 1.845 Test Acc: 0.141
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1763598918914795
Epoch: 8, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.815 Vali Acc: 0.137 Test Loss: 1.815 Test Acc: 0.137
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.079526662826538
Epoch: 9, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.789 Vali Acc: 0.130 Test Loss: 1.789 Test Acc: 0.130
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3214924335479736
Epoch: 10, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.764 Vali Acc: 0.126 Test Loss: 1.764 Test Acc: 0.126
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0476443767547607
Epoch: 11, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.741 Vali Acc: 0.133 Test Loss: 1.741 Test Acc: 0.133
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0185832977294922
Epoch: 12, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.720 Vali Acc: 0.167 Test Loss: 1.720 Test Acc: 0.167
Validation loss decreased (-0.151832 --> -0.166649).  Saving model ...
Epoch: 13 cost time: 1.0168561935424805
Epoch: 13, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.699 Vali Acc: 0.267 Test Loss: 1.699 Test Acc: 0.267
Validation loss decreased (-0.166649 --> -0.266650).  Saving model ...
Epoch: 14 cost time: 1.0656261444091797
Epoch: 14, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.678 Vali Acc: 0.344 Test Loss: 1.678 Test Acc: 0.344
Validation loss decreased (-0.266650 --> -0.344428).  Saving model ...
Epoch: 15 cost time: 0.9801206588745117
Epoch: 15, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.657 Vali Acc: 0.411 Test Loss: 1.657 Test Acc: 0.411
Validation loss decreased (-0.344428 --> -0.411095).  Saving model ...
Epoch: 16 cost time: 0.9996311664581299
Epoch: 16, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.635 Vali Acc: 0.493 Test Loss: 1.635 Test Acc: 0.493
Validation loss decreased (-0.411095 --> -0.492576).  Saving model ...
Epoch: 17 cost time: 0.9329092502593994
Epoch: 17, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.612 Vali Acc: 0.541 Test Loss: 1.612 Test Acc: 0.541
Validation loss decreased (-0.492576 --> -0.540725).  Saving model ...
Epoch: 18 cost time: 1.2830572128295898
Epoch: 18, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.586 Vali Acc: 0.567 Test Loss: 1.586 Test Acc: 0.567
Validation loss decreased (-0.540725 --> -0.566651).  Saving model ...
Epoch: 19 cost time: 1.0039355754852295
Epoch: 19, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.558 Vali Acc: 0.581 Test Loss: 1.558 Test Acc: 0.581
Validation loss decreased (-0.566651 --> -0.581466).  Saving model ...
Epoch: 20 cost time: 0.843041181564331
Epoch: 20, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.528 Vali Acc: 0.589 Test Loss: 1.528 Test Acc: 0.589
Validation loss decreased (-0.581466 --> -0.588874).  Saving model ...
Epoch: 21 cost time: 1.0528347492218018
Epoch: 21, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.495 Vali Acc: 0.604 Test Loss: 1.495 Test Acc: 0.604
Validation loss decreased (-0.588874 --> -0.603689).  Saving model ...
Epoch: 22 cost time: 1.0395112037658691
Epoch: 22, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.460 Vali Acc: 0.619 Test Loss: 1.460 Test Acc: 0.619
Validation loss decreased (-0.603689 --> -0.618504).  Saving model ...
Epoch: 23 cost time: 0.915823221206665
Epoch: 23, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.422 Vali Acc: 0.626 Test Loss: 1.422 Test Acc: 0.626
Validation loss decreased (-0.618504 --> -0.625912).  Saving model ...
Epoch: 24 cost time: 0.9763002395629883
Epoch: 24, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.380 Vali Acc: 0.641 Test Loss: 1.380 Test Acc: 0.641
Validation loss decreased (-0.625912 --> -0.640727).  Saving model ...
Epoch: 25 cost time: 0.8952844142913818
Epoch: 25, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.336 Vali Acc: 0.652 Test Loss: 1.336 Test Acc: 0.652
Validation loss decreased (-0.640727 --> -0.651838).  Saving model ...
Epoch: 26 cost time: 1.043025016784668
Epoch: 26, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.290 Vali Acc: 0.667 Test Loss: 1.290 Test Acc: 0.667
Validation loss decreased (-0.651838 --> -0.666654).  Saving model ...
Epoch: 27 cost time: 0.8361814022064209
Epoch: 27, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.242 Vali Acc: 0.685 Test Loss: 1.242 Test Acc: 0.685
Validation loss decreased (-0.666654 --> -0.685173).  Saving model ...
Epoch: 28 cost time: 0.828589916229248
Epoch: 28, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.193 Vali Acc: 0.726 Test Loss: 1.193 Test Acc: 0.726
Validation loss decreased (-0.685173 --> -0.725914).  Saving model ...
Epoch: 29 cost time: 0.9507558345794678
Epoch: 29, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.144 Vali Acc: 0.741 Test Loss: 1.144 Test Acc: 0.741
Validation loss decreased (-0.725914 --> -0.740729).  Saving model ...
Epoch: 30 cost time: 0.9465124607086182
Epoch: 30, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.096 Vali Acc: 0.781 Test Loss: 1.096 Test Acc: 0.781
Validation loss decreased (-0.740729 --> -0.781471).  Saving model ...
Epoch: 31 cost time: 0.867450475692749
Epoch: 31, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.048 Vali Acc: 0.807 Test Loss: 1.048 Test Acc: 0.807
Validation loss decreased (-0.781471 --> -0.807397).  Saving model ...
Epoch: 32 cost time: 1.1081974506378174
Epoch: 32, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.002 Vali Acc: 0.822 Test Loss: 1.002 Test Acc: 0.822
Validation loss decreased (-0.807397 --> -0.822212).  Saving model ...
Epoch: 33 cost time: 0.8394327163696289
Epoch: 33, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.961 Vali Acc: 0.830 Test Loss: 0.961 Test Acc: 0.830
Validation loss decreased (-0.822212 --> -0.829620).  Saving model ...
Epoch: 34 cost time: 1.1126577854156494
Epoch: 34, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.922 Vali Acc: 0.833 Test Loss: 0.922 Test Acc: 0.833
Validation loss decreased (-0.829620 --> -0.833324).  Saving model ...
Epoch: 35 cost time: 0.9170184135437012
Epoch: 35, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.885 Vali Acc: 0.841 Test Loss: 0.885 Test Acc: 0.841
Validation loss decreased (-0.833324 --> -0.840732).  Saving model ...
Epoch: 36 cost time: 0.8531277179718018
Epoch: 36, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.849 Vali Acc: 0.848 Test Loss: 0.849 Test Acc: 0.848
Validation loss decreased (-0.840732 --> -0.848140).  Saving model ...
Epoch: 37 cost time: 1.004544734954834
Epoch: 37, Steps: 2 | Train Loss: 0.742 Vali Loss: 0.816 Vali Acc: 0.856 Test Loss: 0.816 Test Acc: 0.856
Validation loss decreased (-0.848140 --> -0.855547).  Saving model ...
Epoch: 38 cost time: 1.0953702926635742
Epoch: 38, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.784 Vali Acc: 0.867 Test Loss: 0.784 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866659).  Saving model ...
Epoch: 39 cost time: 0.8263137340545654
Epoch: 39, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.756 Vali Acc: 0.863 Test Loss: 0.756 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.0084891319274902
Epoch: 40, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.733 Vali Acc: 0.859 Test Loss: 0.733 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.171699047088623
Epoch: 41, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.711 Vali Acc: 0.870 Test Loss: 0.711 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 42 cost time: 0.8371140956878662
Epoch: 42, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.691 Vali Acc: 0.878 Test Loss: 0.691 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 43 cost time: 1.0208971500396729
Epoch: 43, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.674 Vali Acc: 0.874 Test Loss: 0.674 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2282352447509766
Epoch: 44, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.659 Vali Acc: 0.870 Test Loss: 0.659 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9271345138549805
Epoch: 45, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.643 Vali Acc: 0.870 Test Loss: 0.643 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9707589149475098
Epoch: 46, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.628 Vali Acc: 0.867 Test Loss: 0.628 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8755249977111816
Epoch: 47, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.612 Vali Acc: 0.852 Test Loss: 0.612 Test Acc: 0.852
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.9937996864318848
Epoch: 48, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.596 Vali Acc: 0.867 Test Loss: 0.596 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.1065199375152588
Epoch: 49, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.579 Vali Acc: 0.870 Test Loss: 0.579 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.019531011581421
Epoch: 50, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.564 Vali Acc: 0.885 Test Loss: 0.564 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885180).  Saving model ...
Epoch: 51 cost time: 1.0885298252105713
Epoch: 51, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.552 Vali Acc: 0.896 Test Loss: 0.552 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896291).  Saving model ...
Epoch: 52 cost time: 0.9196836948394775
Epoch: 52, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.542 Vali Acc: 0.896 Test Loss: 0.542 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 53 cost time: 1.0996267795562744
Epoch: 53, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.531 Vali Acc: 0.900 Test Loss: 0.531 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 54 cost time: 0.8455982208251953
Epoch: 54, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.524 Vali Acc: 0.907 Test Loss: 0.524 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907402).  Saving model ...
Epoch: 55 cost time: 1.1064105033874512
Epoch: 55, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.520 Vali Acc: 0.904 Test Loss: 0.520 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9902935028076172
Epoch: 56, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.513 Vali Acc: 0.904 Test Loss: 0.513 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8013455867767334
Epoch: 57, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.506 Vali Acc: 0.904 Test Loss: 0.506 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.0184404850006104
Epoch: 58, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.9076731204986572
Epoch: 59, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.486 Vali Acc: 0.896 Test Loss: 0.486 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.0473134517669678
Epoch: 60, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.478 Vali Acc: 0.904 Test Loss: 0.478 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.9968011379241943
Epoch: 61, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.468 Vali Acc: 0.904 Test Loss: 0.468 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.1696596145629883
Epoch: 62, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.458 Vali Acc: 0.907 Test Loss: 0.458 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 63 cost time: 0.9529616832733154
Epoch: 63, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.450 Vali Acc: 0.915 Test Loss: 0.450 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914810).  Saving model ...
Epoch: 64 cost time: 1.016622543334961
Epoch: 64, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.441 Vali Acc: 0.919 Test Loss: 0.441 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 65 cost time: 0.7503566741943359
Epoch: 65, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.437 Vali Acc: 0.911 Test Loss: 0.437 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0005981922149658
Epoch: 66, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.430 Vali Acc: 0.919 Test Loss: 0.430 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 67 cost time: 0.9896368980407715
Epoch: 67, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.426 Vali Acc: 0.922 Test Loss: 0.426 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 68 cost time: 1.1999430656433105
Epoch: 68, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.422 Vali Acc: 0.919 Test Loss: 0.422 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 1.0148396492004395
Epoch: 69, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.419 Vali Acc: 0.926 Test Loss: 0.419 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 70 cost time: 1.0526578426361084
Epoch: 70, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.417 Vali Acc: 0.926 Test Loss: 0.417 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 71 cost time: 0.8301980495452881
Epoch: 71, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.417 Vali Acc: 0.919 Test Loss: 0.417 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.8950788974761963
Epoch: 72, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.414 Vali Acc: 0.922 Test Loss: 0.414 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.7949976921081543
Epoch: 73, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.410 Vali Acc: 0.922 Test Loss: 0.410 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.8721890449523926
Epoch: 74, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.404 Vali Acc: 0.922 Test Loss: 0.404 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 1.1109693050384521
Epoch: 75, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.398 Vali Acc: 0.922 Test Loss: 0.398 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.8310387134552002
Epoch: 76, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.390 Vali Acc: 0.922 Test Loss: 0.390 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.9394357204437256
Epoch: 77, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.383 Vali Acc: 0.926 Test Loss: 0.383 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 78 cost time: 1.0378243923187256
Epoch: 78, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.379 Vali Acc: 0.926 Test Loss: 0.379 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 79 cost time: 1.0270566940307617
Epoch: 79, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.377 Vali Acc: 0.926 Test Loss: 0.377 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 80 cost time: 0.71067214012146
Epoch: 80, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.375 Vali Acc: 0.926 Test Loss: 0.375 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 81 cost time: 0.9488182067871094
Epoch: 81, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.372 Vali Acc: 0.922 Test Loss: 0.372 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 1.1372556686401367
Epoch: 82, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.371 Vali Acc: 0.919 Test Loss: 0.371 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.8532896041870117
Epoch: 83, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.365 Vali Acc: 0.922 Test Loss: 0.365 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.9847772121429443
Epoch: 84, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.361 Vali Acc: 0.926 Test Loss: 0.361 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 85 cost time: 0.9424443244934082
Epoch: 85, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.356 Vali Acc: 0.926 Test Loss: 0.356 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 86 cost time: 0.7929244041442871
Epoch: 86, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 87 cost time: 1.0661187171936035
Epoch: 87, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.353 Vali Acc: 0.926 Test Loss: 0.353 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 88 cost time: 0.9925405979156494
Epoch: 88, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.348 Vali Acc: 0.926 Test Loss: 0.348 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 89 cost time: 0.971447229385376
Epoch: 89, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.346 Vali Acc: 0.930 Test Loss: 0.346 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 90 cost time: 0.9522299766540527
Epoch: 90, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.343 Vali Acc: 0.926 Test Loss: 0.343 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.995140790939331
Epoch: 91, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.339 Vali Acc: 0.919 Test Loss: 0.339 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.8937513828277588
Epoch: 92, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.337 Vali Acc: 0.919 Test Loss: 0.337 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 93 cost time: 0.9708719253540039
Epoch: 93, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.335 Vali Acc: 0.926 Test Loss: 0.335 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 94 cost time: 0.8743805885314941
Epoch: 94, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.335 Vali Acc: 0.926 Test Loss: 0.335 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 95 cost time: 0.9682636260986328
Epoch: 95, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.332 Vali Acc: 0.933 Test Loss: 0.332 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 96 cost time: 0.9818415641784668
Epoch: 96, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.330 Vali Acc: 0.930 Test Loss: 0.330 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 1.024139165878296
Epoch: 97, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.979515790939331
Epoch: 98, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.324 Vali Acc: 0.937 Test Loss: 0.324 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 99 cost time: 0.8342573642730713
Epoch: 99, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.321 Vali Acc: 0.937 Test Loss: 0.321 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 100 cost time: 0.836355447769165
Epoch: 100, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.317 Vali Acc: 0.937 Test Loss: 0.317 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 235874
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5548086166381836
Epoch: 1, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.823 Vali Acc: 0.096 Test Loss: 1.823 Test Acc: 0.096
Validation loss decreased (inf --> -0.096278).  Saving model ...
Epoch: 2 cost time: 0.9633307456970215
Epoch: 2, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.806 Vali Acc: 0.100 Test Loss: 1.806 Test Acc: 0.100
Validation loss decreased (-0.096278 --> -0.099982).  Saving model ...
Epoch: 3 cost time: 0.6894054412841797
Epoch: 3, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.791 Vali Acc: 0.107 Test Loss: 1.791 Test Acc: 0.107
Validation loss decreased (-0.099982 --> -0.107389).  Saving model ...
Epoch: 4 cost time: 0.7977316379547119
Epoch: 4, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.775 Vali Acc: 0.126 Test Loss: 1.775 Test Acc: 0.126
Validation loss decreased (-0.107389 --> -0.125908).  Saving model ...
Epoch: 5 cost time: 0.7604529857635498
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.756 Vali Acc: 0.159 Test Loss: 1.756 Test Acc: 0.159
Validation loss decreased (-0.125908 --> -0.159242).  Saving model ...
Epoch: 6 cost time: 1.2778668403625488
Epoch: 6, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.735 Vali Acc: 0.185 Test Loss: 1.735 Test Acc: 0.185
Validation loss decreased (-0.159242 --> -0.185168).  Saving model ...
Epoch: 7 cost time: 0.7925019264221191
Epoch: 7, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.713 Vali Acc: 0.211 Test Loss: 1.713 Test Acc: 0.211
Validation loss decreased (-0.185168 --> -0.211094).  Saving model ...
Epoch: 8 cost time: 0.8643860816955566
Epoch: 8, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.691 Vali Acc: 0.233 Test Loss: 1.691 Test Acc: 0.233
Validation loss decreased (-0.211094 --> -0.233316).  Saving model ...
Epoch: 9 cost time: 0.8546228408813477
Epoch: 9, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.669 Vali Acc: 0.274 Test Loss: 1.669 Test Acc: 0.274
Validation loss decreased (-0.233316 --> -0.274057).  Saving model ...
Epoch: 10 cost time: 1.2076008319854736
Epoch: 10, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.648 Vali Acc: 0.356 Test Loss: 1.648 Test Acc: 0.356
Validation loss decreased (-0.274057 --> -0.355539).  Saving model ...
Epoch: 11 cost time: 0.8559873104095459
Epoch: 11, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.627 Vali Acc: 0.381 Test Loss: 1.627 Test Acc: 0.381
Validation loss decreased (-0.355539 --> -0.381465).  Saving model ...
Epoch: 12 cost time: 1.0255374908447266
Epoch: 12, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.605 Vali Acc: 0.411 Test Loss: 1.605 Test Acc: 0.411
Validation loss decreased (-0.381465 --> -0.411095).  Saving model ...
Epoch: 13 cost time: 1.2475686073303223
Epoch: 13, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.581 Vali Acc: 0.478 Test Loss: 1.581 Test Acc: 0.478
Validation loss decreased (-0.411095 --> -0.477762).  Saving model ...
Epoch: 14 cost time: 1.087855577468872
Epoch: 14, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.555 Vali Acc: 0.541 Test Loss: 1.555 Test Acc: 0.541
Validation loss decreased (-0.477762 --> -0.540725).  Saving model ...
Epoch: 15 cost time: 0.9532370567321777
Epoch: 15, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.527 Vali Acc: 0.574 Test Loss: 1.527 Test Acc: 0.574
Validation loss decreased (-0.540725 --> -0.574059).  Saving model ...
Epoch: 16 cost time: 1.2198238372802734
Epoch: 16, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.496 Vali Acc: 0.600 Test Loss: 1.496 Test Acc: 0.600
Validation loss decreased (-0.574059 --> -0.599985).  Saving model ...
Epoch: 17 cost time: 1.1575703620910645
Epoch: 17, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.463 Vali Acc: 0.641 Test Loss: 1.463 Test Acc: 0.641
Validation loss decreased (-0.599985 --> -0.640726).  Saving model ...
Epoch: 18 cost time: 0.9901332855224609
Epoch: 18, Steps: 2 | Train Loss: 1.458 Vali Loss: 1.430 Vali Acc: 0.693 Test Loss: 1.430 Test Acc: 0.693
Validation loss decreased (-0.640726 --> -0.692578).  Saving model ...
Epoch: 19 cost time: 1.271162986755371
Epoch: 19, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.395 Vali Acc: 0.696 Test Loss: 1.395 Test Acc: 0.696
Validation loss decreased (-0.692578 --> -0.696282).  Saving model ...
Epoch: 20 cost time: 0.9545300006866455
Epoch: 20, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.360 Vali Acc: 0.696 Test Loss: 1.360 Test Acc: 0.696
Validation loss decreased (-0.696282 --> -0.696283).  Saving model ...
Epoch: 21 cost time: 0.9116299152374268
Epoch: 21, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.324 Vali Acc: 0.719 Test Loss: 1.324 Test Acc: 0.719
Validation loss decreased (-0.696283 --> -0.718505).  Saving model ...
Epoch: 22 cost time: 0.9925005435943604
Epoch: 22, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.286 Vali Acc: 0.741 Test Loss: 1.286 Test Acc: 0.741
Validation loss decreased (-0.718505 --> -0.740728).  Saving model ...
Epoch: 23 cost time: 0.8684887886047363
Epoch: 23, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.247 Vali Acc: 0.726 Test Loss: 1.247 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9770238399505615
Epoch: 24, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.206 Vali Acc: 0.752 Test Loss: 1.206 Test Acc: 0.752
Validation loss decreased (-0.740728 --> -0.751840).  Saving model ...
Epoch: 25 cost time: 0.91074538230896
Epoch: 25, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.163 Vali Acc: 0.778 Test Loss: 1.163 Test Acc: 0.778
Validation loss decreased (-0.751840 --> -0.777766).  Saving model ...
Epoch: 26 cost time: 0.992093563079834
Epoch: 26, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.119 Vali Acc: 0.800 Test Loss: 1.119 Test Acc: 0.800
Validation loss decreased (-0.777766 --> -0.799989).  Saving model ...
Epoch: 27 cost time: 0.9720289707183838
Epoch: 27, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.076 Vali Acc: 0.830 Test Loss: 1.076 Test Acc: 0.830
Validation loss decreased (-0.799989 --> -0.829619).  Saving model ...
Epoch: 28 cost time: 0.9023351669311523
Epoch: 28, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.035 Vali Acc: 0.852 Test Loss: 1.035 Test Acc: 0.852
Validation loss decreased (-0.829619 --> -0.851841).  Saving model ...
Epoch: 29 cost time: 1.2840635776519775
Epoch: 29, Steps: 2 | Train Loss: 1.025 Vali Loss: 0.998 Vali Acc: 0.867 Test Loss: 0.998 Test Acc: 0.867
Validation loss decreased (-0.851841 --> -0.866657).  Saving model ...
Epoch: 30 cost time: 1.246368646621704
Epoch: 30, Steps: 2 | Train Loss: 0.984 Vali Loss: 0.962 Vali Acc: 0.867 Test Loss: 0.962 Test Acc: 0.867
Validation loss decreased (-0.866657 --> -0.866657).  Saving model ...
Epoch: 31 cost time: 1.0158464908599854
Epoch: 31, Steps: 2 | Train Loss: 0.969 Vali Loss: 0.929 Vali Acc: 0.874 Test Loss: 0.929 Test Acc: 0.874
Validation loss decreased (-0.866657 --> -0.874065).  Saving model ...
Epoch: 32 cost time: 0.9787366390228271
Epoch: 32, Steps: 2 | Train Loss: 0.940 Vali Loss: 0.897 Vali Acc: 0.878 Test Loss: 0.897 Test Acc: 0.878
Validation loss decreased (-0.874065 --> -0.877769).  Saving model ...
Epoch: 33 cost time: 1.223482370376587
Epoch: 33, Steps: 2 | Train Loss: 0.901 Vali Loss: 0.868 Vali Acc: 0.878 Test Loss: 0.868 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877769).  Saving model ...
Epoch: 34 cost time: 0.9942736625671387
Epoch: 34, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.841 Vali Acc: 0.874 Test Loss: 0.841 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0334389209747314
Epoch: 35, Steps: 2 | Train Loss: 0.796 Vali Loss: 0.817 Vali Acc: 0.867 Test Loss: 0.817 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9418702125549316
Epoch: 36, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.793 Vali Acc: 0.870 Test Loss: 0.793 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.934760570526123
Epoch: 37, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.772 Vali Acc: 0.863 Test Loss: 0.772 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.1528334617614746
Epoch: 38, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.752 Vali Acc: 0.878 Test Loss: 0.752 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877770).  Saving model ...
Epoch: 39 cost time: 0.9476432800292969
Epoch: 39, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.732 Vali Acc: 0.878 Test Loss: 0.732 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877770).  Saving model ...
Epoch: 40 cost time: 0.8784968852996826
Epoch: 40, Steps: 2 | Train Loss: 0.712 Vali Loss: 0.712 Vali Acc: 0.885 Test Loss: 0.712 Test Acc: 0.885
Validation loss decreased (-0.877770 --> -0.885178).  Saving model ...
Epoch: 41 cost time: 0.9819023609161377
Epoch: 41, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.693 Vali Acc: 0.889 Test Loss: 0.693 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 42 cost time: 1.0330870151519775
Epoch: 42, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.675 Vali Acc: 0.904 Test Loss: 0.675 Test Acc: 0.904
Validation loss decreased (-0.888882 --> -0.903697).  Saving model ...
Epoch: 43 cost time: 1.3286619186401367
Epoch: 43, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.658 Vali Acc: 0.915 Test Loss: 0.658 Test Acc: 0.915
Validation loss decreased (-0.903697 --> -0.914808).  Saving model ...
Epoch: 44 cost time: 1.1528918743133545
Epoch: 44, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.642 Vali Acc: 0.919 Test Loss: 0.642 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 45 cost time: 1.045196294784546
Epoch: 45, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.627 Vali Acc: 0.915 Test Loss: 0.627 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.1306614875793457
Epoch: 46, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.613 Vali Acc: 0.919 Test Loss: 0.613 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 47 cost time: 1.0106477737426758
Epoch: 47, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.600 Vali Acc: 0.919 Test Loss: 0.600 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 48 cost time: 0.9832882881164551
Epoch: 48, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.587 Vali Acc: 0.930 Test Loss: 0.587 Test Acc: 0.930
Validation loss decreased (-0.918513 --> -0.929624).  Saving model ...
Epoch: 49 cost time: 1.1446287631988525
Epoch: 49, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.575 Vali Acc: 0.926 Test Loss: 0.575 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.0290896892547607
Epoch: 50, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.565 Vali Acc: 0.922 Test Loss: 0.565 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.057476282119751
Epoch: 51, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.554 Vali Acc: 0.926 Test Loss: 0.554 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.1613328456878662
Epoch: 52, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.544 Vali Acc: 0.922 Test Loss: 0.544 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 1.1402075290679932
Epoch: 53, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.534 Vali Acc: 0.933 Test Loss: 0.534 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 54 cost time: 1.1406466960906982
Epoch: 54, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.522 Vali Acc: 0.933 Test Loss: 0.522 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 55 cost time: 1.0171608924865723
Epoch: 55, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.511 Vali Acc: 0.930 Test Loss: 0.511 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0031487941741943
Epoch: 56, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.500 Vali Acc: 0.930 Test Loss: 0.500 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.1267895698547363
Epoch: 57, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.491 Vali Acc: 0.930 Test Loss: 0.491 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.0795729160308838
Epoch: 58, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.481 Vali Acc: 0.930 Test Loss: 0.481 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 1.2957282066345215
Epoch: 59, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.475 Vali Acc: 0.926 Test Loss: 0.475 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 1.0405399799346924
Epoch: 60, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.470 Vali Acc: 0.911 Test Loss: 0.470 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.255969524383545
Epoch: 61, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.464 Vali Acc: 0.911 Test Loss: 0.464 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.9594805240631104
Epoch: 62, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.457 Vali Acc: 0.907 Test Loss: 0.457 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 1.0964770317077637
Epoch: 63, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.449 Vali Acc: 0.907 Test Loss: 0.449 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 1.2462072372436523
Epoch: 64, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.441 Vali Acc: 0.911 Test Loss: 0.441 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 235490
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           4                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.811781644821167
Epoch: 1, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.831 Vali Acc: 0.285 Test Loss: 1.831 Test Acc: 0.285
Validation loss decreased (inf --> -0.285167).  Saving model ...
Epoch: 2 cost time: 0.944882869720459
Epoch: 2, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.819 Vali Acc: 0.300 Test Loss: 1.819 Test Acc: 0.300
Validation loss decreased (-0.285167 --> -0.299982).  Saving model ...
Epoch: 3 cost time: 0.9098386764526367
Epoch: 3, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.809 Vali Acc: 0.296 Test Loss: 1.809 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1100213527679443
Epoch: 4, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.798 Vali Acc: 0.293 Test Loss: 1.798 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0462801456451416
Epoch: 5, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.784 Vali Acc: 0.304 Test Loss: 1.784 Test Acc: 0.304
Validation loss decreased (-0.299982 --> -0.303686).  Saving model ...
Epoch: 6 cost time: 1.1641802787780762
Epoch: 6, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.769 Vali Acc: 0.307 Test Loss: 1.769 Test Acc: 0.307
Validation loss decreased (-0.303686 --> -0.307390).  Saving model ...
Epoch: 7 cost time: 1.1992902755737305
Epoch: 7, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.754 Vali Acc: 0.319 Test Loss: 1.754 Test Acc: 0.319
Validation loss decreased (-0.307390 --> -0.318501).  Saving model ...
Epoch: 8 cost time: 1.290663480758667
Epoch: 8, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.739 Vali Acc: 0.311 Test Loss: 1.739 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0037002563476562
Epoch: 9, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.723 Vali Acc: 0.344 Test Loss: 1.723 Test Acc: 0.344
Validation loss decreased (-0.318501 --> -0.344427).  Saving model ...
Epoch: 10 cost time: 1.1089367866516113
Epoch: 10, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.707 Vali Acc: 0.385 Test Loss: 1.707 Test Acc: 0.385
Validation loss decreased (-0.344427 --> -0.385168).  Saving model ...
Epoch: 11 cost time: 0.9685819149017334
Epoch: 11, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.691 Vali Acc: 0.426 Test Loss: 1.691 Test Acc: 0.426
Validation loss decreased (-0.385168 --> -0.425909).  Saving model ...
Epoch: 12 cost time: 0.8670377731323242
Epoch: 12, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.675 Vali Acc: 0.452 Test Loss: 1.675 Test Acc: 0.452
Validation loss decreased (-0.425909 --> -0.451835).  Saving model ...
Epoch: 13 cost time: 1.095855951309204
Epoch: 13, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.656 Vali Acc: 0.493 Test Loss: 1.656 Test Acc: 0.493
Validation loss decreased (-0.451835 --> -0.492576).  Saving model ...
Epoch: 14 cost time: 0.9231369495391846
Epoch: 14, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.636 Vali Acc: 0.533 Test Loss: 1.636 Test Acc: 0.533
Validation loss decreased (-0.492576 --> -0.533317).  Saving model ...
Epoch: 15 cost time: 0.9095747470855713
Epoch: 15, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.614 Vali Acc: 0.567 Test Loss: 1.614 Test Acc: 0.567
Validation loss decreased (-0.533317 --> -0.566651).  Saving model ...
Epoch: 16 cost time: 0.867767333984375
Epoch: 16, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.590 Vali Acc: 0.600 Test Loss: 1.590 Test Acc: 0.600
Validation loss decreased (-0.566651 --> -0.599984).  Saving model ...
Epoch: 17 cost time: 0.9314284324645996
Epoch: 17, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.565 Vali Acc: 0.619 Test Loss: 1.565 Test Acc: 0.619
Validation loss decreased (-0.599984 --> -0.618503).  Saving model ...
Epoch: 18 cost time: 1.0448510646820068
Epoch: 18, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.538 Vali Acc: 0.652 Test Loss: 1.538 Test Acc: 0.652
Validation loss decreased (-0.618503 --> -0.651836).  Saving model ...
Epoch: 19 cost time: 1.0018529891967773
Epoch: 19, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.511 Vali Acc: 0.670 Test Loss: 1.511 Test Acc: 0.670
Validation loss decreased (-0.651836 --> -0.670355).  Saving model ...
Epoch: 20 cost time: 1.2142527103424072
Epoch: 20, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.481 Vali Acc: 0.693 Test Loss: 1.481 Test Acc: 0.693
Validation loss decreased (-0.670355 --> -0.692578).  Saving model ...
Epoch: 21 cost time: 1.0111901760101318
Epoch: 21, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.450 Vali Acc: 0.711 Test Loss: 1.450 Test Acc: 0.711
Validation loss decreased (-0.692578 --> -0.711097).  Saving model ...
Epoch: 22 cost time: 0.8782141208648682
Epoch: 22, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.419 Vali Acc: 0.719 Test Loss: 1.419 Test Acc: 0.719
Validation loss decreased (-0.711097 --> -0.718504).  Saving model ...
Epoch: 23 cost time: 0.9351491928100586
Epoch: 23, Steps: 2 | Train Loss: 1.423 Vali Loss: 1.386 Vali Acc: 0.741 Test Loss: 1.386 Test Acc: 0.741
Validation loss decreased (-0.718504 --> -0.740727).  Saving model ...
Epoch: 24 cost time: 0.9288253784179688
Epoch: 24, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.352 Vali Acc: 0.748 Test Loss: 1.352 Test Acc: 0.748
Validation loss decreased (-0.740727 --> -0.748135).  Saving model ...
Epoch: 25 cost time: 0.9424965381622314
Epoch: 25, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.315 Vali Acc: 0.756 Test Loss: 1.315 Test Acc: 0.756
Validation loss decreased (-0.748135 --> -0.755542).  Saving model ...
Epoch: 26 cost time: 0.9366891384124756
Epoch: 26, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.276 Vali Acc: 0.763 Test Loss: 1.276 Test Acc: 0.763
Validation loss decreased (-0.755542 --> -0.762950).  Saving model ...
Epoch: 27 cost time: 1.3500616550445557
Epoch: 27, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.234 Vali Acc: 0.763 Test Loss: 1.234 Test Acc: 0.763
Validation loss decreased (-0.762950 --> -0.762951).  Saving model ...
Epoch: 28 cost time: 0.8377120494842529
Epoch: 28, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.192 Vali Acc: 0.778 Test Loss: 1.192 Test Acc: 0.778
Validation loss decreased (-0.762951 --> -0.777766).  Saving model ...
Epoch: 29 cost time: 0.9082648754119873
Epoch: 29, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.152 Vali Acc: 0.781 Test Loss: 1.152 Test Acc: 0.781
Validation loss decreased (-0.777766 --> -0.781470).  Saving model ...
Epoch: 30 cost time: 0.8960602283477783
Epoch: 30, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.117 Vali Acc: 0.785 Test Loss: 1.117 Test Acc: 0.785
Validation loss decreased (-0.781470 --> -0.785174).  Saving model ...
Epoch: 31 cost time: 0.9797403812408447
Epoch: 31, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.079 Vali Acc: 0.793 Test Loss: 1.079 Test Acc: 0.793
Validation loss decreased (-0.785174 --> -0.792582).  Saving model ...
Epoch: 32 cost time: 0.9468095302581787
Epoch: 32, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.038 Vali Acc: 0.800 Test Loss: 1.038 Test Acc: 0.800
Validation loss decreased (-0.792582 --> -0.799990).  Saving model ...
Epoch: 33 cost time: 0.8331458568572998
Epoch: 33, Steps: 2 | Train Loss: 0.992 Vali Loss: 0.997 Vali Acc: 0.815 Test Loss: 0.997 Test Acc: 0.815
Validation loss decreased (-0.799990 --> -0.814805).  Saving model ...
Epoch: 34 cost time: 0.8899173736572266
Epoch: 34, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.957 Vali Acc: 0.826 Test Loss: 0.957 Test Acc: 0.826
Validation loss decreased (-0.814805 --> -0.825916).  Saving model ...
Epoch: 35 cost time: 0.947251558303833
Epoch: 35, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.921 Vali Acc: 0.844 Test Loss: 0.921 Test Acc: 0.844
Validation loss decreased (-0.825916 --> -0.844435).  Saving model ...
Epoch: 36 cost time: 1.0017566680908203
Epoch: 36, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.888 Vali Acc: 0.844 Test Loss: 0.888 Test Acc: 0.844
Validation loss decreased (-0.844435 --> -0.844436).  Saving model ...
Epoch: 37 cost time: 0.9453392028808594
Epoch: 37, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.858 Vali Acc: 0.844 Test Loss: 0.858 Test Acc: 0.844
Validation loss decreased (-0.844436 --> -0.844436).  Saving model ...
Epoch: 38 cost time: 0.9075307846069336
Epoch: 38, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.830 Vali Acc: 0.852 Test Loss: 0.830 Test Acc: 0.852
Validation loss decreased (-0.844436 --> -0.851844).  Saving model ...
Epoch: 39 cost time: 0.8572866916656494
Epoch: 39, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.801 Vali Acc: 0.852 Test Loss: 0.801 Test Acc: 0.852
Validation loss decreased (-0.851844 --> -0.851844).  Saving model ...
Epoch: 40 cost time: 0.9411888122558594
Epoch: 40, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.776 Vali Acc: 0.859 Test Loss: 0.776 Test Acc: 0.859
Validation loss decreased (-0.851844 --> -0.859252).  Saving model ...
Epoch: 41 cost time: 0.9568219184875488
Epoch: 41, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.755 Vali Acc: 0.856 Test Loss: 0.755 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8938066959381104
Epoch: 42, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.736 Vali Acc: 0.859 Test Loss: 0.736 Test Acc: 0.859
Validation loss decreased (-0.859252 --> -0.859252).  Saving model ...
Epoch: 43 cost time: 0.8862631320953369
Epoch: 43, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.719 Vali Acc: 0.859 Test Loss: 0.719 Test Acc: 0.859
Validation loss decreased (-0.859252 --> -0.859252).  Saving model ...
Epoch: 44 cost time: 1.0216856002807617
Epoch: 44, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.702 Vali Acc: 0.856 Test Loss: 0.702 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 1.15476393699646
Epoch: 45, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.685 Vali Acc: 0.859 Test Loss: 0.685 Test Acc: 0.859
Validation loss decreased (-0.859252 --> -0.859252).  Saving model ...
Epoch: 46 cost time: 0.8886373043060303
Epoch: 46, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.669 Vali Acc: 0.859 Test Loss: 0.669 Test Acc: 0.859
Validation loss decreased (-0.859252 --> -0.859253).  Saving model ...
Epoch: 47 cost time: 1.0145866870880127
Epoch: 47, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.651 Vali Acc: 0.863 Test Loss: 0.651 Test Acc: 0.863
Validation loss decreased (-0.859253 --> -0.862956).  Saving model ...
Epoch: 48 cost time: 1.0434191226959229
Epoch: 48, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.636 Vali Acc: 0.867 Test Loss: 0.636 Test Acc: 0.867
Validation loss decreased (-0.862956 --> -0.866660).  Saving model ...
Epoch: 49 cost time: 0.8804547786712646
Epoch: 49, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.620 Vali Acc: 0.870 Test Loss: 0.620 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 50 cost time: 0.8703880310058594
Epoch: 50, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.607 Vali Acc: 0.874 Test Loss: 0.607 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 51 cost time: 1.2347400188446045
Epoch: 51, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.595 Vali Acc: 0.878 Test Loss: 0.595 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 52 cost time: 0.7587354183197021
Epoch: 52, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.585 Vali Acc: 0.878 Test Loss: 0.585 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 53 cost time: 1.0834355354309082
Epoch: 53, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.578 Vali Acc: 0.874 Test Loss: 0.578 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.9341027736663818
Epoch: 54, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.574 Vali Acc: 0.870 Test Loss: 0.574 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9855635166168213
Epoch: 55, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.569 Vali Acc: 0.870 Test Loss: 0.569 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8125393390655518
Epoch: 56, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.563 Vali Acc: 0.874 Test Loss: 0.563 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0075984001159668
Epoch: 57, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.552 Vali Acc: 0.867 Test Loss: 0.552 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.9457452297210693
Epoch: 58, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.542 Vali Acc: 0.867 Test Loss: 0.542 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9095554351806641
Epoch: 59, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.535 Vali Acc: 0.867 Test Loss: 0.535 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.0820093154907227
Epoch: 60, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.527 Vali Acc: 0.870 Test Loss: 0.527 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.957991361618042
Epoch: 61, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.511 Vali Acc: 0.874 Test Loss: 0.511 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.9949722290039062
Epoch: 62, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.499 Vali Acc: 0.885 Test Loss: 0.499 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885180).  Saving model ...
Epoch: 63 cost time: 0.8182582855224609
Epoch: 63, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.489 Vali Acc: 0.889 Test Loss: 0.489 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 64 cost time: 1.083909273147583
Epoch: 64, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.483 Vali Acc: 0.881 Test Loss: 0.483 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.0432233810424805
Epoch: 65, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.477 Vali Acc: 0.881 Test Loss: 0.477 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.107654094696045
Epoch: 66, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.476 Vali Acc: 0.889 Test Loss: 0.476 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 67 cost time: 0.8504507541656494
Epoch: 67, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.474 Vali Acc: 0.893 Test Loss: 0.474 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 68 cost time: 1.076127290725708
Epoch: 68, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.466 Vali Acc: 0.893 Test Loss: 0.466 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 69 cost time: 0.9860348701477051
Epoch: 69, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.458 Vali Acc: 0.896 Test Loss: 0.458 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 70 cost time: 0.9098846912384033
Epoch: 70, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.452 Vali Acc: 0.885 Test Loss: 0.452 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 1.1531059741973877
Epoch: 71, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.447 Vali Acc: 0.881 Test Loss: 0.447 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.0555241107940674
Epoch: 72, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.441 Vali Acc: 0.885 Test Loss: 0.441 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.8757286071777344
Epoch: 73, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.438 Vali Acc: 0.889 Test Loss: 0.438 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 1.0285074710845947
Epoch: 74, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.436 Vali Acc: 0.885 Test Loss: 0.436 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.0331676006317139
Epoch: 75, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.433 Vali Acc: 0.889 Test Loss: 0.433 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.1117489337921143
Epoch: 76, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.427 Vali Acc: 0.893 Test Loss: 0.427 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.939995527267456
Epoch: 77, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 78 cost time: 0.8655855655670166
Epoch: 78, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 79 cost time: 0.8926355838775635
Epoch: 79, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.408 Vali Acc: 0.907 Test Loss: 0.408 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907403).  Saving model ...
Epoch: 80 cost time: 0.8702352046966553
Epoch: 80, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.402 Vali Acc: 0.900 Test Loss: 0.402 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 1.097013235092163
Epoch: 81, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.398 Vali Acc: 0.904 Test Loss: 0.398 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.9869246482849121
Epoch: 82, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.396 Vali Acc: 0.919 Test Loss: 0.396 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918515).  Saving model ...
Epoch: 83 cost time: 0.9801273345947266
Epoch: 83, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.391 Vali Acc: 0.907 Test Loss: 0.391 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.8574633598327637
Epoch: 84, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.387 Vali Acc: 0.904 Test Loss: 0.387 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.9659428596496582
Epoch: 85, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.385 Vali Acc: 0.907 Test Loss: 0.385 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.8355202674865723
Epoch: 86, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.385 Vali Acc: 0.911 Test Loss: 0.385 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.1004972457885742
Epoch: 87, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.386 Vali Acc: 0.911 Test Loss: 0.386 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 1.0149691104888916
Epoch: 88, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.385 Vali Acc: 0.911 Test Loss: 0.385 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.8355610370635986
Epoch: 89, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.384 Vali Acc: 0.907 Test Loss: 0.384 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.9354596138000488
Epoch: 90, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.382 Vali Acc: 0.907 Test Loss: 0.382 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.8046495914459229
Epoch: 91, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.381 Vali Acc: 0.907 Test Loss: 0.381 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.9276061058044434
Epoch: 92, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.379 Vali Acc: 0.907 Test Loss: 0.379 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el4_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 235106
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.776144504547119
Epoch: 1, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.910 Vali Acc: 0.052 Test Loss: 1.910 Test Acc: 0.052
Validation loss decreased (inf --> -0.051833).  Saving model ...
Epoch: 2 cost time: 0.7835831642150879
Epoch: 2, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.871 Vali Acc: 0.044 Test Loss: 1.871 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7845973968505859
Epoch: 3, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.791 Vali Acc: 0.144 Test Loss: 1.791 Test Acc: 0.144
Validation loss decreased (-0.051833 --> -0.144427).  Saving model ...
Epoch: 4 cost time: 1.0239238739013672
Epoch: 4, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.645 Vali Acc: 0.422 Test Loss: 1.645 Test Acc: 0.422
Validation loss decreased (-0.144427 --> -0.422206).  Saving model ...
Epoch: 5 cost time: 0.8919353485107422
Epoch: 5, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.465 Vali Acc: 0.696 Test Loss: 1.465 Test Acc: 0.696
Validation loss decreased (-0.422206 --> -0.696282).  Saving model ...
Epoch: 6 cost time: 0.834542989730835
Epoch: 6, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.253 Vali Acc: 0.763 Test Loss: 1.253 Test Acc: 0.763
Validation loss decreased (-0.696282 --> -0.762950).  Saving model ...
Epoch: 7 cost time: 0.9206709861755371
Epoch: 7, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.057 Vali Acc: 0.837 Test Loss: 1.057 Test Acc: 0.837
Validation loss decreased (-0.762950 --> -0.837026).  Saving model ...
Epoch: 8 cost time: 0.8581545352935791
Epoch: 8, Steps: 2 | Train Loss: 0.947 Vali Loss: 0.896 Vali Acc: 0.852 Test Loss: 0.896 Test Acc: 0.852
Validation loss decreased (-0.837026 --> -0.851843).  Saving model ...
Epoch: 9 cost time: 0.746981143951416
Epoch: 9, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.745 Vali Acc: 0.896 Test Loss: 0.745 Test Acc: 0.896
Validation loss decreased (-0.851843 --> -0.896289).  Saving model ...
Epoch: 10 cost time: 0.8764052391052246
Epoch: 10, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.605 Vali Acc: 0.915 Test Loss: 0.605 Test Acc: 0.915
Validation loss decreased (-0.896289 --> -0.914809).  Saving model ...
Epoch: 11 cost time: 1.027353048324585
Epoch: 11, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.513 Vali Acc: 0.904 Test Loss: 0.513 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8385365009307861
Epoch: 12, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.407 Vali Acc: 0.941 Test Loss: 0.407 Test Acc: 0.941
Validation loss decreased (-0.914809 --> -0.940737).  Saving model ...
Epoch: 13 cost time: 0.8924267292022705
Epoch: 13, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.332 Vali Acc: 0.948 Test Loss: 0.332 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 14 cost time: 0.9204561710357666
Epoch: 14, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.283 Vali Acc: 0.944 Test Loss: 0.283 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1269316673278809
Epoch: 15, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.255 Vali Acc: 0.956 Test Loss: 0.255 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955553).  Saving model ...
Epoch: 16 cost time: 0.958127498626709
Epoch: 16, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.267 Vali Acc: 0.919 Test Loss: 0.267 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8219971656799316
Epoch: 17, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9537320137023926
Epoch: 18, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9583189487457275
Epoch: 19, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7190790176391602
Epoch: 20, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8991162776947021
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9700045585632324
Epoch: 22, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.0196950435638428
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9511673450469971
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.049041509628296
Epoch: 25, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 26 cost time: 1.1152117252349854
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 27 cost time: 0.8840773105621338
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1481292247772217
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0304946899414062
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8411121368408203
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.9748401641845703
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8717074394226074
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9499721527099609
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8774027824401855
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.1518096923828125
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8391430377960205
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 11115062
model size : 47.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.873586654663086
Epoch: 1, Steps: 2 | Train Loss: 2.162 Vali Loss: 2.080 Vali Acc: 0.170 Test Loss: 2.080 Test Acc: 0.170
Validation loss decreased (inf --> -0.170350).  Saving model ...
Epoch: 2 cost time: 0.8462257385253906
Epoch: 2, Steps: 2 | Train Loss: 2.051 Vali Loss: 1.975 Vali Acc: 0.170 Test Loss: 1.975 Test Acc: 0.170
Validation loss decreased (-0.170350 --> -0.170351).  Saving model ...
Epoch: 3 cost time: 0.9220314025878906
Epoch: 3, Steps: 2 | Train Loss: 2.007 Vali Loss: 1.810 Vali Acc: 0.259 Test Loss: 1.810 Test Acc: 0.259
Validation loss decreased (-0.170351 --> -0.259241).  Saving model ...
Epoch: 4 cost time: 0.735724687576294
Epoch: 4, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.697 Vali Acc: 0.326 Test Loss: 1.697 Test Acc: 0.326
Validation loss decreased (-0.259241 --> -0.325909).  Saving model ...
Epoch: 5 cost time: 0.9770312309265137
Epoch: 5, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.648 Vali Acc: 0.293 Test Loss: 1.648 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8575108051300049
Epoch: 6, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.504 Vali Acc: 0.393 Test Loss: 1.504 Test Acc: 0.393
Validation loss decreased (-0.325909 --> -0.392578).  Saving model ...
Epoch: 7 cost time: 1.142941951751709
Epoch: 7, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.257 Vali Acc: 0.556 Test Loss: 1.257 Test Acc: 0.556
Validation loss decreased (-0.392578 --> -0.555543).  Saving model ...
Epoch: 8 cost time: 0.9476776123046875
Epoch: 8, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.018 Vali Acc: 0.904 Test Loss: 1.018 Test Acc: 0.904
Validation loss decreased (-0.555543 --> -0.903694).  Saving model ...
Epoch: 9 cost time: 0.9565033912658691
Epoch: 9, Steps: 2 | Train Loss: 0.951 Vali Loss: 0.890 Vali Acc: 0.726 Test Loss: 0.890 Test Acc: 0.726
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9487483501434326
Epoch: 10, Steps: 2 | Train Loss: 0.785 Vali Loss: 0.759 Vali Acc: 0.870 Test Loss: 0.759 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.818112850189209
Epoch: 11, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.633 Vali Acc: 0.874 Test Loss: 0.633 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0706157684326172
Epoch: 12, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.516 Vali Acc: 0.885 Test Loss: 0.516 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0594019889831543
Epoch: 13, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.391 Vali Acc: 0.937 Test Loss: 0.391 Test Acc: 0.937
Validation loss decreased (-0.903694 --> -0.937033).  Saving model ...
Epoch: 14 cost time: 1.0166611671447754
Epoch: 14, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8933608531951904
Epoch: 15, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.283 Vali Acc: 0.930 Test Loss: 0.283 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.967648983001709
Epoch: 16, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.270 Vali Acc: 0.907 Test Loss: 0.270 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.984381914138794
Epoch: 17, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 1.0406887531280518
Epoch: 18, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.9545881748199463
Epoch: 19, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8161263465881348
Epoch: 20, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.753563404083252
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8526616096496582
Epoch: 22, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8465545177459717
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9736447334289551
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 1.0952739715576172
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.948146 --> -0.955554).  Saving model ...
Epoch: 26 cost time: 1.0761020183563232
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 27 cost time: 0.7252435684204102
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7485475540161133
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9530000686645508
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8928422927856445
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.092500925064087
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8529167175292969
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8702008724212646
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8172597885131836
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.0019471645355225
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9254164695739746
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 11112246
model size : 47.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.123332977294922
Epoch: 1, Steps: 2 | Train Loss: 2.012 Vali Loss: 1.834 Vali Acc: 0.104 Test Loss: 1.834 Test Acc: 0.104
Validation loss decreased (inf --> -0.103685).  Saving model ...
Epoch: 2 cost time: 0.8439033031463623
Epoch: 2, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.791 Vali Acc: 0.174 Test Loss: 1.791 Test Acc: 0.174
Validation loss decreased (-0.103685 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.9812796115875244
Epoch: 3, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.704 Vali Acc: 0.344 Test Loss: 1.704 Test Acc: 0.344
Validation loss decreased (-0.174056 --> -0.344427).  Saving model ...
Epoch: 4 cost time: 1.0014121532440186
Epoch: 4, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.587 Vali Acc: 0.448 Test Loss: 1.587 Test Acc: 0.448
Validation loss decreased (-0.344427 --> -0.448132).  Saving model ...
Epoch: 5 cost time: 0.9113602638244629
Epoch: 5, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.439 Vali Acc: 0.515 Test Loss: 1.439 Test Acc: 0.515
Validation loss decreased (-0.448132 --> -0.514800).  Saving model ...
Epoch: 6 cost time: 0.7541477680206299
Epoch: 6, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.261 Vali Acc: 0.685 Test Loss: 1.261 Test Acc: 0.685
Validation loss decreased (-0.514800 --> -0.685173).  Saving model ...
Epoch: 7 cost time: 1.0372319221496582
Epoch: 7, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.045 Vali Acc: 0.763 Test Loss: 1.045 Test Acc: 0.763
Validation loss decreased (-0.685173 --> -0.762953).  Saving model ...
Epoch: 8 cost time: 0.905921459197998
Epoch: 8, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.876 Vali Acc: 0.822 Test Loss: 0.876 Test Acc: 0.822
Validation loss decreased (-0.762953 --> -0.822213).  Saving model ...
Epoch: 9 cost time: 0.7802765369415283
Epoch: 9, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.727 Vali Acc: 0.833 Test Loss: 0.727 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833326).  Saving model ...
Epoch: 10 cost time: 0.784801721572876
Epoch: 10, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.596 Vali Acc: 0.911 Test Loss: 0.596 Test Acc: 0.911
Validation loss decreased (-0.833326 --> -0.911105).  Saving model ...
Epoch: 11 cost time: 0.8239231109619141
Epoch: 11, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.486 Vali Acc: 0.915 Test Loss: 0.486 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914810).  Saving model ...
Epoch: 12 cost time: 0.7677183151245117
Epoch: 12, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.400 Vali Acc: 0.926 Test Loss: 0.400 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925922).  Saving model ...
Epoch: 13 cost time: 0.756054162979126
Epoch: 13, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9756829738616943
Epoch: 14, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.318 Vali Acc: 0.915 Test Loss: 0.318 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1053266525268555
Epoch: 15, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937034).  Saving model ...
Epoch: 16 cost time: 1.008465051651001
Epoch: 16, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7775402069091797
Epoch: 17, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.253 Vali Acc: 0.915 Test Loss: 0.253 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8728294372558594
Epoch: 18, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9822750091552734
Epoch: 19, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9497394561767578
Epoch: 20, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.937034 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 1.0293993949890137
Epoch: 21, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.176 Vali Acc: 0.959 Test Loss: 0.176 Test Acc: 0.959
Validation loss decreased (-0.951850 --> -0.959258).  Saving model ...
Epoch: 22 cost time: 0.7670135498046875
Epoch: 22, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.807668924331665
Epoch: 23, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
Validation loss decreased (-0.959258 --> -0.962961).  Saving model ...
Epoch: 24 cost time: 0.9194529056549072
Epoch: 24, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9118177890777588
Epoch: 25, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7649695873260498
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8725824356079102
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8417873382568359
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9128086566925049
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0414423942565918
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7552461624145508
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8244986534118652
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7832350730895996
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 11109430
model size : 47.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.835474729537964
Epoch: 1, Steps: 2 | Train Loss: 1.987 Vali Loss: 1.968 Vali Acc: 0.026 Test Loss: 1.968 Test Acc: 0.026
Validation loss decreased (inf --> -0.025906).  Saving model ...
Epoch: 2 cost time: 0.9765810966491699
Epoch: 2, Steps: 2 | Train Loss: 1.925 Vali Loss: 1.929 Vali Acc: 0.033 Test Loss: 1.929 Test Acc: 0.033
Validation loss decreased (-0.025906 --> -0.033314).  Saving model ...
Epoch: 3 cost time: 0.9126455783843994
Epoch: 3, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.847 Vali Acc: 0.130 Test Loss: 1.847 Test Acc: 0.130
Validation loss decreased (-0.033314 --> -0.129611).  Saving model ...
Epoch: 4 cost time: 0.7893965244293213
Epoch: 4, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.717 Vali Acc: 0.233 Test Loss: 1.717 Test Acc: 0.233
Validation loss decreased (-0.129611 --> -0.233316).  Saving model ...
Epoch: 5 cost time: 0.8466315269470215
Epoch: 5, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.563 Vali Acc: 0.474 Test Loss: 1.563 Test Acc: 0.474
Validation loss decreased (-0.233316 --> -0.474058).  Saving model ...
Epoch: 6 cost time: 0.9844253063201904
Epoch: 6, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.366 Vali Acc: 0.767 Test Loss: 1.366 Test Acc: 0.767
Validation loss decreased (-0.474058 --> -0.766653).  Saving model ...
Epoch: 7 cost time: 0.9055743217468262
Epoch: 7, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.181 Vali Acc: 0.781 Test Loss: 1.181 Test Acc: 0.781
Validation loss decreased (-0.766653 --> -0.781470).  Saving model ...
Epoch: 8 cost time: 0.8908400535583496
Epoch: 8, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.033 Vali Acc: 0.759 Test Loss: 1.033 Test Acc: 0.759
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9774222373962402
Epoch: 9, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.883 Vali Acc: 0.781 Test Loss: 0.883 Test Acc: 0.781
Validation loss decreased (-0.781470 --> -0.781473).  Saving model ...
Epoch: 10 cost time: 0.7710423469543457
Epoch: 10, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.721 Vali Acc: 0.885 Test Loss: 0.721 Test Acc: 0.885
Validation loss decreased (-0.781473 --> -0.885178).  Saving model ...
Epoch: 11 cost time: 0.9174377918243408
Epoch: 11, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.593 Vali Acc: 0.930 Test Loss: 0.593 Test Acc: 0.930
Validation loss decreased (-0.885178 --> -0.929624).  Saving model ...
Epoch: 12 cost time: 0.8382928371429443
Epoch: 12, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.496 Vali Acc: 0.907 Test Loss: 0.496 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0899488925933838
Epoch: 13, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.433 Vali Acc: 0.878 Test Loss: 0.433 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9421298503875732
Epoch: 14, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.345 Vali Acc: 0.926 Test Loss: 0.345 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7678184509277344
Epoch: 15, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.287 Vali Acc: 0.937 Test Loss: 0.287 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937034).  Saving model ...
Epoch: 16 cost time: 0.8461270332336426
Epoch: 16, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.276 Vali Acc: 0.926 Test Loss: 0.276 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9355051517486572
Epoch: 17, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.266 Vali Acc: 0.919 Test Loss: 0.266 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9720454216003418
Epoch: 18, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.910820722579956
Epoch: 19, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.8377997875213623
Epoch: 20, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0160365104675293
Epoch: 21, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8619253635406494
Epoch: 22, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8439228534698486
Epoch: 23, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.226 Vali Acc: 0.915 Test Loss: 0.226 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8791086673736572
Epoch: 24, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7935230731964111
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7213125228881836
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8197259902954102
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.9601969718933105
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.8077201843261719
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.9073660373687744
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.907005786895752
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9099624156951904
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8948523998260498
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7278456687927246
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9319818019866943
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9160606861114502
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.139491081237793
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8643276691436768
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
Validation loss decreased (-0.944443 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.9039022922515869
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8829536437988281
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8041977882385254
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7748298645019531
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9104068279266357
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7974748611450195
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8723433017730713
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8056654930114746
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8589169979095459
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8994905948638916
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 11106614
model size : 47.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.909838914871216
Epoch: 1, Steps: 2 | Train Loss: 2.134 Vali Loss: 2.026 Vali Acc: 0.167 Test Loss: 2.026 Test Acc: 0.167
Validation loss decreased (inf --> -0.166646).  Saving model ...
Epoch: 2 cost time: 0.832155704498291
Epoch: 2, Steps: 2 | Train Loss: 2.070 Vali Loss: 1.937 Vali Acc: 0.167 Test Loss: 1.937 Test Acc: 0.167
Validation loss decreased (-0.166646 --> -0.166647).  Saving model ...
Epoch: 3 cost time: 0.8503191471099854
Epoch: 3, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.794 Vali Acc: 0.181 Test Loss: 1.794 Test Acc: 0.181
Validation loss decreased (-0.166647 --> -0.181464).  Saving model ...
Epoch: 4 cost time: 0.9562287330627441
Epoch: 4, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.679 Vali Acc: 0.433 Test Loss: 1.679 Test Acc: 0.433
Validation loss decreased (-0.181464 --> -0.433317).  Saving model ...
Epoch: 5 cost time: 0.967799186706543
Epoch: 5, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.624 Vali Acc: 0.496 Test Loss: 1.624 Test Acc: 0.496
Validation loss decreased (-0.433317 --> -0.496280).  Saving model ...
Epoch: 6 cost time: 0.8451788425445557
Epoch: 6, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.519 Vali Acc: 0.630 Test Loss: 1.519 Test Acc: 0.630
Validation loss decreased (-0.496280 --> -0.629614).  Saving model ...
Epoch: 7 cost time: 0.9304308891296387
Epoch: 7, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.324 Vali Acc: 0.730 Test Loss: 1.324 Test Acc: 0.730
Validation loss decreased (-0.629614 --> -0.729616).  Saving model ...
Epoch: 8 cost time: 0.9190940856933594
Epoch: 8, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.085 Vali Acc: 0.696 Test Loss: 1.085 Test Acc: 0.696
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0686147212982178
Epoch: 9, Steps: 2 | Train Loss: 1.002 Vali Loss: 0.895 Vali Acc: 0.826 Test Loss: 0.895 Test Acc: 0.826
Validation loss decreased (-0.729616 --> -0.825917).  Saving model ...
Epoch: 10 cost time: 0.8105521202087402
Epoch: 10, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.777 Vali Acc: 0.833 Test Loss: 0.777 Test Acc: 0.833
Validation loss decreased (-0.825917 --> -0.833326).  Saving model ...
Epoch: 11 cost time: 0.8338918685913086
Epoch: 11, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.662 Vali Acc: 0.867 Test Loss: 0.662 Test Acc: 0.867
Validation loss decreased (-0.833326 --> -0.866660).  Saving model ...
Epoch: 12 cost time: 0.7603826522827148
Epoch: 12, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.568 Vali Acc: 0.904 Test Loss: 0.568 Test Acc: 0.904
Validation loss decreased (-0.866660 --> -0.903698).  Saving model ...
Epoch: 13 cost time: 0.8489313125610352
Epoch: 13, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.486 Vali Acc: 0.907 Test Loss: 0.486 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907403).  Saving model ...
Epoch: 14 cost time: 0.8410866260528564
Epoch: 14, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.407 Vali Acc: 0.911 Test Loss: 0.407 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 15 cost time: 0.8136451244354248
Epoch: 15, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
Validation loss decreased (-0.911107 --> -0.940737).  Saving model ...
Epoch: 16 cost time: 0.8770046234130859
Epoch: 16, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.9521615505218506
Epoch: 17, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 18 cost time: 0.9040117263793945
Epoch: 18, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8826274871826172
Epoch: 19, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7518692016601562
Epoch: 20, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.7553071975708008
Epoch: 21, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.8511977195739746
Epoch: 22, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9848403930664062
Epoch: 23, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9933614730834961
Epoch: 24, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.164609432220459
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.246 Vali Acc: 0.919 Test Loss: 0.246 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8311872482299805
Epoch: 26, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.239 Vali Acc: 0.915 Test Loss: 0.239 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0684974193572998
Epoch: 27, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9492480754852295
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8514485359191895
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 1.261795997619629
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
Validation loss decreased (-0.951850 --> -0.959258).  Saving model ...
Epoch: 31 cost time: 0.7498879432678223
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 32 cost time: 0.8839600086212158
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
Validation loss decreased (-0.959258 --> -0.962961).  Saving model ...
Epoch: 33 cost time: 0.9478604793548584
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8711488246917725
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8308424949645996
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0417191982269287
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.9961245059967041
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.867351770401001
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.9568216800689697
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1205179691314697
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9854340553283691
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.0051417350769043
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 9276470
model size : 40.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.235522985458374
Epoch: 1, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.849 Vali Acc: 0.070 Test Loss: 1.849 Test Acc: 0.070
Validation loss decreased (inf --> -0.070352).  Saving model ...
Epoch: 2 cost time: 0.9815402030944824
Epoch: 2, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.813 Vali Acc: 0.104 Test Loss: 1.813 Test Acc: 0.104
Validation loss decreased (-0.070352 --> -0.103686).  Saving model ...
Epoch: 3 cost time: 0.8360128402709961
Epoch: 3, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.740 Vali Acc: 0.252 Test Loss: 1.740 Test Acc: 0.252
Validation loss decreased (-0.103686 --> -0.251834).  Saving model ...
Epoch: 4 cost time: 1.318005084991455
Epoch: 4, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.611 Vali Acc: 0.574 Test Loss: 1.611 Test Acc: 0.574
Validation loss decreased (-0.251834 --> -0.574058).  Saving model ...
Epoch: 5 cost time: 1.0244460105895996
Epoch: 5, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.462 Vali Acc: 0.581 Test Loss: 1.462 Test Acc: 0.581
Validation loss decreased (-0.574058 --> -0.581467).  Saving model ...
Epoch: 6 cost time: 0.8402364253997803
Epoch: 6, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.293 Vali Acc: 0.689 Test Loss: 1.293 Test Acc: 0.689
Validation loss decreased (-0.581467 --> -0.688876).  Saving model ...
Epoch: 7 cost time: 0.8872199058532715
Epoch: 7, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.108 Vali Acc: 0.841 Test Loss: 1.108 Test Acc: 0.841
Validation loss decreased (-0.688876 --> -0.840730).  Saving model ...
Epoch: 8 cost time: 1.040764570236206
Epoch: 8, Steps: 2 | Train Loss: 0.946 Vali Loss: 0.940 Vali Acc: 0.878 Test Loss: 0.940 Test Acc: 0.878
Validation loss decreased (-0.840730 --> -0.877768).  Saving model ...
Epoch: 9 cost time: 0.8810453414916992
Epoch: 9, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.800 Vali Acc: 0.848 Test Loss: 0.800 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9848268032073975
Epoch: 10, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.664 Vali Acc: 0.896 Test Loss: 0.664 Test Acc: 0.896
Validation loss decreased (-0.877768 --> -0.896290).  Saving model ...
Epoch: 11 cost time: 0.8563013076782227
Epoch: 11, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.549 Vali Acc: 0.922 Test Loss: 0.549 Test Acc: 0.922
Validation loss decreased (-0.896290 --> -0.922217).  Saving model ...
Epoch: 12 cost time: 0.8575847148895264
Epoch: 12, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3822124004364014
Epoch: 13, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.423 Vali Acc: 0.893 Test Loss: 0.423 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9545295238494873
Epoch: 14, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.365 Vali Acc: 0.911 Test Loss: 0.365 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9831268787384033
Epoch: 15, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.323 Vali Acc: 0.907 Test Loss: 0.323 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9657495021820068
Epoch: 16, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.279 Vali Acc: 0.919 Test Loss: 0.279 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8012175559997559
Epoch: 17, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.252 Vali Acc: 0.915 Test Loss: 0.252 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9277489185333252
Epoch: 18, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 1.089038372039795
Epoch: 19, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 1.0399293899536133
Epoch: 20, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.223 Vali Acc: 0.911 Test Loss: 0.223 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8369119167327881
Epoch: 21, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.214 Vali Acc: 0.919 Test Loss: 0.214 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9689583778381348
Epoch: 22, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.8725404739379883
Epoch: 23, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933332).  Saving model ...
Epoch: 24 cost time: 0.8984177112579346
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.933332 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.9573755264282227
Epoch: 25, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.912269115447998
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.2764852046966553
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0335819721221924
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.935680627822876
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.948 Test Loss: 0.157 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948147).  Saving model ...
Epoch: 30 cost time: 0.8984050750732422
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.160 Vali Acc: 0.944 Test Loss: 0.160 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0645971298217773
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8279333114624023
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.3945441246032715
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.953444242477417
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8788366317749023
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9244699478149414
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9607200622558594
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.9327969551086426
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9579832553863525
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 9273654
model size : 40.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.246760845184326
Epoch: 1, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.800 Vali Acc: 0.237 Test Loss: 1.800 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 0.6750342845916748
Epoch: 2, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.734 Vali Acc: 0.285 Test Loss: 1.734 Test Acc: 0.285
Validation loss decreased (-0.237019 --> -0.285168).  Saving model ...
Epoch: 3 cost time: 0.8290524482727051
Epoch: 3, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.633 Vali Acc: 0.344 Test Loss: 1.633 Test Acc: 0.344
Validation loss decreased (-0.285168 --> -0.344428).  Saving model ...
Epoch: 4 cost time: 0.7470836639404297
Epoch: 4, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.529 Vali Acc: 0.452 Test Loss: 1.529 Test Acc: 0.452
Validation loss decreased (-0.344428 --> -0.451837).  Saving model ...
Epoch: 5 cost time: 0.8796241283416748
Epoch: 5, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.430 Vali Acc: 0.470 Test Loss: 1.430 Test Acc: 0.470
Validation loss decreased (-0.451837 --> -0.470356).  Saving model ...
Epoch: 6 cost time: 0.9032101631164551
Epoch: 6, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.269 Vali Acc: 0.567 Test Loss: 1.269 Test Acc: 0.567
Validation loss decreased (-0.470356 --> -0.566654).  Saving model ...
Epoch: 7 cost time: 1.0314972400665283
Epoch: 7, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.068 Vali Acc: 0.722 Test Loss: 1.068 Test Acc: 0.722
Validation loss decreased (-0.566654 --> -0.722212).  Saving model ...
Epoch: 8 cost time: 0.7504417896270752
Epoch: 8, Steps: 2 | Train Loss: 0.939 Vali Loss: 0.899 Vali Acc: 0.811 Test Loss: 0.899 Test Acc: 0.811
Validation loss decreased (-0.722212 --> -0.811102).  Saving model ...
Epoch: 9 cost time: 0.9163694381713867
Epoch: 9, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.797 Vali Acc: 0.763 Test Loss: 0.797 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9736835956573486
Epoch: 10, Steps: 2 | Train Loss: 0.721 Vali Loss: 0.671 Vali Acc: 0.859 Test Loss: 0.671 Test Acc: 0.859
Validation loss decreased (-0.811102 --> -0.859253).  Saving model ...
Epoch: 11 cost time: 0.9531888961791992
Epoch: 11, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.544 Vali Acc: 0.896 Test Loss: 0.544 Test Acc: 0.896
Validation loss decreased (-0.859253 --> -0.896291).  Saving model ...
Epoch: 12 cost time: 0.9711360931396484
Epoch: 12, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.470 Vali Acc: 0.881 Test Loss: 0.470 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8191959857940674
Epoch: 13, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.455 Vali Acc: 0.837 Test Loss: 0.455 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9546117782592773
Epoch: 14, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9337832927703857
Epoch: 15, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.326 Vali Acc: 0.911 Test Loss: 0.326 Test Acc: 0.911
Validation loss decreased (-0.896291 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 1.0775339603424072
Epoch: 16, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.295 Vali Acc: 0.919 Test Loss: 0.295 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918516).  Saving model ...
Epoch: 17 cost time: 1.1650443077087402
Epoch: 17, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
Validation loss decreased (-0.918516 --> -0.937034).  Saving model ...
Epoch: 18 cost time: 0.7648262977600098
Epoch: 18, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.9435083866119385
Epoch: 19, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8894293308258057
Epoch: 20, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1343872547149658
Epoch: 21, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8936827182769775
Epoch: 22, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0833916664123535
Epoch: 23, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0469164848327637
Epoch: 24, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9425520896911621
Epoch: 25, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.887049674987793
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8105876445770264
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0741252899169922
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 9270838
model size : 40.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.900911331176758
Epoch: 1, Steps: 2 | Train Loss: 2.129 Vali Loss: 2.038 Vali Acc: 0.089 Test Loss: 2.038 Test Acc: 0.089
Validation loss decreased (inf --> -0.088869).  Saving model ...
Epoch: 2 cost time: 0.8131313323974609
Epoch: 2, Steps: 2 | Train Loss: 2.063 Vali Loss: 1.986 Vali Acc: 0.052 Test Loss: 1.986 Test Acc: 0.052
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7248506546020508
Epoch: 3, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.895 Vali Acc: 0.056 Test Loss: 1.895 Test Acc: 0.056
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7648031711578369
Epoch: 4, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.767 Vali Acc: 0.270 Test Loss: 1.767 Test Acc: 0.270
Validation loss decreased (-0.088869 --> -0.270353).  Saving model ...
Epoch: 5 cost time: 0.8438720703125
Epoch: 5, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.635 Vali Acc: 0.337 Test Loss: 1.635 Test Acc: 0.337
Validation loss decreased (-0.270353 --> -0.337021).  Saving model ...
Epoch: 6 cost time: 0.7470781803131104
Epoch: 6, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.466 Vali Acc: 0.474 Test Loss: 1.466 Test Acc: 0.474
Validation loss decreased (-0.337021 --> -0.474059).  Saving model ...
Epoch: 7 cost time: 0.9772007465362549
Epoch: 7, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.260 Vali Acc: 0.681 Test Loss: 1.260 Test Acc: 0.681
Validation loss decreased (-0.474059 --> -0.681469).  Saving model ...
Epoch: 8 cost time: 0.8949236869812012
Epoch: 8, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.088 Vali Acc: 0.819 Test Loss: 1.088 Test Acc: 0.819
Validation loss decreased (-0.681469 --> -0.818508).  Saving model ...
Epoch: 9 cost time: 0.865447998046875
Epoch: 9, Steps: 2 | Train Loss: 0.980 Vali Loss: 0.954 Vali Acc: 0.770 Test Loss: 0.954 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7420346736907959
Epoch: 10, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.786 Vali Acc: 0.874 Test Loss: 0.786 Test Acc: 0.874
Validation loss decreased (-0.818508 --> -0.874066).  Saving model ...
Epoch: 11 cost time: 0.874598503112793
Epoch: 11, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.655 Vali Acc: 0.881 Test Loss: 0.655 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881475).  Saving model ...
Epoch: 12 cost time: 0.7988114356994629
Epoch: 12, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7774016857147217
Epoch: 13, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.489 Vali Acc: 0.833 Test Loss: 0.489 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7615678310394287
Epoch: 14, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.408 Vali Acc: 0.885 Test Loss: 0.408 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885181).  Saving model ...
Epoch: 15 cost time: 0.850825309753418
Epoch: 15, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
Validation loss decreased (-0.885181 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 0.7595300674438477
Epoch: 16, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.305 Vali Acc: 0.919 Test Loss: 0.305 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918515).  Saving model ...
Epoch: 17 cost time: 1.0240144729614258
Epoch: 17, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.276 Vali Acc: 0.926 Test Loss: 0.276 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 0.904576301574707
Epoch: 18, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9073996543884277
Epoch: 19, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.250 Vali Acc: 0.907 Test Loss: 0.250 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9279482364654541
Epoch: 20, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1547014713287354
Epoch: 21, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 22 cost time: 0.688880205154419
Epoch: 22, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 0.8166601657867432
Epoch: 23, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0164790153503418
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0109436511993408
Epoch: 25, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8610806465148926
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9251260757446289
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8809127807617188
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 1.0017669200897217
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.155992031097412
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9272663593292236
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8610436916351318
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 1.1695787906646729
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7324392795562744
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.8736648559570312
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.8387813568115234
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 1.0029618740081787
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1568419933319092
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1168980598449707
Epoch: 39, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0351428985595703
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7471535205841064
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9172830581665039
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9751396179199219
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9470643997192383
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8794558048248291
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.9266624450683594
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 9268022
model size : 40.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1323132514953613
Epoch: 1, Steps: 2 | Train Loss: 1.998 Vali Loss: 1.918 Vali Acc: 0.193 Test Loss: 1.918 Test Acc: 0.193
Validation loss decreased (inf --> -0.192573).  Saving model ...
Epoch: 2 cost time: 0.8489999771118164
Epoch: 2, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.838 Vali Acc: 0.244 Test Loss: 1.838 Test Acc: 0.244
Validation loss decreased (-0.192573 --> -0.244426).  Saving model ...
Epoch: 3 cost time: 0.6804170608520508
Epoch: 3, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.724 Vali Acc: 0.285 Test Loss: 1.724 Test Acc: 0.285
Validation loss decreased (-0.244426 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.9757685661315918
Epoch: 4, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.605 Vali Acc: 0.378 Test Loss: 1.605 Test Acc: 0.378
Validation loss decreased (-0.285168 --> -0.377762).  Saving model ...
Epoch: 5 cost time: 1.0851449966430664
Epoch: 5, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.559 Vali Acc: 0.307 Test Loss: 1.559 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8821532726287842
Epoch: 6, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.451 Vali Acc: 0.433 Test Loss: 1.451 Test Acc: 0.433
Validation loss decreased (-0.377762 --> -0.433319).  Saving model ...
Epoch: 7 cost time: 0.9633398056030273
Epoch: 7, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.258 Vali Acc: 0.644 Test Loss: 1.258 Test Acc: 0.644
Validation loss decreased (-0.433319 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 0.828998327255249
Epoch: 8, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.049 Vali Acc: 0.778 Test Loss: 1.049 Test Acc: 0.778
Validation loss decreased (-0.644432 --> -0.777767).  Saving model ...
Epoch: 9 cost time: 0.8949391841888428
Epoch: 9, Steps: 2 | Train Loss: 0.932 Vali Loss: 0.894 Vali Acc: 0.844 Test Loss: 0.894 Test Acc: 0.844
Validation loss decreased (-0.777767 --> -0.844436).  Saving model ...
Epoch: 10 cost time: 0.8928849697113037
Epoch: 10, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.775 Vali Acc: 0.826 Test Loss: 0.775 Test Acc: 0.826
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.200371265411377
Epoch: 11, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.654 Vali Acc: 0.881 Test Loss: 0.654 Test Acc: 0.881
Validation loss decreased (-0.844436 --> -0.881475).  Saving model ...
Epoch: 12 cost time: 0.9120733737945557
Epoch: 12, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.546 Vali Acc: 0.896 Test Loss: 0.546 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896291).  Saving model ...
Epoch: 13 cost time: 0.90191650390625
Epoch: 13, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.462 Vali Acc: 0.926 Test Loss: 0.462 Test Acc: 0.926
Validation loss decreased (-0.896291 --> -0.925921).  Saving model ...
Epoch: 14 cost time: 0.6585218906402588
Epoch: 14, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.403 Vali Acc: 0.904 Test Loss: 0.403 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7487540245056152
Epoch: 15, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.396 Vali Acc: 0.852 Test Loss: 0.396 Test Acc: 0.852
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8460233211517334
Epoch: 16, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.343 Vali Acc: 0.885 Test Loss: 0.343 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0651171207427979
Epoch: 17, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.263 Vali Acc: 0.948 Test Loss: 0.263 Test Acc: 0.948
Validation loss decreased (-0.925921 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.7387101650238037
Epoch: 18, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7415933609008789
Epoch: 19, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9135646820068359
Epoch: 20, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9061188697814941
Epoch: 21, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.298 Vali Acc: 0.867 Test Loss: 0.298 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8899490833282471
Epoch: 22, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7675316333770752
Epoch: 23, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.8134589195251465
Epoch: 24, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 25 cost time: 0.8055288791656494
Epoch: 25, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8129386901855469
Epoch: 26, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1974048614501953
Epoch: 27, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7810873985290527
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.261 Vali Acc: 0.915 Test Loss: 0.261 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8350527286529541
Epoch: 29, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.283 Vali Acc: 0.904 Test Loss: 0.283 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.059213399887085
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.273 Vali Acc: 0.911 Test Loss: 0.273 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9409794807434082
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9189238548278809
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8710682392120361
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.8148646354675293
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.8596999645233154
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7557923793792725
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 37 cost time: 0.808060884475708
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9162030220031738
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.959 Test Loss: 0.158 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959258).  Saving model ...
Epoch: 39 cost time: 0.8707282543182373
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8392796516418457
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8490827083587646
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8546454906463623
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.83730149269104
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9252018928527832
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8678748607635498
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.863800048828125
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.922292947769165
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.827803373336792
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 8357174
model size : 36.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1059281826019287
Epoch: 1, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.766 Vali Acc: 0.244 Test Loss: 1.766 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 1.0490727424621582
Epoch: 2, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.733 Vali Acc: 0.252 Test Loss: 1.733 Test Acc: 0.252
Validation loss decreased (-0.244427 --> -0.251835).  Saving model ...
Epoch: 3 cost time: 0.8471164703369141
Epoch: 3, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.664 Vali Acc: 0.263 Test Loss: 1.664 Test Acc: 0.263
Validation loss decreased (-0.251835 --> -0.262946).  Saving model ...
Epoch: 4 cost time: 0.8257896900177002
Epoch: 4, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.558 Vali Acc: 0.437 Test Loss: 1.558 Test Acc: 0.437
Validation loss decreased (-0.262946 --> -0.437021).  Saving model ...
Epoch: 5 cost time: 0.9439175128936768
Epoch: 5, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.447 Vali Acc: 0.474 Test Loss: 1.447 Test Acc: 0.474
Validation loss decreased (-0.437021 --> -0.474060).  Saving model ...
Epoch: 6 cost time: 0.9404714107513428
Epoch: 6, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.315 Vali Acc: 0.552 Test Loss: 1.315 Test Acc: 0.552
Validation loss decreased (-0.474060 --> -0.551839).  Saving model ...
Epoch: 7 cost time: 0.8231549263000488
Epoch: 7, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.163 Vali Acc: 0.693 Test Loss: 1.163 Test Acc: 0.693
Validation loss decreased (-0.551839 --> -0.692581).  Saving model ...
Epoch: 8 cost time: 0.9765145778656006
Epoch: 8, Steps: 2 | Train Loss: 1.051 Vali Loss: 0.996 Vali Acc: 0.856 Test Loss: 0.996 Test Acc: 0.856
Validation loss decreased (-0.692581 --> -0.855546).  Saving model ...
Epoch: 9 cost time: 0.9261419773101807
Epoch: 9, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.857 Vali Acc: 0.830 Test Loss: 0.857 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1531944274902344
Epoch: 10, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.729 Vali Acc: 0.863 Test Loss: 0.729 Test Acc: 0.863
Validation loss decreased (-0.855546 --> -0.862956).  Saving model ...
Epoch: 11 cost time: 0.8076257705688477
Epoch: 11, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.603 Vali Acc: 0.919 Test Loss: 0.603 Test Acc: 0.919
Validation loss decreased (-0.862956 --> -0.918512).  Saving model ...
Epoch: 12 cost time: 0.9166507720947266
Epoch: 12, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.513 Vali Acc: 0.911 Test Loss: 0.513 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.122713327407837
Epoch: 13, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.436 Vali Acc: 0.911 Test Loss: 0.436 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9084343910217285
Epoch: 14, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.365 Vali Acc: 0.915 Test Loss: 0.365 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9004833698272705
Epoch: 15, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9632034301757812
Epoch: 16, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.314 Vali Acc: 0.915 Test Loss: 0.314 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8532328605651855
Epoch: 17, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.918512 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.8713946342468262
Epoch: 18, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9733023643493652
Epoch: 19, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0047247409820557
Epoch: 20, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.258 Vali Acc: 0.904 Test Loss: 0.258 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8521826267242432
Epoch: 21, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.233 Vali Acc: 0.907 Test Loss: 0.233 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0252609252929688
Epoch: 22, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9161088466644287
Epoch: 23, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
Validation loss decreased (-0.944442 --> -0.959258).  Saving model ...
Epoch: 24 cost time: 0.8283090591430664
Epoch: 24, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7986588478088379
Epoch: 25, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 26 cost time: 1.0039441585540771
Epoch: 26, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0400688648223877
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8305258750915527
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.890920877456665
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.915 Test Loss: 0.217 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7961018085479736
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8442990779876709
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.930 Test Loss: 0.187 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0702855587005615
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8542394638061523
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8385586738586426
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9384410381317139
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 8354358
model size : 36.90MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.048872947692871
Epoch: 1, Steps: 2 | Train Loss: 2.054 Vali Loss: 1.994 Vali Acc: 0.167 Test Loss: 1.994 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.838153600692749
Epoch: 2, Steps: 2 | Train Loss: 2.011 Vali Loss: 1.931 Vali Acc: 0.174 Test Loss: 1.931 Test Acc: 0.174
Validation loss decreased (-0.166647 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 1.008805513381958
Epoch: 3, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.827 Vali Acc: 0.215 Test Loss: 1.827 Test Acc: 0.215
Validation loss decreased (-0.174055 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 1.2337441444396973
Epoch: 4, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.705 Vali Acc: 0.281 Test Loss: 1.705 Test Acc: 0.281
Validation loss decreased (-0.214797 --> -0.281464).  Saving model ...
Epoch: 5 cost time: 1.1364047527313232
Epoch: 5, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.629 Vali Acc: 0.344 Test Loss: 1.629 Test Acc: 0.344
Validation loss decreased (-0.281464 --> -0.344428).  Saving model ...
Epoch: 6 cost time: 0.9075169563293457
Epoch: 6, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.519 Vali Acc: 0.448 Test Loss: 1.519 Test Acc: 0.448
Validation loss decreased (-0.344428 --> -0.448133).  Saving model ...
Epoch: 7 cost time: 0.9455540180206299
Epoch: 7, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.325 Vali Acc: 0.537 Test Loss: 1.325 Test Acc: 0.537
Validation loss decreased (-0.448133 --> -0.537024).  Saving model ...
Epoch: 8 cost time: 0.9221591949462891
Epoch: 8, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.134 Vali Acc: 0.752 Test Loss: 1.134 Test Acc: 0.752
Validation loss decreased (-0.537024 --> -0.751841).  Saving model ...
Epoch: 9 cost time: 0.9352600574493408
Epoch: 9, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.010 Vali Acc: 0.767 Test Loss: 1.010 Test Acc: 0.767
Validation loss decreased (-0.751841 --> -0.766657).  Saving model ...
Epoch: 10 cost time: 0.9822649955749512
Epoch: 10, Steps: 2 | Train Loss: 0.933 Vali Loss: 0.912 Vali Acc: 0.781 Test Loss: 0.912 Test Acc: 0.781
Validation loss decreased (-0.766657 --> -0.781472).  Saving model ...
Epoch: 11 cost time: 0.9114980697631836
Epoch: 11, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.762 Vali Acc: 0.800 Test Loss: 0.762 Test Acc: 0.800
Validation loss decreased (-0.781472 --> -0.799992).  Saving model ...
Epoch: 12 cost time: 1.1340796947479248
Epoch: 12, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.609 Vali Acc: 0.893 Test Loss: 0.609 Test Acc: 0.893
Validation loss decreased (-0.799992 --> -0.892587).  Saving model ...
Epoch: 13 cost time: 0.9689292907714844
Epoch: 13, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.518 Vali Acc: 0.904 Test Loss: 0.518 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903699).  Saving model ...
Epoch: 14 cost time: 1.0659444332122803
Epoch: 14, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.447 Vali Acc: 0.889 Test Loss: 0.447 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9074678421020508
Epoch: 15, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.402 Vali Acc: 0.863 Test Loss: 0.402 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.027963638305664
Epoch: 16, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.333 Vali Acc: 0.904 Test Loss: 0.333 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903700).  Saving model ...
Epoch: 17 cost time: 0.7257916927337646
Epoch: 17, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.294 Vali Acc: 0.915 Test Loss: 0.294 Test Acc: 0.915
Validation loss decreased (-0.903700 --> -0.914812).  Saving model ...
Epoch: 18 cost time: 1.0096538066864014
Epoch: 18, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.273 Vali Acc: 0.915 Test Loss: 0.273 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 19 cost time: 0.9259555339813232
Epoch: 19, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.278 Vali Acc: 0.904 Test Loss: 0.278 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6282463073730469
Epoch: 20, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.264 Vali Acc: 0.904 Test Loss: 0.264 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.863492488861084
Epoch: 21, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 0.7882800102233887
Epoch: 22, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 23 cost time: 0.9113237857818604
Epoch: 23, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.925924 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 1.0102195739746094
Epoch: 24, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.8151583671569824
Epoch: 25, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0035991668701172
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.905745267868042
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9874923229217529
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9087505340576172
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.935356855392456
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.005397081375122
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9203155040740967
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9368314743041992
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8861825466156006
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 8351542
model size : 36.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8687446117401123
Epoch: 1, Steps: 2 | Train Loss: 2.012 Vali Loss: 1.935 Vali Acc: 0.156 Test Loss: 1.935 Test Acc: 0.156
Validation loss decreased (inf --> -0.155536).  Saving model ...
Epoch: 2 cost time: 0.89784836769104
Epoch: 2, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.902 Vali Acc: 0.159 Test Loss: 1.902 Test Acc: 0.159
Validation loss decreased (-0.155536 --> -0.159240).  Saving model ...
Epoch: 3 cost time: 0.9043383598327637
Epoch: 3, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.830 Vali Acc: 0.152 Test Loss: 1.830 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9396491050720215
Epoch: 4, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.714 Vali Acc: 0.248 Test Loss: 1.714 Test Acc: 0.248
Validation loss decreased (-0.159240 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 0.981982946395874
Epoch: 5, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.590 Vali Acc: 0.404 Test Loss: 1.590 Test Acc: 0.404
Validation loss decreased (-0.248131 --> -0.403688).  Saving model ...
Epoch: 6 cost time: 0.9004237651824951
Epoch: 6, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.425 Vali Acc: 0.585 Test Loss: 1.425 Test Acc: 0.585
Validation loss decreased (-0.403688 --> -0.585171).  Saving model ...
Epoch: 7 cost time: 0.9457857608795166
Epoch: 7, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.236 Vali Acc: 0.748 Test Loss: 1.236 Test Acc: 0.748
Validation loss decreased (-0.585171 --> -0.748136).  Saving model ...
Epoch: 8 cost time: 0.8963878154754639
Epoch: 8, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.070 Vali Acc: 0.822 Test Loss: 1.070 Test Acc: 0.822
Validation loss decreased (-0.748136 --> -0.822212).  Saving model ...
Epoch: 9 cost time: 1.0564179420471191
Epoch: 9, Steps: 2 | Train Loss: 0.929 Vali Loss: 0.930 Vali Acc: 0.789 Test Loss: 0.930 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9635391235351562
Epoch: 10, Steps: 2 | Train Loss: 0.742 Vali Loss: 0.775 Vali Acc: 0.893 Test Loss: 0.775 Test Acc: 0.893
Validation loss decreased (-0.822212 --> -0.892585).  Saving model ...
Epoch: 11 cost time: 1.0302140712738037
Epoch: 11, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.678 Vali Acc: 0.833 Test Loss: 0.678 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.014547348022461
Epoch: 12, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.567 Vali Acc: 0.885 Test Loss: 0.567 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8586418628692627
Epoch: 13, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.473 Vali Acc: 0.930 Test Loss: 0.473 Test Acc: 0.930
Validation loss decreased (-0.892585 --> -0.929625).  Saving model ...
Epoch: 14 cost time: 0.9269266128540039
Epoch: 14, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.408 Vali Acc: 0.922 Test Loss: 0.408 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0763320922851562
Epoch: 15, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.378 Vali Acc: 0.896 Test Loss: 0.378 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.873572587966919
Epoch: 16, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.325 Vali Acc: 0.915 Test Loss: 0.325 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8933191299438477
Epoch: 17, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.275 Vali Acc: 0.944 Test Loss: 0.275 Test Acc: 0.944
Validation loss decreased (-0.929625 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.7575454711914062
Epoch: 18, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.242 Vali Acc: 0.956 Test Loss: 0.242 Test Acc: 0.956
Validation loss decreased (-0.944442 --> -0.955553).  Saving model ...
Epoch: 19 cost time: 0.951977014541626
Epoch: 19, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.017573595046997
Epoch: 20, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0568900108337402
Epoch: 21, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 22 cost time: 1.0528724193572998
Epoch: 22, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8085784912109375
Epoch: 23, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9161779880523682
Epoch: 24, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5168840885162354
Epoch: 25, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1731250286102295
Epoch: 26, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.25516939163208
Epoch: 27, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9832284450531006
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0573928356170654
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2204480171203613
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9926221370697021
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
Validation loss decreased (-0.955554 --> -0.962961).  Saving model ...
Epoch: 32 cost time: 1.1651573181152344
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
Validation loss decreased (-0.962961 --> -0.962961).  Saving model ...
Epoch: 33 cost time: 0.9044959545135498
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8970696926116943
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.959 Test Loss: 0.160 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.0199525356292725
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.930898904800415
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.959 Test Loss: 0.169 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.8397328853607178
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9926769733428955
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.0205800533294678
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.896712064743042
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.0456435680389404
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.8475258350372314
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 8348726
model size : 36.88MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.744819164276123
Epoch: 1, Steps: 2 | Train Loss: 1.968 Vali Loss: 1.874 Vali Acc: 0.222 Test Loss: 1.874 Test Acc: 0.222
Validation loss decreased (inf --> -0.222203).  Saving model ...
Epoch: 2 cost time: 0.8130466938018799
Epoch: 2, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.821 Vali Acc: 0.259 Test Loss: 1.821 Test Acc: 0.259
Validation loss decreased (-0.222203 --> -0.259241).  Saving model ...
Epoch: 3 cost time: 0.7241318225860596
Epoch: 3, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.745 Vali Acc: 0.370 Test Loss: 1.745 Test Acc: 0.370
Validation loss decreased (-0.259241 --> -0.370353).  Saving model ...
Epoch: 4 cost time: 0.8382320404052734
Epoch: 4, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.643 Vali Acc: 0.333 Test Loss: 1.643 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8338072299957275
Epoch: 5, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.546 Vali Acc: 0.293 Test Loss: 1.546 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2053487300872803
Epoch: 6, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.435 Vali Acc: 0.400 Test Loss: 1.435 Test Acc: 0.400
Validation loss decreased (-0.370353 --> -0.399986).  Saving model ...
Epoch: 7 cost time: 0.9530868530273438
Epoch: 7, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.267 Vali Acc: 0.648 Test Loss: 1.267 Test Acc: 0.648
Validation loss decreased (-0.399986 --> -0.648135).  Saving model ...
Epoch: 8 cost time: 0.8222320079803467
Epoch: 8, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.096 Vali Acc: 0.763 Test Loss: 1.096 Test Acc: 0.763
Validation loss decreased (-0.648135 --> -0.762952).  Saving model ...
Epoch: 9 cost time: 0.7644743919372559
Epoch: 9, Steps: 2 | Train Loss: 1.022 Vali Loss: 0.961 Vali Acc: 0.896 Test Loss: 0.961 Test Acc: 0.896
Validation loss decreased (-0.762952 --> -0.896287).  Saving model ...
Epoch: 10 cost time: 0.854872465133667
Epoch: 10, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.848 Vali Acc: 0.874 Test Loss: 0.848 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9550127983093262
Epoch: 11, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.741 Vali Acc: 0.863 Test Loss: 0.741 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9001073837280273
Epoch: 12, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.624 Vali Acc: 0.900 Test Loss: 0.624 Test Acc: 0.900
Validation loss decreased (-0.896287 --> -0.899994).  Saving model ...
Epoch: 13 cost time: 0.694077730178833
Epoch: 13, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.536 Vali Acc: 0.919 Test Loss: 0.536 Test Acc: 0.919
Validation loss decreased (-0.899994 --> -0.918513).  Saving model ...
Epoch: 14 cost time: 0.8720700740814209
Epoch: 14, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.470 Vali Acc: 0.915 Test Loss: 0.470 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9252214431762695
Epoch: 15, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7994000911712646
Epoch: 16, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.344 Vali Acc: 0.926 Test Loss: 0.344 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925922).  Saving model ...
Epoch: 17 cost time: 0.9680986404418945
Epoch: 17, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.894864559173584
Epoch: 18, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.263 Vali Acc: 0.919 Test Loss: 0.263 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8272120952606201
Epoch: 19, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 20 cost time: 0.8601012229919434
Epoch: 20, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7966659069061279
Epoch: 21, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7830615043640137
Epoch: 22, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.828263521194458
Epoch: 23, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9038000106811523
Epoch: 24, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.963641881942749
Epoch: 25, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.7468011379241943
Epoch: 26, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.944443 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.9121062755584717
Epoch: 27, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.8651683330535889
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8181366920471191
Epoch: 29, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8177103996276855
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9229798316955566
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.965789794921875
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6795616149902344
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7683627605438232
Epoch: 34, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7799813747406006
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.000274419784546
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7467451095581055
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 7897526
model size : 35.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7401421070098877
Epoch: 1, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.782 Vali Acc: 0.193 Test Loss: 1.782 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.7909722328186035
Epoch: 2, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.738 Vali Acc: 0.267 Test Loss: 1.738 Test Acc: 0.267
Validation loss decreased (-0.192575 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 0.9740369319915771
Epoch: 3, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.666 Vali Acc: 0.367 Test Loss: 1.666 Test Acc: 0.367
Validation loss decreased (-0.266649 --> -0.366650).  Saving model ...
Epoch: 4 cost time: 0.7661964893341064
Epoch: 4, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.563 Vali Acc: 0.496 Test Loss: 1.563 Test Acc: 0.496
Validation loss decreased (-0.366650 --> -0.496281).  Saving model ...
Epoch: 5 cost time: 0.8333849906921387
Epoch: 5, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.481 Vali Acc: 0.415 Test Loss: 1.481 Test Acc: 0.415
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8740513324737549
Epoch: 6, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.351 Vali Acc: 0.504 Test Loss: 1.351 Test Acc: 0.504
Validation loss decreased (-0.496281 --> -0.503690).  Saving model ...
Epoch: 7 cost time: 0.8856511116027832
Epoch: 7, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.179 Vali Acc: 0.685 Test Loss: 1.179 Test Acc: 0.685
Validation loss decreased (-0.503690 --> -0.685173).  Saving model ...
Epoch: 8 cost time: 0.9239785671234131
Epoch: 8, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.023 Vali Acc: 0.874 Test Loss: 1.023 Test Acc: 0.874
Validation loss decreased (-0.685173 --> -0.874064).  Saving model ...
Epoch: 9 cost time: 0.7974789142608643
Epoch: 9, Steps: 2 | Train Loss: 0.963 Vali Loss: 0.911 Vali Acc: 0.863 Test Loss: 0.911 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9081170558929443
Epoch: 10, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.782 Vali Acc: 0.896 Test Loss: 0.782 Test Acc: 0.896
Validation loss decreased (-0.874064 --> -0.896288).  Saving model ...
Epoch: 11 cost time: 0.715935468673706
Epoch: 11, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.658 Vali Acc: 0.907 Test Loss: 0.658 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907401).  Saving model ...
Epoch: 12 cost time: 1.0595486164093018
Epoch: 12, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.574 Vali Acc: 0.889 Test Loss: 0.574 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0872793197631836
Epoch: 13, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.484 Vali Acc: 0.893 Test Loss: 0.484 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0323467254638672
Epoch: 14, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.406 Vali Acc: 0.907 Test Loss: 0.406 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907403).  Saving model ...
Epoch: 15 cost time: 1.0735654830932617
Epoch: 15, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.356 Vali Acc: 0.911 Test Loss: 0.356 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 0.7977221012115479
Epoch: 16, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918515).  Saving model ...
Epoch: 17 cost time: 1.0121314525604248
Epoch: 17, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.285 Vali Acc: 0.926 Test Loss: 0.285 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 1.025059461593628
Epoch: 18, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.7635226249694824
Epoch: 19, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 0.7150387763977051
Epoch: 20, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9026763439178467
Epoch: 21, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.749197244644165
Epoch: 22, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0049314498901367
Epoch: 23, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.784339427947998
Epoch: 24, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.6937191486358643
Epoch: 25, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.8143439292907715
Epoch: 26, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.768695592880249
Epoch: 27, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.9344680309295654
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.9559144973754883
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.866539478302002
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7418110370635986
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.880190372467041
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9880101680755615
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0392985343933105
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.229 Vali Acc: 0.915 Test Loss: 0.229 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0511906147003174
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.229 Vali Acc: 0.915 Test Loss: 0.229 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9740104675292969
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.915 Test Loss: 0.225 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.232923984527588
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.919 Test Loss: 0.218 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.941185474395752
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 7894710
model size : 35.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6874985694885254
Epoch: 1, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.859 Vali Acc: 0.059 Test Loss: 1.859 Test Acc: 0.059
Validation loss decreased (inf --> -0.059241).  Saving model ...
Epoch: 2 cost time: 0.9337551593780518
Epoch: 2, Steps: 2 | Train Loss: 1.942 Vali Loss: 1.810 Vali Acc: 0.074 Test Loss: 1.810 Test Acc: 0.074
Validation loss decreased (-0.059241 --> -0.074056).  Saving model ...
Epoch: 3 cost time: 0.9219202995300293
Epoch: 3, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.729 Vali Acc: 0.178 Test Loss: 1.729 Test Acc: 0.178
Validation loss decreased (-0.074056 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 1.0505528450012207
Epoch: 4, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.631 Vali Acc: 0.444 Test Loss: 1.631 Test Acc: 0.444
Validation loss decreased (-0.177760 --> -0.444428).  Saving model ...
Epoch: 5 cost time: 0.7282788753509521
Epoch: 5, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.551 Vali Acc: 0.459 Test Loss: 1.551 Test Acc: 0.459
Validation loss decreased (-0.444428 --> -0.459244).  Saving model ...
Epoch: 6 cost time: 0.8626172542572021
Epoch: 6, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.398 Vali Acc: 0.585 Test Loss: 1.398 Test Acc: 0.585
Validation loss decreased (-0.459244 --> -0.585171).  Saving model ...
Epoch: 7 cost time: 0.8061909675598145
Epoch: 7, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.216 Vali Acc: 0.674 Test Loss: 1.216 Test Acc: 0.674
Validation loss decreased (-0.585171 --> -0.674062).  Saving model ...
Epoch: 8 cost time: 0.959312915802002
Epoch: 8, Steps: 2 | Train Loss: 1.119 Vali Loss: 1.039 Vali Acc: 0.815 Test Loss: 1.039 Test Acc: 0.815
Validation loss decreased (-0.674062 --> -0.814804).  Saving model ...
Epoch: 9 cost time: 0.7634937763214111
Epoch: 9, Steps: 2 | Train Loss: 0.951 Vali Loss: 0.916 Vali Acc: 0.807 Test Loss: 0.916 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.045625925064087
Epoch: 10, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.790 Vali Acc: 0.874 Test Loss: 0.790 Test Acc: 0.874
Validation loss decreased (-0.814804 --> -0.874066).  Saving model ...
Epoch: 11 cost time: 0.9254510402679443
Epoch: 11, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.669 Vali Acc: 0.907 Test Loss: 0.669 Test Acc: 0.907
Validation loss decreased (-0.874066 --> -0.907401).  Saving model ...
Epoch: 12 cost time: 1.0275921821594238
Epoch: 12, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.568 Vali Acc: 0.922 Test Loss: 0.568 Test Acc: 0.922
Validation loss decreased (-0.907401 --> -0.922217).  Saving model ...
Epoch: 13 cost time: 1.0583579540252686
Epoch: 13, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.504 Vali Acc: 0.893 Test Loss: 0.504 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9331278800964355
Epoch: 14, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.427 Vali Acc: 0.937 Test Loss: 0.427 Test Acc: 0.937
Validation loss decreased (-0.922217 --> -0.937033).  Saving model ...
Epoch: 15 cost time: 0.7738234996795654
Epoch: 15, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.396 Vali Acc: 0.893 Test Loss: 0.396 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8978261947631836
Epoch: 16, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.376 Vali Acc: 0.874 Test Loss: 0.376 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9476821422576904
Epoch: 17, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.323 Vali Acc: 0.911 Test Loss: 0.323 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8873274326324463
Epoch: 18, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.281 Vali Acc: 0.922 Test Loss: 0.281 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0228006839752197
Epoch: 19, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.952996015548706
Epoch: 20, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8483002185821533
Epoch: 21, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.280 Vali Acc: 0.896 Test Loss: 0.280 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.096794843673706
Epoch: 22, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.296 Vali Acc: 0.896 Test Loss: 0.296 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.727891206741333
Epoch: 23, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.262 Vali Acc: 0.904 Test Loss: 0.262 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7800183296203613
Epoch: 24, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.225 Vali Acc: 0.926 Test Loss: 0.225 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 7891894
model size : 35.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.698164939880371
Epoch: 1, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.748 Vali Acc: 0.259 Test Loss: 1.748 Test Acc: 0.259
Validation loss decreased (inf --> -0.259242).  Saving model ...
Epoch: 2 cost time: 0.9743573665618896
Epoch: 2, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.701 Vali Acc: 0.274 Test Loss: 1.701 Test Acc: 0.274
Validation loss decreased (-0.259242 --> -0.274057).  Saving model ...
Epoch: 3 cost time: 0.9445154666900635
Epoch: 3, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.631 Vali Acc: 0.267 Test Loss: 1.631 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8917267322540283
Epoch: 4, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.540 Vali Acc: 0.533 Test Loss: 1.540 Test Acc: 0.533
Validation loss decreased (-0.274057 --> -0.533318).  Saving model ...
Epoch: 5 cost time: 0.8016583919525146
Epoch: 5, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.432 Vali Acc: 0.581 Test Loss: 1.432 Test Acc: 0.581
Validation loss decreased (-0.533318 --> -0.581467).  Saving model ...
Epoch: 6 cost time: 0.9157946109771729
Epoch: 6, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.286 Vali Acc: 0.663 Test Loss: 1.286 Test Acc: 0.663
Validation loss decreased (-0.581467 --> -0.662950).  Saving model ...
Epoch: 7 cost time: 0.8258647918701172
Epoch: 7, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.137 Vali Acc: 0.748 Test Loss: 1.137 Test Acc: 0.748
Validation loss decreased (-0.662950 --> -0.748137).  Saving model ...
Epoch: 8 cost time: 1.016106128692627
Epoch: 8, Steps: 2 | Train Loss: 1.028 Vali Loss: 0.985 Vali Acc: 0.759 Test Loss: 0.985 Test Acc: 0.759
Validation loss decreased (-0.748137 --> -0.759249).  Saving model ...
Epoch: 9 cost time: 0.8644015789031982
Epoch: 9, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.854 Vali Acc: 0.852 Test Loss: 0.854 Test Acc: 0.852
Validation loss decreased (-0.759249 --> -0.851843).  Saving model ...
Epoch: 10 cost time: 0.7842681407928467
Epoch: 10, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.761 Vali Acc: 0.800 Test Loss: 0.761 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8736498355865479
Epoch: 11, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.667 Vali Acc: 0.819 Test Loss: 0.667 Test Acc: 0.819
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8958985805511475
Epoch: 12, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.563 Vali Acc: 0.878 Test Loss: 0.563 Test Acc: 0.878
Validation loss decreased (-0.851843 --> -0.877772).  Saving model ...
Epoch: 13 cost time: 0.9178531169891357
Epoch: 13, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.473 Vali Acc: 0.926 Test Loss: 0.473 Test Acc: 0.926
Validation loss decreased (-0.877772 --> -0.925921).  Saving model ...
Epoch: 14 cost time: 0.8368420600891113
Epoch: 14, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.406 Vali Acc: 0.926 Test Loss: 0.406 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 15 cost time: 0.8883717060089111
Epoch: 15, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.367 Vali Acc: 0.904 Test Loss: 0.367 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8602747917175293
Epoch: 16, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.317 Vali Acc: 0.930 Test Loss: 0.317 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 17 cost time: 0.6238572597503662
Epoch: 17, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8123688697814941
Epoch: 18, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 19 cost time: 0.7454941272735596
Epoch: 19, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.862102746963501
Epoch: 20, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.9974973201751709
Epoch: 21, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8171560764312744
Epoch: 22, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9666621685028076
Epoch: 23, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9025616645812988
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.9578866958618164
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.9500632286071777
Epoch: 26, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 1.0231578350067139
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.8117692470550537
Epoch: 28, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7508363723754883
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0069012641906738
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3270695209503174
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9816198348999023
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9109699726104736
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7920284271240234
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7885870933532715
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9037370681762695
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8731012344360352
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 7889078
model size : 35.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.886845111846924
Epoch: 1, Steps: 2 | Train Loss: 1.943 Vali Loss: 1.947 Vali Acc: 0.078 Test Loss: 1.947 Test Acc: 0.078
Validation loss decreased (inf --> -0.077758).  Saving model ...
Epoch: 2 cost time: 0.8806769847869873
Epoch: 2, Steps: 2 | Train Loss: 1.986 Vali Loss: 1.905 Vali Acc: 0.093 Test Loss: 1.905 Test Acc: 0.093
Validation loss decreased (-0.077758 --> -0.092574).  Saving model ...
Epoch: 3 cost time: 0.7541055679321289
Epoch: 3, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.835 Vali Acc: 0.096 Test Loss: 1.835 Test Acc: 0.096
Validation loss decreased (-0.092574 --> -0.096278).  Saving model ...
Epoch: 4 cost time: 0.7185142040252686
Epoch: 4, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.740 Vali Acc: 0.215 Test Loss: 1.740 Test Acc: 0.215
Validation loss decreased (-0.096278 --> -0.214797).  Saving model ...
Epoch: 5 cost time: 0.8137588500976562
Epoch: 5, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.674 Vali Acc: 0.337 Test Loss: 1.674 Test Acc: 0.337
Validation loss decreased (-0.214797 --> -0.337020).  Saving model ...
Epoch: 6 cost time: 0.7252852916717529
Epoch: 6, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.611 Vali Acc: 0.422 Test Loss: 1.611 Test Acc: 0.422
Validation loss decreased (-0.337020 --> -0.422206).  Saving model ...
Epoch: 7 cost time: 0.7803664207458496
Epoch: 7, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.518 Vali Acc: 0.478 Test Loss: 1.518 Test Acc: 0.478
Validation loss decreased (-0.422206 --> -0.477763).  Saving model ...
Epoch: 8 cost time: 1.0511980056762695
Epoch: 8, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.392 Vali Acc: 0.637 Test Loss: 1.392 Test Acc: 0.637
Validation loss decreased (-0.477763 --> -0.637023).  Saving model ...
Epoch: 9 cost time: 0.8490521907806396
Epoch: 9, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.258 Vali Acc: 0.793 Test Loss: 1.258 Test Acc: 0.793
Validation loss decreased (-0.637023 --> -0.792580).  Saving model ...
Epoch: 10 cost time: 0.7201085090637207
Epoch: 10, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.143 Vali Acc: 0.837 Test Loss: 1.143 Test Acc: 0.837
Validation loss decreased (-0.792580 --> -0.837026).  Saving model ...
Epoch: 11 cost time: 0.7637226581573486
Epoch: 11, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.038 Vali Acc: 0.744 Test Loss: 1.038 Test Acc: 0.744
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9745984077453613
Epoch: 12, Steps: 2 | Train Loss: 0.942 Vali Loss: 0.915 Vali Acc: 0.793 Test Loss: 0.915 Test Acc: 0.793
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9736177921295166
Epoch: 13, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.800 Vali Acc: 0.867 Test Loss: 0.800 Test Acc: 0.867
Validation loss decreased (-0.837026 --> -0.866659).  Saving model ...
Epoch: 14 cost time: 0.8523054122924805
Epoch: 14, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.683 Vali Acc: 0.915 Test Loss: 0.683 Test Acc: 0.915
Validation loss decreased (-0.866659 --> -0.914808).  Saving model ...
Epoch: 15 cost time: 0.8911752700805664
Epoch: 15, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.591 Vali Acc: 0.907 Test Loss: 0.591 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7922801971435547
Epoch: 16, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.519 Vali Acc: 0.896 Test Loss: 0.519 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0151803493499756
Epoch: 17, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.448 Vali Acc: 0.922 Test Loss: 0.448 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922218).  Saving model ...
Epoch: 18 cost time: 0.8432347774505615
Epoch: 18, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.398 Vali Acc: 0.933 Test Loss: 0.398 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933329).  Saving model ...
Epoch: 19 cost time: 0.8312211036682129
Epoch: 19, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8271756172180176
Epoch: 20, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.358 Vali Acc: 0.881 Test Loss: 0.358 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8312032222747803
Epoch: 21, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.326 Vali Acc: 0.893 Test Loss: 0.326 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8301253318786621
Epoch: 22, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8923497200012207
Epoch: 23, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
Validation loss decreased (-0.933329 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.9268925189971924
Epoch: 24, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0591418743133545
Epoch: 25, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.069469928741455
Epoch: 26, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.225 Vali Acc: 0.948 Test Loss: 0.225 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.7959935665130615
Epoch: 27, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8463075160980225
Epoch: 28, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1305410861968994
Epoch: 29, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.773491382598877
Epoch: 30, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.219 Vali Acc: 0.948 Test Loss: 0.219 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.994598388671875
Epoch: 31, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 1.0731689929962158
Epoch: 32, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.7845458984375
Epoch: 33, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.948146 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.8670868873596191
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 1.059025526046753
Epoch: 35, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.180 Vali Acc: 0.959 Test Loss: 0.180 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 36 cost time: 0.8444955348968506
Epoch: 36, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8021349906921387
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8594069480895996
Epoch: 38, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9873409271240234
Epoch: 39, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8690290451049805
Epoch: 40, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9808628559112549
Epoch: 41, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8330807685852051
Epoch: 42, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8794670104980469
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.9517927169799805
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9577114582061768
Epoch: 45, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 3726134
model size : 16.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.952369213104248
Epoch: 1, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.793 Vali Acc: 0.181 Test Loss: 1.793 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.8593194484710693
Epoch: 2, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.764 Vali Acc: 0.241 Test Loss: 1.764 Test Acc: 0.241
Validation loss decreased (-0.181464 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.9092557430267334
Epoch: 3, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.723 Vali Acc: 0.278 Test Loss: 1.723 Test Acc: 0.278
Validation loss decreased (-0.240723 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 0.7461609840393066
Epoch: 4, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.656 Vali Acc: 0.348 Test Loss: 1.656 Test Acc: 0.348
Validation loss decreased (-0.277761 --> -0.348132).  Saving model ...
Epoch: 5 cost time: 0.7909407615661621
Epoch: 5, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.580 Vali Acc: 0.470 Test Loss: 1.580 Test Acc: 0.470
Validation loss decreased (-0.348132 --> -0.470355).  Saving model ...
Epoch: 6 cost time: 0.8646695613861084
Epoch: 6, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.494 Vali Acc: 0.615 Test Loss: 1.494 Test Acc: 0.615
Validation loss decreased (-0.470355 --> -0.614800).  Saving model ...
Epoch: 7 cost time: 1.0677986145019531
Epoch: 7, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.394 Vali Acc: 0.704 Test Loss: 1.394 Test Acc: 0.704
Validation loss decreased (-0.614800 --> -0.703690).  Saving model ...
Epoch: 8 cost time: 0.9219098091125488
Epoch: 8, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.279 Vali Acc: 0.789 Test Loss: 1.279 Test Acc: 0.789
Validation loss decreased (-0.703690 --> -0.788876).  Saving model ...
Epoch: 9 cost time: 0.903007984161377
Epoch: 9, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.164 Vali Acc: 0.804 Test Loss: 1.164 Test Acc: 0.804
Validation loss decreased (-0.788876 --> -0.803692).  Saving model ...
Epoch: 10 cost time: 0.7863450050354004
Epoch: 10, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.048 Vali Acc: 0.819 Test Loss: 1.048 Test Acc: 0.819
Validation loss decreased (-0.803692 --> -0.818508).  Saving model ...
Epoch: 11 cost time: 0.7886528968811035
Epoch: 11, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.936 Vali Acc: 0.822 Test Loss: 0.936 Test Acc: 0.822
Validation loss decreased (-0.818508 --> -0.822213).  Saving model ...
Epoch: 12 cost time: 0.9003238677978516
Epoch: 12, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.814 Vali Acc: 0.863 Test Loss: 0.814 Test Acc: 0.863
Validation loss decreased (-0.822213 --> -0.862955).  Saving model ...
Epoch: 13 cost time: 0.79168701171875
Epoch: 13, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.704 Vali Acc: 0.926 Test Loss: 0.704 Test Acc: 0.926
Validation loss decreased (-0.862955 --> -0.925919).  Saving model ...
Epoch: 14 cost time: 0.8737821578979492
Epoch: 14, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.617 Vali Acc: 0.911 Test Loss: 0.617 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1025209426879883
Epoch: 15, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.537 Vali Acc: 0.933 Test Loss: 0.537 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933328).  Saving model ...
Epoch: 16 cost time: 0.8562562465667725
Epoch: 16, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.483 Vali Acc: 0.896 Test Loss: 0.483 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9691517353057861
Epoch: 17, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.431 Vali Acc: 0.904 Test Loss: 0.431 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9262106418609619
Epoch: 18, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7389979362487793
Epoch: 19, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.358 Vali Acc: 0.907 Test Loss: 0.358 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0592496395111084
Epoch: 20, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.332 Vali Acc: 0.915 Test Loss: 0.332 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8523638248443604
Epoch: 21, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9022388458251953
Epoch: 22, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.282 Vali Acc: 0.926 Test Loss: 0.282 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7198371887207031
Epoch: 23, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7098081111907959
Epoch: 24, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.7101771831512451
Epoch: 25, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 3724726
model size : 16.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.477904796600342
Epoch: 1, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.736 Vali Acc: 0.244 Test Loss: 1.736 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.7795982360839844
Epoch: 2, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.707 Vali Acc: 0.267 Test Loss: 1.707 Test Acc: 0.267
Validation loss decreased (-0.244427 --> -0.266650).  Saving model ...
Epoch: 3 cost time: 0.7154293060302734
Epoch: 3, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.665 Vali Acc: 0.367 Test Loss: 1.665 Test Acc: 0.367
Validation loss decreased (-0.266650 --> -0.366650).  Saving model ...
Epoch: 4 cost time: 0.921372652053833
Epoch: 4, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.591 Vali Acc: 0.519 Test Loss: 1.591 Test Acc: 0.519
Validation loss decreased (-0.366650 --> -0.518503).  Saving model ...
Epoch: 5 cost time: 0.9002916812896729
Epoch: 5, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.523 Vali Acc: 0.600 Test Loss: 1.523 Test Acc: 0.600
Validation loss decreased (-0.518503 --> -0.599985).  Saving model ...
Epoch: 6 cost time: 0.7688848972320557
Epoch: 6, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.445 Vali Acc: 0.615 Test Loss: 1.445 Test Acc: 0.615
Validation loss decreased (-0.599985 --> -0.614800).  Saving model ...
Epoch: 7 cost time: 1.0033774375915527
Epoch: 7, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.360 Vali Acc: 0.630 Test Loss: 1.360 Test Acc: 0.630
Validation loss decreased (-0.614800 --> -0.629616).  Saving model ...
Epoch: 8 cost time: 0.7554583549499512
Epoch: 8, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.241 Vali Acc: 0.722 Test Loss: 1.241 Test Acc: 0.722
Validation loss decreased (-0.629616 --> -0.722210).  Saving model ...
Epoch: 9 cost time: 0.7593398094177246
Epoch: 9, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.121 Vali Acc: 0.752 Test Loss: 1.121 Test Acc: 0.752
Validation loss decreased (-0.722210 --> -0.751841).  Saving model ...
Epoch: 10 cost time: 0.8109571933746338
Epoch: 10, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.005 Vali Acc: 0.793 Test Loss: 1.005 Test Acc: 0.793
Validation loss decreased (-0.751841 --> -0.792583).  Saving model ...
Epoch: 11 cost time: 0.6706607341766357
Epoch: 11, Steps: 2 | Train Loss: 0.919 Vali Loss: 0.897 Vali Acc: 0.833 Test Loss: 0.897 Test Acc: 0.833
Validation loss decreased (-0.792583 --> -0.833324).  Saving model ...
Epoch: 12 cost time: 0.7661869525909424
Epoch: 12, Steps: 2 | Train Loss: 0.827 Vali Loss: 0.793 Vali Acc: 0.830 Test Loss: 0.793 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9367876052856445
Epoch: 13, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.692 Vali Acc: 0.859 Test Loss: 0.692 Test Acc: 0.859
Validation loss decreased (-0.833324 --> -0.859252).  Saving model ...
Epoch: 14 cost time: 0.8093307018280029
Epoch: 14, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.602 Vali Acc: 0.907 Test Loss: 0.602 Test Acc: 0.907
Validation loss decreased (-0.859252 --> -0.907401).  Saving model ...
Epoch: 15 cost time: 0.8334987163543701
Epoch: 15, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.532 Vali Acc: 0.900 Test Loss: 0.532 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.793022632598877
Epoch: 16, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.474 Vali Acc: 0.896 Test Loss: 0.474 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8970770835876465
Epoch: 17, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.427 Vali Acc: 0.907 Test Loss: 0.427 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907403).  Saving model ...
Epoch: 18 cost time: 0.953622579574585
Epoch: 18, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.390 Vali Acc: 0.896 Test Loss: 0.390 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7759230136871338
Epoch: 19, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.357 Vali Acc: 0.904 Test Loss: 0.357 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8165180683135986
Epoch: 20, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.323 Vali Acc: 0.907 Test Loss: 0.323 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 21 cost time: 0.8599629402160645
Epoch: 21, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.294 Vali Acc: 0.919 Test Loss: 0.294 Test Acc: 0.919
Validation loss decreased (-0.907404 --> -0.918516).  Saving model ...
Epoch: 22 cost time: 0.9437799453735352
Epoch: 22, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.270 Vali Acc: 0.922 Test Loss: 0.270 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.8824234008789062
Epoch: 23, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.263 Vali Acc: 0.926 Test Loss: 0.263 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 24 cost time: 0.7479217052459717
Epoch: 24, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8109836578369141
Epoch: 25, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8047757148742676
Epoch: 26, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 27 cost time: 0.9287059307098389
Epoch: 27, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.925924 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.7977948188781738
Epoch: 28, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.9440503120422363
Epoch: 29, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.8113698959350586
Epoch: 30, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.8266780376434326
Epoch: 31, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 1.054506778717041
Epoch: 32, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.9485530853271484
Epoch: 33, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 1.016157865524292
Epoch: 34, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.051037311553955
Epoch: 35, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.9544858932495117
Epoch: 36, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7714700698852539
Epoch: 37, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.8144943714141846
Epoch: 38, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0084009170532227
Epoch: 39, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8850667476654053
Epoch: 40, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7970759868621826
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9566631317138672
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.7999875545501709
Epoch: 43, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.7491872310638428
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9434616565704346
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.2201967239379883
Epoch: 46, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.9340543746948242
Epoch: 47, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.894207239151001
Epoch: 48, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7199804782867432
Epoch: 49, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7786283493041992
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.9157657623291016
Epoch: 51, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.9425783157348633
Epoch: 52, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 1.0757923126220703
Epoch: 53, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 3723318
model size : 16.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6986820697784424
Epoch: 1, Steps: 2 | Train Loss: 2.043 Vali Loss: 1.989 Vali Acc: 0.167 Test Loss: 1.989 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.9776005744934082
Epoch: 2, Steps: 2 | Train Loss: 2.005 Vali Loss: 1.940 Vali Acc: 0.178 Test Loss: 1.940 Test Acc: 0.178
Validation loss decreased (-0.166647 --> -0.177758).  Saving model ...
Epoch: 3 cost time: 0.809506893157959
Epoch: 3, Steps: 2 | Train Loss: 1.911 Vali Loss: 1.868 Vali Acc: 0.174 Test Loss: 1.868 Test Acc: 0.174
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9601271152496338
Epoch: 4, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.761 Vali Acc: 0.185 Test Loss: 1.761 Test Acc: 0.185
Validation loss decreased (-0.177758 --> -0.185168).  Saving model ...
Epoch: 5 cost time: 0.7708604335784912
Epoch: 5, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.675 Vali Acc: 0.415 Test Loss: 1.675 Test Acc: 0.415
Validation loss decreased (-0.185168 --> -0.414798).  Saving model ...
Epoch: 6 cost time: 0.7962267398834229
Epoch: 6, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.617 Vali Acc: 0.389 Test Loss: 1.617 Test Acc: 0.389
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0444059371948242
Epoch: 7, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.565 Vali Acc: 0.374 Test Loss: 1.565 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7845096588134766
Epoch: 8, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.477 Vali Acc: 0.348 Test Loss: 1.477 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9077692031860352
Epoch: 9, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.346 Vali Acc: 0.548 Test Loss: 1.346 Test Acc: 0.548
Validation loss decreased (-0.414798 --> -0.548135).  Saving model ...
Epoch: 10 cost time: 0.916191816329956
Epoch: 10, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.211 Vali Acc: 0.848 Test Loss: 1.211 Test Acc: 0.848
Validation loss decreased (-0.548135 --> -0.848136).  Saving model ...
Epoch: 11 cost time: 0.8364920616149902
Epoch: 11, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.101 Vali Acc: 0.844 Test Loss: 1.101 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7936429977416992
Epoch: 12, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.016 Vali Acc: 0.815 Test Loss: 1.016 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9371418952941895
Epoch: 13, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.909 Vali Acc: 0.848 Test Loss: 0.909 Test Acc: 0.848
Validation loss decreased (-0.848136 --> -0.848139).  Saving model ...
Epoch: 14 cost time: 0.8427889347076416
Epoch: 14, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.795 Vali Acc: 0.904 Test Loss: 0.795 Test Acc: 0.904
Validation loss decreased (-0.848139 --> -0.903696).  Saving model ...
Epoch: 15 cost time: 0.8513319492340088
Epoch: 15, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.695 Vali Acc: 0.911 Test Loss: 0.695 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 16 cost time: 0.7930557727813721
Epoch: 16, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.619 Vali Acc: 0.881 Test Loss: 0.619 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8379278182983398
Epoch: 17, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.539 Vali Acc: 0.930 Test Loss: 0.539 Test Acc: 0.930
Validation loss decreased (-0.911104 --> -0.929624).  Saving model ...
Epoch: 18 cost time: 0.8996970653533936
Epoch: 18, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.468 Vali Acc: 0.944 Test Loss: 0.468 Test Acc: 0.944
Validation loss decreased (-0.929624 --> -0.944440).  Saving model ...
Epoch: 19 cost time: 1.0252799987792969
Epoch: 19, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.410 Vali Acc: 0.952 Test Loss: 0.410 Test Acc: 0.952
Validation loss decreased (-0.944440 --> -0.951848).  Saving model ...
Epoch: 20 cost time: 0.9362220764160156
Epoch: 20, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.364 Vali Acc: 0.948 Test Loss: 0.364 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3440847396850586
Epoch: 21, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.334 Vali Acc: 0.948 Test Loss: 0.334 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8607316017150879
Epoch: 22, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.311 Vali Acc: 0.948 Test Loss: 0.311 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.918046236038208
Epoch: 23, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8016753196716309
Epoch: 24, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9610819816589355
Epoch: 25, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.281 Vali Acc: 0.926 Test Loss: 0.281 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9036238193511963
Epoch: 26, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8143503665924072
Epoch: 27, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7471261024475098
Epoch: 28, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8756000995635986
Epoch: 29, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 3721910
model size : 16.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.884195566177368
Epoch: 1, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.857 Vali Acc: 0.193 Test Loss: 1.857 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.8637402057647705
Epoch: 2, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.836 Vali Acc: 0.196 Test Loss: 1.836 Test Acc: 0.196
Validation loss decreased (-0.192574 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.9471960067749023
Epoch: 3, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.799 Vali Acc: 0.189 Test Loss: 1.799 Test Acc: 0.189
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8040053844451904
Epoch: 4, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.739 Vali Acc: 0.215 Test Loss: 1.739 Test Acc: 0.215
Validation loss decreased (-0.196278 --> -0.214797).  Saving model ...
Epoch: 5 cost time: 0.8163001537322998
Epoch: 5, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.675 Vali Acc: 0.300 Test Loss: 1.675 Test Acc: 0.300
Validation loss decreased (-0.214797 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 0.695542573928833
Epoch: 6, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.609 Vali Acc: 0.370 Test Loss: 1.609 Test Acc: 0.370
Validation loss decreased (-0.299983 --> -0.370354).  Saving model ...
Epoch: 7 cost time: 0.6933615207672119
Epoch: 7, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.534 Vali Acc: 0.507 Test Loss: 1.534 Test Acc: 0.507
Validation loss decreased (-0.370354 --> -0.507392).  Saving model ...
Epoch: 8 cost time: 0.8745112419128418
Epoch: 8, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.446 Vali Acc: 0.578 Test Loss: 1.446 Test Acc: 0.578
Validation loss decreased (-0.507392 --> -0.577763).  Saving model ...
Epoch: 9 cost time: 0.7710375785827637
Epoch: 9, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.352 Vali Acc: 0.711 Test Loss: 1.352 Test Acc: 0.711
Validation loss decreased (-0.577763 --> -0.711098).  Saving model ...
Epoch: 10 cost time: 0.9712526798248291
Epoch: 10, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.254 Vali Acc: 0.807 Test Loss: 1.254 Test Acc: 0.807
Validation loss decreased (-0.711098 --> -0.807395).  Saving model ...
Epoch: 11 cost time: 0.6863782405853271
Epoch: 11, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.162 Vali Acc: 0.841 Test Loss: 1.162 Test Acc: 0.841
Validation loss decreased (-0.807395 --> -0.840729).  Saving model ...
Epoch: 12 cost time: 0.7595715522766113
Epoch: 12, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.064 Vali Acc: 0.859 Test Loss: 1.064 Test Acc: 0.859
Validation loss decreased (-0.840729 --> -0.859249).  Saving model ...
Epoch: 13 cost time: 0.7251596450805664
Epoch: 13, Steps: 2 | Train Loss: 1.010 Vali Loss: 0.959 Vali Acc: 0.881 Test Loss: 0.959 Test Acc: 0.881
Validation loss decreased (-0.859249 --> -0.881472).  Saving model ...
Epoch: 14 cost time: 0.945361852645874
Epoch: 14, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.862 Vali Acc: 0.893 Test Loss: 0.862 Test Acc: 0.893
Validation loss decreased (-0.881472 --> -0.892584).  Saving model ...
Epoch: 15 cost time: 1.0200114250183105
Epoch: 15, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.769 Vali Acc: 0.889 Test Loss: 0.769 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9481706619262695
Epoch: 16, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.681 Vali Acc: 0.904 Test Loss: 0.681 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903697).  Saving model ...
Epoch: 17 cost time: 0.7339279651641846
Epoch: 17, Steps: 2 | Train Loss: 0.566 Vali Loss: 0.602 Vali Acc: 0.926 Test Loss: 0.602 Test Acc: 0.926
Validation loss decreased (-0.903697 --> -0.925920).  Saving model ...
Epoch: 18 cost time: 0.7476670742034912
Epoch: 18, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.535 Vali Acc: 0.937 Test Loss: 0.535 Test Acc: 0.937
Validation loss decreased (-0.925920 --> -0.937032).  Saving model ...
Epoch: 19 cost time: 0.8705089092254639
Epoch: 19, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.476 Vali Acc: 0.952 Test Loss: 0.476 Test Acc: 0.952
Validation loss decreased (-0.937032 --> -0.951847).  Saving model ...
Epoch: 20 cost time: 0.8168883323669434
Epoch: 20, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.421 Vali Acc: 0.963 Test Loss: 0.421 Test Acc: 0.963
Validation loss decreased (-0.951847 --> -0.962959).  Saving model ...
Epoch: 21 cost time: 0.7623612880706787
Epoch: 21, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.384 Vali Acc: 0.952 Test Loss: 0.384 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.881746768951416
Epoch: 22, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.355 Vali Acc: 0.941 Test Loss: 0.355 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7117137908935547
Epoch: 23, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.331 Vali Acc: 0.933 Test Loss: 0.331 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8461782932281494
Epoch: 24, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.311 Vali Acc: 0.933 Test Loss: 0.311 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8206567764282227
Epoch: 25, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.285 Vali Acc: 0.948 Test Loss: 0.285 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8135552406311035
Epoch: 26, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.253 Vali Acc: 0.963 Test Loss: 0.253 Test Acc: 0.963
Validation loss decreased (-0.962959 --> -0.962960).  Saving model ...
Epoch: 27 cost time: 0.8489358425140381
Epoch: 27, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.238 Vali Acc: 0.963 Test Loss: 0.238 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962961).  Saving model ...
Epoch: 28 cost time: 0.9674696922302246
Epoch: 28, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.232 Vali Acc: 0.959 Test Loss: 0.232 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9651432037353516
Epoch: 29, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0819692611694336
Epoch: 30, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0348296165466309
Epoch: 31, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9120879173278809
Epoch: 32, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.842278242111206
Epoch: 33, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.89906907081604
Epoch: 34, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9080410003662109
Epoch: 35, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8804378509521484
Epoch: 36, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0357542037963867
Epoch: 37, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 2805046
model size : 13.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4055607318878174
Epoch: 1, Steps: 2 | Train Loss: 2.023 Vali Loss: 1.907 Vali Acc: 0.170 Test Loss: 1.907 Test Acc: 0.170
Validation loss decreased (inf --> -0.170351).  Saving model ...
Epoch: 2 cost time: 0.8194723129272461
Epoch: 2, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.882 Vali Acc: 0.189 Test Loss: 1.882 Test Acc: 0.189
Validation loss decreased (-0.170351 --> -0.188870).  Saving model ...
Epoch: 3 cost time: 0.6672248840332031
Epoch: 3, Steps: 2 | Train Loss: 1.974 Vali Loss: 1.844 Vali Acc: 0.215 Test Loss: 1.844 Test Acc: 0.215
Validation loss decreased (-0.188870 --> -0.214796).  Saving model ...
Epoch: 4 cost time: 0.6831128597259521
Epoch: 4, Steps: 2 | Train Loss: 1.917 Vali Loss: 1.781 Vali Acc: 0.296 Test Loss: 1.781 Test Acc: 0.296
Validation loss decreased (-0.214796 --> -0.296278).  Saving model ...
Epoch: 5 cost time: 0.9440433979034424
Epoch: 5, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.714 Vali Acc: 0.426 Test Loss: 1.714 Test Acc: 0.426
Validation loss decreased (-0.296278 --> -0.425909).  Saving model ...
Epoch: 6 cost time: 0.9560177326202393
Epoch: 6, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.640 Vali Acc: 0.481 Test Loss: 1.640 Test Acc: 0.481
Validation loss decreased (-0.425909 --> -0.481465).  Saving model ...
Epoch: 7 cost time: 0.7660994529724121
Epoch: 7, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.557 Vali Acc: 0.544 Test Loss: 1.557 Test Acc: 0.544
Validation loss decreased (-0.481465 --> -0.544429).  Saving model ...
Epoch: 8 cost time: 0.9447731971740723
Epoch: 8, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.460 Vali Acc: 0.596 Test Loss: 1.460 Test Acc: 0.596
Validation loss decreased (-0.544429 --> -0.596282).  Saving model ...
Epoch: 9 cost time: 0.8243429660797119
Epoch: 9, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.361 Vali Acc: 0.722 Test Loss: 1.361 Test Acc: 0.722
Validation loss decreased (-0.596282 --> -0.722209).  Saving model ...
Epoch: 10 cost time: 0.8140125274658203
Epoch: 10, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.264 Vali Acc: 0.733 Test Loss: 1.264 Test Acc: 0.733
Validation loss decreased (-0.722209 --> -0.733321).  Saving model ...
Epoch: 11 cost time: 0.7753415107727051
Epoch: 11, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.165 Vali Acc: 0.759 Test Loss: 1.165 Test Acc: 0.759
Validation loss decreased (-0.733321 --> -0.759248).  Saving model ...
Epoch: 12 cost time: 0.8848133087158203
Epoch: 12, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.061 Vali Acc: 0.774 Test Loss: 1.061 Test Acc: 0.774
Validation loss decreased (-0.759248 --> -0.774063).  Saving model ...
Epoch: 13 cost time: 0.8608593940734863
Epoch: 13, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.953 Vali Acc: 0.822 Test Loss: 0.953 Test Acc: 0.822
Validation loss decreased (-0.774063 --> -0.822213).  Saving model ...
Epoch: 14 cost time: 0.7588796615600586
Epoch: 14, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.854 Vali Acc: 0.856 Test Loss: 0.854 Test Acc: 0.856
Validation loss decreased (-0.822213 --> -0.855547).  Saving model ...
Epoch: 15 cost time: 0.8136847019195557
Epoch: 15, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.764 Vali Acc: 0.874 Test Loss: 0.764 Test Acc: 0.874
Validation loss decreased (-0.855547 --> -0.874066).  Saving model ...
Epoch: 16 cost time: 0.7953236103057861
Epoch: 16, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.678 Vali Acc: 0.885 Test Loss: 0.678 Test Acc: 0.885
Validation loss decreased (-0.874066 --> -0.885178).  Saving model ...
Epoch: 17 cost time: 0.9526221752166748
Epoch: 17, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.597 Vali Acc: 0.896 Test Loss: 0.597 Test Acc: 0.896
Validation loss decreased (-0.885178 --> -0.896290).  Saving model ...
Epoch: 18 cost time: 0.7489738464355469
Epoch: 18, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.531 Vali Acc: 0.907 Test Loss: 0.531 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907402).  Saving model ...
Epoch: 19 cost time: 0.8109447956085205
Epoch: 19, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.477 Vali Acc: 0.907 Test Loss: 0.477 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 20 cost time: 0.7106397151947021
Epoch: 20, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.429 Vali Acc: 0.919 Test Loss: 0.429 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918514).  Saving model ...
Epoch: 21 cost time: 0.7668616771697998
Epoch: 21, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.391 Vali Acc: 0.911 Test Loss: 0.391 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6887304782867432
Epoch: 22, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.369 Vali Acc: 0.911 Test Loss: 0.369 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.3383114337921143
Epoch: 23, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.363 Vali Acc: 0.911 Test Loss: 0.363 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8939847946166992
Epoch: 24, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.347 Vali Acc: 0.915 Test Loss: 0.347 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0677087306976318
Epoch: 25, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.336 Vali Acc: 0.911 Test Loss: 0.336 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8363745212554932
Epoch: 26, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.318 Vali Acc: 0.915 Test Loss: 0.318 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8376591205596924
Epoch: 27, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.294 Vali Acc: 0.919 Test Loss: 0.294 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918516).  Saving model ...
Epoch: 28 cost time: 0.7931532859802246
Epoch: 28, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 29 cost time: 0.8151521682739258
Epoch: 29, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 30 cost time: 0.9141454696655273
Epoch: 30, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 31 cost time: 1.132523775100708
Epoch: 31, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.268 Vali Acc: 0.911 Test Loss: 0.268 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9501254558563232
Epoch: 32, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.273 Vali Acc: 0.915 Test Loss: 0.273 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9887030124664307
Epoch: 33, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.279 Vali Acc: 0.911 Test Loss: 0.279 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7973048686981201
Epoch: 34, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.278 Vali Acc: 0.915 Test Loss: 0.278 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7942404747009277
Epoch: 35, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8961818218231201
Epoch: 36, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.267 Vali Acc: 0.915 Test Loss: 0.267 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8023910522460938
Epoch: 37, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.261 Vali Acc: 0.915 Test Loss: 0.261 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.959477424621582
Epoch: 38, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 39 cost time: 0.9002375602722168
Epoch: 39, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 40 cost time: 0.7633135318756104
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 41 cost time: 1.1579062938690186
Epoch: 41, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 42 cost time: 1.0527088642120361
Epoch: 42, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8564257621765137
Epoch: 43, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9726264476776123
Epoch: 44, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9706039428710938
Epoch: 45, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7893052101135254
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 47 cost time: 0.9483761787414551
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 48 cost time: 0.9580533504486084
Epoch: 48, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 49 cost time: 0.9571101665496826
Epoch: 49, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 50 cost time: 1.1983857154846191
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 51 cost time: 0.8478477001190186
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7037074565887451
Epoch: 52, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7286114692687988
Epoch: 53, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8979055881500244
Epoch: 54, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.889136552810669
Epoch: 55, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.7958886623382568
Epoch: 56, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.7306711673736572
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.7713229656219482
Epoch: 58, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.7096428871154785
Epoch: 59, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.9220435619354248
Epoch: 60, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 2803638
model size : 13.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7942190170288086
Epoch: 1, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.781 Vali Acc: 0.241 Test Loss: 1.781 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.9372668266296387
Epoch: 2, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.754 Vali Acc: 0.267 Test Loss: 1.754 Test Acc: 0.267
Validation loss decreased (-0.240723 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 0.9280827045440674
Epoch: 3, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.719 Vali Acc: 0.293 Test Loss: 1.719 Test Acc: 0.293
Validation loss decreased (-0.266649 --> -0.292575).  Saving model ...
Epoch: 4 cost time: 0.9714837074279785
Epoch: 4, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.665 Vali Acc: 0.356 Test Loss: 1.665 Test Acc: 0.356
Validation loss decreased (-0.292575 --> -0.355539).  Saving model ...
Epoch: 5 cost time: 0.860344648361206
Epoch: 5, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.609 Vali Acc: 0.415 Test Loss: 1.609 Test Acc: 0.415
Validation loss decreased (-0.355539 --> -0.414799).  Saving model ...
Epoch: 6 cost time: 0.8260753154754639
Epoch: 6, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.544 Vali Acc: 0.570 Test Loss: 1.544 Test Acc: 0.570
Validation loss decreased (-0.414799 --> -0.570355).  Saving model ...
Epoch: 7 cost time: 0.8213021755218506
Epoch: 7, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.465 Vali Acc: 0.663 Test Loss: 1.465 Test Acc: 0.663
Validation loss decreased (-0.570355 --> -0.662948).  Saving model ...
Epoch: 8 cost time: 0.7743620872497559
Epoch: 8, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.372 Vali Acc: 0.759 Test Loss: 1.372 Test Acc: 0.759
Validation loss decreased (-0.662948 --> -0.759246).  Saving model ...
Epoch: 9 cost time: 1.0069332122802734
Epoch: 9, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.271 Vali Acc: 0.870 Test Loss: 1.271 Test Acc: 0.870
Validation loss decreased (-0.759246 --> -0.870358).  Saving model ...
Epoch: 10 cost time: 0.899432897567749
Epoch: 10, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.175 Vali Acc: 0.904 Test Loss: 1.175 Test Acc: 0.904
Validation loss decreased (-0.870358 --> -0.903692).  Saving model ...
Epoch: 11 cost time: 0.8816900253295898
Epoch: 11, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.074 Vali Acc: 0.900 Test Loss: 1.074 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8667421340942383
Epoch: 12, Steps: 2 | Train Loss: 0.980 Vali Loss: 0.969 Vali Acc: 0.893 Test Loss: 0.969 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7924637794494629
Epoch: 13, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.857 Vali Acc: 0.922 Test Loss: 0.857 Test Acc: 0.922
Validation loss decreased (-0.903692 --> -0.922214).  Saving model ...
Epoch: 14 cost time: 0.8603668212890625
Epoch: 14, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.758 Vali Acc: 0.926 Test Loss: 0.758 Test Acc: 0.926
Validation loss decreased (-0.922214 --> -0.925918).  Saving model ...
Epoch: 15 cost time: 0.7423233985900879
Epoch: 15, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.668 Vali Acc: 0.922 Test Loss: 0.668 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1041345596313477
Epoch: 16, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.586 Vali Acc: 0.930 Test Loss: 0.586 Test Acc: 0.930
Validation loss decreased (-0.925918 --> -0.929624).  Saving model ...
Epoch: 17 cost time: 0.9916763305664062
Epoch: 17, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.511 Vali Acc: 0.933 Test Loss: 0.511 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 18 cost time: 0.8838756084442139
Epoch: 18, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.448 Vali Acc: 0.941 Test Loss: 0.448 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 19 cost time: 0.8211071491241455
Epoch: 19, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.397 Vali Acc: 0.956 Test Loss: 0.397 Test Acc: 0.956
Validation loss decreased (-0.940736 --> -0.955552).  Saving model ...
Epoch: 20 cost time: 0.7536404132843018
Epoch: 20, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.357 Vali Acc: 0.956 Test Loss: 0.357 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 21 cost time: 0.8922185897827148
Epoch: 21, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.330 Vali Acc: 0.952 Test Loss: 0.330 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.105703353881836
Epoch: 22, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.314 Vali Acc: 0.933 Test Loss: 0.314 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1417253017425537
Epoch: 23, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9691479206085205
Epoch: 24, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9675920009613037
Epoch: 25, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9823424816131592
Epoch: 26, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.235 Vali Acc: 0.956 Test Loss: 0.235 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 27 cost time: 0.8003623485565186
Epoch: 27, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.228 Vali Acc: 0.956 Test Loss: 0.228 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 28 cost time: 0.9414105415344238
Epoch: 28, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.221 Vali Acc: 0.956 Test Loss: 0.221 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 29 cost time: 0.8253917694091797
Epoch: 29, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 30 cost time: 0.885671854019165
Epoch: 30, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.8223729133605957
Epoch: 31, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.858403205871582
Epoch: 32, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0460407733917236
Epoch: 33, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6864726543426514
Epoch: 34, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7054383754730225
Epoch: 35, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7407150268554688
Epoch: 36, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8376166820526123
Epoch: 37, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7688248157501221
Epoch: 38, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7786836624145508
Epoch: 39, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8197448253631592
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 2802230
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.456536054611206
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.796 Vali Acc: 0.174 Test Loss: 1.796 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.8780536651611328
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.759 Vali Acc: 0.178 Test Loss: 1.759 Test Acc: 0.178
Validation loss decreased (-0.174056 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 1.034857988357544
Epoch: 3, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.715 Vali Acc: 0.211 Test Loss: 1.715 Test Acc: 0.211
Validation loss decreased (-0.177760 --> -0.211094).  Saving model ...
Epoch: 4 cost time: 0.850562572479248
Epoch: 4, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.651 Vali Acc: 0.393 Test Loss: 1.651 Test Acc: 0.393
Validation loss decreased (-0.211094 --> -0.392576).  Saving model ...
Epoch: 5 cost time: 0.7942743301391602
Epoch: 5, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.593 Vali Acc: 0.500 Test Loss: 1.593 Test Acc: 0.500
Validation loss decreased (-0.392576 --> -0.499984).  Saving model ...
Epoch: 6 cost time: 0.8740758895874023
Epoch: 6, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.532 Vali Acc: 0.515 Test Loss: 1.532 Test Acc: 0.515
Validation loss decreased (-0.499984 --> -0.514799).  Saving model ...
Epoch: 7 cost time: 0.8575477600097656
Epoch: 7, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.448 Vali Acc: 0.541 Test Loss: 1.448 Test Acc: 0.541
Validation loss decreased (-0.514799 --> -0.540726).  Saving model ...
Epoch: 8 cost time: 0.88262939453125
Epoch: 8, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.341 Vali Acc: 0.667 Test Loss: 1.341 Test Acc: 0.667
Validation loss decreased (-0.540726 --> -0.666653).  Saving model ...
Epoch: 9 cost time: 0.8461101055145264
Epoch: 9, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.234 Vali Acc: 0.789 Test Loss: 1.234 Test Acc: 0.789
Validation loss decreased (-0.666653 --> -0.788877).  Saving model ...
Epoch: 10 cost time: 0.7147283554077148
Epoch: 10, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.133 Vali Acc: 0.826 Test Loss: 1.133 Test Acc: 0.826
Validation loss decreased (-0.788877 --> -0.825915).  Saving model ...
Epoch: 11 cost time: 0.7383689880371094
Epoch: 11, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.033 Vali Acc: 0.833 Test Loss: 1.033 Test Acc: 0.833
Validation loss decreased (-0.825915 --> -0.833323).  Saving model ...
Epoch: 12 cost time: 0.9313209056854248
Epoch: 12, Steps: 2 | Train Loss: 0.977 Vali Loss: 0.933 Vali Acc: 0.844 Test Loss: 0.933 Test Acc: 0.844
Validation loss decreased (-0.833323 --> -0.844435).  Saving model ...
Epoch: 13 cost time: 1.0149755477905273
Epoch: 13, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.838 Vali Acc: 0.848 Test Loss: 0.838 Test Acc: 0.848
Validation loss decreased (-0.844435 --> -0.848140).  Saving model ...
Epoch: 14 cost time: 0.8109035491943359
Epoch: 14, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.750 Vali Acc: 0.859 Test Loss: 0.750 Test Acc: 0.859
Validation loss decreased (-0.848140 --> -0.859252).  Saving model ...
Epoch: 15 cost time: 0.8451998233795166
Epoch: 15, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.668 Vali Acc: 0.893 Test Loss: 0.668 Test Acc: 0.893
Validation loss decreased (-0.859252 --> -0.892586).  Saving model ...
Epoch: 16 cost time: 0.7178103923797607
Epoch: 16, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.594 Vali Acc: 0.926 Test Loss: 0.594 Test Acc: 0.926
Validation loss decreased (-0.892586 --> -0.925920).  Saving model ...
Epoch: 17 cost time: 0.8540208339691162
Epoch: 17, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.530 Vali Acc: 0.919 Test Loss: 0.530 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8028044700622559
Epoch: 18, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.479 Vali Acc: 0.915 Test Loss: 0.479 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7574479579925537
Epoch: 19, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.442 Vali Acc: 0.904 Test Loss: 0.442 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8014063835144043
Epoch: 20, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.399 Vali Acc: 0.915 Test Loss: 0.399 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0811145305633545
Epoch: 21, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.363 Vali Acc: 0.926 Test Loss: 0.363 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925922).  Saving model ...
Epoch: 22 cost time: 0.8232028484344482
Epoch: 22, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8127331733703613
Epoch: 23, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.322 Vali Acc: 0.922 Test Loss: 0.322 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8669912815093994
Epoch: 24, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.310 Vali Acc: 0.907 Test Loss: 0.310 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7732305526733398
Epoch: 25, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929627).  Saving model ...
Epoch: 26 cost time: 0.9864487648010254
Epoch: 26, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.929627 --> -0.940738).  Saving model ...
Epoch: 27 cost time: 0.7947919368743896
Epoch: 27, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.8281633853912354
Epoch: 28, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.774590015411377
Epoch: 29, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.228 Vali Acc: 0.948 Test Loss: 0.228 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.7588706016540527
Epoch: 30, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8043484687805176
Epoch: 31, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7228999137878418
Epoch: 32, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7612390518188477
Epoch: 33, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8846337795257568
Epoch: 34, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.225 Vali Acc: 0.926 Test Loss: 0.225 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8190293312072754
Epoch: 35, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.7516636848449707
Epoch: 36, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.0032732486724854
Epoch: 37, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.8561270236968994
Epoch: 38, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 1.0699801445007324
Epoch: 39, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7572875022888184
Epoch: 40, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8927521705627441
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9344930648803711
Epoch: 42, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.943108320236206
Epoch: 43, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.0506129264831543
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8406767845153809
Epoch: 45, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.0466701984405518
Epoch: 46, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8577132225036621
Epoch: 47, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.7388722896575928
Epoch: 48, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 2800822
model size : 13.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7465789318084717
Epoch: 1, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.830 Vali Acc: 0.230 Test Loss: 1.830 Test Acc: 0.230
Validation loss decreased (inf --> -0.229611).  Saving model ...
Epoch: 2 cost time: 1.1974475383758545
Epoch: 2, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.798 Vali Acc: 0.241 Test Loss: 1.798 Test Acc: 0.241
Validation loss decreased (-0.229611 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.9583535194396973
Epoch: 3, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.751 Vali Acc: 0.267 Test Loss: 1.751 Test Acc: 0.267
Validation loss decreased (-0.240723 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.8506424427032471
Epoch: 4, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.687 Vali Acc: 0.300 Test Loss: 1.687 Test Acc: 0.300
Validation loss decreased (-0.266649 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 0.7668344974517822
Epoch: 5, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.629 Vali Acc: 0.315 Test Loss: 1.629 Test Acc: 0.315
Validation loss decreased (-0.299983 --> -0.314799).  Saving model ...
Epoch: 6 cost time: 0.680081844329834
Epoch: 6, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.579 Vali Acc: 0.359 Test Loss: 1.579 Test Acc: 0.359
Validation loss decreased (-0.314799 --> -0.359243).  Saving model ...
Epoch: 7 cost time: 0.8065197467803955
Epoch: 7, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.521 Vali Acc: 0.478 Test Loss: 1.521 Test Acc: 0.478
Validation loss decreased (-0.359243 --> -0.477763).  Saving model ...
Epoch: 8 cost time: 0.8314685821533203
Epoch: 8, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.437 Vali Acc: 0.570 Test Loss: 1.437 Test Acc: 0.570
Validation loss decreased (-0.477763 --> -0.570356).  Saving model ...
Epoch: 9 cost time: 0.7050504684448242
Epoch: 9, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.340 Vali Acc: 0.630 Test Loss: 1.340 Test Acc: 0.630
Validation loss decreased (-0.570356 --> -0.629616).  Saving model ...
Epoch: 10 cost time: 0.7979428768157959
Epoch: 10, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.254 Vali Acc: 0.767 Test Loss: 1.254 Test Acc: 0.767
Validation loss decreased (-0.629616 --> -0.766654).  Saving model ...
Epoch: 11 cost time: 0.7436399459838867
Epoch: 11, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.174 Vali Acc: 0.748 Test Loss: 1.174 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.915949821472168
Epoch: 12, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.082 Vali Acc: 0.826 Test Loss: 1.082 Test Acc: 0.826
Validation loss decreased (-0.766654 --> -0.825915).  Saving model ...
Epoch: 13 cost time: 0.7578592300415039
Epoch: 13, Steps: 2 | Train Loss: 0.945 Vali Loss: 0.985 Vali Acc: 0.859 Test Loss: 0.985 Test Acc: 0.859
Validation loss decreased (-0.825915 --> -0.859249).  Saving model ...
Epoch: 14 cost time: 0.7936456203460693
Epoch: 14, Steps: 2 | Train Loss: 0.946 Vali Loss: 0.888 Vali Acc: 0.893 Test Loss: 0.888 Test Acc: 0.893
Validation loss decreased (-0.859249 --> -0.892584).  Saving model ...
Epoch: 15 cost time: 0.7690556049346924
Epoch: 15, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.799 Vali Acc: 0.911 Test Loss: 0.799 Test Acc: 0.911
Validation loss decreased (-0.892584 --> -0.911103).  Saving model ...
Epoch: 16 cost time: 0.9140040874481201
Epoch: 16, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.716 Vali Acc: 0.922 Test Loss: 0.716 Test Acc: 0.922
Validation loss decreased (-0.911103 --> -0.922215).  Saving model ...
Epoch: 17 cost time: 0.7759168148040771
Epoch: 17, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.643 Vali Acc: 0.919 Test Loss: 0.643 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8178343772888184
Epoch: 18, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.573 Vali Acc: 0.937 Test Loss: 0.573 Test Acc: 0.937
Validation loss decreased (-0.922215 --> -0.937031).  Saving model ...
Epoch: 19 cost time: 0.6538705825805664
Epoch: 19, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.521 Vali Acc: 0.922 Test Loss: 0.521 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9290308952331543
Epoch: 20, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.468 Vali Acc: 0.926 Test Loss: 0.468 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9708547592163086
Epoch: 21, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.419 Vali Acc: 0.933 Test Loss: 0.419 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8496012687683105
Epoch: 22, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.376 Vali Acc: 0.930 Test Loss: 0.376 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.643791675567627
Epoch: 23, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.351 Vali Acc: 0.926 Test Loss: 0.351 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8938848972320557
Epoch: 24, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.321 Vali Acc: 0.926 Test Loss: 0.321 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9604272842407227
Epoch: 25, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.937031 --> -0.944442).  Saving model ...
Epoch: 26 cost time: 0.878105640411377
Epoch: 26, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.269 Vali Acc: 0.948 Test Loss: 0.269 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 27 cost time: 0.923590898513794
Epoch: 27, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9385898113250732
Epoch: 28, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.271 Vali Acc: 0.926 Test Loss: 0.271 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8266153335571289
Epoch: 29, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.276 Vali Acc: 0.919 Test Loss: 0.276 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9134318828582764
Epoch: 30, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8724980354309082
Epoch: 31, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.241 Vali Acc: 0.919 Test Loss: 0.241 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9074392318725586
Epoch: 32, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8936123847961426
Epoch: 33, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 1.2829229831695557
Epoch: 34, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.8865566253662109
Epoch: 35, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.7992026805877686
Epoch: 36, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8321855068206787
Epoch: 37, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8431923389434814
Epoch: 38, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.077383041381836
Epoch: 39, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.717879056930542
Epoch: 40, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9664533138275146
Epoch: 41, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8433778285980225
Epoch: 42, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9215977191925049
Epoch: 43, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.808081865310669
Epoch: 44, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.9936814308166504
Epoch: 45, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 2344502
model size : 11.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.053896903991699
Epoch: 1, Steps: 2 | Train Loss: 1.978 Vali Loss: 1.987 Vali Acc: 0.104 Test Loss: 1.987 Test Acc: 0.104
Validation loss decreased (inf --> -0.103684).  Saving model ...
Epoch: 2 cost time: 0.9168128967285156
Epoch: 2, Steps: 2 | Train Loss: 2.017 Vali Loss: 1.944 Vali Acc: 0.119 Test Loss: 1.944 Test Acc: 0.119
Validation loss decreased (-0.103684 --> -0.118499).  Saving model ...
Epoch: 3 cost time: 0.8725569248199463
Epoch: 3, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.895 Vali Acc: 0.122 Test Loss: 1.895 Test Acc: 0.122
Validation loss decreased (-0.118499 --> -0.122203).  Saving model ...
Epoch: 4 cost time: 0.9841160774230957
Epoch: 4, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.828 Vali Acc: 0.148 Test Loss: 1.828 Test Acc: 0.148
Validation loss decreased (-0.122203 --> -0.148130).  Saving model ...
Epoch: 5 cost time: 0.8420212268829346
Epoch: 5, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.777 Vali Acc: 0.241 Test Loss: 1.777 Test Acc: 0.241
Validation loss decreased (-0.148130 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 0.7595477104187012
Epoch: 6, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.727 Vali Acc: 0.293 Test Loss: 1.727 Test Acc: 0.293
Validation loss decreased (-0.240723 --> -0.292575).  Saving model ...
Epoch: 7 cost time: 0.8729698657989502
Epoch: 7, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.667 Vali Acc: 0.356 Test Loss: 1.667 Test Acc: 0.356
Validation loss decreased (-0.292575 --> -0.355539).  Saving model ...
Epoch: 8 cost time: 0.8648884296417236
Epoch: 8, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.595 Vali Acc: 0.452 Test Loss: 1.595 Test Acc: 0.452
Validation loss decreased (-0.355539 --> -0.451836).  Saving model ...
Epoch: 9 cost time: 0.7575070858001709
Epoch: 9, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.506 Vali Acc: 0.593 Test Loss: 1.506 Test Acc: 0.593
Validation loss decreased (-0.451836 --> -0.592578).  Saving model ...
Epoch: 10 cost time: 0.7343604564666748
Epoch: 10, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.414 Vali Acc: 0.630 Test Loss: 1.414 Test Acc: 0.630
Validation loss decreased (-0.592578 --> -0.629615).  Saving model ...
Epoch: 11 cost time: 1.2174088954925537
Epoch: 11, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.329 Vali Acc: 0.704 Test Loss: 1.329 Test Acc: 0.704
Validation loss decreased (-0.629615 --> -0.703690).  Saving model ...
Epoch: 12 cost time: 0.9686784744262695
Epoch: 12, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.239 Vali Acc: 0.741 Test Loss: 1.239 Test Acc: 0.741
Validation loss decreased (-0.703690 --> -0.740728).  Saving model ...
Epoch: 13 cost time: 0.9623293876647949
Epoch: 13, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.143 Vali Acc: 0.807 Test Loss: 1.143 Test Acc: 0.807
Validation loss decreased (-0.740728 --> -0.807396).  Saving model ...
Epoch: 14 cost time: 0.8538908958435059
Epoch: 14, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.046 Vali Acc: 0.826 Test Loss: 1.046 Test Acc: 0.826
Validation loss decreased (-0.807396 --> -0.825915).  Saving model ...
Epoch: 15 cost time: 1.0433766841888428
Epoch: 15, Steps: 2 | Train Loss: 0.927 Vali Loss: 0.945 Vali Acc: 0.870 Test Loss: 0.945 Test Acc: 0.870
Validation loss decreased (-0.825915 --> -0.870361).  Saving model ...
Epoch: 16 cost time: 0.9078915119171143
Epoch: 16, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.848 Vali Acc: 0.859 Test Loss: 0.848 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9068586826324463
Epoch: 17, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.763 Vali Acc: 0.837 Test Loss: 0.763 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3214569091796875
Epoch: 18, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.676 Vali Acc: 0.856 Test Loss: 0.676 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9506287574768066
Epoch: 19, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.601 Vali Acc: 0.889 Test Loss: 0.601 Test Acc: 0.889
Validation loss decreased (-0.870361 --> -0.888883).  Saving model ...
Epoch: 20 cost time: 0.8010704517364502
Epoch: 20, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.534 Vali Acc: 0.904 Test Loss: 0.534 Test Acc: 0.904
Validation loss decreased (-0.888883 --> -0.903698).  Saving model ...
Epoch: 21 cost time: 0.8382024765014648
Epoch: 21, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.481 Vali Acc: 0.911 Test Loss: 0.481 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 22 cost time: 0.9420981407165527
Epoch: 22, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.431 Vali Acc: 0.911 Test Loss: 0.431 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 23 cost time: 0.9350411891937256
Epoch: 23, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.394 Vali Acc: 0.904 Test Loss: 0.394 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8860909938812256
Epoch: 24, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.361 Vali Acc: 0.911 Test Loss: 0.361 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 25 cost time: 0.9757978916168213
Epoch: 25, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.333 Vali Acc: 0.911 Test Loss: 0.333 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 26 cost time: 0.869121789932251
Epoch: 26, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.314 Vali Acc: 0.907 Test Loss: 0.314 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9274826049804688
Epoch: 27, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.295 Vali Acc: 0.907 Test Loss: 0.295 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1429827213287354
Epoch: 28, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.276 Vali Acc: 0.907 Test Loss: 0.276 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0485272407531738
Epoch: 29, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.257 Vali Acc: 0.915 Test Loss: 0.257 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 30 cost time: 1.119605302810669
Epoch: 30, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.914812 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.8457562923431396
Epoch: 31, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.0664207935333252
Epoch: 32, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.230 Vali Acc: 0.915 Test Loss: 0.230 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.1986188888549805
Epoch: 33, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0465304851531982
Epoch: 34, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.236 Vali Acc: 0.915 Test Loss: 0.236 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.123368501663208
Epoch: 35, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.235 Vali Acc: 0.915 Test Loss: 0.235 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.061589241027832
Epoch: 36, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.994746208190918
Epoch: 37, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.06270170211792
Epoch: 38, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.142669916152954
Epoch: 39, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.0233631134033203
Epoch: 40, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 2343094
model size : 11.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.763298273086548
Epoch: 1, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.817 Vali Acc: 0.144 Test Loss: 1.817 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.7306675910949707
Epoch: 2, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.776 Vali Acc: 0.133 Test Loss: 1.776 Test Acc: 0.133
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8193480968475342
Epoch: 3, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.731 Vali Acc: 0.152 Test Loss: 1.731 Test Acc: 0.152
Validation loss decreased (-0.144426 --> -0.151835).  Saving model ...
Epoch: 4 cost time: 1.0587069988250732
Epoch: 4, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.673 Vali Acc: 0.267 Test Loss: 1.673 Test Acc: 0.267
Validation loss decreased (-0.151835 --> -0.266650).  Saving model ...
Epoch: 5 cost time: 0.8100171089172363
Epoch: 5, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.625 Vali Acc: 0.404 Test Loss: 1.625 Test Acc: 0.404
Validation loss decreased (-0.266650 --> -0.403687).  Saving model ...
Epoch: 6 cost time: 0.7634189128875732
Epoch: 6, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.579 Vali Acc: 0.426 Test Loss: 1.579 Test Acc: 0.426
Validation loss decreased (-0.403687 --> -0.425910).  Saving model ...
Epoch: 7 cost time: 0.9010083675384521
Epoch: 7, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.523 Vali Acc: 0.474 Test Loss: 1.523 Test Acc: 0.474
Validation loss decreased (-0.425910 --> -0.474059).  Saving model ...
Epoch: 8 cost time: 0.7877638339996338
Epoch: 8, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.445 Vali Acc: 0.552 Test Loss: 1.445 Test Acc: 0.552
Validation loss decreased (-0.474059 --> -0.551837).  Saving model ...
Epoch: 9 cost time: 0.7815456390380859
Epoch: 9, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.351 Vali Acc: 0.707 Test Loss: 1.351 Test Acc: 0.707
Validation loss decreased (-0.551837 --> -0.707394).  Saving model ...
Epoch: 10 cost time: 0.8464531898498535
Epoch: 10, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.257 Vali Acc: 0.833 Test Loss: 1.257 Test Acc: 0.833
Validation loss decreased (-0.707394 --> -0.833321).  Saving model ...
Epoch: 11 cost time: 0.8845944404602051
Epoch: 11, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.164 Vali Acc: 0.874 Test Loss: 1.164 Test Acc: 0.874
Validation loss decreased (-0.833321 --> -0.874062).  Saving model ...
Epoch: 12 cost time: 0.8898847103118896
Epoch: 12, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.073 Vali Acc: 0.863 Test Loss: 1.073 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7582747936248779
Epoch: 13, Steps: 2 | Train Loss: 0.926 Vali Loss: 0.977 Vali Acc: 0.881 Test Loss: 0.977 Test Acc: 0.881
Validation loss decreased (-0.874062 --> -0.881472).  Saving model ...
Epoch: 14 cost time: 0.8480989933013916
Epoch: 14, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.880 Vali Acc: 0.907 Test Loss: 0.880 Test Acc: 0.907
Validation loss decreased (-0.881472 --> -0.907399).  Saving model ...
Epoch: 15 cost time: 0.9511175155639648
Epoch: 15, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.791 Vali Acc: 0.919 Test Loss: 0.791 Test Acc: 0.919
Validation loss decreased (-0.907399 --> -0.918511).  Saving model ...
Epoch: 16 cost time: 0.7964661121368408
Epoch: 16, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.711 Vali Acc: 0.915 Test Loss: 0.711 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8369035720825195
Epoch: 17, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.649 Vali Acc: 0.904 Test Loss: 0.649 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8086137771606445
Epoch: 18, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.576 Vali Acc: 0.922 Test Loss: 0.576 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922216).  Saving model ...
Epoch: 19 cost time: 0.8514764308929443
Epoch: 19, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.509 Vali Acc: 0.933 Test Loss: 0.509 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933328).  Saving model ...
Epoch: 20 cost time: 1.1068484783172607
Epoch: 20, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.455 Vali Acc: 0.933 Test Loss: 0.455 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 21 cost time: 0.8646345138549805
Epoch: 21, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.412 Vali Acc: 0.937 Test Loss: 0.412 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 22 cost time: 0.8024189472198486
Epoch: 22, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.382 Vali Acc: 0.930 Test Loss: 0.382 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7902779579162598
Epoch: 23, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.355 Vali Acc: 0.922 Test Loss: 0.355 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8345856666564941
Epoch: 24, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9441311359405518
Epoch: 25, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.310 Vali Acc: 0.933 Test Loss: 0.310 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9386920928955078
Epoch: 26, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.286 Vali Acc: 0.941 Test Loss: 0.286 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940738).  Saving model ...
Epoch: 27 cost time: 0.9611647129058838
Epoch: 27, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 28 cost time: 0.9660775661468506
Epoch: 28, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.7990765571594238
Epoch: 29, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.1436305046081543
Epoch: 30, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9230899810791016
Epoch: 31, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.126718521118164
Epoch: 32, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.926640510559082
Epoch: 33, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7407429218292236
Epoch: 34, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9661285877227783
Epoch: 35, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.056673526763916
Epoch: 36, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.933936357498169
Epoch: 37, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.099189043045044
Epoch: 38, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 2341686
model size : 11.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.647294521331787
Epoch: 1, Steps: 2 | Train Loss: 1.894 Vali Loss: 1.857 Vali Acc: 0.170 Test Loss: 1.857 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.7743754386901855
Epoch: 2, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.836 Vali Acc: 0.174 Test Loss: 1.836 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.8475456237792969
Epoch: 3, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.807 Vali Acc: 0.204 Test Loss: 1.807 Test Acc: 0.204
Validation loss decreased (-0.174056 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.9226851463317871
Epoch: 4, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.759 Vali Acc: 0.263 Test Loss: 1.759 Test Acc: 0.263
Validation loss decreased (-0.203686 --> -0.262945).  Saving model ...
Epoch: 5 cost time: 0.9445652961730957
Epoch: 5, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.702 Vali Acc: 0.330 Test Loss: 1.702 Test Acc: 0.330
Validation loss decreased (-0.262945 --> -0.329613).  Saving model ...
Epoch: 6 cost time: 1.0137643814086914
Epoch: 6, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.645 Vali Acc: 0.415 Test Loss: 1.645 Test Acc: 0.415
Validation loss decreased (-0.329613 --> -0.414798).  Saving model ...
Epoch: 7 cost time: 1.002842903137207
Epoch: 7, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.576 Vali Acc: 0.526 Test Loss: 1.576 Test Acc: 0.526
Validation loss decreased (-0.414798 --> -0.525910).  Saving model ...
Epoch: 8 cost time: 0.8434038162231445
Epoch: 8, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.500 Vali Acc: 0.563 Test Loss: 1.500 Test Acc: 0.563
Validation loss decreased (-0.525910 --> -0.562948).  Saving model ...
Epoch: 9 cost time: 0.9014537334442139
Epoch: 9, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.418 Vali Acc: 0.600 Test Loss: 1.418 Test Acc: 0.600
Validation loss decreased (-0.562948 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 0.7609167098999023
Epoch: 10, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.333 Vali Acc: 0.663 Test Loss: 1.333 Test Acc: 0.663
Validation loss decreased (-0.599986 --> -0.662950).  Saving model ...
Epoch: 11 cost time: 1.0673043727874756
Epoch: 11, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.249 Vali Acc: 0.715 Test Loss: 1.249 Test Acc: 0.715
Validation loss decreased (-0.662950 --> -0.714802).  Saving model ...
Epoch: 12 cost time: 1.0625865459442139
Epoch: 12, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.161 Vali Acc: 0.785 Test Loss: 1.161 Test Acc: 0.785
Validation loss decreased (-0.714802 --> -0.785174).  Saving model ...
Epoch: 13 cost time: 0.9514031410217285
Epoch: 13, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.074 Vali Acc: 0.800 Test Loss: 1.074 Test Acc: 0.800
Validation loss decreased (-0.785174 --> -0.799989).  Saving model ...
Epoch: 14 cost time: 0.9586100578308105
Epoch: 14, Steps: 2 | Train Loss: 0.938 Vali Loss: 0.984 Vali Acc: 0.833 Test Loss: 0.984 Test Acc: 0.833
Validation loss decreased (-0.799989 --> -0.833323).  Saving model ...
Epoch: 15 cost time: 1.0076031684875488
Epoch: 15, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.895 Vali Acc: 0.856 Test Loss: 0.895 Test Acc: 0.856
Validation loss decreased (-0.833323 --> -0.855547).  Saving model ...
Epoch: 16 cost time: 1.121025800704956
Epoch: 16, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.810 Vali Acc: 0.870 Test Loss: 0.810 Test Acc: 0.870
Validation loss decreased (-0.855547 --> -0.870362).  Saving model ...
Epoch: 17 cost time: 0.9127888679504395
Epoch: 17, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.732 Vali Acc: 0.885 Test Loss: 0.732 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885178).  Saving model ...
Epoch: 18 cost time: 0.9794971942901611
Epoch: 18, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.659 Vali Acc: 0.904 Test Loss: 0.659 Test Acc: 0.904
Validation loss decreased (-0.885178 --> -0.903697).  Saving model ...
Epoch: 19 cost time: 0.9652647972106934
Epoch: 19, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.592 Vali Acc: 0.919 Test Loss: 0.592 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918513).  Saving model ...
Epoch: 20 cost time: 1.160658359527588
Epoch: 20, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.535 Vali Acc: 0.922 Test Loss: 0.535 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 21 cost time: 1.1026368141174316
Epoch: 21, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.485 Vali Acc: 0.933 Test Loss: 0.485 Test Acc: 0.933
Validation loss decreased (-0.922217 --> -0.933328).  Saving model ...
Epoch: 22 cost time: 0.8493893146514893
Epoch: 22, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.446 Vali Acc: 0.922 Test Loss: 0.446 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0467886924743652
Epoch: 23, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.411 Vali Acc: 0.926 Test Loss: 0.411 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.190397024154663
Epoch: 24, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8652901649475098
Epoch: 25, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.347 Vali Acc: 0.937 Test Loss: 0.347 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937034).  Saving model ...
Epoch: 26 cost time: 0.6875624656677246
Epoch: 26, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.314 Vali Acc: 0.933 Test Loss: 0.314 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1086046695709229
Epoch: 27, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9616777896881104
Epoch: 28, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2127325534820557
Epoch: 29, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.8553595542907715
Epoch: 30, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9408261775970459
Epoch: 31, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.9805700778961182
Epoch: 32, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.256 Vali Acc: 0.941 Test Loss: 0.256 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 33 cost time: 0.8902866840362549
Epoch: 33, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 1.0206058025360107
Epoch: 34, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.8508429527282715
Epoch: 35, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9822094440460205
Epoch: 36, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.8847639560699463
Epoch: 37, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8174388408660889
Epoch: 38, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.1134295463562012
Epoch: 39, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0326945781707764
Epoch: 40, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9241347312927246
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9325039386749268
Epoch: 42, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9607138633728027
Epoch: 43, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8763847351074219
Epoch: 44, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.9745650291442871
Epoch: 45, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 1.1437244415283203
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.0569145679473877
Epoch: 47, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.0584182739257812
Epoch: 48, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7820301055908203
Epoch: 49, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9866774082183838
Epoch: 50, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9174268245697021
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.124100923538208
Epoch: 52, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0843799114227295
Epoch: 53, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.8501682281494141
Epoch: 54, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.0374224185943604
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 2340278
model size : 11.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6276400089263916
Epoch: 1, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.823 Vali Acc: 0.174 Test Loss: 1.823 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.9465627670288086
Epoch: 2, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.797 Vali Acc: 0.193 Test Loss: 1.797 Test Acc: 0.193
Validation loss decreased (-0.174056 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 0.7879300117492676
Epoch: 3, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.768 Vali Acc: 0.233 Test Loss: 1.768 Test Acc: 0.233
Validation loss decreased (-0.192575 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 0.7892303466796875
Epoch: 4, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.727 Vali Acc: 0.237 Test Loss: 1.727 Test Acc: 0.237
Validation loss decreased (-0.233316 --> -0.237020).  Saving model ...
Epoch: 5 cost time: 0.900343656539917
Epoch: 5, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.684 Vali Acc: 0.289 Test Loss: 1.684 Test Acc: 0.289
Validation loss decreased (-0.237020 --> -0.288872).  Saving model ...
Epoch: 6 cost time: 0.9717257022857666
Epoch: 6, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.635 Vali Acc: 0.356 Test Loss: 1.635 Test Acc: 0.356
Validation loss decreased (-0.288872 --> -0.355539).  Saving model ...
Epoch: 7 cost time: 0.8774735927581787
Epoch: 7, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.579 Vali Acc: 0.437 Test Loss: 1.579 Test Acc: 0.437
Validation loss decreased (-0.355539 --> -0.437021).  Saving model ...
Epoch: 8 cost time: 0.8163168430328369
Epoch: 8, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.512 Vali Acc: 0.504 Test Loss: 1.512 Test Acc: 0.504
Validation loss decreased (-0.437021 --> -0.503689).  Saving model ...
Epoch: 9 cost time: 0.819760799407959
Epoch: 9, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.439 Vali Acc: 0.567 Test Loss: 1.439 Test Acc: 0.567
Validation loss decreased (-0.503689 --> -0.566652).  Saving model ...
Epoch: 10 cost time: 0.8284575939178467
Epoch: 10, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.358 Vali Acc: 0.596 Test Loss: 1.358 Test Acc: 0.596
Validation loss decreased (-0.566652 --> -0.596283).  Saving model ...
Epoch: 11 cost time: 0.6813724040985107
Epoch: 11, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.276 Vali Acc: 0.652 Test Loss: 1.276 Test Acc: 0.652
Validation loss decreased (-0.596283 --> -0.651839).  Saving model ...
Epoch: 12 cost time: 0.8867001533508301
Epoch: 12, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.191 Vali Acc: 0.681 Test Loss: 1.191 Test Acc: 0.681
Validation loss decreased (-0.651839 --> -0.681470).  Saving model ...
Epoch: 13 cost time: 0.918079137802124
Epoch: 13, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.107 Vali Acc: 0.756 Test Loss: 1.107 Test Acc: 0.756
Validation loss decreased (-0.681470 --> -0.755544).  Saving model ...
Epoch: 14 cost time: 0.7142925262451172
Epoch: 14, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.023 Vali Acc: 0.778 Test Loss: 1.023 Test Acc: 0.778
Validation loss decreased (-0.755544 --> -0.777768).  Saving model ...
Epoch: 15 cost time: 1.1524615287780762
Epoch: 15, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.944 Vali Acc: 0.793 Test Loss: 0.944 Test Acc: 0.793
Validation loss decreased (-0.777768 --> -0.792583).  Saving model ...
Epoch: 16 cost time: 1.0282008647918701
Epoch: 16, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.861 Vali Acc: 0.811 Test Loss: 0.861 Test Acc: 0.811
Validation loss decreased (-0.792583 --> -0.811103).  Saving model ...
Epoch: 17 cost time: 0.7832546234130859
Epoch: 17, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.783 Vali Acc: 0.848 Test Loss: 0.783 Test Acc: 0.848
Validation loss decreased (-0.811103 --> -0.848140).  Saving model ...
Epoch: 18 cost time: 0.8394989967346191
Epoch: 18, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.717 Vali Acc: 0.830 Test Loss: 0.717 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8444833755493164
Epoch: 19, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.661 Vali Acc: 0.804 Test Loss: 0.661 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8723008632659912
Epoch: 20, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.598 Vali Acc: 0.863 Test Loss: 0.598 Test Acc: 0.863
Validation loss decreased (-0.848140 --> -0.862957).  Saving model ...
Epoch: 21 cost time: 0.8740115165710449
Epoch: 21, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.545 Vali Acc: 0.878 Test Loss: 0.545 Test Acc: 0.878
Validation loss decreased (-0.862957 --> -0.877772).  Saving model ...
Epoch: 22 cost time: 0.8603932857513428
Epoch: 22, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.488 Vali Acc: 0.907 Test Loss: 0.488 Test Acc: 0.907
Validation loss decreased (-0.877772 --> -0.907403).  Saving model ...
Epoch: 23 cost time: 0.8733351230621338
Epoch: 23, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.442 Vali Acc: 0.922 Test Loss: 0.442 Test Acc: 0.922
Validation loss decreased (-0.907403 --> -0.922218).  Saving model ...
Epoch: 24 cost time: 0.9390416145324707
Epoch: 24, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.405 Vali Acc: 0.926 Test Loss: 0.405 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 25 cost time: 0.8756058216094971
Epoch: 25, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.385 Vali Acc: 0.915 Test Loss: 0.385 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9029059410095215
Epoch: 26, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.381 Vali Acc: 0.881 Test Loss: 0.381 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1284284591674805
Epoch: 27, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.369 Vali Acc: 0.870 Test Loss: 0.369 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0585784912109375
Epoch: 28, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.326 Vali Acc: 0.922 Test Loss: 0.326 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7549057006835938
Epoch: 29, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.9903898239135742
Epoch: 30, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.9808437824249268
Epoch: 31, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.927262544631958
Epoch: 32, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8747315406799316
Epoch: 33, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9264419078826904
Epoch: 34, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8523869514465332
Epoch: 35, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.8163414001464844
Epoch: 36, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.9157662391662598
Epoch: 37, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8515825271606445
Epoch: 38, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8029730319976807
Epoch: 39, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8982429504394531
Epoch: 40, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7681529521942139
Epoch: 41, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8178021907806396
Epoch: 42, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.835928201675415
Epoch: 43, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7390925884246826
Epoch: 44, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8565371036529541
Epoch: 45, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.819000244140625
Epoch: 46, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 2114230
model size : 10.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6025874614715576
Epoch: 1, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.781 Vali Acc: 0.130 Test Loss: 1.781 Test Acc: 0.130
Validation loss decreased (inf --> -0.129612).  Saving model ...
Epoch: 2 cost time: 0.8603065013885498
Epoch: 2, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.740 Vali Acc: 0.144 Test Loss: 1.740 Test Acc: 0.144
Validation loss decreased (-0.129612 --> -0.144427).  Saving model ...
Epoch: 3 cost time: 0.6681711673736572
Epoch: 3, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.695 Vali Acc: 0.207 Test Loss: 1.695 Test Acc: 0.207
Validation loss decreased (-0.144427 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.9615015983581543
Epoch: 4, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.639 Vali Acc: 0.285 Test Loss: 1.639 Test Acc: 0.285
Validation loss decreased (-0.207390 --> -0.285169).  Saving model ...
Epoch: 5 cost time: 0.7914645671844482
Epoch: 5, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.590 Vali Acc: 0.563 Test Loss: 1.590 Test Acc: 0.563
Validation loss decreased (-0.285169 --> -0.562947).  Saving model ...
Epoch: 6 cost time: 0.8036501407623291
Epoch: 6, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.542 Vali Acc: 0.630 Test Loss: 1.542 Test Acc: 0.630
Validation loss decreased (-0.562947 --> -0.629614).  Saving model ...
Epoch: 7 cost time: 0.9059345722198486
Epoch: 7, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.489 Vali Acc: 0.644 Test Loss: 1.489 Test Acc: 0.644
Validation loss decreased (-0.629614 --> -0.644430).  Saving model ...
Epoch: 8 cost time: 0.7481827735900879
Epoch: 8, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.421 Vali Acc: 0.678 Test Loss: 1.421 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677764).  Saving model ...
Epoch: 9 cost time: 0.78822922706604
Epoch: 9, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.345 Vali Acc: 0.700 Test Loss: 1.345 Test Acc: 0.700
Validation loss decreased (-0.677764 --> -0.699987).  Saving model ...
Epoch: 10 cost time: 1.137873649597168
Epoch: 10, Steps: 2 | Train Loss: 1.289 Vali Loss: 1.258 Vali Acc: 0.763 Test Loss: 1.258 Test Acc: 0.763
Validation loss decreased (-0.699987 --> -0.762950).  Saving model ...
Epoch: 11 cost time: 1.1883697509765625
Epoch: 11, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.170 Vali Acc: 0.822 Test Loss: 1.170 Test Acc: 0.822
Validation loss decreased (-0.762950 --> -0.822211).  Saving model ...
Epoch: 12 cost time: 1.1362898349761963
Epoch: 12, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.089 Vali Acc: 0.830 Test Loss: 1.089 Test Acc: 0.830
Validation loss decreased (-0.822211 --> -0.829619).  Saving model ...
Epoch: 13 cost time: 0.9568395614624023
Epoch: 13, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.004 Vali Acc: 0.844 Test Loss: 1.004 Test Acc: 0.844
Validation loss decreased (-0.829619 --> -0.844434).  Saving model ...
Epoch: 14 cost time: 1.2916221618652344
Epoch: 14, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.911 Vali Acc: 0.881 Test Loss: 0.911 Test Acc: 0.881
Validation loss decreased (-0.844434 --> -0.881472).  Saving model ...
Epoch: 15 cost time: 0.8977870941162109
Epoch: 15, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.820 Vali Acc: 0.915 Test Loss: 0.820 Test Acc: 0.915
Validation loss decreased (-0.881472 --> -0.914807).  Saving model ...
Epoch: 16 cost time: 1.3298733234405518
Epoch: 16, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.745 Vali Acc: 0.907 Test Loss: 0.745 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3482437133789062
Epoch: 17, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.674 Vali Acc: 0.915 Test Loss: 0.674 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 18 cost time: 0.7810609340667725
Epoch: 18, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.600 Vali Acc: 0.922 Test Loss: 0.600 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 19 cost time: 0.9420180320739746
Epoch: 19, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.535 Vali Acc: 0.930 Test Loss: 0.535 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 20 cost time: 0.8810276985168457
Epoch: 20, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.479 Vali Acc: 0.926 Test Loss: 0.479 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.810173511505127
Epoch: 21, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.439 Vali Acc: 0.922 Test Loss: 0.439 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1351318359375
Epoch: 22, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.407 Vali Acc: 0.915 Test Loss: 0.407 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9205360412597656
Epoch: 23, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.379 Vali Acc: 0.915 Test Loss: 0.379 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9360153675079346
Epoch: 24, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.352 Vali Acc: 0.919 Test Loss: 0.352 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9718091487884521
Epoch: 25, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8263554573059082
Epoch: 26, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0875513553619385
Epoch: 27, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9251184463500977
Epoch: 28, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.291 Vali Acc: 0.915 Test Loss: 0.291 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8183050155639648
Epoch: 29, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.277 Vali Acc: 0.915 Test Loss: 0.277 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 2112822
model size : 10.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8299551010131836
Epoch: 1, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.835 Vali Acc: 0.170 Test Loss: 1.835 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.7417876720428467
Epoch: 2, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.796 Vali Acc: 0.178 Test Loss: 1.796 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.7504143714904785
Epoch: 3, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.758 Vali Acc: 0.196 Test Loss: 1.758 Test Acc: 0.196
Validation loss decreased (-0.177760 --> -0.196279).  Saving model ...
Epoch: 4 cost time: 0.7727067470550537
Epoch: 4, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.707 Vali Acc: 0.285 Test Loss: 1.707 Test Acc: 0.285
Validation loss decreased (-0.196279 --> -0.285168).  Saving model ...
Epoch: 5 cost time: 0.8332288265228271
Epoch: 5, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.662 Vali Acc: 0.419 Test Loss: 1.662 Test Acc: 0.419
Validation loss decreased (-0.285168 --> -0.418502).  Saving model ...
Epoch: 6 cost time: 1.180434226989746
Epoch: 6, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.618 Vali Acc: 0.448 Test Loss: 1.618 Test Acc: 0.448
Validation loss decreased (-0.418502 --> -0.448132).  Saving model ...
Epoch: 7 cost time: 0.9939305782318115
Epoch: 7, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.562 Vali Acc: 0.507 Test Loss: 1.562 Test Acc: 0.507
Validation loss decreased (-0.448132 --> -0.507392).  Saving model ...
Epoch: 8 cost time: 0.9502420425415039
Epoch: 8, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.497 Vali Acc: 0.548 Test Loss: 1.497 Test Acc: 0.548
Validation loss decreased (-0.507392 --> -0.548133).  Saving model ...
Epoch: 9 cost time: 0.9253377914428711
Epoch: 9, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.418 Vali Acc: 0.607 Test Loss: 1.418 Test Acc: 0.607
Validation loss decreased (-0.548133 --> -0.607393).  Saving model ...
Epoch: 10 cost time: 0.9891362190246582
Epoch: 10, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.333 Vali Acc: 0.711 Test Loss: 1.333 Test Acc: 0.711
Validation loss decreased (-0.607393 --> -0.711098).  Saving model ...
Epoch: 11 cost time: 0.8533859252929688
Epoch: 11, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.247 Vali Acc: 0.804 Test Loss: 1.247 Test Acc: 0.804
Validation loss decreased (-0.711098 --> -0.803691).  Saving model ...
Epoch: 12 cost time: 0.7952597141265869
Epoch: 12, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.162 Vali Acc: 0.826 Test Loss: 1.162 Test Acc: 0.826
Validation loss decreased (-0.803691 --> -0.825914).  Saving model ...
Epoch: 13 cost time: 0.9890537261962891
Epoch: 13, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.068 Vali Acc: 0.859 Test Loss: 1.068 Test Acc: 0.859
Validation loss decreased (-0.825914 --> -0.859249).  Saving model ...
Epoch: 14 cost time: 0.9313485622406006
Epoch: 14, Steps: 2 | Train Loss: 0.950 Vali Loss: 0.966 Vali Acc: 0.878 Test Loss: 0.966 Test Acc: 0.878
Validation loss decreased (-0.859249 --> -0.877768).  Saving model ...
Epoch: 15 cost time: 0.8847830295562744
Epoch: 15, Steps: 2 | Train Loss: 0.833 Vali Loss: 0.876 Vali Acc: 0.889 Test Loss: 0.876 Test Acc: 0.889
Validation loss decreased (-0.877768 --> -0.888880).  Saving model ...
Epoch: 16 cost time: 0.8705275058746338
Epoch: 16, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.798 Vali Acc: 0.881 Test Loss: 0.798 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7554237842559814
Epoch: 17, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.721 Vali Acc: 0.904 Test Loss: 0.721 Test Acc: 0.904
Validation loss decreased (-0.888880 --> -0.903696).  Saving model ...
Epoch: 18 cost time: 0.8721857070922852
Epoch: 18, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.643 Vali Acc: 0.907 Test Loss: 0.643 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907401).  Saving model ...
Epoch: 19 cost time: 1.012026071548462
Epoch: 19, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.583 Vali Acc: 0.915 Test Loss: 0.583 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 20 cost time: 0.7019369602203369
Epoch: 20, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.531 Vali Acc: 0.911 Test Loss: 0.531 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9381389617919922
Epoch: 21, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.491 Vali Acc: 0.893 Test Loss: 0.491 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8583745956420898
Epoch: 22, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8935680389404297
Epoch: 23, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.413 Vali Acc: 0.915 Test Loss: 0.413 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914811).  Saving model ...
Epoch: 24 cost time: 0.7582323551177979
Epoch: 24, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.388 Vali Acc: 0.926 Test Loss: 0.388 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925922).  Saving model ...
Epoch: 25 cost time: 0.8702449798583984
Epoch: 25, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.364 Vali Acc: 0.922 Test Loss: 0.364 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8196938037872314
Epoch: 26, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.339 Vali Acc: 0.915 Test Loss: 0.339 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9596858024597168
Epoch: 27, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.328 Vali Acc: 0.904 Test Loss: 0.328 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8947415351867676
Epoch: 28, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.310 Vali Acc: 0.907 Test Loss: 0.310 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7919456958770752
Epoch: 29, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 30 cost time: 0.7355141639709473
Epoch: 30, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.8211655616760254
Epoch: 31, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9248647689819336
Epoch: 32, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8547792434692383
Epoch: 33, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.909132719039917
Epoch: 34, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7474081516265869
Epoch: 35, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7969427108764648
Epoch: 36, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7499401569366455
Epoch: 37, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6912200450897217
Epoch: 38, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8130016326904297
Epoch: 39, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8213403224945068
Epoch: 40, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 2111414
model size : 10.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.94771671295166
Epoch: 1, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.854 Vali Acc: 0.159 Test Loss: 1.854 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 0.7864842414855957
Epoch: 2, Steps: 2 | Train Loss: 1.917 Vali Loss: 1.826 Vali Acc: 0.148 Test Loss: 1.826 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7743754386901855
Epoch: 3, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.786 Vali Acc: 0.189 Test Loss: 1.786 Test Acc: 0.189
Validation loss decreased (-0.159241 --> -0.188871).  Saving model ...
Epoch: 4 cost time: 0.7167303562164307
Epoch: 4, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.726 Vali Acc: 0.244 Test Loss: 1.726 Test Acc: 0.244
Validation loss decreased (-0.188871 --> -0.244427).  Saving model ...
Epoch: 5 cost time: 0.894819974899292
Epoch: 5, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.668 Vali Acc: 0.356 Test Loss: 1.668 Test Acc: 0.356
Validation loss decreased (-0.244427 --> -0.355539).  Saving model ...
Epoch: 6 cost time: 0.733536958694458
Epoch: 6, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.616 Vali Acc: 0.344 Test Loss: 1.616 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8787322044372559
Epoch: 7, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.566 Vali Acc: 0.307 Test Loss: 1.566 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8343789577484131
Epoch: 8, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.489 Vali Acc: 0.378 Test Loss: 1.489 Test Acc: 0.378
Validation loss decreased (-0.355539 --> -0.377763).  Saving model ...
Epoch: 9 cost time: 0.7528839111328125
Epoch: 9, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.398 Vali Acc: 0.563 Test Loss: 1.398 Test Acc: 0.563
Validation loss decreased (-0.377763 --> -0.562949).  Saving model ...
Epoch: 10 cost time: 0.8169360160827637
Epoch: 10, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.301 Vali Acc: 0.807 Test Loss: 1.301 Test Acc: 0.807
Validation loss decreased (-0.562949 --> -0.807394).  Saving model ...
Epoch: 11 cost time: 0.7329373359680176
Epoch: 11, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.215 Vali Acc: 0.848 Test Loss: 1.215 Test Acc: 0.848
Validation loss decreased (-0.807394 --> -0.848136).  Saving model ...
Epoch: 12 cost time: 0.8457694053649902
Epoch: 12, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.140 Vali Acc: 0.781 Test Loss: 1.140 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0053606033325195
Epoch: 13, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.057 Vali Acc: 0.796 Test Loss: 1.057 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8375585079193115
Epoch: 14, Steps: 2 | Train Loss: 0.935 Vali Loss: 0.962 Vali Acc: 0.874 Test Loss: 0.962 Test Acc: 0.874
Validation loss decreased (-0.848136 --> -0.874064).  Saving model ...
Epoch: 15 cost time: 0.7654263973236084
Epoch: 15, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.865 Vali Acc: 0.878 Test Loss: 0.865 Test Acc: 0.878
Validation loss decreased (-0.874064 --> -0.877769).  Saving model ...
Epoch: 16 cost time: 0.703648567199707
Epoch: 16, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.783 Vali Acc: 0.867 Test Loss: 0.783 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7800028324127197
Epoch: 17, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.703 Vali Acc: 0.896 Test Loss: 0.703 Test Acc: 0.896
Validation loss decreased (-0.877769 --> -0.896289).  Saving model ...
Epoch: 18 cost time: 0.9785666465759277
Epoch: 18, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.628 Vali Acc: 0.922 Test Loss: 0.628 Test Acc: 0.922
Validation loss decreased (-0.896289 --> -0.922216).  Saving model ...
Epoch: 19 cost time: 0.7801122665405273
Epoch: 19, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.567 Vali Acc: 0.893 Test Loss: 0.567 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8622679710388184
Epoch: 20, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.515 Vali Acc: 0.881 Test Loss: 0.515 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6743748188018799
Epoch: 21, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.463 Vali Acc: 0.904 Test Loss: 0.463 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7795274257659912
Epoch: 22, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.414 Vali Acc: 0.919 Test Loss: 0.414 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8212039470672607
Epoch: 23, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.378 Vali Acc: 0.922 Test Loss: 0.378 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922218).  Saving model ...
Epoch: 24 cost time: 0.7574672698974609
Epoch: 24, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.350 Vali Acc: 0.930 Test Loss: 0.350 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 25 cost time: 0.9743227958679199
Epoch: 25, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7471587657928467
Epoch: 26, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.314 Vali Acc: 0.915 Test Loss: 0.314 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0054526329040527
Epoch: 27, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.308 Vali Acc: 0.904 Test Loss: 0.308 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8312737941741943
Epoch: 28, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7707359790802002
Epoch: 29, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.276 Vali Acc: 0.919 Test Loss: 0.276 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9356732368469238
Epoch: 30, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.9309489727020264
Epoch: 31, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.981360673904419
Epoch: 32, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2377567291259766
Epoch: 33, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 34 cost time: 0.6916992664337158
Epoch: 34, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.8539972305297852
Epoch: 35, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.9505913257598877
Epoch: 36, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.9958457946777344
Epoch: 37, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7732553482055664
Epoch: 38, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8774349689483643
Epoch: 39, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 40 cost time: 0.7141702175140381
Epoch: 40, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.7670960426330566
Epoch: 41, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.7717957496643066
Epoch: 42, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 1.3504259586334229
Epoch: 43, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1592481136322021
Epoch: 44, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9624793529510498
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.949347972869873
Epoch: 46, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1558473110198975
Epoch: 47, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.254478931427002
Epoch: 48, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.0030848979949951
Epoch: 49, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.9635207653045654
Epoch: 50, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 51 cost time: 0.9358062744140625
Epoch: 51, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 52 cost time: 1.2116949558258057
Epoch: 52, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 1.149906873703003
Epoch: 53, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 54 cost time: 0.9628415107727051
Epoch: 54, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 55 cost time: 0.9198675155639648
Epoch: 55, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 56 cost time: 0.8455851078033447
Epoch: 56, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 1.1209123134613037
Epoch: 57, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.9569880962371826
Epoch: 58, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.9187057018280029
Epoch: 59, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 1.0382130146026611
Epoch: 60, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 1.1028072834014893
Epoch: 61, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 1.1175944805145264
Epoch: 62, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 1.3179240226745605
Epoch: 63, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 64 cost time: 0.8966269493103027
Epoch: 64, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 65 cost time: 0.9815304279327393
Epoch: 65, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9856922626495361
Epoch: 66, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 67 cost time: 0.8255190849304199
Epoch: 67, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 68 cost time: 0.9851481914520264
Epoch: 68, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8253521919250488
Epoch: 69, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 1.3145692348480225
Epoch: 70, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.7950458526611328
Epoch: 71, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.7788670063018799
Epoch: 72, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 1.0811655521392822
Epoch: 73, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.1223387718200684
Epoch: 74, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 1.0026369094848633
Epoch: 75, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.8505706787109375
Epoch: 76, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 1.054861068725586
Epoch: 77, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 2110006
model size : 10.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5210695266723633
Epoch: 1, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.834 Vali Acc: 0.074 Test Loss: 1.834 Test Acc: 0.074
Validation loss decreased (inf --> -0.074056).  Saving model ...
Epoch: 2 cost time: 0.9538187980651855
Epoch: 2, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.821 Vali Acc: 0.089 Test Loss: 1.821 Test Acc: 0.089
Validation loss decreased (-0.074056 --> -0.088871).  Saving model ...
Epoch: 3 cost time: 1.033247709274292
Epoch: 3, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.803 Vali Acc: 0.115 Test Loss: 1.803 Test Acc: 0.115
Validation loss decreased (-0.088871 --> -0.114797).  Saving model ...
Epoch: 4 cost time: 0.7952439785003662
Epoch: 4, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.770 Vali Acc: 0.159 Test Loss: 1.770 Test Acc: 0.159
Validation loss decreased (-0.114797 --> -0.159242).  Saving model ...
Epoch: 5 cost time: 0.7572176456451416
Epoch: 5, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.731 Vali Acc: 0.226 Test Loss: 1.731 Test Acc: 0.226
Validation loss decreased (-0.159242 --> -0.225909).  Saving model ...
Epoch: 6 cost time: 0.9294466972351074
Epoch: 6, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.688 Vali Acc: 0.344 Test Loss: 1.688 Test Acc: 0.344
Validation loss decreased (-0.225909 --> -0.344428).  Saving model ...
Epoch: 7 cost time: 0.8742897510528564
Epoch: 7, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.640 Vali Acc: 0.419 Test Loss: 1.640 Test Acc: 0.419
Validation loss decreased (-0.344428 --> -0.418502).  Saving model ...
Epoch: 8 cost time: 0.7926769256591797
Epoch: 8, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.587 Vali Acc: 0.493 Test Loss: 1.587 Test Acc: 0.493
Validation loss decreased (-0.418502 --> -0.492577).  Saving model ...
Epoch: 9 cost time: 0.9246048927307129
Epoch: 9, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.529 Vali Acc: 0.533 Test Loss: 1.529 Test Acc: 0.533
Validation loss decreased (-0.492577 --> -0.533318).  Saving model ...
Epoch: 10 cost time: 1.1726114749908447
Epoch: 10, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.467 Vali Acc: 0.585 Test Loss: 1.467 Test Acc: 0.585
Validation loss decreased (-0.533318 --> -0.585171).  Saving model ...
Epoch: 11 cost time: 1.1428260803222656
Epoch: 11, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.401 Vali Acc: 0.644 Test Loss: 1.401 Test Acc: 0.644
Validation loss decreased (-0.585171 --> -0.644430).  Saving model ...
Epoch: 12 cost time: 0.9070312976837158
Epoch: 12, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.332 Vali Acc: 0.674 Test Loss: 1.332 Test Acc: 0.674
Validation loss decreased (-0.644430 --> -0.674061).  Saving model ...
Epoch: 13 cost time: 0.9258542060852051
Epoch: 13, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.262 Vali Acc: 0.689 Test Loss: 1.262 Test Acc: 0.689
Validation loss decreased (-0.674061 --> -0.688876).  Saving model ...
Epoch: 14 cost time: 0.9208316802978516
Epoch: 14, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.191 Vali Acc: 0.678 Test Loss: 1.191 Test Acc: 0.678
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8895537853240967
Epoch: 15, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.113 Vali Acc: 0.696 Test Loss: 1.113 Test Acc: 0.696
Validation loss decreased (-0.688876 --> -0.696285).  Saving model ...
Epoch: 16 cost time: 0.7960219383239746
Epoch: 16, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.031 Vali Acc: 0.733 Test Loss: 1.031 Test Acc: 0.733
Validation loss decreased (-0.696285 --> -0.733323).  Saving model ...
Epoch: 17 cost time: 0.7975590229034424
Epoch: 17, Steps: 2 | Train Loss: 0.953 Vali Loss: 0.956 Vali Acc: 0.826 Test Loss: 0.956 Test Acc: 0.826
Validation loss decreased (-0.733323 --> -0.825916).  Saving model ...
Epoch: 18 cost time: 1.0116229057312012
Epoch: 18, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.885 Vali Acc: 0.837 Test Loss: 0.885 Test Acc: 0.837
Validation loss decreased (-0.825916 --> -0.837028).  Saving model ...
Epoch: 19 cost time: 0.9035890102386475
Epoch: 19, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.819 Vali Acc: 0.852 Test Loss: 0.819 Test Acc: 0.852
Validation loss decreased (-0.837028 --> -0.851844).  Saving model ...
Epoch: 20 cost time: 0.7447302341461182
Epoch: 20, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.758 Vali Acc: 0.856 Test Loss: 0.758 Test Acc: 0.856
Validation loss decreased (-0.851844 --> -0.855548).  Saving model ...
Epoch: 21 cost time: 1.21010422706604
Epoch: 21, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.702 Vali Acc: 0.867 Test Loss: 0.702 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866660).  Saving model ...
Epoch: 22 cost time: 0.8997583389282227
Epoch: 22, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.652 Vali Acc: 0.870 Test Loss: 0.652 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 23 cost time: 0.9043915271759033
Epoch: 23, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.606 Vali Acc: 0.889 Test Loss: 0.606 Test Acc: 0.889
Validation loss decreased (-0.870364 --> -0.888883).  Saving model ...
Epoch: 24 cost time: 0.7777767181396484
Epoch: 24, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.569 Vali Acc: 0.893 Test Loss: 0.569 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 25 cost time: 0.8053479194641113
Epoch: 25, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.536 Vali Acc: 0.893 Test Loss: 0.536 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 26 cost time: 0.7126390933990479
Epoch: 26, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.503 Vali Acc: 0.896 Test Loss: 0.503 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 27 cost time: 0.712482213973999
Epoch: 27, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.478 Vali Acc: 0.889 Test Loss: 0.478 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0063481330871582
Epoch: 28, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.456 Vali Acc: 0.893 Test Loss: 0.456 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0748040676116943
Epoch: 29, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.437 Vali Acc: 0.904 Test Loss: 0.437 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 30 cost time: 0.9301044940948486
Epoch: 30, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.420 Vali Acc: 0.900 Test Loss: 0.420 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0904531478881836
Epoch: 31, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.405 Vali Acc: 0.904 Test Loss: 0.405 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903700).  Saving model ...
Epoch: 32 cost time: 0.9037513732910156
Epoch: 32, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.397 Vali Acc: 0.911 Test Loss: 0.397 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911107).  Saving model ...
Epoch: 33 cost time: 1.006899356842041
Epoch: 33, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.381 Vali Acc: 0.911 Test Loss: 0.381 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 34 cost time: 0.8598980903625488
Epoch: 34, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.366 Vali Acc: 0.915 Test Loss: 0.366 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 35 cost time: 1.0044453144073486
Epoch: 35, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.351 Vali Acc: 0.919 Test Loss: 0.351 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 36 cost time: 0.9646122455596924
Epoch: 36, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.339 Vali Acc: 0.919 Test Loss: 0.339 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 37 cost time: 0.7340538501739502
Epoch: 37, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.332 Vali Acc: 0.919 Test Loss: 0.332 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 38 cost time: 1.0238053798675537
Epoch: 38, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.328 Vali Acc: 0.919 Test Loss: 0.328 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 39 cost time: 0.9078538417816162
Epoch: 39, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.324 Vali Acc: 0.919 Test Loss: 0.324 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 40 cost time: 0.9410605430603027
Epoch: 40, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 41 cost time: 0.8788332939147949
Epoch: 41, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.312 Vali Acc: 0.919 Test Loss: 0.312 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 42 cost time: 0.784388542175293
Epoch: 42, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 43 cost time: 0.7237241268157959
Epoch: 43, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.305 Vali Acc: 0.919 Test Loss: 0.305 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 44 cost time: 1.0103707313537598
Epoch: 44, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 45 cost time: 1.0140399932861328
Epoch: 45, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.300 Vali Acc: 0.915 Test Loss: 0.300 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8138294219970703
Epoch: 46, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.296 Vali Acc: 0.915 Test Loss: 0.296 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.0568346977233887
Epoch: 47, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9002459049224854
Epoch: 48, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.290 Vali Acc: 0.911 Test Loss: 0.290 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8650872707366943
Epoch: 49, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9373490810394287
Epoch: 50, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.281 Vali Acc: 0.919 Test Loss: 0.281 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 51 cost time: 0.9152204990386963
Epoch: 51, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.276 Vali Acc: 0.915 Test Loss: 0.276 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8912203311920166
Epoch: 52, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 53 cost time: 0.8405327796936035
Epoch: 53, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 54 cost time: 0.7818558216094971
Epoch: 54, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.266 Vali Acc: 0.926 Test Loss: 0.266 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 55 cost time: 0.7423017024993896
Epoch: 55, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.873523473739624
Epoch: 56, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 1.0197036266326904
Epoch: 57, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8854897022247314
Epoch: 58, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8614752292633057
Epoch: 59, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.274 Vali Acc: 0.919 Test Loss: 0.274 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.6639354228973389
Epoch: 60, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.7516646385192871
Epoch: 61, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.9749581813812256
Epoch: 62, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.264 Vali Acc: 0.915 Test Loss: 0.264 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.8761117458343506
Epoch: 63, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.82454514503479
Epoch: 64, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 65 cost time: 0.8299539089202881
Epoch: 65, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.858637809753418
Epoch: 66, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.8748271465301514
Epoch: 67, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.9612605571746826
Epoch: 68, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.7963047027587891
Epoch: 69, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.9259684085845947
Epoch: 70, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 71 cost time: 0.83640456199646
Epoch: 71, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 72 cost time: 0.9639401435852051
Epoch: 72, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 73 cost time: 1.025735855102539
Epoch: 73, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.8393266201019287
Epoch: 74, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.8865840435028076
Epoch: 75, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.9353740215301514
Epoch: 76, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.8667726516723633
Epoch: 77, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.253 Vali Acc: 0.919 Test Loss: 0.253 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.8646104335784912
Epoch: 78, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.254 Vali Acc: 0.919 Test Loss: 0.254 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 1.2440011501312256
Epoch: 79, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.253 Vali Acc: 0.919 Test Loss: 0.253 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.8914706707000732
Epoch: 80, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.9743087291717529
Epoch: 81, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.971545934677124
Epoch: 82, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 1407926
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.739725351333618
Epoch: 1, Steps: 2 | Train Loss: 2.031 Vali Loss: 1.886 Vali Acc: 0.093 Test Loss: 1.886 Test Acc: 0.093
Validation loss decreased (inf --> -0.092574).  Saving model ...
Epoch: 2 cost time: 0.8371484279632568
Epoch: 2, Steps: 2 | Train Loss: 1.931 Vali Loss: 1.865 Vali Acc: 0.100 Test Loss: 1.865 Test Acc: 0.100
Validation loss decreased (-0.092574 --> -0.099981).  Saving model ...
Epoch: 3 cost time: 0.9312210083007812
Epoch: 3, Steps: 2 | Train Loss: 1.967 Vali Loss: 1.839 Vali Acc: 0.115 Test Loss: 1.839 Test Acc: 0.115
Validation loss decreased (-0.099981 --> -0.114796).  Saving model ...
Epoch: 4 cost time: 0.8400137424468994
Epoch: 4, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.796 Vali Acc: 0.193 Test Loss: 1.796 Test Acc: 0.193
Validation loss decreased (-0.114796 --> -0.192575).  Saving model ...
Epoch: 5 cost time: 0.8423211574554443
Epoch: 5, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.744 Vali Acc: 0.226 Test Loss: 1.744 Test Acc: 0.226
Validation loss decreased (-0.192575 --> -0.225908).  Saving model ...
Epoch: 6 cost time: 1.0910429954528809
Epoch: 6, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.688 Vali Acc: 0.341 Test Loss: 1.688 Test Acc: 0.341
Validation loss decreased (-0.225908 --> -0.340724).  Saving model ...
Epoch: 7 cost time: 0.8654642105102539
Epoch: 7, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.625 Vali Acc: 0.567 Test Loss: 1.625 Test Acc: 0.567
Validation loss decreased (-0.340724 --> -0.566650).  Saving model ...
Epoch: 8 cost time: 0.9516162872314453
Epoch: 8, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.555 Vali Acc: 0.644 Test Loss: 1.555 Test Acc: 0.644
Validation loss decreased (-0.566650 --> -0.644429).  Saving model ...
Epoch: 9 cost time: 0.8689625263214111
Epoch: 9, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.480 Vali Acc: 0.667 Test Loss: 1.480 Test Acc: 0.667
Validation loss decreased (-0.644429 --> -0.666652).  Saving model ...
Epoch: 10 cost time: 0.787222146987915
Epoch: 10, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.398 Vali Acc: 0.756 Test Loss: 1.398 Test Acc: 0.756
Validation loss decreased (-0.666652 --> -0.755542).  Saving model ...
Epoch: 11 cost time: 0.8903837203979492
Epoch: 11, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.312 Vali Acc: 0.804 Test Loss: 1.312 Test Acc: 0.804
Validation loss decreased (-0.755542 --> -0.803691).  Saving model ...
Epoch: 12 cost time: 1.0484819412231445
Epoch: 12, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.222 Vali Acc: 0.848 Test Loss: 1.222 Test Acc: 0.848
Validation loss decreased (-0.803691 --> -0.848136).  Saving model ...
Epoch: 13 cost time: 1.1767594814300537
Epoch: 13, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.128 Vali Acc: 0.859 Test Loss: 1.128 Test Acc: 0.859
Validation loss decreased (-0.848136 --> -0.859248).  Saving model ...
Epoch: 14 cost time: 0.9013316631317139
Epoch: 14, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.034 Vali Acc: 0.900 Test Loss: 1.034 Test Acc: 0.900
Validation loss decreased (-0.859248 --> -0.899990).  Saving model ...
Epoch: 15 cost time: 0.8362410068511963
Epoch: 15, Steps: 2 | Train Loss: 0.947 Vali Loss: 0.947 Vali Acc: 0.915 Test Loss: 0.947 Test Acc: 0.915
Validation loss decreased (-0.899990 --> -0.914805).  Saving model ...
Epoch: 16 cost time: 0.7744507789611816
Epoch: 16, Steps: 2 | Train Loss: 0.900 Vali Loss: 0.866 Vali Acc: 0.915 Test Loss: 0.866 Test Acc: 0.915
Validation loss decreased (-0.914805 --> -0.914806).  Saving model ...
Epoch: 17 cost time: 0.8108677864074707
Epoch: 17, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.791 Vali Acc: 0.915 Test Loss: 0.791 Test Acc: 0.915
Validation loss decreased (-0.914806 --> -0.914807).  Saving model ...
Epoch: 18 cost time: 0.9372749328613281
Epoch: 18, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.723 Vali Acc: 0.922 Test Loss: 0.723 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922215).  Saving model ...
Epoch: 19 cost time: 0.8323659896850586
Epoch: 19, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.660 Vali Acc: 0.937 Test Loss: 0.660 Test Acc: 0.937
Validation loss decreased (-0.922215 --> -0.937030).  Saving model ...
Epoch: 20 cost time: 0.9206504821777344
Epoch: 20, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.604 Vali Acc: 0.937 Test Loss: 0.604 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937031).  Saving model ...
Epoch: 21 cost time: 0.8030712604522705
Epoch: 21, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.554 Vali Acc: 0.937 Test Loss: 0.554 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937031).  Saving model ...
Epoch: 22 cost time: 0.8672845363616943
Epoch: 22, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.510 Vali Acc: 0.941 Test Loss: 0.510 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940736).  Saving model ...
Epoch: 23 cost time: 0.7319250106811523
Epoch: 23, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.473 Vali Acc: 0.944 Test Loss: 0.473 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 24 cost time: 0.7185282707214355
Epoch: 24, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.445 Vali Acc: 0.937 Test Loss: 0.445 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9655194282531738
Epoch: 25, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.425 Vali Acc: 0.930 Test Loss: 0.425 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7659339904785156
Epoch: 26, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.418 Vali Acc: 0.911 Test Loss: 0.418 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0128436088562012
Epoch: 27, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.401 Vali Acc: 0.904 Test Loss: 0.401 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9684927463531494
Epoch: 28, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.374 Vali Acc: 0.922 Test Loss: 0.374 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8876736164093018
Epoch: 29, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.351 Vali Acc: 0.937 Test Loss: 0.351 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1042420864105225
Epoch: 30, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.334 Vali Acc: 0.941 Test Loss: 0.334 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8630313873291016
Epoch: 31, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.320 Vali Acc: 0.937 Test Loss: 0.320 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9854159355163574
Epoch: 32, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.311 Vali Acc: 0.941 Test Loss: 0.311 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9015421867370605
Epoch: 33, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1407222
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2363009452819824
Epoch: 1, Steps: 2 | Train Loss: 2.089 Vali Loss: 1.980 Vali Acc: 0.167 Test Loss: 1.980 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 1.0263214111328125
Epoch: 2, Steps: 2 | Train Loss: 2.014 Vali Loss: 1.930 Vali Acc: 0.219 Test Loss: 1.930 Test Acc: 0.219
Validation loss decreased (-0.166647 --> -0.218499).  Saving model ...
Epoch: 3 cost time: 0.9095690250396729
Epoch: 3, Steps: 2 | Train Loss: 1.995 Vali Loss: 1.871 Vali Acc: 0.319 Test Loss: 1.871 Test Acc: 0.319
Validation loss decreased (-0.218499 --> -0.318500).  Saving model ...
Epoch: 4 cost time: 0.9293076992034912
Epoch: 4, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.791 Vali Acc: 0.356 Test Loss: 1.791 Test Acc: 0.356
Validation loss decreased (-0.318500 --> -0.355538).  Saving model ...
Epoch: 5 cost time: 0.7674202919006348
Epoch: 5, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.718 Vali Acc: 0.415 Test Loss: 1.718 Test Acc: 0.415
Validation loss decreased (-0.355538 --> -0.414798).  Saving model ...
Epoch: 6 cost time: 0.8642280101776123
Epoch: 6, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.662 Vali Acc: 0.433 Test Loss: 1.662 Test Acc: 0.433
Validation loss decreased (-0.414798 --> -0.433317).  Saving model ...
Epoch: 7 cost time: 0.85833740234375
Epoch: 7, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.613 Vali Acc: 0.415 Test Loss: 1.613 Test Acc: 0.415
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.424764633178711
Epoch: 8, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.557 Vali Acc: 0.444 Test Loss: 1.557 Test Acc: 0.444
Validation loss decreased (-0.433317 --> -0.444429).  Saving model ...
Epoch: 9 cost time: 1.0045769214630127
Epoch: 9, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.490 Vali Acc: 0.530 Test Loss: 1.490 Test Acc: 0.530
Validation loss decreased (-0.444429 --> -0.529615).  Saving model ...
Epoch: 10 cost time: 0.7708923816680908
Epoch: 10, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.411 Vali Acc: 0.615 Test Loss: 1.411 Test Acc: 0.615
Validation loss decreased (-0.529615 --> -0.614801).  Saving model ...
Epoch: 11 cost time: 0.7338356971740723
Epoch: 11, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.326 Vali Acc: 0.696 Test Loss: 1.326 Test Acc: 0.696
Validation loss decreased (-0.614801 --> -0.696283).  Saving model ...
Epoch: 12 cost time: 0.6916704177856445
Epoch: 12, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.239 Vali Acc: 0.800 Test Loss: 1.239 Test Acc: 0.800
Validation loss decreased (-0.696283 --> -0.799988).  Saving model ...
Epoch: 13 cost time: 0.7864599227905273
Epoch: 13, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.154 Vali Acc: 0.833 Test Loss: 1.154 Test Acc: 0.833
Validation loss decreased (-0.799988 --> -0.833322).  Saving model ...
Epoch: 14 cost time: 0.7996931076049805
Epoch: 14, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.066 Vali Acc: 0.856 Test Loss: 1.066 Test Acc: 0.856
Validation loss decreased (-0.833322 --> -0.855545).  Saving model ...
Epoch: 15 cost time: 0.794680118560791
Epoch: 15, Steps: 2 | Train Loss: 0.977 Vali Loss: 0.977 Vali Acc: 0.867 Test Loss: 0.977 Test Acc: 0.867
Validation loss decreased (-0.855545 --> -0.866657).  Saving model ...
Epoch: 16 cost time: 0.9191408157348633
Epoch: 16, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.889 Vali Acc: 0.881 Test Loss: 0.889 Test Acc: 0.881
Validation loss decreased (-0.866657 --> -0.881473).  Saving model ...
Epoch: 17 cost time: 0.9262986183166504
Epoch: 17, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.809 Vali Acc: 0.881 Test Loss: 0.809 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881473).  Saving model ...
Epoch: 18 cost time: 0.7855181694030762
Epoch: 18, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.736 Vali Acc: 0.889 Test Loss: 0.736 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888882).  Saving model ...
Epoch: 19 cost time: 0.8650658130645752
Epoch: 19, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.668 Vali Acc: 0.904 Test Loss: 0.668 Test Acc: 0.904
Validation loss decreased (-0.888882 --> -0.903697).  Saving model ...
Epoch: 20 cost time: 0.8611111640930176
Epoch: 20, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.608 Vali Acc: 0.904 Test Loss: 0.608 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 21 cost time: 0.8092198371887207
Epoch: 21, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.551 Vali Acc: 0.941 Test Loss: 0.551 Test Acc: 0.941
Validation loss decreased (-0.903698 --> -0.940735).  Saving model ...
Epoch: 22 cost time: 0.7905361652374268
Epoch: 22, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.506 Vali Acc: 0.944 Test Loss: 0.506 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 23 cost time: 0.7201530933380127
Epoch: 23, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.468 Vali Acc: 0.948 Test Loss: 0.468 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 24 cost time: 0.8525629043579102
Epoch: 24, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.436 Vali Acc: 0.948 Test Loss: 0.436 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 25 cost time: 0.7744874954223633
Epoch: 25, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.411 Vali Acc: 0.944 Test Loss: 0.411 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8967900276184082
Epoch: 26, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.392 Vali Acc: 0.933 Test Loss: 0.392 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.740215539932251
Epoch: 27, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.379 Vali Acc: 0.926 Test Loss: 0.379 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9268693923950195
Epoch: 28, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.811840295791626
Epoch: 29, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.347 Vali Acc: 0.926 Test Loss: 0.347 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8405654430389404
Epoch: 30, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.331 Vali Acc: 0.937 Test Loss: 0.331 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.911811351776123
Epoch: 31, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.319 Vali Acc: 0.941 Test Loss: 0.319 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9058682918548584
Epoch: 32, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.310 Vali Acc: 0.941 Test Loss: 0.310 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7318449020385742
Epoch: 33, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.9477553367614746
Epoch: 34, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.302 Vali Acc: 0.937 Test Loss: 0.302 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 1406518
model size : 6.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8871841430664062
Epoch: 1, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.808 Vali Acc: 0.226 Test Loss: 1.808 Test Acc: 0.226
Validation loss decreased (inf --> -0.225908).  Saving model ...
Epoch: 2 cost time: 0.7858562469482422
Epoch: 2, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.778 Vali Acc: 0.226 Test Loss: 1.778 Test Acc: 0.226
Validation loss decreased (-0.225908 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.9145450592041016
Epoch: 3, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.731 Vali Acc: 0.237 Test Loss: 1.731 Test Acc: 0.237
Validation loss decreased (-0.225908 --> -0.237020).  Saving model ...
Epoch: 4 cost time: 0.9629454612731934
Epoch: 4, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.659 Vali Acc: 0.311 Test Loss: 1.659 Test Acc: 0.311
Validation loss decreased (-0.237020 --> -0.311095).  Saving model ...
Epoch: 5 cost time: 0.9064657688140869
Epoch: 5, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.587 Vali Acc: 0.563 Test Loss: 1.587 Test Acc: 0.563
Validation loss decreased (-0.311095 --> -0.562947).  Saving model ...
Epoch: 6 cost time: 0.958519458770752
Epoch: 6, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.522 Vali Acc: 0.585 Test Loss: 1.522 Test Acc: 0.585
Validation loss decreased (-0.562947 --> -0.585170).  Saving model ...
Epoch: 7 cost time: 0.9671354293823242
Epoch: 7, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.460 Vali Acc: 0.544 Test Loss: 1.460 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.980139970779419
Epoch: 8, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.396 Vali Acc: 0.556 Test Loss: 1.396 Test Acc: 0.556
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9944655895233154
Epoch: 9, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.320 Vali Acc: 0.626 Test Loss: 1.320 Test Acc: 0.626
Validation loss decreased (-0.585170 --> -0.625913).  Saving model ...
Epoch: 10 cost time: 0.8368299007415771
Epoch: 10, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.228 Vali Acc: 0.696 Test Loss: 1.228 Test Acc: 0.696
Validation loss decreased (-0.625913 --> -0.696284).  Saving model ...
Epoch: 11 cost time: 0.8553917407989502
Epoch: 11, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.130 Vali Acc: 0.811 Test Loss: 1.130 Test Acc: 0.811
Validation loss decreased (-0.696284 --> -0.811100).  Saving model ...
Epoch: 12 cost time: 0.8352079391479492
Epoch: 12, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.038 Vali Acc: 0.837 Test Loss: 1.038 Test Acc: 0.837
Validation loss decreased (-0.811100 --> -0.837027).  Saving model ...
Epoch: 13 cost time: 0.6490709781646729
Epoch: 13, Steps: 2 | Train Loss: 0.963 Vali Loss: 0.954 Vali Acc: 0.837 Test Loss: 0.954 Test Acc: 0.837
Validation loss decreased (-0.837027 --> -0.837027).  Saving model ...
Epoch: 14 cost time: 0.9963850975036621
Epoch: 14, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.878 Vali Acc: 0.837 Test Loss: 0.878 Test Acc: 0.837
Validation loss decreased (-0.837027 --> -0.837028).  Saving model ...
Epoch: 15 cost time: 0.7273070812225342
Epoch: 15, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.809 Vali Acc: 0.844 Test Loss: 0.809 Test Acc: 0.844
Validation loss decreased (-0.837028 --> -0.844436).  Saving model ...
Epoch: 16 cost time: 0.8271410465240479
Epoch: 16, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.743 Vali Acc: 0.870 Test Loss: 0.743 Test Acc: 0.870
Validation loss decreased (-0.844436 --> -0.870363).  Saving model ...
Epoch: 17 cost time: 0.7303426265716553
Epoch: 17, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.681 Vali Acc: 0.907 Test Loss: 0.681 Test Acc: 0.907
Validation loss decreased (-0.870363 --> -0.907401).  Saving model ...
Epoch: 18 cost time: 0.7854046821594238
Epoch: 18, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.627 Vali Acc: 0.907 Test Loss: 0.627 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 19 cost time: 0.7239153385162354
Epoch: 19, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.578 Vali Acc: 0.915 Test Loss: 0.578 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914809).  Saving model ...
Epoch: 20 cost time: 0.8296456336975098
Epoch: 20, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.534 Vali Acc: 0.922 Test Loss: 0.534 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 21 cost time: 0.8059697151184082
Epoch: 21, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.498 Vali Acc: 0.930 Test Loss: 0.498 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 22 cost time: 0.8202228546142578
Epoch: 22, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.467 Vali Acc: 0.919 Test Loss: 0.467 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8992469310760498
Epoch: 23, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.446 Vali Acc: 0.907 Test Loss: 0.446 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9251377582550049
Epoch: 24, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.427 Vali Acc: 0.893 Test Loss: 0.427 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8661608695983887
Epoch: 25, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.406 Vali Acc: 0.896 Test Loss: 0.406 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8705945014953613
Epoch: 26, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.379 Vali Acc: 0.911 Test Loss: 0.379 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8345046043395996
Epoch: 27, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.357 Vali Acc: 0.926 Test Loss: 0.357 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.826460599899292
Epoch: 28, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.341 Vali Acc: 0.926 Test Loss: 0.341 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7673444747924805
Epoch: 29, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.335 Vali Acc: 0.930 Test Loss: 0.335 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 30 cost time: 0.8707642555236816
Epoch: 30, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.325 Vali Acc: 0.930 Test Loss: 0.325 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 31 cost time: 0.6875464916229248
Epoch: 31, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 32 cost time: 0.7446188926696777
Epoch: 32, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.309 Vali Acc: 0.933 Test Loss: 0.309 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 33 cost time: 0.9297630786895752
Epoch: 33, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 34 cost time: 0.7902932167053223
Epoch: 34, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.297 Vali Acc: 0.937 Test Loss: 0.297 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 35 cost time: 0.882073163986206
Epoch: 35, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 36 cost time: 1.0046377182006836
Epoch: 36, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 37 cost time: 1.1325738430023193
Epoch: 37, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9357190132141113
Epoch: 38, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 39 cost time: 1.0178828239440918
Epoch: 39, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 0.7153160572052002
Epoch: 40, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8363962173461914
Epoch: 41, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9940667152404785
Epoch: 42, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8819313049316406
Epoch: 43, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8318192958831787
Epoch: 44, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.8617627620697021
Epoch: 45, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.7894742488861084
Epoch: 46, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.8249857425689697
Epoch: 47, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.8528077602386475
Epoch: 48, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0118975639343262
Epoch: 49, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7100849151611328
Epoch: 50, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7743377685546875
Epoch: 51, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.7194435596466064
Epoch: 52, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.8877429962158203
Epoch: 53, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.8568301200866699
Epoch: 54, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.8881986141204834
Epoch: 55, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.6966311931610107
Epoch: 56, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.9599993228912354
Epoch: 57, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 1405814
model size : 6.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7539989948272705
Epoch: 1, Steps: 2 | Train Loss: 1.945 Vali Loss: 1.968 Vali Acc: 0.170 Test Loss: 1.968 Test Acc: 0.170
Validation loss decreased (inf --> -0.170351).  Saving model ...
Epoch: 2 cost time: 0.929314136505127
Epoch: 2, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.922 Vali Acc: 0.174 Test Loss: 1.922 Test Acc: 0.174
Validation loss decreased (-0.170351 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 0.8440299034118652
Epoch: 3, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.876 Vali Acc: 0.200 Test Loss: 1.876 Test Acc: 0.200
Validation loss decreased (-0.174055 --> -0.199981).  Saving model ...
Epoch: 4 cost time: 0.7740139961242676
Epoch: 4, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.815 Vali Acc: 0.230 Test Loss: 1.815 Test Acc: 0.230
Validation loss decreased (-0.199981 --> -0.229611).  Saving model ...
Epoch: 5 cost time: 0.8313436508178711
Epoch: 5, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.757 Vali Acc: 0.281 Test Loss: 1.757 Test Acc: 0.281
Validation loss decreased (-0.229611 --> -0.281464).  Saving model ...
Epoch: 6 cost time: 0.9061136245727539
Epoch: 6, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.705 Vali Acc: 0.341 Test Loss: 1.705 Test Acc: 0.341
Validation loss decreased (-0.281464 --> -0.340724).  Saving model ...
Epoch: 7 cost time: 1.0374743938446045
Epoch: 7, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.657 Vali Acc: 0.378 Test Loss: 1.657 Test Acc: 0.378
Validation loss decreased (-0.340724 --> -0.377761).  Saving model ...
Epoch: 8 cost time: 0.9210038185119629
Epoch: 8, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.608 Vali Acc: 0.415 Test Loss: 1.608 Test Acc: 0.415
Validation loss decreased (-0.377761 --> -0.414799).  Saving model ...
Epoch: 9 cost time: 0.985205888748169
Epoch: 9, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.555 Vali Acc: 0.493 Test Loss: 1.555 Test Acc: 0.493
Validation loss decreased (-0.414799 --> -0.492577).  Saving model ...
Epoch: 10 cost time: 1.0166070461273193
Epoch: 10, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.498 Vali Acc: 0.581 Test Loss: 1.498 Test Acc: 0.581
Validation loss decreased (-0.492577 --> -0.581467).  Saving model ...
Epoch: 11 cost time: 0.8701977729797363
Epoch: 11, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.428 Vali Acc: 0.622 Test Loss: 1.428 Test Acc: 0.622
Validation loss decreased (-0.581467 --> -0.622208).  Saving model ...
Epoch: 12 cost time: 0.9693403244018555
Epoch: 12, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.352 Vali Acc: 0.659 Test Loss: 1.352 Test Acc: 0.659
Validation loss decreased (-0.622208 --> -0.659246).  Saving model ...
Epoch: 13 cost time: 0.8884975910186768
Epoch: 13, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.271 Vali Acc: 0.707 Test Loss: 1.271 Test Acc: 0.707
Validation loss decreased (-0.659246 --> -0.707395).  Saving model ...
Epoch: 14 cost time: 0.8456289768218994
Epoch: 14, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.189 Vali Acc: 0.744 Test Loss: 1.189 Test Acc: 0.744
Validation loss decreased (-0.707395 --> -0.744433).  Saving model ...
Epoch: 15 cost time: 0.8657057285308838
Epoch: 15, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.106 Vali Acc: 0.781 Test Loss: 1.106 Test Acc: 0.781
Validation loss decreased (-0.744433 --> -0.781470).  Saving model ...
Epoch: 16 cost time: 0.9820146560668945
Epoch: 16, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.027 Vali Acc: 0.830 Test Loss: 1.027 Test Acc: 0.830
Validation loss decreased (-0.781470 --> -0.829619).  Saving model ...
Epoch: 17 cost time: 1.2557272911071777
Epoch: 17, Steps: 2 | Train Loss: 0.946 Vali Loss: 0.951 Vali Acc: 0.863 Test Loss: 0.951 Test Acc: 0.863
Validation loss decreased (-0.829619 --> -0.862953).  Saving model ...
Epoch: 18 cost time: 1.0573663711547852
Epoch: 18, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.879 Vali Acc: 0.893 Test Loss: 0.879 Test Acc: 0.893
Validation loss decreased (-0.862953 --> -0.892584).  Saving model ...
Epoch: 19 cost time: 1.0085430145263672
Epoch: 19, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.813 Vali Acc: 0.889 Test Loss: 0.813 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.0327222347259521
Epoch: 20, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.752 Vali Acc: 0.907 Test Loss: 0.752 Test Acc: 0.907
Validation loss decreased (-0.892584 --> -0.907400).  Saving model ...
Epoch: 21 cost time: 0.8866796493530273
Epoch: 21, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.696 Vali Acc: 0.907 Test Loss: 0.696 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 22 cost time: 0.9448695182800293
Epoch: 22, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.644 Vali Acc: 0.907 Test Loss: 0.644 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 23 cost time: 0.8179349899291992
Epoch: 23, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.599 Vali Acc: 0.911 Test Loss: 0.599 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 24 cost time: 1.1945149898529053
Epoch: 24, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.556 Vali Acc: 0.911 Test Loss: 0.556 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 25 cost time: 1.020953893661499
Epoch: 25, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.518 Vali Acc: 0.915 Test Loss: 0.518 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 26 cost time: 0.9471845626831055
Epoch: 26, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.486 Vali Acc: 0.911 Test Loss: 0.486 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0170652866363525
Epoch: 27, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.453 Vali Acc: 0.919 Test Loss: 0.453 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 28 cost time: 0.7631425857543945
Epoch: 28, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.427 Vali Acc: 0.922 Test Loss: 0.427 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 29 cost time: 1.1446969509124756
Epoch: 29, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.405 Vali Acc: 0.926 Test Loss: 0.405 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 0.9867000579833984
Epoch: 30, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.394 Vali Acc: 0.919 Test Loss: 0.394 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.990729808807373
Epoch: 31, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.381 Vali Acc: 0.922 Test Loss: 0.381 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.90505051612854
Epoch: 32, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.371 Vali Acc: 0.907 Test Loss: 0.371 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0615363121032715
Epoch: 33, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.359 Vali Acc: 0.904 Test Loss: 0.359 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.0616421699523926
Epoch: 34, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.343 Vali Acc: 0.919 Test Loss: 0.343 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9252421855926514
Epoch: 35, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.322 Vali Acc: 0.933 Test Loss: 0.322 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 36 cost time: 1.012129545211792
Epoch: 36, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.307 Vali Acc: 0.937 Test Loss: 0.307 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 37 cost time: 0.8869807720184326
Epoch: 37, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.8268547058105469
Epoch: 38, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.8647372722625732
Epoch: 39, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.9945104122161865
Epoch: 40, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9485595226287842
Epoch: 41, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.140733242034912
Epoch: 42, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0458967685699463
Epoch: 43, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.8746602535247803
Epoch: 44, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.260 Vali Acc: 0.948 Test Loss: 0.260 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.8311352729797363
Epoch: 45, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 46 cost time: 0.7162549495697021
Epoch: 46, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.249 Vali Acc: 0.952 Test Loss: 0.249 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 47 cost time: 0.6350460052490234
Epoch: 47, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9129250049591064
Epoch: 48, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8410799503326416
Epoch: 49, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.7823801040649414
Epoch: 50, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0727484226226807
Epoch: 51, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 1.058006763458252
Epoch: 52, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.9063732624053955
Epoch: 53, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.8595278263092041
Epoch: 54, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.222 Vali Acc: 0.952 Test Loss: 0.222 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 55 cost time: 0.8435912132263184
Epoch: 55, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.219 Vali Acc: 0.948 Test Loss: 0.219 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8394813537597656
Epoch: 56, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.9384126663208008
Epoch: 57, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8659765720367432
Epoch: 58, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8705844879150391
Epoch: 59, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.8887064456939697
Epoch: 60, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.9819762706756592
Epoch: 61, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.796135663986206
Epoch: 62, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.8018641471862793
Epoch: 63, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.964942216873169
Epoch: 64, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 65 cost time: 0.9015319347381592
Epoch: 65, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8659155368804932
Epoch: 66, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.827650785446167
Epoch: 67, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.7743682861328125
Epoch: 68, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.9733297824859619
Epoch: 69, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.04129958152771
Epoch: 70, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.9917750358581543
Epoch: 71, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.840867280960083
Epoch: 72, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.7695748805999756
Epoch: 73, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.8265578746795654
Epoch: 74, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 945590
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.404486656188965
Epoch: 1, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.867 Vali Acc: 0.111 Test Loss: 1.867 Test Acc: 0.111
Validation loss decreased (inf --> -0.111092).  Saving model ...
Epoch: 2 cost time: 0.9769613742828369
Epoch: 2, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.852 Vali Acc: 0.119 Test Loss: 1.852 Test Acc: 0.119
Validation loss decreased (-0.111092 --> -0.118500).  Saving model ...
Epoch: 3 cost time: 1.1334807872772217
Epoch: 3, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.834 Vali Acc: 0.126 Test Loss: 1.834 Test Acc: 0.126
Validation loss decreased (-0.118500 --> -0.125908).  Saving model ...
Epoch: 4 cost time: 1.066054344177246
Epoch: 4, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.807 Vali Acc: 0.107 Test Loss: 1.807 Test Acc: 0.107
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8996949195861816
Epoch: 5, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.775 Vali Acc: 0.111 Test Loss: 1.775 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8286731243133545
Epoch: 6, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.739 Vali Acc: 0.144 Test Loss: 1.739 Test Acc: 0.144
Validation loss decreased (-0.125908 --> -0.144427).  Saving model ...
Epoch: 7 cost time: 0.9060389995574951
Epoch: 7, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.699 Vali Acc: 0.226 Test Loss: 1.699 Test Acc: 0.226
Validation loss decreased (-0.144427 --> -0.225909).  Saving model ...
Epoch: 8 cost time: 1.0188572406768799
Epoch: 8, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.655 Vali Acc: 0.352 Test Loss: 1.655 Test Acc: 0.352
Validation loss decreased (-0.225909 --> -0.351835).  Saving model ...
Epoch: 9 cost time: 0.854102373123169
Epoch: 9, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.606 Vali Acc: 0.433 Test Loss: 1.606 Test Acc: 0.433
Validation loss decreased (-0.351835 --> -0.433317).  Saving model ...
Epoch: 10 cost time: 0.7704269886016846
Epoch: 10, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.551 Vali Acc: 0.559 Test Loss: 1.551 Test Acc: 0.559
Validation loss decreased (-0.433317 --> -0.559244).  Saving model ...
Epoch: 11 cost time: 0.849226713180542
Epoch: 11, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.490 Vali Acc: 0.633 Test Loss: 1.490 Test Acc: 0.633
Validation loss decreased (-0.559244 --> -0.633318).  Saving model ...
Epoch: 12 cost time: 0.8142468929290771
Epoch: 12, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.426 Vali Acc: 0.670 Test Loss: 1.426 Test Acc: 0.670
Validation loss decreased (-0.633318 --> -0.670356).  Saving model ...
Epoch: 13 cost time: 0.8075556755065918
Epoch: 13, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.360 Vali Acc: 0.700 Test Loss: 1.360 Test Acc: 0.700
Validation loss decreased (-0.670356 --> -0.699986).  Saving model ...
Epoch: 14 cost time: 0.8997976779937744
Epoch: 14, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.290 Vali Acc: 0.763 Test Loss: 1.290 Test Acc: 0.763
Validation loss decreased (-0.699986 --> -0.762950).  Saving model ...
Epoch: 15 cost time: 0.9986062049865723
Epoch: 15, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.220 Vali Acc: 0.781 Test Loss: 1.220 Test Acc: 0.781
Validation loss decreased (-0.762950 --> -0.781469).  Saving model ...
Epoch: 16 cost time: 0.912602424621582
Epoch: 16, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.149 Vali Acc: 0.793 Test Loss: 1.149 Test Acc: 0.793
Validation loss decreased (-0.781469 --> -0.792581).  Saving model ...
Epoch: 17 cost time: 0.8515253067016602
Epoch: 17, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.077 Vali Acc: 0.819 Test Loss: 1.077 Test Acc: 0.819
Validation loss decreased (-0.792581 --> -0.818508).  Saving model ...
Epoch: 18 cost time: 1.0151934623718262
Epoch: 18, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.001 Vali Acc: 0.826 Test Loss: 1.001 Test Acc: 0.826
Validation loss decreased (-0.818508 --> -0.825916).  Saving model ...
Epoch: 19 cost time: 0.8300518989562988
Epoch: 19, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.927 Vali Acc: 0.833 Test Loss: 0.927 Test Acc: 0.833
Validation loss decreased (-0.825916 --> -0.833324).  Saving model ...
Epoch: 20 cost time: 0.8581583499908447
Epoch: 20, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.858 Vali Acc: 0.833 Test Loss: 0.858 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833325).  Saving model ...
Epoch: 21 cost time: 0.909477949142456
Epoch: 21, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.796 Vali Acc: 0.841 Test Loss: 0.796 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840733).  Saving model ...
Epoch: 22 cost time: 0.8090014457702637
Epoch: 22, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.742 Vali Acc: 0.841 Test Loss: 0.742 Test Acc: 0.841
Validation loss decreased (-0.840733 --> -0.840733).  Saving model ...
Epoch: 23 cost time: 0.9703998565673828
Epoch: 23, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.690 Vali Acc: 0.848 Test Loss: 0.690 Test Acc: 0.848
Validation loss decreased (-0.840733 --> -0.848141).  Saving model ...
Epoch: 24 cost time: 0.8790006637573242
Epoch: 24, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.642 Vali Acc: 0.863 Test Loss: 0.642 Test Acc: 0.863
Validation loss decreased (-0.848141 --> -0.862957).  Saving model ...
Epoch: 25 cost time: 0.8597514629364014
Epoch: 25, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.595 Vali Acc: 0.896 Test Loss: 0.595 Test Acc: 0.896
Validation loss decreased (-0.862957 --> -0.896290).  Saving model ...
Epoch: 26 cost time: 0.7285892963409424
Epoch: 26, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.554 Vali Acc: 0.915 Test Loss: 0.554 Test Acc: 0.915
Validation loss decreased (-0.896290 --> -0.914809).  Saving model ...
Epoch: 27 cost time: 0.8929600715637207
Epoch: 27, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.520 Vali Acc: 0.930 Test Loss: 0.520 Test Acc: 0.930
Validation loss decreased (-0.914809 --> -0.929624).  Saving model ...
Epoch: 28 cost time: 0.9105484485626221
Epoch: 28, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.487 Vali Acc: 0.919 Test Loss: 0.487 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9647376537322998
Epoch: 29, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.458 Vali Acc: 0.919 Test Loss: 0.458 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7901675701141357
Epoch: 30, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.435 Vali Acc: 0.922 Test Loss: 0.435 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8903191089630127
Epoch: 31, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.414 Vali Acc: 0.926 Test Loss: 0.414 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9734973907470703
Epoch: 32, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.399 Vali Acc: 0.930 Test Loss: 0.399 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929626).  Saving model ...
Epoch: 33 cost time: 0.8707172870635986
Epoch: 33, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.380 Vali Acc: 0.937 Test Loss: 0.380 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937033).  Saving model ...
Epoch: 34 cost time: 1.021470069885254
Epoch: 34, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.362 Vali Acc: 0.937 Test Loss: 0.362 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 35 cost time: 0.9178571701049805
Epoch: 35, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.345 Vali Acc: 0.941 Test Loss: 0.345 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 36 cost time: 0.8420181274414062
Epoch: 36, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.329 Vali Acc: 0.941 Test Loss: 0.329 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 37 cost time: 0.9195494651794434
Epoch: 37, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.317 Vali Acc: 0.948 Test Loss: 0.317 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 38 cost time: 0.999666690826416
Epoch: 38, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.305 Vali Acc: 0.952 Test Loss: 0.305 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.7361652851104736
Epoch: 39, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.296 Vali Acc: 0.956 Test Loss: 0.296 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 40 cost time: 1.0025739669799805
Epoch: 40, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.287 Vali Acc: 0.959 Test Loss: 0.287 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959256).  Saving model ...
Epoch: 41 cost time: 1.0449142456054688
Epoch: 41, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.282 Vali Acc: 0.959 Test Loss: 0.282 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 42 cost time: 0.8381333351135254
Epoch: 42, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.277 Vali Acc: 0.948 Test Loss: 0.277 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9989352226257324
Epoch: 43, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.272 Vali Acc: 0.948 Test Loss: 0.272 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.1064095497131348
Epoch: 44, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.266 Vali Acc: 0.948 Test Loss: 0.266 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9096407890319824
Epoch: 45, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.261 Vali Acc: 0.952 Test Loss: 0.261 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.0405306816101074
Epoch: 46, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.256 Vali Acc: 0.956 Test Loss: 0.256 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9378392696380615
Epoch: 47, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.252 Vali Acc: 0.956 Test Loss: 0.252 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.023331880569458
Epoch: 48, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.248 Vali Acc: 0.956 Test Loss: 0.248 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9037997722625732
Epoch: 49, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.02201509475708
Epoch: 50, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.240 Vali Acc: 0.956 Test Loss: 0.240 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.0058348178863525
Epoch: 51, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.236 Vali Acc: 0.956 Test Loss: 0.236 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 944886
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7091660499572754
Epoch: 1, Steps: 2 | Train Loss: 1.933 Vali Loss: 1.854 Vali Acc: 0.181 Test Loss: 1.854 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.9484841823577881
Epoch: 2, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.825 Vali Acc: 0.193 Test Loss: 1.825 Test Acc: 0.193
Validation loss decreased (-0.181463 --> -0.192574).  Saving model ...
Epoch: 3 cost time: 0.8636884689331055
Epoch: 3, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.797 Vali Acc: 0.219 Test Loss: 1.797 Test Acc: 0.219
Validation loss decreased (-0.192574 --> -0.218501).  Saving model ...
Epoch: 4 cost time: 0.7541236877441406
Epoch: 4, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.757 Vali Acc: 0.304 Test Loss: 1.757 Test Acc: 0.304
Validation loss decreased (-0.218501 --> -0.303686).  Saving model ...
Epoch: 5 cost time: 0.7810726165771484
Epoch: 5, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.712 Vali Acc: 0.356 Test Loss: 1.712 Test Acc: 0.356
Validation loss decreased (-0.303686 --> -0.355538).  Saving model ...
Epoch: 6 cost time: 0.8001351356506348
Epoch: 6, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.668 Vali Acc: 0.515 Test Loss: 1.668 Test Acc: 0.515
Validation loss decreased (-0.355538 --> -0.514798).  Saving model ...
Epoch: 7 cost time: 0.7906765937805176
Epoch: 7, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.628 Vali Acc: 0.515 Test Loss: 1.628 Test Acc: 0.515
Validation loss decreased (-0.514798 --> -0.514799).  Saving model ...
Epoch: 8 cost time: 0.9564719200134277
Epoch: 8, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.586 Vali Acc: 0.511 Test Loss: 1.586 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7701239585876465
Epoch: 9, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.541 Vali Acc: 0.526 Test Loss: 1.541 Test Acc: 0.526
Validation loss decreased (-0.514799 --> -0.525911).  Saving model ...
Epoch: 10 cost time: 0.841301441192627
Epoch: 10, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.491 Vali Acc: 0.559 Test Loss: 1.491 Test Acc: 0.559
Validation loss decreased (-0.525911 --> -0.559244).  Saving model ...
Epoch: 11 cost time: 0.850560188293457
Epoch: 11, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.431 Vali Acc: 0.596 Test Loss: 1.431 Test Acc: 0.596
Validation loss decreased (-0.559244 --> -0.596282).  Saving model ...
Epoch: 12 cost time: 0.7737815380096436
Epoch: 12, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.365 Vali Acc: 0.644 Test Loss: 1.365 Test Acc: 0.644
Validation loss decreased (-0.596282 --> -0.644431).  Saving model ...
Epoch: 13 cost time: 0.6761536598205566
Epoch: 13, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.294 Vali Acc: 0.681 Test Loss: 1.294 Test Acc: 0.681
Validation loss decreased (-0.644431 --> -0.681469).  Saving model ...
Epoch: 14 cost time: 1.1298911571502686
Epoch: 14, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.226 Vali Acc: 0.733 Test Loss: 1.226 Test Acc: 0.733
Validation loss decreased (-0.681469 --> -0.733321).  Saving model ...
Epoch: 15 cost time: 0.8018853664398193
Epoch: 15, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.157 Vali Acc: 0.770 Test Loss: 1.157 Test Acc: 0.770
Validation loss decreased (-0.733321 --> -0.770359).  Saving model ...
Epoch: 16 cost time: 0.7225558757781982
Epoch: 16, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.088 Vali Acc: 0.785 Test Loss: 1.088 Test Acc: 0.785
Validation loss decreased (-0.770359 --> -0.785174).  Saving model ...
Epoch: 17 cost time: 0.7367055416107178
Epoch: 17, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.018 Vali Acc: 0.819 Test Loss: 1.018 Test Acc: 0.819
Validation loss decreased (-0.785174 --> -0.818508).  Saving model ...
Epoch: 18 cost time: 0.893510103225708
Epoch: 18, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.952 Vali Acc: 0.807 Test Loss: 0.952 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.780853271484375
Epoch: 19, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.889 Vali Acc: 0.830 Test Loss: 0.889 Test Acc: 0.830
Validation loss decreased (-0.818508 --> -0.829621).  Saving model ...
Epoch: 20 cost time: 0.9855186939239502
Epoch: 20, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.825 Vali Acc: 0.852 Test Loss: 0.825 Test Acc: 0.852
Validation loss decreased (-0.829621 --> -0.851844).  Saving model ...
Epoch: 21 cost time: 1.0813159942626953
Epoch: 21, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.766 Vali Acc: 0.881 Test Loss: 0.766 Test Acc: 0.881
Validation loss decreased (-0.851844 --> -0.881474).  Saving model ...
Epoch: 22 cost time: 0.9673023223876953
Epoch: 22, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.711 Vali Acc: 0.896 Test Loss: 0.711 Test Acc: 0.896
Validation loss decreased (-0.881474 --> -0.896289).  Saving model ...
Epoch: 23 cost time: 0.653515100479126
Epoch: 23, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.662 Vali Acc: 0.900 Test Loss: 0.662 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 24 cost time: 0.695195198059082
Epoch: 24, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.619 Vali Acc: 0.911 Test Loss: 0.619 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.911105).  Saving model ...
Epoch: 25 cost time: 0.945350170135498
Epoch: 25, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.582 Vali Acc: 0.907 Test Loss: 0.582 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9845049381256104
Epoch: 26, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.549 Vali Acc: 0.907 Test Loss: 0.549 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9174222946166992
Epoch: 27, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.516 Vali Acc: 0.911 Test Loss: 0.516 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911106).  Saving model ...
Epoch: 28 cost time: 1.0527992248535156
Epoch: 28, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.491 Vali Acc: 0.907 Test Loss: 0.491 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7474086284637451
Epoch: 29, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.468 Vali Acc: 0.911 Test Loss: 0.468 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 30 cost time: 0.7953612804412842
Epoch: 30, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.448 Vali Acc: 0.911 Test Loss: 0.448 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 31 cost time: 0.9053044319152832
Epoch: 31, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.433 Vali Acc: 0.911 Test Loss: 0.433 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 32 cost time: 0.8390498161315918
Epoch: 32, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.410 Vali Acc: 0.915 Test Loss: 0.410 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 33 cost time: 0.9274425506591797
Epoch: 33, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.393 Vali Acc: 0.919 Test Loss: 0.393 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 34 cost time: 0.9337301254272461
Epoch: 34, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.376 Vali Acc: 0.922 Test Loss: 0.376 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922218).  Saving model ...
Epoch: 35 cost time: 0.9995481967926025
Epoch: 35, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.363 Vali Acc: 0.926 Test Loss: 0.363 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 36 cost time: 0.8457386493682861
Epoch: 36, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.355 Vali Acc: 0.926 Test Loss: 0.355 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 37 cost time: 0.826648473739624
Epoch: 37, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.350 Vali Acc: 0.911 Test Loss: 0.350 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9193847179412842
Epoch: 38, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.345 Vali Acc: 0.915 Test Loss: 0.345 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8528547286987305
Epoch: 39, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.344 Vali Acc: 0.919 Test Loss: 0.344 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.0020332336425781
Epoch: 40, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.351 Vali Acc: 0.915 Test Loss: 0.351 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7392656803131104
Epoch: 41, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.348 Vali Acc: 0.922 Test Loss: 0.348 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8011837005615234
Epoch: 42, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.340 Vali Acc: 0.922 Test Loss: 0.340 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7176666259765625
Epoch: 43, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.333 Vali Acc: 0.922 Test Loss: 0.333 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.1198756694793701
Epoch: 44, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.323 Vali Acc: 0.919 Test Loss: 0.323 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.824063777923584
Epoch: 45, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.314 Vali Acc: 0.919 Test Loss: 0.314 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7940840721130371
Epoch: 46, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.308 Vali Acc: 0.922 Test Loss: 0.308 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 944182
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6340572834014893
Epoch: 1, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.848 Vali Acc: 0.085 Test Loss: 1.848 Test Acc: 0.085
Validation loss decreased (inf --> -0.085167).  Saving model ...
Epoch: 2 cost time: 0.8195896148681641
Epoch: 2, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.826 Vali Acc: 0.070 Test Loss: 1.826 Test Acc: 0.070
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9747326374053955
Epoch: 3, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.803 Vali Acc: 0.074 Test Loss: 1.803 Test Acc: 0.074
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8088603019714355
Epoch: 4, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.769 Vali Acc: 0.096 Test Loss: 1.769 Test Acc: 0.096
Validation loss decreased (-0.085167 --> -0.096279).  Saving model ...
Epoch: 5 cost time: 0.6964507102966309
Epoch: 5, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.734 Vali Acc: 0.259 Test Loss: 1.734 Test Acc: 0.259
Validation loss decreased (-0.096279 --> -0.259242).  Saving model ...
Epoch: 6 cost time: 1.0975143909454346
Epoch: 6, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.697 Vali Acc: 0.370 Test Loss: 1.697 Test Acc: 0.370
Validation loss decreased (-0.259242 --> -0.370353).  Saving model ...
Epoch: 7 cost time: 0.6376454830169678
Epoch: 7, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.658 Vali Acc: 0.478 Test Loss: 1.658 Test Acc: 0.478
Validation loss decreased (-0.370353 --> -0.477761).  Saving model ...
Epoch: 8 cost time: 0.8536522388458252
Epoch: 8, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.619 Vali Acc: 0.548 Test Loss: 1.619 Test Acc: 0.548
Validation loss decreased (-0.477761 --> -0.548132).  Saving model ...
Epoch: 9 cost time: 0.8879928588867188
Epoch: 9, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.574 Vali Acc: 0.574 Test Loss: 1.574 Test Acc: 0.574
Validation loss decreased (-0.548132 --> -0.574058).  Saving model ...
Epoch: 10 cost time: 0.9319567680358887
Epoch: 10, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.526 Vali Acc: 0.596 Test Loss: 1.526 Test Acc: 0.596
Validation loss decreased (-0.574058 --> -0.596281).  Saving model ...
Epoch: 11 cost time: 0.9311349391937256
Epoch: 11, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.469 Vali Acc: 0.630 Test Loss: 1.469 Test Acc: 0.630
Validation loss decreased (-0.596281 --> -0.629615).  Saving model ...
Epoch: 12 cost time: 0.7852644920349121
Epoch: 12, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.406 Vali Acc: 0.644 Test Loss: 1.406 Test Acc: 0.644
Validation loss decreased (-0.629615 --> -0.644430).  Saving model ...
Epoch: 13 cost time: 0.8771100044250488
Epoch: 13, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.338 Vali Acc: 0.663 Test Loss: 1.338 Test Acc: 0.663
Validation loss decreased (-0.644430 --> -0.662950).  Saving model ...
Epoch: 14 cost time: 0.9693741798400879
Epoch: 14, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.268 Vali Acc: 0.689 Test Loss: 1.268 Test Acc: 0.689
Validation loss decreased (-0.662950 --> -0.688876).  Saving model ...
Epoch: 15 cost time: 0.8907480239868164
Epoch: 15, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.199 Vali Acc: 0.730 Test Loss: 1.199 Test Acc: 0.730
Validation loss decreased (-0.688876 --> -0.729618).  Saving model ...
Epoch: 16 cost time: 0.6933572292327881
Epoch: 16, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.131 Vali Acc: 0.756 Test Loss: 1.131 Test Acc: 0.756
Validation loss decreased (-0.729618 --> -0.755544).  Saving model ...
Epoch: 17 cost time: 0.9223461151123047
Epoch: 17, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.061 Vali Acc: 0.767 Test Loss: 1.061 Test Acc: 0.767
Validation loss decreased (-0.755544 --> -0.766656).  Saving model ...
Epoch: 18 cost time: 0.7400455474853516
Epoch: 18, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.992 Vali Acc: 0.793 Test Loss: 0.992 Test Acc: 0.793
Validation loss decreased (-0.766656 --> -0.792583).  Saving model ...
Epoch: 19 cost time: 0.7190659046173096
Epoch: 19, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.932 Vali Acc: 0.807 Test Loss: 0.932 Test Acc: 0.807
Validation loss decreased (-0.792583 --> -0.807398).  Saving model ...
Epoch: 20 cost time: 0.946721076965332
Epoch: 20, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.873 Vali Acc: 0.807 Test Loss: 0.873 Test Acc: 0.807
Validation loss decreased (-0.807398 --> -0.807399).  Saving model ...
Epoch: 21 cost time: 0.9539015293121338
Epoch: 21, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.816 Vali Acc: 0.811 Test Loss: 0.816 Test Acc: 0.811
Validation loss decreased (-0.807399 --> -0.811103).  Saving model ...
Epoch: 22 cost time: 0.885127067565918
Epoch: 22, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.761 Vali Acc: 0.822 Test Loss: 0.761 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 23 cost time: 1.0004487037658691
Epoch: 23, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.709 Vali Acc: 0.830 Test Loss: 0.709 Test Acc: 0.830
Validation loss decreased (-0.822215 --> -0.829623).  Saving model ...
Epoch: 24 cost time: 0.8917708396911621
Epoch: 24, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.663 Vali Acc: 0.844 Test Loss: 0.663 Test Acc: 0.844
Validation loss decreased (-0.829623 --> -0.844438).  Saving model ...
Epoch: 25 cost time: 0.7745077610015869
Epoch: 25, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866660).  Saving model ...
Epoch: 26 cost time: 0.8905839920043945
Epoch: 26, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.581 Vali Acc: 0.885 Test Loss: 0.581 Test Acc: 0.885
Validation loss decreased (-0.866660 --> -0.885179).  Saving model ...
Epoch: 27 cost time: 0.9108331203460693
Epoch: 27, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.551 Vali Acc: 0.896 Test Loss: 0.551 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896291).  Saving model ...
Epoch: 28 cost time: 0.8797731399536133
Epoch: 28, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.521 Vali Acc: 0.885 Test Loss: 0.521 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9446601867675781
Epoch: 29, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.501 Vali Acc: 0.867 Test Loss: 0.501 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9494175910949707
Epoch: 30, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.487 Vali Acc: 0.859 Test Loss: 0.487 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0250787734985352
Epoch: 31, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.467 Vali Acc: 0.863 Test Loss: 0.467 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9122765064239502
Epoch: 32, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.444 Vali Acc: 0.874 Test Loss: 0.444 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8638193607330322
Epoch: 33, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.423 Vali Acc: 0.885 Test Loss: 0.423 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9063115119934082
Epoch: 34, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899996).  Saving model ...
Epoch: 35 cost time: 0.8711872100830078
Epoch: 35, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.379 Vali Acc: 0.915 Test Loss: 0.379 Test Acc: 0.915
Validation loss decreased (-0.899996 --> -0.914811).  Saving model ...
Epoch: 36 cost time: 0.6835696697235107
Epoch: 36, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.365 Vali Acc: 0.919 Test Loss: 0.365 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 37 cost time: 0.7586748600006104
Epoch: 37, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.358 Vali Acc: 0.919 Test Loss: 0.358 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 38 cost time: 0.7224302291870117
Epoch: 38, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.355 Vali Acc: 0.919 Test Loss: 0.355 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 39 cost time: 0.9506351947784424
Epoch: 39, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.345 Vali Acc: 0.915 Test Loss: 0.345 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1688079833984375
Epoch: 40, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.338 Vali Acc: 0.915 Test Loss: 0.338 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8461523056030273
Epoch: 41, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.321 Vali Acc: 0.926 Test Loss: 0.321 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 42 cost time: 0.7893681526184082
Epoch: 42, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7854094505310059
Epoch: 43, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.312 Vali Acc: 0.915 Test Loss: 0.312 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.7500584125518799
Epoch: 44, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.307 Vali Acc: 0.915 Test Loss: 0.307 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.9272441864013672
Epoch: 45, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.303 Vali Acc: 0.915 Test Loss: 0.303 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8481478691101074
Epoch: 46, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.299 Vali Acc: 0.915 Test Loss: 0.299 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.821340799331665
Epoch: 47, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.294 Vali Acc: 0.915 Test Loss: 0.294 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9133033752441406
Epoch: 48, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.282 Vali Acc: 0.915 Test Loss: 0.282 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7971501350402832
Epoch: 49, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.278 Vali Acc: 0.919 Test Loss: 0.278 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.7421762943267822
Epoch: 50, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.281 Vali Acc: 0.915 Test Loss: 0.281 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.8697922229766846
Epoch: 51, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.287 Vali Acc: 0.915 Test Loss: 0.287 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 943478
model size : 4.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.324100971221924
Epoch: 1, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.802 Vali Acc: 0.148 Test Loss: 1.802 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.7722954750061035
Epoch: 2, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.785 Vali Acc: 0.148 Test Loss: 1.785 Test Acc: 0.148
Validation loss decreased (-0.148130 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 0.9048237800598145
Epoch: 3, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.768 Vali Acc: 0.174 Test Loss: 1.768 Test Acc: 0.174
Validation loss decreased (-0.148130 --> -0.174056).  Saving model ...
Epoch: 4 cost time: 1.096785068511963
Epoch: 4, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.741 Vali Acc: 0.193 Test Loss: 1.741 Test Acc: 0.193
Validation loss decreased (-0.174056 --> -0.192575).  Saving model ...
Epoch: 5 cost time: 0.8835780620574951
Epoch: 5, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.709 Vali Acc: 0.274 Test Loss: 1.709 Test Acc: 0.274
Validation loss decreased (-0.192575 --> -0.274057).  Saving model ...
Epoch: 6 cost time: 1.149834394454956
Epoch: 6, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.677 Vali Acc: 0.352 Test Loss: 1.677 Test Acc: 0.352
Validation loss decreased (-0.274057 --> -0.351835).  Saving model ...
Epoch: 7 cost time: 0.8165292739868164
Epoch: 7, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.642 Vali Acc: 0.404 Test Loss: 1.642 Test Acc: 0.404
Validation loss decreased (-0.351835 --> -0.403687).  Saving model ...
Epoch: 8 cost time: 0.8754198551177979
Epoch: 8, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.604 Vali Acc: 0.522 Test Loss: 1.604 Test Acc: 0.522
Validation loss decreased (-0.403687 --> -0.522206).  Saving model ...
Epoch: 9 cost time: 0.9028868675231934
Epoch: 9, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.564 Vali Acc: 0.604 Test Loss: 1.564 Test Acc: 0.604
Validation loss decreased (-0.522206 --> -0.603688).  Saving model ...
Epoch: 10 cost time: 1.0346612930297852
Epoch: 10, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.520 Vali Acc: 0.633 Test Loss: 1.520 Test Acc: 0.633
Validation loss decreased (-0.603688 --> -0.633318).  Saving model ...
Epoch: 11 cost time: 0.8702924251556396
Epoch: 11, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.471 Vali Acc: 0.700 Test Loss: 1.471 Test Acc: 0.700
Validation loss decreased (-0.633318 --> -0.699985).  Saving model ...
Epoch: 12 cost time: 0.9361083507537842
Epoch: 12, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.418 Vali Acc: 0.748 Test Loss: 1.418 Test Acc: 0.748
Validation loss decreased (-0.699985 --> -0.748134).  Saving model ...
Epoch: 13 cost time: 0.9070162773132324
Epoch: 13, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.361 Vali Acc: 0.804 Test Loss: 1.361 Test Acc: 0.804
Validation loss decreased (-0.748134 --> -0.803690).  Saving model ...
Epoch: 14 cost time: 0.8445281982421875
Epoch: 14, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.301 Vali Acc: 0.826 Test Loss: 1.301 Test Acc: 0.826
Validation loss decreased (-0.803690 --> -0.825913).  Saving model ...
Epoch: 15 cost time: 1.0159192085266113
Epoch: 15, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.241 Vali Acc: 0.841 Test Loss: 1.241 Test Acc: 0.841
Validation loss decreased (-0.825913 --> -0.840728).  Saving model ...
Epoch: 16 cost time: 0.7431607246398926
Epoch: 16, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.178 Vali Acc: 0.844 Test Loss: 1.178 Test Acc: 0.844
Validation loss decreased (-0.840728 --> -0.844433).  Saving model ...
Epoch: 17 cost time: 0.8772227764129639
Epoch: 17, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.113 Vali Acc: 0.859 Test Loss: 1.113 Test Acc: 0.859
Validation loss decreased (-0.844433 --> -0.859248).  Saving model ...
Epoch: 18 cost time: 0.7223758697509766
Epoch: 18, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.047 Vali Acc: 0.856 Test Loss: 1.047 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8859765529632568
Epoch: 19, Steps: 2 | Train Loss: 0.985 Vali Loss: 0.982 Vali Acc: 0.856 Test Loss: 0.982 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7971975803375244
Epoch: 20, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.918 Vali Acc: 0.863 Test Loss: 0.918 Test Acc: 0.863
Validation loss decreased (-0.859248 --> -0.862954).  Saving model ...
Epoch: 21 cost time: 1.0145070552825928
Epoch: 21, Steps: 2 | Train Loss: 0.925 Vali Loss: 0.856 Vali Acc: 0.859 Test Loss: 0.856 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9548707008361816
Epoch: 22, Steps: 2 | Train Loss: 0.742 Vali Loss: 0.795 Vali Acc: 0.870 Test Loss: 0.795 Test Acc: 0.870
Validation loss decreased (-0.862954 --> -0.870362).  Saving model ...
Epoch: 23 cost time: 0.880859375
Epoch: 23, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.741 Vali Acc: 0.874 Test Loss: 0.741 Test Acc: 0.874
Validation loss decreased (-0.870362 --> -0.874067).  Saving model ...
Epoch: 24 cost time: 0.8310258388519287
Epoch: 24, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.688 Vali Acc: 0.893 Test Loss: 0.688 Test Acc: 0.893
Validation loss decreased (-0.874067 --> -0.892586).  Saving model ...
Epoch: 25 cost time: 0.7834222316741943
Epoch: 25, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.640 Vali Acc: 0.896 Test Loss: 0.640 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 26 cost time: 0.7940020561218262
Epoch: 26, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.595 Vali Acc: 0.896 Test Loss: 0.595 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 27 cost time: 0.9331405162811279
Epoch: 27, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.8320372104644775
Epoch: 28, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.522 Vali Acc: 0.900 Test Loss: 0.522 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 29 cost time: 0.8585107326507568
Epoch: 29, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.491 Vali Acc: 0.904 Test Loss: 0.491 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 30 cost time: 1.0008761882781982
Epoch: 30, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.465 Vali Acc: 0.907 Test Loss: 0.465 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 31 cost time: 0.6961638927459717
Epoch: 31, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.440 Vali Acc: 0.911 Test Loss: 0.440 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 32 cost time: 0.8986458778381348
Epoch: 32, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.420 Vali Acc: 0.915 Test Loss: 0.420 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 33 cost time: 0.781456470489502
Epoch: 33, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.406 Vali Acc: 0.915 Test Loss: 0.406 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 34 cost time: 0.7255244255065918
Epoch: 34, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.392 Vali Acc: 0.896 Test Loss: 0.392 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8817269802093506
Epoch: 35, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.375 Vali Acc: 0.904 Test Loss: 0.375 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8188316822052002
Epoch: 36, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7968392372131348
Epoch: 37, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.345 Vali Acc: 0.922 Test Loss: 0.345 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 38 cost time: 0.7444400787353516
Epoch: 38, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.329 Vali Acc: 0.930 Test Loss: 0.329 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929626).  Saving model ...
Epoch: 39 cost time: 0.772784948348999
Epoch: 39, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.316 Vali Acc: 0.933 Test Loss: 0.316 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 40 cost time: 1.0051450729370117
Epoch: 40, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 41 cost time: 0.8686568737030029
Epoch: 41, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8685896396636963
Epoch: 42, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.298 Vali Acc: 0.930 Test Loss: 0.298 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8557310104370117
Epoch: 43, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.292 Vali Acc: 0.926 Test Loss: 0.292 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8006916046142578
Epoch: 44, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.285 Vali Acc: 0.926 Test Loss: 0.285 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.9794859886169434
Epoch: 45, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7704167366027832
Epoch: 46, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8869993686676025
Epoch: 47, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.9599101543426514
Epoch: 48, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.8434367179870605
Epoch: 49, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.203902006149292
Epoch: 50, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 51 cost time: 0.885784387588501
Epoch: 51, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 52 cost time: 1.0238173007965088
Epoch: 52, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 53 cost time: 0.8482518196105957
Epoch: 53, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 1.019683599472046
Epoch: 54, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 1.1395695209503174
Epoch: 55, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.9409778118133545
Epoch: 56, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.7332003116607666
Epoch: 57, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.7392709255218506
Epoch: 58, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 1.0058860778808594
Epoch: 59, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9018995761871338
Epoch: 60, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.8482522964477539
Epoch: 61, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.917839765548706
Epoch: 62, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.8239173889160156
Epoch: 63, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8267123699188232
Epoch: 64, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.7642579078674316
Epoch: 65, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.91107177734375
Epoch: 66, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.9300363063812256
Epoch: 67, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 714422
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8314499855041504
Epoch: 1, Steps: 2 | Train Loss: 2.003 Vali Loss: 1.943 Vali Acc: 0.152 Test Loss: 1.943 Test Acc: 0.152
Validation loss decreased (inf --> -0.151832).  Saving model ...
Epoch: 2 cost time: 0.9273014068603516
Epoch: 2, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.908 Vali Acc: 0.152 Test Loss: 1.908 Test Acc: 0.152
Validation loss decreased (-0.151832 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 1.092339277267456
Epoch: 3, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.876 Vali Acc: 0.152 Test Loss: 1.876 Test Acc: 0.152
Validation loss decreased (-0.151833 --> -0.151833).  Saving model ...
Epoch: 4 cost time: 0.8954532146453857
Epoch: 4, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.835 Vali Acc: 0.156 Test Loss: 1.835 Test Acc: 0.156
Validation loss decreased (-0.151833 --> -0.155537).  Saving model ...
Epoch: 5 cost time: 0.9673576354980469
Epoch: 5, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.789 Vali Acc: 0.159 Test Loss: 1.789 Test Acc: 0.159
Validation loss decreased (-0.155537 --> -0.159241).  Saving model ...
Epoch: 6 cost time: 0.8332715034484863
Epoch: 6, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.745 Vali Acc: 0.181 Test Loss: 1.745 Test Acc: 0.181
Validation loss decreased (-0.159241 --> -0.181464).  Saving model ...
Epoch: 7 cost time: 0.7328071594238281
Epoch: 7, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.701 Vali Acc: 0.267 Test Loss: 1.701 Test Acc: 0.267
Validation loss decreased (-0.181464 --> -0.266650).  Saving model ...
Epoch: 8 cost time: 1.0574169158935547
Epoch: 8, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.662 Vali Acc: 0.411 Test Loss: 1.662 Test Acc: 0.411
Validation loss decreased (-0.266650 --> -0.411094).  Saving model ...
Epoch: 9 cost time: 0.7336845397949219
Epoch: 9, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.625 Vali Acc: 0.422 Test Loss: 1.625 Test Acc: 0.422
Validation loss decreased (-0.411094 --> -0.422206).  Saving model ...
Epoch: 10 cost time: 1.0291743278503418
Epoch: 10, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.585 Vali Acc: 0.481 Test Loss: 1.585 Test Acc: 0.481
Validation loss decreased (-0.422206 --> -0.481466).  Saving model ...
Epoch: 11 cost time: 0.9238467216491699
Epoch: 11, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.541 Vali Acc: 0.556 Test Loss: 1.541 Test Acc: 0.556
Validation loss decreased (-0.481466 --> -0.555540).  Saving model ...
Epoch: 12 cost time: 0.7640829086303711
Epoch: 12, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.491 Vali Acc: 0.611 Test Loss: 1.491 Test Acc: 0.611
Validation loss decreased (-0.555540 --> -0.611096).  Saving model ...
Epoch: 13 cost time: 0.8053956031799316
Epoch: 13, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.438 Vali Acc: 0.615 Test Loss: 1.438 Test Acc: 0.615
Validation loss decreased (-0.611096 --> -0.614800).  Saving model ...
Epoch: 14 cost time: 0.8297934532165527
Epoch: 14, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.381 Vali Acc: 0.604 Test Loss: 1.381 Test Acc: 0.604
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0327696800231934
Epoch: 15, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.325 Vali Acc: 0.630 Test Loss: 1.325 Test Acc: 0.630
Validation loss decreased (-0.614800 --> -0.629616).  Saving model ...
Epoch: 16 cost time: 1.048635721206665
Epoch: 16, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.269 Vali Acc: 0.685 Test Loss: 1.269 Test Acc: 0.685
Validation loss decreased (-0.629616 --> -0.685172).  Saving model ...
Epoch: 17 cost time: 0.8932585716247559
Epoch: 17, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.217 Vali Acc: 0.681 Test Loss: 1.217 Test Acc: 0.681
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.957988977432251
Epoch: 18, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.160 Vali Acc: 0.719 Test Loss: 1.160 Test Acc: 0.719
Validation loss decreased (-0.685172 --> -0.718507).  Saving model ...
Epoch: 19 cost time: 0.8778111934661865
Epoch: 19, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.102 Vali Acc: 0.741 Test Loss: 1.102 Test Acc: 0.741
Validation loss decreased (-0.718507 --> -0.740730).  Saving model ...
Epoch: 20 cost time: 0.9062762260437012
Epoch: 20, Steps: 2 | Train Loss: 0.977 Vali Loss: 1.041 Vali Acc: 0.759 Test Loss: 1.041 Test Acc: 0.759
Validation loss decreased (-0.740730 --> -0.759249).  Saving model ...
Epoch: 21 cost time: 1.1192450523376465
Epoch: 21, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.982 Vali Acc: 0.778 Test Loss: 0.982 Test Acc: 0.778
Validation loss decreased (-0.759249 --> -0.777768).  Saving model ...
Epoch: 22 cost time: 0.8852508068084717
Epoch: 22, Steps: 2 | Train Loss: 0.962 Vali Loss: 0.923 Vali Acc: 0.804 Test Loss: 0.923 Test Acc: 0.804
Validation loss decreased (-0.777768 --> -0.803694).  Saving model ...
Epoch: 23 cost time: 1.0079185962677002
Epoch: 23, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.865 Vali Acc: 0.830 Test Loss: 0.865 Test Acc: 0.830
Validation loss decreased (-0.803694 --> -0.829621).  Saving model ...
Epoch: 24 cost time: 0.8406682014465332
Epoch: 24, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.810 Vali Acc: 0.852 Test Loss: 0.810 Test Acc: 0.852
Validation loss decreased (-0.829621 --> -0.851844).  Saving model ...
Epoch: 25 cost time: 0.7791283130645752
Epoch: 25, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.759 Vali Acc: 0.863 Test Loss: 0.759 Test Acc: 0.863
Validation loss decreased (-0.851844 --> -0.862955).  Saving model ...
Epoch: 26 cost time: 0.8468601703643799
Epoch: 26, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.711 Vali Acc: 0.870 Test Loss: 0.711 Test Acc: 0.870
Validation loss decreased (-0.862955 --> -0.870363).  Saving model ...
Epoch: 27 cost time: 0.8480050563812256
Epoch: 27, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.669 Vali Acc: 0.878 Test Loss: 0.669 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 28 cost time: 1.2272255420684814
Epoch: 28, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.631 Vali Acc: 0.870 Test Loss: 0.631 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1309864521026611
Epoch: 29, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.598 Vali Acc: 0.863 Test Loss: 0.598 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1008777618408203
Epoch: 30, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9049468040466309
Epoch: 31, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.534 Vali Acc: 0.867 Test Loss: 0.534 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9790353775024414
Epoch: 32, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.504 Vali Acc: 0.881 Test Loss: 0.504 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881476).  Saving model ...
Epoch: 33 cost time: 1.444303035736084
Epoch: 33, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
Validation loss decreased (-0.881476 --> -0.899995).  Saving model ...
Epoch: 34 cost time: 0.8192081451416016
Epoch: 34, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.454 Vali Acc: 0.904 Test Loss: 0.454 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 35 cost time: 0.8161239624023438
Epoch: 35, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.429 Vali Acc: 0.911 Test Loss: 0.429 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911107).  Saving model ...
Epoch: 36 cost time: 0.9869451522827148
Epoch: 36, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.406 Vali Acc: 0.915 Test Loss: 0.406 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 37 cost time: 0.980586051940918
Epoch: 37, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.386 Vali Acc: 0.930 Test Loss: 0.386 Test Acc: 0.930
Validation loss decreased (-0.914811 --> -0.929626).  Saving model ...
Epoch: 38 cost time: 0.9743320941925049
Epoch: 38, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.372 Vali Acc: 0.930 Test Loss: 0.372 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 39 cost time: 0.9284613132476807
Epoch: 39, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.363 Vali Acc: 0.915 Test Loss: 0.363 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7473371028900146
Epoch: 40, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.356 Vali Acc: 0.915 Test Loss: 0.356 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.8681185245513916
Epoch: 41, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.354 Vali Acc: 0.911 Test Loss: 0.354 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7561986446380615
Epoch: 42, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.342 Vali Acc: 0.915 Test Loss: 0.342 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.9997780323028564
Epoch: 43, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.330 Vali Acc: 0.919 Test Loss: 0.330 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.8282268047332764
Epoch: 44, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.317 Vali Acc: 0.922 Test Loss: 0.317 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7803878784179688
Epoch: 45, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 46 cost time: 0.8925752639770508
Epoch: 46, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 47 cost time: 0.9002888202667236
Epoch: 47, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 48 cost time: 0.8020675182342529
Epoch: 48, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 1.0394625663757324
Epoch: 49, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.281 Vali Acc: 0.926 Test Loss: 0.281 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.9706122875213623
Epoch: 50, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7964375019073486
Epoch: 51, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.8378889560699463
Epoch: 52, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.282 Vali Acc: 0.926 Test Loss: 0.282 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.9127857685089111
Epoch: 53, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 54 cost time: 0.9188718795776367
Epoch: 54, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 55 cost time: 0.8967127799987793
Epoch: 55, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 56 cost time: 1.0451455116271973
Epoch: 56, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.262 Vali Acc: 0.937 Test Loss: 0.262 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 57 cost time: 1.0340912342071533
Epoch: 57, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 58 cost time: 0.8032267093658447
Epoch: 58, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 59 cost time: 0.6728732585906982
Epoch: 59, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 60 cost time: 0.9005558490753174
Epoch: 60, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 61 cost time: 0.9733631610870361
Epoch: 61, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 62 cost time: 1.0427544116973877
Epoch: 62, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 63 cost time: 0.9867401123046875
Epoch: 63, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.9280350208282471
Epoch: 64, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9346389770507812
Epoch: 65, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.9447126388549805
Epoch: 66, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.8714079856872559
Epoch: 67, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.255 Vali Acc: 0.915 Test Loss: 0.255 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.9745678901672363
Epoch: 68, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 1.0888166427612305
Epoch: 69, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.9772968292236328
Epoch: 70, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.8621125221252441
Epoch: 71, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.8446731567382812
Epoch: 72, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 713718
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.519105911254883
Epoch: 1, Steps: 2 | Train Loss: 1.959 Vali Loss: 1.938 Vali Acc: 0.133 Test Loss: 1.938 Test Acc: 0.133
Validation loss decreased (inf --> -0.133314).  Saving model ...
Epoch: 2 cost time: 1.3969249725341797
Epoch: 2, Steps: 2 | Train Loss: 1.961 Vali Loss: 1.904 Vali Acc: 0.111 Test Loss: 1.904 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8837325572967529
Epoch: 3, Steps: 2 | Train Loss: 2.024 Vali Loss: 1.874 Vali Acc: 0.107 Test Loss: 1.874 Test Acc: 0.107
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.965094804763794
Epoch: 4, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.831 Vali Acc: 0.148 Test Loss: 1.831 Test Acc: 0.148
Validation loss decreased (-0.133314 --> -0.148130).  Saving model ...
Epoch: 5 cost time: 0.7500209808349609
Epoch: 5, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.783 Vali Acc: 0.215 Test Loss: 1.783 Test Acc: 0.215
Validation loss decreased (-0.148130 --> -0.214797).  Saving model ...
Epoch: 6 cost time: 0.71478271484375
Epoch: 6, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.738 Vali Acc: 0.289 Test Loss: 1.738 Test Acc: 0.289
Validation loss decreased (-0.214797 --> -0.288872).  Saving model ...
Epoch: 7 cost time: 1.1567842960357666
Epoch: 7, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.698 Vali Acc: 0.359 Test Loss: 1.698 Test Acc: 0.359
Validation loss decreased (-0.288872 --> -0.359242).  Saving model ...
Epoch: 8 cost time: 0.8613266944885254
Epoch: 8, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.660 Vali Acc: 0.426 Test Loss: 1.660 Test Acc: 0.426
Validation loss decreased (-0.359242 --> -0.425909).  Saving model ...
Epoch: 9 cost time: 0.978508472442627
Epoch: 9, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.622 Vali Acc: 0.522 Test Loss: 1.622 Test Acc: 0.522
Validation loss decreased (-0.425909 --> -0.522206).  Saving model ...
Epoch: 10 cost time: 0.7792210578918457
Epoch: 10, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.583 Vali Acc: 0.541 Test Loss: 1.583 Test Acc: 0.541
Validation loss decreased (-0.522206 --> -0.540725).  Saving model ...
Epoch: 11 cost time: 0.8168745040893555
Epoch: 11, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.536 Vali Acc: 0.593 Test Loss: 1.536 Test Acc: 0.593
Validation loss decreased (-0.540725 --> -0.592577).  Saving model ...
Epoch: 12 cost time: 0.6688134670257568
Epoch: 12, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.481 Vali Acc: 0.663 Test Loss: 1.481 Test Acc: 0.663
Validation loss decreased (-0.592577 --> -0.662948).  Saving model ...
Epoch: 13 cost time: 0.8165442943572998
Epoch: 13, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.424 Vali Acc: 0.711 Test Loss: 1.424 Test Acc: 0.711
Validation loss decreased (-0.662948 --> -0.711097).  Saving model ...
Epoch: 14 cost time: 0.8870177268981934
Epoch: 14, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.361 Vali Acc: 0.770 Test Loss: 1.361 Test Acc: 0.770
Validation loss decreased (-0.711097 --> -0.770357).  Saving model ...
Epoch: 15 cost time: 0.8944106101989746
Epoch: 15, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.297 Vali Acc: 0.826 Test Loss: 1.297 Test Acc: 0.826
Validation loss decreased (-0.770357 --> -0.825913).  Saving model ...
Epoch: 16 cost time: 1.000899314880371
Epoch: 16, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.231 Vali Acc: 0.856 Test Loss: 1.231 Test Acc: 0.856
Validation loss decreased (-0.825913 --> -0.855543).  Saving model ...
Epoch: 17 cost time: 1.134876012802124
Epoch: 17, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.163 Vali Acc: 0.863 Test Loss: 1.163 Test Acc: 0.863
Validation loss decreased (-0.855543 --> -0.862951).  Saving model ...
Epoch: 18 cost time: 1.1619689464569092
Epoch: 18, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.094 Vali Acc: 0.874 Test Loss: 1.094 Test Acc: 0.874
Validation loss decreased (-0.862951 --> -0.874063).  Saving model ...
Epoch: 19 cost time: 0.9591100215911865
Epoch: 19, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.024 Vali Acc: 0.878 Test Loss: 1.024 Test Acc: 0.878
Validation loss decreased (-0.874063 --> -0.877768).  Saving model ...
Epoch: 20 cost time: 0.8430113792419434
Epoch: 20, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.956 Vali Acc: 0.878 Test Loss: 0.956 Test Acc: 0.878
Validation loss decreased (-0.877768 --> -0.877768).  Saving model ...
Epoch: 21 cost time: 1.0281877517700195
Epoch: 21, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.890 Vali Acc: 0.874 Test Loss: 0.890 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9281067848205566
Epoch: 22, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.831 Vali Acc: 0.878 Test Loss: 0.831 Test Acc: 0.878
Validation loss decreased (-0.877768 --> -0.877769).  Saving model ...
Epoch: 23 cost time: 0.773292064666748
Epoch: 23, Steps: 2 | Train Loss: 0.716 Vali Loss: 0.773 Vali Acc: 0.878 Test Loss: 0.773 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877770).  Saving model ...
Epoch: 24 cost time: 0.7555513381958008
Epoch: 24, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.719 Vali Acc: 0.878 Test Loss: 0.719 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877771).  Saving model ...
Epoch: 25 cost time: 0.8195970058441162
Epoch: 25, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.670 Vali Acc: 0.885 Test Loss: 0.670 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885178).  Saving model ...
Epoch: 26 cost time: 0.7384870052337646
Epoch: 26, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.625 Vali Acc: 0.889 Test Loss: 0.625 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888883).  Saving model ...
Epoch: 27 cost time: 0.8166861534118652
Epoch: 27, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.584 Vali Acc: 0.889 Test Loss: 0.584 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 28 cost time: 1.0161840915679932
Epoch: 28, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.550 Vali Acc: 0.893 Test Loss: 0.550 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 29 cost time: 0.831167459487915
Epoch: 29, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.516 Vali Acc: 0.896 Test Loss: 0.516 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 30 cost time: 0.7886643409729004
Epoch: 30, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.488 Vali Acc: 0.885 Test Loss: 0.488 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9453084468841553
Epoch: 31, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.9736042022705078
Epoch: 32, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.428 Vali Acc: 0.896 Test Loss: 0.428 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 33 cost time: 0.7953317165374756
Epoch: 33, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.410 Vali Acc: 0.904 Test Loss: 0.410 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903700).  Saving model ...
Epoch: 34 cost time: 0.8933277130126953
Epoch: 34, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.398 Vali Acc: 0.896 Test Loss: 0.398 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8816885948181152
Epoch: 35, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.391 Vali Acc: 0.885 Test Loss: 0.391 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.1863698959350586
Epoch: 36, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.378 Vali Acc: 0.889 Test Loss: 0.378 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.1612794399261475
Epoch: 37, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.370 Vali Acc: 0.893 Test Loss: 0.370 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8118190765380859
Epoch: 38, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.363 Vali Acc: 0.896 Test Loss: 0.363 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8705308437347412
Epoch: 39, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.350 Vali Acc: 0.900 Test Loss: 0.350 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.948326587677002
Epoch: 40, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.337 Vali Acc: 0.904 Test Loss: 0.337 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 41 cost time: 0.9181902408599854
Epoch: 41, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.327 Vali Acc: 0.907 Test Loss: 0.327 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 42 cost time: 0.8198893070220947
Epoch: 42, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.319 Vali Acc: 0.907 Test Loss: 0.319 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 43 cost time: 1.0468976497650146
Epoch: 43, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.316 Vali Acc: 0.907 Test Loss: 0.316 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 44 cost time: 1.0669026374816895
Epoch: 44, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.315 Vali Acc: 0.907 Test Loss: 0.315 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 45 cost time: 1.0075078010559082
Epoch: 45, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.318 Vali Acc: 0.904 Test Loss: 0.318 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7615475654602051
Epoch: 46, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.319 Vali Acc: 0.907 Test Loss: 0.319 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8790249824523926
Epoch: 47, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.313 Vali Acc: 0.907 Test Loss: 0.313 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 48 cost time: 0.84259033203125
Epoch: 48, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 49 cost time: 0.9109532833099365
Epoch: 49, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 50 cost time: 1.0204808712005615
Epoch: 50, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.266 Vali Acc: 0.922 Test Loss: 0.266 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 51 cost time: 0.8577694892883301
Epoch: 51, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 52 cost time: 0.8140077590942383
Epoch: 52, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 53 cost time: 0.7089931964874268
Epoch: 53, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.275 Vali Acc: 0.919 Test Loss: 0.275 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8737914562225342
Epoch: 54, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.289 Vali Acc: 0.919 Test Loss: 0.289 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.79595947265625
Epoch: 55, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9384350776672363
Epoch: 56, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.8550164699554443
Epoch: 57, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.7230238914489746
Epoch: 58, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.264 Vali Acc: 0.926 Test Loss: 0.264 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 59 cost time: 0.8718388080596924
Epoch: 59, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.263 Vali Acc: 0.926 Test Loss: 0.263 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 60 cost time: 0.885502815246582
Epoch: 60, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.264 Vali Acc: 0.926 Test Loss: 0.264 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9435446262359619
Epoch: 61, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.270 Vali Acc: 0.919 Test Loss: 0.270 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9902698993682861
Epoch: 62, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8232138156890869
Epoch: 63, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.275 Vali Acc: 0.922 Test Loss: 0.275 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.830059289932251
Epoch: 64, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.7431211471557617
Epoch: 65, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.263 Vali Acc: 0.926 Test Loss: 0.263 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 66 cost time: 1.0326285362243652
Epoch: 66, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 67 cost time: 1.0225856304168701
Epoch: 67, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 68 cost time: 0.8466842174530029
Epoch: 68, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.248 Vali Acc: 0.919 Test Loss: 0.248 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.9416096210479736
Epoch: 69, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.6811761856079102
Epoch: 70, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.253 Vali Acc: 0.915 Test Loss: 0.253 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.8248896598815918
Epoch: 71, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.257 Vali Acc: 0.915 Test Loss: 0.257 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.9816629886627197
Epoch: 72, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.258 Vali Acc: 0.919 Test Loss: 0.258 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.8884150981903076
Epoch: 73, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.261 Vali Acc: 0.919 Test Loss: 0.261 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 1.0821309089660645
Epoch: 74, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.267 Vali Acc: 0.919 Test Loss: 0.267 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.7346062660217285
Epoch: 75, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.8886265754699707
Epoch: 76, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.270 Vali Acc: 0.919 Test Loss: 0.270 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.8890688419342041
Epoch: 77, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 713014
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6499433517456055
Epoch: 1, Steps: 2 | Train Loss: 2.067 Vali Loss: 2.003 Vali Acc: 0.170 Test Loss: 2.003 Test Acc: 0.170
Validation loss decreased (inf --> -0.170350).  Saving model ...
Epoch: 2 cost time: 1.0280296802520752
Epoch: 2, Steps: 2 | Train Loss: 2.060 Vali Loss: 1.954 Vali Acc: 0.174 Test Loss: 1.954 Test Acc: 0.174
Validation loss decreased (-0.170350 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 0.8303976058959961
Epoch: 3, Steps: 2 | Train Loss: 2.025 Vali Loss: 1.910 Vali Acc: 0.181 Test Loss: 1.910 Test Acc: 0.181
Validation loss decreased (-0.174055 --> -0.181462).  Saving model ...
Epoch: 4 cost time: 1.093604564666748
Epoch: 4, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.855 Vali Acc: 0.211 Test Loss: 1.855 Test Acc: 0.211
Validation loss decreased (-0.181462 --> -0.211093).  Saving model ...
Epoch: 5 cost time: 0.9741785526275635
Epoch: 5, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.799 Vali Acc: 0.285 Test Loss: 1.799 Test Acc: 0.285
Validation loss decreased (-0.211093 --> -0.285167).  Saving model ...
Epoch: 6 cost time: 0.894517183303833
Epoch: 6, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.750 Vali Acc: 0.367 Test Loss: 1.750 Test Acc: 0.367
Validation loss decreased (-0.285167 --> -0.366649).  Saving model ...
Epoch: 7 cost time: 0.7819867134094238
Epoch: 7, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.709 Vali Acc: 0.367 Test Loss: 1.709 Test Acc: 0.367
Validation loss decreased (-0.366649 --> -0.366650).  Saving model ...
Epoch: 8 cost time: 0.7871544361114502
Epoch: 8, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.676 Vali Acc: 0.341 Test Loss: 1.676 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8579137325286865
Epoch: 9, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.644 Vali Acc: 0.359 Test Loss: 1.644 Test Acc: 0.359
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8807559013366699
Epoch: 10, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.608 Vali Acc: 0.381 Test Loss: 1.608 Test Acc: 0.381
Validation loss decreased (-0.366650 --> -0.381465).  Saving model ...
Epoch: 11 cost time: 1.1441013813018799
Epoch: 11, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.562 Vali Acc: 0.448 Test Loss: 1.562 Test Acc: 0.448
Validation loss decreased (-0.381465 --> -0.448133).  Saving model ...
Epoch: 12 cost time: 0.9312858581542969
Epoch: 12, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.507 Vali Acc: 0.541 Test Loss: 1.507 Test Acc: 0.541
Validation loss decreased (-0.448133 --> -0.540726).  Saving model ...
Epoch: 13 cost time: 0.9290874004364014
Epoch: 13, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.445 Vali Acc: 0.567 Test Loss: 1.445 Test Acc: 0.567
Validation loss decreased (-0.540726 --> -0.566652).  Saving model ...
Epoch: 14 cost time: 0.8962218761444092
Epoch: 14, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.381 Vali Acc: 0.611 Test Loss: 1.381 Test Acc: 0.611
Validation loss decreased (-0.566652 --> -0.611097).  Saving model ...
Epoch: 15 cost time: 0.7859604358673096
Epoch: 15, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.315 Vali Acc: 0.637 Test Loss: 1.315 Test Acc: 0.637
Validation loss decreased (-0.611097 --> -0.637024).  Saving model ...
Epoch: 16 cost time: 1.2535066604614258
Epoch: 16, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.248 Vali Acc: 0.696 Test Loss: 1.248 Test Acc: 0.696
Validation loss decreased (-0.637024 --> -0.696284).  Saving model ...
Epoch: 17 cost time: 0.9082858562469482
Epoch: 17, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.184 Vali Acc: 0.726 Test Loss: 1.184 Test Acc: 0.726
Validation loss decreased (-0.696284 --> -0.725914).  Saving model ...
Epoch: 18 cost time: 0.8704781532287598
Epoch: 18, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.121 Vali Acc: 0.726 Test Loss: 1.121 Test Acc: 0.726
Validation loss decreased (-0.725914 --> -0.725915).  Saving model ...
Epoch: 19 cost time: 0.7748229503631592
Epoch: 19, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.056 Vali Acc: 0.756 Test Loss: 1.056 Test Acc: 0.756
Validation loss decreased (-0.725915 --> -0.755545).  Saving model ...
Epoch: 20 cost time: 0.8704965114593506
Epoch: 20, Steps: 2 | Train Loss: 0.974 Vali Loss: 0.989 Vali Acc: 0.811 Test Loss: 0.989 Test Acc: 0.811
Validation loss decreased (-0.755545 --> -0.811101).  Saving model ...
Epoch: 21 cost time: 0.839921236038208
Epoch: 21, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.925 Vali Acc: 0.856 Test Loss: 0.925 Test Acc: 0.856
Validation loss decreased (-0.811101 --> -0.855546).  Saving model ...
Epoch: 22 cost time: 0.9497895240783691
Epoch: 22, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.865 Vali Acc: 0.889 Test Loss: 0.865 Test Acc: 0.889
Validation loss decreased (-0.855546 --> -0.888880).  Saving model ...
Epoch: 23 cost time: 0.8237783908843994
Epoch: 23, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.807 Vali Acc: 0.904 Test Loss: 0.807 Test Acc: 0.904
Validation loss decreased (-0.888880 --> -0.903696).  Saving model ...
Epoch: 24 cost time: 1.0727283954620361
Epoch: 24, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.749 Vali Acc: 0.919 Test Loss: 0.749 Test Acc: 0.919
Validation loss decreased (-0.903696 --> -0.918511).  Saving model ...
Epoch: 25 cost time: 0.9852793216705322
Epoch: 25, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.698 Vali Acc: 0.919 Test Loss: 0.698 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918512).  Saving model ...
Epoch: 26 cost time: 0.8455674648284912
Epoch: 26, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.647 Vali Acc: 0.919 Test Loss: 0.647 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 27 cost time: 0.8658483028411865
Epoch: 27, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.600 Vali Acc: 0.930 Test Loss: 0.600 Test Acc: 0.930
Validation loss decreased (-0.918512 --> -0.929624).  Saving model ...
Epoch: 28 cost time: 0.8917555809020996
Epoch: 28, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.559 Vali Acc: 0.926 Test Loss: 0.559 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.1470873355865479
Epoch: 29, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.524 Vali Acc: 0.930 Test Loss: 0.524 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 30 cost time: 0.8738696575164795
Epoch: 30, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.493 Vali Acc: 0.930 Test Loss: 0.493 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 31 cost time: 0.8570048809051514
Epoch: 31, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.465 Vali Acc: 0.930 Test Loss: 0.465 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 32 cost time: 0.8343079090118408
Epoch: 32, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.438 Vali Acc: 0.930 Test Loss: 0.438 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 33 cost time: 0.8158023357391357
Epoch: 33, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.415 Vali Acc: 0.933 Test Loss: 0.415 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 34 cost time: 0.9453814029693604
Epoch: 34, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.394 Vali Acc: 0.933 Test Loss: 0.394 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 35 cost time: 0.9200305938720703
Epoch: 35, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.376 Vali Acc: 0.937 Test Loss: 0.376 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 36 cost time: 0.9497697353363037
Epoch: 36, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.360 Vali Acc: 0.937 Test Loss: 0.360 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 37 cost time: 0.9052550792694092
Epoch: 37, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.345 Vali Acc: 0.937 Test Loss: 0.345 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 38 cost time: 1.1031370162963867
Epoch: 38, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.333 Vali Acc: 0.937 Test Loss: 0.333 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 39 cost time: 0.7201497554779053
Epoch: 39, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.323 Vali Acc: 0.941 Test Loss: 0.323 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 40 cost time: 0.7933633327484131
Epoch: 40, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.313 Vali Acc: 0.937 Test Loss: 0.313 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7919893264770508
Epoch: 41, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.304 Vali Acc: 0.937 Test Loss: 0.304 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8698775768280029
Epoch: 42, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.2029509544372559
Epoch: 43, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8197410106658936
Epoch: 44, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.9571232795715332
Epoch: 45, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.892371416091919
Epoch: 46, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.264 Vali Acc: 0.948 Test Loss: 0.264 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.7757415771484375
Epoch: 47, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 1.1390392780303955
Epoch: 48, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9811005592346191
Epoch: 49, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.8564321994781494
Epoch: 50, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.245 Vali Acc: 0.948 Test Loss: 0.245 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 51 cost time: 0.77935791015625
Epoch: 51, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8152389526367188
Epoch: 52, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.107609510421753
Epoch: 53, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2279391288757324
Epoch: 54, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.2063853740692139
Epoch: 55, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.197070837020874
Epoch: 56, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.9796984195709229
Epoch: 57, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.0213923454284668
Epoch: 58, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.768843412399292
Epoch: 59, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.8412446975708008
Epoch: 60, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 712310
model size : 4.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.959502935409546
Epoch: 1, Steps: 2 | Train Loss: 1.985 Vali Loss: 1.903 Vali Acc: 0.167 Test Loss: 1.903 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.9451935291290283
Epoch: 2, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.875 Vali Acc: 0.167 Test Loss: 1.875 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.9144549369812012
Epoch: 3, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.848 Vali Acc: 0.170 Test Loss: 1.848 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 4 cost time: 1.1352922916412354
Epoch: 4, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.813 Vali Acc: 0.189 Test Loss: 1.813 Test Acc: 0.189
Validation loss decreased (-0.170352 --> -0.188871).  Saving model ...
Epoch: 5 cost time: 0.9050796031951904
Epoch: 5, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.777 Vali Acc: 0.207 Test Loss: 1.777 Test Acc: 0.207
Validation loss decreased (-0.188871 --> -0.207390).  Saving model ...
Epoch: 6 cost time: 1.1492412090301514
Epoch: 6, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.744 Vali Acc: 0.226 Test Loss: 1.744 Test Acc: 0.226
Validation loss decreased (-0.207390 --> -0.225908).  Saving model ...
Epoch: 7 cost time: 0.9443652629852295
Epoch: 7, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.717 Vali Acc: 0.252 Test Loss: 1.717 Test Acc: 0.252
Validation loss decreased (-0.225908 --> -0.251835).  Saving model ...
Epoch: 8 cost time: 0.7574312686920166
Epoch: 8, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.692 Vali Acc: 0.304 Test Loss: 1.692 Test Acc: 0.304
Validation loss decreased (-0.251835 --> -0.303687).  Saving model ...
Epoch: 9 cost time: 1.4682762622833252
Epoch: 9, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.670 Vali Acc: 0.319 Test Loss: 1.670 Test Acc: 0.319
Validation loss decreased (-0.303687 --> -0.318502).  Saving model ...
Epoch: 10 cost time: 1.0726678371429443
Epoch: 10, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.644 Vali Acc: 0.337 Test Loss: 1.644 Test Acc: 0.337
Validation loss decreased (-0.318502 --> -0.337021).  Saving model ...
Epoch: 11 cost time: 0.9837775230407715
Epoch: 11, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.614 Vali Acc: 0.393 Test Loss: 1.614 Test Acc: 0.393
Validation loss decreased (-0.337021 --> -0.392576).  Saving model ...
Epoch: 12 cost time: 0.866443395614624
Epoch: 12, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.571 Vali Acc: 0.463 Test Loss: 1.571 Test Acc: 0.463
Validation loss decreased (-0.392576 --> -0.462947).  Saving model ...
Epoch: 13 cost time: 1.0042526721954346
Epoch: 13, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.521 Vali Acc: 0.544 Test Loss: 1.521 Test Acc: 0.544
Validation loss decreased (-0.462947 --> -0.544429).  Saving model ...
Epoch: 14 cost time: 1.105255365371704
Epoch: 14, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.468 Vali Acc: 0.585 Test Loss: 1.468 Test Acc: 0.585
Validation loss decreased (-0.544429 --> -0.585171).  Saving model ...
Epoch: 15 cost time: 0.7974729537963867
Epoch: 15, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.413 Vali Acc: 0.663 Test Loss: 1.413 Test Acc: 0.663
Validation loss decreased (-0.585171 --> -0.662949).  Saving model ...
Epoch: 16 cost time: 1.0315980911254883
Epoch: 16, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.356 Vali Acc: 0.722 Test Loss: 1.356 Test Acc: 0.722
Validation loss decreased (-0.662949 --> -0.722209).  Saving model ...
Epoch: 17 cost time: 1.007978916168213
Epoch: 17, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.299 Vali Acc: 0.785 Test Loss: 1.299 Test Acc: 0.785
Validation loss decreased (-0.722209 --> -0.785172).  Saving model ...
Epoch: 18 cost time: 0.8657345771789551
Epoch: 18, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.238 Vali Acc: 0.796 Test Loss: 1.238 Test Acc: 0.796
Validation loss decreased (-0.785172 --> -0.796284).  Saving model ...
Epoch: 19 cost time: 0.8285577297210693
Epoch: 19, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.172 Vali Acc: 0.822 Test Loss: 1.172 Test Acc: 0.822
Validation loss decreased (-0.796284 --> -0.822211).  Saving model ...
Epoch: 20 cost time: 0.9298968315124512
Epoch: 20, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.106 Vali Acc: 0.822 Test Loss: 1.106 Test Acc: 0.822
Validation loss decreased (-0.822211 --> -0.822211).  Saving model ...
Epoch: 21 cost time: 0.9377999305725098
Epoch: 21, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.041 Vali Acc: 0.830 Test Loss: 1.041 Test Acc: 0.830
Validation loss decreased (-0.822211 --> -0.829619).  Saving model ...
Epoch: 22 cost time: 0.9373204708099365
Epoch: 22, Steps: 2 | Train Loss: 1.001 Vali Loss: 0.974 Vali Acc: 0.859 Test Loss: 0.974 Test Acc: 0.859
Validation loss decreased (-0.829619 --> -0.859250).  Saving model ...
Epoch: 23 cost time: 0.9316926002502441
Epoch: 23, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.913 Vali Acc: 0.841 Test Loss: 0.913 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8407588005065918
Epoch: 24, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.856 Vali Acc: 0.833 Test Loss: 0.856 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9065032005310059
Epoch: 25, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.799 Vali Acc: 0.848 Test Loss: 0.799 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1067981719970703
Epoch: 26, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.742 Vali Acc: 0.878 Test Loss: 0.742 Test Acc: 0.878
Validation loss decreased (-0.859250 --> -0.877770).  Saving model ...
Epoch: 27 cost time: 0.9171702861785889
Epoch: 27, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.690 Vali Acc: 0.881 Test Loss: 0.690 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881475).  Saving model ...
Epoch: 28 cost time: 1.0072882175445557
Epoch: 28, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.643 Vali Acc: 0.896 Test Loss: 0.643 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896290).  Saving model ...
Epoch: 29 cost time: 0.7871110439300537
Epoch: 29, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.600 Vali Acc: 0.907 Test Loss: 0.600 Test Acc: 0.907
Validation loss decreased (-0.896290 --> -0.907401).  Saving model ...
Epoch: 30 cost time: 0.9507083892822266
Epoch: 30, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.563 Vali Acc: 0.900 Test Loss: 0.563 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0125632286071777
Epoch: 31, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.528 Vali Acc: 0.904 Test Loss: 0.528 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8686938285827637
Epoch: 32, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.496 Vali Acc: 0.904 Test Loss: 0.496 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8610188961029053
Epoch: 33, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.468 Vali Acc: 0.904 Test Loss: 0.468 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1746187210083008
Epoch: 34, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.444 Vali Acc: 0.907 Test Loss: 0.444 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907403).  Saving model ...
Epoch: 35 cost time: 0.9614410400390625
Epoch: 35, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.423 Vali Acc: 0.907 Test Loss: 0.423 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 36 cost time: 0.9271166324615479
Epoch: 36, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.404 Vali Acc: 0.904 Test Loss: 0.404 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.1642389297485352
Epoch: 37, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.384 Vali Acc: 0.919 Test Loss: 0.384 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918515).  Saving model ...
Epoch: 38 cost time: 0.782944917678833
Epoch: 38, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.369 Vali Acc: 0.907 Test Loss: 0.369 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.0541179180145264
Epoch: 39, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.357 Vali Acc: 0.907 Test Loss: 0.357 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.953094482421875
Epoch: 40, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.346 Vali Acc: 0.911 Test Loss: 0.346 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0418376922607422
Epoch: 41, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.0334506034851074
Epoch: 42, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.325 Vali Acc: 0.911 Test Loss: 0.325 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9293727874755859
Epoch: 43, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.320 Vali Acc: 0.915 Test Loss: 0.320 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.9137232303619385
Epoch: 44, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.311 Vali Acc: 0.915 Test Loss: 0.311 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7620296478271484
Epoch: 45, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 46 cost time: 0.9033472537994385
Epoch: 46, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.296 Vali Acc: 0.919 Test Loss: 0.296 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 47 cost time: 1.0583081245422363
Epoch: 47, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925923).  Saving model ...
Epoch: 48 cost time: 1.0584332942962646
Epoch: 48, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 49 cost time: 1.0758402347564697
Epoch: 49, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 50 cost time: 0.8413674831390381
Epoch: 50, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.270 Vali Acc: 0.922 Test Loss: 0.270 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.868109941482544
Epoch: 51, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.8186068534851074
Epoch: 52, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 53 cost time: 0.7973790168762207
Epoch: 53, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 54 cost time: 0.868321418762207
Epoch: 54, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.273 Vali Acc: 0.933 Test Loss: 0.273 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 55 cost time: 0.8824751377105713
Epoch: 55, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.9370505809783936
Epoch: 56, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.272 Vali Acc: 0.922 Test Loss: 0.272 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.78810715675354
Epoch: 57, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 58 cost time: 0.7360694408416748
Epoch: 58, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 0.8008360862731934
Epoch: 59, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8690545558929443
Epoch: 60, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.9727802276611328
Epoch: 61, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.7800209522247314
Epoch: 62, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.8435242176055908
Epoch: 63, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.869349479675293
Epoch: 64, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 65 cost time: 1.0041978359222412
Epoch: 65, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 66 cost time: 0.7295958995819092
Epoch: 66, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.9422686100006104
Epoch: 67, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.8868403434753418
Epoch: 68, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9452040195465088
Epoch: 69, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.966212272644043
Epoch: 70, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.7658648490905762
Epoch: 71, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.8751778602600098
Epoch: 72, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.9457380771636963
Epoch: 73, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.9325973987579346
Epoch: 74, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 1.021533727645874
Epoch: 75, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 598838
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7451179027557373
Epoch: 1, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.685 Vali Acc: 0.278 Test Loss: 1.685 Test Acc: 0.278
Validation loss decreased (inf --> -0.277761).  Saving model ...
Epoch: 2 cost time: 0.9345846176147461
Epoch: 2, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.667 Vali Acc: 0.322 Test Loss: 1.667 Test Acc: 0.322
Validation loss decreased (-0.277761 --> -0.322206).  Saving model ...
Epoch: 3 cost time: 0.882652997970581
Epoch: 3, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.649 Vali Acc: 0.407 Test Loss: 1.649 Test Acc: 0.407
Validation loss decreased (-0.322206 --> -0.407391).  Saving model ...
Epoch: 4 cost time: 0.7473695278167725
Epoch: 4, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.625 Vali Acc: 0.396 Test Loss: 1.625 Test Acc: 0.396
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9786198139190674
Epoch: 5, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.596 Vali Acc: 0.389 Test Loss: 1.596 Test Acc: 0.389
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0515694618225098
Epoch: 6, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.563 Vali Acc: 0.389 Test Loss: 1.563 Test Acc: 0.389
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9566755294799805
Epoch: 7, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.526 Vali Acc: 0.444 Test Loss: 1.526 Test Acc: 0.444
Validation loss decreased (-0.407391 --> -0.444429).  Saving model ...
Epoch: 8 cost time: 0.892155647277832
Epoch: 8, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.488 Vali Acc: 0.496 Test Loss: 1.488 Test Acc: 0.496
Validation loss decreased (-0.444429 --> -0.496281).  Saving model ...
Epoch: 9 cost time: 0.9461019039154053
Epoch: 9, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.447 Vali Acc: 0.548 Test Loss: 1.447 Test Acc: 0.548
Validation loss decreased (-0.496281 --> -0.548134).  Saving model ...
Epoch: 10 cost time: 0.818406343460083
Epoch: 10, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.404 Vali Acc: 0.633 Test Loss: 1.404 Test Acc: 0.633
Validation loss decreased (-0.548134 --> -0.633319).  Saving model ...
Epoch: 11 cost time: 1.102729082107544
Epoch: 11, Steps: 2 | Train Loss: 1.409 Vali Loss: 1.356 Vali Acc: 0.652 Test Loss: 1.356 Test Acc: 0.652
Validation loss decreased (-0.633319 --> -0.651838).  Saving model ...
Epoch: 12 cost time: 0.923227071762085
Epoch: 12, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.306 Vali Acc: 0.667 Test Loss: 1.306 Test Acc: 0.667
Validation loss decreased (-0.651838 --> -0.666654).  Saving model ...
Epoch: 13 cost time: 0.9816958904266357
Epoch: 13, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.252 Vali Acc: 0.704 Test Loss: 1.252 Test Acc: 0.704
Validation loss decreased (-0.666654 --> -0.703691).  Saving model ...
Epoch: 14 cost time: 0.9518005847930908
Epoch: 14, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.195 Vali Acc: 0.737 Test Loss: 1.195 Test Acc: 0.737
Validation loss decreased (-0.703691 --> -0.737025).  Saving model ...
Epoch: 15 cost time: 0.8939697742462158
Epoch: 15, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.135 Vali Acc: 0.774 Test Loss: 1.135 Test Acc: 0.774
Validation loss decreased (-0.737025 --> -0.774063).  Saving model ...
Epoch: 16 cost time: 0.7464699745178223
Epoch: 16, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.076 Vali Acc: 0.781 Test Loss: 1.076 Test Acc: 0.781
Validation loss decreased (-0.774063 --> -0.781471).  Saving model ...
Epoch: 17 cost time: 0.7387897968292236
Epoch: 17, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.018 Vali Acc: 0.826 Test Loss: 1.018 Test Acc: 0.826
Validation loss decreased (-0.781471 --> -0.825916).  Saving model ...
Epoch: 18 cost time: 0.847405195236206
Epoch: 18, Steps: 2 | Train Loss: 0.971 Vali Loss: 0.961 Vali Acc: 0.841 Test Loss: 0.961 Test Acc: 0.841
Validation loss decreased (-0.825916 --> -0.840731).  Saving model ...
Epoch: 19 cost time: 0.9100468158721924
Epoch: 19, Steps: 2 | Train Loss: 0.908 Vali Loss: 0.904 Vali Acc: 0.852 Test Loss: 0.904 Test Acc: 0.852
Validation loss decreased (-0.840731 --> -0.851843).  Saving model ...
Epoch: 20 cost time: 1.1201128959655762
Epoch: 20, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.852 Vali Acc: 0.859 Test Loss: 0.852 Test Acc: 0.859
Validation loss decreased (-0.851843 --> -0.859251).  Saving model ...
Epoch: 21 cost time: 0.8616962432861328
Epoch: 21, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.802 Vali Acc: 0.852 Test Loss: 0.802 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8273415565490723
Epoch: 22, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.752 Vali Acc: 0.885 Test Loss: 0.752 Test Acc: 0.885
Validation loss decreased (-0.859251 --> -0.885178).  Saving model ...
Epoch: 23 cost time: 1.0189921855926514
Epoch: 23, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.707 Vali Acc: 0.889 Test Loss: 0.707 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 24 cost time: 0.8442304134368896
Epoch: 24, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.664 Vali Acc: 0.889 Test Loss: 0.664 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888882).  Saving model ...
Epoch: 25 cost time: 0.7729983329772949
Epoch: 25, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.623 Vali Acc: 0.900 Test Loss: 0.623 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.7256059646606445
Epoch: 26, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.586 Vali Acc: 0.907 Test Loss: 0.586 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 27 cost time: 0.7981002330780029
Epoch: 27, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.552 Vali Acc: 0.919 Test Loss: 0.552 Test Acc: 0.919
Validation loss decreased (-0.907402 --> -0.918513).  Saving model ...
Epoch: 28 cost time: 0.9323887825012207
Epoch: 28, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.521 Vali Acc: 0.922 Test Loss: 0.521 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 29 cost time: 0.915398359298706
Epoch: 29, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.494 Vali Acc: 0.915 Test Loss: 0.494 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0607967376708984
Epoch: 30, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.471 Vali Acc: 0.926 Test Loss: 0.471 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 31 cost time: 0.9719107151031494
Epoch: 31, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.451 Vali Acc: 0.919 Test Loss: 0.451 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7922589778900146
Epoch: 32, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.433 Vali Acc: 0.922 Test Loss: 0.433 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.0041983127593994
Epoch: 33, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.421 Vali Acc: 0.911 Test Loss: 0.421 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.069887399673462
Epoch: 34, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.406 Vali Acc: 0.911 Test Loss: 0.406 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8138823509216309
Epoch: 35, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.390 Vali Acc: 0.915 Test Loss: 0.390 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.1040024757385254
Epoch: 36, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.375 Vali Acc: 0.919 Test Loss: 0.375 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.9289877414703369
Epoch: 37, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.358 Vali Acc: 0.922 Test Loss: 0.358 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9207792282104492
Epoch: 38, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.342 Vali Acc: 0.933 Test Loss: 0.342 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933330).  Saving model ...
Epoch: 39 cost time: 0.8862161636352539
Epoch: 39, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.331 Vali Acc: 0.937 Test Loss: 0.331 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 1.0752980709075928
Epoch: 40, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.327 Vali Acc: 0.937 Test Loss: 0.327 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.9648098945617676
Epoch: 41, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.322 Vali Acc: 0.919 Test Loss: 0.322 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0463261604309082
Epoch: 42, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.3224549293518066
Epoch: 43, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.309 Vali Acc: 0.922 Test Loss: 0.309 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8220040798187256
Epoch: 44, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8261075019836426
Epoch: 45, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.0860414505004883
Epoch: 46, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9976863861083984
Epoch: 47, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.284 Vali Acc: 0.937 Test Loss: 0.284 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 48 cost time: 1.1791183948516846
Epoch: 48, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 49 cost time: 0.7596242427825928
Epoch: 49, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.8068950176239014
Epoch: 50, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 51 cost time: 0.8564655780792236
Epoch: 51, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 52 cost time: 0.9972860813140869
Epoch: 52, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 53 cost time: 1.0452804565429688
Epoch: 53, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.2021763324737549
Epoch: 54, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.0276007652282715
Epoch: 55, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.766068696975708
Epoch: 56, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.9676921367645264
Epoch: 57, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 58 cost time: 0.8810670375823975
Epoch: 58, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.239 Vali Acc: 0.952 Test Loss: 0.239 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 59 cost time: 0.7711396217346191
Epoch: 59, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.1089832782745361
Epoch: 60, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.8199446201324463
Epoch: 61, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8643040657043457
Epoch: 62, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.8654952049255371
Epoch: 63, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.9545063972473145
Epoch: 64, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.7374067306518555
Epoch: 65, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.9209671020507812
Epoch: 66, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.897477388381958
Epoch: 67, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.980717658996582
Epoch: 68, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 598134
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7654058933258057
Epoch: 1, Steps: 2 | Train Loss: 2.039 Vali Loss: 1.908 Vali Acc: 0.085 Test Loss: 1.908 Test Acc: 0.085
Validation loss decreased (inf --> -0.085166).  Saving model ...
Epoch: 2 cost time: 0.7093429565429688
Epoch: 2, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.885 Vali Acc: 0.078 Test Loss: 1.885 Test Acc: 0.078
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8729443550109863
Epoch: 3, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.862 Vali Acc: 0.070 Test Loss: 1.862 Test Acc: 0.070
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8303351402282715
Epoch: 4, Steps: 2 | Train Loss: 1.949 Vali Loss: 1.832 Vali Acc: 0.063 Test Loss: 1.832 Test Acc: 0.063
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8967640399932861
Epoch: 5, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.800 Vali Acc: 0.093 Test Loss: 1.800 Test Acc: 0.093
Validation loss decreased (-0.085166 --> -0.092575).  Saving model ...
Epoch: 6 cost time: 0.8167085647583008
Epoch: 6, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.769 Vali Acc: 0.215 Test Loss: 1.769 Test Acc: 0.215
Validation loss decreased (-0.092575 --> -0.214797).  Saving model ...
Epoch: 7 cost time: 0.7291514873504639
Epoch: 7, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.737 Vali Acc: 0.315 Test Loss: 1.737 Test Acc: 0.315
Validation loss decreased (-0.214797 --> -0.314797).  Saving model ...
Epoch: 8 cost time: 0.7781229019165039
Epoch: 8, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.706 Vali Acc: 0.381 Test Loss: 1.706 Test Acc: 0.381
Validation loss decreased (-0.314797 --> -0.381464).  Saving model ...
Epoch: 9 cost time: 0.8839609622955322
Epoch: 9, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.674 Vali Acc: 0.470 Test Loss: 1.674 Test Acc: 0.470
Validation loss decreased (-0.381464 --> -0.470354).  Saving model ...
Epoch: 10 cost time: 0.7752525806427002
Epoch: 10, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.641 Vali Acc: 0.548 Test Loss: 1.641 Test Acc: 0.548
Validation loss decreased (-0.470354 --> -0.548132).  Saving model ...
Epoch: 11 cost time: 0.7780442237854004
Epoch: 11, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.605 Vali Acc: 0.544 Test Loss: 1.605 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7669942378997803
Epoch: 12, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.565 Vali Acc: 0.581 Test Loss: 1.565 Test Acc: 0.581
Validation loss decreased (-0.548132 --> -0.581466).  Saving model ...
Epoch: 13 cost time: 0.7313451766967773
Epoch: 13, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.521 Vali Acc: 0.644 Test Loss: 1.521 Test Acc: 0.644
Validation loss decreased (-0.581466 --> -0.644429).  Saving model ...
Epoch: 14 cost time: 0.6583812236785889
Epoch: 14, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.476 Vali Acc: 0.696 Test Loss: 1.476 Test Acc: 0.696
Validation loss decreased (-0.644429 --> -0.696282).  Saving model ...
Epoch: 15 cost time: 0.7910411357879639
Epoch: 15, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.431 Vali Acc: 0.722 Test Loss: 1.431 Test Acc: 0.722
Validation loss decreased (-0.696282 --> -0.722208).  Saving model ...
Epoch: 16 cost time: 0.7112395763397217
Epoch: 16, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.385 Vali Acc: 0.759 Test Loss: 1.385 Test Acc: 0.759
Validation loss decreased (-0.722208 --> -0.759245).  Saving model ...
Epoch: 17 cost time: 0.6553008556365967
Epoch: 17, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.338 Vali Acc: 0.785 Test Loss: 1.338 Test Acc: 0.785
Validation loss decreased (-0.759245 --> -0.785172).  Saving model ...
Epoch: 18 cost time: 0.6343033313751221
Epoch: 18, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.287 Vali Acc: 0.785 Test Loss: 1.287 Test Acc: 0.785
Validation loss decreased (-0.785172 --> -0.785172).  Saving model ...
Epoch: 19 cost time: 0.8256568908691406
Epoch: 19, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.233 Vali Acc: 0.785 Test Loss: 1.233 Test Acc: 0.785
Validation loss decreased (-0.785172 --> -0.785173).  Saving model ...
Epoch: 20 cost time: 0.696605920791626
Epoch: 20, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.175 Vali Acc: 0.800 Test Loss: 1.175 Test Acc: 0.800
Validation loss decreased (-0.785173 --> -0.799988).  Saving model ...
Epoch: 21 cost time: 0.7124028205871582
Epoch: 21, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.118 Vali Acc: 0.815 Test Loss: 1.118 Test Acc: 0.815
Validation loss decreased (-0.799988 --> -0.814804).  Saving model ...
Epoch: 22 cost time: 0.8157021999359131
Epoch: 22, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.061 Vali Acc: 0.833 Test Loss: 1.061 Test Acc: 0.833
Validation loss decreased (-0.814804 --> -0.833323).  Saving model ...
Epoch: 23 cost time: 1.048537254333496
Epoch: 23, Steps: 2 | Train Loss: 0.958 Vali Loss: 1.004 Vali Acc: 0.833 Test Loss: 1.004 Test Acc: 0.833
Validation loss decreased (-0.833323 --> -0.833323).  Saving model ...
Epoch: 24 cost time: 0.803173303604126
Epoch: 24, Steps: 2 | Train Loss: 0.899 Vali Loss: 0.952 Vali Acc: 0.848 Test Loss: 0.952 Test Acc: 0.848
Validation loss decreased (-0.833323 --> -0.848139).  Saving model ...
Epoch: 25 cost time: 0.8544256687164307
Epoch: 25, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.900 Vali Acc: 0.863 Test Loss: 0.900 Test Acc: 0.863
Validation loss decreased (-0.848139 --> -0.862954).  Saving model ...
Epoch: 26 cost time: 0.8083312511444092
Epoch: 26, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.850 Vali Acc: 0.874 Test Loss: 0.850 Test Acc: 0.874
Validation loss decreased (-0.862954 --> -0.874066).  Saving model ...
Epoch: 27 cost time: 0.7253165245056152
Epoch: 27, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.801 Vali Acc: 0.859 Test Loss: 0.801 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8551216125488281
Epoch: 28, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.754 Vali Acc: 0.870 Test Loss: 0.754 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8605387210845947
Epoch: 29, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.711 Vali Acc: 0.870 Test Loss: 0.711 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8182899951934814
Epoch: 30, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.671 Vali Acc: 0.885 Test Loss: 0.671 Test Acc: 0.885
Validation loss decreased (-0.874066 --> -0.885178).  Saving model ...
Epoch: 31 cost time: 0.8829019069671631
Epoch: 31, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.634 Vali Acc: 0.893 Test Loss: 0.634 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 32 cost time: 0.8608806133270264
Epoch: 32, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.601 Vali Acc: 0.893 Test Loss: 0.601 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 33 cost time: 0.7183458805084229
Epoch: 33, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.572 Vali Acc: 0.904 Test Loss: 0.572 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903698).  Saving model ...
Epoch: 34 cost time: 0.8129053115844727
Epoch: 34, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.546 Vali Acc: 0.904 Test Loss: 0.546 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 35 cost time: 0.7569563388824463
Epoch: 35, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.518 Vali Acc: 0.907 Test Loss: 0.518 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 36 cost time: 0.848721981048584
Epoch: 36, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7491061687469482
Epoch: 37, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.459 Vali Acc: 0.907 Test Loss: 0.459 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 38 cost time: 0.7621808052062988
Epoch: 38, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.436 Vali Acc: 0.915 Test Loss: 0.436 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914810).  Saving model ...
Epoch: 39 cost time: 0.8958382606506348
Epoch: 39, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.415 Vali Acc: 0.904 Test Loss: 0.415 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8125224113464355
Epoch: 40, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.402 Vali Acc: 0.907 Test Loss: 0.402 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9999313354492188
Epoch: 41, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.391 Vali Acc: 0.919 Test Loss: 0.391 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918515).  Saving model ...
Epoch: 42 cost time: 0.7529981136322021
Epoch: 42, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.385 Vali Acc: 0.915 Test Loss: 0.385 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.0260469913482666
Epoch: 43, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.371 Vali Acc: 0.922 Test Loss: 0.371 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 44 cost time: 0.7003462314605713
Epoch: 44, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.360 Vali Acc: 0.922 Test Loss: 0.360 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 45 cost time: 0.7869877815246582
Epoch: 45, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.347 Vali Acc: 0.915 Test Loss: 0.347 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.7874829769134521
Epoch: 46, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.331 Vali Acc: 0.919 Test Loss: 0.331 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8090453147888184
Epoch: 47, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.318 Vali Acc: 0.915 Test Loss: 0.318 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.9041783809661865
Epoch: 48, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8189079761505127
Epoch: 49, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.299 Vali Acc: 0.919 Test Loss: 0.299 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9633514881134033
Epoch: 50, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.295 Vali Acc: 0.926 Test Loss: 0.295 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 51 cost time: 0.8210484981536865
Epoch: 51, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 52 cost time: 0.7477962970733643
Epoch: 52, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.288 Vali Acc: 0.930 Test Loss: 0.288 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 53 cost time: 0.7123878002166748
Epoch: 53, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8990719318389893
Epoch: 54, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 55 cost time: 0.6944677829742432
Epoch: 55, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 56 cost time: 0.6909139156341553
Epoch: 56, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 57 cost time: 0.7322366237640381
Epoch: 57, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7551813125610352
Epoch: 58, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 59 cost time: 0.9580690860748291
Epoch: 59, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 60 cost time: 0.8606119155883789
Epoch: 60, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 61 cost time: 0.8631680011749268
Epoch: 61, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 62 cost time: 0.8415298461914062
Epoch: 62, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 63 cost time: 0.8176658153533936
Epoch: 63, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8157949447631836
Epoch: 64, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9180872440338135
Epoch: 65, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8398051261901855
Epoch: 66, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 67 cost time: 0.7838046550750732
Epoch: 67, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.0304346084594727
Epoch: 68, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.219 Vali Acc: 0.952 Test Loss: 0.219 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 69 cost time: 0.9022362232208252
Epoch: 69, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.220 Vali Acc: 0.948 Test Loss: 0.220 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.7627015113830566
Epoch: 70, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.9203627109527588
Epoch: 71, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.7519185543060303
Epoch: 72, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.9004008769989014
Epoch: 73, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.9079029560089111
Epoch: 74, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.7840511798858643
Epoch: 75, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.8144702911376953
Epoch: 76, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.7833669185638428
Epoch: 77, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.7408347129821777
Epoch: 78, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 597430
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.307429313659668
Epoch: 1, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.806 Vali Acc: 0.089 Test Loss: 1.806 Test Acc: 0.089
Validation loss decreased (inf --> -0.088871).  Saving model ...
Epoch: 2 cost time: 0.8373527526855469
Epoch: 2, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.793 Vali Acc: 0.093 Test Loss: 1.793 Test Acc: 0.093
Validation loss decreased (-0.088871 --> -0.092575).  Saving model ...
Epoch: 3 cost time: 0.6718251705169678
Epoch: 3, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.779 Vali Acc: 0.122 Test Loss: 1.779 Test Acc: 0.122
Validation loss decreased (-0.092575 --> -0.122204).  Saving model ...
Epoch: 4 cost time: 0.9406225681304932
Epoch: 4, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.759 Vali Acc: 0.156 Test Loss: 1.759 Test Acc: 0.156
Validation loss decreased (-0.122204 --> -0.155538).  Saving model ...
Epoch: 5 cost time: 0.8561346530914307
Epoch: 5, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.736 Vali Acc: 0.178 Test Loss: 1.736 Test Acc: 0.178
Validation loss decreased (-0.155538 --> -0.177760).  Saving model ...
Epoch: 6 cost time: 0.8031902313232422
Epoch: 6, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.710 Vali Acc: 0.211 Test Loss: 1.710 Test Acc: 0.211
Validation loss decreased (-0.177760 --> -0.211094).  Saving model ...
Epoch: 7 cost time: 0.7663447856903076
Epoch: 7, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.681 Vali Acc: 0.263 Test Loss: 1.681 Test Acc: 0.263
Validation loss decreased (-0.211094 --> -0.262946).  Saving model ...
Epoch: 8 cost time: 0.8284621238708496
Epoch: 8, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.651 Vali Acc: 0.333 Test Loss: 1.651 Test Acc: 0.333
Validation loss decreased (-0.262946 --> -0.333317).  Saving model ...
Epoch: 9 cost time: 0.7345309257507324
Epoch: 9, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.618 Vali Acc: 0.444 Test Loss: 1.618 Test Acc: 0.444
Validation loss decreased (-0.333317 --> -0.444428).  Saving model ...
Epoch: 10 cost time: 0.8546280860900879
Epoch: 10, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.580 Vali Acc: 0.563 Test Loss: 1.580 Test Acc: 0.563
Validation loss decreased (-0.444428 --> -0.562947).  Saving model ...
Epoch: 11 cost time: 0.8074791431427002
Epoch: 11, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.540 Vali Acc: 0.611 Test Loss: 1.540 Test Acc: 0.611
Validation loss decreased (-0.562947 --> -0.611096).  Saving model ...
Epoch: 12 cost time: 0.7751002311706543
Epoch: 12, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.499 Vali Acc: 0.678 Test Loss: 1.499 Test Acc: 0.678
Validation loss decreased (-0.611096 --> -0.677763).  Saving model ...
Epoch: 13 cost time: 0.8749709129333496
Epoch: 13, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.458 Vali Acc: 0.711 Test Loss: 1.458 Test Acc: 0.711
Validation loss decreased (-0.677763 --> -0.711097).  Saving model ...
Epoch: 14 cost time: 0.9540340900421143
Epoch: 14, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.414 Vali Acc: 0.752 Test Loss: 1.414 Test Acc: 0.752
Validation loss decreased (-0.711097 --> -0.751838).  Saving model ...
Epoch: 15 cost time: 0.8166060447692871
Epoch: 15, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.368 Vali Acc: 0.796 Test Loss: 1.368 Test Acc: 0.796
Validation loss decreased (-0.751838 --> -0.796283).  Saving model ...
Epoch: 16 cost time: 0.8259406089782715
Epoch: 16, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.320 Vali Acc: 0.830 Test Loss: 1.320 Test Acc: 0.830
Validation loss decreased (-0.796283 --> -0.829616).  Saving model ...
Epoch: 17 cost time: 0.9761593341827393
Epoch: 17, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.270 Vali Acc: 0.844 Test Loss: 1.270 Test Acc: 0.844
Validation loss decreased (-0.829616 --> -0.844432).  Saving model ...
Epoch: 18 cost time: 0.7763447761535645
Epoch: 18, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.217 Vali Acc: 0.859 Test Loss: 1.217 Test Acc: 0.859
Validation loss decreased (-0.844432 --> -0.859247).  Saving model ...
Epoch: 19 cost time: 0.8421611785888672
Epoch: 19, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.164 Vali Acc: 0.881 Test Loss: 1.164 Test Acc: 0.881
Validation loss decreased (-0.859247 --> -0.881470).  Saving model ...
Epoch: 20 cost time: 0.8439531326293945
Epoch: 20, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.108 Vali Acc: 0.893 Test Loss: 1.108 Test Acc: 0.893
Validation loss decreased (-0.881470 --> -0.892582).  Saving model ...
Epoch: 21 cost time: 0.7243809700012207
Epoch: 21, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.051 Vali Acc: 0.896 Test Loss: 1.051 Test Acc: 0.896
Validation loss decreased (-0.892582 --> -0.896286).  Saving model ...
Epoch: 22 cost time: 0.7888903617858887
Epoch: 22, Steps: 2 | Train Loss: 0.957 Vali Loss: 0.994 Vali Acc: 0.900 Test Loss: 0.994 Test Acc: 0.900
Validation loss decreased (-0.896286 --> -0.899990).  Saving model ...
Epoch: 23 cost time: 0.8840858936309814
Epoch: 23, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.939 Vali Acc: 0.900 Test Loss: 0.939 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899991).  Saving model ...
Epoch: 24 cost time: 0.9459655284881592
Epoch: 24, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.881 Vali Acc: 0.904 Test Loss: 0.881 Test Acc: 0.904
Validation loss decreased (-0.899991 --> -0.903695).  Saving model ...
Epoch: 25 cost time: 0.8075284957885742
Epoch: 25, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.821 Vali Acc: 0.904 Test Loss: 0.821 Test Acc: 0.904
Validation loss decreased (-0.903695 --> -0.903695).  Saving model ...
Epoch: 26 cost time: 0.9406476020812988
Epoch: 26, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.766 Vali Acc: 0.896 Test Loss: 0.766 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.935887336730957
Epoch: 27, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.713 Vali Acc: 0.889 Test Loss: 0.713 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9300801753997803
Epoch: 28, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.662 Vali Acc: 0.900 Test Loss: 0.662 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8732693195343018
Epoch: 29, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.612 Vali Acc: 0.911 Test Loss: 0.612 Test Acc: 0.911
Validation loss decreased (-0.903695 --> -0.911105).  Saving model ...
Epoch: 30 cost time: 0.9250109195709229
Epoch: 30, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.570 Vali Acc: 0.911 Test Loss: 0.570 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 31 cost time: 0.9203543663024902
Epoch: 31, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.535 Vali Acc: 0.896 Test Loss: 0.535 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.674454927444458
Epoch: 32, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.507 Vali Acc: 0.893 Test Loss: 0.507 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8328161239624023
Epoch: 33, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.480 Vali Acc: 0.896 Test Loss: 0.480 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.9136643409729004
Epoch: 34, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.456 Vali Acc: 0.900 Test Loss: 0.456 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9250199794769287
Epoch: 35, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.432 Vali Acc: 0.900 Test Loss: 0.432 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9026622772216797
Epoch: 36, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.411 Vali Acc: 0.900 Test Loss: 0.411 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.295605182647705
Epoch: 37, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.390 Vali Acc: 0.904 Test Loss: 0.390 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7449657917022705
Epoch: 38, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7967054843902588
Epoch: 39, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.366 Vali Acc: 0.904 Test Loss: 0.366 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8806807994842529
Epoch: 40, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.353 Vali Acc: 0.907 Test Loss: 0.353 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 596726
model size : 3.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5929925441741943
Epoch: 1, Steps: 2 | Train Loss: 1.986 Vali Loss: 1.897 Vali Acc: 0.167 Test Loss: 1.897 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.6914963722229004
Epoch: 2, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.860 Vali Acc: 0.170 Test Loss: 1.860 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 3 cost time: 1.0017507076263428
Epoch: 3, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.824 Vali Acc: 0.178 Test Loss: 1.824 Test Acc: 0.178
Validation loss decreased (-0.170352 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 0.7042114734649658
Epoch: 4, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.775 Vali Acc: 0.196 Test Loss: 1.775 Test Acc: 0.196
Validation loss decreased (-0.177760 --> -0.196279).  Saving model ...
Epoch: 5 cost time: 0.7966136932373047
Epoch: 5, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.721 Vali Acc: 0.259 Test Loss: 1.721 Test Acc: 0.259
Validation loss decreased (-0.196279 --> -0.259242).  Saving model ...
Epoch: 6 cost time: 0.8179960250854492
Epoch: 6, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.670 Vali Acc: 0.307 Test Loss: 1.670 Test Acc: 0.307
Validation loss decreased (-0.259242 --> -0.307391).  Saving model ...
Epoch: 7 cost time: 0.8477020263671875
Epoch: 7, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.625 Vali Acc: 0.378 Test Loss: 1.625 Test Acc: 0.378
Validation loss decreased (-0.307391 --> -0.377762).  Saving model ...
Epoch: 8 cost time: 0.7555382251739502
Epoch: 8, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.584 Vali Acc: 0.481 Test Loss: 1.584 Test Acc: 0.481
Validation loss decreased (-0.377762 --> -0.481466).  Saving model ...
Epoch: 9 cost time: 0.7692101001739502
Epoch: 9, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.544 Vali Acc: 0.574 Test Loss: 1.544 Test Acc: 0.574
Validation loss decreased (-0.481466 --> -0.574059).  Saving model ...
Epoch: 10 cost time: 0.781728982925415
Epoch: 10, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.503 Vali Acc: 0.611 Test Loss: 1.503 Test Acc: 0.611
Validation loss decreased (-0.574059 --> -0.611096).  Saving model ...
Epoch: 11 cost time: 1.0576446056365967
Epoch: 11, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.456 Vali Acc: 0.641 Test Loss: 1.456 Test Acc: 0.641
Validation loss decreased (-0.611096 --> -0.640726).  Saving model ...
Epoch: 12 cost time: 0.8110666275024414
Epoch: 12, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.402 Vali Acc: 0.659 Test Loss: 1.402 Test Acc: 0.659
Validation loss decreased (-0.640726 --> -0.659245).  Saving model ...
Epoch: 13 cost time: 0.8940997123718262
Epoch: 13, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.346 Vali Acc: 0.659 Test Loss: 1.346 Test Acc: 0.659
Validation loss decreased (-0.659245 --> -0.659246).  Saving model ...
Epoch: 14 cost time: 0.988295316696167
Epoch: 14, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.287 Vali Acc: 0.696 Test Loss: 1.287 Test Acc: 0.696
Validation loss decreased (-0.659246 --> -0.696283).  Saving model ...
Epoch: 15 cost time: 0.8314285278320312
Epoch: 15, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.226 Vali Acc: 0.711 Test Loss: 1.226 Test Acc: 0.711
Validation loss decreased (-0.696283 --> -0.711099).  Saving model ...
Epoch: 16 cost time: 0.798530101776123
Epoch: 16, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.167 Vali Acc: 0.759 Test Loss: 1.167 Test Acc: 0.759
Validation loss decreased (-0.711099 --> -0.759248).  Saving model ...
Epoch: 17 cost time: 0.8083794116973877
Epoch: 17, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.111 Vali Acc: 0.789 Test Loss: 1.111 Test Acc: 0.789
Validation loss decreased (-0.759248 --> -0.788878).  Saving model ...
Epoch: 18 cost time: 0.9658803939819336
Epoch: 18, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.059 Vali Acc: 0.807 Test Loss: 1.059 Test Acc: 0.807
Validation loss decreased (-0.788878 --> -0.807397).  Saving model ...
Epoch: 19 cost time: 0.8817217350006104
Epoch: 19, Steps: 2 | Train Loss: 0.987 Vali Loss: 1.010 Vali Acc: 0.841 Test Loss: 1.010 Test Acc: 0.841
Validation loss decreased (-0.807397 --> -0.840731).  Saving model ...
Epoch: 20 cost time: 1.0204496383666992
Epoch: 20, Steps: 2 | Train Loss: 0.946 Vali Loss: 0.964 Vali Acc: 0.830 Test Loss: 0.964 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9158110618591309
Epoch: 21, Steps: 2 | Train Loss: 0.894 Vali Loss: 0.920 Vali Acc: 0.833 Test Loss: 0.920 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8629882335662842
Epoch: 22, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.878 Vali Acc: 0.844 Test Loss: 0.878 Test Acc: 0.844
Validation loss decreased (-0.840731 --> -0.844436).  Saving model ...
Epoch: 23 cost time: 0.8018708229064941
Epoch: 23, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.839 Vali Acc: 0.856 Test Loss: 0.839 Test Acc: 0.856
Validation loss decreased (-0.844436 --> -0.855547).  Saving model ...
Epoch: 24 cost time: 0.7771854400634766
Epoch: 24, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.804 Vali Acc: 0.863 Test Loss: 0.804 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862955).  Saving model ...
Epoch: 25 cost time: 1.0092813968658447
Epoch: 25, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.772 Vali Acc: 0.878 Test Loss: 0.772 Test Acc: 0.878
Validation loss decreased (-0.862955 --> -0.877770).  Saving model ...
Epoch: 26 cost time: 0.8691611289978027
Epoch: 26, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.742 Vali Acc: 0.893 Test Loss: 0.742 Test Acc: 0.893
Validation loss decreased (-0.877770 --> -0.892585).  Saving model ...
Epoch: 27 cost time: 0.8184542655944824
Epoch: 27, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.718 Vali Acc: 0.900 Test Loss: 0.718 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 0.7448718547821045
Epoch: 28, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.699 Vali Acc: 0.893 Test Loss: 0.699 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7936794757843018
Epoch: 29, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.674 Vali Acc: 0.893 Test Loss: 0.674 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.1038751602172852
Epoch: 30, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.653 Vali Acc: 0.889 Test Loss: 0.653 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0438501834869385
Epoch: 31, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.634 Vali Acc: 0.893 Test Loss: 0.634 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9971716403961182
Epoch: 32, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.616 Vali Acc: 0.889 Test Loss: 0.616 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8616642951965332
Epoch: 33, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.599 Vali Acc: 0.885 Test Loss: 0.599 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7651066780090332
Epoch: 34, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.586 Vali Acc: 0.885 Test Loss: 0.586 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8535463809967041
Epoch: 35, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.574 Vali Acc: 0.881 Test Loss: 0.574 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8251972198486328
Epoch: 36, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.558 Vali Acc: 0.878 Test Loss: 0.558 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7852001190185547
Epoch: 37, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.542 Vali Acc: 0.874 Test Loss: 0.542 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 592886
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7001466751098633
Epoch: 1, Steps: 2 | Train Loss: 2.003 Vali Loss: 1.964 Vali Acc: 0.170 Test Loss: 1.964 Test Acc: 0.170
Validation loss decreased (inf --> -0.170351).  Saving model ...
Epoch: 2 cost time: 0.8212385177612305
Epoch: 2, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.936 Vali Acc: 0.170 Test Loss: 1.936 Test Acc: 0.170
Validation loss decreased (-0.170351 --> -0.170351).  Saving model ...
Epoch: 3 cost time: 0.9997975826263428
Epoch: 3, Steps: 2 | Train Loss: 1.931 Vali Loss: 1.909 Vali Acc: 0.170 Test Loss: 1.909 Test Acc: 0.170
Validation loss decreased (-0.170351 --> -0.170351).  Saving model ...
Epoch: 4 cost time: 0.7489793300628662
Epoch: 4, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.875 Vali Acc: 0.174 Test Loss: 1.875 Test Acc: 0.174
Validation loss decreased (-0.170351 --> -0.174055).  Saving model ...
Epoch: 5 cost time: 0.9290642738342285
Epoch: 5, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.836 Vali Acc: 0.193 Test Loss: 1.836 Test Acc: 0.193
Validation loss decreased (-0.174055 --> -0.192574).  Saving model ...
Epoch: 6 cost time: 0.8441901206970215
Epoch: 6, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.799 Vali Acc: 0.237 Test Loss: 1.799 Test Acc: 0.237
Validation loss decreased (-0.192574 --> -0.237019).  Saving model ...
Epoch: 7 cost time: 1.2045786380767822
Epoch: 7, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.764 Vali Acc: 0.259 Test Loss: 1.764 Test Acc: 0.259
Validation loss decreased (-0.237019 --> -0.259242).  Saving model ...
Epoch: 8 cost time: 0.9710464477539062
Epoch: 8, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.731 Vali Acc: 0.259 Test Loss: 1.731 Test Acc: 0.259
Validation loss decreased (-0.259242 --> -0.259242).  Saving model ...
Epoch: 9 cost time: 1.0707647800445557
Epoch: 9, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.699 Vali Acc: 0.256 Test Loss: 1.699 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0824620723724365
Epoch: 10, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.668 Vali Acc: 0.237 Test Loss: 1.668 Test Acc: 0.237
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0604958534240723
Epoch: 11, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.636 Vali Acc: 0.311 Test Loss: 1.636 Test Acc: 0.311
Validation loss decreased (-0.259242 --> -0.311095).  Saving model ...
Epoch: 12 cost time: 0.9373884201049805
Epoch: 12, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.601 Vali Acc: 0.374 Test Loss: 1.601 Test Acc: 0.374
Validation loss decreased (-0.311095 --> -0.374058).  Saving model ...
Epoch: 13 cost time: 0.889289140701294
Epoch: 13, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.558 Vali Acc: 0.507 Test Loss: 1.558 Test Acc: 0.507
Validation loss decreased (-0.374058 --> -0.507392).  Saving model ...
Epoch: 14 cost time: 0.9678287506103516
Epoch: 14, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.512 Vali Acc: 0.585 Test Loss: 1.512 Test Acc: 0.585
Validation loss decreased (-0.507392 --> -0.585170).  Saving model ...
Epoch: 15 cost time: 0.9028122425079346
Epoch: 15, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.461 Vali Acc: 0.630 Test Loss: 1.461 Test Acc: 0.630
Validation loss decreased (-0.585170 --> -0.629615).  Saving model ...
Epoch: 16 cost time: 0.8339834213256836
Epoch: 16, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.406 Vali Acc: 0.674 Test Loss: 1.406 Test Acc: 0.674
Validation loss decreased (-0.629615 --> -0.674060).  Saving model ...
Epoch: 17 cost time: 0.7399513721466064
Epoch: 17, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.348 Vali Acc: 0.685 Test Loss: 1.348 Test Acc: 0.685
Validation loss decreased (-0.674060 --> -0.685172).  Saving model ...
Epoch: 18 cost time: 1.0301024913787842
Epoch: 18, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.284 Vali Acc: 0.726 Test Loss: 1.284 Test Acc: 0.726
Validation loss decreased (-0.685172 --> -0.725913).  Saving model ...
Epoch: 19 cost time: 0.8171157836914062
Epoch: 19, Steps: 2 | Train Loss: 1.248 Vali Loss: 1.219 Vali Acc: 0.744 Test Loss: 1.219 Test Acc: 0.744
Validation loss decreased (-0.725913 --> -0.744432).  Saving model ...
Epoch: 20 cost time: 1.1437816619873047
Epoch: 20, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.153 Vali Acc: 0.800 Test Loss: 1.153 Test Acc: 0.800
Validation loss decreased (-0.744432 --> -0.799988).  Saving model ...
Epoch: 21 cost time: 0.8907301425933838
Epoch: 21, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.087 Vali Acc: 0.826 Test Loss: 1.087 Test Acc: 0.826
Validation loss decreased (-0.799988 --> -0.825915).  Saving model ...
Epoch: 22 cost time: 0.7940592765808105
Epoch: 22, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.028 Vali Acc: 0.856 Test Loss: 1.028 Test Acc: 0.856
Validation loss decreased (-0.825915 --> -0.855545).  Saving model ...
Epoch: 23 cost time: 0.7690927982330322
Epoch: 23, Steps: 2 | Train Loss: 0.894 Vali Loss: 0.973 Vali Acc: 0.859 Test Loss: 0.973 Test Acc: 0.859
Validation loss decreased (-0.855545 --> -0.859250).  Saving model ...
Epoch: 24 cost time: 0.8629863262176514
Epoch: 24, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.921 Vali Acc: 0.867 Test Loss: 0.921 Test Acc: 0.867
Validation loss decreased (-0.859250 --> -0.866657).  Saving model ...
Epoch: 25 cost time: 0.9133586883544922
Epoch: 25, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.875 Vali Acc: 0.874 Test Loss: 0.875 Test Acc: 0.874
Validation loss decreased (-0.866657 --> -0.874065).  Saving model ...
Epoch: 26 cost time: 0.9877331256866455
Epoch: 26, Steps: 2 | Train Loss: 0.765 Vali Loss: 0.831 Vali Acc: 0.878 Test Loss: 0.831 Test Acc: 0.878
Validation loss decreased (-0.874065 --> -0.877769).  Saving model ...
Epoch: 27 cost time: 0.9443416595458984
Epoch: 27, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.795 Vali Acc: 0.859 Test Loss: 0.795 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2316386699676514
Epoch: 28, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.759 Vali Acc: 0.859 Test Loss: 0.759 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.972693681716919
Epoch: 29, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.724 Vali Acc: 0.863 Test Loss: 0.724 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0062167644500732
Epoch: 30, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.692 Vali Acc: 0.881 Test Loss: 0.692 Test Acc: 0.881
Validation loss decreased (-0.877769 --> -0.881475).  Saving model ...
Epoch: 31 cost time: 0.8497860431671143
Epoch: 31, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.657 Vali Acc: 0.893 Test Loss: 0.657 Test Acc: 0.893
Validation loss decreased (-0.881475 --> -0.892586).  Saving model ...
Epoch: 32 cost time: 1.0355432033538818
Epoch: 32, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.626 Vali Acc: 0.911 Test Loss: 0.626 Test Acc: 0.911
Validation loss decreased (-0.892586 --> -0.911105).  Saving model ...
Epoch: 33 cost time: 0.9078788757324219
Epoch: 33, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.601 Vali Acc: 0.896 Test Loss: 0.601 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7720825672149658
Epoch: 34, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.580 Vali Acc: 0.889 Test Loss: 0.580 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7589528560638428
Epoch: 35, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.565 Vali Acc: 0.878 Test Loss: 0.565 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7403848171234131
Epoch: 36, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.550 Vali Acc: 0.907 Test Loss: 0.550 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7934303283691406
Epoch: 37, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.537 Vali Acc: 0.919 Test Loss: 0.537 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 38 cost time: 0.8581790924072266
Epoch: 38, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.527 Vali Acc: 0.915 Test Loss: 0.527 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7934422492980957
Epoch: 39, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.1519834995269775
Epoch: 40, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.508 Vali Acc: 0.893 Test Loss: 0.508 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7602400779724121
Epoch: 41, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.492 Vali Acc: 0.900 Test Loss: 0.492 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7856996059417725
Epoch: 42, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.473 Vali Acc: 0.919 Test Loss: 0.473 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 43 cost time: 0.7785179615020752
Epoch: 43, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.460 Vali Acc: 0.922 Test Loss: 0.460 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 44 cost time: 0.8733153343200684
Epoch: 44, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.451 Vali Acc: 0.922 Test Loss: 0.451 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 45 cost time: 0.9683539867401123
Epoch: 45, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.447 Vali Acc: 0.922 Test Loss: 0.447 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 46 cost time: 0.7261979579925537
Epoch: 46, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.436 Vali Acc: 0.933 Test Loss: 0.436 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933329).  Saving model ...
Epoch: 47 cost time: 0.74532151222229
Epoch: 47, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.425 Vali Acc: 0.930 Test Loss: 0.425 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8591172695159912
Epoch: 48, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.414 Vali Acc: 0.926 Test Loss: 0.414 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8257865905761719
Epoch: 49, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.408 Vali Acc: 0.933 Test Loss: 0.408 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 50 cost time: 1.0836982727050781
Epoch: 50, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.405 Vali Acc: 0.937 Test Loss: 0.405 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 51 cost time: 0.6892900466918945
Epoch: 51, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.403 Vali Acc: 0.937 Test Loss: 0.403 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 52 cost time: 1.2283058166503906
Epoch: 52, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.396 Vali Acc: 0.933 Test Loss: 0.396 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8333473205566406
Epoch: 53, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.389 Vali Acc: 0.933 Test Loss: 0.389 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7985222339630127
Epoch: 54, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.388 Vali Acc: 0.937 Test Loss: 0.388 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 55 cost time: 0.9700570106506348
Epoch: 55, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.390 Vali Acc: 0.933 Test Loss: 0.390 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.11006760597229
Epoch: 56, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.388 Vali Acc: 0.926 Test Loss: 0.388 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.92362380027771
Epoch: 57, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.383 Vali Acc: 0.926 Test Loss: 0.383 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.8767156600952148
Epoch: 58, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.375 Vali Acc: 0.926 Test Loss: 0.375 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.8894917964935303
Epoch: 59, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.367 Vali Acc: 0.926 Test Loss: 0.367 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.7430484294891357
Epoch: 60, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.360 Vali Acc: 0.930 Test Loss: 0.360 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 1.008791208267212
Epoch: 61, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.350 Vali Acc: 0.933 Test Loss: 0.350 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 1.157599925994873
Epoch: 62, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.344 Vali Acc: 0.941 Test Loss: 0.344 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 63 cost time: 0.9396560192108154
Epoch: 63, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.340 Vali Acc: 0.941 Test Loss: 0.340 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 64 cost time: 0.7032372951507568
Epoch: 64, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.340 Vali Acc: 0.944 Test Loss: 0.340 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 65 cost time: 0.877133846282959
Epoch: 65, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.343 Vali Acc: 0.937 Test Loss: 0.343 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.718559980392456
Epoch: 66, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.345 Vali Acc: 0.926 Test Loss: 0.345 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.8458161354064941
Epoch: 67, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.347 Vali Acc: 0.919 Test Loss: 0.347 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.7813770771026611
Epoch: 68, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.9757125377655029
Epoch: 69, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.329 Vali Acc: 0.930 Test Loss: 0.329 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.0471131801605225
Epoch: 70, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.312 Vali Acc: 0.948 Test Loss: 0.312 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 71 cost time: 1.0800211429595947
Epoch: 71, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.304 Vali Acc: 0.952 Test Loss: 0.304 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 72 cost time: 0.9257221221923828
Epoch: 72, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.301 Vali Acc: 0.956 Test Loss: 0.301 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 73 cost time: 0.7441802024841309
Epoch: 73, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.303 Vali Acc: 0.952 Test Loss: 0.303 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.9382734298706055
Epoch: 74, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 1.136826753616333
Epoch: 75, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.9474666118621826
Epoch: 76, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.7716827392578125
Epoch: 77, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.313 Vali Acc: 0.933 Test Loss: 0.313 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.866243839263916
Epoch: 78, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.298 Vali Acc: 0.948 Test Loss: 0.298 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.7374062538146973
Epoch: 79, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.288 Vali Acc: 0.952 Test Loss: 0.288 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 1.2333052158355713
Epoch: 80, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.285 Vali Acc: 0.948 Test Loss: 0.285 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.8144979476928711
Epoch: 81, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.289 Vali Acc: 0.944 Test Loss: 0.289 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.9010968208312988
Epoch: 82, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 592534
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.481544017791748
Epoch: 1, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.815 Vali Acc: 0.148 Test Loss: 1.815 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 1.0094261169433594
Epoch: 2, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.800 Vali Acc: 0.159 Test Loss: 1.800 Test Acc: 0.159
Validation loss decreased (-0.148130 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 0.9074234962463379
Epoch: 3, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.784 Vali Acc: 0.178 Test Loss: 1.784 Test Acc: 0.178
Validation loss decreased (-0.159241 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 0.9797170162200928
Epoch: 4, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.761 Vali Acc: 0.189 Test Loss: 1.761 Test Acc: 0.189
Validation loss decreased (-0.177760 --> -0.188871).  Saving model ...
Epoch: 5 cost time: 0.9971413612365723
Epoch: 5, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.733 Vali Acc: 0.233 Test Loss: 1.733 Test Acc: 0.233
Validation loss decreased (-0.188871 --> -0.233316).  Saving model ...
Epoch: 6 cost time: 0.9763071537017822
Epoch: 6, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.702 Vali Acc: 0.296 Test Loss: 1.702 Test Acc: 0.296
Validation loss decreased (-0.233316 --> -0.296279).  Saving model ...
Epoch: 7 cost time: 0.8121578693389893
Epoch: 7, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.670 Vali Acc: 0.319 Test Loss: 1.670 Test Acc: 0.319
Validation loss decreased (-0.296279 --> -0.318502).  Saving model ...
Epoch: 8 cost time: 0.880913496017456
Epoch: 8, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.636 Vali Acc: 0.367 Test Loss: 1.636 Test Acc: 0.367
Validation loss decreased (-0.318502 --> -0.366650).  Saving model ...
Epoch: 9 cost time: 0.8051698207855225
Epoch: 9, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.600 Vali Acc: 0.419 Test Loss: 1.600 Test Acc: 0.419
Validation loss decreased (-0.366650 --> -0.418503).  Saving model ...
Epoch: 10 cost time: 1.0208461284637451
Epoch: 10, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.562 Vali Acc: 0.481 Test Loss: 1.562 Test Acc: 0.481
Validation loss decreased (-0.418503 --> -0.481466).  Saving model ...
Epoch: 11 cost time: 0.7943766117095947
Epoch: 11, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.522 Vali Acc: 0.567 Test Loss: 1.522 Test Acc: 0.567
Validation loss decreased (-0.481466 --> -0.566651).  Saving model ...
Epoch: 12 cost time: 0.8916852474212646
Epoch: 12, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.479 Vali Acc: 0.637 Test Loss: 1.479 Test Acc: 0.637
Validation loss decreased (-0.566651 --> -0.637022).  Saving model ...
Epoch: 13 cost time: 0.8581020832061768
Epoch: 13, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.433 Vali Acc: 0.678 Test Loss: 1.433 Test Acc: 0.678
Validation loss decreased (-0.637022 --> -0.677763).  Saving model ...
Epoch: 14 cost time: 1.0268657207489014
Epoch: 14, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.384 Vali Acc: 0.719 Test Loss: 1.384 Test Acc: 0.719
Validation loss decreased (-0.677763 --> -0.718505).  Saving model ...
Epoch: 15 cost time: 0.9644761085510254
Epoch: 15, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.333 Vali Acc: 0.748 Test Loss: 1.333 Test Acc: 0.748
Validation loss decreased (-0.718505 --> -0.748135).  Saving model ...
Epoch: 16 cost time: 0.8502688407897949
Epoch: 16, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.279 Vali Acc: 0.781 Test Loss: 1.279 Test Acc: 0.781
Validation loss decreased (-0.748135 --> -0.781469).  Saving model ...
Epoch: 17 cost time: 1.2885620594024658
Epoch: 17, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.221 Vali Acc: 0.796 Test Loss: 1.221 Test Acc: 0.796
Validation loss decreased (-0.781469 --> -0.796284).  Saving model ...
Epoch: 18 cost time: 0.7698161602020264
Epoch: 18, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.161 Vali Acc: 0.819 Test Loss: 1.161 Test Acc: 0.819
Validation loss decreased (-0.796284 --> -0.818507).  Saving model ...
Epoch: 19 cost time: 0.9078845977783203
Epoch: 19, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.100 Vali Acc: 0.822 Test Loss: 1.100 Test Acc: 0.822
Validation loss decreased (-0.818507 --> -0.822211).  Saving model ...
Epoch: 20 cost time: 0.9808332920074463
Epoch: 20, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.040 Vali Acc: 0.833 Test Loss: 1.040 Test Acc: 0.833
Validation loss decreased (-0.822211 --> -0.833323).  Saving model ...
Epoch: 21 cost time: 0.8688724040985107
Epoch: 21, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.983 Vali Acc: 0.837 Test Loss: 0.983 Test Acc: 0.837
Validation loss decreased (-0.833323 --> -0.837027).  Saving model ...
Epoch: 22 cost time: 0.9414544105529785
Epoch: 22, Steps: 2 | Train Loss: 0.857 Vali Loss: 0.929 Vali Acc: 0.852 Test Loss: 0.929 Test Acc: 0.852
Validation loss decreased (-0.837027 --> -0.851843).  Saving model ...
Epoch: 23 cost time: 1.118251085281372
Epoch: 23, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.881 Vali Acc: 0.859 Test Loss: 0.881 Test Acc: 0.859
Validation loss decreased (-0.851843 --> -0.859250).  Saving model ...
Epoch: 24 cost time: 0.9129331111907959
Epoch: 24, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.837 Vali Acc: 0.856 Test Loss: 0.837 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9770224094390869
Epoch: 25, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.797 Vali Acc: 0.863 Test Loss: 0.797 Test Acc: 0.863
Validation loss decreased (-0.859250 --> -0.862955).  Saving model ...
Epoch: 26 cost time: 1.0544929504394531
Epoch: 26, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.763 Vali Acc: 0.856 Test Loss: 0.763 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.12941312789917
Epoch: 27, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.731 Vali Acc: 0.878 Test Loss: 0.731 Test Acc: 0.878
Validation loss decreased (-0.862955 --> -0.877770).  Saving model ...
Epoch: 28 cost time: 0.9861640930175781
Epoch: 28, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.702 Vali Acc: 0.893 Test Loss: 0.702 Test Acc: 0.893
Validation loss decreased (-0.877770 --> -0.892586).  Saving model ...
Epoch: 29 cost time: 0.7777633666992188
Epoch: 29, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.678 Vali Acc: 0.889 Test Loss: 0.678 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9019603729248047
Epoch: 30, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.655 Vali Acc: 0.893 Test Loss: 0.655 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 31 cost time: 0.8364303112030029
Epoch: 31, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.636 Vali Acc: 0.900 Test Loss: 0.636 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899994).  Saving model ...
Epoch: 32 cost time: 1.0676820278167725
Epoch: 32, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.616 Vali Acc: 0.904 Test Loss: 0.616 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 33 cost time: 0.8556866645812988
Epoch: 33, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.595 Vali Acc: 0.904 Test Loss: 0.595 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 34 cost time: 0.8082308769226074
Epoch: 34, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.575 Vali Acc: 0.904 Test Loss: 0.575 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 35 cost time: 0.9169819355010986
Epoch: 35, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.560 Vali Acc: 0.904 Test Loss: 0.560 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 36 cost time: 0.9521007537841797
Epoch: 36, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.545 Vali Acc: 0.904 Test Loss: 0.545 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 37 cost time: 1.0001449584960938
Epoch: 37, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.528 Vali Acc: 0.904 Test Loss: 0.528 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 38 cost time: 0.927156925201416
Epoch: 38, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.509 Vali Acc: 0.900 Test Loss: 0.509 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7247662544250488
Epoch: 39, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.493 Vali Acc: 0.911 Test Loss: 0.493 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 40 cost time: 0.727313756942749
Epoch: 40, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.481 Vali Acc: 0.919 Test Loss: 0.481 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 41 cost time: 0.7890434265136719
Epoch: 41, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.474 Vali Acc: 0.915 Test Loss: 0.474 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1611127853393555
Epoch: 42, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.467 Vali Acc: 0.915 Test Loss: 0.467 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.1636900901794434
Epoch: 43, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.463 Vali Acc: 0.915 Test Loss: 0.463 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.115455150604248
Epoch: 44, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.456 Vali Acc: 0.907 Test Loss: 0.456 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8181796073913574
Epoch: 45, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.444 Vali Acc: 0.911 Test Loss: 0.444 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9237537384033203
Epoch: 46, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.438 Vali Acc: 0.911 Test Loss: 0.438 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8187990188598633
Epoch: 47, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.432 Vali Acc: 0.915 Test Loss: 0.432 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.1262094974517822
Epoch: 48, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.425 Vali Acc: 0.919 Test Loss: 0.425 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 49 cost time: 1.2953550815582275
Epoch: 49, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.423 Vali Acc: 0.911 Test Loss: 0.423 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9401695728302002
Epoch: 50, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.424 Vali Acc: 0.915 Test Loss: 0.424 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.1285717487335205
Epoch: 51, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.411 Vali Acc: 0.915 Test Loss: 0.411 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.040745496749878
Epoch: 52, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.402 Vali Acc: 0.915 Test Loss: 0.402 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.9664618968963623
Epoch: 53, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.398 Vali Acc: 0.922 Test Loss: 0.398 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 54 cost time: 0.8197672367095947
Epoch: 54, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.397 Vali Acc: 0.919 Test Loss: 0.397 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8811287879943848
Epoch: 55, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.390 Vali Acc: 0.919 Test Loss: 0.390 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 1.1215829849243164
Epoch: 56, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.391 Vali Acc: 0.907 Test Loss: 0.391 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.9726877212524414
Epoch: 57, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.393 Vali Acc: 0.904 Test Loss: 0.393 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.9719858169555664
Epoch: 58, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.388 Vali Acc: 0.907 Test Loss: 0.388 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.9120619297027588
Epoch: 59, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.380 Vali Acc: 0.900 Test Loss: 0.380 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.9955885410308838
Epoch: 60, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.370 Vali Acc: 0.911 Test Loss: 0.370 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 1.0317888259887695
Epoch: 61, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.362 Vali Acc: 0.922 Test Loss: 0.362 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 62 cost time: 1.1255934238433838
Epoch: 62, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.361 Vali Acc: 0.915 Test Loss: 0.361 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7908141613006592
Epoch: 63, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.364 Vali Acc: 0.919 Test Loss: 0.364 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.9528074264526367
Epoch: 64, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.360 Vali Acc: 0.919 Test Loss: 0.360 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.8130261898040771
Epoch: 65, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 66 cost time: 0.9809701442718506
Epoch: 66, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.356 Vali Acc: 0.922 Test Loss: 0.356 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 67 cost time: 0.7489535808563232
Epoch: 67, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.354 Vali Acc: 0.926 Test Loss: 0.354 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925922).  Saving model ...
Epoch: 68 cost time: 0.9562649726867676
Epoch: 68, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.347 Vali Acc: 0.926 Test Loss: 0.347 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 69 cost time: 0.8256125450134277
Epoch: 69, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.337 Vali Acc: 0.926 Test Loss: 0.337 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 70 cost time: 0.7700481414794922
Epoch: 70, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.330 Vali Acc: 0.937 Test Loss: 0.330 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937034).  Saving model ...
Epoch: 71 cost time: 0.9056575298309326
Epoch: 71, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 1.1368768215179443
Epoch: 72, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 1.0598530769348145
Epoch: 73, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.327 Vali Acc: 0.926 Test Loss: 0.327 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.9823658466339111
Epoch: 74, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.335 Vali Acc: 0.915 Test Loss: 0.335 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.7309553623199463
Epoch: 75, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.335 Vali Acc: 0.911 Test Loss: 0.335 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.9367413520812988
Epoch: 76, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.334 Vali Acc: 0.922 Test Loss: 0.334 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.9196207523345947
Epoch: 77, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.335 Vali Acc: 0.922 Test Loss: 0.335 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.7531130313873291
Epoch: 78, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.816443920135498
Epoch: 79, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 80 cost time: 1.079859733581543
Epoch: 80, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.325 Vali Acc: 0.922 Test Loss: 0.325 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 592182
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.881894826889038
Epoch: 1, Steps: 2 | Train Loss: 1.982 Vali Loss: 1.908 Vali Acc: 0.126 Test Loss: 1.908 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 1.0113577842712402
Epoch: 2, Steps: 2 | Train Loss: 1.944 Vali Loss: 1.885 Vali Acc: 0.122 Test Loss: 1.885 Test Acc: 0.122
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9136285781860352
Epoch: 3, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.861 Vali Acc: 0.119 Test Loss: 1.861 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9002091884613037
Epoch: 4, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.826 Vali Acc: 0.104 Test Loss: 1.826 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7560551166534424
Epoch: 5, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.787 Vali Acc: 0.130 Test Loss: 1.787 Test Acc: 0.130
Validation loss decreased (-0.125907 --> -0.129612).  Saving model ...
Epoch: 6 cost time: 0.922722578048706
Epoch: 6, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.747 Vali Acc: 0.174 Test Loss: 1.747 Test Acc: 0.174
Validation loss decreased (-0.129612 --> -0.174057).  Saving model ...
Epoch: 7 cost time: 0.7822864055633545
Epoch: 7, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.710 Vali Acc: 0.319 Test Loss: 1.710 Test Acc: 0.319
Validation loss decreased (-0.174057 --> -0.318501).  Saving model ...
Epoch: 8 cost time: 1.3357923030853271
Epoch: 8, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.677 Vali Acc: 0.378 Test Loss: 1.677 Test Acc: 0.378
Validation loss decreased (-0.318501 --> -0.377761).  Saving model ...
Epoch: 9 cost time: 0.923637866973877
Epoch: 9, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.645 Vali Acc: 0.411 Test Loss: 1.645 Test Acc: 0.411
Validation loss decreased (-0.377761 --> -0.411095).  Saving model ...
Epoch: 10 cost time: 0.8418538570404053
Epoch: 10, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.613 Vali Acc: 0.456 Test Loss: 1.613 Test Acc: 0.456
Validation loss decreased (-0.411095 --> -0.455539).  Saving model ...
Epoch: 11 cost time: 0.8486120700836182
Epoch: 11, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.578 Vali Acc: 0.493 Test Loss: 1.578 Test Acc: 0.493
Validation loss decreased (-0.455539 --> -0.492577).  Saving model ...
Epoch: 12 cost time: 0.9404740333557129
Epoch: 12, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.538 Vali Acc: 0.511 Test Loss: 1.538 Test Acc: 0.511
Validation loss decreased (-0.492577 --> -0.511096).  Saving model ...
Epoch: 13 cost time: 0.9794495105743408
Epoch: 13, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.492 Vali Acc: 0.570 Test Loss: 1.492 Test Acc: 0.570
Validation loss decreased (-0.511096 --> -0.570355).  Saving model ...
Epoch: 14 cost time: 1.0695364475250244
Epoch: 14, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.440 Vali Acc: 0.641 Test Loss: 1.440 Test Acc: 0.641
Validation loss decreased (-0.570355 --> -0.640726).  Saving model ...
Epoch: 15 cost time: 0.7668323516845703
Epoch: 15, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.384 Vali Acc: 0.748 Test Loss: 1.384 Test Acc: 0.748
Validation loss decreased (-0.640726 --> -0.748134).  Saving model ...
Epoch: 16 cost time: 0.7950625419616699
Epoch: 16, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.324 Vali Acc: 0.767 Test Loss: 1.324 Test Acc: 0.767
Validation loss decreased (-0.748134 --> -0.766653).  Saving model ...
Epoch: 17 cost time: 0.756403923034668
Epoch: 17, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.262 Vali Acc: 0.796 Test Loss: 1.262 Test Acc: 0.796
Validation loss decreased (-0.766653 --> -0.796284).  Saving model ...
Epoch: 18 cost time: 0.8150970935821533
Epoch: 18, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.200 Vali Acc: 0.793 Test Loss: 1.200 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8786060810089111
Epoch: 19, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.139 Vali Acc: 0.789 Test Loss: 1.139 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7251310348510742
Epoch: 20, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.077 Vali Acc: 0.793 Test Loss: 1.077 Test Acc: 0.793
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9318456649780273
Epoch: 21, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.019 Vali Acc: 0.800 Test Loss: 1.019 Test Acc: 0.800
Validation loss decreased (-0.796284 --> -0.799990).  Saving model ...
Epoch: 22 cost time: 0.82802414894104
Epoch: 22, Steps: 2 | Train Loss: 0.983 Vali Loss: 0.964 Vali Acc: 0.815 Test Loss: 0.964 Test Acc: 0.815
Validation loss decreased (-0.799990 --> -0.814805).  Saving model ...
Epoch: 23 cost time: 0.7286891937255859
Epoch: 23, Steps: 2 | Train Loss: 0.957 Vali Loss: 0.913 Vali Acc: 0.841 Test Loss: 0.913 Test Acc: 0.841
Validation loss decreased (-0.814805 --> -0.840732).  Saving model ...
Epoch: 24 cost time: 0.9257779121398926
Epoch: 24, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.867 Vali Acc: 0.841 Test Loss: 0.867 Test Acc: 0.841
Validation loss decreased (-0.840732 --> -0.840732).  Saving model ...
Epoch: 25 cost time: 0.9030437469482422
Epoch: 25, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.825 Vali Acc: 0.841 Test Loss: 0.825 Test Acc: 0.841
Validation loss decreased (-0.840732 --> -0.840732).  Saving model ...
Epoch: 26 cost time: 0.9993817806243896
Epoch: 26, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.786 Vali Acc: 0.859 Test Loss: 0.786 Test Acc: 0.859
Validation loss decreased (-0.840732 --> -0.859251).  Saving model ...
Epoch: 27 cost time: 0.803016185760498
Epoch: 27, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.750 Vali Acc: 0.870 Test Loss: 0.750 Test Acc: 0.870
Validation loss decreased (-0.859251 --> -0.870363).  Saving model ...
Epoch: 28 cost time: 0.8661141395568848
Epoch: 28, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.718 Vali Acc: 0.878 Test Loss: 0.718 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 29 cost time: 0.8336234092712402
Epoch: 29, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.687 Vali Acc: 0.896 Test Loss: 0.687 Test Acc: 0.896
Validation loss decreased (-0.877771 --> -0.896289).  Saving model ...
Epoch: 30 cost time: 0.7417142391204834
Epoch: 30, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.658 Vali Acc: 0.911 Test Loss: 0.658 Test Acc: 0.911
Validation loss decreased (-0.896289 --> -0.911105).  Saving model ...
Epoch: 31 cost time: 0.8303666114807129
Epoch: 31, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.631 Vali Acc: 0.907 Test Loss: 0.631 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8984124660491943
Epoch: 32, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.608 Vali Acc: 0.911 Test Loss: 0.608 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 33 cost time: 0.7979679107666016
Epoch: 33, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.587 Vali Acc: 0.919 Test Loss: 0.587 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 34 cost time: 0.9941484928131104
Epoch: 34, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.569 Vali Acc: 0.919 Test Loss: 0.569 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 35 cost time: 0.8275759220123291
Epoch: 35, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.551 Vali Acc: 0.922 Test Loss: 0.551 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 36 cost time: 0.7523901462554932
Epoch: 36, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.535 Vali Acc: 0.922 Test Loss: 0.535 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 37 cost time: 0.8599317073822021
Epoch: 37, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.520 Vali Acc: 0.926 Test Loss: 0.520 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 38 cost time: 0.854748010635376
Epoch: 38, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.506 Vali Acc: 0.922 Test Loss: 0.506 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9868950843811035
Epoch: 39, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.493 Vali Acc: 0.922 Test Loss: 0.493 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9450583457946777
Epoch: 40, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.481 Vali Acc: 0.922 Test Loss: 0.481 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0074677467346191
Epoch: 41, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.469 Vali Acc: 0.919 Test Loss: 0.469 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8799607753753662
Epoch: 42, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.459 Vali Acc: 0.922 Test Loss: 0.459 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8750412464141846
Epoch: 43, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.447 Vali Acc: 0.926 Test Loss: 0.447 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 44 cost time: 0.8228850364685059
Epoch: 44, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.438 Vali Acc: 0.930 Test Loss: 0.438 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 45 cost time: 0.9253616333007812
Epoch: 45, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.427 Vali Acc: 0.926 Test Loss: 0.427 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.85819411277771
Epoch: 46, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.414 Vali Acc: 0.922 Test Loss: 0.414 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7378058433532715
Epoch: 47, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.404 Vali Acc: 0.915 Test Loss: 0.404 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.7587919235229492
Epoch: 48, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.400 Vali Acc: 0.907 Test Loss: 0.400 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7464220523834229
Epoch: 49, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.395 Vali Acc: 0.904 Test Loss: 0.395 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.8729660511016846
Epoch: 50, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.387 Vali Acc: 0.904 Test Loss: 0.387 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.9465065002441406
Epoch: 51, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.381 Vali Acc: 0.915 Test Loss: 0.381 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.8777577877044678
Epoch: 52, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.380 Vali Acc: 0.922 Test Loss: 0.380 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.7811176776885986
Epoch: 53, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.373 Vali Acc: 0.922 Test Loss: 0.373 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.9655313491821289
Epoch: 54, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 591830
model size : 3.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4421586990356445
Epoch: 1, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.871 Vali Acc: 0.167 Test Loss: 1.871 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.819556474685669
Epoch: 2, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.847 Vali Acc: 0.167 Test Loss: 1.847 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 1.0606234073638916
Epoch: 3, Steps: 2 | Train Loss: 1.959 Vali Loss: 1.830 Vali Acc: 0.167 Test Loss: 1.830 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 4 cost time: 0.8336882591247559
Epoch: 4, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.810 Vali Acc: 0.167 Test Loss: 1.810 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166649).  Saving model ...
Epoch: 5 cost time: 1.023676872253418
Epoch: 5, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.786 Vali Acc: 0.167 Test Loss: 1.786 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 0.8701894283294678
Epoch: 6, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.763 Vali Acc: 0.170 Test Loss: 1.763 Test Acc: 0.170
Validation loss decreased (-0.166649 --> -0.170353).  Saving model ...
Epoch: 7 cost time: 0.8953983783721924
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.742 Vali Acc: 0.226 Test Loss: 1.742 Test Acc: 0.226
Validation loss decreased (-0.170353 --> -0.225909).  Saving model ...
Epoch: 8 cost time: 0.926722526550293
Epoch: 8, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.721 Vali Acc: 0.278 Test Loss: 1.721 Test Acc: 0.278
Validation loss decreased (-0.225909 --> -0.277761).  Saving model ...
Epoch: 9 cost time: 0.759026050567627
Epoch: 9, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.702 Vali Acc: 0.311 Test Loss: 1.702 Test Acc: 0.311
Validation loss decreased (-0.277761 --> -0.311094).  Saving model ...
Epoch: 10 cost time: 0.9093179702758789
Epoch: 10, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.683 Vali Acc: 0.481 Test Loss: 1.683 Test Acc: 0.481
Validation loss decreased (-0.311094 --> -0.481465).  Saving model ...
Epoch: 11 cost time: 0.9017035961151123
Epoch: 11, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.664 Vali Acc: 0.530 Test Loss: 1.664 Test Acc: 0.530
Validation loss decreased (-0.481465 --> -0.529613).  Saving model ...
Epoch: 12 cost time: 0.713996171951294
Epoch: 12, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.646 Vali Acc: 0.533 Test Loss: 1.646 Test Acc: 0.533
Validation loss decreased (-0.529613 --> -0.533317).  Saving model ...
Epoch: 13 cost time: 0.8258295059204102
Epoch: 13, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.626 Vali Acc: 0.563 Test Loss: 1.626 Test Acc: 0.563
Validation loss decreased (-0.533317 --> -0.562947).  Saving model ...
Epoch: 14 cost time: 0.9601900577545166
Epoch: 14, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.603 Vali Acc: 0.574 Test Loss: 1.603 Test Acc: 0.574
Validation loss decreased (-0.562947 --> -0.574058).  Saving model ...
Epoch: 15 cost time: 0.8316254615783691
Epoch: 15, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.575 Vali Acc: 0.596 Test Loss: 1.575 Test Acc: 0.596
Validation loss decreased (-0.574058 --> -0.596281).  Saving model ...
Epoch: 16 cost time: 0.9016814231872559
Epoch: 16, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.544 Vali Acc: 0.615 Test Loss: 1.544 Test Acc: 0.615
Validation loss decreased (-0.596281 --> -0.614799).  Saving model ...
Epoch: 17 cost time: 0.9078783988952637
Epoch: 17, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.509 Vali Acc: 0.630 Test Loss: 1.509 Test Acc: 0.630
Validation loss decreased (-0.614799 --> -0.629615).  Saving model ...
Epoch: 18 cost time: 0.7657527923583984
Epoch: 18, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.471 Vali Acc: 0.656 Test Loss: 1.471 Test Acc: 0.656
Validation loss decreased (-0.629615 --> -0.655541).  Saving model ...
Epoch: 19 cost time: 0.8567678928375244
Epoch: 19, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.429 Vali Acc: 0.667 Test Loss: 1.429 Test Acc: 0.667
Validation loss decreased (-0.655541 --> -0.666652).  Saving model ...
Epoch: 20 cost time: 1.030625820159912
Epoch: 20, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.384 Vali Acc: 0.700 Test Loss: 1.384 Test Acc: 0.700
Validation loss decreased (-0.666652 --> -0.699986).  Saving model ...
Epoch: 21 cost time: 0.7406570911407471
Epoch: 21, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.336 Vali Acc: 0.719 Test Loss: 1.336 Test Acc: 0.719
Validation loss decreased (-0.699986 --> -0.718505).  Saving model ...
Epoch: 22 cost time: 0.8600473403930664
Epoch: 22, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.285 Vali Acc: 0.759 Test Loss: 1.285 Test Acc: 0.759
Validation loss decreased (-0.718505 --> -0.759246).  Saving model ...
Epoch: 23 cost time: 1.0100576877593994
Epoch: 23, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.232 Vali Acc: 0.796 Test Loss: 1.232 Test Acc: 0.796
Validation loss decreased (-0.759246 --> -0.796284).  Saving model ...
Epoch: 24 cost time: 0.8446030616760254
Epoch: 24, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.177 Vali Acc: 0.811 Test Loss: 1.177 Test Acc: 0.811
Validation loss decreased (-0.796284 --> -0.811099).  Saving model ...
Epoch: 25 cost time: 0.8218975067138672
Epoch: 25, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.122 Vali Acc: 0.822 Test Loss: 1.122 Test Acc: 0.822
Validation loss decreased (-0.811099 --> -0.822211).  Saving model ...
Epoch: 26 cost time: 0.7505013942718506
Epoch: 26, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.068 Vali Acc: 0.819 Test Loss: 1.068 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8129825592041016
Epoch: 27, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.019 Vali Acc: 0.815 Test Loss: 1.019 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1598868370056152
Epoch: 28, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.971 Vali Acc: 0.819 Test Loss: 0.971 Test Acc: 0.819
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9410359859466553
Epoch: 29, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.927 Vali Acc: 0.833 Test Loss: 0.927 Test Acc: 0.833
Validation loss decreased (-0.822211 --> -0.833324).  Saving model ...
Epoch: 30 cost time: 0.8034055233001709
Epoch: 30, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.886 Vali Acc: 0.830 Test Loss: 0.886 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8847296237945557
Epoch: 31, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.848 Vali Acc: 0.833 Test Loss: 0.848 Test Acc: 0.833
Validation loss decreased (-0.833324 --> -0.833325).  Saving model ...
Epoch: 32 cost time: 0.8043990135192871
Epoch: 32, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.813 Vali Acc: 0.848 Test Loss: 0.813 Test Acc: 0.848
Validation loss decreased (-0.833325 --> -0.848140).  Saving model ...
Epoch: 33 cost time: 0.9587299823760986
Epoch: 33, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.780 Vali Acc: 0.844 Test Loss: 0.780 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.9271931648254395
Epoch: 34, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.750 Vali Acc: 0.837 Test Loss: 0.750 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7974169254302979
Epoch: 35, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.723 Vali Acc: 0.844 Test Loss: 0.723 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8552098274230957
Epoch: 36, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.697 Vali Acc: 0.844 Test Loss: 0.697 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7800240516662598
Epoch: 37, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.674 Vali Acc: 0.852 Test Loss: 0.674 Test Acc: 0.852
Validation loss decreased (-0.848140 --> -0.851845).  Saving model ...
Epoch: 38 cost time: 0.8341379165649414
Epoch: 38, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.652 Vali Acc: 0.848 Test Loss: 0.652 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9927098751068115
Epoch: 39, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.631 Vali Acc: 0.852 Test Loss: 0.631 Test Acc: 0.852
Validation loss decreased (-0.851845 --> -0.851846).  Saving model ...
Epoch: 40 cost time: 0.9027421474456787
Epoch: 40, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.612 Vali Acc: 0.852 Test Loss: 0.612 Test Acc: 0.852
Validation loss decreased (-0.851846 --> -0.851846).  Saving model ...
Epoch: 41 cost time: 0.7730157375335693
Epoch: 41, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.593 Vali Acc: 0.856 Test Loss: 0.593 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 42 cost time: 0.7351028919219971
Epoch: 42, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.575 Vali Acc: 0.863 Test Loss: 0.575 Test Acc: 0.863
Validation loss decreased (-0.855550 --> -0.862957).  Saving model ...
Epoch: 43 cost time: 0.7599465847015381
Epoch: 43, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.557 Vali Acc: 0.863 Test Loss: 0.557 Test Acc: 0.863
Validation loss decreased (-0.862957 --> -0.862957).  Saving model ...
Epoch: 44 cost time: 0.6620349884033203
Epoch: 44, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.543 Vali Acc: 0.870 Test Loss: 0.543 Test Acc: 0.870
Validation loss decreased (-0.862957 --> -0.870365).  Saving model ...
Epoch: 45 cost time: 0.8192627429962158
Epoch: 45, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.530 Vali Acc: 0.870 Test Loss: 0.530 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 46 cost time: 0.7809882164001465
Epoch: 46, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.518 Vali Acc: 0.867 Test Loss: 0.518 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.8108887672424316
Epoch: 47, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.509 Vali Acc: 0.870 Test Loss: 0.509 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 48 cost time: 0.9615464210510254
Epoch: 48, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.501 Vali Acc: 0.874 Test Loss: 0.501 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 49 cost time: 0.8248016834259033
Epoch: 49, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.490 Vali Acc: 0.881 Test Loss: 0.490 Test Acc: 0.881
Validation loss decreased (-0.874069 --> -0.881477).  Saving model ...
Epoch: 50 cost time: 1.0081369876861572
Epoch: 50, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.479 Vali Acc: 0.881 Test Loss: 0.479 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 51 cost time: 0.8411965370178223
Epoch: 51, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.470 Vali Acc: 0.878 Test Loss: 0.470 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8578372001647949
Epoch: 52, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.460 Vali Acc: 0.874 Test Loss: 0.460 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.1672673225402832
Epoch: 53, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.453 Vali Acc: 0.878 Test Loss: 0.453 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.0206665992736816
Epoch: 54, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.446 Vali Acc: 0.878 Test Loss: 0.446 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.7567188739776611
Epoch: 55, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.438 Vali Acc: 0.874 Test Loss: 0.438 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.7626359462738037
Epoch: 56, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.431 Vali Acc: 0.881 Test Loss: 0.431 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 57 cost time: 0.7920975685119629
Epoch: 57, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.424 Vali Acc: 0.881 Test Loss: 0.424 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 58 cost time: 0.8005197048187256
Epoch: 58, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.415 Vali Acc: 0.885 Test Loss: 0.415 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885181).  Saving model ...
Epoch: 59 cost time: 0.758699893951416
Epoch: 59, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
Validation loss decreased (-0.885181 --> -0.888885).  Saving model ...
Epoch: 60 cost time: 0.9468066692352295
Epoch: 60, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.402 Vali Acc: 0.889 Test Loss: 0.402 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 61 cost time: 0.8826701641082764
Epoch: 61, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.397 Vali Acc: 0.889 Test Loss: 0.397 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 62 cost time: 0.7232074737548828
Epoch: 62, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.392 Vali Acc: 0.889 Test Loss: 0.392 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 63 cost time: 1.1809329986572266
Epoch: 63, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888885).  Saving model ...
Epoch: 64 cost time: 0.8623883724212646
Epoch: 64, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.383 Vali Acc: 0.893 Test Loss: 0.383 Test Acc: 0.893
Validation loss decreased (-0.888885 --> -0.892589).  Saving model ...
Epoch: 65 cost time: 1.1636226177215576
Epoch: 65, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.380 Vali Acc: 0.885 Test Loss: 0.380 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 1.0105259418487549
Epoch: 66, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.377 Vali Acc: 0.885 Test Loss: 0.377 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 1.1242420673370361
Epoch: 67, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.376 Vali Acc: 0.885 Test Loss: 0.376 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 1.224628210067749
Epoch: 68, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.375 Vali Acc: 0.889 Test Loss: 0.375 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 1.1402621269226074
Epoch: 69, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.376 Vali Acc: 0.889 Test Loss: 0.376 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 1.061126470565796
Epoch: 70, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.375 Vali Acc: 0.885 Test Loss: 0.375 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.9912707805633545
Epoch: 71, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.369 Vali Acc: 0.889 Test Loss: 0.369 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.9675707817077637
Epoch: 72, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.363 Vali Acc: 0.896 Test Loss: 0.363 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 73 cost time: 1.050635814666748
Epoch: 73, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.359 Vali Acc: 0.896 Test Loss: 0.359 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 74 cost time: 1.172849178314209
Epoch: 74, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.354 Vali Acc: 0.896 Test Loss: 0.354 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 75 cost time: 0.8831968307495117
Epoch: 75, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.348 Vali Acc: 0.893 Test Loss: 0.348 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 1.1615734100341797
Epoch: 76, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.342 Vali Acc: 0.893 Test Loss: 0.342 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 1.0373928546905518
Epoch: 77, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.338 Vali Acc: 0.893 Test Loss: 0.338 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 1.150446891784668
Epoch: 78, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.336 Vali Acc: 0.893 Test Loss: 0.336 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.1618854999542236
Epoch: 79, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.334 Vali Acc: 0.893 Test Loss: 0.334 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 1.1251776218414307
Epoch: 80, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.335 Vali Acc: 0.893 Test Loss: 0.335 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.9920434951782227
Epoch: 81, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.336 Vali Acc: 0.896 Test Loss: 0.336 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 82 cost time: 0.9505701065063477
Epoch: 82, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.338 Vali Acc: 0.896 Test Loss: 0.338 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.1370892524719238
Epoch: 83, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.338 Vali Acc: 0.893 Test Loss: 0.338 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.0980987548828125
Epoch: 84, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.339 Vali Acc: 0.893 Test Loss: 0.339 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.2482211589813232
Epoch: 85, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 86 cost time: 1.131108283996582
Epoch: 86, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.332 Vali Acc: 0.904 Test Loss: 0.332 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903700).  Saving model ...
Epoch: 87 cost time: 1.0139186382293701
Epoch: 87, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.326 Vali Acc: 0.904 Test Loss: 0.326 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 88 cost time: 0.9744012355804443
Epoch: 88, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.320 Vali Acc: 0.893 Test Loss: 0.320 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.2535181045532227
Epoch: 89, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.317 Vali Acc: 0.893 Test Loss: 0.317 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 1.055067539215088
Epoch: 90, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 1.159337043762207
Epoch: 91, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.313 Vali Acc: 0.893 Test Loss: 0.313 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 1.2275593280792236
Epoch: 92, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 1.2188241481781006
Epoch: 93, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.308 Vali Acc: 0.896 Test Loss: 0.308 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 0.8427610397338867
Epoch: 94, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.307 Vali Acc: 0.896 Test Loss: 0.307 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 0.9639146327972412
Epoch: 95, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.305 Vali Acc: 0.904 Test Loss: 0.305 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903701).  Saving model ...
Epoch: 96 cost time: 0.9316554069519043
Epoch: 96, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.303 Vali Acc: 0.904 Test Loss: 0.303 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 97 cost time: 1.110154390335083
Epoch: 97, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.302 Vali Acc: 0.904 Test Loss: 0.302 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 98 cost time: 1.0019543170928955
Epoch: 98, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.301 Vali Acc: 0.911 Test Loss: 0.301 Test Acc: 0.911
Validation loss decreased (-0.903701 --> -0.911108).  Saving model ...
Epoch: 99 cost time: 0.9849987030029297
Epoch: 99, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.300 Vali Acc: 0.907 Test Loss: 0.300 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 1.2726075649261475
Epoch: 100, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.301 Vali Acc: 0.904 Test Loss: 0.301 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 359926
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.940786123275757
Epoch: 1, Steps: 2 | Train Loss: 1.912 Vali Loss: 1.890 Vali Acc: 0.167 Test Loss: 1.890 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 1.1242833137512207
Epoch: 2, Steps: 2 | Train Loss: 1.951 Vali Loss: 1.867 Vali Acc: 0.167 Test Loss: 1.867 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.771967887878418
Epoch: 3, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.848 Vali Acc: 0.167 Test Loss: 1.848 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 4 cost time: 0.7241578102111816
Epoch: 4, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.826 Vali Acc: 0.167 Test Loss: 1.826 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 5 cost time: 0.9980154037475586
Epoch: 5, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.800 Vali Acc: 0.167 Test Loss: 1.800 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 0.8705739974975586
Epoch: 6, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.774 Vali Acc: 0.167 Test Loss: 1.774 Test Acc: 0.167
Validation loss decreased (-0.166649 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 0.8421201705932617
Epoch: 7, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.748 Vali Acc: 0.178 Test Loss: 1.748 Test Acc: 0.178
Validation loss decreased (-0.166649 --> -0.177760).  Saving model ...
Epoch: 8 cost time: 0.8047473430633545
Epoch: 8, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.724 Vali Acc: 0.233 Test Loss: 1.724 Test Acc: 0.233
Validation loss decreased (-0.177760 --> -0.233316).  Saving model ...
Epoch: 9 cost time: 0.8104710578918457
Epoch: 9, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.700 Vali Acc: 0.344 Test Loss: 1.700 Test Acc: 0.344
Validation loss decreased (-0.233316 --> -0.344427).  Saving model ...
Epoch: 10 cost time: 0.834883451461792
Epoch: 10, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.678 Vali Acc: 0.422 Test Loss: 1.678 Test Acc: 0.422
Validation loss decreased (-0.344427 --> -0.422205).  Saving model ...
Epoch: 11 cost time: 0.6172773838043213
Epoch: 11, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.655 Vali Acc: 0.444 Test Loss: 1.655 Test Acc: 0.444
Validation loss decreased (-0.422205 --> -0.444428).  Saving model ...
Epoch: 12 cost time: 1.008741855621338
Epoch: 12, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.631 Vali Acc: 0.463 Test Loss: 1.631 Test Acc: 0.463
Validation loss decreased (-0.444428 --> -0.462947).  Saving model ...
Epoch: 13 cost time: 1.0025553703308105
Epoch: 13, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.605 Vali Acc: 0.478 Test Loss: 1.605 Test Acc: 0.478
Validation loss decreased (-0.462947 --> -0.477762).  Saving model ...
Epoch: 14 cost time: 0.970400333404541
Epoch: 14, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.576 Vali Acc: 0.504 Test Loss: 1.576 Test Acc: 0.504
Validation loss decreased (-0.477762 --> -0.503688).  Saving model ...
Epoch: 15 cost time: 0.8926703929901123
Epoch: 15, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.544 Vali Acc: 0.515 Test Loss: 1.544 Test Acc: 0.515
Validation loss decreased (-0.503688 --> -0.514799).  Saving model ...
Epoch: 16 cost time: 0.829160213470459
Epoch: 16, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.508 Vali Acc: 0.530 Test Loss: 1.508 Test Acc: 0.530
Validation loss decreased (-0.514799 --> -0.529615).  Saving model ...
Epoch: 17 cost time: 0.9213674068450928
Epoch: 17, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.471 Vali Acc: 0.567 Test Loss: 1.471 Test Acc: 0.567
Validation loss decreased (-0.529615 --> -0.566652).  Saving model ...
Epoch: 18 cost time: 0.7121551036834717
Epoch: 18, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.429 Vali Acc: 0.615 Test Loss: 1.429 Test Acc: 0.615
Validation loss decreased (-0.566652 --> -0.614801).  Saving model ...
Epoch: 19 cost time: 0.8424317836761475
Epoch: 19, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.382 Vali Acc: 0.648 Test Loss: 1.382 Test Acc: 0.648
Validation loss decreased (-0.614801 --> -0.648134).  Saving model ...
Epoch: 20 cost time: 0.858198881149292
Epoch: 20, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.335 Vali Acc: 0.674 Test Loss: 1.335 Test Acc: 0.674
Validation loss decreased (-0.648134 --> -0.674061).  Saving model ...
Epoch: 21 cost time: 0.8964807987213135
Epoch: 21, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.287 Vali Acc: 0.711 Test Loss: 1.287 Test Acc: 0.711
Validation loss decreased (-0.674061 --> -0.711098).  Saving model ...
Epoch: 22 cost time: 0.9241316318511963
Epoch: 22, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.238 Vali Acc: 0.726 Test Loss: 1.238 Test Acc: 0.726
Validation loss decreased (-0.711098 --> -0.725914).  Saving model ...
Epoch: 23 cost time: 0.7507352828979492
Epoch: 23, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.188 Vali Acc: 0.752 Test Loss: 1.188 Test Acc: 0.752
Validation loss decreased (-0.725914 --> -0.751840).  Saving model ...
Epoch: 24 cost time: 1.0819382667541504
Epoch: 24, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.138 Vali Acc: 0.778 Test Loss: 1.138 Test Acc: 0.778
Validation loss decreased (-0.751840 --> -0.777766).  Saving model ...
Epoch: 25 cost time: 0.9150798320770264
Epoch: 25, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.089 Vali Acc: 0.789 Test Loss: 1.089 Test Acc: 0.789
Validation loss decreased (-0.777766 --> -0.788878).  Saving model ...
Epoch: 26 cost time: 0.8068928718566895
Epoch: 26, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.042 Vali Acc: 0.800 Test Loss: 1.042 Test Acc: 0.800
Validation loss decreased (-0.788878 --> -0.799990).  Saving model ...
Epoch: 27 cost time: 0.9063811302185059
Epoch: 27, Steps: 2 | Train Loss: 0.976 Vali Loss: 0.996 Vali Acc: 0.804 Test Loss: 0.996 Test Acc: 0.804
Validation loss decreased (-0.799990 --> -0.803694).  Saving model ...
Epoch: 28 cost time: 0.789503812789917
Epoch: 28, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.951 Vali Acc: 0.807 Test Loss: 0.951 Test Acc: 0.807
Validation loss decreased (-0.803694 --> -0.807398).  Saving model ...
Epoch: 29 cost time: 0.8361713886260986
Epoch: 29, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.909 Vali Acc: 0.804 Test Loss: 0.909 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8104026317596436
Epoch: 30, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.870 Vali Acc: 0.822 Test Loss: 0.870 Test Acc: 0.822
Validation loss decreased (-0.807398 --> -0.822214).  Saving model ...
Epoch: 31 cost time: 0.7571392059326172
Epoch: 31, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.834 Vali Acc: 0.833 Test Loss: 0.834 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833325).  Saving model ...
Epoch: 32 cost time: 0.7557146549224854
Epoch: 32, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.799 Vali Acc: 0.848 Test Loss: 0.799 Test Acc: 0.848
Validation loss decreased (-0.833325 --> -0.848140).  Saving model ...
Epoch: 33 cost time: 0.9207532405853271
Epoch: 33, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.765 Vali Acc: 0.852 Test Loss: 0.765 Test Acc: 0.852
Validation loss decreased (-0.848140 --> -0.851844).  Saving model ...
Epoch: 34 cost time: 1.00201416015625
Epoch: 34, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.735 Vali Acc: 0.852 Test Loss: 0.735 Test Acc: 0.852
Validation loss decreased (-0.851844 --> -0.851844).  Saving model ...
Epoch: 35 cost time: 0.7558658123016357
Epoch: 35, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.708 Vali Acc: 0.874 Test Loss: 0.708 Test Acc: 0.874
Validation loss decreased (-0.851844 --> -0.874067).  Saving model ...
Epoch: 36 cost time: 0.8903748989105225
Epoch: 36, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.681 Vali Acc: 0.889 Test Loss: 0.681 Test Acc: 0.889
Validation loss decreased (-0.874067 --> -0.888882).  Saving model ...
Epoch: 37 cost time: 1.01768159866333
Epoch: 37, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.659 Vali Acc: 0.911 Test Loss: 0.659 Test Acc: 0.911
Validation loss decreased (-0.888882 --> -0.911105).  Saving model ...
Epoch: 38 cost time: 0.9322052001953125
Epoch: 38, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.641 Vali Acc: 0.900 Test Loss: 0.641 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8639729022979736
Epoch: 39, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.622 Vali Acc: 0.904 Test Loss: 0.622 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.00809645652771
Epoch: 40, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.605 Vali Acc: 0.896 Test Loss: 0.605 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8635604381561279
Epoch: 41, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.996347188949585
Epoch: 42, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.573 Vali Acc: 0.907 Test Loss: 0.573 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8925087451934814
Epoch: 43, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.558 Vali Acc: 0.907 Test Loss: 0.558 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6583905220031738
Epoch: 44, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.544 Vali Acc: 0.907 Test Loss: 0.544 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.7573139667510986
Epoch: 45, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.531 Vali Acc: 0.904 Test Loss: 0.531 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8357498645782471
Epoch: 46, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.519 Vali Acc: 0.919 Test Loss: 0.519 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 47 cost time: 0.8630354404449463
Epoch: 47, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.506 Vali Acc: 0.911 Test Loss: 0.506 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.9670536518096924
Epoch: 48, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.492 Vali Acc: 0.911 Test Loss: 0.492 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.0544867515563965
Epoch: 49, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.479 Vali Acc: 0.915 Test Loss: 0.479 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.9590206146240234
Epoch: 50, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.470 Vali Acc: 0.922 Test Loss: 0.470 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922218).  Saving model ...
Epoch: 51 cost time: 0.7744219303131104
Epoch: 51, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.462 Vali Acc: 0.915 Test Loss: 0.462 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8913226127624512
Epoch: 52, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.457 Vali Acc: 0.915 Test Loss: 0.457 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9930751323699951
Epoch: 53, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.451 Vali Acc: 0.907 Test Loss: 0.451 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.1446826457977295
Epoch: 54, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.442 Vali Acc: 0.911 Test Loss: 0.442 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.0385499000549316
Epoch: 55, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.434 Vali Acc: 0.911 Test Loss: 0.434 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.096015214920044
Epoch: 56, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.424 Vali Acc: 0.915 Test Loss: 0.424 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.9511406421661377
Epoch: 57, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.416 Vali Acc: 0.922 Test Loss: 0.416 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 58 cost time: 0.8604743480682373
Epoch: 58, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.409 Vali Acc: 0.915 Test Loss: 0.409 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.9352757930755615
Epoch: 59, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.403 Vali Acc: 0.915 Test Loss: 0.403 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.9696762561798096
Epoch: 60, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.400 Vali Acc: 0.911 Test Loss: 0.400 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.9452331066131592
Epoch: 61, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.394 Vali Acc: 0.911 Test Loss: 0.394 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.8920943737030029
Epoch: 62, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.387 Vali Acc: 0.911 Test Loss: 0.387 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.9051010608673096
Epoch: 63, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.375 Vali Acc: 0.915 Test Loss: 0.375 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8146281242370605
Epoch: 64, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.362 Vali Acc: 0.915 Test Loss: 0.362 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.7505898475646973
Epoch: 65, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.354 Vali Acc: 0.911 Test Loss: 0.354 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.8429782390594482
Epoch: 66, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.348 Vali Acc: 0.915 Test Loss: 0.348 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 1.5800590515136719
Epoch: 67, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.348 Vali Acc: 0.919 Test Loss: 0.348 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 359574
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7096874713897705
Epoch: 1, Steps: 2 | Train Loss: 2.047 Vali Loss: 2.005 Vali Acc: 0.167 Test Loss: 2.005 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.9146010875701904
Epoch: 2, Steps: 2 | Train Loss: 2.033 Vali Loss: 1.975 Vali Acc: 0.170 Test Loss: 1.975 Test Acc: 0.170
Validation loss decreased (-0.166647 --> -0.170351).  Saving model ...
Epoch: 3 cost time: 0.8487856388092041
Epoch: 3, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.950 Vali Acc: 0.174 Test Loss: 1.950 Test Acc: 0.174
Validation loss decreased (-0.170351 --> -0.174055).  Saving model ...
Epoch: 4 cost time: 0.9402251243591309
Epoch: 4, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.917 Vali Acc: 0.167 Test Loss: 1.917 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9133186340332031
Epoch: 5, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.881 Vali Acc: 0.170 Test Loss: 1.881 Test Acc: 0.170
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8029043674468994
Epoch: 6, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.845 Vali Acc: 0.159 Test Loss: 1.845 Test Acc: 0.159
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9663219451904297
Epoch: 7, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.814 Vali Acc: 0.137 Test Loss: 1.814 Test Acc: 0.137
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0485339164733887
Epoch: 8, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.788 Vali Acc: 0.230 Test Loss: 1.788 Test Acc: 0.230
Validation loss decreased (-0.174055 --> -0.229612).  Saving model ...
Epoch: 9 cost time: 0.8035995960235596
Epoch: 9, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.766 Vali Acc: 0.263 Test Loss: 1.766 Test Acc: 0.263
Validation loss decreased (-0.229612 --> -0.262945).  Saving model ...
Epoch: 10 cost time: 0.7994701862335205
Epoch: 10, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.749 Vali Acc: 0.263 Test Loss: 1.749 Test Acc: 0.263
Validation loss decreased (-0.262945 --> -0.262945).  Saving model ...
Epoch: 11 cost time: 0.8008935451507568
Epoch: 11, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.731 Vali Acc: 0.263 Test Loss: 1.731 Test Acc: 0.263
Validation loss decreased (-0.262945 --> -0.262946).  Saving model ...
Epoch: 12 cost time: 0.9247450828552246
Epoch: 12, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.714 Vali Acc: 0.285 Test Loss: 1.714 Test Acc: 0.285
Validation loss decreased (-0.262946 --> -0.285168).  Saving model ...
Epoch: 13 cost time: 0.9388816356658936
Epoch: 13, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.693 Vali Acc: 0.296 Test Loss: 1.693 Test Acc: 0.296
Validation loss decreased (-0.285168 --> -0.296279).  Saving model ...
Epoch: 14 cost time: 0.9962434768676758
Epoch: 14, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.670 Vali Acc: 0.348 Test Loss: 1.670 Test Acc: 0.348
Validation loss decreased (-0.296279 --> -0.348131).  Saving model ...
Epoch: 15 cost time: 1.0313949584960938
Epoch: 15, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.644 Vali Acc: 0.400 Test Loss: 1.644 Test Acc: 0.400
Validation loss decreased (-0.348131 --> -0.399984).  Saving model ...
Epoch: 16 cost time: 0.9934637546539307
Epoch: 16, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.617 Vali Acc: 0.474 Test Loss: 1.617 Test Acc: 0.474
Validation loss decreased (-0.399984 --> -0.474058).  Saving model ...
Epoch: 17 cost time: 0.9965932369232178
Epoch: 17, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.589 Vali Acc: 0.507 Test Loss: 1.589 Test Acc: 0.507
Validation loss decreased (-0.474058 --> -0.507392).  Saving model ...
Epoch: 18 cost time: 0.9197983741760254
Epoch: 18, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.559 Vali Acc: 0.515 Test Loss: 1.559 Test Acc: 0.515
Validation loss decreased (-0.507392 --> -0.514799).  Saving model ...
Epoch: 19 cost time: 0.7937142848968506
Epoch: 19, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.525 Vali Acc: 0.570 Test Loss: 1.525 Test Acc: 0.570
Validation loss decreased (-0.514799 --> -0.570355).  Saving model ...
Epoch: 20 cost time: 0.8091011047363281
Epoch: 20, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.486 Vali Acc: 0.626 Test Loss: 1.486 Test Acc: 0.626
Validation loss decreased (-0.570355 --> -0.625911).  Saving model ...
Epoch: 21 cost time: 0.8332092761993408
Epoch: 21, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.443 Vali Acc: 0.663 Test Loss: 1.443 Test Acc: 0.663
Validation loss decreased (-0.625911 --> -0.662949).  Saving model ...
Epoch: 22 cost time: 1.0256714820861816
Epoch: 22, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.397 Vali Acc: 0.678 Test Loss: 1.397 Test Acc: 0.678
Validation loss decreased (-0.662949 --> -0.677764).  Saving model ...
Epoch: 23 cost time: 0.6846733093261719
Epoch: 23, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.346 Vali Acc: 0.696 Test Loss: 1.346 Test Acc: 0.696
Validation loss decreased (-0.677764 --> -0.696283).  Saving model ...
Epoch: 24 cost time: 0.7999050617218018
Epoch: 24, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.293 Vali Acc: 0.707 Test Loss: 1.293 Test Acc: 0.707
Validation loss decreased (-0.696283 --> -0.707394).  Saving model ...
Epoch: 25 cost time: 0.6769917011260986
Epoch: 25, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.239 Vali Acc: 0.726 Test Loss: 1.239 Test Acc: 0.726
Validation loss decreased (-0.707394 --> -0.725914).  Saving model ...
Epoch: 26 cost time: 0.8568172454833984
Epoch: 26, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.184 Vali Acc: 0.744 Test Loss: 1.184 Test Acc: 0.744
Validation loss decreased (-0.725914 --> -0.744433).  Saving model ...
Epoch: 27 cost time: 0.8220899105072021
Epoch: 27, Steps: 2 | Train Loss: 1.148 Vali Loss: 1.129 Vali Acc: 0.748 Test Loss: 1.129 Test Acc: 0.748
Validation loss decreased (-0.744433 --> -0.748137).  Saving model ...
Epoch: 28 cost time: 0.8111882209777832
Epoch: 28, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.076 Vali Acc: 0.756 Test Loss: 1.076 Test Acc: 0.756
Validation loss decreased (-0.748137 --> -0.755545).  Saving model ...
Epoch: 29 cost time: 0.8153421878814697
Epoch: 29, Steps: 2 | Train Loss: 1.000 Vali Loss: 1.029 Vali Acc: 0.774 Test Loss: 1.029 Test Acc: 0.774
Validation loss decreased (-0.755545 --> -0.774064).  Saving model ...
Epoch: 30 cost time: 0.8074371814727783
Epoch: 30, Steps: 2 | Train Loss: 0.919 Vali Loss: 0.984 Vali Acc: 0.778 Test Loss: 0.984 Test Acc: 0.778
Validation loss decreased (-0.774064 --> -0.777768).  Saving model ...
Epoch: 31 cost time: 0.7817542552947998
Epoch: 31, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.941 Vali Acc: 0.796 Test Loss: 0.941 Test Acc: 0.796
Validation loss decreased (-0.777768 --> -0.796287).  Saving model ...
Epoch: 32 cost time: 0.8932015895843506
Epoch: 32, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.900 Vali Acc: 0.815 Test Loss: 0.900 Test Acc: 0.815
Validation loss decreased (-0.796287 --> -0.814806).  Saving model ...
Epoch: 33 cost time: 0.8552451133728027
Epoch: 33, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.859 Vali Acc: 0.826 Test Loss: 0.859 Test Acc: 0.826
Validation loss decreased (-0.814806 --> -0.825917).  Saving model ...
Epoch: 34 cost time: 0.7787485122680664
Epoch: 34, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.819 Vali Acc: 0.837 Test Loss: 0.819 Test Acc: 0.837
Validation loss decreased (-0.825917 --> -0.837029).  Saving model ...
Epoch: 35 cost time: 0.9162724018096924
Epoch: 35, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.783 Vali Acc: 0.841 Test Loss: 0.783 Test Acc: 0.841
Validation loss decreased (-0.837029 --> -0.840733).  Saving model ...
Epoch: 36 cost time: 0.8205475807189941
Epoch: 36, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.747 Vali Acc: 0.856 Test Loss: 0.747 Test Acc: 0.856
Validation loss decreased (-0.840733 --> -0.855548).  Saving model ...
Epoch: 37 cost time: 0.8489723205566406
Epoch: 37, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.716 Vali Acc: 0.859 Test Loss: 0.716 Test Acc: 0.859
Validation loss decreased (-0.855548 --> -0.859252).  Saving model ...
Epoch: 38 cost time: 0.7405519485473633
Epoch: 38, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.685 Vali Acc: 0.867 Test Loss: 0.685 Test Acc: 0.867
Validation loss decreased (-0.859252 --> -0.866660).  Saving model ...
Epoch: 39 cost time: 1.0566163063049316
Epoch: 39, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.658 Vali Acc: 0.867 Test Loss: 0.658 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866660).  Saving model ...
Epoch: 40 cost time: 0.9189519882202148
Epoch: 40, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.635 Vali Acc: 0.874 Test Loss: 0.635 Test Acc: 0.874
Validation loss decreased (-0.866660 --> -0.874068).  Saving model ...
Epoch: 41 cost time: 0.777641773223877
Epoch: 41, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.613 Vali Acc: 0.874 Test Loss: 0.613 Test Acc: 0.874
Validation loss decreased (-0.874068 --> -0.874068).  Saving model ...
Epoch: 42 cost time: 0.8982186317443848
Epoch: 42, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.594 Vali Acc: 0.878 Test Loss: 0.594 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 43 cost time: 0.7838990688323975
Epoch: 43, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.579 Vali Acc: 0.878 Test Loss: 0.579 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 44 cost time: 0.9694933891296387
Epoch: 44, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.567 Vali Acc: 0.870 Test Loss: 0.567 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7420625686645508
Epoch: 45, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.556 Vali Acc: 0.867 Test Loss: 0.556 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.8411052227020264
Epoch: 46, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.546 Vali Acc: 0.863 Test Loss: 0.546 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8827245235443115
Epoch: 47, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.528 Vali Acc: 0.870 Test Loss: 0.528 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.950559139251709
Epoch: 48, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.511 Vali Acc: 0.881 Test Loss: 0.511 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 49 cost time: 1.226020097732544
Epoch: 49, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
Validation loss decreased (-0.881476 --> -0.899995).  Saving model ...
Epoch: 50 cost time: 0.8770194053649902
Epoch: 50, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.482 Vali Acc: 0.907 Test Loss: 0.482 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 51 cost time: 0.7863979339599609
Epoch: 51, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.471 Vali Acc: 0.900 Test Loss: 0.471 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7407834529876709
Epoch: 52, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.463 Vali Acc: 0.907 Test Loss: 0.463 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 53 cost time: 0.8889927864074707
Epoch: 53, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.458 Vali Acc: 0.896 Test Loss: 0.458 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8395941257476807
Epoch: 54, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.454 Vali Acc: 0.893 Test Loss: 0.454 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.8548440933227539
Epoch: 55, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.448 Vali Acc: 0.893 Test Loss: 0.448 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.9157960414886475
Epoch: 56, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.442 Vali Acc: 0.881 Test Loss: 0.442 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.8013436794281006
Epoch: 57, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.432 Vali Acc: 0.889 Test Loss: 0.432 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.995924711227417
Epoch: 58, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.419 Vali Acc: 0.904 Test Loss: 0.419 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.9511404037475586
Epoch: 59, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.7630250453948975
Epoch: 60, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.410 Vali Acc: 0.904 Test Loss: 0.410 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.8564355373382568
Epoch: 61, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.409 Vali Acc: 0.885 Test Loss: 0.409 Test Acc: 0.885
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.9397158622741699
Epoch: 62, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.405 Vali Acc: 0.885 Test Loss: 0.405 Test Acc: 0.885
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 359222
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1090705394744873
Epoch: 1, Steps: 2 | Train Loss: 2.126 Vali Loss: 2.071 Vali Acc: 0.096 Test Loss: 2.071 Test Acc: 0.096
Validation loss decreased (inf --> -0.096276).  Saving model ...
Epoch: 2 cost time: 0.8467481136322021
Epoch: 2, Steps: 2 | Train Loss: 2.008 Vali Loss: 2.042 Vali Acc: 0.085 Test Loss: 2.042 Test Acc: 0.085
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8228483200073242
Epoch: 3, Steps: 2 | Train Loss: 2.128 Vali Loss: 2.017 Vali Acc: 0.085 Test Loss: 2.017 Test Acc: 0.085
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.726346492767334
Epoch: 4, Steps: 2 | Train Loss: 2.130 Vali Loss: 1.988 Vali Acc: 0.089 Test Loss: 1.988 Test Acc: 0.089
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8605184555053711
Epoch: 5, Steps: 2 | Train Loss: 1.992 Vali Loss: 1.952 Vali Acc: 0.100 Test Loss: 1.952 Test Acc: 0.100
Validation loss decreased (-0.096276 --> -0.099980).  Saving model ...
Epoch: 6 cost time: 0.8890078067779541
Epoch: 6, Steps: 2 | Train Loss: 2.032 Vali Loss: 1.914 Vali Acc: 0.104 Test Loss: 1.914 Test Acc: 0.104
Validation loss decreased (-0.099980 --> -0.103685).  Saving model ...
Epoch: 7 cost time: 1.0672633647918701
Epoch: 7, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.877 Vali Acc: 0.107 Test Loss: 1.877 Test Acc: 0.107
Validation loss decreased (-0.103685 --> -0.107389).  Saving model ...
Epoch: 8 cost time: 0.9228696823120117
Epoch: 8, Steps: 2 | Train Loss: 1.933 Vali Loss: 1.842 Vali Acc: 0.130 Test Loss: 1.842 Test Acc: 0.130
Validation loss decreased (-0.107389 --> -0.129611).  Saving model ...
Epoch: 9 cost time: 0.973447322845459
Epoch: 9, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.810 Vali Acc: 0.141 Test Loss: 1.810 Test Acc: 0.141
Validation loss decreased (-0.129611 --> -0.140723).  Saving model ...
Epoch: 10 cost time: 0.8644139766693115
Epoch: 10, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.783 Vali Acc: 0.163 Test Loss: 1.783 Test Acc: 0.163
Validation loss decreased (-0.140723 --> -0.162945).  Saving model ...
Epoch: 11 cost time: 0.9143447875976562
Epoch: 11, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.759 Vali Acc: 0.256 Test Loss: 1.759 Test Acc: 0.256
Validation loss decreased (-0.162945 --> -0.255538).  Saving model ...
Epoch: 12 cost time: 0.9614787101745605
Epoch: 12, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.740 Vali Acc: 0.322 Test Loss: 1.740 Test Acc: 0.322
Validation loss decreased (-0.255538 --> -0.322205).  Saving model ...
Epoch: 13 cost time: 0.7372419834136963
Epoch: 13, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.723 Vali Acc: 0.330 Test Loss: 1.723 Test Acc: 0.330
Validation loss decreased (-0.322205 --> -0.329612).  Saving model ...
Epoch: 14 cost time: 0.9182999134063721
Epoch: 14, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.707 Vali Acc: 0.337 Test Loss: 1.707 Test Acc: 0.337
Validation loss decreased (-0.329612 --> -0.337020).  Saving model ...
Epoch: 15 cost time: 0.7491264343261719
Epoch: 15, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.690 Vali Acc: 0.352 Test Loss: 1.690 Test Acc: 0.352
Validation loss decreased (-0.337020 --> -0.351835).  Saving model ...
Epoch: 16 cost time: 0.8279428482055664
Epoch: 16, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.672 Vali Acc: 0.352 Test Loss: 1.672 Test Acc: 0.352
Validation loss decreased (-0.351835 --> -0.351835).  Saving model ...
Epoch: 17 cost time: 1.1840269565582275
Epoch: 17, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.650 Vali Acc: 0.381 Test Loss: 1.650 Test Acc: 0.381
Validation loss decreased (-0.351835 --> -0.381465).  Saving model ...
Epoch: 18 cost time: 0.7322616577148438
Epoch: 18, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.626 Vali Acc: 0.415 Test Loss: 1.626 Test Acc: 0.415
Validation loss decreased (-0.381465 --> -0.414799).  Saving model ...
Epoch: 19 cost time: 0.7477402687072754
Epoch: 19, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.596 Vali Acc: 0.448 Test Loss: 1.596 Test Acc: 0.448
Validation loss decreased (-0.414799 --> -0.448132).  Saving model ...
Epoch: 20 cost time: 0.8124065399169922
Epoch: 20, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.564 Vali Acc: 0.496 Test Loss: 1.564 Test Acc: 0.496
Validation loss decreased (-0.448132 --> -0.496281).  Saving model ...
Epoch: 21 cost time: 0.9805059432983398
Epoch: 21, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.528 Vali Acc: 0.563 Test Loss: 1.528 Test Acc: 0.563
Validation loss decreased (-0.496281 --> -0.562948).  Saving model ...
Epoch: 22 cost time: 0.8260619640350342
Epoch: 22, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.489 Vali Acc: 0.641 Test Loss: 1.489 Test Acc: 0.641
Validation loss decreased (-0.562948 --> -0.640726).  Saving model ...
Epoch: 23 cost time: 0.8808364868164062
Epoch: 23, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.447 Vali Acc: 0.678 Test Loss: 1.447 Test Acc: 0.678
Validation loss decreased (-0.640726 --> -0.677763).  Saving model ...
Epoch: 24 cost time: 0.884871244430542
Epoch: 24, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.403 Vali Acc: 0.756 Test Loss: 1.403 Test Acc: 0.756
Validation loss decreased (-0.677763 --> -0.755542).  Saving model ...
Epoch: 25 cost time: 0.9346604347229004
Epoch: 25, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.356 Vali Acc: 0.785 Test Loss: 1.356 Test Acc: 0.785
Validation loss decreased (-0.755542 --> -0.785172).  Saving model ...
Epoch: 26 cost time: 1.1417315006256104
Epoch: 26, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.305 Vali Acc: 0.811 Test Loss: 1.305 Test Acc: 0.811
Validation loss decreased (-0.785172 --> -0.811098).  Saving model ...
Epoch: 27 cost time: 0.8447551727294922
Epoch: 27, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.252 Vali Acc: 0.815 Test Loss: 1.252 Test Acc: 0.815
Validation loss decreased (-0.811098 --> -0.814802).  Saving model ...
Epoch: 28 cost time: 0.7484290599822998
Epoch: 28, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.198 Vali Acc: 0.833 Test Loss: 1.198 Test Acc: 0.833
Validation loss decreased (-0.814802 --> -0.833321).  Saving model ...
Epoch: 29 cost time: 0.856471061706543
Epoch: 29, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.145 Vali Acc: 0.837 Test Loss: 1.145 Test Acc: 0.837
Validation loss decreased (-0.833321 --> -0.837026).  Saving model ...
Epoch: 30 cost time: 1.1313495635986328
Epoch: 30, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.091 Vali Acc: 0.856 Test Loss: 1.091 Test Acc: 0.856
Validation loss decreased (-0.837026 --> -0.855545).  Saving model ...
Epoch: 31 cost time: 0.9796733856201172
Epoch: 31, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.038 Vali Acc: 0.878 Test Loss: 1.038 Test Acc: 0.878
Validation loss decreased (-0.855545 --> -0.877767).  Saving model ...
Epoch: 32 cost time: 0.9386627674102783
Epoch: 32, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.986 Vali Acc: 0.896 Test Loss: 0.986 Test Acc: 0.896
Validation loss decreased (-0.877767 --> -0.896286).  Saving model ...
Epoch: 33 cost time: 0.8057971000671387
Epoch: 33, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.937 Vali Acc: 0.896 Test Loss: 0.937 Test Acc: 0.896
Validation loss decreased (-0.896286 --> -0.896287).  Saving model ...
Epoch: 34 cost time: 1.3416357040405273
Epoch: 34, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.892 Vali Acc: 0.889 Test Loss: 0.892 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.8105287551879883
Epoch: 35, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.850 Vali Acc: 0.911 Test Loss: 0.850 Test Acc: 0.911
Validation loss decreased (-0.896287 --> -0.911103).  Saving model ...
Epoch: 36 cost time: 0.9940164089202881
Epoch: 36, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.813 Vali Acc: 0.911 Test Loss: 0.813 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911103).  Saving model ...
Epoch: 37 cost time: 1.0385043621063232
Epoch: 37, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.777 Vali Acc: 0.911 Test Loss: 0.777 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911103).  Saving model ...
Epoch: 38 cost time: 0.7630276679992676
Epoch: 38, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.740 Vali Acc: 0.911 Test Loss: 0.740 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911104).  Saving model ...
Epoch: 39 cost time: 0.7707667350769043
Epoch: 39, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.704 Vali Acc: 0.937 Test Loss: 0.704 Test Acc: 0.937
Validation loss decreased (-0.911104 --> -0.937030).  Saving model ...
Epoch: 40 cost time: 1.0310280323028564
Epoch: 40, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.671 Vali Acc: 0.937 Test Loss: 0.671 Test Acc: 0.937
Validation loss decreased (-0.937030 --> -0.937030).  Saving model ...
Epoch: 41 cost time: 0.9985935688018799
Epoch: 41, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.641 Vali Acc: 0.941 Test Loss: 0.641 Test Acc: 0.941
Validation loss decreased (-0.937030 --> -0.940734).  Saving model ...
Epoch: 42 cost time: 0.8349630832672119
Epoch: 42, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.614 Vali Acc: 0.941 Test Loss: 0.614 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940735).  Saving model ...
Epoch: 43 cost time: 0.8703422546386719
Epoch: 43, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.588 Vali Acc: 0.933 Test Loss: 0.588 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0123050212860107
Epoch: 44, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.563 Vali Acc: 0.937 Test Loss: 0.563 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.854741096496582
Epoch: 45, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.542 Vali Acc: 0.937 Test Loss: 0.542 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.0748085975646973
Epoch: 46, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.524 Vali Acc: 0.937 Test Loss: 0.524 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9368100166320801
Epoch: 47, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.509 Vali Acc: 0.937 Test Loss: 0.509 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.040306806564331
Epoch: 48, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.499 Vali Acc: 0.944 Test Loss: 0.499 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 49 cost time: 1.0297234058380127
Epoch: 49, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.489 Vali Acc: 0.937 Test Loss: 0.489 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.073340654373169
Epoch: 50, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.477 Vali Acc: 0.937 Test Loss: 0.477 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8922786712646484
Epoch: 51, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.461 Vali Acc: 0.937 Test Loss: 0.461 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 1.1664881706237793
Epoch: 52, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.440 Vali Acc: 0.937 Test Loss: 0.440 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8549761772155762
Epoch: 53, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.423 Vali Acc: 0.941 Test Loss: 0.423 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 1.0453965663909912
Epoch: 54, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.407 Vali Acc: 0.937 Test Loss: 0.407 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.1790568828582764
Epoch: 55, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.395 Vali Acc: 0.944 Test Loss: 0.395 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 56 cost time: 0.9940268993377686
Epoch: 56, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.384 Vali Acc: 0.944 Test Loss: 0.384 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 57 cost time: 0.8135392665863037
Epoch: 57, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.376 Vali Acc: 0.944 Test Loss: 0.376 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 58 cost time: 0.74973464012146
Epoch: 58, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.369 Vali Acc: 0.944 Test Loss: 0.369 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 59 cost time: 0.9549345970153809
Epoch: 59, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.365 Vali Acc: 0.941 Test Loss: 0.365 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.081421136856079
Epoch: 60, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.362 Vali Acc: 0.944 Test Loss: 0.362 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 61 cost time: 0.7953176498413086
Epoch: 61, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.354 Vali Acc: 0.941 Test Loss: 0.354 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.9838275909423828
Epoch: 62, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.349 Vali Acc: 0.944 Test Loss: 0.349 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 63 cost time: 0.8004331588745117
Epoch: 63, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.343 Vali Acc: 0.944 Test Loss: 0.343 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 64 cost time: 0.7754068374633789
Epoch: 64, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.337 Vali Acc: 0.944 Test Loss: 0.337 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 65 cost time: 0.8684110641479492
Epoch: 65, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.330 Vali Acc: 0.948 Test Loss: 0.330 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 66 cost time: 1.0197532176971436
Epoch: 66, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.322 Vali Acc: 0.956 Test Loss: 0.322 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955552).  Saving model ...
Epoch: 67 cost time: 0.7301087379455566
Epoch: 67, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.315 Vali Acc: 0.952 Test Loss: 0.315 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.9597156047821045
Epoch: 68, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.313 Vali Acc: 0.948 Test Loss: 0.313 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 1.0058913230895996
Epoch: 69, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.313 Vali Acc: 0.941 Test Loss: 0.313 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.1013329029083252
Epoch: 70, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.9231808185577393
Epoch: 71, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.314 Vali Acc: 0.937 Test Loss: 0.314 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 1.0351805686950684
Epoch: 72, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.311 Vali Acc: 0.941 Test Loss: 0.311 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.8286375999450684
Epoch: 73, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 1.1427690982818604
Epoch: 74, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.297 Vali Acc: 0.941 Test Loss: 0.297 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.8870348930358887
Epoch: 75, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.291 Vali Acc: 0.948 Test Loss: 0.291 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6969161033630371
Epoch: 76, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 358870
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.114469051361084
Epoch: 1, Steps: 2 | Train Loss: 1.964 Vali Loss: 1.908 Vali Acc: 0.056 Test Loss: 1.908 Test Acc: 0.056
Validation loss decreased (inf --> -0.055536).  Saving model ...
Epoch: 2 cost time: 0.8734598159790039
Epoch: 2, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.891 Vali Acc: 0.056 Test Loss: 1.891 Test Acc: 0.056
Validation loss decreased (-0.055536 --> -0.055537).  Saving model ...
Epoch: 3 cost time: 0.8931360244750977
Epoch: 3, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.876 Vali Acc: 0.044 Test Loss: 1.876 Test Acc: 0.044
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8903000354766846
Epoch: 4, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.858 Vali Acc: 0.041 Test Loss: 1.858 Test Acc: 0.041
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7764174938201904
Epoch: 5, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.836 Vali Acc: 0.041 Test Loss: 1.836 Test Acc: 0.041
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.8775277137756348
Epoch: 6, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.813 Vali Acc: 0.052 Test Loss: 1.813 Test Acc: 0.052
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.8475024700164795
Epoch: 7, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.789 Vali Acc: 0.074 Test Loss: 1.789 Test Acc: 0.074
Validation loss decreased (-0.055537 --> -0.074056).  Saving model ...
Epoch: 8 cost time: 0.8218779563903809
Epoch: 8, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.765 Vali Acc: 0.096 Test Loss: 1.765 Test Acc: 0.096
Validation loss decreased (-0.074056 --> -0.096279).  Saving model ...
Epoch: 9 cost time: 0.9751806259155273
Epoch: 9, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.740 Vali Acc: 0.126 Test Loss: 1.740 Test Acc: 0.126
Validation loss decreased (-0.096279 --> -0.125909).  Saving model ...
Epoch: 10 cost time: 1.0112228393554688
Epoch: 10, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.717 Vali Acc: 0.207 Test Loss: 1.717 Test Acc: 0.207
Validation loss decreased (-0.125909 --> -0.207390).  Saving model ...
Epoch: 11 cost time: 1.1100881099700928
Epoch: 11, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.692 Vali Acc: 0.248 Test Loss: 1.692 Test Acc: 0.248
Validation loss decreased (-0.207390 --> -0.248131).  Saving model ...
Epoch: 12 cost time: 0.8253850936889648
Epoch: 12, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.666 Vali Acc: 0.330 Test Loss: 1.666 Test Acc: 0.330
Validation loss decreased (-0.248131 --> -0.329613).  Saving model ...
Epoch: 13 cost time: 0.7569370269775391
Epoch: 13, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.640 Vali Acc: 0.419 Test Loss: 1.640 Test Acc: 0.419
Validation loss decreased (-0.329613 --> -0.418502).  Saving model ...
Epoch: 14 cost time: 0.9188971519470215
Epoch: 14, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.612 Vali Acc: 0.504 Test Loss: 1.612 Test Acc: 0.504
Validation loss decreased (-0.418502 --> -0.503688).  Saving model ...
Epoch: 15 cost time: 0.7115321159362793
Epoch: 15, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.583 Vali Acc: 0.537 Test Loss: 1.583 Test Acc: 0.537
Validation loss decreased (-0.503688 --> -0.537021).  Saving model ...
Epoch: 16 cost time: 0.8728480339050293
Epoch: 16, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.552 Vali Acc: 0.578 Test Loss: 1.552 Test Acc: 0.578
Validation loss decreased (-0.537021 --> -0.577762).  Saving model ...
Epoch: 17 cost time: 0.8344252109527588
Epoch: 17, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.519 Vali Acc: 0.633 Test Loss: 1.519 Test Acc: 0.633
Validation loss decreased (-0.577762 --> -0.633318).  Saving model ...
Epoch: 18 cost time: 1.0751769542694092
Epoch: 18, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.485 Vali Acc: 0.659 Test Loss: 1.485 Test Acc: 0.659
Validation loss decreased (-0.633318 --> -0.659244).  Saving model ...
Epoch: 19 cost time: 0.8767426013946533
Epoch: 19, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.450 Vali Acc: 0.700 Test Loss: 1.450 Test Acc: 0.700
Validation loss decreased (-0.659244 --> -0.699986).  Saving model ...
Epoch: 20 cost time: 1.013965129852295
Epoch: 20, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.413 Vali Acc: 0.711 Test Loss: 1.413 Test Acc: 0.711
Validation loss decreased (-0.699986 --> -0.711097).  Saving model ...
Epoch: 21 cost time: 0.8769915103912354
Epoch: 21, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.374 Vali Acc: 0.748 Test Loss: 1.374 Test Acc: 0.748
Validation loss decreased (-0.711097 --> -0.748134).  Saving model ...
Epoch: 22 cost time: 0.8216793537139893
Epoch: 22, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.333 Vali Acc: 0.774 Test Loss: 1.333 Test Acc: 0.774
Validation loss decreased (-0.748134 --> -0.774061).  Saving model ...
Epoch: 23 cost time: 0.7937333583831787
Epoch: 23, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.290 Vali Acc: 0.793 Test Loss: 1.290 Test Acc: 0.793
Validation loss decreased (-0.774061 --> -0.792580).  Saving model ...
Epoch: 24 cost time: 0.8403611183166504
Epoch: 24, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.246 Vali Acc: 0.811 Test Loss: 1.246 Test Acc: 0.811
Validation loss decreased (-0.792580 --> -0.811099).  Saving model ...
Epoch: 25 cost time: 0.8536217212677002
Epoch: 25, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.201 Vali Acc: 0.815 Test Loss: 1.201 Test Acc: 0.815
Validation loss decreased (-0.811099 --> -0.814803).  Saving model ...
Epoch: 26 cost time: 1.0544092655181885
Epoch: 26, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.155 Vali Acc: 0.815 Test Loss: 1.155 Test Acc: 0.815
Validation loss decreased (-0.814803 --> -0.814803).  Saving model ...
Epoch: 27 cost time: 0.9371795654296875
Epoch: 27, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.110 Vali Acc: 0.822 Test Loss: 1.110 Test Acc: 0.822
Validation loss decreased (-0.814803 --> -0.822211).  Saving model ...
Epoch: 28 cost time: 0.8201308250427246
Epoch: 28, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.065 Vali Acc: 0.822 Test Loss: 1.065 Test Acc: 0.822
Validation loss decreased (-0.822211 --> -0.822212).  Saving model ...
Epoch: 29 cost time: 1.0632703304290771
Epoch: 29, Steps: 2 | Train Loss: 0.976 Vali Loss: 1.021 Vali Acc: 0.830 Test Loss: 1.021 Test Acc: 0.830
Validation loss decreased (-0.822212 --> -0.829619).  Saving model ...
Epoch: 30 cost time: 0.846566915512085
Epoch: 30, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.979 Vali Acc: 0.830 Test Loss: 0.979 Test Acc: 0.830
Validation loss decreased (-0.829619 --> -0.829620).  Saving model ...
Epoch: 31 cost time: 1.063875675201416
Epoch: 31, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.939 Vali Acc: 0.830 Test Loss: 0.939 Test Acc: 0.830
Validation loss decreased (-0.829620 --> -0.829620).  Saving model ...
Epoch: 32 cost time: 0.7595582008361816
Epoch: 32, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.901 Vali Acc: 0.830 Test Loss: 0.901 Test Acc: 0.830
Validation loss decreased (-0.829620 --> -0.829621).  Saving model ...
Epoch: 33 cost time: 0.7655129432678223
Epoch: 33, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.865 Vali Acc: 0.833 Test Loss: 0.865 Test Acc: 0.833
Validation loss decreased (-0.829621 --> -0.833325).  Saving model ...
Epoch: 34 cost time: 1.0590369701385498
Epoch: 34, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.830 Vali Acc: 0.841 Test Loss: 0.830 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840732).  Saving model ...
Epoch: 35 cost time: 1.028404951095581
Epoch: 35, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.797 Vali Acc: 0.848 Test Loss: 0.797 Test Acc: 0.848
Validation loss decreased (-0.840732 --> -0.848140).  Saving model ...
Epoch: 36 cost time: 0.9422838687896729
Epoch: 36, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.765 Vali Acc: 0.863 Test Loss: 0.765 Test Acc: 0.863
Validation loss decreased (-0.848140 --> -0.862955).  Saving model ...
Epoch: 37 cost time: 0.7926673889160156
Epoch: 37, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.735 Vali Acc: 0.863 Test Loss: 0.735 Test Acc: 0.863
Validation loss decreased (-0.862955 --> -0.862956).  Saving model ...
Epoch: 38 cost time: 0.8566839694976807
Epoch: 38, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.706 Vali Acc: 0.874 Test Loss: 0.706 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874067).  Saving model ...
Epoch: 39 cost time: 0.8432691097259521
Epoch: 39, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.678 Vali Acc: 0.881 Test Loss: 0.678 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881475).  Saving model ...
Epoch: 40 cost time: 0.7393383979797363
Epoch: 40, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.653 Vali Acc: 0.881 Test Loss: 0.653 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 41 cost time: 1.1763944625854492
Epoch: 41, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.632 Vali Acc: 0.885 Test Loss: 0.632 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 42 cost time: 1.0962834358215332
Epoch: 42, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.610 Vali Acc: 0.896 Test Loss: 0.610 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896290).  Saving model ...
Epoch: 43 cost time: 1.0041532516479492
Epoch: 43, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 44 cost time: 0.9607694149017334
Epoch: 44, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.572 Vali Acc: 0.904 Test Loss: 0.572 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 45 cost time: 1.029001235961914
Epoch: 45, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.556 Vali Acc: 0.900 Test Loss: 0.556 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0840237140655518
Epoch: 46, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.541 Vali Acc: 0.907 Test Loss: 0.541 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 47 cost time: 0.9531922340393066
Epoch: 47, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.526 Vali Acc: 0.907 Test Loss: 0.526 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 48 cost time: 1.026319980621338
Epoch: 48, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.514 Vali Acc: 0.900 Test Loss: 0.514 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.9370441436767578
Epoch: 49, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.505 Vali Acc: 0.896 Test Loss: 0.505 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 1.059729814529419
Epoch: 50, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.498 Vali Acc: 0.896 Test Loss: 0.498 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9950704574584961
Epoch: 51, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.488 Vali Acc: 0.900 Test Loss: 0.488 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0130176544189453
Epoch: 52, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.478 Vali Acc: 0.904 Test Loss: 0.478 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.8382604122161865
Epoch: 53, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.467 Vali Acc: 0.907 Test Loss: 0.467 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 54 cost time: 1.0638766288757324
Epoch: 54, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.458 Vali Acc: 0.911 Test Loss: 0.458 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 55 cost time: 0.9312751293182373
Epoch: 55, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.450 Vali Acc: 0.915 Test Loss: 0.450 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914810).  Saving model ...
Epoch: 56 cost time: 0.8451931476593018
Epoch: 56, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.441 Vali Acc: 0.919 Test Loss: 0.441 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 57 cost time: 0.8685793876647949
Epoch: 57, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.434 Vali Acc: 0.911 Test Loss: 0.434 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.933661937713623
Epoch: 58, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.427 Vali Acc: 0.911 Test Loss: 0.427 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8019092082977295
Epoch: 59, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.421 Vali Acc: 0.911 Test Loss: 0.421 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 1.153160572052002
Epoch: 60, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.416 Vali Acc: 0.907 Test Loss: 0.416 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 1.163301706314087
Epoch: 61, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.409 Vali Acc: 0.911 Test Loss: 0.409 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.8685035705566406
Epoch: 62, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.405 Vali Acc: 0.907 Test Loss: 0.405 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 63 cost time: 1.0588257312774658
Epoch: 63, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.403 Vali Acc: 0.907 Test Loss: 0.403 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 64 cost time: 0.9829950332641602
Epoch: 64, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.397 Vali Acc: 0.907 Test Loss: 0.397 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 65 cost time: 0.9861457347869873
Epoch: 65, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.391 Vali Acc: 0.911 Test Loss: 0.391 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 66 cost time: 0.9149186611175537
Epoch: 66, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.386 Vali Acc: 0.911 Test Loss: 0.386 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 243446
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7497448921203613
Epoch: 1, Steps: 2 | Train Loss: 2.040 Vali Loss: 2.055 Vali Acc: 0.163 Test Loss: 2.055 Test Acc: 0.163
Validation loss decreased (inf --> -0.162942).  Saving model ...
Epoch: 2 cost time: 0.9680848121643066
Epoch: 2, Steps: 2 | Train Loss: 1.936 Vali Loss: 2.018 Vali Acc: 0.159 Test Loss: 2.018 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8712725639343262
Epoch: 3, Steps: 2 | Train Loss: 2.004 Vali Loss: 1.989 Vali Acc: 0.159 Test Loss: 1.989 Test Acc: 0.159
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8116400241851807
Epoch: 4, Steps: 2 | Train Loss: 2.005 Vali Loss: 1.960 Vali Acc: 0.156 Test Loss: 1.960 Test Acc: 0.156
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8593184947967529
Epoch: 5, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.926 Vali Acc: 0.152 Test Loss: 1.926 Test Acc: 0.152
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.9290056228637695
Epoch: 6, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.889 Vali Acc: 0.148 Test Loss: 1.889 Test Acc: 0.148
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.7190086841583252
Epoch: 7, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.852 Vali Acc: 0.152 Test Loss: 1.852 Test Acc: 0.152
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.017509937286377
Epoch: 8, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.816 Vali Acc: 0.148 Test Loss: 1.816 Test Acc: 0.148
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.9826748371124268
Epoch: 9, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.785 Vali Acc: 0.148 Test Loss: 1.785 Test Acc: 0.148
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.9587972164154053
Epoch: 10, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.755 Vali Acc: 0.196 Test Loss: 1.755 Test Acc: 0.196
Validation loss decreased (-0.162942 --> -0.196279).  Saving model ...
Epoch: 11 cost time: 0.8330614566802979
Epoch: 11, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.729 Vali Acc: 0.326 Test Loss: 1.729 Test Acc: 0.326
Validation loss decreased (-0.196279 --> -0.325909).  Saving model ...
Epoch: 12 cost time: 1.0853915214538574
Epoch: 12, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.704 Vali Acc: 0.396 Test Loss: 1.704 Test Acc: 0.396
Validation loss decreased (-0.325909 --> -0.396279).  Saving model ...
Epoch: 13 cost time: 1.363100528717041
Epoch: 13, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.679 Vali Acc: 0.411 Test Loss: 1.679 Test Acc: 0.411
Validation loss decreased (-0.396279 --> -0.411094).  Saving model ...
Epoch: 14 cost time: 1.0191941261291504
Epoch: 14, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.655 Vali Acc: 0.374 Test Loss: 1.655 Test Acc: 0.374
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9825246334075928
Epoch: 15, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.631 Vali Acc: 0.374 Test Loss: 1.631 Test Acc: 0.374
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9194235801696777
Epoch: 16, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.606 Vali Acc: 0.411 Test Loss: 1.606 Test Acc: 0.411
Validation loss decreased (-0.411094 --> -0.411095).  Saving model ...
Epoch: 17 cost time: 0.9193432331085205
Epoch: 17, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.578 Vali Acc: 0.433 Test Loss: 1.578 Test Acc: 0.433
Validation loss decreased (-0.411095 --> -0.433318).  Saving model ...
Epoch: 18 cost time: 1.0711655616760254
Epoch: 18, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.547 Vali Acc: 0.456 Test Loss: 1.547 Test Acc: 0.456
Validation loss decreased (-0.433318 --> -0.455540).  Saving model ...
Epoch: 19 cost time: 1.0737524032592773
Epoch: 19, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.514 Vali Acc: 0.493 Test Loss: 1.514 Test Acc: 0.493
Validation loss decreased (-0.455540 --> -0.492577).  Saving model ...
Epoch: 20 cost time: 0.8463301658630371
Epoch: 20, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.477 Vali Acc: 0.526 Test Loss: 1.477 Test Acc: 0.526
Validation loss decreased (-0.492577 --> -0.525911).  Saving model ...
Epoch: 21 cost time: 0.9174585342407227
Epoch: 21, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.439 Vali Acc: 0.552 Test Loss: 1.439 Test Acc: 0.552
Validation loss decreased (-0.525911 --> -0.551837).  Saving model ...
Epoch: 22 cost time: 0.9148814678192139
Epoch: 22, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.398 Vali Acc: 0.585 Test Loss: 1.398 Test Acc: 0.585
Validation loss decreased (-0.551837 --> -0.585171).  Saving model ...
Epoch: 23 cost time: 1.0078907012939453
Epoch: 23, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.355 Vali Acc: 0.600 Test Loss: 1.355 Test Acc: 0.600
Validation loss decreased (-0.585171 --> -0.599986).  Saving model ...
Epoch: 24 cost time: 0.9895026683807373
Epoch: 24, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.313 Vali Acc: 0.626 Test Loss: 1.313 Test Acc: 0.626
Validation loss decreased (-0.599986 --> -0.625913).  Saving model ...
Epoch: 25 cost time: 1.0183699131011963
Epoch: 25, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.268 Vali Acc: 0.641 Test Loss: 1.268 Test Acc: 0.641
Validation loss decreased (-0.625913 --> -0.640728).  Saving model ...
Epoch: 26 cost time: 0.8554177284240723
Epoch: 26, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.223 Vali Acc: 0.641 Test Loss: 1.223 Test Acc: 0.641
Validation loss decreased (-0.640728 --> -0.640729).  Saving model ...
Epoch: 27 cost time: 1.1312320232391357
Epoch: 27, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.177 Vali Acc: 0.648 Test Loss: 1.177 Test Acc: 0.648
Validation loss decreased (-0.640729 --> -0.648136).  Saving model ...
Epoch: 28 cost time: 1.0808238983154297
Epoch: 28, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.131 Vali Acc: 0.659 Test Loss: 1.131 Test Acc: 0.659
Validation loss decreased (-0.648136 --> -0.659248).  Saving model ...
Epoch: 29 cost time: 1.0776269435882568
Epoch: 29, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.087 Vali Acc: 0.685 Test Loss: 1.087 Test Acc: 0.685
Validation loss decreased (-0.659248 --> -0.685174).  Saving model ...
Epoch: 30 cost time: 1.0074114799499512
Epoch: 30, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.043 Vali Acc: 0.707 Test Loss: 1.043 Test Acc: 0.707
Validation loss decreased (-0.685174 --> -0.707397).  Saving model ...
Epoch: 31 cost time: 0.8937575817108154
Epoch: 31, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.000 Vali Acc: 0.707 Test Loss: 1.000 Test Acc: 0.707
Validation loss decreased (-0.707397 --> -0.707397).  Saving model ...
Epoch: 32 cost time: 0.8859958648681641
Epoch: 32, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.960 Vali Acc: 0.722 Test Loss: 0.960 Test Acc: 0.722
Validation loss decreased (-0.707397 --> -0.722213).  Saving model ...
Epoch: 33 cost time: 0.8384861946105957
Epoch: 33, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.924 Vali Acc: 0.737 Test Loss: 0.924 Test Acc: 0.737
Validation loss decreased (-0.722213 --> -0.737028).  Saving model ...
Epoch: 34 cost time: 1.0869765281677246
Epoch: 34, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.890 Vali Acc: 0.733 Test Loss: 0.890 Test Acc: 0.733
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.1845753192901611
Epoch: 35, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.858 Vali Acc: 0.748 Test Loss: 0.858 Test Acc: 0.748
Validation loss decreased (-0.737028 --> -0.748140).  Saving model ...
Epoch: 36 cost time: 0.9892330169677734
Epoch: 36, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.829 Vali Acc: 0.770 Test Loss: 0.829 Test Acc: 0.770
Validation loss decreased (-0.748140 --> -0.770362).  Saving model ...
Epoch: 37 cost time: 0.8735592365264893
Epoch: 37, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.800 Vali Acc: 0.781 Test Loss: 0.800 Test Acc: 0.781
Validation loss decreased (-0.770362 --> -0.781473).  Saving model ...
Epoch: 38 cost time: 1.0172808170318604
Epoch: 38, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.774 Vali Acc: 0.785 Test Loss: 0.774 Test Acc: 0.785
Validation loss decreased (-0.781473 --> -0.785177).  Saving model ...
Epoch: 39 cost time: 0.9504406452178955
Epoch: 39, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.748 Vali Acc: 0.796 Test Loss: 0.748 Test Acc: 0.796
Validation loss decreased (-0.785177 --> -0.796289).  Saving model ...
Epoch: 40 cost time: 0.780247688293457
Epoch: 40, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.724 Vali Acc: 0.804 Test Loss: 0.724 Test Acc: 0.804
Validation loss decreased (-0.796289 --> -0.803696).  Saving model ...
Epoch: 41 cost time: 0.8130660057067871
Epoch: 41, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.701 Vali Acc: 0.822 Test Loss: 0.701 Test Acc: 0.822
Validation loss decreased (-0.803696 --> -0.822215).  Saving model ...
Epoch: 42 cost time: 0.7003705501556396
Epoch: 42, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.682 Vali Acc: 0.822 Test Loss: 0.682 Test Acc: 0.822
Validation loss decreased (-0.822215 --> -0.822215).  Saving model ...
Epoch: 43 cost time: 0.9199483394622803
Epoch: 43, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.665 Vali Acc: 0.815 Test Loss: 0.665 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9267706871032715
Epoch: 44, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.647 Vali Acc: 0.826 Test Loss: 0.647 Test Acc: 0.826
Validation loss decreased (-0.822215 --> -0.825919).  Saving model ...
Epoch: 45 cost time: 0.9091718196868896
Epoch: 45, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.629 Vali Acc: 0.826 Test Loss: 0.629 Test Acc: 0.826
Validation loss decreased (-0.825919 --> -0.825920).  Saving model ...
Epoch: 46 cost time: 0.7085781097412109
Epoch: 46, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.609 Vali Acc: 0.830 Test Loss: 0.609 Test Acc: 0.830
Validation loss decreased (-0.825920 --> -0.829624).  Saving model ...
Epoch: 47 cost time: 0.8171992301940918
Epoch: 47, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.593 Vali Acc: 0.833 Test Loss: 0.593 Test Acc: 0.833
Validation loss decreased (-0.829624 --> -0.833327).  Saving model ...
Epoch: 48 cost time: 1.0798168182373047
Epoch: 48, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.577 Vali Acc: 0.837 Test Loss: 0.577 Test Acc: 0.837
Validation loss decreased (-0.833327 --> -0.837031).  Saving model ...
Epoch: 49 cost time: 1.1039783954620361
Epoch: 49, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.565 Vali Acc: 0.844 Test Loss: 0.565 Test Acc: 0.844
Validation loss decreased (-0.837031 --> -0.844439).  Saving model ...
Epoch: 50 cost time: 0.9255917072296143
Epoch: 50, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.552 Vali Acc: 0.859 Test Loss: 0.552 Test Acc: 0.859
Validation loss decreased (-0.844439 --> -0.859254).  Saving model ...
Epoch: 51 cost time: 1.0184266567230225
Epoch: 51, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.539 Vali Acc: 0.870 Test Loss: 0.539 Test Acc: 0.870
Validation loss decreased (-0.859254 --> -0.870365).  Saving model ...
Epoch: 52 cost time: 0.8657469749450684
Epoch: 52, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.530 Vali Acc: 0.859 Test Loss: 0.530 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8909828662872314
Epoch: 53, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.521 Vali Acc: 0.863 Test Loss: 0.521 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 1.0532045364379883
Epoch: 54, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.513 Vali Acc: 0.867 Test Loss: 0.513 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 1.1569945812225342
Epoch: 55, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.502 Vali Acc: 0.874 Test Loss: 0.502 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 56 cost time: 1.0438799858093262
Epoch: 56, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.488 Vali Acc: 0.889 Test Loss: 0.488 Test Acc: 0.889
Validation loss decreased (-0.874069 --> -0.888884).  Saving model ...
Epoch: 57 cost time: 0.9640970230102539
Epoch: 57, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.475 Vali Acc: 0.893 Test Loss: 0.475 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 58 cost time: 0.7672228813171387
Epoch: 58, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.466 Vali Acc: 0.893 Test Loss: 0.466 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 59 cost time: 0.9223344326019287
Epoch: 59, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.458 Vali Acc: 0.893 Test Loss: 0.458 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 60 cost time: 0.8965389728546143
Epoch: 60, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.453 Vali Acc: 0.893 Test Loss: 0.453 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 61 cost time: 0.9239761829376221
Epoch: 61, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.451 Vali Acc: 0.889 Test Loss: 0.451 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8297164440155029
Epoch: 62, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.454 Vali Acc: 0.878 Test Loss: 0.454 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 1.1101782321929932
Epoch: 63, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.452 Vali Acc: 0.878 Test Loss: 0.452 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.8761489391326904
Epoch: 64, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.441 Vali Acc: 0.878 Test Loss: 0.441 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.9224908351898193
Epoch: 65, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.430 Vali Acc: 0.885 Test Loss: 0.430 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 1.049485206604004
Epoch: 66, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.421 Vali Acc: 0.893 Test Loss: 0.421 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 67 cost time: 0.8065235614776611
Epoch: 67, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.413 Vali Acc: 0.889 Test Loss: 0.413 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8407964706420898
Epoch: 68, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.411 Vali Acc: 0.881 Test Loss: 0.411 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.8286619186401367
Epoch: 69, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.412 Vali Acc: 0.878 Test Loss: 0.412 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 1.032712697982788
Epoch: 70, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.414 Vali Acc: 0.881 Test Loss: 0.414 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 1.0529847145080566
Epoch: 71, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.419 Vali Acc: 0.881 Test Loss: 0.419 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.8809604644775391
Epoch: 72, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.412 Vali Acc: 0.885 Test Loss: 0.412 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 1.1724729537963867
Epoch: 73, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.9151153564453125
Epoch: 74, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
Validation loss decreased (-0.892588 --> -0.899996).  Saving model ...
Epoch: 75 cost time: 1.0077879428863525
Epoch: 75, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.372 Vali Acc: 0.911 Test Loss: 0.372 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911107).  Saving model ...
Epoch: 76 cost time: 0.9040648937225342
Epoch: 76, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.372 Vali Acc: 0.904 Test Loss: 0.372 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 1.1124773025512695
Epoch: 77, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.382 Vali Acc: 0.893 Test Loss: 0.382 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 1.0119426250457764
Epoch: 78, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.397 Vali Acc: 0.874 Test Loss: 0.397 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.9293041229248047
Epoch: 79, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.0783183574676514
Epoch: 80, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.394 Vali Acc: 0.874 Test Loss: 0.394 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.8954958915710449
Epoch: 81, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.372 Vali Acc: 0.893 Test Loss: 0.372 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.0449192523956299
Epoch: 82, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.359 Vali Acc: 0.896 Test Loss: 0.359 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 1.0084447860717773
Epoch: 83, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.356 Vali Acc: 0.889 Test Loss: 0.356 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.9027872085571289
Epoch: 84, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.9389567375183105
Epoch: 85, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.355 Vali Acc: 0.889 Test Loss: 0.355 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 243094
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8371152877807617
Epoch: 1, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.898 Vali Acc: 0.156 Test Loss: 1.898 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 0.9777195453643799
Epoch: 2, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.876 Vali Acc: 0.159 Test Loss: 1.876 Test Acc: 0.159
Validation loss decreased (-0.155537 --> -0.159240).  Saving model ...
Epoch: 3 cost time: 1.1676833629608154
Epoch: 3, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.860 Vali Acc: 0.159 Test Loss: 1.860 Test Acc: 0.159
Validation loss decreased (-0.159240 --> -0.159241).  Saving model ...
Epoch: 4 cost time: 0.8599135875701904
Epoch: 4, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.842 Vali Acc: 0.185 Test Loss: 1.842 Test Acc: 0.185
Validation loss decreased (-0.159241 --> -0.185167).  Saving model ...
Epoch: 5 cost time: 0.8015689849853516
Epoch: 5, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.821 Vali Acc: 0.219 Test Loss: 1.821 Test Acc: 0.219
Validation loss decreased (-0.185167 --> -0.218500).  Saving model ...
Epoch: 6 cost time: 0.8403215408325195
Epoch: 6, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.799 Vali Acc: 0.252 Test Loss: 1.799 Test Acc: 0.252
Validation loss decreased (-0.218500 --> -0.251834).  Saving model ...
Epoch: 7 cost time: 1.2266111373901367
Epoch: 7, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.777 Vali Acc: 0.270 Test Loss: 1.777 Test Acc: 0.270
Validation loss decreased (-0.251834 --> -0.270353).  Saving model ...
Epoch: 8 cost time: 0.8456807136535645
Epoch: 8, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.756 Vali Acc: 0.278 Test Loss: 1.756 Test Acc: 0.278
Validation loss decreased (-0.270353 --> -0.277760).  Saving model ...
Epoch: 9 cost time: 0.9038267135620117
Epoch: 9, Steps: 2 | Train Loss: 1.768 Vali Loss: 1.735 Vali Acc: 0.274 Test Loss: 1.735 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2622966766357422
Epoch: 10, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.715 Vali Acc: 0.274 Test Loss: 1.715 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9968490600585938
Epoch: 11, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.696 Vali Acc: 0.289 Test Loss: 1.696 Test Acc: 0.289
Validation loss decreased (-0.277760 --> -0.288872).  Saving model ...
Epoch: 12 cost time: 1.2111077308654785
Epoch: 12, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.676 Vali Acc: 0.322 Test Loss: 1.676 Test Acc: 0.322
Validation loss decreased (-0.288872 --> -0.322205).  Saving model ...
Epoch: 13 cost time: 1.0167927742004395
Epoch: 13, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.656 Vali Acc: 0.341 Test Loss: 1.656 Test Acc: 0.341
Validation loss decreased (-0.322205 --> -0.340724).  Saving model ...
Epoch: 14 cost time: 0.9507875442504883
Epoch: 14, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.634 Vali Acc: 0.381 Test Loss: 1.634 Test Acc: 0.381
Validation loss decreased (-0.340724 --> -0.381465).  Saving model ...
Epoch: 15 cost time: 0.768665075302124
Epoch: 15, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.611 Vali Acc: 0.422 Test Loss: 1.611 Test Acc: 0.422
Validation loss decreased (-0.381465 --> -0.422206).  Saving model ...
Epoch: 16 cost time: 1.010911226272583
Epoch: 16, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.585 Vali Acc: 0.448 Test Loss: 1.585 Test Acc: 0.448
Validation loss decreased (-0.422206 --> -0.448132).  Saving model ...
Epoch: 17 cost time: 1.191253900527954
Epoch: 17, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.557 Vali Acc: 0.467 Test Loss: 1.557 Test Acc: 0.467
Validation loss decreased (-0.448132 --> -0.466651).  Saving model ...
Epoch: 18 cost time: 0.9902288913726807
Epoch: 18, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.527 Vali Acc: 0.504 Test Loss: 1.527 Test Acc: 0.504
Validation loss decreased (-0.466651 --> -0.503688).  Saving model ...
Epoch: 19 cost time: 0.8888905048370361
Epoch: 19, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.497 Vali Acc: 0.522 Test Loss: 1.497 Test Acc: 0.522
Validation loss decreased (-0.503688 --> -0.522207).  Saving model ...
Epoch: 20 cost time: 0.9421708583831787
Epoch: 20, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.464 Vali Acc: 0.533 Test Loss: 1.464 Test Acc: 0.533
Validation loss decreased (-0.522207 --> -0.533319).  Saving model ...
Epoch: 21 cost time: 0.8623359203338623
Epoch: 21, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.429 Vali Acc: 0.559 Test Loss: 1.429 Test Acc: 0.559
Validation loss decreased (-0.533319 --> -0.559245).  Saving model ...
Epoch: 22 cost time: 0.9780228137969971
Epoch: 22, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.392 Vali Acc: 0.589 Test Loss: 1.392 Test Acc: 0.589
Validation loss decreased (-0.559245 --> -0.588875).  Saving model ...
Epoch: 23 cost time: 1.009700059890747
Epoch: 23, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.353 Vali Acc: 0.589 Test Loss: 1.353 Test Acc: 0.589
Validation loss decreased (-0.588875 --> -0.588875).  Saving model ...
Epoch: 24 cost time: 0.9592175483703613
Epoch: 24, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.314 Vali Acc: 0.604 Test Loss: 1.314 Test Acc: 0.604
Validation loss decreased (-0.588875 --> -0.603691).  Saving model ...
Epoch: 25 cost time: 0.9011421203613281
Epoch: 25, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.274 Vali Acc: 0.611 Test Loss: 1.274 Test Acc: 0.611
Validation loss decreased (-0.603691 --> -0.611098).  Saving model ...
Epoch: 26 cost time: 1.0573687553405762
Epoch: 26, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.232 Vali Acc: 0.652 Test Loss: 1.232 Test Acc: 0.652
Validation loss decreased (-0.611098 --> -0.651840).  Saving model ...
Epoch: 27 cost time: 0.7600438594818115
Epoch: 27, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.191 Vali Acc: 0.663 Test Loss: 1.191 Test Acc: 0.663
Validation loss decreased (-0.651840 --> -0.662951).  Saving model ...
Epoch: 28 cost time: 1.0424108505249023
Epoch: 28, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.151 Vali Acc: 0.700 Test Loss: 1.151 Test Acc: 0.700
Validation loss decreased (-0.662951 --> -0.699988).  Saving model ...
Epoch: 29 cost time: 0.9226131439208984
Epoch: 29, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.111 Vali Acc: 0.715 Test Loss: 1.111 Test Acc: 0.715
Validation loss decreased (-0.699988 --> -0.714804).  Saving model ...
Epoch: 30 cost time: 0.8799898624420166
Epoch: 30, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.073 Vali Acc: 0.726 Test Loss: 1.073 Test Acc: 0.726
Validation loss decreased (-0.714804 --> -0.725915).  Saving model ...
Epoch: 31 cost time: 1.2685778141021729
Epoch: 31, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.036 Vali Acc: 0.748 Test Loss: 1.036 Test Acc: 0.748
Validation loss decreased (-0.725915 --> -0.748138).  Saving model ...
Epoch: 32 cost time: 0.8458406925201416
Epoch: 32, Steps: 2 | Train Loss: 0.887 Vali Loss: 1.000 Vali Acc: 0.752 Test Loss: 1.000 Test Acc: 0.752
Validation loss decreased (-0.748138 --> -0.751842).  Saving model ...
Epoch: 33 cost time: 0.9736881256103516
Epoch: 33, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.967 Vali Acc: 0.774 Test Loss: 0.967 Test Acc: 0.774
Validation loss decreased (-0.751842 --> -0.774064).  Saving model ...
Epoch: 34 cost time: 0.7574758529663086
Epoch: 34, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.932 Vali Acc: 0.781 Test Loss: 0.932 Test Acc: 0.781
Validation loss decreased (-0.774064 --> -0.781472).  Saving model ...
Epoch: 35 cost time: 1.4376232624053955
Epoch: 35, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.902 Vali Acc: 0.785 Test Loss: 0.902 Test Acc: 0.785
Validation loss decreased (-0.781472 --> -0.785176).  Saving model ...
Epoch: 36 cost time: 0.9538407325744629
Epoch: 36, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.870 Vali Acc: 0.800 Test Loss: 0.870 Test Acc: 0.800
Validation loss decreased (-0.785176 --> -0.799991).  Saving model ...
Epoch: 37 cost time: 1.0540821552276611
Epoch: 37, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.840 Vali Acc: 0.807 Test Loss: 0.840 Test Acc: 0.807
Validation loss decreased (-0.799991 --> -0.807399).  Saving model ...
Epoch: 38 cost time: 1.044926643371582
Epoch: 38, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.811 Vali Acc: 0.815 Test Loss: 0.811 Test Acc: 0.815
Validation loss decreased (-0.807399 --> -0.814807).  Saving model ...
Epoch: 39 cost time: 1.1632096767425537
Epoch: 39, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.783 Vali Acc: 0.833 Test Loss: 0.783 Test Acc: 0.833
Validation loss decreased (-0.814807 --> -0.833326).  Saving model ...
Epoch: 40 cost time: 0.8981142044067383
Epoch: 40, Steps: 2 | Train Loss: 0.586 Vali Loss: 0.756 Vali Acc: 0.848 Test Loss: 0.756 Test Acc: 0.848
Validation loss decreased (-0.833326 --> -0.848141).  Saving model ...
Epoch: 41 cost time: 1.1455638408660889
Epoch: 41, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.731 Vali Acc: 0.856 Test Loss: 0.731 Test Acc: 0.856
Validation loss decreased (-0.848141 --> -0.855548).  Saving model ...
Epoch: 42 cost time: 1.0413727760314941
Epoch: 42, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.712 Vali Acc: 0.848 Test Loss: 0.712 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.135035514831543
Epoch: 43, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.690 Vali Acc: 0.859 Test Loss: 0.690 Test Acc: 0.859
Validation loss decreased (-0.855548 --> -0.859252).  Saving model ...
Epoch: 44 cost time: 0.9737493991851807
Epoch: 44, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.670 Vali Acc: 0.859 Test Loss: 0.670 Test Acc: 0.859
Validation loss decreased (-0.859252 --> -0.859253).  Saving model ...
Epoch: 45 cost time: 1.0520718097686768
Epoch: 45, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.652 Vali Acc: 0.863 Test Loss: 0.652 Test Acc: 0.863
Validation loss decreased (-0.859253 --> -0.862956).  Saving model ...
Epoch: 46 cost time: 1.2064707279205322
Epoch: 46, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.635 Vali Acc: 0.870 Test Loss: 0.635 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870364).  Saving model ...
Epoch: 47 cost time: 1.0636036396026611
Epoch: 47, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.619 Vali Acc: 0.878 Test Loss: 0.619 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877772).  Saving model ...
Epoch: 48 cost time: 0.7801468372344971
Epoch: 48, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.605 Vali Acc: 0.878 Test Loss: 0.605 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 49 cost time: 1.2258286476135254
Epoch: 49, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.590 Vali Acc: 0.878 Test Loss: 0.590 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 50 cost time: 1.1689441204071045
Epoch: 50, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.577 Vali Acc: 0.881 Test Loss: 0.577 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 51 cost time: 1.1885685920715332
Epoch: 51, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.564 Vali Acc: 0.881 Test Loss: 0.564 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 52 cost time: 1.216634750366211
Epoch: 52, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.552 Vali Acc: 0.885 Test Loss: 0.552 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 53 cost time: 0.9033830165863037
Epoch: 53, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.540 Vali Acc: 0.885 Test Loss: 0.540 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 54 cost time: 1.248878002166748
Epoch: 54, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.529 Vali Acc: 0.900 Test Loss: 0.529 Test Acc: 0.900
Validation loss decreased (-0.885180 --> -0.899995).  Saving model ...
Epoch: 55 cost time: 0.8603739738464355
Epoch: 55, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.521 Vali Acc: 0.889 Test Loss: 0.521 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 1.0041797161102295
Epoch: 56, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.513 Vali Acc: 0.889 Test Loss: 0.513 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.8878450393676758
Epoch: 57, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.503 Vali Acc: 0.893 Test Loss: 0.503 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 1.0842223167419434
Epoch: 58, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.495 Vali Acc: 0.896 Test Loss: 0.495 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.9528374671936035
Epoch: 59, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.487 Vali Acc: 0.904 Test Loss: 0.487 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 60 cost time: 0.9200730323791504
Epoch: 60, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.483 Vali Acc: 0.904 Test Loss: 0.483 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 61 cost time: 1.0861709117889404
Epoch: 61, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.475 Vali Acc: 0.904 Test Loss: 0.475 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 62 cost time: 0.9879622459411621
Epoch: 62, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7781033515930176
Epoch: 63, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.464 Vali Acc: 0.900 Test Loss: 0.464 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.981250524520874
Epoch: 64, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.460 Vali Acc: 0.896 Test Loss: 0.460 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 1.437565565109253
Epoch: 65, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.459 Vali Acc: 0.893 Test Loss: 0.459 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.8887050151824951
Epoch: 66, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.457 Vali Acc: 0.893 Test Loss: 0.457 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 1.0279450416564941
Epoch: 67, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.451 Vali Acc: 0.893 Test Loss: 0.451 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 1.0169944763183594
Epoch: 68, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.442 Vali Acc: 0.896 Test Loss: 0.442 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 1.0935688018798828
Epoch: 69, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.9286503791809082
Epoch: 70, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.429 Vali Acc: 0.900 Test Loss: 0.429 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 1.0678784847259521
Epoch: 71, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 242742
model size : 1.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.3706724643707275
Epoch: 1, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.886 Vali Acc: 0.233 Test Loss: 1.886 Test Acc: 0.233
Validation loss decreased (inf --> -0.233314).  Saving model ...
Epoch: 2 cost time: 0.8527531623840332
Epoch: 2, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.863 Vali Acc: 0.278 Test Loss: 1.863 Test Acc: 0.278
Validation loss decreased (-0.233314 --> -0.277759).  Saving model ...
Epoch: 3 cost time: 0.7543025016784668
Epoch: 3, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.846 Vali Acc: 0.285 Test Loss: 1.846 Test Acc: 0.285
Validation loss decreased (-0.277759 --> -0.285167).  Saving model ...
Epoch: 4 cost time: 1.2369279861450195
Epoch: 4, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.827 Vali Acc: 0.296 Test Loss: 1.827 Test Acc: 0.296
Validation loss decreased (-0.285167 --> -0.296278).  Saving model ...
Epoch: 5 cost time: 0.7318854331970215
Epoch: 5, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.804 Vali Acc: 0.322 Test Loss: 1.804 Test Acc: 0.322
Validation loss decreased (-0.296278 --> -0.322204).  Saving model ...
Epoch: 6 cost time: 1.0793488025665283
Epoch: 6, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.778 Vali Acc: 0.344 Test Loss: 1.778 Test Acc: 0.344
Validation loss decreased (-0.322204 --> -0.344427).  Saving model ...
Epoch: 7 cost time: 1.035381555557251
Epoch: 7, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.752 Vali Acc: 0.378 Test Loss: 1.752 Test Acc: 0.378
Validation loss decreased (-0.344427 --> -0.377760).  Saving model ...
Epoch: 8 cost time: 0.7078514099121094
Epoch: 8, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.725 Vali Acc: 0.426 Test Loss: 1.725 Test Acc: 0.426
Validation loss decreased (-0.377760 --> -0.425909).  Saving model ...
Epoch: 9 cost time: 0.8539543151855469
Epoch: 9, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.699 Vali Acc: 0.441 Test Loss: 1.699 Test Acc: 0.441
Validation loss decreased (-0.425909 --> -0.440724).  Saving model ...
Epoch: 10 cost time: 0.9949338436126709
Epoch: 10, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.672 Vali Acc: 0.463 Test Loss: 1.672 Test Acc: 0.463
Validation loss decreased (-0.440724 --> -0.462946).  Saving model ...
Epoch: 11 cost time: 0.9561707973480225
Epoch: 11, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.645 Vali Acc: 0.493 Test Loss: 1.645 Test Acc: 0.493
Validation loss decreased (-0.462946 --> -0.492576).  Saving model ...
Epoch: 12 cost time: 1.0844159126281738
Epoch: 12, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.619 Vali Acc: 0.552 Test Loss: 1.619 Test Acc: 0.552
Validation loss decreased (-0.492576 --> -0.551836).  Saving model ...
Epoch: 13 cost time: 0.9332735538482666
Epoch: 13, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.592 Vali Acc: 0.552 Test Loss: 1.592 Test Acc: 0.552
Validation loss decreased (-0.551836 --> -0.551836).  Saving model ...
Epoch: 14 cost time: 0.9052021503448486
Epoch: 14, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.566 Vali Acc: 0.544 Test Loss: 1.566 Test Acc: 0.544
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9309568405151367
Epoch: 15, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.540 Vali Acc: 0.563 Test Loss: 1.540 Test Acc: 0.563
Validation loss decreased (-0.551836 --> -0.562948).  Saving model ...
Epoch: 16 cost time: 0.9177150726318359
Epoch: 16, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.513 Vali Acc: 0.615 Test Loss: 1.513 Test Acc: 0.615
Validation loss decreased (-0.562948 --> -0.614800).  Saving model ...
Epoch: 17 cost time: 0.8680713176727295
Epoch: 17, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.485 Vali Acc: 0.656 Test Loss: 1.485 Test Acc: 0.656
Validation loss decreased (-0.614800 --> -0.655541).  Saving model ...
Epoch: 18 cost time: 0.8173766136169434
Epoch: 18, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.455 Vali Acc: 0.670 Test Loss: 1.455 Test Acc: 0.670
Validation loss decreased (-0.655541 --> -0.670356).  Saving model ...
Epoch: 19 cost time: 0.8122341632843018
Epoch: 19, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.423 Vali Acc: 0.681 Test Loss: 1.423 Test Acc: 0.681
Validation loss decreased (-0.670356 --> -0.681467).  Saving model ...
Epoch: 20 cost time: 0.8223514556884766
Epoch: 20, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.389 Vali Acc: 0.715 Test Loss: 1.389 Test Acc: 0.715
Validation loss decreased (-0.681467 --> -0.714801).  Saving model ...
Epoch: 21 cost time: 1.0588161945343018
Epoch: 21, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.353 Vali Acc: 0.752 Test Loss: 1.353 Test Acc: 0.752
Validation loss decreased (-0.714801 --> -0.751838).  Saving model ...
Epoch: 22 cost time: 0.8535616397857666
Epoch: 22, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.316 Vali Acc: 0.756 Test Loss: 1.316 Test Acc: 0.756
Validation loss decreased (-0.751838 --> -0.755542).  Saving model ...
Epoch: 23 cost time: 0.9290573596954346
Epoch: 23, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.277 Vali Acc: 0.774 Test Loss: 1.277 Test Acc: 0.774
Validation loss decreased (-0.755542 --> -0.774061).  Saving model ...
Epoch: 24 cost time: 0.8469045162200928
Epoch: 24, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.237 Vali Acc: 0.785 Test Loss: 1.237 Test Acc: 0.785
Validation loss decreased (-0.774061 --> -0.785173).  Saving model ...
Epoch: 25 cost time: 0.8809618949890137
Epoch: 25, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.199 Vali Acc: 0.793 Test Loss: 1.199 Test Acc: 0.793
Validation loss decreased (-0.785173 --> -0.792581).  Saving model ...
Epoch: 26 cost time: 0.7485084533691406
Epoch: 26, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.160 Vali Acc: 0.811 Test Loss: 1.160 Test Acc: 0.811
Validation loss decreased (-0.792581 --> -0.811100).  Saving model ...
Epoch: 27 cost time: 1.087245225906372
Epoch: 27, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.121 Vali Acc: 0.815 Test Loss: 1.121 Test Acc: 0.815
Validation loss decreased (-0.811100 --> -0.814804).  Saving model ...
Epoch: 28 cost time: 0.7386636734008789
Epoch: 28, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.081 Vali Acc: 0.826 Test Loss: 1.081 Test Acc: 0.826
Validation loss decreased (-0.814804 --> -0.825915).  Saving model ...
Epoch: 29 cost time: 0.8806421756744385
Epoch: 29, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.041 Vali Acc: 0.833 Test Loss: 1.041 Test Acc: 0.833
Validation loss decreased (-0.825915 --> -0.833323).  Saving model ...
Epoch: 30 cost time: 0.8628120422363281
Epoch: 30, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.001 Vali Acc: 0.848 Test Loss: 1.001 Test Acc: 0.848
Validation loss decreased (-0.833323 --> -0.848138).  Saving model ...
Epoch: 31 cost time: 0.7465667724609375
Epoch: 31, Steps: 2 | Train Loss: 0.966 Vali Loss: 0.961 Vali Acc: 0.863 Test Loss: 0.961 Test Acc: 0.863
Validation loss decreased (-0.848138 --> -0.862953).  Saving model ...
Epoch: 32 cost time: 0.8746111392974854
Epoch: 32, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.923 Vali Acc: 0.874 Test Loss: 0.923 Test Acc: 0.874
Validation loss decreased (-0.862953 --> -0.874065).  Saving model ...
Epoch: 33 cost time: 0.9346234798431396
Epoch: 33, Steps: 2 | Train Loss: 0.806 Vali Loss: 0.887 Vali Acc: 0.881 Test Loss: 0.887 Test Acc: 0.881
Validation loss decreased (-0.874065 --> -0.881473).  Saving model ...
Epoch: 34 cost time: 0.8263137340545654
Epoch: 34, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.852 Vali Acc: 0.889 Test Loss: 0.852 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888880).  Saving model ...
Epoch: 35 cost time: 0.9139070510864258
Epoch: 35, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.818 Vali Acc: 0.907 Test Loss: 0.818 Test Acc: 0.907
Validation loss decreased (-0.888880 --> -0.907399).  Saving model ...
Epoch: 36 cost time: 0.7858686447143555
Epoch: 36, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.787 Vali Acc: 0.907 Test Loss: 0.787 Test Acc: 0.907
Validation loss decreased (-0.907399 --> -0.907400).  Saving model ...
Epoch: 37 cost time: 0.7577605247497559
Epoch: 37, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.758 Vali Acc: 0.907 Test Loss: 0.758 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 38 cost time: 0.7246363162994385
Epoch: 38, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.729 Vali Acc: 0.907 Test Loss: 0.729 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 39 cost time: 0.927748441696167
Epoch: 39, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.703 Vali Acc: 0.915 Test Loss: 0.703 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 40 cost time: 0.9054527282714844
Epoch: 40, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.679 Vali Acc: 0.915 Test Loss: 0.679 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 41 cost time: 0.7722771167755127
Epoch: 41, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.657 Vali Acc: 0.907 Test Loss: 0.657 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8343818187713623
Epoch: 42, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.634 Vali Acc: 0.904 Test Loss: 0.634 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0555157661437988
Epoch: 43, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.612 Vali Acc: 0.911 Test Loss: 0.612 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.1424105167388916
Epoch: 44, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.591 Vali Acc: 0.911 Test Loss: 0.591 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.964292049407959
Epoch: 45, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.571 Vali Acc: 0.926 Test Loss: 0.571 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925920).  Saving model ...
Epoch: 46 cost time: 0.6572580337524414
Epoch: 46, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.552 Vali Acc: 0.930 Test Loss: 0.552 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 47 cost time: 0.8100018501281738
Epoch: 47, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.535 Vali Acc: 0.933 Test Loss: 0.535 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 48 cost time: 1.0403430461883545
Epoch: 48, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.517 Vali Acc: 0.933 Test Loss: 0.517 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 49 cost time: 0.8573117256164551
Epoch: 49, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.502 Vali Acc: 0.933 Test Loss: 0.502 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 50 cost time: 1.049584150314331
Epoch: 50, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.488 Vali Acc: 0.933 Test Loss: 0.488 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 51 cost time: 0.7611756324768066
Epoch: 51, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.475 Vali Acc: 0.937 Test Loss: 0.475 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 52 cost time: 0.9149675369262695
Epoch: 52, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.462 Vali Acc: 0.937 Test Loss: 0.462 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 53 cost time: 0.9221324920654297
Epoch: 53, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.450 Vali Acc: 0.937 Test Loss: 0.450 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 54 cost time: 0.9978847503662109
Epoch: 54, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.439 Vali Acc: 0.937 Test Loss: 0.439 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 55 cost time: 0.8223106861114502
Epoch: 55, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.426 Vali Acc: 0.937 Test Loss: 0.426 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 56 cost time: 1.0595440864562988
Epoch: 56, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.416 Vali Acc: 0.937 Test Loss: 0.416 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 57 cost time: 1.0109431743621826
Epoch: 57, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.406 Vali Acc: 0.937 Test Loss: 0.406 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 58 cost time: 0.9758005142211914
Epoch: 58, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.396 Vali Acc: 0.937 Test Loss: 0.396 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 59 cost time: 0.971705436706543
Epoch: 59, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.387 Vali Acc: 0.937 Test Loss: 0.387 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 60 cost time: 0.9143779277801514
Epoch: 60, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.378 Vali Acc: 0.944 Test Loss: 0.378 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944441).  Saving model ...
Epoch: 61 cost time: 0.9076492786407471
Epoch: 61, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.371 Vali Acc: 0.948 Test Loss: 0.371 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948144).  Saving model ...
Epoch: 62 cost time: 0.8398430347442627
Epoch: 62, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.363 Vali Acc: 0.952 Test Loss: 0.363 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 63 cost time: 0.8752734661102295
Epoch: 63, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.357 Vali Acc: 0.952 Test Loss: 0.357 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 64 cost time: 0.9445962905883789
Epoch: 64, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.353 Vali Acc: 0.944 Test Loss: 0.353 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.9672400951385498
Epoch: 65, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.351 Vali Acc: 0.944 Test Loss: 0.351 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.7878303527832031
Epoch: 66, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.348 Vali Acc: 0.937 Test Loss: 0.348 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.8607196807861328
Epoch: 67, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.344 Vali Acc: 0.937 Test Loss: 0.344 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.9084219932556152
Epoch: 68, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.337 Vali Acc: 0.933 Test Loss: 0.337 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.8420147895812988
Epoch: 69, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.332 Vali Acc: 0.930 Test Loss: 0.332 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.0361392498016357
Epoch: 70, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.323 Vali Acc: 0.937 Test Loss: 0.323 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.9211320877075195
Epoch: 71, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.315 Vali Acc: 0.944 Test Loss: 0.315 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.1634626388549805
Epoch: 72, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.309 Vali Acc: 0.944 Test Loss: 0.309 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.0614519119262695
Epoch: 73, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.304 Vali Acc: 0.952 Test Loss: 0.304 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951849).  Saving model ...
Epoch: 74 cost time: 0.9925153255462646
Epoch: 74, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.302 Vali Acc: 0.952 Test Loss: 0.302 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 75 cost time: 0.7866978645324707
Epoch: 75, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.299 Vali Acc: 0.952 Test Loss: 0.299 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 76 cost time: 0.8828344345092773
Epoch: 76, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.298 Vali Acc: 0.948 Test Loss: 0.298 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.8453369140625
Epoch: 77, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.299 Vali Acc: 0.937 Test Loss: 0.299 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.9122838973999023
Epoch: 78, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.9989001750946045
Epoch: 79, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 1.118004322052002
Epoch: 80, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 1.0062334537506104
Epoch: 81, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 1.1091303825378418
Epoch: 82, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.284 Vali Acc: 0.937 Test Loss: 0.284 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.9415819644927979
Epoch: 83, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.9384946823120117
Epoch: 84, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.278 Vali Acc: 0.937 Test Loss: 0.278 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.934821367263794
Epoch: 85, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 242390
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4684031009674072
Epoch: 1, Steps: 2 | Train Loss: 2.038 Vali Loss: 2.001 Vali Acc: 0.100 Test Loss: 2.001 Test Acc: 0.100
Validation loss decreased (inf --> -0.099980).  Saving model ...
Epoch: 2 cost time: 0.6863949298858643
Epoch: 2, Steps: 2 | Train Loss: 2.013 Vali Loss: 1.970 Vali Acc: 0.100 Test Loss: 1.970 Test Acc: 0.100
Validation loss decreased (-0.099980 --> -0.099980).  Saving model ...
Epoch: 3 cost time: 0.8125417232513428
Epoch: 3, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.945 Vali Acc: 0.100 Test Loss: 1.945 Test Acc: 0.100
Validation loss decreased (-0.099980 --> -0.099981).  Saving model ...
Epoch: 4 cost time: 0.7474532127380371
Epoch: 4, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.921 Vali Acc: 0.104 Test Loss: 1.921 Test Acc: 0.104
Validation loss decreased (-0.099981 --> -0.103684).  Saving model ...
Epoch: 5 cost time: 0.7603867053985596
Epoch: 5, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.892 Vali Acc: 0.107 Test Loss: 1.892 Test Acc: 0.107
Validation loss decreased (-0.103684 --> -0.107388).  Saving model ...
Epoch: 6 cost time: 0.7109527587890625
Epoch: 6, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.860 Vali Acc: 0.104 Test Loss: 1.860 Test Acc: 0.104
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9507255554199219
Epoch: 7, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.827 Vali Acc: 0.111 Test Loss: 1.827 Test Acc: 0.111
Validation loss decreased (-0.107388 --> -0.111093).  Saving model ...
Epoch: 8 cost time: 0.8050315380096436
Epoch: 8, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.797 Vali Acc: 0.137 Test Loss: 1.797 Test Acc: 0.137
Validation loss decreased (-0.111093 --> -0.137019).  Saving model ...
Epoch: 9 cost time: 0.8155238628387451
Epoch: 9, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.768 Vali Acc: 0.167 Test Loss: 1.768 Test Acc: 0.167
Validation loss decreased (-0.137019 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 1.0406696796417236
Epoch: 10, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.741 Vali Acc: 0.248 Test Loss: 1.741 Test Acc: 0.248
Validation loss decreased (-0.166649 --> -0.248131).  Saving model ...
Epoch: 11 cost time: 0.8716766834259033
Epoch: 11, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.717 Vali Acc: 0.270 Test Loss: 1.717 Test Acc: 0.270
Validation loss decreased (-0.248131 --> -0.270353).  Saving model ...
Epoch: 12 cost time: 0.8429980278015137
Epoch: 12, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.695 Vali Acc: 0.293 Test Loss: 1.695 Test Acc: 0.293
Validation loss decreased (-0.270353 --> -0.292576).  Saving model ...
Epoch: 13 cost time: 0.7920138835906982
Epoch: 13, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.674 Vali Acc: 0.315 Test Loss: 1.674 Test Acc: 0.315
Validation loss decreased (-0.292576 --> -0.314798).  Saving model ...
Epoch: 14 cost time: 0.7343134880065918
Epoch: 14, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.655 Vali Acc: 0.348 Test Loss: 1.655 Test Acc: 0.348
Validation loss decreased (-0.314798 --> -0.348132).  Saving model ...
Epoch: 15 cost time: 1.009185791015625
Epoch: 15, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.635 Vali Acc: 0.359 Test Loss: 1.635 Test Acc: 0.359
Validation loss decreased (-0.348132 --> -0.359243).  Saving model ...
Epoch: 16 cost time: 0.7865109443664551
Epoch: 16, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.614 Vali Acc: 0.400 Test Loss: 1.614 Test Acc: 0.400
Validation loss decreased (-0.359243 --> -0.399984).  Saving model ...
Epoch: 17 cost time: 1.0700058937072754
Epoch: 17, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.591 Vali Acc: 0.407 Test Loss: 1.591 Test Acc: 0.407
Validation loss decreased (-0.399984 --> -0.407391).  Saving model ...
Epoch: 18 cost time: 0.9399576187133789
Epoch: 18, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.568 Vali Acc: 0.415 Test Loss: 1.568 Test Acc: 0.415
Validation loss decreased (-0.407391 --> -0.414799).  Saving model ...
Epoch: 19 cost time: 0.8544764518737793
Epoch: 19, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.542 Vali Acc: 0.452 Test Loss: 1.542 Test Acc: 0.452
Validation loss decreased (-0.414799 --> -0.451836).  Saving model ...
Epoch: 20 cost time: 0.6488490104675293
Epoch: 20, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.514 Vali Acc: 0.496 Test Loss: 1.514 Test Acc: 0.496
Validation loss decreased (-0.451836 --> -0.496281).  Saving model ...
Epoch: 21 cost time: 0.729851484298706
Epoch: 21, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.484 Vali Acc: 0.563 Test Loss: 1.484 Test Acc: 0.563
Validation loss decreased (-0.496281 --> -0.562948).  Saving model ...
Epoch: 22 cost time: 0.8296232223510742
Epoch: 22, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.454 Vali Acc: 0.626 Test Loss: 1.454 Test Acc: 0.626
Validation loss decreased (-0.562948 --> -0.625911).  Saving model ...
Epoch: 23 cost time: 0.9394822120666504
Epoch: 23, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.422 Vali Acc: 0.637 Test Loss: 1.422 Test Acc: 0.637
Validation loss decreased (-0.625911 --> -0.637023).  Saving model ...
Epoch: 24 cost time: 0.9101965427398682
Epoch: 24, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.389 Vali Acc: 0.652 Test Loss: 1.389 Test Acc: 0.652
Validation loss decreased (-0.637023 --> -0.651838).  Saving model ...
Epoch: 25 cost time: 0.843407392501831
Epoch: 25, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.355 Vali Acc: 0.656 Test Loss: 1.355 Test Acc: 0.656
Validation loss decreased (-0.651838 --> -0.655542).  Saving model ...
Epoch: 26 cost time: 0.9121646881103516
Epoch: 26, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.319 Vali Acc: 0.700 Test Loss: 1.319 Test Acc: 0.700
Validation loss decreased (-0.655542 --> -0.699987).  Saving model ...
Epoch: 27 cost time: 0.9171898365020752
Epoch: 27, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.283 Vali Acc: 0.700 Test Loss: 1.283 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699987).  Saving model ...
Epoch: 28 cost time: 0.8059732913970947
Epoch: 28, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.245 Vali Acc: 0.711 Test Loss: 1.245 Test Acc: 0.711
Validation loss decreased (-0.699987 --> -0.711099).  Saving model ...
Epoch: 29 cost time: 0.7156655788421631
Epoch: 29, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.206 Vali Acc: 0.737 Test Loss: 1.206 Test Acc: 0.737
Validation loss decreased (-0.711099 --> -0.737025).  Saving model ...
Epoch: 30 cost time: 0.8773376941680908
Epoch: 30, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.169 Vali Acc: 0.752 Test Loss: 1.169 Test Acc: 0.752
Validation loss decreased (-0.737025 --> -0.751840).  Saving model ...
Epoch: 31 cost time: 0.7562148571014404
Epoch: 31, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.131 Vali Acc: 0.756 Test Loss: 1.131 Test Acc: 0.756
Validation loss decreased (-0.751840 --> -0.755544).  Saving model ...
Epoch: 32 cost time: 0.6888406276702881
Epoch: 32, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.093 Vali Acc: 0.770 Test Loss: 1.093 Test Acc: 0.770
Validation loss decreased (-0.755544 --> -0.770359).  Saving model ...
Epoch: 33 cost time: 0.9288280010223389
Epoch: 33, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.055 Vali Acc: 0.778 Test Loss: 1.055 Test Acc: 0.778
Validation loss decreased (-0.770359 --> -0.777767).  Saving model ...
Epoch: 34 cost time: 0.6553902626037598
Epoch: 34, Steps: 2 | Train Loss: 0.948 Vali Loss: 1.019 Vali Acc: 0.778 Test Loss: 1.019 Test Acc: 0.778
Validation loss decreased (-0.777767 --> -0.777768).  Saving model ...
Epoch: 35 cost time: 0.8559560775756836
Epoch: 35, Steps: 2 | Train Loss: 0.908 Vali Loss: 0.983 Vali Acc: 0.789 Test Loss: 0.983 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788879).  Saving model ...
Epoch: 36 cost time: 0.809586763381958
Epoch: 36, Steps: 2 | Train Loss: 0.901 Vali Loss: 0.949 Vali Acc: 0.785 Test Loss: 0.949 Test Acc: 0.785
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.797555685043335
Epoch: 37, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.915 Vali Acc: 0.796 Test Loss: 0.915 Test Acc: 0.796
Validation loss decreased (-0.788879 --> -0.796287).  Saving model ...
Epoch: 38 cost time: 0.8020141124725342
Epoch: 38, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.883 Vali Acc: 0.807 Test Loss: 0.883 Test Acc: 0.807
Validation loss decreased (-0.796287 --> -0.807399).  Saving model ...
Epoch: 39 cost time: 0.7383666038513184
Epoch: 39, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.851 Vali Acc: 0.822 Test Loss: 0.851 Test Acc: 0.822
Validation loss decreased (-0.807399 --> -0.822214).  Saving model ...
Epoch: 40 cost time: 0.874924898147583
Epoch: 40, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.821 Vali Acc: 0.826 Test Loss: 0.821 Test Acc: 0.826
Validation loss decreased (-0.822214 --> -0.825918).  Saving model ...
Epoch: 41 cost time: 0.9360201358795166
Epoch: 41, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.792 Vali Acc: 0.830 Test Loss: 0.792 Test Acc: 0.830
Validation loss decreased (-0.825918 --> -0.829622).  Saving model ...
Epoch: 42 cost time: 0.7389886379241943
Epoch: 42, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.763 Vali Acc: 0.830 Test Loss: 0.763 Test Acc: 0.830
Validation loss decreased (-0.829622 --> -0.829622).  Saving model ...
Epoch: 43 cost time: 0.971505880355835
Epoch: 43, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.736 Vali Acc: 0.833 Test Loss: 0.736 Test Acc: 0.833
Validation loss decreased (-0.829622 --> -0.833326).  Saving model ...
Epoch: 44 cost time: 0.7528352737426758
Epoch: 44, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.712 Vali Acc: 0.844 Test Loss: 0.712 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 45 cost time: 0.8208670616149902
Epoch: 45, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.688 Vali Acc: 0.852 Test Loss: 0.688 Test Acc: 0.852
Validation loss decreased (-0.844437 --> -0.851845).  Saving model ...
Epoch: 46 cost time: 0.842036247253418
Epoch: 46, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.665 Vali Acc: 0.852 Test Loss: 0.665 Test Acc: 0.852
Validation loss decreased (-0.851845 --> -0.851845).  Saving model ...
Epoch: 47 cost time: 1.0100362300872803
Epoch: 47, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.644 Vali Acc: 0.852 Test Loss: 0.644 Test Acc: 0.852
Validation loss decreased (-0.851845 --> -0.851845).  Saving model ...
Epoch: 48 cost time: 0.9714367389678955
Epoch: 48, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.624 Vali Acc: 0.859 Test Loss: 0.624 Test Acc: 0.859
Validation loss decreased (-0.851845 --> -0.859253).  Saving model ...
Epoch: 49 cost time: 0.7528011798858643
Epoch: 49, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.605 Vali Acc: 0.852 Test Loss: 0.605 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7929930686950684
Epoch: 50, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.588 Vali Acc: 0.856 Test Loss: 0.588 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8397109508514404
Epoch: 51, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.573 Vali Acc: 0.852 Test Loss: 0.573 Test Acc: 0.852
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9483978748321533
Epoch: 52, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.558 Vali Acc: 0.856 Test Loss: 0.558 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8360788822174072
Epoch: 53, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.544 Vali Acc: 0.856 Test Loss: 0.544 Test Acc: 0.856
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.94559645652771
Epoch: 54, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.531 Vali Acc: 0.863 Test Loss: 0.531 Test Acc: 0.863
Validation loss decreased (-0.859253 --> -0.862958).  Saving model ...
Epoch: 55 cost time: 0.8563523292541504
Epoch: 55, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.519 Vali Acc: 0.870 Test Loss: 0.519 Test Acc: 0.870
Validation loss decreased (-0.862958 --> -0.870365).  Saving model ...
Epoch: 56 cost time: 0.7918386459350586
Epoch: 56, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.505 Vali Acc: 0.867 Test Loss: 0.505 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.802711009979248
Epoch: 57, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.493 Vali Acc: 0.867 Test Loss: 0.493 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.8561460971832275
Epoch: 58, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.9514784812927246
Epoch: 59, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.471 Vali Acc: 0.867 Test Loss: 0.471 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.7947041988372803
Epoch: 60, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.461 Vali Acc: 0.867 Test Loss: 0.461 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.8864102363586426
Epoch: 61, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.451 Vali Acc: 0.867 Test Loss: 0.451 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.8211517333984375
Epoch: 62, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.443 Vali Acc: 0.870 Test Loss: 0.443 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870366).  Saving model ...
Epoch: 63 cost time: 0.7814218997955322
Epoch: 63, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.437 Vali Acc: 0.878 Test Loss: 0.437 Test Acc: 0.878
Validation loss decreased (-0.870366 --> -0.877773).  Saving model ...
Epoch: 64 cost time: 0.8229920864105225
Epoch: 64, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.429 Vali Acc: 0.881 Test Loss: 0.429 Test Acc: 0.881
Validation loss decreased (-0.877773 --> -0.881477).  Saving model ...
Epoch: 65 cost time: 1.0727407932281494
Epoch: 65, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.423 Vali Acc: 0.885 Test Loss: 0.423 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885181).  Saving model ...
Epoch: 66 cost time: 0.8402626514434814
Epoch: 66, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.418 Vali Acc: 0.881 Test Loss: 0.418 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8233394622802734
Epoch: 67, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.412 Vali Acc: 0.881 Test Loss: 0.412 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7477304935455322
Epoch: 68, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.405 Vali Acc: 0.881 Test Loss: 0.405 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.9290695190429688
Epoch: 69, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.401 Vali Acc: 0.881 Test Loss: 0.401 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 1.04427170753479
Epoch: 70, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.397 Vali Acc: 0.881 Test Loss: 0.397 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.7801940441131592
Epoch: 71, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.392 Vali Acc: 0.878 Test Loss: 0.392 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.8907797336578369
Epoch: 72, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.387 Vali Acc: 0.874 Test Loss: 0.387 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 73 cost time: 0.8850493431091309
Epoch: 73, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.382 Vali Acc: 0.878 Test Loss: 0.382 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 74 cost time: 0.8071112632751465
Epoch: 74, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.377 Vali Acc: 0.874 Test Loss: 0.377 Test Acc: 0.874
EarlyStopping counter: 9 out of 10
Epoch: 75 cost time: 0.9711086750030518
Epoch: 75, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.372 Vali Acc: 0.874 Test Loss: 0.372 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 185206
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.81471586227417
Epoch: 1, Steps: 2 | Train Loss: 2.012 Vali Loss: 1.985 Vali Acc: 0.174 Test Loss: 1.985 Test Acc: 0.174
Validation loss decreased (inf --> -0.174054).  Saving model ...
Epoch: 2 cost time: 0.8404457569122314
Epoch: 2, Steps: 2 | Train Loss: 1.908 Vali Loss: 1.965 Vali Acc: 0.174 Test Loss: 1.965 Test Acc: 0.174
Validation loss decreased (-0.174054 --> -0.174054).  Saving model ...
Epoch: 3 cost time: 0.8922955989837646
Epoch: 3, Steps: 2 | Train Loss: 2.040 Vali Loss: 1.948 Vali Acc: 0.170 Test Loss: 1.948 Test Acc: 0.170
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0533294677734375
Epoch: 4, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.929 Vali Acc: 0.170 Test Loss: 1.929 Test Acc: 0.170
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.7465159893035889
Epoch: 5, Steps: 2 | Train Loss: 1.987 Vali Loss: 1.905 Vali Acc: 0.163 Test Loss: 1.905 Test Acc: 0.163
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7797396183013916
Epoch: 6, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.878 Vali Acc: 0.163 Test Loss: 1.878 Test Acc: 0.163
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.9421091079711914
Epoch: 7, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.851 Vali Acc: 0.130 Test Loss: 1.851 Test Acc: 0.130
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.8564236164093018
Epoch: 8, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.825 Vali Acc: 0.130 Test Loss: 1.825 Test Acc: 0.130
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 0.8930821418762207
Epoch: 9, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.802 Vali Acc: 0.156 Test Loss: 1.802 Test Acc: 0.156
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.7743182182312012
Epoch: 10, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.780 Vali Acc: 0.207 Test Loss: 1.780 Test Acc: 0.207
Validation loss decreased (-0.174054 --> -0.207390).  Saving model ...
Epoch: 11 cost time: 0.7624990940093994
Epoch: 11, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.759 Vali Acc: 0.248 Test Loss: 1.759 Test Acc: 0.248
Validation loss decreased (-0.207390 --> -0.248131).  Saving model ...
Epoch: 12 cost time: 0.653416633605957
Epoch: 12, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.738 Vali Acc: 0.307 Test Loss: 1.738 Test Acc: 0.307
Validation loss decreased (-0.248131 --> -0.307390).  Saving model ...
Epoch: 13 cost time: 0.7933704853057861
Epoch: 13, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.717 Vali Acc: 0.374 Test Loss: 1.717 Test Acc: 0.374
Validation loss decreased (-0.307390 --> -0.374057).  Saving model ...
Epoch: 14 cost time: 0.807971715927124
Epoch: 14, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.695 Vali Acc: 0.400 Test Loss: 1.695 Test Acc: 0.400
Validation loss decreased (-0.374057 --> -0.399983).  Saving model ...
Epoch: 15 cost time: 0.7132272720336914
Epoch: 15, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.671 Vali Acc: 0.419 Test Loss: 1.671 Test Acc: 0.419
Validation loss decreased (-0.399983 --> -0.418502).  Saving model ...
Epoch: 16 cost time: 0.9483664035797119
Epoch: 16, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.645 Vali Acc: 0.437 Test Loss: 1.645 Test Acc: 0.437
Validation loss decreased (-0.418502 --> -0.437021).  Saving model ...
Epoch: 17 cost time: 0.7882423400878906
Epoch: 17, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.619 Vali Acc: 0.452 Test Loss: 1.619 Test Acc: 0.452
Validation loss decreased (-0.437021 --> -0.451836).  Saving model ...
Epoch: 18 cost time: 0.7637040615081787
Epoch: 18, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.591 Vali Acc: 0.470 Test Loss: 1.591 Test Acc: 0.470
Validation loss decreased (-0.451836 --> -0.470354).  Saving model ...
Epoch: 19 cost time: 0.8108267784118652
Epoch: 19, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.562 Vali Acc: 0.493 Test Loss: 1.562 Test Acc: 0.493
Validation loss decreased (-0.470354 --> -0.492577).  Saving model ...
Epoch: 20 cost time: 0.7715916633605957
Epoch: 20, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.530 Vali Acc: 0.519 Test Loss: 1.530 Test Acc: 0.519
Validation loss decreased (-0.492577 --> -0.518503).  Saving model ...
Epoch: 21 cost time: 0.6666579246520996
Epoch: 21, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.499 Vali Acc: 0.533 Test Loss: 1.499 Test Acc: 0.533
Validation loss decreased (-0.518503 --> -0.533318).  Saving model ...
Epoch: 22 cost time: 0.7311489582061768
Epoch: 22, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.468 Vali Acc: 0.563 Test Loss: 1.468 Test Acc: 0.563
Validation loss decreased (-0.533318 --> -0.562948).  Saving model ...
Epoch: 23 cost time: 0.7566015720367432
Epoch: 23, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.434 Vali Acc: 0.585 Test Loss: 1.434 Test Acc: 0.585
Validation loss decreased (-0.562948 --> -0.585171).  Saving model ...
Epoch: 24 cost time: 0.8685307502746582
Epoch: 24, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.400 Vali Acc: 0.619 Test Loss: 1.400 Test Acc: 0.619
Validation loss decreased (-0.585171 --> -0.618505).  Saving model ...
Epoch: 25 cost time: 0.7476794719696045
Epoch: 25, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.365 Vali Acc: 0.659 Test Loss: 1.365 Test Acc: 0.659
Validation loss decreased (-0.618505 --> -0.659246).  Saving model ...
Epoch: 26 cost time: 0.7883956432342529
Epoch: 26, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.328 Vali Acc: 0.674 Test Loss: 1.328 Test Acc: 0.674
Validation loss decreased (-0.659246 --> -0.674061).  Saving model ...
Epoch: 27 cost time: 0.8380639553070068
Epoch: 27, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.290 Vali Acc: 0.685 Test Loss: 1.290 Test Acc: 0.685
Validation loss decreased (-0.674061 --> -0.685172).  Saving model ...
Epoch: 28 cost time: 0.778942346572876
Epoch: 28, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.251 Vali Acc: 0.693 Test Loss: 1.251 Test Acc: 0.693
Validation loss decreased (-0.685172 --> -0.692580).  Saving model ...
Epoch: 29 cost time: 0.7563161849975586
Epoch: 29, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.214 Vali Acc: 0.700 Test Loss: 1.214 Test Acc: 0.700
Validation loss decreased (-0.692580 --> -0.699988).  Saving model ...
Epoch: 30 cost time: 0.8717639446258545
Epoch: 30, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.177 Vali Acc: 0.719 Test Loss: 1.177 Test Acc: 0.719
Validation loss decreased (-0.699988 --> -0.718507).  Saving model ...
Epoch: 31 cost time: 0.6878888607025146
Epoch: 31, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.138 Vali Acc: 0.733 Test Loss: 1.138 Test Acc: 0.733
Validation loss decreased (-0.718507 --> -0.733322).  Saving model ...
Epoch: 32 cost time: 0.6598546504974365
Epoch: 32, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.101 Vali Acc: 0.752 Test Loss: 1.101 Test Acc: 0.752
Validation loss decreased (-0.733322 --> -0.751841).  Saving model ...
Epoch: 33 cost time: 0.8099911212921143
Epoch: 33, Steps: 2 | Train Loss: 0.947 Vali Loss: 1.061 Vali Acc: 0.763 Test Loss: 1.061 Test Acc: 0.763
Validation loss decreased (-0.751841 --> -0.762952).  Saving model ...
Epoch: 34 cost time: 0.6975419521331787
Epoch: 34, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.023 Vali Acc: 0.785 Test Loss: 1.023 Test Acc: 0.785
Validation loss decreased (-0.762952 --> -0.785175).  Saving model ...
Epoch: 35 cost time: 0.6607658863067627
Epoch: 35, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.987 Vali Acc: 0.785 Test Loss: 0.987 Test Acc: 0.785
Validation loss decreased (-0.785175 --> -0.785175).  Saving model ...
Epoch: 36 cost time: 0.8457963466644287
Epoch: 36, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.951 Vali Acc: 0.819 Test Loss: 0.951 Test Acc: 0.819
Validation loss decreased (-0.785175 --> -0.818509).  Saving model ...
Epoch: 37 cost time: 0.9365642070770264
Epoch: 37, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.917 Vali Acc: 0.826 Test Loss: 0.917 Test Acc: 0.826
Validation loss decreased (-0.818509 --> -0.825917).  Saving model ...
Epoch: 38 cost time: 0.7851114273071289
Epoch: 38, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.882 Vali Acc: 0.833 Test Loss: 0.882 Test Acc: 0.833
Validation loss decreased (-0.825917 --> -0.833325).  Saving model ...
Epoch: 39 cost time: 1.0092203617095947
Epoch: 39, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.848 Vali Acc: 0.844 Test Loss: 0.848 Test Acc: 0.844
Validation loss decreased (-0.833325 --> -0.844436).  Saving model ...
Epoch: 40 cost time: 0.7761595249176025
Epoch: 40, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.815 Vali Acc: 0.852 Test Loss: 0.815 Test Acc: 0.852
Validation loss decreased (-0.844436 --> -0.851844).  Saving model ...
Epoch: 41 cost time: 0.8452193737030029
Epoch: 41, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.784 Vali Acc: 0.856 Test Loss: 0.784 Test Acc: 0.856
Validation loss decreased (-0.851844 --> -0.855548).  Saving model ...
Epoch: 42 cost time: 0.8458216190338135
Epoch: 42, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.755 Vali Acc: 0.867 Test Loss: 0.755 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866659).  Saving model ...
Epoch: 43 cost time: 0.8758816719055176
Epoch: 43, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.728 Vali Acc: 0.867 Test Loss: 0.728 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 44 cost time: 0.822859525680542
Epoch: 44, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.701 Vali Acc: 0.874 Test Loss: 0.701 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874067).  Saving model ...
Epoch: 45 cost time: 0.7610518932342529
Epoch: 45, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.675 Vali Acc: 0.867 Test Loss: 0.675 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.9409377574920654
Epoch: 46, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.651 Vali Acc: 0.867 Test Loss: 0.651 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.01204252243042
Epoch: 47, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.628 Vali Acc: 0.878 Test Loss: 0.628 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877772).  Saving model ...
Epoch: 48 cost time: 1.099916934967041
Epoch: 48, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.607 Vali Acc: 0.885 Test Loss: 0.607 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885179).  Saving model ...
Epoch: 49 cost time: 0.9655439853668213
Epoch: 49, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.588 Vali Acc: 0.889 Test Loss: 0.588 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 50 cost time: 0.7958452701568604
Epoch: 50, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.571 Vali Acc: 0.889 Test Loss: 0.571 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 51 cost time: 0.7837033271789551
Epoch: 51, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.556 Vali Acc: 0.881 Test Loss: 0.556 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8511068820953369
Epoch: 52, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.542 Vali Acc: 0.881 Test Loss: 0.542 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9546668529510498
Epoch: 53, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.530 Vali Acc: 0.881 Test Loss: 0.530 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8914914131164551
Epoch: 54, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.520 Vali Acc: 0.878 Test Loss: 0.520 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.8355531692504883
Epoch: 55, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.508 Vali Acc: 0.885 Test Loss: 0.508 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.722559928894043
Epoch: 56, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.492 Vali Acc: 0.893 Test Loss: 0.492 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892588).  Saving model ...
Epoch: 57 cost time: 0.8881340026855469
Epoch: 57, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
Validation loss decreased (-0.892588 --> -0.899995).  Saving model ...
Epoch: 58 cost time: 0.8312854766845703
Epoch: 58, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.467 Vali Acc: 0.900 Test Loss: 0.467 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 59 cost time: 0.8408191204071045
Epoch: 59, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.456 Vali Acc: 0.896 Test Loss: 0.456 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 1.0043582916259766
Epoch: 60, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.446 Vali Acc: 0.904 Test Loss: 0.446 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 61 cost time: 0.8412365913391113
Epoch: 61, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7398757934570312
Epoch: 62, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.431 Vali Acc: 0.907 Test Loss: 0.431 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 63 cost time: 0.6603546142578125
Epoch: 63, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.426 Vali Acc: 0.900 Test Loss: 0.426 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.8478319644927979
Epoch: 64, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.418 Vali Acc: 0.900 Test Loss: 0.418 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 1.1351184844970703
Epoch: 65, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.410 Vali Acc: 0.896 Test Loss: 0.410 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8968255519866943
Epoch: 66, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.403 Vali Acc: 0.896 Test Loss: 0.403 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 1.120926856994629
Epoch: 67, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.398 Vali Acc: 0.896 Test Loss: 0.398 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.871342658996582
Epoch: 68, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.392 Vali Acc: 0.907 Test Loss: 0.392 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 69 cost time: 0.7462916374206543
Epoch: 69, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.389 Vali Acc: 0.911 Test Loss: 0.389 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 70 cost time: 0.726409912109375
Epoch: 70, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.384 Vali Acc: 0.911 Test Loss: 0.384 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 71 cost time: 0.8216588497161865
Epoch: 71, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.376 Vali Acc: 0.911 Test Loss: 0.376 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 72 cost time: 0.7794182300567627
Epoch: 72, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.372 Vali Acc: 0.900 Test Loss: 0.372 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.7778868675231934
Epoch: 73, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.368 Vali Acc: 0.911 Test Loss: 0.368 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 74 cost time: 0.892570972442627
Epoch: 74, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.365 Vali Acc: 0.907 Test Loss: 0.365 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.8700447082519531
Epoch: 75, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.365 Vali Acc: 0.919 Test Loss: 0.365 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 76 cost time: 0.7466022968292236
Epoch: 76, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.359 Vali Acc: 0.907 Test Loss: 0.359 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7744050025939941
Epoch: 77, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.353 Vali Acc: 0.911 Test Loss: 0.353 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.8620152473449707
Epoch: 78, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.351 Vali Acc: 0.911 Test Loss: 0.351 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 1.0227940082550049
Epoch: 79, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.349 Vali Acc: 0.911 Test Loss: 0.349 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.8419764041900635
Epoch: 80, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.353 Vali Acc: 0.911 Test Loss: 0.353 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.9112420082092285
Epoch: 81, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.351 Vali Acc: 0.904 Test Loss: 0.351 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.797565221786499
Epoch: 82, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.347 Vali Acc: 0.904 Test Loss: 0.347 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.9359078407287598
Epoch: 83, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.336 Vali Acc: 0.911 Test Loss: 0.336 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.78481125831604
Epoch: 84, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.332 Vali Acc: 0.911 Test Loss: 0.332 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.9795496463775635
Epoch: 85, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.330 Vali Acc: 0.904 Test Loss: 0.330 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 184854
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.802414655685425
Epoch: 1, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.802 Vali Acc: 0.270 Test Loss: 1.802 Test Acc: 0.270
Validation loss decreased (inf --> -0.270352).  Saving model ...
Epoch: 2 cost time: 0.829246997833252
Epoch: 2, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.786 Vali Acc: 0.278 Test Loss: 1.786 Test Acc: 0.278
Validation loss decreased (-0.270352 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.8357722759246826
Epoch: 3, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.774 Vali Acc: 0.285 Test Loss: 1.774 Test Acc: 0.285
Validation loss decreased (-0.277760 --> -0.285167).  Saving model ...
Epoch: 4 cost time: 0.783043384552002
Epoch: 4, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.762 Vali Acc: 0.278 Test Loss: 1.762 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8665895462036133
Epoch: 5, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.747 Vali Acc: 0.267 Test Loss: 1.747 Test Acc: 0.267
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.8158223628997803
Epoch: 6, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.728 Vali Acc: 0.270 Test Loss: 1.728 Test Acc: 0.270
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 0.9253659248352051
Epoch: 7, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.709 Vali Acc: 0.278 Test Loss: 1.709 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 0.77341628074646
Epoch: 8, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.689 Vali Acc: 0.278 Test Loss: 1.689 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 0.7672827243804932
Epoch: 9, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.669 Vali Acc: 0.311 Test Loss: 1.669 Test Acc: 0.311
Validation loss decreased (-0.285167 --> -0.311094).  Saving model ...
Epoch: 10 cost time: 0.8226866722106934
Epoch: 10, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.649 Vali Acc: 0.348 Test Loss: 1.649 Test Acc: 0.348
Validation loss decreased (-0.311094 --> -0.348132).  Saving model ...
Epoch: 11 cost time: 0.710777759552002
Epoch: 11, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.628 Vali Acc: 0.356 Test Loss: 1.628 Test Acc: 0.356
Validation loss decreased (-0.348132 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 0.8719558715820312
Epoch: 12, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.607 Vali Acc: 0.407 Test Loss: 1.607 Test Acc: 0.407
Validation loss decreased (-0.355539 --> -0.407391).  Saving model ...
Epoch: 13 cost time: 0.7362010478973389
Epoch: 13, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.585 Vali Acc: 0.459 Test Loss: 1.585 Test Acc: 0.459
Validation loss decreased (-0.407391 --> -0.459243).  Saving model ...
Epoch: 14 cost time: 0.8933048248291016
Epoch: 14, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.561 Vali Acc: 0.489 Test Loss: 1.561 Test Acc: 0.489
Validation loss decreased (-0.459243 --> -0.488873).  Saving model ...
Epoch: 15 cost time: 0.9878475666046143
Epoch: 15, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.536 Vali Acc: 0.507 Test Loss: 1.536 Test Acc: 0.507
Validation loss decreased (-0.488873 --> -0.507392).  Saving model ...
Epoch: 16 cost time: 0.7205839157104492
Epoch: 16, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.510 Vali Acc: 0.519 Test Loss: 1.510 Test Acc: 0.519
Validation loss decreased (-0.507392 --> -0.518503).  Saving model ...
Epoch: 17 cost time: 0.8264956474304199
Epoch: 17, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.482 Vali Acc: 0.548 Test Loss: 1.482 Test Acc: 0.548
Validation loss decreased (-0.518503 --> -0.548133).  Saving model ...
Epoch: 18 cost time: 0.7709145545959473
Epoch: 18, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.452 Vali Acc: 0.556 Test Loss: 1.452 Test Acc: 0.556
Validation loss decreased (-0.548133 --> -0.555541).  Saving model ...
Epoch: 19 cost time: 0.7486741542816162
Epoch: 19, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.422 Vali Acc: 0.570 Test Loss: 1.422 Test Acc: 0.570
Validation loss decreased (-0.555541 --> -0.570356).  Saving model ...
Epoch: 20 cost time: 0.7451362609863281
Epoch: 20, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.390 Vali Acc: 0.585 Test Loss: 1.390 Test Acc: 0.585
Validation loss decreased (-0.570356 --> -0.585171).  Saving model ...
Epoch: 21 cost time: 0.7509860992431641
Epoch: 21, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.357 Vali Acc: 0.589 Test Loss: 1.357 Test Acc: 0.589
Validation loss decreased (-0.585171 --> -0.588875).  Saving model ...
Epoch: 22 cost time: 0.8215062618255615
Epoch: 22, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.323 Vali Acc: 0.604 Test Loss: 1.323 Test Acc: 0.604
Validation loss decreased (-0.588875 --> -0.603690).  Saving model ...
Epoch: 23 cost time: 0.9244174957275391
Epoch: 23, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.288 Vali Acc: 0.619 Test Loss: 1.288 Test Acc: 0.619
Validation loss decreased (-0.603690 --> -0.618506).  Saving model ...
Epoch: 24 cost time: 0.7750086784362793
Epoch: 24, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.252 Vali Acc: 0.637 Test Loss: 1.252 Test Acc: 0.637
Validation loss decreased (-0.618506 --> -0.637025).  Saving model ...
Epoch: 25 cost time: 0.8665213584899902
Epoch: 25, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.216 Vali Acc: 0.637 Test Loss: 1.216 Test Acc: 0.637
Validation loss decreased (-0.637025 --> -0.637025).  Saving model ...
Epoch: 26 cost time: 0.8239994049072266
Epoch: 26, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.179 Vali Acc: 0.648 Test Loss: 1.179 Test Acc: 0.648
Validation loss decreased (-0.637025 --> -0.648136).  Saving model ...
Epoch: 27 cost time: 0.718386173248291
Epoch: 27, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.142 Vali Acc: 0.659 Test Loss: 1.142 Test Acc: 0.659
Validation loss decreased (-0.648136 --> -0.659248).  Saving model ...
Epoch: 28 cost time: 0.7506973743438721
Epoch: 28, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.106 Vali Acc: 0.663 Test Loss: 1.106 Test Acc: 0.663
Validation loss decreased (-0.659248 --> -0.662952).  Saving model ...
Epoch: 29 cost time: 0.7321920394897461
Epoch: 29, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.070 Vali Acc: 0.678 Test Loss: 1.070 Test Acc: 0.678
Validation loss decreased (-0.662952 --> -0.677767).  Saving model ...
Epoch: 30 cost time: 0.7262604236602783
Epoch: 30, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.036 Vali Acc: 0.685 Test Loss: 1.036 Test Acc: 0.685
Validation loss decreased (-0.677767 --> -0.685175).  Saving model ...
Epoch: 31 cost time: 0.9739007949829102
Epoch: 31, Steps: 2 | Train Loss: 0.969 Vali Loss: 1.003 Vali Acc: 0.693 Test Loss: 1.003 Test Acc: 0.693
Validation loss decreased (-0.685175 --> -0.692583).  Saving model ...
Epoch: 32 cost time: 0.7760584354400635
Epoch: 32, Steps: 2 | Train Loss: 0.981 Vali Loss: 0.970 Vali Acc: 0.696 Test Loss: 0.970 Test Acc: 0.696
Validation loss decreased (-0.692583 --> -0.696287).  Saving model ...
Epoch: 33 cost time: 0.6665291786193848
Epoch: 33, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.938 Vali Acc: 0.707 Test Loss: 0.938 Test Acc: 0.707
Validation loss decreased (-0.696287 --> -0.707398).  Saving model ...
Epoch: 34 cost time: 0.7648594379425049
Epoch: 34, Steps: 2 | Train Loss: 0.827 Vali Loss: 0.909 Vali Acc: 0.722 Test Loss: 0.909 Test Acc: 0.722
Validation loss decreased (-0.707398 --> -0.722213).  Saving model ...
Epoch: 35 cost time: 0.9328482151031494
Epoch: 35, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.879 Vali Acc: 0.737 Test Loss: 0.879 Test Acc: 0.737
Validation loss decreased (-0.722213 --> -0.737028).  Saving model ...
Epoch: 36 cost time: 0.743523120880127
Epoch: 36, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.851 Vali Acc: 0.741 Test Loss: 0.851 Test Acc: 0.741
Validation loss decreased (-0.737028 --> -0.740732).  Saving model ...
Epoch: 37 cost time: 0.7361099720001221
Epoch: 37, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.823 Vali Acc: 0.748 Test Loss: 0.823 Test Acc: 0.748
Validation loss decreased (-0.740732 --> -0.748140).  Saving model ...
Epoch: 38 cost time: 0.7761080265045166
Epoch: 38, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.796 Vali Acc: 0.763 Test Loss: 0.796 Test Acc: 0.763
Validation loss decreased (-0.748140 --> -0.762955).  Saving model ...
Epoch: 39 cost time: 0.7308335304260254
Epoch: 39, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.771 Vali Acc: 0.770 Test Loss: 0.771 Test Acc: 0.770
Validation loss decreased (-0.762955 --> -0.770363).  Saving model ...
Epoch: 40 cost time: 0.7681255340576172
Epoch: 40, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.747 Vali Acc: 0.781 Test Loss: 0.747 Test Acc: 0.781
Validation loss decreased (-0.770363 --> -0.781474).  Saving model ...
Epoch: 41 cost time: 0.9251625537872314
Epoch: 41, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.724 Vali Acc: 0.789 Test Loss: 0.724 Test Acc: 0.789
Validation loss decreased (-0.781474 --> -0.788882).  Saving model ...
Epoch: 42 cost time: 1.0271120071411133
Epoch: 42, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.703 Vali Acc: 0.789 Test Loss: 0.703 Test Acc: 0.789
Validation loss decreased (-0.788882 --> -0.788882).  Saving model ...
Epoch: 43 cost time: 1.0318048000335693
Epoch: 43, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.683 Vali Acc: 0.800 Test Loss: 0.683 Test Acc: 0.800
Validation loss decreased (-0.788882 --> -0.799993).  Saving model ...
Epoch: 44 cost time: 0.6995019912719727
Epoch: 44, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.663 Vali Acc: 0.815 Test Loss: 0.663 Test Acc: 0.815
Validation loss decreased (-0.799993 --> -0.814808).  Saving model ...
Epoch: 45 cost time: 0.7459309101104736
Epoch: 45, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.644 Vali Acc: 0.822 Test Loss: 0.644 Test Acc: 0.822
Validation loss decreased (-0.814808 --> -0.822216).  Saving model ...
Epoch: 46 cost time: 0.8083696365356445
Epoch: 46, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.627 Vali Acc: 0.830 Test Loss: 0.627 Test Acc: 0.830
Validation loss decreased (-0.822216 --> -0.829623).  Saving model ...
Epoch: 47 cost time: 0.9130001068115234
Epoch: 47, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.610 Vali Acc: 0.833 Test Loss: 0.610 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833327).  Saving model ...
Epoch: 48 cost time: 1.0317063331604004
Epoch: 48, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.594 Vali Acc: 0.844 Test Loss: 0.594 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 49 cost time: 1.1395487785339355
Epoch: 49, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 50 cost time: 0.9974246025085449
Epoch: 50, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.563 Vali Acc: 0.859 Test Loss: 0.563 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859254).  Saving model ...
Epoch: 51 cost time: 1.2574927806854248
Epoch: 51, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.550 Vali Acc: 0.859 Test Loss: 0.550 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 52 cost time: 0.695246696472168
Epoch: 52, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.537 Vali Acc: 0.859 Test Loss: 0.537 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 53 cost time: 0.9999954700469971
Epoch: 53, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.526 Vali Acc: 0.863 Test Loss: 0.526 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 54 cost time: 0.864417552947998
Epoch: 54, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.514 Vali Acc: 0.867 Test Loss: 0.514 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 55 cost time: 0.7700662612915039
Epoch: 55, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.503 Vali Acc: 0.870 Test Loss: 0.503 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870365).  Saving model ...
Epoch: 56 cost time: 0.8285341262817383
Epoch: 56, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.494 Vali Acc: 0.874 Test Loss: 0.494 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 57 cost time: 0.6917579174041748
Epoch: 57, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.484 Vali Acc: 0.881 Test Loss: 0.484 Test Acc: 0.881
Validation loss decreased (-0.874069 --> -0.881477).  Saving model ...
Epoch: 58 cost time: 0.85160231590271
Epoch: 58, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.474 Vali Acc: 0.889 Test Loss: 0.474 Test Acc: 0.889
Validation loss decreased (-0.881477 --> -0.888884).  Saving model ...
Epoch: 59 cost time: 0.7434706687927246
Epoch: 59, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.465 Vali Acc: 0.885 Test Loss: 0.465 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.9499204158782959
Epoch: 60, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.458 Vali Acc: 0.885 Test Loss: 0.458 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7756350040435791
Epoch: 61, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.451 Vali Acc: 0.885 Test Loss: 0.451 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 1.0313255786895752
Epoch: 62, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.445 Vali Acc: 0.889 Test Loss: 0.445 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 63 cost time: 0.7538599967956543
Epoch: 63, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.439 Vali Acc: 0.889 Test Loss: 0.439 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 64 cost time: 0.7523560523986816
Epoch: 64, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.434 Vali Acc: 0.896 Test Loss: 0.434 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896292).  Saving model ...
Epoch: 65 cost time: 0.7588891983032227
Epoch: 65, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 66 cost time: 0.7965860366821289
Epoch: 66, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.424 Vali Acc: 0.907 Test Loss: 0.424 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907403).  Saving model ...
Epoch: 67 cost time: 0.7719986438751221
Epoch: 67, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.418 Vali Acc: 0.896 Test Loss: 0.418 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7282652854919434
Epoch: 68, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.412 Vali Acc: 0.893 Test Loss: 0.412 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7897241115570068
Epoch: 69, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.407 Vali Acc: 0.893 Test Loss: 0.407 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.8523552417755127
Epoch: 70, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.400 Vali Acc: 0.896 Test Loss: 0.400 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.6580493450164795
Epoch: 71, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.395 Vali Acc: 0.896 Test Loss: 0.395 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.8375444412231445
Epoch: 72, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.390 Vali Acc: 0.896 Test Loss: 0.390 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.7668201923370361
Epoch: 73, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.386 Vali Acc: 0.904 Test Loss: 0.386 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.7353291511535645
Epoch: 74, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.383 Vali Acc: 0.907 Test Loss: 0.383 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907404).  Saving model ...
Epoch: 75 cost time: 0.720238208770752
Epoch: 75, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.380 Vali Acc: 0.904 Test Loss: 0.380 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8987541198730469
Epoch: 76, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.375 Vali Acc: 0.911 Test Loss: 0.375 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911107).  Saving model ...
Epoch: 77 cost time: 0.7453451156616211
Epoch: 77, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.369 Vali Acc: 0.907 Test Loss: 0.369 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8333940505981445
Epoch: 78, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.364 Vali Acc: 0.904 Test Loss: 0.364 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.7183654308319092
Epoch: 79, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.359 Vali Acc: 0.907 Test Loss: 0.359 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 1.0714378356933594
Epoch: 80, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.357 Vali Acc: 0.915 Test Loss: 0.357 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 81 cost time: 0.8567295074462891
Epoch: 81, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.354 Vali Acc: 0.915 Test Loss: 0.354 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 82 cost time: 0.7295436859130859
Epoch: 82, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.352 Vali Acc: 0.919 Test Loss: 0.352 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 83 cost time: 0.7167904376983643
Epoch: 83, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.349 Vali Acc: 0.919 Test Loss: 0.349 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 84 cost time: 0.7378983497619629
Epoch: 84, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.346 Vali Acc: 0.911 Test Loss: 0.346 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.744696855545044
Epoch: 85, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.343 Vali Acc: 0.915 Test Loss: 0.343 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.8918347358703613
Epoch: 86, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.340 Vali Acc: 0.919 Test Loss: 0.340 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 87 cost time: 0.8761789798736572
Epoch: 87, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.337 Vali Acc: 0.919 Test Loss: 0.337 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 88 cost time: 0.7121710777282715
Epoch: 88, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.335 Vali Acc: 0.919 Test Loss: 0.335 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 89 cost time: 0.8198897838592529
Epoch: 89, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.333 Vali Acc: 0.919 Test Loss: 0.333 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 90 cost time: 0.8140659332275391
Epoch: 90, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.331 Vali Acc: 0.919 Test Loss: 0.331 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 91 cost time: 0.7301819324493408
Epoch: 91, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 92 cost time: 0.8739666938781738
Epoch: 92, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 93 cost time: 0.803518533706665
Epoch: 93, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.320 Vali Acc: 0.919 Test Loss: 0.320 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.8309605121612549
Epoch: 94, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.316 Vali Acc: 0.919 Test Loss: 0.316 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.8291923999786377
Epoch: 95, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.7768759727478027
Epoch: 96, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 0.923893928527832
Epoch: 97, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 0.7448863983154297
Epoch: 98, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.308 Vali Acc: 0.915 Test Loss: 0.308 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 1.098679780960083
Epoch: 99, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 0.8042349815368652
Epoch: 100, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 184502
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           3                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.836577892303467
Epoch: 1, Steps: 2 | Train Loss: 2.006 Vali Loss: 1.943 Vali Acc: 0.107 Test Loss: 1.943 Test Acc: 0.107
Validation loss decreased (inf --> -0.107388).  Saving model ...
Epoch: 2 cost time: 1.0201952457427979
Epoch: 2, Steps: 2 | Train Loss: 1.930 Vali Loss: 1.917 Vali Acc: 0.107 Test Loss: 1.917 Test Acc: 0.107
Validation loss decreased (-0.107388 --> -0.107388).  Saving model ...
Epoch: 3 cost time: 1.0662238597869873
Epoch: 3, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.897 Vali Acc: 0.111 Test Loss: 1.897 Test Acc: 0.111
Validation loss decreased (-0.107388 --> -0.111092).  Saving model ...
Epoch: 4 cost time: 1.0369954109191895
Epoch: 4, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.878 Vali Acc: 0.126 Test Loss: 1.878 Test Acc: 0.126
Validation loss decreased (-0.111092 --> -0.125907).  Saving model ...
Epoch: 5 cost time: 0.8905072212219238
Epoch: 5, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.856 Vali Acc: 0.126 Test Loss: 1.856 Test Acc: 0.126
Validation loss decreased (-0.125907 --> -0.125907).  Saving model ...
Epoch: 6 cost time: 0.8919451236724854
Epoch: 6, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.833 Vali Acc: 0.148 Test Loss: 1.833 Test Acc: 0.148
Validation loss decreased (-0.125907 --> -0.148130).  Saving model ...
Epoch: 7 cost time: 0.7355821132659912
Epoch: 7, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.809 Vali Acc: 0.181 Test Loss: 1.809 Test Acc: 0.181
Validation loss decreased (-0.148130 --> -0.181463).  Saving model ...
Epoch: 8 cost time: 0.7970967292785645
Epoch: 8, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.786 Vali Acc: 0.207 Test Loss: 1.786 Test Acc: 0.207
Validation loss decreased (-0.181463 --> -0.207390).  Saving model ...
Epoch: 9 cost time: 0.803145170211792
Epoch: 9, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.765 Vali Acc: 0.263 Test Loss: 1.765 Test Acc: 0.263
Validation loss decreased (-0.207390 --> -0.262945).  Saving model ...
Epoch: 10 cost time: 0.910611629486084
Epoch: 10, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.745 Vali Acc: 0.319 Test Loss: 1.745 Test Acc: 0.319
Validation loss decreased (-0.262945 --> -0.318501).  Saving model ...
Epoch: 11 cost time: 0.7567665576934814
Epoch: 11, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.726 Vali Acc: 0.319 Test Loss: 1.726 Test Acc: 0.319
Validation loss decreased (-0.318501 --> -0.318501).  Saving model ...
Epoch: 12 cost time: 0.8495175838470459
Epoch: 12, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.709 Vali Acc: 0.322 Test Loss: 1.709 Test Acc: 0.322
Validation loss decreased (-0.318501 --> -0.322205).  Saving model ...
Epoch: 13 cost time: 0.7563536167144775
Epoch: 13, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.691 Vali Acc: 0.359 Test Loss: 1.691 Test Acc: 0.359
Validation loss decreased (-0.322205 --> -0.359242).  Saving model ...
Epoch: 14 cost time: 0.8824710845947266
Epoch: 14, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.673 Vali Acc: 0.378 Test Loss: 1.673 Test Acc: 0.378
Validation loss decreased (-0.359242 --> -0.377761).  Saving model ...
Epoch: 15 cost time: 0.9451074600219727
Epoch: 15, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.652 Vali Acc: 0.422 Test Loss: 1.652 Test Acc: 0.422
Validation loss decreased (-0.377761 --> -0.422206).  Saving model ...
Epoch: 16 cost time: 1.0383427143096924
Epoch: 16, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.631 Vali Acc: 0.467 Test Loss: 1.631 Test Acc: 0.467
Validation loss decreased (-0.422206 --> -0.466650).  Saving model ...
Epoch: 17 cost time: 0.8991525173187256
Epoch: 17, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.609 Vali Acc: 0.493 Test Loss: 1.609 Test Acc: 0.493
Validation loss decreased (-0.466650 --> -0.492576).  Saving model ...
Epoch: 18 cost time: 0.9125659465789795
Epoch: 18, Steps: 2 | Train Loss: 1.600 Vali Loss: 1.586 Vali Acc: 0.511 Test Loss: 1.586 Test Acc: 0.511
Validation loss decreased (-0.492576 --> -0.511095).  Saving model ...
Epoch: 19 cost time: 1.0749824047088623
Epoch: 19, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.560 Vali Acc: 0.544 Test Loss: 1.560 Test Acc: 0.544
Validation loss decreased (-0.511095 --> -0.544429).  Saving model ...
Epoch: 20 cost time: 0.9188656806945801
Epoch: 20, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.534 Vali Acc: 0.563 Test Loss: 1.534 Test Acc: 0.563
Validation loss decreased (-0.544429 --> -0.562948).  Saving model ...
Epoch: 21 cost time: 0.7070739269256592
Epoch: 21, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.505 Vali Acc: 0.596 Test Loss: 1.505 Test Acc: 0.596
Validation loss decreased (-0.562948 --> -0.596281).  Saving model ...
Epoch: 22 cost time: 0.9676437377929688
Epoch: 22, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.475 Vali Acc: 0.600 Test Loss: 1.475 Test Acc: 0.600
Validation loss decreased (-0.596281 --> -0.599985).  Saving model ...
Epoch: 23 cost time: 0.9457552433013916
Epoch: 23, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.443 Vali Acc: 0.611 Test Loss: 1.443 Test Acc: 0.611
Validation loss decreased (-0.599985 --> -0.611097).  Saving model ...
Epoch: 24 cost time: 0.8521177768707275
Epoch: 24, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.410 Vali Acc: 0.637 Test Loss: 1.410 Test Acc: 0.637
Validation loss decreased (-0.611097 --> -0.637023).  Saving model ...
Epoch: 25 cost time: 1.1067173480987549
Epoch: 25, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.377 Vali Acc: 0.656 Test Loss: 1.377 Test Acc: 0.656
Validation loss decreased (-0.637023 --> -0.655542).  Saving model ...
Epoch: 26 cost time: 0.9510006904602051
Epoch: 26, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.343 Vali Acc: 0.667 Test Loss: 1.343 Test Acc: 0.667
Validation loss decreased (-0.655542 --> -0.666653).  Saving model ...
Epoch: 27 cost time: 0.8615071773529053
Epoch: 27, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.308 Vali Acc: 0.678 Test Loss: 1.308 Test Acc: 0.678
Validation loss decreased (-0.666653 --> -0.677765).  Saving model ...
Epoch: 28 cost time: 0.9311115741729736
Epoch: 28, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.273 Vali Acc: 0.678 Test Loss: 1.273 Test Acc: 0.678
Validation loss decreased (-0.677765 --> -0.677765).  Saving model ...
Epoch: 29 cost time: 0.9356563091278076
Epoch: 29, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.237 Vali Acc: 0.693 Test Loss: 1.237 Test Acc: 0.693
Validation loss decreased (-0.677765 --> -0.692580).  Saving model ...
Epoch: 30 cost time: 0.9036550521850586
Epoch: 30, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.202 Vali Acc: 0.707 Test Loss: 1.202 Test Acc: 0.707
Validation loss decreased (-0.692580 --> -0.707395).  Saving model ...
Epoch: 31 cost time: 1.2661523818969727
Epoch: 31, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.165 Vali Acc: 0.715 Test Loss: 1.165 Test Acc: 0.715
Validation loss decreased (-0.707395 --> -0.714803).  Saving model ...
Epoch: 32 cost time: 0.8645153045654297
Epoch: 32, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.127 Vali Acc: 0.730 Test Loss: 1.127 Test Acc: 0.730
Validation loss decreased (-0.714803 --> -0.729618).  Saving model ...
Epoch: 33 cost time: 1.131697654724121
Epoch: 33, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.089 Vali Acc: 0.737 Test Loss: 1.089 Test Acc: 0.737
Validation loss decreased (-0.729618 --> -0.737026).  Saving model ...
Epoch: 34 cost time: 0.9741151332855225
Epoch: 34, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.049 Vali Acc: 0.752 Test Loss: 1.049 Test Acc: 0.752
Validation loss decreased (-0.737026 --> -0.751841).  Saving model ...
Epoch: 35 cost time: 1.284846544265747
Epoch: 35, Steps: 2 | Train Loss: 0.918 Vali Loss: 1.009 Vali Acc: 0.770 Test Loss: 1.009 Test Acc: 0.770
Validation loss decreased (-0.751841 --> -0.770360).  Saving model ...
Epoch: 36 cost time: 0.8924720287322998
Epoch: 36, Steps: 2 | Train Loss: 0.942 Vali Loss: 0.972 Vali Acc: 0.778 Test Loss: 0.972 Test Acc: 0.778
Validation loss decreased (-0.770360 --> -0.777768).  Saving model ...
Epoch: 37 cost time: 1.1250624656677246
Epoch: 37, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.936 Vali Acc: 0.789 Test Loss: 0.936 Test Acc: 0.789
Validation loss decreased (-0.777768 --> -0.788880).  Saving model ...
Epoch: 38 cost time: 0.9047331809997559
Epoch: 38, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.900 Vali Acc: 0.800 Test Loss: 0.900 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799991).  Saving model ...
Epoch: 39 cost time: 1.189826488494873
Epoch: 39, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.865 Vali Acc: 0.822 Test Loss: 0.865 Test Acc: 0.822
Validation loss decreased (-0.799991 --> -0.822214).  Saving model ...
Epoch: 40 cost time: 1.071150302886963
Epoch: 40, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.831 Vali Acc: 0.841 Test Loss: 0.831 Test Acc: 0.841
Validation loss decreased (-0.822214 --> -0.840732).  Saving model ...
Epoch: 41 cost time: 1.075465440750122
Epoch: 41, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.799 Vali Acc: 0.833 Test Loss: 0.799 Test Acc: 0.833
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8403162956237793
Epoch: 42, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.769 Vali Acc: 0.837 Test Loss: 0.769 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.287501573562622
Epoch: 43, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.737 Vali Acc: 0.841 Test Loss: 0.737 Test Acc: 0.841
Validation loss decreased (-0.840732 --> -0.840733).  Saving model ...
Epoch: 44 cost time: 0.8465406894683838
Epoch: 44, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.708 Vali Acc: 0.856 Test Loss: 0.708 Test Acc: 0.856
Validation loss decreased (-0.840733 --> -0.855548).  Saving model ...
Epoch: 45 cost time: 0.7707667350769043
Epoch: 45, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.680 Vali Acc: 0.856 Test Loss: 0.680 Test Acc: 0.856
Validation loss decreased (-0.855548 --> -0.855549).  Saving model ...
Epoch: 46 cost time: 0.8585855960845947
Epoch: 46, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.652 Vali Acc: 0.870 Test Loss: 0.652 Test Acc: 0.870
Validation loss decreased (-0.855549 --> -0.870364).  Saving model ...
Epoch: 47 cost time: 1.0139448642730713
Epoch: 47, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.626 Vali Acc: 0.881 Test Loss: 0.626 Test Acc: 0.881
Validation loss decreased (-0.870364 --> -0.881475).  Saving model ...
Epoch: 48 cost time: 0.8356401920318604
Epoch: 48, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.603 Vali Acc: 0.874 Test Loss: 0.603 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.815925121307373
Epoch: 49, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.583 Vali Acc: 0.874 Test Loss: 0.583 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.880263090133667
Epoch: 50, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.566 Vali Acc: 0.874 Test Loss: 0.566 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9730703830718994
Epoch: 51, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.549 Vali Acc: 0.870 Test Loss: 0.549 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 1.0916268825531006
Epoch: 52, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.534 Vali Acc: 0.881 Test Loss: 0.534 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 53 cost time: 0.8400707244873047
Epoch: 53, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.517 Vali Acc: 0.881 Test Loss: 0.517 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 54 cost time: 0.8593785762786865
Epoch: 54, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.500 Vali Acc: 0.881 Test Loss: 0.500 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 55 cost time: 0.884321928024292
Epoch: 55, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.487 Vali Acc: 0.881 Test Loss: 0.487 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881477).  Saving model ...
Epoch: 56 cost time: 0.8503372669219971
Epoch: 56, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.474 Vali Acc: 0.881 Test Loss: 0.474 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 57 cost time: 0.7925279140472412
Epoch: 57, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.459 Vali Acc: 0.881 Test Loss: 0.459 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 58 cost time: 0.9067955017089844
Epoch: 58, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.446 Vali Acc: 0.889 Test Loss: 0.446 Test Acc: 0.889
Validation loss decreased (-0.881477 --> -0.888884).  Saving model ...
Epoch: 59 cost time: 0.8334057331085205
Epoch: 59, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.434 Vali Acc: 0.889 Test Loss: 0.434 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 60 cost time: 0.8628559112548828
Epoch: 60, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.424 Vali Acc: 0.893 Test Loss: 0.424 Test Acc: 0.893
Validation loss decreased (-0.888885 --> -0.892588).  Saving model ...
Epoch: 61 cost time: 1.0666284561157227
Epoch: 61, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.414 Vali Acc: 0.896 Test Loss: 0.414 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 62 cost time: 1.0320026874542236
Epoch: 62, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.406 Vali Acc: 0.896 Test Loss: 0.406 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 63 cost time: 1.0137732028961182
Epoch: 63, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.398 Vali Acc: 0.900 Test Loss: 0.398 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 64 cost time: 0.8347620964050293
Epoch: 64, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.390 Vali Acc: 0.907 Test Loss: 0.390 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907404).  Saving model ...
Epoch: 65 cost time: 0.952648401260376
Epoch: 65, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.382 Vali Acc: 0.907 Test Loss: 0.382 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 66 cost time: 0.9513132572174072
Epoch: 66, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.375 Vali Acc: 0.907 Test Loss: 0.375 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 67 cost time: 1.0385076999664307
Epoch: 67, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.368 Vali Acc: 0.907 Test Loss: 0.368 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 68 cost time: 0.8670003414154053
Epoch: 68, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.360 Vali Acc: 0.915 Test Loss: 0.360 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914811).  Saving model ...
Epoch: 69 cost time: 0.8631591796875
Epoch: 69, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.355 Vali Acc: 0.915 Test Loss: 0.355 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 70 cost time: 0.7916004657745361
Epoch: 70, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.352 Vali Acc: 0.907 Test Loss: 0.352 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.8582684993743896
Epoch: 71, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.347 Vali Acc: 0.911 Test Loss: 0.347 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9853837490081787
Epoch: 72, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 73 cost time: 1.0402536392211914
Epoch: 73, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 74 cost time: 0.912346363067627
Epoch: 74, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 75 cost time: 0.7830560207366943
Epoch: 75, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.320 Vali Acc: 0.922 Test Loss: 0.320 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.8877546787261963
Epoch: 76, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.318 Vali Acc: 0.919 Test Loss: 0.318 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.7811110019683838
Epoch: 77, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.317 Vali Acc: 0.915 Test Loss: 0.317 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.9341607093811035
Epoch: 78, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 1.1171374320983887
Epoch: 79, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 80 cost time: 0.7760577201843262
Epoch: 80, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933330).  Saving model ...
Epoch: 81 cost time: 0.7225654125213623
Epoch: 81, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 82 cost time: 0.896327018737793
Epoch: 82, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 83 cost time: 0.9416930675506592
Epoch: 83, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.8973844051361084
Epoch: 84, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.7804176807403564
Epoch: 85, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.8031823635101318
Epoch: 86, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 87 cost time: 0.817033052444458
Epoch: 87, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.279 Vali Acc: 0.937 Test Loss: 0.279 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 88 cost time: 0.9793233871459961
Epoch: 88, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.274 Vali Acc: 0.941 Test Loss: 0.274 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 89 cost time: 0.8757038116455078
Epoch: 89, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 90 cost time: 0.833115816116333
Epoch: 90, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 91 cost time: 0.7195858955383301
Epoch: 91, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.8801496028900146
Epoch: 92, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 1.0022337436676025
Epoch: 93, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.9872043132781982
Epoch: 94, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 95 cost time: 0.9634382724761963
Epoch: 95, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.260 Vali Acc: 0.948 Test Loss: 0.260 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 96 cost time: 0.7999310493469238
Epoch: 96, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.9727966785430908
Epoch: 97, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.9091975688934326
Epoch: 98, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 1.1830415725708008
Epoch: 99, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 1.0375871658325195
Epoch: 100, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el3_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 184150
model size : 1.46MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.714972972869873
Epoch: 1, Steps: 2 | Train Loss: 1.894 Vali Loss: 1.843 Vali Acc: 0.274 Test Loss: 1.843 Test Acc: 0.274
Validation loss decreased (inf --> -0.274056).  Saving model ...
Epoch: 2 cost time: 0.7583878040313721
Epoch: 2, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.785 Vali Acc: 0.326 Test Loss: 1.785 Test Acc: 0.326
Validation loss decreased (-0.274056 --> -0.325908).  Saving model ...
Epoch: 3 cost time: 0.6481902599334717
Epoch: 3, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.701 Vali Acc: 0.430 Test Loss: 1.701 Test Acc: 0.430
Validation loss decreased (-0.325908 --> -0.429613).  Saving model ...
Epoch: 4 cost time: 0.7507286071777344
Epoch: 4, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.583 Vali Acc: 0.426 Test Loss: 1.583 Test Acc: 0.426
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8069255352020264
Epoch: 5, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.467 Vali Acc: 0.548 Test Loss: 1.467 Test Acc: 0.548
Validation loss decreased (-0.429613 --> -0.548133).  Saving model ...
Epoch: 6 cost time: 0.75435471534729
Epoch: 6, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.330 Vali Acc: 0.633 Test Loss: 1.330 Test Acc: 0.633
Validation loss decreased (-0.548133 --> -0.633320).  Saving model ...
Epoch: 7 cost time: 0.8318066596984863
Epoch: 7, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.166 Vali Acc: 0.748 Test Loss: 1.166 Test Acc: 0.748
Validation loss decreased (-0.633320 --> -0.748136).  Saving model ...
Epoch: 8 cost time: 0.7281012535095215
Epoch: 8, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.018 Vali Acc: 0.837 Test Loss: 1.018 Test Acc: 0.837
Validation loss decreased (-0.748136 --> -0.837027).  Saving model ...
Epoch: 9 cost time: 0.629896879196167
Epoch: 9, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.890 Vali Acc: 0.837 Test Loss: 0.890 Test Acc: 0.837
Validation loss decreased (-0.837027 --> -0.837028).  Saving model ...
Epoch: 10 cost time: 0.8910837173461914
Epoch: 10, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.768 Vali Acc: 0.867 Test Loss: 0.768 Test Acc: 0.867
Validation loss decreased (-0.837028 --> -0.866659).  Saving model ...
Epoch: 11 cost time: 1.0280601978302002
Epoch: 11, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.656 Vali Acc: 0.911 Test Loss: 0.656 Test Acc: 0.911
Validation loss decreased (-0.866659 --> -0.911105).  Saving model ...
Epoch: 12 cost time: 0.7663605213165283
Epoch: 12, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.550 Vali Acc: 0.941 Test Loss: 0.550 Test Acc: 0.941
Validation loss decreased (-0.911105 --> -0.940735).  Saving model ...
Epoch: 13 cost time: 0.7127599716186523
Epoch: 13, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.467 Vali Acc: 0.952 Test Loss: 0.467 Test Acc: 0.952
Validation loss decreased (-0.940735 --> -0.951847).  Saving model ...
Epoch: 14 cost time: 0.7539231777191162
Epoch: 14, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.389 Vali Acc: 0.944 Test Loss: 0.389 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7586901187896729
Epoch: 15, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.332 Vali Acc: 0.941 Test Loss: 0.332 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6790075302124023
Epoch: 16, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.278 Vali Acc: 0.963 Test Loss: 0.278 Test Acc: 0.963
Validation loss decreased (-0.951847 --> -0.962960).  Saving model ...
Epoch: 17 cost time: 0.7084269523620605
Epoch: 17, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.244 Vali Acc: 0.952 Test Loss: 0.244 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7084834575653076
Epoch: 18, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7289884090423584
Epoch: 19, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7319047451019287
Epoch: 20, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.847409725189209
Epoch: 21, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7621269226074219
Epoch: 22, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7166018486022949
Epoch: 23, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.165 Vali Acc: 0.967 Test Loss: 0.165 Test Acc: 0.967
Validation loss decreased (-0.962960 --> -0.966665).  Saving model ...
Epoch: 24 cost time: 0.6540203094482422
Epoch: 24, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
Validation loss decreased (-0.966665 --> -0.966665).  Saving model ...
Epoch: 25 cost time: 0.7501511573791504
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9961678981781006
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7461693286895752
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9623451232910156
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7265756130218506
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.7230691909790039
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7440080642700195
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7082397937774658
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8254926204681396
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.161 Vali Acc: 0.948 Test Loss: 0.161 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8273506164550781
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.948 Test Loss: 0.157 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9666666666666667
model parameter : 7953194
model size : 35.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8891561031341553
Epoch: 1, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.880 Vali Acc: 0.085 Test Loss: 1.880 Test Acc: 0.085
Validation loss decreased (inf --> -0.085166).  Saving model ...
Epoch: 2 cost time: 0.6347634792327881
Epoch: 2, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.853 Vali Acc: 0.104 Test Loss: 1.853 Test Acc: 0.104
Validation loss decreased (-0.085166 --> -0.103685).  Saving model ...
Epoch: 3 cost time: 0.6912834644317627
Epoch: 3, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.798 Vali Acc: 0.107 Test Loss: 1.798 Test Acc: 0.107
Validation loss decreased (-0.103685 --> -0.107389).  Saving model ...
Epoch: 4 cost time: 0.6764507293701172
Epoch: 4, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.688 Vali Acc: 0.304 Test Loss: 1.688 Test Acc: 0.304
Validation loss decreased (-0.107389 --> -0.303687).  Saving model ...
Epoch: 5 cost time: 0.7214851379394531
Epoch: 5, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.552 Vali Acc: 0.519 Test Loss: 1.552 Test Acc: 0.519
Validation loss decreased (-0.303687 --> -0.518503).  Saving model ...
Epoch: 6 cost time: 0.7296781539916992
Epoch: 6, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.402 Vali Acc: 0.670 Test Loss: 1.402 Test Acc: 0.670
Validation loss decreased (-0.518503 --> -0.670356).  Saving model ...
Epoch: 7 cost time: 0.6755998134613037
Epoch: 7, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.246 Vali Acc: 0.763 Test Loss: 1.246 Test Acc: 0.763
Validation loss decreased (-0.670356 --> -0.762951).  Saving model ...
Epoch: 8 cost time: 0.6677312850952148
Epoch: 8, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.101 Vali Acc: 0.752 Test Loss: 1.101 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7605123519897461
Epoch: 9, Steps: 2 | Train Loss: 1.019 Vali Loss: 0.960 Vali Acc: 0.807 Test Loss: 0.960 Test Acc: 0.807
Validation loss decreased (-0.762951 --> -0.807398).  Saving model ...
Epoch: 10 cost time: 0.6228442192077637
Epoch: 10, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.819 Vali Acc: 0.881 Test Loss: 0.819 Test Acc: 0.881
Validation loss decreased (-0.807398 --> -0.881473).  Saving model ...
Epoch: 11 cost time: 0.7205760478973389
Epoch: 11, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.696 Vali Acc: 0.926 Test Loss: 0.696 Test Acc: 0.926
Validation loss decreased (-0.881473 --> -0.925919).  Saving model ...
Epoch: 12 cost time: 0.6745419502258301
Epoch: 12, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.595 Vali Acc: 0.933 Test Loss: 0.595 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933327).  Saving model ...
Epoch: 13 cost time: 0.5955312252044678
Epoch: 13, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.510 Vali Acc: 0.944 Test Loss: 0.510 Test Acc: 0.944
Validation loss decreased (-0.933327 --> -0.944439).  Saving model ...
Epoch: 14 cost time: 0.7382380962371826
Epoch: 14, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.447 Vali Acc: 0.911 Test Loss: 0.447 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6878883838653564
Epoch: 15, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.404 Vali Acc: 0.889 Test Loss: 0.404 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7038779258728027
Epoch: 16, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.332 Vali Acc: 0.933 Test Loss: 0.332 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7341887950897217
Epoch: 17, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.7279136180877686
Epoch: 18, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7509212493896484
Epoch: 19, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8023979663848877
Epoch: 20, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7217526435852051
Epoch: 21, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.8645565509796143
Epoch: 22, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.7065627574920654
Epoch: 23, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.6340720653533936
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7164227962493896
Epoch: 25, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8064119815826416
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7664394378662109
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7862117290496826
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.195 Vali Acc: 0.926 Test Loss: 0.195 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7306547164916992
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.745607852935791
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.926 Test Loss: 0.186 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6910092830657959
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6597256660461426
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7563433647155762
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 7950890
model size : 35.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.709453821182251
Epoch: 1, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.762 Vali Acc: 0.137 Test Loss: 1.762 Test Acc: 0.137
Validation loss decreased (inf --> -0.137019).  Saving model ...
Epoch: 2 cost time: 0.9573166370391846
Epoch: 2, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.731 Vali Acc: 0.174 Test Loss: 1.731 Test Acc: 0.174
Validation loss decreased (-0.137019 --> -0.174057).  Saving model ...
Epoch: 3 cost time: 0.8815560340881348
Epoch: 3, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.668 Vali Acc: 0.333 Test Loss: 1.668 Test Acc: 0.333
Validation loss decreased (-0.174057 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 0.8312342166900635
Epoch: 4, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.564 Vali Acc: 0.581 Test Loss: 1.564 Test Acc: 0.581
Validation loss decreased (-0.333317 --> -0.581466).  Saving model ...
Epoch: 5 cost time: 0.8561747074127197
Epoch: 5, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.454 Vali Acc: 0.511 Test Loss: 1.454 Test Acc: 0.511
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0148060321807861
Epoch: 6, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.321 Vali Acc: 0.552 Test Loss: 1.321 Test Acc: 0.552
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9084198474884033
Epoch: 7, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.163 Vali Acc: 0.741 Test Loss: 1.163 Test Acc: 0.741
Validation loss decreased (-0.581466 --> -0.740729).  Saving model ...
Epoch: 8 cost time: 0.915553092956543
Epoch: 8, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.013 Vali Acc: 0.837 Test Loss: 1.013 Test Acc: 0.837
Validation loss decreased (-0.740729 --> -0.837027).  Saving model ...
Epoch: 9 cost time: 0.6913118362426758
Epoch: 9, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.885 Vali Acc: 0.852 Test Loss: 0.885 Test Acc: 0.852
Validation loss decreased (-0.837027 --> -0.851843).  Saving model ...
Epoch: 10 cost time: 1.0135502815246582
Epoch: 10, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.753 Vali Acc: 0.933 Test Loss: 0.753 Test Acc: 0.933
Validation loss decreased (-0.851843 --> -0.933326).  Saving model ...
Epoch: 11 cost time: 0.9941926002502441
Epoch: 11, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.633 Vali Acc: 0.948 Test Loss: 0.633 Test Acc: 0.948
Validation loss decreased (-0.933326 --> -0.948142).  Saving model ...
Epoch: 12 cost time: 0.8973267078399658
Epoch: 12, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.544 Vali Acc: 0.937 Test Loss: 0.544 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7445769309997559
Epoch: 13, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.465 Vali Acc: 0.944 Test Loss: 0.465 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9078514575958252
Epoch: 14, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.409 Vali Acc: 0.933 Test Loss: 0.409 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.052459478378296
Epoch: 15, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.358 Vali Acc: 0.937 Test Loss: 0.358 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.0002217292785645
Epoch: 16, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.305 Vali Acc: 0.956 Test Loss: 0.305 Test Acc: 0.956
Validation loss decreased (-0.948142 --> -0.955553).  Saving model ...
Epoch: 17 cost time: 0.7642228603363037
Epoch: 17, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.260 Vali Acc: 0.963 Test Loss: 0.260 Test Acc: 0.963
Validation loss decreased (-0.955553 --> -0.962960).  Saving model ...
Epoch: 18 cost time: 0.8949050903320312
Epoch: 18, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9182305335998535
Epoch: 19, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.955672025680542
Epoch: 20, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.237 Vali Acc: 0.919 Test Loss: 0.237 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8559226989746094
Epoch: 21, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.034907579421997
Epoch: 22, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.884096622467041
Epoch: 23, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8002026081085205
Epoch: 24, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9362692832946777
Epoch: 25, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9434340000152588
Epoch: 26, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8567073345184326
Epoch: 27, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 7948586
model size : 35.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1224684715270996
Epoch: 1, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.792 Vali Acc: 0.144 Test Loss: 1.792 Test Acc: 0.144
Validation loss decreased (inf --> -0.144427).  Saving model ...
Epoch: 2 cost time: 0.8363151550292969
Epoch: 2, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.745 Vali Acc: 0.248 Test Loss: 1.745 Test Acc: 0.248
Validation loss decreased (-0.144427 --> -0.248131).  Saving model ...
Epoch: 3 cost time: 0.6703777313232422
Epoch: 3, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.682 Vali Acc: 0.385 Test Loss: 1.682 Test Acc: 0.385
Validation loss decreased (-0.248131 --> -0.385168).  Saving model ...
Epoch: 4 cost time: 0.6702830791473389
Epoch: 4, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.581 Vali Acc: 0.463 Test Loss: 1.581 Test Acc: 0.463
Validation loss decreased (-0.385168 --> -0.462947).  Saving model ...
Epoch: 5 cost time: 0.7316076755523682
Epoch: 5, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.459 Vali Acc: 0.496 Test Loss: 1.459 Test Acc: 0.496
Validation loss decreased (-0.462947 --> -0.496282).  Saving model ...
Epoch: 6 cost time: 0.9144020080566406
Epoch: 6, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.313 Vali Acc: 0.600 Test Loss: 1.313 Test Acc: 0.600
Validation loss decreased (-0.496282 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 0.9300417900085449
Epoch: 7, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.148 Vali Acc: 0.804 Test Loss: 1.148 Test Acc: 0.804
Validation loss decreased (-0.599987 --> -0.803692).  Saving model ...
Epoch: 8 cost time: 0.9759950637817383
Epoch: 8, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.005 Vali Acc: 0.830 Test Loss: 1.005 Test Acc: 0.830
Validation loss decreased (-0.803692 --> -0.829620).  Saving model ...
Epoch: 9 cost time: 0.9218313694000244
Epoch: 9, Steps: 2 | Train Loss: 0.894 Vali Loss: 0.870 Vali Acc: 0.844 Test Loss: 0.870 Test Acc: 0.844
Validation loss decreased (-0.829620 --> -0.844436).  Saving model ...
Epoch: 10 cost time: 1.1851775646209717
Epoch: 10, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.741 Vali Acc: 0.878 Test Loss: 0.741 Test Acc: 0.878
Validation loss decreased (-0.844436 --> -0.877770).  Saving model ...
Epoch: 11 cost time: 0.7382075786590576
Epoch: 11, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.630 Vali Acc: 0.930 Test Loss: 0.630 Test Acc: 0.930
Validation loss decreased (-0.877770 --> -0.929623).  Saving model ...
Epoch: 12 cost time: 0.8205041885375977
Epoch: 12, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.539 Vali Acc: 0.922 Test Loss: 0.539 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8749070167541504
Epoch: 13, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.449 Vali Acc: 0.944 Test Loss: 0.449 Test Acc: 0.944
Validation loss decreased (-0.929623 --> -0.944440).  Saving model ...
Epoch: 14 cost time: 0.8294215202331543
Epoch: 14, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.383 Vali Acc: 0.941 Test Loss: 0.383 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1293601989746094
Epoch: 15, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.342 Vali Acc: 0.926 Test Loss: 0.342 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7841126918792725
Epoch: 16, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7186169624328613
Epoch: 17, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.7890224456787109
Epoch: 18, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
Validation loss decreased (-0.944442 --> -0.955553).  Saving model ...
Epoch: 19 cost time: 0.7508318424224854
Epoch: 19, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8343820571899414
Epoch: 20, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8770637512207031
Epoch: 21, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9683406352996826
Epoch: 22, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.199 Vali Acc: 0.919 Test Loss: 0.199 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8625223636627197
Epoch: 23, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.183 Vali Acc: 0.926 Test Loss: 0.183 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8543200492858887
Epoch: 24, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7792134284973145
Epoch: 25, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8299028873443604
Epoch: 26, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.941 Test Loss: 0.157 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8529508113861084
Epoch: 27, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.155 Vali Acc: 0.941 Test Loss: 0.155 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7552471160888672
Epoch: 28, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 7946282
model size : 35.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.727989673614502
Epoch: 1, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.838 Vali Acc: 0.315 Test Loss: 1.838 Test Acc: 0.315
Validation loss decreased (inf --> -0.314796).  Saving model ...
Epoch: 2 cost time: 0.8684835433959961
Epoch: 2, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.765 Vali Acc: 0.356 Test Loss: 1.765 Test Acc: 0.356
Validation loss decreased (-0.314796 --> -0.355538).  Saving model ...
Epoch: 3 cost time: 0.9259183406829834
Epoch: 3, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.671 Vali Acc: 0.496 Test Loss: 1.671 Test Acc: 0.496
Validation loss decreased (-0.355538 --> -0.496280).  Saving model ...
Epoch: 4 cost time: 0.8384993076324463
Epoch: 4, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.554 Vali Acc: 0.563 Test Loss: 1.554 Test Acc: 0.563
Validation loss decreased (-0.496280 --> -0.562947).  Saving model ...
Epoch: 5 cost time: 0.9138085842132568
Epoch: 5, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.479 Vali Acc: 0.515 Test Loss: 1.479 Test Acc: 0.515
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8846309185028076
Epoch: 6, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.399 Vali Acc: 0.444 Test Loss: 1.399 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7746672630310059
Epoch: 7, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.270 Vali Acc: 0.478 Test Loss: 1.270 Test Acc: 0.478
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.960472822189331
Epoch: 8, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.092 Vali Acc: 0.700 Test Loss: 1.092 Test Acc: 0.700
Validation loss decreased (-0.562947 --> -0.699989).  Saving model ...
Epoch: 9 cost time: 0.7859911918640137
Epoch: 9, Steps: 2 | Train Loss: 1.010 Vali Loss: 0.939 Vali Acc: 0.867 Test Loss: 0.939 Test Acc: 0.867
Validation loss decreased (-0.699989 --> -0.866657).  Saving model ...
Epoch: 10 cost time: 0.7132968902587891
Epoch: 10, Steps: 2 | Train Loss: 0.796 Vali Loss: 0.849 Vali Acc: 0.807 Test Loss: 0.849 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6494433879852295
Epoch: 11, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.761 Vali Acc: 0.804 Test Loss: 0.761 Test Acc: 0.804
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8410649299621582
Epoch: 12, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.641 Vali Acc: 0.863 Test Loss: 0.641 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.170971155166626
Epoch: 13, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.546 Vali Acc: 0.944 Test Loss: 0.546 Test Acc: 0.944
Validation loss decreased (-0.866657 --> -0.944439).  Saving model ...
Epoch: 14 cost time: 0.7400116920471191
Epoch: 14, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.490 Vali Acc: 0.919 Test Loss: 0.490 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7639360427856445
Epoch: 15, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.417 Vali Acc: 0.937 Test Loss: 0.417 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7507119178771973
Epoch: 16, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.387 Vali Acc: 0.911 Test Loss: 0.387 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7462799549102783
Epoch: 17, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.378 Vali Acc: 0.874 Test Loss: 0.378 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8637754917144775
Epoch: 18, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.315 Vali Acc: 0.904 Test Loss: 0.315 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9928975105285645
Epoch: 19, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6892378330230713
Epoch: 20, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.7428605556488037
Epoch: 21, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7479503154754639
Epoch: 22, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.240 Vali Acc: 0.919 Test Loss: 0.240 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.801398515701294
Epoch: 23, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.230 Vali Acc: 0.919 Test Loss: 0.230 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9197993278503418
Epoch: 24, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.833611249923706
Epoch: 25, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9117133617401123
Epoch: 26, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8011236190795898
Epoch: 27, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7876994609832764
Epoch: 28, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.8456981182098389
Epoch: 29, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.908571720123291
Epoch: 30, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7605223655700684
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7525856494903564
Epoch: 32, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.926 Test Loss: 0.207 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.769794225692749
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7461283206939697
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.194 Vali Acc: 0.922 Test Loss: 0.194 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7872223854064941
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7957334518432617
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.754204273223877
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.7043278217315674
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 6639914
model size : 30.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.201080322265625
Epoch: 1, Steps: 2 | Train Loss: 1.979 Vali Loss: 1.938 Vali Acc: 0.093 Test Loss: 1.938 Test Acc: 0.093
Validation loss decreased (inf --> -0.092573).  Saving model ...
Epoch: 2 cost time: 1.1357834339141846
Epoch: 2, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.894 Vali Acc: 0.111 Test Loss: 1.894 Test Acc: 0.111
Validation loss decreased (-0.092573 --> -0.111092).  Saving model ...
Epoch: 3 cost time: 0.6132957935333252
Epoch: 3, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.827 Vali Acc: 0.119 Test Loss: 1.827 Test Acc: 0.119
Validation loss decreased (-0.111092 --> -0.118500).  Saving model ...
Epoch: 4 cost time: 0.7564184665679932
Epoch: 4, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.726 Vali Acc: 0.259 Test Loss: 1.726 Test Acc: 0.259
Validation loss decreased (-0.118500 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 0.850060224533081
Epoch: 5, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.627 Vali Acc: 0.363 Test Loss: 1.627 Test Acc: 0.363
Validation loss decreased (-0.259242 --> -0.362947).  Saving model ...
Epoch: 6 cost time: 0.8142786026000977
Epoch: 6, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.510 Vali Acc: 0.407 Test Loss: 1.510 Test Acc: 0.407
Validation loss decreased (-0.362947 --> -0.407392).  Saving model ...
Epoch: 7 cost time: 0.7220017910003662
Epoch: 7, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.357 Vali Acc: 0.541 Test Loss: 1.357 Test Acc: 0.541
Validation loss decreased (-0.407392 --> -0.540727).  Saving model ...
Epoch: 8 cost time: 0.8142082691192627
Epoch: 8, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.202 Vali Acc: 0.756 Test Loss: 1.202 Test Acc: 0.756
Validation loss decreased (-0.540727 --> -0.755544).  Saving model ...
Epoch: 9 cost time: 0.8151607513427734
Epoch: 9, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.059 Vali Acc: 0.793 Test Loss: 1.059 Test Acc: 0.793
Validation loss decreased (-0.755544 --> -0.792582).  Saving model ...
Epoch: 10 cost time: 0.7956035137176514
Epoch: 10, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.931 Vali Acc: 0.848 Test Loss: 0.931 Test Acc: 0.848
Validation loss decreased (-0.792582 --> -0.848139).  Saving model ...
Epoch: 11 cost time: 0.8218131065368652
Epoch: 11, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.813 Vali Acc: 0.870 Test Loss: 0.813 Test Acc: 0.870
Validation loss decreased (-0.848139 --> -0.870362).  Saving model ...
Epoch: 12 cost time: 0.6848993301391602
Epoch: 12, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.717 Vali Acc: 0.878 Test Loss: 0.717 Test Acc: 0.878
Validation loss decreased (-0.870362 --> -0.877771).  Saving model ...
Epoch: 13 cost time: 0.8609416484832764
Epoch: 13, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.625 Vali Acc: 0.904 Test Loss: 0.625 Test Acc: 0.904
Validation loss decreased (-0.877771 --> -0.903697).  Saving model ...
Epoch: 14 cost time: 1.0524389743804932
Epoch: 14, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.542 Vali Acc: 0.907 Test Loss: 0.542 Test Acc: 0.907
Validation loss decreased (-0.903697 --> -0.907402).  Saving model ...
Epoch: 15 cost time: 0.9288244247436523
Epoch: 15, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.476 Vali Acc: 0.904 Test Loss: 0.476 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8398051261901855
Epoch: 16, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.413 Vali Acc: 0.930 Test Loss: 0.413 Test Acc: 0.930
Validation loss decreased (-0.907402 --> -0.929625).  Saving model ...
Epoch: 17 cost time: 0.8664801120758057
Epoch: 17, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.375 Vali Acc: 0.933 Test Loss: 0.375 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933330).  Saving model ...
Epoch: 18 cost time: 0.6926884651184082
Epoch: 18, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.334 Vali Acc: 0.941 Test Loss: 0.334 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940737).  Saving model ...
Epoch: 19 cost time: 0.9231610298156738
Epoch: 19, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.302 Vali Acc: 0.926 Test Loss: 0.302 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7865068912506104
Epoch: 20, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8509321212768555
Epoch: 21, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.012542963027954
Epoch: 22, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7816550731658936
Epoch: 23, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7005653381347656
Epoch: 24, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.849022388458252
Epoch: 25, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.71150803565979
Epoch: 26, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8727121353149414
Epoch: 27, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0479063987731934
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 6637610
model size : 30.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4336187839508057
Epoch: 1, Steps: 2 | Train Loss: 1.959 Vali Loss: 1.893 Vali Acc: 0.130 Test Loss: 1.893 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 0.6492838859558105
Epoch: 2, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.834 Vali Acc: 0.185 Test Loss: 1.834 Test Acc: 0.185
Validation loss decreased (-0.129611 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 0.8323709964752197
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.751 Vali Acc: 0.281 Test Loss: 1.751 Test Acc: 0.281
Validation loss decreased (-0.185167 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.9100682735443115
Epoch: 4, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.628 Vali Acc: 0.470 Test Loss: 1.628 Test Acc: 0.470
Validation loss decreased (-0.281464 --> -0.470354).  Saving model ...
Epoch: 5 cost time: 0.7400965690612793
Epoch: 5, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.520 Vali Acc: 0.533 Test Loss: 1.520 Test Acc: 0.533
Validation loss decreased (-0.470354 --> -0.533318).  Saving model ...
Epoch: 6 cost time: 0.8032674789428711
Epoch: 6, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.406 Vali Acc: 0.493 Test Loss: 1.406 Test Acc: 0.493
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6863231658935547
Epoch: 7, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.251 Vali Acc: 0.652 Test Loss: 1.251 Test Acc: 0.652
Validation loss decreased (-0.533318 --> -0.651839).  Saving model ...
Epoch: 8 cost time: 0.5763673782348633
Epoch: 8, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.084 Vali Acc: 0.800 Test Loss: 1.084 Test Acc: 0.800
Validation loss decreased (-0.651839 --> -0.799989).  Saving model ...
Epoch: 9 cost time: 0.7093052864074707
Epoch: 9, Steps: 2 | Train Loss: 0.943 Vali Loss: 0.955 Vali Acc: 0.822 Test Loss: 0.955 Test Acc: 0.822
Validation loss decreased (-0.799989 --> -0.822213).  Saving model ...
Epoch: 10 cost time: 0.6879894733428955
Epoch: 10, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.856 Vali Acc: 0.770 Test Loss: 0.856 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8467981815338135
Epoch: 11, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.744 Vali Acc: 0.848 Test Loss: 0.744 Test Acc: 0.848
Validation loss decreased (-0.822213 --> -0.848141).  Saving model ...
Epoch: 12 cost time: 0.840378999710083
Epoch: 12, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.633 Vali Acc: 0.944 Test Loss: 0.633 Test Acc: 0.944
Validation loss decreased (-0.848141 --> -0.944438).  Saving model ...
Epoch: 13 cost time: 0.7167713642120361
Epoch: 13, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.547 Vali Acc: 0.948 Test Loss: 0.547 Test Acc: 0.948
Validation loss decreased (-0.944438 --> -0.948143).  Saving model ...
Epoch: 14 cost time: 0.7738323211669922
Epoch: 14, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.472 Vali Acc: 0.952 Test Loss: 0.472 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 15 cost time: 0.9280669689178467
Epoch: 15, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.416 Vali Acc: 0.937 Test Loss: 0.416 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6902899742126465
Epoch: 16, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7274656295776367
Epoch: 17, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7654376029968262
Epoch: 18, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8069031238555908
Epoch: 19, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7662296295166016
Epoch: 20, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.651923418045044
Epoch: 21, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7549502849578857
Epoch: 22, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6637945175170898
Epoch: 23, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6751887798309326
Epoch: 24, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 6635306
model size : 30.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5885093212127686
Epoch: 1, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.802 Vali Acc: 0.174 Test Loss: 1.802 Test Acc: 0.174
Validation loss decreased (inf --> -0.174056).  Saving model ...
Epoch: 2 cost time: 0.6948771476745605
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.746 Vali Acc: 0.241 Test Loss: 1.746 Test Acc: 0.241
Validation loss decreased (-0.174056 --> -0.240723).  Saving model ...
Epoch: 3 cost time: 0.716055154800415
Epoch: 3, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.677 Vali Acc: 0.411 Test Loss: 1.677 Test Acc: 0.411
Validation loss decreased (-0.240723 --> -0.411094).  Saving model ...
Epoch: 4 cost time: 0.5867834091186523
Epoch: 4, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.580 Vali Acc: 0.437 Test Loss: 1.580 Test Acc: 0.437
Validation loss decreased (-0.411094 --> -0.437021).  Saving model ...
Epoch: 5 cost time: 0.7831096649169922
Epoch: 5, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.478 Vali Acc: 0.470 Test Loss: 1.478 Test Acc: 0.470
Validation loss decreased (-0.437021 --> -0.470356).  Saving model ...
Epoch: 6 cost time: 0.8281280994415283
Epoch: 6, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.356 Vali Acc: 0.578 Test Loss: 1.356 Test Acc: 0.578
Validation loss decreased (-0.470356 --> -0.577764).  Saving model ...
Epoch: 7 cost time: 0.627246618270874
Epoch: 7, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.224 Vali Acc: 0.756 Test Loss: 1.224 Test Acc: 0.756
Validation loss decreased (-0.577764 --> -0.755543).  Saving model ...
Epoch: 8 cost time: 0.7601222991943359
Epoch: 8, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.084 Vali Acc: 0.811 Test Loss: 1.084 Test Acc: 0.811
Validation loss decreased (-0.755543 --> -0.811100).  Saving model ...
Epoch: 9 cost time: 0.785114049911499
Epoch: 9, Steps: 2 | Train Loss: 0.977 Vali Loss: 0.957 Vali Acc: 0.848 Test Loss: 0.957 Test Acc: 0.848
Validation loss decreased (-0.811100 --> -0.848139).  Saving model ...
Epoch: 10 cost time: 0.7686846256256104
Epoch: 10, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.853 Vali Acc: 0.830 Test Loss: 0.853 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7066028118133545
Epoch: 11, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.745 Vali Acc: 0.863 Test Loss: 0.745 Test Acc: 0.863
Validation loss decreased (-0.848139 --> -0.862956).  Saving model ...
Epoch: 12 cost time: 0.814661979675293
Epoch: 12, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.643 Vali Acc: 0.904 Test Loss: 0.643 Test Acc: 0.904
Validation loss decreased (-0.862956 --> -0.903697).  Saving model ...
Epoch: 13 cost time: 0.7575714588165283
Epoch: 13, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.558 Vali Acc: 0.911 Test Loss: 0.558 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911106).  Saving model ...
Epoch: 14 cost time: 0.9276294708251953
Epoch: 14, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.485 Vali Acc: 0.885 Test Loss: 0.485 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6895480155944824
Epoch: 15, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6957521438598633
Epoch: 16, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.8859074115753174
Epoch: 17, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.328 Vali Acc: 0.922 Test Loss: 0.328 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 18 cost time: 0.7828412055969238
Epoch: 18, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9227869510650635
Epoch: 19, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.286 Vali Acc: 0.907 Test Loss: 0.286 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8348395824432373
Epoch: 20, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7156660556793213
Epoch: 21, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.228 Vali Acc: 0.919 Test Loss: 0.228 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9329214096069336
Epoch: 22, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.922219 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.7931327819824219
Epoch: 23, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.8039760589599609
Epoch: 24, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.9350008964538574
Epoch: 25, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.8709709644317627
Epoch: 26, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7629520893096924
Epoch: 27, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8916611671447754
Epoch: 28, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8437848091125488
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7268843650817871
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.691838264465332
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.6935384273529053
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.6942043304443359
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.7879288196563721
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.9911706447601318
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.9039528369903564
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.7355751991271973
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7022860050201416
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.727339506149292
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8791160583496094
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7364339828491211
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8430442810058594
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7986483573913574
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.776451826095581
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.864229679107666
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.0406243801116943
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 6633002
model size : 30.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6867716312408447
Epoch: 1, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.802 Vali Acc: 0.274 Test Loss: 1.802 Test Acc: 0.274
Validation loss decreased (inf --> -0.274056).  Saving model ...
Epoch: 2 cost time: 0.7674872875213623
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.758 Vali Acc: 0.293 Test Loss: 1.758 Test Acc: 0.293
Validation loss decreased (-0.274056 --> -0.292575).  Saving model ...
Epoch: 3 cost time: 0.8827064037322998
Epoch: 3, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.699 Vali Acc: 0.337 Test Loss: 1.699 Test Acc: 0.337
Validation loss decreased (-0.292575 --> -0.337020).  Saving model ...
Epoch: 4 cost time: 0.7367398738861084
Epoch: 4, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.603 Vali Acc: 0.500 Test Loss: 1.603 Test Acc: 0.500
Validation loss decreased (-0.337020 --> -0.499984).  Saving model ...
Epoch: 5 cost time: 0.7845966815948486
Epoch: 5, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.504 Vali Acc: 0.556 Test Loss: 1.504 Test Acc: 0.556
Validation loss decreased (-0.499984 --> -0.555541).  Saving model ...
Epoch: 6 cost time: 0.8237261772155762
Epoch: 6, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.398 Vali Acc: 0.589 Test Loss: 1.398 Test Acc: 0.589
Validation loss decreased (-0.555541 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 0.7804548740386963
Epoch: 7, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.259 Vali Acc: 0.830 Test Loss: 1.259 Test Acc: 0.830
Validation loss decreased (-0.588875 --> -0.829617).  Saving model ...
Epoch: 8 cost time: 0.9105160236358643
Epoch: 8, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.117 Vali Acc: 0.874 Test Loss: 1.117 Test Acc: 0.874
Validation loss decreased (-0.829617 --> -0.874063).  Saving model ...
Epoch: 9 cost time: 0.8113877773284912
Epoch: 9, Steps: 2 | Train Loss: 1.068 Vali Loss: 0.992 Vali Acc: 0.830 Test Loss: 0.992 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8149299621582031
Epoch: 10, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.870 Vali Acc: 0.870 Test Loss: 0.870 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.9608757495880127
Epoch: 11, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.755 Vali Acc: 0.896 Test Loss: 0.755 Test Acc: 0.896
Validation loss decreased (-0.874063 --> -0.896289).  Saving model ...
Epoch: 12 cost time: 0.7202045917510986
Epoch: 12, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.646 Vali Acc: 0.941 Test Loss: 0.646 Test Acc: 0.941
Validation loss decreased (-0.896289 --> -0.940734).  Saving model ...
Epoch: 13 cost time: 0.8182234764099121
Epoch: 13, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.554 Vali Acc: 0.941 Test Loss: 0.554 Test Acc: 0.941
Validation loss decreased (-0.940734 --> -0.940735).  Saving model ...
Epoch: 14 cost time: 0.6930594444274902
Epoch: 14, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.480 Vali Acc: 0.941 Test Loss: 0.480 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 15 cost time: 0.7852439880371094
Epoch: 15, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.418 Vali Acc: 0.926 Test Loss: 0.418 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8784716129302979
Epoch: 16, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.369 Vali Acc: 0.926 Test Loss: 0.369 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6198430061340332
Epoch: 17, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.339 Vali Acc: 0.915 Test Loss: 0.339 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7748713493347168
Epoch: 18, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.295 Vali Acc: 0.926 Test Loss: 0.295 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6811444759368896
Epoch: 19, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940738).  Saving model ...
Epoch: 20 cost time: 0.7396302223205566
Epoch: 20, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.7253603935241699
Epoch: 21, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8058161735534668
Epoch: 22, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7951560020446777
Epoch: 23, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7340908050537109
Epoch: 24, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6814627647399902
Epoch: 25, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7642827033996582
Epoch: 26, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7733361721038818
Epoch: 27, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8905882835388184
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.823206901550293
Epoch: 29, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7391338348388672
Epoch: 30, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 5983274
model size : 27.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.288649559020996
Epoch: 1, Steps: 2 | Train Loss: 1.998 Vali Loss: 1.951 Vali Acc: 0.156 Test Loss: 1.951 Test Acc: 0.156
Validation loss decreased (inf --> -0.155536).  Saving model ...
Epoch: 2 cost time: 0.8335475921630859
Epoch: 2, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.869 Vali Acc: 0.130 Test Loss: 1.869 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8629395961761475
Epoch: 3, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.781 Vali Acc: 0.122 Test Loss: 1.781 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.751793622970581
Epoch: 4, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.671 Vali Acc: 0.359 Test Loss: 1.671 Test Acc: 0.359
Validation loss decreased (-0.155536 --> -0.359243).  Saving model ...
Epoch: 5 cost time: 0.7392213344573975
Epoch: 5, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.583 Vali Acc: 0.581 Test Loss: 1.583 Test Acc: 0.581
Validation loss decreased (-0.359243 --> -0.581466).  Saving model ...
Epoch: 6 cost time: 0.7220921516418457
Epoch: 6, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.480 Vali Acc: 0.641 Test Loss: 1.480 Test Acc: 0.641
Validation loss decreased (-0.581466 --> -0.640726).  Saving model ...
Epoch: 7 cost time: 0.7291305065155029
Epoch: 7, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.339 Vali Acc: 0.700 Test Loss: 1.339 Test Acc: 0.700
Validation loss decreased (-0.640726 --> -0.699987).  Saving model ...
Epoch: 8 cost time: 0.8473408222198486
Epoch: 8, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.179 Vali Acc: 0.785 Test Loss: 1.179 Test Acc: 0.785
Validation loss decreased (-0.699987 --> -0.785173).  Saving model ...
Epoch: 9 cost time: 0.6933999061584473
Epoch: 9, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.043 Vali Acc: 0.867 Test Loss: 1.043 Test Acc: 0.867
Validation loss decreased (-0.785173 --> -0.866656).  Saving model ...
Epoch: 10 cost time: 0.7533853054046631
Epoch: 10, Steps: 2 | Train Loss: 0.966 Vali Loss: 0.936 Vali Acc: 0.774 Test Loss: 0.936 Test Acc: 0.774
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7065317630767822
Epoch: 11, Steps: 2 | Train Loss: 0.806 Vali Loss: 0.821 Vali Acc: 0.833 Test Loss: 0.821 Test Acc: 0.833
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6999149322509766
Epoch: 12, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.702 Vali Acc: 0.922 Test Loss: 0.702 Test Acc: 0.922
Validation loss decreased (-0.866656 --> -0.922215).  Saving model ...
Epoch: 13 cost time: 0.7479720115661621
Epoch: 13, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.603 Vali Acc: 0.948 Test Loss: 0.603 Test Acc: 0.948
Validation loss decreased (-0.922215 --> -0.948142).  Saving model ...
Epoch: 14 cost time: 0.8222689628601074
Epoch: 14, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.520 Vali Acc: 0.956 Test Loss: 0.520 Test Acc: 0.956
Validation loss decreased (-0.948142 --> -0.955550).  Saving model ...
Epoch: 15 cost time: 0.7346727848052979
Epoch: 15, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.448 Vali Acc: 0.937 Test Loss: 0.448 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8160011768341064
Epoch: 16, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.396 Vali Acc: 0.930 Test Loss: 0.396 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8077743053436279
Epoch: 17, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7603859901428223
Epoch: 18, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.291 Vali Acc: 0.959 Test Loss: 0.291 Test Acc: 0.959
Validation loss decreased (-0.955550 --> -0.959256).  Saving model ...
Epoch: 19 cost time: 0.7725310325622559
Epoch: 19, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.260 Vali Acc: 0.948 Test Loss: 0.260 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5629937648773193
Epoch: 20, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7013561725616455
Epoch: 21, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7642889022827148
Epoch: 22, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.230 Vali Acc: 0.915 Test Loss: 0.230 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6977899074554443
Epoch: 23, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7234256267547607
Epoch: 24, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7594475746154785
Epoch: 25, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.714993953704834
Epoch: 26, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7527711391448975
Epoch: 27, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8370745182037354
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 5980970
model size : 27.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4238667488098145
Epoch: 1, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.792 Vali Acc: 0.307 Test Loss: 1.792 Test Acc: 0.307
Validation loss decreased (inf --> -0.307389).  Saving model ...
Epoch: 2 cost time: 0.727165699005127
Epoch: 2, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.740 Vali Acc: 0.396 Test Loss: 1.740 Test Acc: 0.396
Validation loss decreased (-0.307389 --> -0.396279).  Saving model ...
Epoch: 3 cost time: 0.6522636413574219
Epoch: 3, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.675 Vali Acc: 0.437 Test Loss: 1.675 Test Acc: 0.437
Validation loss decreased (-0.396279 --> -0.437020).  Saving model ...
Epoch: 4 cost time: 0.7779946327209473
Epoch: 4, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.582 Vali Acc: 0.444 Test Loss: 1.582 Test Acc: 0.444
Validation loss decreased (-0.437020 --> -0.444429).  Saving model ...
Epoch: 5 cost time: 0.7862339019775391
Epoch: 5, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.491 Vali Acc: 0.496 Test Loss: 1.491 Test Acc: 0.496
Validation loss decreased (-0.444429 --> -0.496281).  Saving model ...
Epoch: 6 cost time: 0.6313214302062988
Epoch: 6, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.388 Vali Acc: 0.570 Test Loss: 1.388 Test Acc: 0.570
Validation loss decreased (-0.496281 --> -0.570356).  Saving model ...
Epoch: 7 cost time: 0.7537927627563477
Epoch: 7, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.280 Vali Acc: 0.596 Test Loss: 1.280 Test Acc: 0.596
Validation loss decreased (-0.570356 --> -0.596283).  Saving model ...
Epoch: 8 cost time: 0.7924766540527344
Epoch: 8, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.147 Vali Acc: 0.719 Test Loss: 1.147 Test Acc: 0.719
Validation loss decreased (-0.596283 --> -0.718507).  Saving model ...
Epoch: 9 cost time: 0.7096188068389893
Epoch: 9, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.025 Vali Acc: 0.748 Test Loss: 1.025 Test Acc: 0.748
Validation loss decreased (-0.718507 --> -0.748138).  Saving model ...
Epoch: 10 cost time: 0.8141980171203613
Epoch: 10, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.917 Vali Acc: 0.737 Test Loss: 0.917 Test Acc: 0.737
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6520040035247803
Epoch: 11, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.836 Vali Acc: 0.704 Test Loss: 0.836 Test Acc: 0.704
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7574315071105957
Epoch: 12, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.716 Vali Acc: 0.859 Test Loss: 0.716 Test Acc: 0.859
Validation loss decreased (-0.748138 --> -0.859252).  Saving model ...
Epoch: 13 cost time: 0.6997160911560059
Epoch: 13, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.617 Vali Acc: 0.930 Test Loss: 0.617 Test Acc: 0.930
Validation loss decreased (-0.859252 --> -0.929623).  Saving model ...
Epoch: 14 cost time: 0.6544084548950195
Epoch: 14, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.543 Vali Acc: 0.930 Test Loss: 0.543 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 15 cost time: 0.806732177734375
Epoch: 15, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.479 Vali Acc: 0.937 Test Loss: 0.479 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 16 cost time: 0.7880821228027344
Epoch: 16, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.430 Vali Acc: 0.919 Test Loss: 0.430 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7629983425140381
Epoch: 17, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.385 Vali Acc: 0.911 Test Loss: 0.385 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7920217514038086
Epoch: 18, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.7055470943450928
Epoch: 19, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.286 Vali Acc: 0.948 Test Loss: 0.286 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 20 cost time: 0.7449464797973633
Epoch: 20, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.256 Vali Acc: 0.941 Test Loss: 0.256 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8307030200958252
Epoch: 21, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7925317287445068
Epoch: 22, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8570263385772705
Epoch: 23, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9757404327392578
Epoch: 24, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.988652229309082
Epoch: 25, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8530881404876709
Epoch: 26, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8306360244750977
Epoch: 27, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8643743991851807
Epoch: 28, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.8303382396697998
Epoch: 29, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.8294169902801514
Epoch: 30, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.8767306804656982
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7768619060516357
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.6391456127166748
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8185527324676514
Epoch: 34, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7514858245849609
Epoch: 35, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.8499059677124023
Epoch: 36, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7331798076629639
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9887776374816895
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.8673093318939209
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.888465404510498
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.8953015804290771
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.7719557285308838
Epoch: 42, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 5978666
model size : 27.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.650723695755005
Epoch: 1, Steps: 2 | Train Loss: 2.028 Vali Loss: 1.870 Vali Acc: 0.133 Test Loss: 1.870 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 0.8133299350738525
Epoch: 2, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.805 Vali Acc: 0.174 Test Loss: 1.805 Test Acc: 0.174
Validation loss decreased (-0.133315 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.8334062099456787
Epoch: 3, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.719 Vali Acc: 0.167 Test Loss: 1.719 Test Acc: 0.167
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8557188510894775
Epoch: 4, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.615 Vali Acc: 0.422 Test Loss: 1.615 Test Acc: 0.422
Validation loss decreased (-0.174056 --> -0.422206).  Saving model ...
Epoch: 5 cost time: 0.7946453094482422
Epoch: 5, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.528 Vali Acc: 0.537 Test Loss: 1.528 Test Acc: 0.537
Validation loss decreased (-0.422206 --> -0.537022).  Saving model ...
Epoch: 6 cost time: 0.7509629726409912
Epoch: 6, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.432 Vali Acc: 0.533 Test Loss: 1.432 Test Acc: 0.533
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7000129222869873
Epoch: 7, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.300 Vali Acc: 0.559 Test Loss: 1.300 Test Acc: 0.559
Validation loss decreased (-0.537022 --> -0.559246).  Saving model ...
Epoch: 8 cost time: 0.815422534942627
Epoch: 8, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.149 Vali Acc: 0.737 Test Loss: 1.149 Test Acc: 0.737
Validation loss decreased (-0.559246 --> -0.737026).  Saving model ...
Epoch: 9 cost time: 0.7555291652679443
Epoch: 9, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.027 Vali Acc: 0.804 Test Loss: 1.027 Test Acc: 0.804
Validation loss decreased (-0.737026 --> -0.803693).  Saving model ...
Epoch: 10 cost time: 0.8848037719726562
Epoch: 10, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.917 Vali Acc: 0.837 Test Loss: 0.917 Test Acc: 0.837
Validation loss decreased (-0.803693 --> -0.837028).  Saving model ...
Epoch: 11 cost time: 0.679288387298584
Epoch: 11, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.812 Vali Acc: 0.907 Test Loss: 0.812 Test Acc: 0.907
Validation loss decreased (-0.837028 --> -0.907399).  Saving model ...
Epoch: 12 cost time: 0.8421633243560791
Epoch: 12, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.714 Vali Acc: 0.915 Test Loss: 0.714 Test Acc: 0.915
Validation loss decreased (-0.907399 --> -0.914808).  Saving model ...
Epoch: 13 cost time: 0.7799739837646484
Epoch: 13, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.628 Vali Acc: 0.926 Test Loss: 0.628 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925920).  Saving model ...
Epoch: 14 cost time: 0.7242839336395264
Epoch: 14, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.548 Vali Acc: 0.937 Test Loss: 0.548 Test Acc: 0.937
Validation loss decreased (-0.925920 --> -0.937032).  Saving model ...
Epoch: 15 cost time: 0.8349597454071045
Epoch: 15, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.493 Vali Acc: 0.922 Test Loss: 0.493 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7830889225006104
Epoch: 16, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.429 Vali Acc: 0.915 Test Loss: 0.429 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.084014654159546
Epoch: 17, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.377 Vali Acc: 0.933 Test Loss: 0.377 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8742172718048096
Epoch: 18, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.331 Vali Acc: 0.944 Test Loss: 0.331 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944441).  Saving model ...
Epoch: 19 cost time: 0.9400463104248047
Epoch: 19, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.312 Vali Acc: 0.930 Test Loss: 0.312 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7821521759033203
Epoch: 20, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8604912757873535
Epoch: 21, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7155425548553467
Epoch: 22, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.720512866973877
Epoch: 23, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0360443592071533
Epoch: 24, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6868674755096436
Epoch: 25, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9594662189483643
Epoch: 26, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 27 cost time: 0.8015084266662598
Epoch: 27, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0865285396575928
Epoch: 28, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8433587551116943
Epoch: 29, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8663978576660156
Epoch: 30, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8330166339874268
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6781494617462158
Epoch: 32, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7476606369018555
Epoch: 33, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.926 Test Loss: 0.182 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7975046634674072
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.926 Test Loss: 0.181 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8659508228302002
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8696999549865723
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 5976362
model size : 27.79MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.208958387374878
Epoch: 1, Steps: 2 | Train Loss: 1.986 Vali Loss: 1.897 Vali Acc: 0.185 Test Loss: 1.897 Test Acc: 0.185
Validation loss decreased (inf --> -0.185166).  Saving model ...
Epoch: 2 cost time: 0.7807602882385254
Epoch: 2, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.844 Vali Acc: 0.211 Test Loss: 1.844 Test Acc: 0.211
Validation loss decreased (-0.185166 --> -0.211093).  Saving model ...
Epoch: 3 cost time: 0.7401714324951172
Epoch: 3, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.779 Vali Acc: 0.230 Test Loss: 1.779 Test Acc: 0.230
Validation loss decreased (-0.211093 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.6976785659790039
Epoch: 4, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.688 Vali Acc: 0.341 Test Loss: 1.688 Test Acc: 0.341
Validation loss decreased (-0.229612 --> -0.340724).  Saving model ...
Epoch: 5 cost time: 0.8862636089324951
Epoch: 5, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.603 Vali Acc: 0.467 Test Loss: 1.603 Test Acc: 0.467
Validation loss decreased (-0.340724 --> -0.466651).  Saving model ...
Epoch: 6 cost time: 0.8328096866607666
Epoch: 6, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.504 Vali Acc: 0.485 Test Loss: 1.504 Test Acc: 0.485
Validation loss decreased (-0.466651 --> -0.485170).  Saving model ...
Epoch: 7 cost time: 0.8926084041595459
Epoch: 7, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.380 Vali Acc: 0.578 Test Loss: 1.380 Test Acc: 0.578
Validation loss decreased (-0.485170 --> -0.577764).  Saving model ...
Epoch: 8 cost time: 0.7448673248291016
Epoch: 8, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.253 Vali Acc: 0.663 Test Loss: 1.253 Test Acc: 0.663
Validation loss decreased (-0.577764 --> -0.662950).  Saving model ...
Epoch: 9 cost time: 0.7298657894134521
Epoch: 9, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.122 Vali Acc: 0.763 Test Loss: 1.122 Test Acc: 0.763
Validation loss decreased (-0.662950 --> -0.762952).  Saving model ...
Epoch: 10 cost time: 0.8179683685302734
Epoch: 10, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.023 Vali Acc: 0.756 Test Loss: 1.023 Test Acc: 0.756
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0569820404052734
Epoch: 11, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.916 Vali Acc: 0.789 Test Loss: 0.916 Test Acc: 0.789
Validation loss decreased (-0.762952 --> -0.788880).  Saving model ...
Epoch: 12 cost time: 0.6880977153778076
Epoch: 12, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.810 Vali Acc: 0.800 Test Loss: 0.810 Test Acc: 0.800
Validation loss decreased (-0.788880 --> -0.799992).  Saving model ...
Epoch: 13 cost time: 0.7569904327392578
Epoch: 13, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.709 Vali Acc: 0.878 Test Loss: 0.709 Test Acc: 0.878
Validation loss decreased (-0.799992 --> -0.877771).  Saving model ...
Epoch: 14 cost time: 0.7746946811676025
Epoch: 14, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.625 Vali Acc: 0.893 Test Loss: 0.625 Test Acc: 0.893
Validation loss decreased (-0.877771 --> -0.892586).  Saving model ...
Epoch: 15 cost time: 0.7732782363891602
Epoch: 15, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.553 Vali Acc: 0.896 Test Loss: 0.553 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896291).  Saving model ...
Epoch: 16 cost time: 0.9712538719177246
Epoch: 16, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.487 Vali Acc: 0.922 Test Loss: 0.487 Test Acc: 0.922
Validation loss decreased (-0.896291 --> -0.922217).  Saving model ...
Epoch: 17 cost time: 0.805311918258667
Epoch: 17, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.442 Vali Acc: 0.896 Test Loss: 0.442 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6149885654449463
Epoch: 18, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.406 Vali Acc: 0.889 Test Loss: 0.406 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7316505908966064
Epoch: 19, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.622319221496582
Epoch: 20, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925923).  Saving model ...
Epoch: 21 cost time: 0.8314003944396973
Epoch: 21, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.285 Vali Acc: 0.937 Test Loss: 0.285 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 0.8811438083648682
Epoch: 22, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 23 cost time: 0.6755881309509277
Epoch: 23, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 24 cost time: 0.7745048999786377
Epoch: 24, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.237 Vali Acc: 0.919 Test Loss: 0.237 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7754166126251221
Epoch: 25, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.237 Vali Acc: 0.919 Test Loss: 0.237 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7103085517883301
Epoch: 26, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7541906833648682
Epoch: 27, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 28 cost time: 0.7076826095581055
Epoch: 28, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 29 cost time: 0.7399177551269531
Epoch: 29, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7471413612365723
Epoch: 30, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7512407302856445
Epoch: 31, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7300388813018799
Epoch: 32, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8792629241943359
Epoch: 33, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.802532434463501
Epoch: 34, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6833326816558838
Epoch: 35, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.7610657215118408
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0676045417785645
Epoch: 37, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.715324878692627
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 5654954
model size : 26.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7601451873779297
Epoch: 1, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.837 Vali Acc: 0.230 Test Loss: 1.837 Test Acc: 0.230
Validation loss decreased (inf --> -0.229611).  Saving model ...
Epoch: 2 cost time: 0.9003908634185791
Epoch: 2, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.764 Vali Acc: 0.300 Test Loss: 1.764 Test Acc: 0.300
Validation loss decreased (-0.229611 --> -0.299982).  Saving model ...
Epoch: 3 cost time: 0.6489231586456299
Epoch: 3, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.684 Vali Acc: 0.341 Test Loss: 1.684 Test Acc: 0.341
Validation loss decreased (-0.299982 --> -0.340724).  Saving model ...
Epoch: 4 cost time: 0.7482321262359619
Epoch: 4, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.593 Vali Acc: 0.422 Test Loss: 1.593 Test Acc: 0.422
Validation loss decreased (-0.340724 --> -0.422206).  Saving model ...
Epoch: 5 cost time: 0.7084267139434814
Epoch: 5, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.507 Vali Acc: 0.474 Test Loss: 1.507 Test Acc: 0.474
Validation loss decreased (-0.422206 --> -0.474059).  Saving model ...
Epoch: 6 cost time: 0.7593846321105957
Epoch: 6, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.400 Vali Acc: 0.641 Test Loss: 1.400 Test Acc: 0.641
Validation loss decreased (-0.474059 --> -0.640727).  Saving model ...
Epoch: 7 cost time: 0.7066147327423096
Epoch: 7, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.266 Vali Acc: 0.715 Test Loss: 1.266 Test Acc: 0.715
Validation loss decreased (-0.640727 --> -0.714802).  Saving model ...
Epoch: 8 cost time: 0.6455719470977783
Epoch: 8, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.124 Vali Acc: 0.830 Test Loss: 1.124 Test Acc: 0.830
Validation loss decreased (-0.714802 --> -0.829618).  Saving model ...
Epoch: 9 cost time: 0.750765323638916
Epoch: 9, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.009 Vali Acc: 0.848 Test Loss: 1.009 Test Acc: 0.848
Validation loss decreased (-0.829618 --> -0.848138).  Saving model ...
Epoch: 10 cost time: 0.770355224609375
Epoch: 10, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.917 Vali Acc: 0.811 Test Loss: 0.917 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7488729953765869
Epoch: 11, Steps: 2 | Train Loss: 0.742 Vali Loss: 0.815 Vali Acc: 0.837 Test Loss: 0.815 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7055830955505371
Epoch: 12, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.715 Vali Acc: 0.856 Test Loss: 0.715 Test Acc: 0.856
Validation loss decreased (-0.848138 --> -0.855548).  Saving model ...
Epoch: 13 cost time: 0.7359042167663574
Epoch: 13, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.620 Vali Acc: 0.933 Test Loss: 0.620 Test Acc: 0.933
Validation loss decreased (-0.855548 --> -0.933327).  Saving model ...
Epoch: 14 cost time: 0.7326617240905762
Epoch: 14, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.544 Vali Acc: 0.926 Test Loss: 0.544 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7213237285614014
Epoch: 15, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.472 Vali Acc: 0.930 Test Loss: 0.472 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8308188915252686
Epoch: 16, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.414 Vali Acc: 0.930 Test Loss: 0.414 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7332119941711426
Epoch: 17, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.363 Vali Acc: 0.937 Test Loss: 0.363 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937033).  Saving model ...
Epoch: 18 cost time: 0.8458046913146973
Epoch: 18, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7877926826477051
Epoch: 19, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 20 cost time: 0.817589521408081
Epoch: 20, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7546830177307129
Epoch: 21, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.260 Vali Acc: 0.915 Test Loss: 0.260 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9290924072265625
Epoch: 22, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.240 Vali Acc: 0.915 Test Loss: 0.240 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8919069766998291
Epoch: 23, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.774057149887085
Epoch: 24, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.7832129001617432
Epoch: 25, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.7135307788848877
Epoch: 26, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6801674365997314
Epoch: 27, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7296090126037598
Epoch: 28, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.205 Vali Acc: 0.915 Test Loss: 0.205 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7223107814788818
Epoch: 29, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.208 Vali Acc: 0.911 Test Loss: 0.208 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0070788860321045
Epoch: 30, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.926 Test Loss: 0.197 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8031322956085205
Epoch: 31, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.186 Vali Acc: 0.926 Test Loss: 0.186 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.84039306640625
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.926 Test Loss: 0.178 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8003487586975098
Epoch: 33, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.173 Vali Acc: 0.930 Test Loss: 0.173 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9464704990386963
Epoch: 34, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.930 Test Loss: 0.171 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7663342952728271
Epoch: 35, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.930 Test Loss: 0.172 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 5652650
model size : 26.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8952395915985107
Epoch: 1, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.923 Vali Acc: 0.170 Test Loss: 1.923 Test Acc: 0.170
Validation loss decreased (inf --> -0.170351).  Saving model ...
Epoch: 2 cost time: 0.7581453323364258
Epoch: 2, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.869 Vali Acc: 0.196 Test Loss: 1.869 Test Acc: 0.196
Validation loss decreased (-0.170351 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.6916306018829346
Epoch: 3, Steps: 2 | Train Loss: 1.960 Vali Loss: 1.808 Vali Acc: 0.219 Test Loss: 1.808 Test Acc: 0.219
Validation loss decreased (-0.196278 --> -0.218500).  Saving model ...
Epoch: 4 cost time: 0.8882203102111816
Epoch: 4, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.725 Vali Acc: 0.222 Test Loss: 1.725 Test Acc: 0.222
Validation loss decreased (-0.218500 --> -0.222205).  Saving model ...
Epoch: 5 cost time: 0.9076621532440186
Epoch: 5, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.632 Vali Acc: 0.430 Test Loss: 1.632 Test Acc: 0.430
Validation loss decreased (-0.222205 --> -0.429613).  Saving model ...
Epoch: 6 cost time: 0.7128772735595703
Epoch: 6, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.517 Vali Acc: 0.559 Test Loss: 1.517 Test Acc: 0.559
Validation loss decreased (-0.429613 --> -0.559244).  Saving model ...
Epoch: 7 cost time: 0.841437578201294
Epoch: 7, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.384 Vali Acc: 0.667 Test Loss: 1.384 Test Acc: 0.667
Validation loss decreased (-0.559244 --> -0.666653).  Saving model ...
Epoch: 8 cost time: 0.9415240287780762
Epoch: 8, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.245 Vali Acc: 0.759 Test Loss: 1.245 Test Acc: 0.759
Validation loss decreased (-0.666653 --> -0.759247).  Saving model ...
Epoch: 9 cost time: 0.7690730094909668
Epoch: 9, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.112 Vali Acc: 0.848 Test Loss: 1.112 Test Acc: 0.848
Validation loss decreased (-0.759247 --> -0.848137).  Saving model ...
Epoch: 10 cost time: 0.7690300941467285
Epoch: 10, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.001 Vali Acc: 0.852 Test Loss: 1.001 Test Acc: 0.852
Validation loss decreased (-0.848137 --> -0.851842).  Saving model ...
Epoch: 11 cost time: 0.9289505481719971
Epoch: 11, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.888 Vali Acc: 0.930 Test Loss: 0.888 Test Acc: 0.930
Validation loss decreased (-0.851842 --> -0.929621).  Saving model ...
Epoch: 12 cost time: 0.767376184463501
Epoch: 12, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.788 Vali Acc: 0.896 Test Loss: 0.788 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1528558731079102
Epoch: 13, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.693 Vali Acc: 0.907 Test Loss: 0.693 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7721893787384033
Epoch: 14, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.607 Vali Acc: 0.911 Test Loss: 0.607 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7780418395996094
Epoch: 15, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.531 Vali Acc: 0.948 Test Loss: 0.531 Test Acc: 0.948
Validation loss decreased (-0.929621 --> -0.948143).  Saving model ...
Epoch: 16 cost time: 0.7847785949707031
Epoch: 16, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.473 Vali Acc: 0.948 Test Loss: 0.473 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948143).  Saving model ...
Epoch: 17 cost time: 0.827873945236206
Epoch: 17, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.417 Vali Acc: 0.944 Test Loss: 0.417 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8641808032989502
Epoch: 18, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.373 Vali Acc: 0.930 Test Loss: 0.373 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8486974239349365
Epoch: 19, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.326 Vali Acc: 0.937 Test Loss: 0.326 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8053033351898193
Epoch: 20, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.298 Vali Acc: 0.937 Test Loss: 0.298 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7256851196289062
Epoch: 21, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0098903179168701
Epoch: 22, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.818610429763794
Epoch: 23, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.215078592300415
Epoch: 24, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7664027214050293
Epoch: 25, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8241610527038574
Epoch: 26, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 5650346
model size : 26.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4112043380737305
Epoch: 1, Steps: 2 | Train Loss: 2.105 Vali Loss: 2.027 Vali Acc: 0.167 Test Loss: 2.027 Test Acc: 0.167
Validation loss decreased (inf --> -0.166646).  Saving model ...
Epoch: 2 cost time: 0.8838558197021484
Epoch: 2, Steps: 2 | Train Loss: 2.005 Vali Loss: 1.939 Vali Acc: 0.137 Test Loss: 1.939 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8844811916351318
Epoch: 3, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.846 Vali Acc: 0.100 Test Loss: 1.846 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9084136486053467
Epoch: 4, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.729 Vali Acc: 0.274 Test Loss: 1.729 Test Acc: 0.274
Validation loss decreased (-0.166646 --> -0.274057).  Saving model ...
Epoch: 5 cost time: 0.8364095687866211
Epoch: 5, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.646 Vali Acc: 0.444 Test Loss: 1.646 Test Acc: 0.444
Validation loss decreased (-0.274057 --> -0.444428).  Saving model ...
Epoch: 6 cost time: 0.801196813583374
Epoch: 6, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.568 Vali Acc: 0.489 Test Loss: 1.568 Test Acc: 0.489
Validation loss decreased (-0.444428 --> -0.488873).  Saving model ...
Epoch: 7 cost time: 0.7586929798126221
Epoch: 7, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.444 Vali Acc: 0.596 Test Loss: 1.444 Test Acc: 0.596
Validation loss decreased (-0.488873 --> -0.596282).  Saving model ...
Epoch: 8 cost time: 0.7255885601043701
Epoch: 8, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.291 Vali Acc: 0.619 Test Loss: 1.291 Test Acc: 0.619
Validation loss decreased (-0.596282 --> -0.618506).  Saving model ...
Epoch: 9 cost time: 0.9474239349365234
Epoch: 9, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.146 Vali Acc: 0.707 Test Loss: 1.146 Test Acc: 0.707
Validation loss decreased (-0.618506 --> -0.707396).  Saving model ...
Epoch: 10 cost time: 0.8297092914581299
Epoch: 10, Steps: 2 | Train Loss: 1.074 Vali Loss: 1.035 Vali Acc: 0.704 Test Loss: 1.035 Test Acc: 0.704
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.879875659942627
Epoch: 11, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.935 Vali Acc: 0.722 Test Loss: 0.935 Test Acc: 0.722
Validation loss decreased (-0.707396 --> -0.722213).  Saving model ...
Epoch: 12 cost time: 0.733100175857544
Epoch: 12, Steps: 2 | Train Loss: 0.785 Vali Loss: 0.844 Vali Acc: 0.737 Test Loss: 0.844 Test Acc: 0.737
Validation loss decreased (-0.722213 --> -0.737029).  Saving model ...
Epoch: 13 cost time: 0.6506853103637695
Epoch: 13, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.749 Vali Acc: 0.844 Test Loss: 0.749 Test Acc: 0.844
Validation loss decreased (-0.737029 --> -0.844437).  Saving model ...
Epoch: 14 cost time: 0.8863203525543213
Epoch: 14, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.640 Vali Acc: 0.907 Test Loss: 0.640 Test Acc: 0.907
Validation loss decreased (-0.844437 --> -0.907401).  Saving model ...
Epoch: 15 cost time: 0.9086775779724121
Epoch: 15, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.564 Vali Acc: 0.907 Test Loss: 0.564 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 16 cost time: 0.7826550006866455
Epoch: 16, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.496 Vali Acc: 0.922 Test Loss: 0.496 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922217).  Saving model ...
Epoch: 17 cost time: 0.7379515171051025
Epoch: 17, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.857081413269043
Epoch: 18, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.406 Vali Acc: 0.919 Test Loss: 0.406 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9457869529724121
Epoch: 19, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.350 Vali Acc: 0.952 Test Loss: 0.350 Test Acc: 0.952
Validation loss decreased (-0.922217 --> -0.951848).  Saving model ...
Epoch: 20 cost time: 0.8763911724090576
Epoch: 20, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9096040725708008
Epoch: 21, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7771730422973633
Epoch: 22, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.263 Vali Acc: 0.926 Test Loss: 0.263 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.747143030166626
Epoch: 23, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.807225227355957
Epoch: 24, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7641775608062744
Epoch: 25, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9578342437744141
Epoch: 26, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0185542106628418
Epoch: 27, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6595220565795898
Epoch: 28, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8595144748687744
Epoch: 29, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 5648042
model size : 26.54MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4637789726257324
Epoch: 1, Steps: 2 | Train Loss: 2.187 Vali Loss: 2.113 Vali Acc: 0.037 Test Loss: 2.113 Test Acc: 0.037
Validation loss decreased (inf --> -0.037016).  Saving model ...
Epoch: 2 cost time: 0.9317734241485596
Epoch: 2, Steps: 2 | Train Loss: 2.048 Vali Loss: 2.057 Vali Acc: 0.030 Test Loss: 2.057 Test Acc: 0.030
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8776998519897461
Epoch: 3, Steps: 2 | Train Loss: 2.033 Vali Loss: 1.989 Vali Acc: 0.033 Test Loss: 1.989 Test Acc: 0.033
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9278213977813721
Epoch: 4, Steps: 2 | Train Loss: 1.963 Vali Loss: 1.898 Vali Acc: 0.063 Test Loss: 1.898 Test Acc: 0.063
Validation loss decreased (-0.037016 --> -0.062944).  Saving model ...
Epoch: 5 cost time: 0.8335695266723633
Epoch: 5, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.818 Vali Acc: 0.159 Test Loss: 1.818 Test Acc: 0.159
Validation loss decreased (-0.062944 --> -0.159241).  Saving model ...
Epoch: 6 cost time: 0.9263942241668701
Epoch: 6, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.753 Vali Acc: 0.352 Test Loss: 1.753 Test Acc: 0.352
Validation loss decreased (-0.159241 --> -0.351834).  Saving model ...
Epoch: 7 cost time: 0.9733321666717529
Epoch: 7, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.702 Vali Acc: 0.385 Test Loss: 1.702 Test Acc: 0.385
Validation loss decreased (-0.351834 --> -0.385168).  Saving model ...
Epoch: 8 cost time: 1.0917365550994873
Epoch: 8, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.623 Vali Acc: 0.404 Test Loss: 1.623 Test Acc: 0.404
Validation loss decreased (-0.385168 --> -0.403687).  Saving model ...
Epoch: 9 cost time: 1.0265874862670898
Epoch: 9, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.516 Vali Acc: 0.456 Test Loss: 1.516 Test Acc: 0.456
Validation loss decreased (-0.403687 --> -0.455540).  Saving model ...
Epoch: 10 cost time: 0.861027717590332
Epoch: 10, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.403 Vali Acc: 0.574 Test Loss: 1.403 Test Acc: 0.574
Validation loss decreased (-0.455540 --> -0.574060).  Saving model ...
Epoch: 11 cost time: 0.8914721012115479
Epoch: 11, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.305 Vali Acc: 0.674 Test Loss: 1.305 Test Acc: 0.674
Validation loss decreased (-0.574060 --> -0.674061).  Saving model ...
Epoch: 12 cost time: 0.7942612171173096
Epoch: 12, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.214 Vali Acc: 0.663 Test Loss: 1.214 Test Acc: 0.663
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7991642951965332
Epoch: 13, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.127 Vali Acc: 0.715 Test Loss: 1.127 Test Acc: 0.715
Validation loss decreased (-0.674061 --> -0.714804).  Saving model ...
Epoch: 14 cost time: 0.7310090065002441
Epoch: 14, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.030 Vali Acc: 0.763 Test Loss: 1.030 Test Acc: 0.763
Validation loss decreased (-0.714804 --> -0.762953).  Saving model ...
Epoch: 15 cost time: 0.6941816806793213
Epoch: 15, Steps: 2 | Train Loss: 0.845 Vali Loss: 0.925 Vali Acc: 0.852 Test Loss: 0.925 Test Acc: 0.852
Validation loss decreased (-0.762953 --> -0.851843).  Saving model ...
Epoch: 16 cost time: 0.9569973945617676
Epoch: 16, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.836 Vali Acc: 0.881 Test Loss: 0.836 Test Acc: 0.881
Validation loss decreased (-0.851843 --> -0.881473).  Saving model ...
Epoch: 17 cost time: 0.913079023361206
Epoch: 17, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.751 Vali Acc: 0.911 Test Loss: 0.751 Test Acc: 0.911
Validation loss decreased (-0.881473 --> -0.911104).  Saving model ...
Epoch: 18 cost time: 1.0305471420288086
Epoch: 18, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.671 Vali Acc: 0.937 Test Loss: 0.671 Test Acc: 0.937
Validation loss decreased (-0.911104 --> -0.937030).  Saving model ...
Epoch: 19 cost time: 1.168189287185669
Epoch: 19, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.597 Vali Acc: 0.944 Test Loss: 0.597 Test Acc: 0.944
Validation loss decreased (-0.937030 --> -0.944438).  Saving model ...
Epoch: 20 cost time: 0.6331560611724854
Epoch: 20, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.533 Vali Acc: 0.941 Test Loss: 0.533 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7707276344299316
Epoch: 21, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.481 Vali Acc: 0.915 Test Loss: 0.481 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7253909111022949
Epoch: 22, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.433 Vali Acc: 0.915 Test Loss: 0.433 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.80143141746521
Epoch: 23, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.395 Vali Acc: 0.904 Test Loss: 0.395 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.925250768661499
Epoch: 24, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8646149635314941
Epoch: 25, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.325 Vali Acc: 0.915 Test Loss: 0.325 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0625863075256348
Epoch: 26, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8603806495666504
Epoch: 27, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.278 Vali Acc: 0.930 Test Loss: 0.278 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9109103679656982
Epoch: 28, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.113755464553833
Epoch: 29, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.261 Vali Acc: 0.919 Test Loss: 0.261 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 2668458
model size : 12.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.723243236541748
Epoch: 1, Steps: 2 | Train Loss: 2.038 Vali Loss: 1.911 Vali Acc: 0.181 Test Loss: 1.911 Test Acc: 0.181
Validation loss decreased (inf --> -0.181462).  Saving model ...
Epoch: 2 cost time: 0.8111424446105957
Epoch: 2, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.856 Vali Acc: 0.215 Test Loss: 1.856 Test Acc: 0.215
Validation loss decreased (-0.181462 --> -0.214796).  Saving model ...
Epoch: 3 cost time: 0.7785680294036865
Epoch: 3, Steps: 2 | Train Loss: 1.933 Vali Loss: 1.797 Vali Acc: 0.263 Test Loss: 1.797 Test Acc: 0.263
Validation loss decreased (-0.214796 --> -0.262945).  Saving model ...
Epoch: 4 cost time: 0.6883580684661865
Epoch: 4, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.713 Vali Acc: 0.378 Test Loss: 1.713 Test Acc: 0.378
Validation loss decreased (-0.262945 --> -0.377761).  Saving model ...
Epoch: 5 cost time: 0.8187458515167236
Epoch: 5, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.632 Vali Acc: 0.456 Test Loss: 1.632 Test Acc: 0.456
Validation loss decreased (-0.377761 --> -0.455539).  Saving model ...
Epoch: 6 cost time: 0.8459148406982422
Epoch: 6, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.566 Vali Acc: 0.530 Test Loss: 1.566 Test Acc: 0.530
Validation loss decreased (-0.455539 --> -0.529614).  Saving model ...
Epoch: 7 cost time: 0.6431639194488525
Epoch: 7, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.500 Vali Acc: 0.619 Test Loss: 1.500 Test Acc: 0.619
Validation loss decreased (-0.529614 --> -0.618504).  Saving model ...
Epoch: 8 cost time: 0.7848343849182129
Epoch: 8, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.425 Vali Acc: 0.626 Test Loss: 1.425 Test Acc: 0.626
Validation loss decreased (-0.618504 --> -0.625912).  Saving model ...
Epoch: 9 cost time: 0.7606339454650879
Epoch: 9, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.329 Vali Acc: 0.667 Test Loss: 1.329 Test Acc: 0.667
Validation loss decreased (-0.625912 --> -0.666653).  Saving model ...
Epoch: 10 cost time: 0.8948783874511719
Epoch: 10, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.224 Vali Acc: 0.759 Test Loss: 1.224 Test Acc: 0.759
Validation loss decreased (-0.666653 --> -0.759247).  Saving model ...
Epoch: 11 cost time: 0.7750363349914551
Epoch: 11, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.118 Vali Acc: 0.867 Test Loss: 1.118 Test Acc: 0.867
Validation loss decreased (-0.759247 --> -0.866655).  Saving model ...
Epoch: 12 cost time: 0.7203924655914307
Epoch: 12, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.024 Vali Acc: 0.900 Test Loss: 1.024 Test Acc: 0.900
Validation loss decreased (-0.866655 --> -0.899990).  Saving model ...
Epoch: 13 cost time: 0.7696659564971924
Epoch: 13, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.943 Vali Acc: 0.896 Test Loss: 0.943 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8347506523132324
Epoch: 14, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.853 Vali Acc: 0.904 Test Loss: 0.853 Test Acc: 0.904
Validation loss decreased (-0.899990 --> -0.903695).  Saving model ...
Epoch: 15 cost time: 0.6818752288818359
Epoch: 15, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.754 Vali Acc: 0.937 Test Loss: 0.754 Test Acc: 0.937
Validation loss decreased (-0.903695 --> -0.937029).  Saving model ...
Epoch: 16 cost time: 0.6784844398498535
Epoch: 16, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.676 Vali Acc: 0.926 Test Loss: 0.676 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7774126529693604
Epoch: 17, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.610 Vali Acc: 0.915 Test Loss: 0.610 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7168104648590088
Epoch: 18, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.548 Vali Acc: 0.904 Test Loss: 0.548 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.0969533920288086
Epoch: 19, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.495 Vali Acc: 0.893 Test Loss: 0.495 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9418141841888428
Epoch: 20, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.452 Vali Acc: 0.896 Test Loss: 0.452 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8511590957641602
Epoch: 21, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.409 Vali Acc: 0.907 Test Loss: 0.409 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8112378120422363
Epoch: 22, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.368 Vali Acc: 0.922 Test Loss: 0.368 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8218975067138672
Epoch: 23, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.338 Vali Acc: 0.926 Test Loss: 0.338 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8243377208709717
Epoch: 24, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9493179321289062
Epoch: 25, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.310 Vali Acc: 0.904 Test Loss: 0.310 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 2667306
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5186398029327393
Epoch: 1, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.726 Vali Acc: 0.341 Test Loss: 1.726 Test Acc: 0.341
Validation loss decreased (inf --> -0.340723).  Saving model ...
Epoch: 2 cost time: 0.9694609642028809
Epoch: 2, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.701 Vali Acc: 0.337 Test Loss: 1.701 Test Acc: 0.337
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9018688201904297
Epoch: 3, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.669 Vali Acc: 0.348 Test Loss: 1.669 Test Acc: 0.348
Validation loss decreased (-0.340723 --> -0.348131).  Saving model ...
Epoch: 4 cost time: 0.7603931427001953
Epoch: 4, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.618 Vali Acc: 0.426 Test Loss: 1.618 Test Acc: 0.426
Validation loss decreased (-0.348131 --> -0.425910).  Saving model ...
Epoch: 5 cost time: 0.6699662208557129
Epoch: 5, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.563 Vali Acc: 0.463 Test Loss: 1.563 Test Acc: 0.463
Validation loss decreased (-0.425910 --> -0.462947).  Saving model ...
Epoch: 6 cost time: 0.7485418319702148
Epoch: 6, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.503 Vali Acc: 0.526 Test Loss: 1.503 Test Acc: 0.526
Validation loss decreased (-0.462947 --> -0.525911).  Saving model ...
Epoch: 7 cost time: 0.8738977909088135
Epoch: 7, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.432 Vali Acc: 0.626 Test Loss: 1.432 Test Acc: 0.626
Validation loss decreased (-0.525911 --> -0.625912).  Saving model ...
Epoch: 8 cost time: 0.8697049617767334
Epoch: 8, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.344 Vali Acc: 0.778 Test Loss: 1.344 Test Acc: 0.778
Validation loss decreased (-0.625912 --> -0.777764).  Saving model ...
Epoch: 9 cost time: 0.731189489364624
Epoch: 9, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.248 Vali Acc: 0.804 Test Loss: 1.248 Test Acc: 0.804
Validation loss decreased (-0.777764 --> -0.803691).  Saving model ...
Epoch: 10 cost time: 0.6612634658813477
Epoch: 10, Steps: 2 | Train Loss: 1.158 Vali Loss: 1.156 Vali Acc: 0.807 Test Loss: 1.156 Test Acc: 0.807
Validation loss decreased (-0.803691 --> -0.807396).  Saving model ...
Epoch: 11 cost time: 0.7355673313140869
Epoch: 11, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.069 Vali Acc: 0.844 Test Loss: 1.069 Test Acc: 0.844
Validation loss decreased (-0.807396 --> -0.844434).  Saving model ...
Epoch: 12 cost time: 0.8418011665344238
Epoch: 12, Steps: 2 | Train Loss: 0.961 Vali Loss: 0.977 Vali Acc: 0.885 Test Loss: 0.977 Test Acc: 0.885
Validation loss decreased (-0.844434 --> -0.885175).  Saving model ...
Epoch: 13 cost time: 0.6843020915985107
Epoch: 13, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.885 Vali Acc: 0.915 Test Loss: 0.885 Test Acc: 0.915
Validation loss decreased (-0.885175 --> -0.914806).  Saving model ...
Epoch: 14 cost time: 0.8493654727935791
Epoch: 14, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.791 Vali Acc: 0.919 Test Loss: 0.791 Test Acc: 0.919
Validation loss decreased (-0.914806 --> -0.918511).  Saving model ...
Epoch: 15 cost time: 0.9122636318206787
Epoch: 15, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.708 Vali Acc: 0.926 Test Loss: 0.708 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925919).  Saving model ...
Epoch: 16 cost time: 0.740525484085083
Epoch: 16, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.629 Vali Acc: 0.926 Test Loss: 0.629 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925920).  Saving model ...
Epoch: 17 cost time: 0.660618782043457
Epoch: 17, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.559 Vali Acc: 0.915 Test Loss: 0.559 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8240206241607666
Epoch: 18, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.493 Vali Acc: 0.930 Test Loss: 0.493 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929625).  Saving model ...
Epoch: 19 cost time: 0.7693276405334473
Epoch: 19, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.441 Vali Acc: 0.926 Test Loss: 0.441 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.816774845123291
Epoch: 20, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.389 Vali Acc: 0.937 Test Loss: 0.389 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 21 cost time: 0.8579220771789551
Epoch: 21, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.348 Vali Acc: 0.948 Test Loss: 0.348 Test Acc: 0.948
Validation loss decreased (-0.937033 --> -0.948145).  Saving model ...
Epoch: 22 cost time: 0.8739092350006104
Epoch: 22, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.318 Vali Acc: 0.944 Test Loss: 0.318 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7695634365081787
Epoch: 23, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.293 Vali Acc: 0.948 Test Loss: 0.293 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 24 cost time: 0.6484630107879639
Epoch: 24, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8814258575439453
Epoch: 25, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.261 Vali Acc: 0.941 Test Loss: 0.261 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7974064350128174
Epoch: 26, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7273061275482178
Epoch: 27, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7385625839233398
Epoch: 28, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8547337055206299
Epoch: 29, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8511598110198975
Epoch: 30, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.7819771766662598
Epoch: 31, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9212164878845215
Epoch: 32, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8650758266448975
Epoch: 33, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8553786277770996
Epoch: 34, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8370265960693359
Epoch: 35, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.7448067665100098
Epoch: 36, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.67954421043396
Epoch: 37, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.800037145614624
Epoch: 38, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.8026723861694336
Epoch: 39, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9595036506652832
Epoch: 40, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.9846079349517822
Epoch: 41, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.78413987159729
Epoch: 42, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.7117941379547119
Epoch: 43, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.7674431800842285
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948147).  Saving model ...
Epoch: 45 cost time: 0.6660475730895996
Epoch: 45, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 46 cost time: 0.7918968200683594
Epoch: 46, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
Validation loss decreased (-0.948147 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.793067216873169
Epoch: 47, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7341737747192383
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.8030750751495361
Epoch: 49, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.6629512310028076
Epoch: 50, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 51 cost time: 0.8869965076446533
Epoch: 51, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 52 cost time: 0.6184430122375488
Epoch: 52, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.948 Test Loss: 0.158 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.7342565059661865
Epoch: 53, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.948 Test Loss: 0.158 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6475799083709717
Epoch: 54, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.948 Test Loss: 0.158 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.7588415145874023
Epoch: 55, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.158 Vali Acc: 0.948 Test Loss: 0.158 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.8316881656646729
Epoch: 56, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.158 Vali Acc: 0.948 Test Loss: 0.158 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.7470722198486328
Epoch: 57, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.948 Test Loss: 0.156 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.748436689376831
Epoch: 58, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.156 Vali Acc: 0.948 Test Loss: 0.156 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.7472794055938721
Epoch: 59, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.948 Test Loss: 0.156 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.6814100742340088
Epoch: 60, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.155 Vali Acc: 0.948 Test Loss: 0.155 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.7693488597869873
Epoch: 61, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.154 Vali Acc: 0.948 Test Loss: 0.154 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 2666154
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.51155161857605
Epoch: 1, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.857 Vali Acc: 0.167 Test Loss: 1.857 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.8065543174743652
Epoch: 2, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.829 Vali Acc: 0.170 Test Loss: 1.829 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170352).  Saving model ...
Epoch: 3 cost time: 1.0417826175689697
Epoch: 3, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.793 Vali Acc: 0.215 Test Loss: 1.793 Test Acc: 0.215
Validation loss decreased (-0.170352 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 0.7994403839111328
Epoch: 4, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.734 Vali Acc: 0.326 Test Loss: 1.734 Test Acc: 0.326
Validation loss decreased (-0.214797 --> -0.325909).  Saving model ...
Epoch: 5 cost time: 0.819981575012207
Epoch: 5, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.673 Vali Acc: 0.422 Test Loss: 1.673 Test Acc: 0.422
Validation loss decreased (-0.325909 --> -0.422205).  Saving model ...
Epoch: 6 cost time: 0.759812593460083
Epoch: 6, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.606 Vali Acc: 0.500 Test Loss: 1.606 Test Acc: 0.500
Validation loss decreased (-0.422205 --> -0.499984).  Saving model ...
Epoch: 7 cost time: 0.904747724533081
Epoch: 7, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.530 Vali Acc: 0.648 Test Loss: 1.530 Test Acc: 0.648
Validation loss decreased (-0.499984 --> -0.648133).  Saving model ...
Epoch: 8 cost time: 0.7379214763641357
Epoch: 8, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.440 Vali Acc: 0.711 Test Loss: 1.440 Test Acc: 0.711
Validation loss decreased (-0.648133 --> -0.711097).  Saving model ...
Epoch: 9 cost time: 0.8105237483978271
Epoch: 9, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.344 Vali Acc: 0.778 Test Loss: 1.344 Test Acc: 0.778
Validation loss decreased (-0.711097 --> -0.777764).  Saving model ...
Epoch: 10 cost time: 0.9044156074523926
Epoch: 10, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.245 Vali Acc: 0.796 Test Loss: 1.245 Test Acc: 0.796
Validation loss decreased (-0.777764 --> -0.796284).  Saving model ...
Epoch: 11 cost time: 1.0638341903686523
Epoch: 11, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.144 Vali Acc: 0.856 Test Loss: 1.144 Test Acc: 0.856
Validation loss decreased (-0.796284 --> -0.855544).  Saving model ...
Epoch: 12 cost time: 0.8346772193908691
Epoch: 12, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.043 Vali Acc: 0.874 Test Loss: 1.043 Test Acc: 0.874
Validation loss decreased (-0.855544 --> -0.874064).  Saving model ...
Epoch: 13 cost time: 0.7533283233642578
Epoch: 13, Steps: 2 | Train Loss: 0.947 Vali Loss: 0.943 Vali Acc: 0.893 Test Loss: 0.943 Test Acc: 0.893
Validation loss decreased (-0.874064 --> -0.892583).  Saving model ...
Epoch: 14 cost time: 0.8047361373901367
Epoch: 14, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.838 Vali Acc: 0.915 Test Loss: 0.838 Test Acc: 0.915
Validation loss decreased (-0.892583 --> -0.914806).  Saving model ...
Epoch: 15 cost time: 0.8171570301055908
Epoch: 15, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.744 Vali Acc: 0.907 Test Loss: 0.744 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9057316780090332
Epoch: 16, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.658 Vali Acc: 0.900 Test Loss: 0.658 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0387823581695557
Epoch: 17, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.577 Vali Acc: 0.904 Test Loss: 0.577 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1473023891448975
Epoch: 18, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.510 Vali Acc: 0.911 Test Loss: 0.510 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1204285621643066
Epoch: 19, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.446 Vali Acc: 0.944 Test Loss: 0.446 Test Acc: 0.944
Validation loss decreased (-0.914806 --> -0.944440).  Saving model ...
Epoch: 20 cost time: 0.93524169921875
Epoch: 20, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.401 Vali Acc: 0.937 Test Loss: 0.401 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9486982822418213
Epoch: 21, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.370 Vali Acc: 0.926 Test Loss: 0.370 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8085448741912842
Epoch: 22, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.349 Vali Acc: 0.911 Test Loss: 0.349 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8113675117492676
Epoch: 23, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.328 Vali Acc: 0.911 Test Loss: 0.328 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0241835117340088
Epoch: 24, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.308 Vali Acc: 0.915 Test Loss: 0.308 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.0867094993591309
Epoch: 25, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.289 Vali Acc: 0.922 Test Loss: 0.289 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8986332416534424
Epoch: 26, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7810206413269043
Epoch: 27, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.81284499168396
Epoch: 28, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.706934928894043
Epoch: 29, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.6422457695007324
Epoch: 30, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.8174457550048828
Epoch: 31, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9093620777130127
Epoch: 32, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7726845741271973
Epoch: 33, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8909308910369873
Epoch: 34, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8214240074157715
Epoch: 35, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6713993549346924
Epoch: 36, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.8629679679870605
Epoch: 37, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8193826675415039
Epoch: 38, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 1.049607276916504
Epoch: 39, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.7822291851043701
Epoch: 40, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.7599489688873291
Epoch: 41, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7344896793365479
Epoch: 42, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7676217555999756
Epoch: 43, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9507052898406982
Epoch: 44, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.0088651180267334
Epoch: 45, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.9331750869750977
Epoch: 46, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 1.0894553661346436
Epoch: 47, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.920586109161377
Epoch: 48, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.8890743255615234
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.7378237247467041
Epoch: 50, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.948829174041748
Epoch: 51, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 1.0766944885253906
Epoch: 52, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.8968935012817383
Epoch: 53, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.9513847827911377
Epoch: 54, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.8606946468353271
Epoch: 55, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.8721630573272705
Epoch: 56, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 57 cost time: 1.0556023120880127
Epoch: 57, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 58 cost time: 0.938368558883667
Epoch: 58, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 59 cost time: 0.7958168983459473
Epoch: 59, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 60 cost time: 1.042349100112915
Epoch: 60, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.7696847915649414
Epoch: 61, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.9841783046722412
Epoch: 62, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 63 cost time: 0.8662126064300537
Epoch: 63, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 1.152254343032837
Epoch: 64, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.9744415283203125
Epoch: 65, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.76108717918396
Epoch: 66, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.9673011302947998
Epoch: 67, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 1.2340166568756104
Epoch: 68, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.977473258972168
Epoch: 69, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.9156749248504639
Epoch: 70, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.9257268905639648
Epoch: 71, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.7825536727905273
Epoch: 72, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 2665002
model size : 12.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.24873423576355
Epoch: 1, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.885 Vali Acc: 0.185 Test Loss: 1.885 Test Acc: 0.185
Validation loss decreased (inf --> -0.185166).  Saving model ...
Epoch: 2 cost time: 0.9055523872375488
Epoch: 2, Steps: 2 | Train Loss: 1.954 Vali Loss: 1.848 Vali Acc: 0.193 Test Loss: 1.848 Test Acc: 0.193
Validation loss decreased (-0.185166 --> -0.192574).  Saving model ...
Epoch: 3 cost time: 0.7808005809783936
Epoch: 3, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.808 Vali Acc: 0.222 Test Loss: 1.808 Test Acc: 0.222
Validation loss decreased (-0.192574 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.77126145362854
Epoch: 4, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.757 Vali Acc: 0.259 Test Loss: 1.757 Test Acc: 0.259
Validation loss decreased (-0.222204 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 0.8871610164642334
Epoch: 5, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.703 Vali Acc: 0.267 Test Loss: 1.703 Test Acc: 0.267
Validation loss decreased (-0.259242 --> -0.266650).  Saving model ...
Epoch: 6 cost time: 0.7576637268066406
Epoch: 6, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.649 Vali Acc: 0.452 Test Loss: 1.649 Test Acc: 0.452
Validation loss decreased (-0.266650 --> -0.451835).  Saving model ...
Epoch: 7 cost time: 0.8109376430511475
Epoch: 7, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.589 Vali Acc: 0.481 Test Loss: 1.589 Test Acc: 0.481
Validation loss decreased (-0.451835 --> -0.481466).  Saving model ...
Epoch: 8 cost time: 0.6101813316345215
Epoch: 8, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.518 Vali Acc: 0.519 Test Loss: 1.518 Test Acc: 0.519
Validation loss decreased (-0.481466 --> -0.518503).  Saving model ...
Epoch: 9 cost time: 0.7485041618347168
Epoch: 9, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.439 Vali Acc: 0.574 Test Loss: 1.439 Test Acc: 0.574
Validation loss decreased (-0.518503 --> -0.574060).  Saving model ...
Epoch: 10 cost time: 0.8093099594116211
Epoch: 10, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.357 Vali Acc: 0.663 Test Loss: 1.357 Test Acc: 0.663
Validation loss decreased (-0.574060 --> -0.662949).  Saving model ...
Epoch: 11 cost time: 0.7350749969482422
Epoch: 11, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.272 Vali Acc: 0.744 Test Loss: 1.272 Test Acc: 0.744
Validation loss decreased (-0.662949 --> -0.744432).  Saving model ...
Epoch: 12 cost time: 0.8427963256835938
Epoch: 12, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.186 Vali Acc: 0.781 Test Loss: 1.186 Test Acc: 0.781
Validation loss decreased (-0.744432 --> -0.781470).  Saving model ...
Epoch: 13 cost time: 0.6656486988067627
Epoch: 13, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.099 Vali Acc: 0.804 Test Loss: 1.099 Test Acc: 0.804
Validation loss decreased (-0.781470 --> -0.803693).  Saving model ...
Epoch: 14 cost time: 0.7757573127746582
Epoch: 14, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.011 Vali Acc: 0.852 Test Loss: 1.011 Test Acc: 0.852
Validation loss decreased (-0.803693 --> -0.851842).  Saving model ...
Epoch: 15 cost time: 0.6948227882385254
Epoch: 15, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.925 Vali Acc: 0.874 Test Loss: 0.925 Test Acc: 0.874
Validation loss decreased (-0.851842 --> -0.874065).  Saving model ...
Epoch: 16 cost time: 0.632763147354126
Epoch: 16, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.848 Vali Acc: 0.870 Test Loss: 0.848 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7992379665374756
Epoch: 17, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.772 Vali Acc: 0.896 Test Loss: 0.772 Test Acc: 0.896
Validation loss decreased (-0.874065 --> -0.896289).  Saving model ...
Epoch: 18 cost time: 0.7137880325317383
Epoch: 18, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.699 Vali Acc: 0.926 Test Loss: 0.699 Test Acc: 0.926
Validation loss decreased (-0.896289 --> -0.925919).  Saving model ...
Epoch: 19 cost time: 0.7023451328277588
Epoch: 19, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.635 Vali Acc: 0.933 Test Loss: 0.635 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933327).  Saving model ...
Epoch: 20 cost time: 1.0650832653045654
Epoch: 20, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.574 Vali Acc: 0.944 Test Loss: 0.574 Test Acc: 0.944
Validation loss decreased (-0.933327 --> -0.944439).  Saving model ...
Epoch: 21 cost time: 0.6800293922424316
Epoch: 21, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.523 Vali Acc: 0.926 Test Loss: 0.523 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9261586666107178
Epoch: 22, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.484 Vali Acc: 0.907 Test Loss: 0.484 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0239322185516357
Epoch: 23, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.457 Vali Acc: 0.885 Test Loss: 0.457 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9185984134674072
Epoch: 24, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.414 Vali Acc: 0.907 Test Loss: 0.414 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8315389156341553
Epoch: 25, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.375 Vali Acc: 0.930 Test Loss: 0.375 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7768824100494385
Epoch: 26, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.343 Vali Acc: 0.930 Test Loss: 0.343 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0608010292053223
Epoch: 27, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7945282459259033
Epoch: 28, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.767648458480835
Epoch: 29, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8292429447174072
Epoch: 30, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 2010538
model size : 10.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6340208053588867
Epoch: 1, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.877 Vali Acc: 0.159 Test Loss: 1.877 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.8302123546600342
Epoch: 2, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.834 Vali Acc: 0.178 Test Loss: 1.834 Test Acc: 0.178
Validation loss decreased (-0.159240 --> -0.177759).  Saving model ...
Epoch: 3 cost time: 0.7032279968261719
Epoch: 3, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.786 Vali Acc: 0.196 Test Loss: 1.786 Test Acc: 0.196
Validation loss decreased (-0.177759 --> -0.196278).  Saving model ...
Epoch: 4 cost time: 0.7701330184936523
Epoch: 4, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.722 Vali Acc: 0.241 Test Loss: 1.722 Test Acc: 0.241
Validation loss decreased (-0.196278 --> -0.240724).  Saving model ...
Epoch: 5 cost time: 0.6992089748382568
Epoch: 5, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.664 Vali Acc: 0.370 Test Loss: 1.664 Test Acc: 0.370
Validation loss decreased (-0.240724 --> -0.370354).  Saving model ...
Epoch: 6 cost time: 0.7016041278839111
Epoch: 6, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.614 Vali Acc: 0.481 Test Loss: 1.614 Test Acc: 0.481
Validation loss decreased (-0.370354 --> -0.481465).  Saving model ...
Epoch: 7 cost time: 1.0991723537445068
Epoch: 7, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.560 Vali Acc: 0.474 Test Loss: 1.560 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7520251274108887
Epoch: 8, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.503 Vali Acc: 0.496 Test Loss: 1.503 Test Acc: 0.496
Validation loss decreased (-0.481465 --> -0.496281).  Saving model ...
Epoch: 9 cost time: 0.7893636226654053
Epoch: 9, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.424 Vali Acc: 0.626 Test Loss: 1.424 Test Acc: 0.626
Validation loss decreased (-0.496281 --> -0.625912).  Saving model ...
Epoch: 10 cost time: 0.786332368850708
Epoch: 10, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.335 Vali Acc: 0.722 Test Loss: 1.335 Test Acc: 0.722
Validation loss decreased (-0.625912 --> -0.722209).  Saving model ...
Epoch: 11 cost time: 0.8102929592132568
Epoch: 11, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.247 Vali Acc: 0.741 Test Loss: 1.247 Test Acc: 0.741
Validation loss decreased (-0.722209 --> -0.740728).  Saving model ...
Epoch: 12 cost time: 0.7401576042175293
Epoch: 12, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.162 Vali Acc: 0.741 Test Loss: 1.162 Test Acc: 0.741
Validation loss decreased (-0.740728 --> -0.740729).  Saving model ...
Epoch: 13 cost time: 0.7760155200958252
Epoch: 13, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.082 Vali Acc: 0.767 Test Loss: 1.082 Test Acc: 0.767
Validation loss decreased (-0.740729 --> -0.766656).  Saving model ...
Epoch: 14 cost time: 0.6790444850921631
Epoch: 14, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.001 Vali Acc: 0.789 Test Loss: 1.001 Test Acc: 0.789
Validation loss decreased (-0.766656 --> -0.788879).  Saving model ...
Epoch: 15 cost time: 0.9427087306976318
Epoch: 15, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.920 Vali Acc: 0.830 Test Loss: 0.920 Test Acc: 0.830
Validation loss decreased (-0.788879 --> -0.829620).  Saving model ...
Epoch: 16 cost time: 0.798635721206665
Epoch: 16, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.837 Vali Acc: 0.874 Test Loss: 0.837 Test Acc: 0.874
Validation loss decreased (-0.829620 --> -0.874066).  Saving model ...
Epoch: 17 cost time: 0.8667480945587158
Epoch: 17, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.763 Vali Acc: 0.881 Test Loss: 0.763 Test Acc: 0.881
Validation loss decreased (-0.874066 --> -0.881474).  Saving model ...
Epoch: 18 cost time: 0.9457406997680664
Epoch: 18, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.694 Vali Acc: 0.893 Test Loss: 0.694 Test Acc: 0.893
Validation loss decreased (-0.881474 --> -0.892586).  Saving model ...
Epoch: 19 cost time: 0.797917366027832
Epoch: 19, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.633 Vali Acc: 0.896 Test Loss: 0.633 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 20 cost time: 0.8545069694519043
Epoch: 20, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.572 Vali Acc: 0.919 Test Loss: 0.572 Test Acc: 0.919
Validation loss decreased (-0.896290 --> -0.918513).  Saving model ...
Epoch: 21 cost time: 0.822382926940918
Epoch: 21, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.520 Vali Acc: 0.919 Test Loss: 0.520 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 22 cost time: 0.9491226673126221
Epoch: 22, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.469 Vali Acc: 0.933 Test Loss: 0.469 Test Acc: 0.933
Validation loss decreased (-0.918513 --> -0.933329).  Saving model ...
Epoch: 23 cost time: 1.0232563018798828
Epoch: 23, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.425 Vali Acc: 0.937 Test Loss: 0.425 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 24 cost time: 0.9985575675964355
Epoch: 24, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.390 Vali Acc: 0.937 Test Loss: 0.390 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 25 cost time: 0.9023034572601318
Epoch: 25, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.363 Vali Acc: 0.930 Test Loss: 0.363 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0258431434631348
Epoch: 26, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.336 Vali Acc: 0.933 Test Loss: 0.336 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8553290367126465
Epoch: 27, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.311 Vali Acc: 0.937 Test Loss: 0.311 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 28 cost time: 0.9993553161621094
Epoch: 28, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8045320510864258
Epoch: 29, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9755649566650391
Epoch: 30, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8492310047149658
Epoch: 31, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9859678745269775
Epoch: 32, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.785161018371582
Epoch: 33, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9880352020263672
Epoch: 34, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9916782379150391
Epoch: 35, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.9272315502166748
Epoch: 36, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 1.0649018287658691
Epoch: 37, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.1592092514038086
Epoch: 38, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8709073066711426
Epoch: 39, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.9693217277526855
Epoch: 40, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8826491832733154
Epoch: 41, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.760704755783081
Epoch: 42, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.155947208404541
Epoch: 43, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6713387966156006
Epoch: 44, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8347506523132324
Epoch: 45, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8667287826538086
Epoch: 46, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 2009386
model size : 10.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.243927240371704
Epoch: 1, Steps: 2 | Train Loss: 2.042 Vali Loss: 1.881 Vali Acc: 0.200 Test Loss: 1.881 Test Acc: 0.200
Validation loss decreased (inf --> -0.199981).  Saving model ...
Epoch: 2 cost time: 0.8240218162536621
Epoch: 2, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.826 Vali Acc: 0.241 Test Loss: 1.826 Test Acc: 0.241
Validation loss decreased (-0.199981 --> -0.240722).  Saving model ...
Epoch: 3 cost time: 0.764941930770874
Epoch: 3, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.771 Vali Acc: 0.274 Test Loss: 1.771 Test Acc: 0.274
Validation loss decreased (-0.240722 --> -0.274056).  Saving model ...
Epoch: 4 cost time: 0.7629110813140869
Epoch: 4, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.706 Vali Acc: 0.256 Test Loss: 1.706 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7774431705474854
Epoch: 5, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.646 Vali Acc: 0.344 Test Loss: 1.646 Test Acc: 0.344
Validation loss decreased (-0.274056 --> -0.344428).  Saving model ...
Epoch: 6 cost time: 0.8165452480316162
Epoch: 6, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.594 Vali Acc: 0.389 Test Loss: 1.594 Test Acc: 0.389
Validation loss decreased (-0.344428 --> -0.388873).  Saving model ...
Epoch: 7 cost time: 0.8718409538269043
Epoch: 7, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.536 Vali Acc: 0.481 Test Loss: 1.536 Test Acc: 0.481
Validation loss decreased (-0.388873 --> -0.481466).  Saving model ...
Epoch: 8 cost time: 0.8920426368713379
Epoch: 8, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.473 Vali Acc: 0.585 Test Loss: 1.473 Test Acc: 0.585
Validation loss decreased (-0.481466 --> -0.585170).  Saving model ...
Epoch: 9 cost time: 0.8472259044647217
Epoch: 9, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.398 Vali Acc: 0.641 Test Loss: 1.398 Test Acc: 0.641
Validation loss decreased (-0.585170 --> -0.640727).  Saving model ...
Epoch: 10 cost time: 0.7899601459503174
Epoch: 10, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.314 Vali Acc: 0.689 Test Loss: 1.314 Test Acc: 0.689
Validation loss decreased (-0.640727 --> -0.688876).  Saving model ...
Epoch: 11 cost time: 0.7930731773376465
Epoch: 11, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.235 Vali Acc: 0.730 Test Loss: 1.235 Test Acc: 0.730
Validation loss decreased (-0.688876 --> -0.729617).  Saving model ...
Epoch: 12 cost time: 0.8286938667297363
Epoch: 12, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.158 Vali Acc: 0.770 Test Loss: 1.158 Test Acc: 0.770
Validation loss decreased (-0.729617 --> -0.770359).  Saving model ...
Epoch: 13 cost time: 0.8752350807189941
Epoch: 13, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.083 Vali Acc: 0.811 Test Loss: 1.083 Test Acc: 0.811
Validation loss decreased (-0.770359 --> -0.811100).  Saving model ...
Epoch: 14 cost time: 1.2149410247802734
Epoch: 14, Steps: 2 | Train Loss: 0.940 Vali Loss: 1.010 Vali Acc: 0.826 Test Loss: 1.010 Test Acc: 0.826
Validation loss decreased (-0.811100 --> -0.825916).  Saving model ...
Epoch: 15 cost time: 1.0009078979492188
Epoch: 15, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.938 Vali Acc: 0.841 Test Loss: 0.938 Test Acc: 0.841
Validation loss decreased (-0.825916 --> -0.840731).  Saving model ...
Epoch: 16 cost time: 0.9827322959899902
Epoch: 16, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.853 Vali Acc: 0.863 Test Loss: 0.853 Test Acc: 0.863
Validation loss decreased (-0.840731 --> -0.862954).  Saving model ...
Epoch: 17 cost time: 0.7102305889129639
Epoch: 17, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.771 Vali Acc: 0.878 Test Loss: 0.771 Test Acc: 0.878
Validation loss decreased (-0.862954 --> -0.877770).  Saving model ...
Epoch: 18 cost time: 0.8296422958374023
Epoch: 18, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.693 Vali Acc: 0.893 Test Loss: 0.693 Test Acc: 0.893
Validation loss decreased (-0.877770 --> -0.892586).  Saving model ...
Epoch: 19 cost time: 0.7491583824157715
Epoch: 19, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.626 Vali Acc: 0.900 Test Loss: 0.626 Test Acc: 0.900
Validation loss decreased (-0.892586 --> -0.899994).  Saving model ...
Epoch: 20 cost time: 0.9295516014099121
Epoch: 20, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.571 Vali Acc: 0.904 Test Loss: 0.571 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 21 cost time: 0.846625566482544
Epoch: 21, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.519 Vali Acc: 0.904 Test Loss: 0.519 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903699).  Saving model ...
Epoch: 22 cost time: 0.8091070652008057
Epoch: 22, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.477 Vali Acc: 0.907 Test Loss: 0.477 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 23 cost time: 1.067255973815918
Epoch: 23, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.435 Vali Acc: 0.926 Test Loss: 0.435 Test Acc: 0.926
Validation loss decreased (-0.907403 --> -0.925922).  Saving model ...
Epoch: 24 cost time: 0.9275574684143066
Epoch: 24, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.402 Vali Acc: 0.919 Test Loss: 0.402 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6773061752319336
Epoch: 25, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.372 Vali Acc: 0.922 Test Loss: 0.372 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9865729808807373
Epoch: 26, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.346 Vali Acc: 0.930 Test Loss: 0.346 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 27 cost time: 0.9803426265716553
Epoch: 27, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.325 Vali Acc: 0.926 Test Loss: 0.325 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0158870220184326
Epoch: 28, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7835984230041504
Epoch: 29, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9147312641143799
Epoch: 30, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.288 Vali Acc: 0.930 Test Loss: 0.288 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.9331479072570801
Epoch: 31, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8143613338470459
Epoch: 32, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 33 cost time: 0.8498313426971436
Epoch: 33, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.8573076725006104
Epoch: 34, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.6169910430908203
Epoch: 35, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.7712497711181641
Epoch: 36, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.8079969882965088
Epoch: 37, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.9738922119140625
Epoch: 38, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8542516231536865
Epoch: 39, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9582924842834473
Epoch: 40, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8796436786651611
Epoch: 41, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7316462993621826
Epoch: 42, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8059072494506836
Epoch: 43, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1717076301574707
Epoch: 44, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9455776214599609
Epoch: 45, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9111900329589844
Epoch: 46, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8841760158538818
Epoch: 47, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 2008234
model size : 10.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.448712110519409
Epoch: 1, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.810 Vali Acc: 0.126 Test Loss: 1.810 Test Acc: 0.126
Validation loss decreased (inf --> -0.125908).  Saving model ...
Epoch: 2 cost time: 0.8312921524047852
Epoch: 2, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.785 Vali Acc: 0.207 Test Loss: 1.785 Test Acc: 0.207
Validation loss decreased (-0.125908 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.8013832569122314
Epoch: 3, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.753 Vali Acc: 0.215 Test Loss: 1.753 Test Acc: 0.215
Validation loss decreased (-0.207390 --> -0.214797).  Saving model ...
Epoch: 4 cost time: 0.8486764430999756
Epoch: 4, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.704 Vali Acc: 0.248 Test Loss: 1.704 Test Acc: 0.248
Validation loss decreased (-0.214797 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 0.6874072551727295
Epoch: 5, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.650 Vali Acc: 0.296 Test Loss: 1.650 Test Acc: 0.296
Validation loss decreased (-0.248131 --> -0.296280).  Saving model ...
Epoch: 6 cost time: 0.8523378372192383
Epoch: 6, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.593 Vali Acc: 0.407 Test Loss: 1.593 Test Acc: 0.407
Validation loss decreased (-0.296280 --> -0.407391).  Saving model ...
Epoch: 7 cost time: 0.7475409507751465
Epoch: 7, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.533 Vali Acc: 0.463 Test Loss: 1.533 Test Acc: 0.463
Validation loss decreased (-0.407391 --> -0.462948).  Saving model ...
Epoch: 8 cost time: 1.0939648151397705
Epoch: 8, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.466 Vali Acc: 0.474 Test Loss: 1.466 Test Acc: 0.474
Validation loss decreased (-0.462948 --> -0.474059).  Saving model ...
Epoch: 9 cost time: 0.8572044372558594
Epoch: 9, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.391 Vali Acc: 0.556 Test Loss: 1.391 Test Acc: 0.556
Validation loss decreased (-0.474059 --> -0.555542).  Saving model ...
Epoch: 10 cost time: 0.869795560836792
Epoch: 10, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.306 Vali Acc: 0.615 Test Loss: 1.306 Test Acc: 0.615
Validation loss decreased (-0.555542 --> -0.614802).  Saving model ...
Epoch: 11 cost time: 0.8233916759490967
Epoch: 11, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.217 Vali Acc: 0.748 Test Loss: 1.217 Test Acc: 0.748
Validation loss decreased (-0.614802 --> -0.748136).  Saving model ...
Epoch: 12 cost time: 0.9314944744110107
Epoch: 12, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.131 Vali Acc: 0.804 Test Loss: 1.131 Test Acc: 0.804
Validation loss decreased (-0.748136 --> -0.803692).  Saving model ...
Epoch: 13 cost time: 0.7535824775695801
Epoch: 13, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.054 Vali Acc: 0.815 Test Loss: 1.054 Test Acc: 0.815
Validation loss decreased (-0.803692 --> -0.814804).  Saving model ...
Epoch: 14 cost time: 0.9900312423706055
Epoch: 14, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.976 Vali Acc: 0.830 Test Loss: 0.976 Test Acc: 0.830
Validation loss decreased (-0.814804 --> -0.829620).  Saving model ...
Epoch: 15 cost time: 0.9213588237762451
Epoch: 15, Steps: 2 | Train Loss: 0.783 Vali Loss: 0.898 Vali Acc: 0.833 Test Loss: 0.898 Test Acc: 0.833
Validation loss decreased (-0.829620 --> -0.833324).  Saving model ...
Epoch: 16 cost time: 0.9840400218963623
Epoch: 16, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.822 Vali Acc: 0.867 Test Loss: 0.822 Test Acc: 0.867
Validation loss decreased (-0.833324 --> -0.866658).  Saving model ...
Epoch: 17 cost time: 0.9558839797973633
Epoch: 17, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.750 Vali Acc: 0.896 Test Loss: 0.750 Test Acc: 0.896
Validation loss decreased (-0.866658 --> -0.896289).  Saving model ...
Epoch: 18 cost time: 0.9786782264709473
Epoch: 18, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.686 Vali Acc: 0.896 Test Loss: 0.686 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896289).  Saving model ...
Epoch: 19 cost time: 1.1791763305664062
Epoch: 19, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.626 Vali Acc: 0.881 Test Loss: 0.626 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8712685108184814
Epoch: 20, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.565 Vali Acc: 0.900 Test Loss: 0.565 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899994).  Saving model ...
Epoch: 21 cost time: 0.9299423694610596
Epoch: 21, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.509 Vali Acc: 0.896 Test Loss: 0.509 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8650031089782715
Epoch: 22, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.458 Vali Acc: 0.926 Test Loss: 0.458 Test Acc: 0.926
Validation loss decreased (-0.899994 --> -0.925921).  Saving model ...
Epoch: 23 cost time: 0.8733532428741455
Epoch: 23, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.419 Vali Acc: 0.926 Test Loss: 0.419 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 24 cost time: 0.7391481399536133
Epoch: 24, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.393 Vali Acc: 0.919 Test Loss: 0.393 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8732531070709229
Epoch: 25, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.367 Vali Acc: 0.911 Test Loss: 0.367 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9775922298431396
Epoch: 26, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.335 Vali Acc: 0.919 Test Loss: 0.335 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8692357540130615
Epoch: 27, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.315 Vali Acc: 0.930 Test Loss: 0.315 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 28 cost time: 0.7400453090667725
Epoch: 28, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.682581901550293
Epoch: 29, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8205866813659668
Epoch: 30, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8471462726593018
Epoch: 31, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 32 cost time: 0.8739533424377441
Epoch: 32, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 33 cost time: 0.7505173683166504
Epoch: 33, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.9704394340515137
Epoch: 34, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 35 cost time: 0.8830502033233643
Epoch: 35, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.919684886932373
Epoch: 36, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 37 cost time: 0.9506728649139404
Epoch: 37, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 38 cost time: 0.8540143966674805
Epoch: 38, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.857191801071167
Epoch: 39, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7677187919616699
Epoch: 40, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.7929060459136963
Epoch: 41, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.7378430366516113
Epoch: 42, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.8554773330688477
Epoch: 43, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 1.07631254196167
Epoch: 44, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.9193637371063232
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 46 cost time: 0.8031718730926514
Epoch: 46, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 1.2231292724609375
Epoch: 47, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 1.204786777496338
Epoch: 48, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.9391982555389404
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.8042588233947754
Epoch: 50, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 1.0279154777526855
Epoch: 51, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.8636143207550049
Epoch: 52, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.9797179698944092
Epoch: 53, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.1772947311401367
Epoch: 54, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.9313912391662598
Epoch: 55, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 2007082
model size : 10.21MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.817758083343506
Epoch: 1, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.907 Vali Acc: 0.170 Test Loss: 1.907 Test Acc: 0.170
Validation loss decreased (inf --> -0.170351).  Saving model ...
Epoch: 2 cost time: 0.9757587909698486
Epoch: 2, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.852 Vali Acc: 0.159 Test Loss: 1.852 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.029869794845581
Epoch: 3, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.806 Vali Acc: 0.156 Test Loss: 1.806 Test Acc: 0.156
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6896467208862305
Epoch: 4, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.753 Vali Acc: 0.252 Test Loss: 1.753 Test Acc: 0.252
Validation loss decreased (-0.170351 --> -0.251834).  Saving model ...
Epoch: 5 cost time: 0.7698147296905518
Epoch: 5, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.699 Vali Acc: 0.367 Test Loss: 1.699 Test Acc: 0.367
Validation loss decreased (-0.251834 --> -0.366650).  Saving model ...
Epoch: 6 cost time: 0.8968632221221924
Epoch: 6, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.652 Vali Acc: 0.411 Test Loss: 1.652 Test Acc: 0.411
Validation loss decreased (-0.366650 --> -0.411095).  Saving model ...
Epoch: 7 cost time: 0.566490650177002
Epoch: 7, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.603 Vali Acc: 0.444 Test Loss: 1.603 Test Acc: 0.444
Validation loss decreased (-0.411095 --> -0.444428).  Saving model ...
Epoch: 8 cost time: 0.7508962154388428
Epoch: 8, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.548 Vali Acc: 0.485 Test Loss: 1.548 Test Acc: 0.485
Validation loss decreased (-0.444428 --> -0.485170).  Saving model ...
Epoch: 9 cost time: 0.784015417098999
Epoch: 9, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.485 Vali Acc: 0.541 Test Loss: 1.485 Test Acc: 0.541
Validation loss decreased (-0.485170 --> -0.540726).  Saving model ...
Epoch: 10 cost time: 0.7966961860656738
Epoch: 10, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.418 Vali Acc: 0.596 Test Loss: 1.418 Test Acc: 0.596
Validation loss decreased (-0.540726 --> -0.596282).  Saving model ...
Epoch: 11 cost time: 0.7209863662719727
Epoch: 11, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.342 Vali Acc: 0.648 Test Loss: 1.342 Test Acc: 0.648
Validation loss decreased (-0.596282 --> -0.648135).  Saving model ...
Epoch: 12 cost time: 0.8437528610229492
Epoch: 12, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.263 Vali Acc: 0.681 Test Loss: 1.263 Test Acc: 0.681
Validation loss decreased (-0.648135 --> -0.681469).  Saving model ...
Epoch: 13 cost time: 0.8307132720947266
Epoch: 13, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.193 Vali Acc: 0.685 Test Loss: 1.193 Test Acc: 0.685
Validation loss decreased (-0.681469 --> -0.685173).  Saving model ...
Epoch: 14 cost time: 0.7771914005279541
Epoch: 14, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.126 Vali Acc: 0.696 Test Loss: 1.126 Test Acc: 0.696
Validation loss decreased (-0.685173 --> -0.696285).  Saving model ...
Epoch: 15 cost time: 0.9019687175750732
Epoch: 15, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.053 Vali Acc: 0.719 Test Loss: 1.053 Test Acc: 0.719
Validation loss decreased (-0.696285 --> -0.718508).  Saving model ...
Epoch: 16 cost time: 0.8742771148681641
Epoch: 16, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.980 Vali Acc: 0.774 Test Loss: 0.980 Test Acc: 0.774
Validation loss decreased (-0.718508 --> -0.774064).  Saving model ...
Epoch: 17 cost time: 0.9558422565460205
Epoch: 17, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.905 Vali Acc: 0.837 Test Loss: 0.905 Test Acc: 0.837
Validation loss decreased (-0.774064 --> -0.837028).  Saving model ...
Epoch: 18 cost time: 0.963512659072876
Epoch: 18, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.834 Vali Acc: 0.863 Test Loss: 0.834 Test Acc: 0.863
Validation loss decreased (-0.837028 --> -0.862955).  Saving model ...
Epoch: 19 cost time: 0.894381046295166
Epoch: 19, Steps: 2 | Train Loss: 0.652 Vali Loss: 0.771 Vali Acc: 0.896 Test Loss: 0.771 Test Acc: 0.896
Validation loss decreased (-0.862955 --> -0.896289).  Saving model ...
Epoch: 20 cost time: 0.7633848190307617
Epoch: 20, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.709 Vali Acc: 0.896 Test Loss: 0.709 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896289).  Saving model ...
Epoch: 21 cost time: 0.8775947093963623
Epoch: 21, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.646 Vali Acc: 0.900 Test Loss: 0.646 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.7598154544830322
Epoch: 22, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.585 Vali Acc: 0.900 Test Loss: 0.585 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.9516260623931885
Epoch: 23, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.533 Vali Acc: 0.915 Test Loss: 0.533 Test Acc: 0.915
Validation loss decreased (-0.899994 --> -0.914809).  Saving model ...
Epoch: 24 cost time: 0.9297549724578857
Epoch: 24, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.487 Vali Acc: 0.915 Test Loss: 0.487 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 25 cost time: 0.8031456470489502
Epoch: 25, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.447 Vali Acc: 0.922 Test Loss: 0.447 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 26 cost time: 0.9655890464782715
Epoch: 26, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.411 Vali Acc: 0.933 Test Loss: 0.411 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933329).  Saving model ...
Epoch: 27 cost time: 0.8120310306549072
Epoch: 27, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.384 Vali Acc: 0.926 Test Loss: 0.384 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7679619789123535
Epoch: 28, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 29 cost time: 0.8091282844543457
Epoch: 29, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 30 cost time: 0.8485288619995117
Epoch: 30, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.306 Vali Acc: 0.933 Test Loss: 0.306 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9308054447174072
Epoch: 31, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8612604141235352
Epoch: 32, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.281 Vali Acc: 0.926 Test Loss: 0.281 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8331117630004883
Epoch: 33, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8265929222106934
Epoch: 34, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.270 Vali Acc: 0.926 Test Loss: 0.270 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8967220783233643
Epoch: 35, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0054993629455566
Epoch: 36, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.8373777866363525
Epoch: 37, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8734650611877441
Epoch: 38, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.970923900604248
Epoch: 39, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 1681578
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4271459579467773
Epoch: 1, Steps: 2 | Train Loss: 2.020 Vali Loss: 2.058 Vali Acc: 0.093 Test Loss: 2.058 Test Acc: 0.093
Validation loss decreased (inf --> -0.092572).  Saving model ...
Epoch: 2 cost time: 0.8028566837310791
Epoch: 2, Steps: 2 | Train Loss: 2.011 Vali Loss: 2.011 Vali Acc: 0.074 Test Loss: 2.011 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8061561584472656
Epoch: 3, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.958 Vali Acc: 0.067 Test Loss: 1.958 Test Acc: 0.067
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0086398124694824
Epoch: 4, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.891 Vali Acc: 0.074 Test Loss: 1.891 Test Acc: 0.074
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7217881679534912
Epoch: 5, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.822 Vali Acc: 0.093 Test Loss: 1.822 Test Acc: 0.093
Validation loss decreased (-0.092572 --> -0.092574).  Saving model ...
Epoch: 6 cost time: 1.1823430061340332
Epoch: 6, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.760 Vali Acc: 0.174 Test Loss: 1.760 Test Acc: 0.174
Validation loss decreased (-0.092574 --> -0.174056).  Saving model ...
Epoch: 7 cost time: 0.7586181163787842
Epoch: 7, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.702 Vali Acc: 0.233 Test Loss: 1.702 Test Acc: 0.233
Validation loss decreased (-0.174056 --> -0.233316).  Saving model ...
Epoch: 8 cost time: 0.6892640590667725
Epoch: 8, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.645 Vali Acc: 0.311 Test Loss: 1.645 Test Acc: 0.311
Validation loss decreased (-0.233316 --> -0.311095).  Saving model ...
Epoch: 9 cost time: 0.871344804763794
Epoch: 9, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.577 Vali Acc: 0.411 Test Loss: 1.577 Test Acc: 0.411
Validation loss decreased (-0.311095 --> -0.411095).  Saving model ...
Epoch: 10 cost time: 0.8654341697692871
Epoch: 10, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.493 Vali Acc: 0.544 Test Loss: 1.493 Test Acc: 0.544
Validation loss decreased (-0.411095 --> -0.544430).  Saving model ...
Epoch: 11 cost time: 0.7762012481689453
Epoch: 11, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.403 Vali Acc: 0.667 Test Loss: 1.403 Test Acc: 0.667
Validation loss decreased (-0.544430 --> -0.666653).  Saving model ...
Epoch: 12 cost time: 0.7719378471374512
Epoch: 12, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.315 Vali Acc: 0.719 Test Loss: 1.315 Test Acc: 0.719
Validation loss decreased (-0.666653 --> -0.718505).  Saving model ...
Epoch: 13 cost time: 1.1367440223693848
Epoch: 13, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.233 Vali Acc: 0.748 Test Loss: 1.233 Test Acc: 0.748
Validation loss decreased (-0.718505 --> -0.748136).  Saving model ...
Epoch: 14 cost time: 1.2718160152435303
Epoch: 14, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.150 Vali Acc: 0.756 Test Loss: 1.150 Test Acc: 0.756
Validation loss decreased (-0.748136 --> -0.755544).  Saving model ...
Epoch: 15 cost time: 0.9763381481170654
Epoch: 15, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.066 Vali Acc: 0.793 Test Loss: 1.066 Test Acc: 0.793
Validation loss decreased (-0.755544 --> -0.792582).  Saving model ...
Epoch: 16 cost time: 0.9075729846954346
Epoch: 16, Steps: 2 | Train Loss: 0.901 Vali Loss: 0.983 Vali Acc: 0.833 Test Loss: 0.983 Test Acc: 0.833
Validation loss decreased (-0.792582 --> -0.833323).  Saving model ...
Epoch: 17 cost time: 0.8381774425506592
Epoch: 17, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.905 Vali Acc: 0.874 Test Loss: 0.905 Test Acc: 0.874
Validation loss decreased (-0.833323 --> -0.874065).  Saving model ...
Epoch: 18 cost time: 0.7496042251586914
Epoch: 18, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.828 Vali Acc: 0.896 Test Loss: 0.828 Test Acc: 0.896
Validation loss decreased (-0.874065 --> -0.896288).  Saving model ...
Epoch: 19 cost time: 0.8489787578582764
Epoch: 19, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.755 Vali Acc: 0.915 Test Loss: 0.755 Test Acc: 0.915
Validation loss decreased (-0.896288 --> -0.914807).  Saving model ...
Epoch: 20 cost time: 0.7147178649902344
Epoch: 20, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.686 Vali Acc: 0.922 Test Loss: 0.686 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922215).  Saving model ...
Epoch: 21 cost time: 0.8464443683624268
Epoch: 21, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.622 Vali Acc: 0.911 Test Loss: 0.622 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9508717060089111
Epoch: 22, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.562 Vali Acc: 0.907 Test Loss: 0.562 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.074023962020874
Epoch: 23, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.512 Vali Acc: 0.911 Test Loss: 0.512 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8872127532958984
Epoch: 24, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.466 Vali Acc: 0.922 Test Loss: 0.466 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922218).  Saving model ...
Epoch: 25 cost time: 0.8370950222015381
Epoch: 25, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.424 Vali Acc: 0.933 Test Loss: 0.424 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933329).  Saving model ...
Epoch: 26 cost time: 0.9742708206176758
Epoch: 26, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.383 Vali Acc: 0.937 Test Loss: 0.383 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 27 cost time: 0.8548338413238525
Epoch: 27, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.348 Vali Acc: 0.952 Test Loss: 0.348 Test Acc: 0.952
Validation loss decreased (-0.937033 --> -0.951848).  Saving model ...
Epoch: 28 cost time: 0.7640781402587891
Epoch: 28, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9195041656494141
Epoch: 29, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.9782676696777344
Epoch: 30, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.285 Vali Acc: 0.937 Test Loss: 0.285 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9113311767578125
Epoch: 31, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.0117449760437012
Epoch: 32, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8029861450195312
Epoch: 33, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8350429534912109
Epoch: 34, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8817422389984131
Epoch: 35, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.1204631328582764
Epoch: 36, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8867146968841553
Epoch: 37, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1680426
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.831209182739258
Epoch: 1, Steps: 2 | Train Loss: 1.966 Vali Loss: 1.897 Vali Acc: 0.111 Test Loss: 1.897 Test Acc: 0.111
Validation loss decreased (inf --> -0.111092).  Saving model ...
Epoch: 2 cost time: 0.6466565132141113
Epoch: 2, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.860 Vali Acc: 0.111 Test Loss: 1.860 Test Acc: 0.111
Validation loss decreased (-0.111092 --> -0.111093).  Saving model ...
Epoch: 3 cost time: 0.6321516036987305
Epoch: 3, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.822 Vali Acc: 0.089 Test Loss: 1.822 Test Acc: 0.089
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8335096836090088
Epoch: 4, Steps: 2 | Train Loss: 1.817 Vali Loss: 1.774 Vali Acc: 0.130 Test Loss: 1.774 Test Acc: 0.130
Validation loss decreased (-0.111093 --> -0.129612).  Saving model ...
Epoch: 5 cost time: 0.684133768081665
Epoch: 5, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.724 Vali Acc: 0.296 Test Loss: 1.724 Test Acc: 0.296
Validation loss decreased (-0.129612 --> -0.296279).  Saving model ...
Epoch: 6 cost time: 0.6310243606567383
Epoch: 6, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.675 Vali Acc: 0.344 Test Loss: 1.675 Test Acc: 0.344
Validation loss decreased (-0.296279 --> -0.344428).  Saving model ...
Epoch: 7 cost time: 0.6950864791870117
Epoch: 7, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.626 Vali Acc: 0.393 Test Loss: 1.626 Test Acc: 0.393
Validation loss decreased (-0.344428 --> -0.392576).  Saving model ...
Epoch: 8 cost time: 0.7161538600921631
Epoch: 8, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.566 Vali Acc: 0.474 Test Loss: 1.566 Test Acc: 0.474
Validation loss decreased (-0.392576 --> -0.474058).  Saving model ...
Epoch: 9 cost time: 0.8040897846221924
Epoch: 9, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.496 Vali Acc: 0.511 Test Loss: 1.496 Test Acc: 0.511
Validation loss decreased (-0.474058 --> -0.511096).  Saving model ...
Epoch: 10 cost time: 0.8355436325073242
Epoch: 10, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.424 Vali Acc: 0.563 Test Loss: 1.424 Test Acc: 0.563
Validation loss decreased (-0.511096 --> -0.562949).  Saving model ...
Epoch: 11 cost time: 0.8116922378540039
Epoch: 11, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.346 Vali Acc: 0.681 Test Loss: 1.346 Test Acc: 0.681
Validation loss decreased (-0.562949 --> -0.681468).  Saving model ...
Epoch: 12 cost time: 0.8758301734924316
Epoch: 12, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.271 Vali Acc: 0.748 Test Loss: 1.271 Test Acc: 0.748
Validation loss decreased (-0.681468 --> -0.748135).  Saving model ...
Epoch: 13 cost time: 0.7502090930938721
Epoch: 13, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.200 Vali Acc: 0.774 Test Loss: 1.200 Test Acc: 0.774
Validation loss decreased (-0.748135 --> -0.774062).  Saving model ...
Epoch: 14 cost time: 0.8749978542327881
Epoch: 14, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.127 Vali Acc: 0.789 Test Loss: 1.127 Test Acc: 0.789
Validation loss decreased (-0.774062 --> -0.788878).  Saving model ...
Epoch: 15 cost time: 0.6433279514312744
Epoch: 15, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.052 Vali Acc: 0.819 Test Loss: 1.052 Test Acc: 0.819
Validation loss decreased (-0.788878 --> -0.818508).  Saving model ...
Epoch: 16 cost time: 0.7950632572174072
Epoch: 16, Steps: 2 | Train Loss: 0.864 Vali Loss: 0.975 Vali Acc: 0.867 Test Loss: 0.975 Test Acc: 0.867
Validation loss decreased (-0.818508 --> -0.866657).  Saving model ...
Epoch: 17 cost time: 0.6866447925567627
Epoch: 17, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.898 Vali Acc: 0.889 Test Loss: 0.898 Test Acc: 0.889
Validation loss decreased (-0.866657 --> -0.888880).  Saving model ...
Epoch: 18 cost time: 0.7263822555541992
Epoch: 18, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.827 Vali Acc: 0.889 Test Loss: 0.827 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888881).  Saving model ...
Epoch: 19 cost time: 0.8759298324584961
Epoch: 19, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.762 Vali Acc: 0.904 Test Loss: 0.762 Test Acc: 0.904
Validation loss decreased (-0.888881 --> -0.903696).  Saving model ...
Epoch: 20 cost time: 0.8249945640563965
Epoch: 20, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.696 Vali Acc: 0.907 Test Loss: 0.696 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 21 cost time: 0.7817907333374023
Epoch: 21, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.634 Vali Acc: 0.904 Test Loss: 0.634 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8142695426940918
Epoch: 22, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.578 Vali Acc: 0.911 Test Loss: 0.578 Test Acc: 0.911
Validation loss decreased (-0.907400 --> -0.911105).  Saving model ...
Epoch: 23 cost time: 0.8751568794250488
Epoch: 23, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.521 Vali Acc: 0.930 Test Loss: 0.521 Test Acc: 0.930
Validation loss decreased (-0.911105 --> -0.929624).  Saving model ...
Epoch: 24 cost time: 0.7587757110595703
Epoch: 24, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.480 Vali Acc: 0.922 Test Loss: 0.480 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7999846935272217
Epoch: 25, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.440 Vali Acc: 0.915 Test Loss: 0.440 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7751009464263916
Epoch: 26, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.404 Vali Acc: 0.926 Test Loss: 0.404 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6835649013519287
Epoch: 27, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.367 Vali Acc: 0.922 Test Loss: 0.367 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7908616065979004
Epoch: 28, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.338 Vali Acc: 0.937 Test Loss: 0.338 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937034).  Saving model ...
Epoch: 29 cost time: 0.8519899845123291
Epoch: 29, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8862030506134033
Epoch: 30, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.298 Vali Acc: 0.937 Test Loss: 0.298 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.8583409786224365
Epoch: 31, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.8743176460266113
Epoch: 32, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 33 cost time: 0.9615767002105713
Epoch: 33, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 34 cost time: 0.8632924556732178
Epoch: 34, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.7875986099243164
Epoch: 35, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6953775882720947
Epoch: 36, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0916757583618164
Epoch: 37, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.9916427135467529
Epoch: 38, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.7487013339996338
Epoch: 39, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.9966466426849365
Epoch: 40, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.9051074981689453
Epoch: 41, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.6845364570617676
Epoch: 42, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.8552892208099365
Epoch: 43, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.8889260292053223
Epoch: 44, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.878392219543457
Epoch: 45, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 1.026947021484375
Epoch: 46, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8178684711456299
Epoch: 47, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.8981850147247314
Epoch: 48, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.887930154800415
Epoch: 49, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.8188128471374512
Epoch: 50, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.9527294635772705
Epoch: 51, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.6777234077453613
Epoch: 52, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.7436878681182861
Epoch: 53, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 1679274
model size : 8.96MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.14487886428833
Epoch: 1, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.806 Vali Acc: 0.156 Test Loss: 1.806 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 0.9499578475952148
Epoch: 2, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.772 Vali Acc: 0.200 Test Loss: 1.772 Test Acc: 0.200
Validation loss decreased (-0.155537 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.764087438583374
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.736 Vali Acc: 0.281 Test Loss: 1.736 Test Acc: 0.281
Validation loss decreased (-0.199982 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.8064873218536377
Epoch: 4, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.689 Vali Acc: 0.307 Test Loss: 1.689 Test Acc: 0.307
Validation loss decreased (-0.281464 --> -0.307391).  Saving model ...
Epoch: 5 cost time: 0.7205965518951416
Epoch: 5, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.636 Vali Acc: 0.356 Test Loss: 1.636 Test Acc: 0.356
Validation loss decreased (-0.307391 --> -0.355539).  Saving model ...
Epoch: 6 cost time: 0.7031941413879395
Epoch: 6, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.579 Vali Acc: 0.530 Test Loss: 1.579 Test Acc: 0.530
Validation loss decreased (-0.355539 --> -0.529614).  Saving model ...
Epoch: 7 cost time: 0.7589831352233887
Epoch: 7, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.524 Vali Acc: 0.604 Test Loss: 1.524 Test Acc: 0.604
Validation loss decreased (-0.529614 --> -0.603688).  Saving model ...
Epoch: 8 cost time: 0.8151226043701172
Epoch: 8, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.467 Vali Acc: 0.593 Test Loss: 1.467 Test Acc: 0.593
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7744975090026855
Epoch: 9, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.402 Vali Acc: 0.607 Test Loss: 1.402 Test Acc: 0.607
Validation loss decreased (-0.603688 --> -0.607393).  Saving model ...
Epoch: 10 cost time: 0.8458070755004883
Epoch: 10, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.334 Vali Acc: 0.622 Test Loss: 1.334 Test Acc: 0.622
Validation loss decreased (-0.607393 --> -0.622209).  Saving model ...
Epoch: 11 cost time: 0.7545957565307617
Epoch: 11, Steps: 2 | Train Loss: 1.246 Vali Loss: 1.251 Vali Acc: 0.715 Test Loss: 1.251 Test Acc: 0.715
Validation loss decreased (-0.622209 --> -0.714802).  Saving model ...
Epoch: 12 cost time: 0.939967155456543
Epoch: 12, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.165 Vali Acc: 0.852 Test Loss: 1.165 Test Acc: 0.852
Validation loss decreased (-0.714802 --> -0.851840).  Saving model ...
Epoch: 13 cost time: 1.031815528869629
Epoch: 13, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.080 Vali Acc: 0.900 Test Loss: 1.080 Test Acc: 0.900
Validation loss decreased (-0.851840 --> -0.899989).  Saving model ...
Epoch: 14 cost time: 0.7555868625640869
Epoch: 14, Steps: 2 | Train Loss: 0.981 Vali Loss: 0.997 Vali Acc: 0.896 Test Loss: 0.997 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6753177642822266
Epoch: 15, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.918 Vali Acc: 0.915 Test Loss: 0.918 Test Acc: 0.915
Validation loss decreased (-0.899989 --> -0.914806).  Saving model ...
Epoch: 16 cost time: 0.8901364803314209
Epoch: 16, Steps: 2 | Train Loss: 0.833 Vali Loss: 0.843 Vali Acc: 0.911 Test Loss: 0.843 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8644721508026123
Epoch: 17, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.770 Vali Acc: 0.904 Test Loss: 0.770 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7856931686401367
Epoch: 18, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.701 Vali Acc: 0.922 Test Loss: 0.701 Test Acc: 0.922
Validation loss decreased (-0.914806 --> -0.922215).  Saving model ...
Epoch: 19 cost time: 0.6636185646057129
Epoch: 19, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.642 Vali Acc: 0.926 Test Loss: 0.642 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925920).  Saving model ...
Epoch: 20 cost time: 0.8364415168762207
Epoch: 20, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.586 Vali Acc: 0.937 Test Loss: 0.586 Test Acc: 0.937
Validation loss decreased (-0.925920 --> -0.937031).  Saving model ...
Epoch: 21 cost time: 0.8277668952941895
Epoch: 21, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.532 Vali Acc: 0.941 Test Loss: 0.532 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 22 cost time: 0.7412135601043701
Epoch: 22, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.483 Vali Acc: 0.944 Test Loss: 0.483 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944440).  Saving model ...
Epoch: 23 cost time: 0.8191056251525879
Epoch: 23, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.439 Vali Acc: 0.944 Test Loss: 0.439 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 24 cost time: 0.7740716934204102
Epoch: 24, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.404 Vali Acc: 0.944 Test Loss: 0.404 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 25 cost time: 0.6486847400665283
Epoch: 25, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.370 Vali Acc: 0.944 Test Loss: 0.370 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 26 cost time: 0.6457729339599609
Epoch: 26, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.341 Vali Acc: 0.941 Test Loss: 0.341 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7354192733764648
Epoch: 27, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.318 Vali Acc: 0.941 Test Loss: 0.318 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7030072212219238
Epoch: 28, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7230629920959473
Epoch: 29, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 30 cost time: 0.6673753261566162
Epoch: 30, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0469861030578613
Epoch: 31, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7831254005432129
Epoch: 32, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8355724811553955
Epoch: 33, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7853810787200928
Epoch: 34, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7355108261108398
Epoch: 35, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6727921962738037
Epoch: 36, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6666035652160645
Epoch: 37, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.8318686485290527
Epoch: 38, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7719275951385498
Epoch: 39, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1678122
model size : 8.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.716275930404663
Epoch: 1, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.819 Vali Acc: 0.181 Test Loss: 1.819 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.7212727069854736
Epoch: 2, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.791 Vali Acc: 0.226 Test Loss: 1.791 Test Acc: 0.226
Validation loss decreased (-0.181463 --> -0.225908).  Saving model ...
Epoch: 3 cost time: 0.8079605102539062
Epoch: 3, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.764 Vali Acc: 0.256 Test Loss: 1.764 Test Acc: 0.256
Validation loss decreased (-0.225908 --> -0.255538).  Saving model ...
Epoch: 4 cost time: 0.8379182815551758
Epoch: 4, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.726 Vali Acc: 0.300 Test Loss: 1.726 Test Acc: 0.300
Validation loss decreased (-0.255538 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 0.8924670219421387
Epoch: 5, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.681 Vali Acc: 0.459 Test Loss: 1.681 Test Acc: 0.459
Validation loss decreased (-0.299983 --> -0.459242).  Saving model ...
Epoch: 6 cost time: 0.7102372646331787
Epoch: 6, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.633 Vali Acc: 0.478 Test Loss: 1.633 Test Acc: 0.478
Validation loss decreased (-0.459242 --> -0.477761).  Saving model ...
Epoch: 7 cost time: 0.7784085273742676
Epoch: 7, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.582 Vali Acc: 0.459 Test Loss: 1.582 Test Acc: 0.459
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8550434112548828
Epoch: 8, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.528 Vali Acc: 0.496 Test Loss: 1.528 Test Acc: 0.496
Validation loss decreased (-0.477761 --> -0.496281).  Saving model ...
Epoch: 9 cost time: 0.7861707210540771
Epoch: 9, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.467 Vali Acc: 0.533 Test Loss: 1.467 Test Acc: 0.533
Validation loss decreased (-0.496281 --> -0.533319).  Saving model ...
Epoch: 10 cost time: 0.7997539043426514
Epoch: 10, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.401 Vali Acc: 0.626 Test Loss: 1.401 Test Acc: 0.626
Validation loss decreased (-0.533319 --> -0.625912).  Saving model ...
Epoch: 11 cost time: 0.8267855644226074
Epoch: 11, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.335 Vali Acc: 0.711 Test Loss: 1.335 Test Acc: 0.711
Validation loss decreased (-0.625912 --> -0.711098).  Saving model ...
Epoch: 12 cost time: 0.8156864643096924
Epoch: 12, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.266 Vali Acc: 0.767 Test Loss: 1.266 Test Acc: 0.767
Validation loss decreased (-0.711098 --> -0.766654).  Saving model ...
Epoch: 13 cost time: 0.7146093845367432
Epoch: 13, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.193 Vali Acc: 0.793 Test Loss: 1.193 Test Acc: 0.793
Validation loss decreased (-0.766654 --> -0.792581).  Saving model ...
Epoch: 14 cost time: 1.0248448848724365
Epoch: 14, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.121 Vali Acc: 0.841 Test Loss: 1.121 Test Acc: 0.841
Validation loss decreased (-0.792581 --> -0.840730).  Saving model ...
Epoch: 15 cost time: 1.0005056858062744
Epoch: 15, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.051 Vali Acc: 0.863 Test Loss: 1.051 Test Acc: 0.863
Validation loss decreased (-0.840730 --> -0.862952).  Saving model ...
Epoch: 16 cost time: 0.8452448844909668
Epoch: 16, Steps: 2 | Train Loss: 0.957 Vali Loss: 0.982 Vali Acc: 0.870 Test Loss: 0.982 Test Acc: 0.870
Validation loss decreased (-0.862952 --> -0.870361).  Saving model ...
Epoch: 17 cost time: 0.9540591239929199
Epoch: 17, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.916 Vali Acc: 0.878 Test Loss: 0.916 Test Acc: 0.878
Validation loss decreased (-0.870361 --> -0.877769).  Saving model ...
Epoch: 18 cost time: 0.6852412223815918
Epoch: 18, Steps: 2 | Train Loss: 0.812 Vali Loss: 0.850 Vali Acc: 0.900 Test Loss: 0.850 Test Acc: 0.900
Validation loss decreased (-0.877769 --> -0.899992).  Saving model ...
Epoch: 19 cost time: 0.7816758155822754
Epoch: 19, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.783 Vali Acc: 0.915 Test Loss: 0.783 Test Acc: 0.915
Validation loss decreased (-0.899992 --> -0.914807).  Saving model ...
Epoch: 20 cost time: 0.8544182777404785
Epoch: 20, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.718 Vali Acc: 0.922 Test Loss: 0.718 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922215).  Saving model ...
Epoch: 21 cost time: 0.7919912338256836
Epoch: 21, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.655 Vali Acc: 0.926 Test Loss: 0.655 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 22 cost time: 0.6828532218933105
Epoch: 22, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.600 Vali Acc: 0.937 Test Loss: 0.600 Test Acc: 0.937
Validation loss decreased (-0.925919 --> -0.937031).  Saving model ...
Epoch: 23 cost time: 0.840651273727417
Epoch: 23, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.547 Vali Acc: 0.941 Test Loss: 0.547 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 24 cost time: 0.7095947265625
Epoch: 24, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.507 Vali Acc: 0.919 Test Loss: 0.507 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7387959957122803
Epoch: 25, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.464 Vali Acc: 0.941 Test Loss: 0.464 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 26 cost time: 0.8203520774841309
Epoch: 26, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.427 Vali Acc: 0.941 Test Loss: 0.427 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 27 cost time: 0.7354724407196045
Epoch: 27, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.393 Vali Acc: 0.941 Test Loss: 0.393 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 28 cost time: 0.6825735569000244
Epoch: 28, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.366 Vali Acc: 0.933 Test Loss: 0.366 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6967887878417969
Epoch: 29, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.347 Vali Acc: 0.930 Test Loss: 0.347 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6990489959716797
Epoch: 30, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.331 Vali Acc: 0.922 Test Loss: 0.331 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7429125308990479
Epoch: 31, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.794872522354126
Epoch: 32, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.291 Vali Acc: 0.930 Test Loss: 0.291 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7848711013793945
Epoch: 33, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.759937047958374
Epoch: 34, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.9648241996765137
Epoch: 35, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.7925419807434082
Epoch: 36, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.8216211795806885
Epoch: 37, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0179882049560547
Epoch: 38, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8466508388519287
Epoch: 39, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.8820452690124512
Epoch: 40, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6805224418640137
Epoch: 41, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7579851150512695
Epoch: 42, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8980503082275391
Epoch: 43, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8742520809173584
Epoch: 44, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.144500494003296
Epoch: 45, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.8719730377197266
Epoch: 46, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1517098
model size : 8.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8542561531066895
Epoch: 1, Steps: 2 | Train Loss: 2.060 Vali Loss: 1.926 Vali Acc: 0.167 Test Loss: 1.926 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.6923427581787109
Epoch: 2, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.855 Vali Acc: 0.196 Test Loss: 1.855 Test Acc: 0.196
Validation loss decreased (-0.166647 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.6971113681793213
Epoch: 3, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.797 Vali Acc: 0.319 Test Loss: 1.797 Test Acc: 0.319
Validation loss decreased (-0.196278 --> -0.318501).  Saving model ...
Epoch: 4 cost time: 0.7809629440307617
Epoch: 4, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.730 Vali Acc: 0.337 Test Loss: 1.730 Test Acc: 0.337
Validation loss decreased (-0.318501 --> -0.337020).  Saving model ...
Epoch: 5 cost time: 0.7176706790924072
Epoch: 5, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.666 Vali Acc: 0.370 Test Loss: 1.666 Test Acc: 0.370
Validation loss decreased (-0.337020 --> -0.370354).  Saving model ...
Epoch: 6 cost time: 0.8033044338226318
Epoch: 6, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.612 Vali Acc: 0.485 Test Loss: 1.612 Test Acc: 0.485
Validation loss decreased (-0.370354 --> -0.485169).  Saving model ...
Epoch: 7 cost time: 0.7974936962127686
Epoch: 7, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.564 Vali Acc: 0.485 Test Loss: 1.564 Test Acc: 0.485
Validation loss decreased (-0.485169 --> -0.485170).  Saving model ...
Epoch: 8 cost time: 0.818657636642456
Epoch: 8, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.519 Vali Acc: 0.515 Test Loss: 1.519 Test Acc: 0.515
Validation loss decreased (-0.485170 --> -0.514800).  Saving model ...
Epoch: 9 cost time: 0.73081374168396
Epoch: 9, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.460 Vali Acc: 0.637 Test Loss: 1.460 Test Acc: 0.637
Validation loss decreased (-0.514800 --> -0.637022).  Saving model ...
Epoch: 10 cost time: 0.9272313117980957
Epoch: 10, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.387 Vali Acc: 0.700 Test Loss: 1.387 Test Acc: 0.700
Validation loss decreased (-0.637022 --> -0.699986).  Saving model ...
Epoch: 11 cost time: 0.7632005214691162
Epoch: 11, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.304 Vali Acc: 0.730 Test Loss: 1.304 Test Acc: 0.730
Validation loss decreased (-0.699986 --> -0.729617).  Saving model ...
Epoch: 12 cost time: 1.0912463665008545
Epoch: 12, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.219 Vali Acc: 0.830 Test Loss: 1.219 Test Acc: 0.830
Validation loss decreased (-0.729617 --> -0.829617).  Saving model ...
Epoch: 13 cost time: 0.860173225402832
Epoch: 13, Steps: 2 | Train Loss: 1.108 Vali Loss: 1.138 Vali Acc: 0.841 Test Loss: 1.138 Test Acc: 0.841
Validation loss decreased (-0.829617 --> -0.840729).  Saving model ...
Epoch: 14 cost time: 1.0929369926452637
Epoch: 14, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.065 Vali Acc: 0.863 Test Loss: 1.065 Test Acc: 0.863
Validation loss decreased (-0.840729 --> -0.862952).  Saving model ...
Epoch: 15 cost time: 1.199089765548706
Epoch: 15, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.001 Vali Acc: 0.822 Test Loss: 1.001 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8941590785980225
Epoch: 16, Steps: 2 | Train Loss: 0.904 Vali Loss: 0.936 Vali Acc: 0.822 Test Loss: 0.936 Test Acc: 0.822
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0827720165252686
Epoch: 17, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.863 Vali Acc: 0.867 Test Loss: 0.863 Test Acc: 0.867
Validation loss decreased (-0.862952 --> -0.866658).  Saving model ...
Epoch: 18 cost time: 0.7113823890686035
Epoch: 18, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.790 Vali Acc: 0.907 Test Loss: 0.790 Test Acc: 0.907
Validation loss decreased (-0.866658 --> -0.907400).  Saving model ...
Epoch: 19 cost time: 0.9630570411682129
Epoch: 19, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.725 Vali Acc: 0.926 Test Loss: 0.725 Test Acc: 0.926
Validation loss decreased (-0.907400 --> -0.925919).  Saving model ...
Epoch: 20 cost time: 0.6840040683746338
Epoch: 20, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.669 Vali Acc: 0.933 Test Loss: 0.669 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933327).  Saving model ...
Epoch: 21 cost time: 1.030041217803955
Epoch: 21, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.616 Vali Acc: 0.930 Test Loss: 0.616 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7708010673522949
Epoch: 22, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.560 Vali Acc: 0.937 Test Loss: 0.560 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937031).  Saving model ...
Epoch: 23 cost time: 0.7512948513031006
Epoch: 23, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.506 Vali Acc: 0.952 Test Loss: 0.506 Test Acc: 0.952
Validation loss decreased (-0.937031 --> -0.951847).  Saving model ...
Epoch: 24 cost time: 0.7918822765350342
Epoch: 24, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.467 Vali Acc: 0.944 Test Loss: 0.467 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.683748722076416
Epoch: 25, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.431 Vali Acc: 0.948 Test Loss: 0.431 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9119901657104492
Epoch: 26, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.396 Vali Acc: 0.948 Test Loss: 0.396 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0585458278656006
Epoch: 27, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.367 Vali Acc: 0.956 Test Loss: 0.367 Test Acc: 0.956
Validation loss decreased (-0.951847 --> -0.955552).  Saving model ...
Epoch: 28 cost time: 0.8642826080322266
Epoch: 28, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.339 Vali Acc: 0.956 Test Loss: 0.339 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 29 cost time: 0.9793186187744141
Epoch: 29, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.319 Vali Acc: 0.959 Test Loss: 0.319 Test Acc: 0.959
Validation loss decreased (-0.955552 --> -0.959256).  Saving model ...
Epoch: 30 cost time: 0.9617810249328613
Epoch: 30, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.299 Vali Acc: 0.959 Test Loss: 0.299 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 31 cost time: 0.6933329105377197
Epoch: 31, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.282 Vali Acc: 0.956 Test Loss: 0.282 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8874619007110596
Epoch: 32, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.268 Vali Acc: 0.956 Test Loss: 0.268 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8885226249694824
Epoch: 33, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.255 Vali Acc: 0.952 Test Loss: 0.255 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8741154670715332
Epoch: 34, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8034968376159668
Epoch: 35, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.237 Vali Acc: 0.952 Test Loss: 0.237 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8423070907592773
Epoch: 36, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.229 Vali Acc: 0.952 Test Loss: 0.229 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7580671310424805
Epoch: 37, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.703129768371582
Epoch: 38, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8602988719940186
Epoch: 39, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7255291938781738
Epoch: 40, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 1515946
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.704402208328247
Epoch: 1, Steps: 2 | Train Loss: 1.925 Vali Loss: 1.870 Vali Acc: 0.178 Test Loss: 1.870 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.7695643901824951
Epoch: 2, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.823 Vali Acc: 0.204 Test Loss: 1.823 Test Acc: 0.204
Validation loss decreased (-0.177759 --> -0.203685).  Saving model ...
Epoch: 3 cost time: 0.7280640602111816
Epoch: 3, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.777 Vali Acc: 0.233 Test Loss: 1.777 Test Acc: 0.233
Validation loss decreased (-0.203685 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 0.794684886932373
Epoch: 4, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.719 Vali Acc: 0.311 Test Loss: 1.719 Test Acc: 0.311
Validation loss decreased (-0.233316 --> -0.311094).  Saving model ...
Epoch: 5 cost time: 1.097524881362915
Epoch: 5, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.662 Vali Acc: 0.393 Test Loss: 1.662 Test Acc: 0.393
Validation loss decreased (-0.311094 --> -0.392576).  Saving model ...
Epoch: 6 cost time: 0.8021214008331299
Epoch: 6, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.609 Vali Acc: 0.452 Test Loss: 1.609 Test Acc: 0.452
Validation loss decreased (-0.392576 --> -0.451836).  Saving model ...
Epoch: 7 cost time: 0.7150588035583496
Epoch: 7, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.561 Vali Acc: 0.433 Test Loss: 1.561 Test Acc: 0.433
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7680020332336426
Epoch: 8, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.512 Vali Acc: 0.444 Test Loss: 1.512 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7725434303283691
Epoch: 9, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.460 Vali Acc: 0.459 Test Loss: 1.460 Test Acc: 0.459
Validation loss decreased (-0.451836 --> -0.459245).  Saving model ...
Epoch: 10 cost time: 0.782447338104248
Epoch: 10, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.394 Vali Acc: 0.541 Test Loss: 1.394 Test Acc: 0.541
Validation loss decreased (-0.459245 --> -0.540727).  Saving model ...
Epoch: 11 cost time: 0.8176524639129639
Epoch: 11, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.319 Vali Acc: 0.678 Test Loss: 1.319 Test Acc: 0.678
Validation loss decreased (-0.540727 --> -0.677765).  Saving model ...
Epoch: 12 cost time: 0.6609587669372559
Epoch: 12, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.245 Vali Acc: 0.770 Test Loss: 1.245 Test Acc: 0.770
Validation loss decreased (-0.677765 --> -0.770358).  Saving model ...
Epoch: 13 cost time: 0.8856253623962402
Epoch: 13, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.171 Vali Acc: 0.822 Test Loss: 1.171 Test Acc: 0.822
Validation loss decreased (-0.770358 --> -0.822211).  Saving model ...
Epoch: 14 cost time: 0.8357367515563965
Epoch: 14, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.103 Vali Acc: 0.804 Test Loss: 1.103 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8404648303985596
Epoch: 15, Steps: 2 | Train Loss: 0.982 Vali Loss: 1.033 Vali Acc: 0.811 Test Loss: 1.033 Test Acc: 0.811
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7707741260528564
Epoch: 16, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.964 Vali Acc: 0.807 Test Loss: 0.964 Test Acc: 0.807
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.653416633605957
Epoch: 17, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.892 Vali Acc: 0.819 Test Loss: 0.892 Test Acc: 0.819
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7856009006500244
Epoch: 18, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.822 Vali Acc: 0.870 Test Loss: 0.822 Test Acc: 0.870
Validation loss decreased (-0.822211 --> -0.870362).  Saving model ...
Epoch: 19 cost time: 0.7705380916595459
Epoch: 19, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.756 Vali Acc: 0.885 Test Loss: 0.756 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885178).  Saving model ...
Epoch: 20 cost time: 0.7283670902252197
Epoch: 20, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.696 Vali Acc: 0.881 Test Loss: 0.696 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.868410587310791
Epoch: 21, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.636 Vali Acc: 0.893 Test Loss: 0.636 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 22 cost time: 0.8698785305023193
Epoch: 22, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.583 Vali Acc: 0.896 Test Loss: 0.583 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 23 cost time: 0.6616365909576416
Epoch: 23, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.532 Vali Acc: 0.919 Test Loss: 0.532 Test Acc: 0.919
Validation loss decreased (-0.896290 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 0.6336760520935059
Epoch: 24, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.485 Vali Acc: 0.930 Test Loss: 0.485 Test Acc: 0.930
Validation loss decreased (-0.918513 --> -0.929625).  Saving model ...
Epoch: 25 cost time: 0.9008359909057617
Epoch: 25, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.444 Vali Acc: 0.926 Test Loss: 0.444 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7505543231964111
Epoch: 26, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.411 Vali Acc: 0.911 Test Loss: 0.411 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7201213836669922
Epoch: 27, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.379 Vali Acc: 0.922 Test Loss: 0.379 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8395745754241943
Epoch: 28, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.352 Vali Acc: 0.926 Test Loss: 0.352 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.1681270599365234
Epoch: 29, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.8270401954650879
Epoch: 30, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.313 Vali Acc: 0.926 Test Loss: 0.313 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.826962947845459
Epoch: 31, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.299 Vali Acc: 0.922 Test Loss: 0.299 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7714924812316895
Epoch: 32, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.0221192836761475
Epoch: 33, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7059156894683838
Epoch: 34, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.263 Vali Acc: 0.926 Test Loss: 0.263 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 1514794
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2510430812835693
Epoch: 1, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.781 Vali Acc: 0.204 Test Loss: 1.781 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.8273682594299316
Epoch: 2, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.734 Vali Acc: 0.270 Test Loss: 1.734 Test Acc: 0.270
Validation loss decreased (-0.203686 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.8837003707885742
Epoch: 3, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.696 Vali Acc: 0.307 Test Loss: 1.696 Test Acc: 0.307
Validation loss decreased (-0.270353 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 0.7771701812744141
Epoch: 4, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.650 Vali Acc: 0.330 Test Loss: 1.650 Test Acc: 0.330
Validation loss decreased (-0.307390 --> -0.329613).  Saving model ...
Epoch: 5 cost time: 0.8780856132507324
Epoch: 5, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.602 Vali Acc: 0.519 Test Loss: 1.602 Test Acc: 0.519
Validation loss decreased (-0.329613 --> -0.518502).  Saving model ...
Epoch: 6 cost time: 0.8392531871795654
Epoch: 6, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.556 Vali Acc: 0.507 Test Loss: 1.556 Test Acc: 0.507
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7701952457427979
Epoch: 7, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.509 Vali Acc: 0.496 Test Loss: 1.509 Test Acc: 0.496
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9010272026062012
Epoch: 8, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.459 Vali Acc: 0.511 Test Loss: 1.459 Test Acc: 0.511
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2544965744018555
Epoch: 9, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.400 Vali Acc: 0.570 Test Loss: 1.400 Test Acc: 0.570
Validation loss decreased (-0.518502 --> -0.570356).  Saving model ...
Epoch: 10 cost time: 0.7769341468811035
Epoch: 10, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.331 Vali Acc: 0.659 Test Loss: 1.331 Test Acc: 0.659
Validation loss decreased (-0.570356 --> -0.659246).  Saving model ...
Epoch: 11 cost time: 0.6538205146789551
Epoch: 11, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.261 Vali Acc: 0.770 Test Loss: 1.261 Test Acc: 0.770
Validation loss decreased (-0.659246 --> -0.770358).  Saving model ...
Epoch: 12 cost time: 0.7442135810852051
Epoch: 12, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.190 Vali Acc: 0.763 Test Loss: 1.190 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7622218132019043
Epoch: 13, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.116 Vali Acc: 0.793 Test Loss: 1.116 Test Acc: 0.793
Validation loss decreased (-0.770358 --> -0.792581).  Saving model ...
Epoch: 14 cost time: 0.6951773166656494
Epoch: 14, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.044 Vali Acc: 0.811 Test Loss: 1.044 Test Acc: 0.811
Validation loss decreased (-0.792581 --> -0.811101).  Saving model ...
Epoch: 15 cost time: 0.8259732723236084
Epoch: 15, Steps: 2 | Train Loss: 0.967 Vali Loss: 0.971 Vali Acc: 0.859 Test Loss: 0.971 Test Acc: 0.859
Validation loss decreased (-0.811101 --> -0.859250).  Saving model ...
Epoch: 16 cost time: 0.9652812480926514
Epoch: 16, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.898 Vali Acc: 0.907 Test Loss: 0.898 Test Acc: 0.907
Validation loss decreased (-0.859250 --> -0.907398).  Saving model ...
Epoch: 17 cost time: 0.8198590278625488
Epoch: 17, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.826 Vali Acc: 0.919 Test Loss: 0.826 Test Acc: 0.919
Validation loss decreased (-0.907398 --> -0.918510).  Saving model ...
Epoch: 18 cost time: 0.778740644454956
Epoch: 18, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.761 Vali Acc: 0.907 Test Loss: 0.761 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7407841682434082
Epoch: 19, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.698 Vali Acc: 0.922 Test Loss: 0.698 Test Acc: 0.922
Validation loss decreased (-0.918510 --> -0.922215).  Saving model ...
Epoch: 20 cost time: 0.6714234352111816
Epoch: 20, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.641 Vali Acc: 0.915 Test Loss: 0.641 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8008508682250977
Epoch: 21, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.589 Vali Acc: 0.919 Test Loss: 0.589 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7620031833648682
Epoch: 22, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.546 Vali Acc: 0.900 Test Loss: 0.546 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9703912734985352
Epoch: 23, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.508 Vali Acc: 0.893 Test Loss: 0.508 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9267964363098145
Epoch: 24, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.463 Vali Acc: 0.915 Test Loss: 0.463 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7859172821044922
Epoch: 25, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.419 Vali Acc: 0.926 Test Loss: 0.419 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925922).  Saving model ...
Epoch: 26 cost time: 0.8899767398834229
Epoch: 26, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.384 Vali Acc: 0.937 Test Loss: 0.384 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937033).  Saving model ...
Epoch: 27 cost time: 0.778580904006958
Epoch: 27, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.354 Vali Acc: 0.944 Test Loss: 0.354 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944441).  Saving model ...
Epoch: 28 cost time: 0.9288539886474609
Epoch: 28, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7200160026550293
Epoch: 29, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8662083148956299
Epoch: 30, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8477296829223633
Epoch: 31, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.279 Vali Acc: 0.922 Test Loss: 0.279 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7475852966308594
Epoch: 32, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7585902214050293
Epoch: 33, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.661851167678833
Epoch: 34, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8929245471954346
Epoch: 35, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9335174560546875
Epoch: 36, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.7866959571838379
Epoch: 37, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1513642
model size : 8.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.620912790298462
Epoch: 1, Steps: 2 | Train Loss: 2.038 Vali Loss: 1.971 Vali Acc: 0.130 Test Loss: 1.971 Test Acc: 0.130
Validation loss decreased (inf --> -0.129610).  Saving model ...
Epoch: 2 cost time: 0.8717520236968994
Epoch: 2, Steps: 2 | Train Loss: 1.968 Vali Loss: 1.939 Vali Acc: 0.111 Test Loss: 1.939 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8938944339752197
Epoch: 3, Steps: 2 | Train Loss: 1.968 Vali Loss: 1.907 Vali Acc: 0.111 Test Loss: 1.907 Test Acc: 0.111
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9170148372650146
Epoch: 4, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.860 Vali Acc: 0.122 Test Loss: 1.860 Test Acc: 0.122
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.8079690933227539
Epoch: 5, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.810 Vali Acc: 0.148 Test Loss: 1.810 Test Acc: 0.148
Validation loss decreased (-0.129610 --> -0.148130).  Saving model ...
Epoch: 6 cost time: 0.8255341053009033
Epoch: 6, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.761 Vali Acc: 0.200 Test Loss: 1.761 Test Acc: 0.200
Validation loss decreased (-0.148130 --> -0.199982).  Saving model ...
Epoch: 7 cost time: 1.0452089309692383
Epoch: 7, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.715 Vali Acc: 0.304 Test Loss: 1.715 Test Acc: 0.304
Validation loss decreased (-0.199982 --> -0.303687).  Saving model ...
Epoch: 8 cost time: 0.7210578918457031
Epoch: 8, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.668 Vali Acc: 0.385 Test Loss: 1.668 Test Acc: 0.385
Validation loss decreased (-0.303687 --> -0.385169).  Saving model ...
Epoch: 9 cost time: 0.8893566131591797
Epoch: 9, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.617 Vali Acc: 0.437 Test Loss: 1.617 Test Acc: 0.437
Validation loss decreased (-0.385169 --> -0.437021).  Saving model ...
Epoch: 10 cost time: 0.980445146560669
Epoch: 10, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.559 Vali Acc: 0.474 Test Loss: 1.559 Test Acc: 0.474
Validation loss decreased (-0.437021 --> -0.474058).  Saving model ...
Epoch: 11 cost time: 0.8415820598602295
Epoch: 11, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.495 Vali Acc: 0.537 Test Loss: 1.495 Test Acc: 0.537
Validation loss decreased (-0.474058 --> -0.537022).  Saving model ...
Epoch: 12 cost time: 0.878248929977417
Epoch: 12, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.428 Vali Acc: 0.604 Test Loss: 1.428 Test Acc: 0.604
Validation loss decreased (-0.537022 --> -0.603689).  Saving model ...
Epoch: 13 cost time: 0.9853990077972412
Epoch: 13, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.362 Vali Acc: 0.685 Test Loss: 1.362 Test Acc: 0.685
Validation loss decreased (-0.603689 --> -0.685172).  Saving model ...
Epoch: 14 cost time: 0.8836104869842529
Epoch: 14, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.295 Vali Acc: 0.733 Test Loss: 1.295 Test Acc: 0.733
Validation loss decreased (-0.685172 --> -0.733320).  Saving model ...
Epoch: 15 cost time: 0.9121081829071045
Epoch: 15, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.227 Vali Acc: 0.759 Test Loss: 1.227 Test Acc: 0.759
Validation loss decreased (-0.733320 --> -0.759247).  Saving model ...
Epoch: 16 cost time: 0.8602676391601562
Epoch: 16, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.158 Vali Acc: 0.781 Test Loss: 1.158 Test Acc: 0.781
Validation loss decreased (-0.759247 --> -0.781470).  Saving model ...
Epoch: 17 cost time: 0.966865062713623
Epoch: 17, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.087 Vali Acc: 0.804 Test Loss: 1.087 Test Acc: 0.804
Validation loss decreased (-0.781470 --> -0.803693).  Saving model ...
Epoch: 18 cost time: 0.949575662612915
Epoch: 18, Steps: 2 | Train Loss: 0.950 Vali Loss: 1.013 Vali Acc: 0.830 Test Loss: 1.013 Test Acc: 0.830
Validation loss decreased (-0.803693 --> -0.829619).  Saving model ...
Epoch: 19 cost time: 0.9084608554840088
Epoch: 19, Steps: 2 | Train Loss: 0.941 Vali Loss: 0.938 Vali Acc: 0.859 Test Loss: 0.938 Test Acc: 0.859
Validation loss decreased (-0.829619 --> -0.859250).  Saving model ...
Epoch: 20 cost time: 0.8438470363616943
Epoch: 20, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.869 Vali Acc: 0.870 Test Loss: 0.869 Test Acc: 0.870
Validation loss decreased (-0.859250 --> -0.870362).  Saving model ...
Epoch: 21 cost time: 0.8034505844116211
Epoch: 21, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.806 Vali Acc: 0.859 Test Loss: 0.806 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9096424579620361
Epoch: 22, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.748 Vali Acc: 0.889 Test Loss: 0.748 Test Acc: 0.889
Validation loss decreased (-0.870362 --> -0.888881).  Saving model ...
Epoch: 23 cost time: 0.8507471084594727
Epoch: 23, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.700 Vali Acc: 0.889 Test Loss: 0.700 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888882).  Saving model ...
Epoch: 24 cost time: 0.8098342418670654
Epoch: 24, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.649 Vali Acc: 0.911 Test Loss: 0.649 Test Acc: 0.911
Validation loss decreased (-0.888882 --> -0.911105).  Saving model ...
Epoch: 25 cost time: 0.7138714790344238
Epoch: 25, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.599 Vali Acc: 0.937 Test Loss: 0.599 Test Acc: 0.937
Validation loss decreased (-0.911105 --> -0.937031).  Saving model ...
Epoch: 26 cost time: 0.8284497261047363
Epoch: 26, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.556 Vali Acc: 0.956 Test Loss: 0.556 Test Acc: 0.956
Validation loss decreased (-0.937031 --> -0.955550).  Saving model ...
Epoch: 27 cost time: 0.8327529430389404
Epoch: 27, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.520 Vali Acc: 0.959 Test Loss: 0.520 Test Acc: 0.959
Validation loss decreased (-0.955550 --> -0.959254).  Saving model ...
Epoch: 28 cost time: 1.0148439407348633
Epoch: 28, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.488 Vali Acc: 0.956 Test Loss: 0.488 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8790402412414551
Epoch: 29, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.458 Vali Acc: 0.956 Test Loss: 0.458 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8653302192687988
Epoch: 30, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.431 Vali Acc: 0.952 Test Loss: 0.431 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8188498020172119
Epoch: 31, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.408 Vali Acc: 0.952 Test Loss: 0.408 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.865933895111084
Epoch: 32, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.391 Vali Acc: 0.944 Test Loss: 0.391 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8949661254882812
Epoch: 33, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.375 Vali Acc: 0.944 Test Loss: 0.375 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.776890754699707
Epoch: 34, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.364 Vali Acc: 0.937 Test Loss: 0.364 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7880842685699463
Epoch: 35, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.343 Vali Acc: 0.944 Test Loss: 0.343 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8177177906036377
Epoch: 36, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.321 Vali Acc: 0.956 Test Loss: 0.321 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8145761489868164
Epoch: 37, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.305 Vali Acc: 0.959 Test Loss: 0.305 Test Acc: 0.959
Validation loss decreased (-0.959254 --> -0.959256).  Saving model ...
Epoch: 38 cost time: 0.6046433448791504
Epoch: 38, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.291 Vali Acc: 0.963 Test Loss: 0.291 Test Acc: 0.963
Validation loss decreased (-0.959256 --> -0.962960).  Saving model ...
Epoch: 39 cost time: 0.7184884548187256
Epoch: 39, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.280 Vali Acc: 0.963 Test Loss: 0.280 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 40 cost time: 0.6263108253479004
Epoch: 40, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.271 Vali Acc: 0.963 Test Loss: 0.271 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 41 cost time: 0.770052433013916
Epoch: 41, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.263 Vali Acc: 0.963 Test Loss: 0.263 Test Acc: 0.963
Validation loss decreased (-0.962960 --> -0.962960).  Saving model ...
Epoch: 42 cost time: 0.6842212677001953
Epoch: 42, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.258 Vali Acc: 0.967 Test Loss: 0.258 Test Acc: 0.967
Validation loss decreased (-0.962960 --> -0.966664).  Saving model ...
Epoch: 43 cost time: 0.8127148151397705
Epoch: 43, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.255 Vali Acc: 0.963 Test Loss: 0.255 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9542343616485596
Epoch: 44, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.252 Vali Acc: 0.959 Test Loss: 0.252 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8162403106689453
Epoch: 45, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.245 Vali Acc: 0.963 Test Loss: 0.245 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8272595405578613
Epoch: 46, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.236 Vali Acc: 0.967 Test Loss: 0.236 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 47 cost time: 0.8121280670166016
Epoch: 47, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.229 Vali Acc: 0.967 Test Loss: 0.229 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 48 cost time: 0.8611454963684082
Epoch: 48, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.224 Vali Acc: 0.967 Test Loss: 0.224 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 49 cost time: 0.7320644855499268
Epoch: 49, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.220 Vali Acc: 0.967 Test Loss: 0.220 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 50 cost time: 1.0552434921264648
Epoch: 50, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.220 Vali Acc: 0.967 Test Loss: 0.220 Test Acc: 0.967
Validation loss decreased (-0.966664 --> -0.966664).  Saving model ...
Epoch: 51 cost time: 0.8386828899383545
Epoch: 51, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.219 Vali Acc: 0.970 Test Loss: 0.219 Test Acc: 0.970
Validation loss decreased (-0.966664 --> -0.970368).  Saving model ...
Epoch: 52 cost time: 0.8508810997009277
Epoch: 52, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.216 Vali Acc: 0.970 Test Loss: 0.216 Test Acc: 0.970
Validation loss decreased (-0.970368 --> -0.970368).  Saving model ...
Epoch: 53 cost time: 0.8408610820770264
Epoch: 53, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.214 Vali Acc: 0.967 Test Loss: 0.214 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.877577543258667
Epoch: 54, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.967 Test Loss: 0.211 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.9418299198150635
Epoch: 55, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.208 Vali Acc: 0.967 Test Loss: 0.208 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.8851420879364014
Epoch: 56, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.205 Vali Acc: 0.967 Test Loss: 0.205 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.0791370868682861
Epoch: 57, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.0093419551849365
Epoch: 58, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.195 Vali Acc: 0.967 Test Loss: 0.195 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.6765334606170654
Epoch: 59, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.7964298725128174
Epoch: 60, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 0.9099884033203125
Epoch: 61, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 0.9371511936187744
Epoch: 62, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.183 Vali Acc: 0.967 Test Loss: 0.183 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9703703703703703
model parameter : 1009130
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5058648586273193
Epoch: 1, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.779 Vali Acc: 0.244 Test Loss: 1.779 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.7711763381958008
Epoch: 2, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.759 Vali Acc: 0.252 Test Loss: 1.759 Test Acc: 0.252
Validation loss decreased (-0.244427 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.6252913475036621
Epoch: 3, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.737 Vali Acc: 0.252 Test Loss: 1.737 Test Acc: 0.252
Validation loss decreased (-0.251834 --> -0.251834).  Saving model ...
Epoch: 4 cost time: 0.7025470733642578
Epoch: 4, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.707 Vali Acc: 0.270 Test Loss: 1.707 Test Acc: 0.270
Validation loss decreased (-0.251834 --> -0.270353).  Saving model ...
Epoch: 5 cost time: 0.7274811267852783
Epoch: 5, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.671 Vali Acc: 0.330 Test Loss: 1.671 Test Acc: 0.330
Validation loss decreased (-0.270353 --> -0.329613).  Saving model ...
Epoch: 6 cost time: 0.7202816009521484
Epoch: 6, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.633 Vali Acc: 0.415 Test Loss: 1.633 Test Acc: 0.415
Validation loss decreased (-0.329613 --> -0.414798).  Saving model ...
Epoch: 7 cost time: 0.8278977870941162
Epoch: 7, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.591 Vali Acc: 0.463 Test Loss: 1.591 Test Acc: 0.463
Validation loss decreased (-0.414798 --> -0.462947).  Saving model ...
Epoch: 8 cost time: 0.7796714305877686
Epoch: 8, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.545 Vali Acc: 0.489 Test Loss: 1.545 Test Acc: 0.489
Validation loss decreased (-0.462947 --> -0.488873).  Saving model ...
Epoch: 9 cost time: 0.5986368656158447
Epoch: 9, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.492 Vali Acc: 0.526 Test Loss: 1.492 Test Acc: 0.526
Validation loss decreased (-0.488873 --> -0.525911).  Saving model ...
Epoch: 10 cost time: 0.6667628288269043
Epoch: 10, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.431 Vali Acc: 0.674 Test Loss: 1.431 Test Acc: 0.674
Validation loss decreased (-0.525911 --> -0.674060).  Saving model ...
Epoch: 11 cost time: 0.6841850280761719
Epoch: 11, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.366 Vali Acc: 0.719 Test Loss: 1.366 Test Acc: 0.719
Validation loss decreased (-0.674060 --> -0.718505).  Saving model ...
Epoch: 12 cost time: 0.5988364219665527
Epoch: 12, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.298 Vali Acc: 0.737 Test Loss: 1.298 Test Acc: 0.737
Validation loss decreased (-0.718505 --> -0.737024).  Saving model ...
Epoch: 13 cost time: 0.6127829551696777
Epoch: 13, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.229 Vali Acc: 0.778 Test Loss: 1.229 Test Acc: 0.778
Validation loss decreased (-0.737024 --> -0.777765).  Saving model ...
Epoch: 14 cost time: 0.5193090438842773
Epoch: 14, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.157 Vali Acc: 0.837 Test Loss: 1.157 Test Acc: 0.837
Validation loss decreased (-0.777765 --> -0.837025).  Saving model ...
Epoch: 15 cost time: 0.7858664989471436
Epoch: 15, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.084 Vali Acc: 0.844 Test Loss: 1.084 Test Acc: 0.844
Validation loss decreased (-0.837025 --> -0.844434).  Saving model ...
Epoch: 16 cost time: 0.6723322868347168
Epoch: 16, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.010 Vali Acc: 0.848 Test Loss: 1.010 Test Acc: 0.848
Validation loss decreased (-0.844434 --> -0.848138).  Saving model ...
Epoch: 17 cost time: 0.7856583595275879
Epoch: 17, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.937 Vali Acc: 0.878 Test Loss: 0.937 Test Acc: 0.878
Validation loss decreased (-0.848138 --> -0.877768).  Saving model ...
Epoch: 18 cost time: 0.5669310092926025
Epoch: 18, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.868 Vali Acc: 0.893 Test Loss: 0.868 Test Acc: 0.893
Validation loss decreased (-0.877768 --> -0.892584).  Saving model ...
Epoch: 19 cost time: 0.6108489036560059
Epoch: 19, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.806 Vali Acc: 0.900 Test Loss: 0.806 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 20 cost time: 0.6656835079193115
Epoch: 20, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.745 Vali Acc: 0.900 Test Loss: 0.745 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 21 cost time: 0.6350288391113281
Epoch: 21, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.691 Vali Acc: 0.911 Test Loss: 0.691 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.6214663982391357
Epoch: 22, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.640 Vali Acc: 0.922 Test Loss: 0.640 Test Acc: 0.922
Validation loss decreased (-0.911104 --> -0.922216).  Saving model ...
Epoch: 23 cost time: 0.7157242298126221
Epoch: 23, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.593 Vali Acc: 0.919 Test Loss: 0.593 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6196508407592773
Epoch: 24, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.551 Vali Acc: 0.922 Test Loss: 0.551 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.7644150257110596
Epoch: 25, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.514 Vali Acc: 0.922 Test Loss: 0.514 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 26 cost time: 0.6875896453857422
Epoch: 26, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.481 Vali Acc: 0.922 Test Loss: 0.481 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 27 cost time: 0.7888567447662354
Epoch: 27, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.453 Vali Acc: 0.926 Test Loss: 0.453 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 28 cost time: 0.7089931964874268
Epoch: 28, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.428 Vali Acc: 0.930 Test Loss: 0.428 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 29 cost time: 0.575056791305542
Epoch: 29, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.405 Vali Acc: 0.930 Test Loss: 0.405 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 30 cost time: 0.5917079448699951
Epoch: 30, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.385 Vali Acc: 0.930 Test Loss: 0.385 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 31 cost time: 0.8193676471710205
Epoch: 31, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.372 Vali Acc: 0.926 Test Loss: 0.372 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8376929759979248
Epoch: 32, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.358 Vali Acc: 0.922 Test Loss: 0.358 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6228408813476562
Epoch: 33, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7644832134246826
Epoch: 34, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.333 Vali Acc: 0.926 Test Loss: 0.333 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8327319622039795
Epoch: 35, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.321 Vali Acc: 0.941 Test Loss: 0.321 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.7274353504180908
Epoch: 36, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 37 cost time: 0.6729583740234375
Epoch: 37, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.304 Vali Acc: 0.944 Test Loss: 0.304 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.7758035659790039
Epoch: 38, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 39 cost time: 0.5986144542694092
Epoch: 39, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.5553202629089355
Epoch: 40, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.287 Vali Acc: 0.937 Test Loss: 0.287 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7196922302246094
Epoch: 41, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.285 Vali Acc: 0.937 Test Loss: 0.285 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.68985915184021
Epoch: 42, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7315940856933594
Epoch: 43, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7040274143218994
Epoch: 44, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7589206695556641
Epoch: 45, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7841107845306396
Epoch: 46, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.715273380279541
Epoch: 47, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9070878028869629
Epoch: 48, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7764120101928711
Epoch: 49, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1008554
model size : 5.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.901287794113159
Epoch: 1, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.897 Vali Acc: 0.141 Test Loss: 1.897 Test Acc: 0.141
Validation loss decreased (inf --> -0.140722).  Saving model ...
Epoch: 2 cost time: 1.1200225353240967
Epoch: 2, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.872 Vali Acc: 0.119 Test Loss: 1.872 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9543561935424805
Epoch: 3, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.843 Vali Acc: 0.122 Test Loss: 1.843 Test Acc: 0.122
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8320400714874268
Epoch: 4, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.802 Vali Acc: 0.119 Test Loss: 1.802 Test Acc: 0.119
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9513118267059326
Epoch: 5, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.752 Vali Acc: 0.174 Test Loss: 1.752 Test Acc: 0.174
Validation loss decreased (-0.140722 --> -0.174057).  Saving model ...
Epoch: 6 cost time: 0.6828007698059082
Epoch: 6, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.699 Vali Acc: 0.333 Test Loss: 1.699 Test Acc: 0.333
Validation loss decreased (-0.174057 --> -0.333316).  Saving model ...
Epoch: 7 cost time: 0.8243045806884766
Epoch: 7, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.644 Vali Acc: 0.459 Test Loss: 1.644 Test Acc: 0.459
Validation loss decreased (-0.333316 --> -0.459243).  Saving model ...
Epoch: 8 cost time: 0.9387407302856445
Epoch: 8, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.591 Vali Acc: 0.474 Test Loss: 1.591 Test Acc: 0.474
Validation loss decreased (-0.459243 --> -0.474058).  Saving model ...
Epoch: 9 cost time: 0.8267176151275635
Epoch: 9, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.537 Vali Acc: 0.544 Test Loss: 1.537 Test Acc: 0.544
Validation loss decreased (-0.474058 --> -0.544429).  Saving model ...
Epoch: 10 cost time: 0.6776978969573975
Epoch: 10, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.480 Vali Acc: 0.611 Test Loss: 1.480 Test Acc: 0.611
Validation loss decreased (-0.544429 --> -0.611096).  Saving model ...
Epoch: 11 cost time: 0.7585368156433105
Epoch: 11, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.421 Vali Acc: 0.626 Test Loss: 1.421 Test Acc: 0.626
Validation loss decreased (-0.611096 --> -0.625912).  Saving model ...
Epoch: 12 cost time: 0.7146985530853271
Epoch: 12, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.357 Vali Acc: 0.674 Test Loss: 1.357 Test Acc: 0.674
Validation loss decreased (-0.625912 --> -0.674061).  Saving model ...
Epoch: 13 cost time: 0.747765302658081
Epoch: 13, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.290 Vali Acc: 0.756 Test Loss: 1.290 Test Acc: 0.756
Validation loss decreased (-0.674061 --> -0.755543).  Saving model ...
Epoch: 14 cost time: 0.8312275409698486
Epoch: 14, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.222 Vali Acc: 0.804 Test Loss: 1.222 Test Acc: 0.804
Validation loss decreased (-0.755543 --> -0.803691).  Saving model ...
Epoch: 15 cost time: 0.7177867889404297
Epoch: 15, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.153 Vali Acc: 0.852 Test Loss: 1.153 Test Acc: 0.852
Validation loss decreased (-0.803691 --> -0.851840).  Saving model ...
Epoch: 16 cost time: 0.8094792366027832
Epoch: 16, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.083 Vali Acc: 0.870 Test Loss: 1.083 Test Acc: 0.870
Validation loss decreased (-0.851840 --> -0.870360).  Saving model ...
Epoch: 17 cost time: 0.6900713443756104
Epoch: 17, Steps: 2 | Train Loss: 0.949 Vali Loss: 1.012 Vali Acc: 0.867 Test Loss: 1.012 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.710383415222168
Epoch: 18, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.940 Vali Acc: 0.878 Test Loss: 0.940 Test Acc: 0.878
Validation loss decreased (-0.870360 --> -0.877768).  Saving model ...
Epoch: 19 cost time: 0.7323276996612549
Epoch: 19, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.872 Vali Acc: 0.889 Test Loss: 0.872 Test Acc: 0.889
Validation loss decreased (-0.877768 --> -0.888880).  Saving model ...
Epoch: 20 cost time: 0.6076357364654541
Epoch: 20, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.804 Vali Acc: 0.900 Test Loss: 0.804 Test Acc: 0.900
Validation loss decreased (-0.888880 --> -0.899992).  Saving model ...
Epoch: 21 cost time: 0.7164163589477539
Epoch: 21, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.741 Vali Acc: 0.911 Test Loss: 0.741 Test Acc: 0.911
Validation loss decreased (-0.899992 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.7651767730712891
Epoch: 22, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.681 Vali Acc: 0.922 Test Loss: 0.681 Test Acc: 0.922
Validation loss decreased (-0.911104 --> -0.922215).  Saving model ...
Epoch: 23 cost time: 0.8233771324157715
Epoch: 23, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.630 Vali Acc: 0.919 Test Loss: 0.630 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8331608772277832
Epoch: 24, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.583 Vali Acc: 0.933 Test Loss: 0.583 Test Acc: 0.933
Validation loss decreased (-0.922215 --> -0.933328).  Saving model ...
Epoch: 25 cost time: 0.7775223255157471
Epoch: 25, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.539 Vali Acc: 0.941 Test Loss: 0.539 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940735).  Saving model ...
Epoch: 26 cost time: 0.7195966243743896
Epoch: 26, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.501 Vali Acc: 0.941 Test Loss: 0.501 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 27 cost time: 0.6655178070068359
Epoch: 27, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.467 Vali Acc: 0.944 Test Loss: 0.467 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 28 cost time: 0.8889384269714355
Epoch: 28, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.438 Vali Acc: 0.952 Test Loss: 0.438 Test Acc: 0.952
Validation loss decreased (-0.944440 --> -0.951847).  Saving model ...
Epoch: 29 cost time: 0.898411750793457
Epoch: 29, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.416 Vali Acc: 0.941 Test Loss: 0.416 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7688350677490234
Epoch: 30, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.399 Vali Acc: 0.930 Test Loss: 0.399 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7135217189788818
Epoch: 31, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.379 Vali Acc: 0.933 Test Loss: 0.379 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8359694480895996
Epoch: 32, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.362 Vali Acc: 0.930 Test Loss: 0.362 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9602847099304199
Epoch: 33, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.346 Vali Acc: 0.930 Test Loss: 0.346 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9226412773132324
Epoch: 34, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.332 Vali Acc: 0.937 Test Loss: 0.332 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0111136436462402
Epoch: 35, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.318 Vali Acc: 0.941 Test Loss: 0.318 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8178057670593262
Epoch: 36, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.308 Vali Acc: 0.941 Test Loss: 0.308 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9228441715240479
Epoch: 37, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.2341578006744385
Epoch: 38, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.291 Vali Acc: 0.948 Test Loss: 0.291 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1007978
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7697999477386475
Epoch: 1, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.815 Vali Acc: 0.193 Test Loss: 1.815 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 1.027738094329834
Epoch: 2, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.795 Vali Acc: 0.200 Test Loss: 1.795 Test Acc: 0.200
Validation loss decreased (-0.192574 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.8468422889709473
Epoch: 3, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.771 Vali Acc: 0.211 Test Loss: 1.771 Test Acc: 0.211
Validation loss decreased (-0.199982 --> -0.211093).  Saving model ...
Epoch: 4 cost time: 0.6783051490783691
Epoch: 4, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.737 Vali Acc: 0.230 Test Loss: 1.737 Test Acc: 0.230
Validation loss decreased (-0.211093 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 1.0403943061828613
Epoch: 5, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.698 Vali Acc: 0.278 Test Loss: 1.698 Test Acc: 0.278
Validation loss decreased (-0.229612 --> -0.277761).  Saving model ...
Epoch: 6 cost time: 0.8182332515716553
Epoch: 6, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.655 Vali Acc: 0.337 Test Loss: 1.655 Test Acc: 0.337
Validation loss decreased (-0.277761 --> -0.337020).  Saving model ...
Epoch: 7 cost time: 1.0386829376220703
Epoch: 7, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.609 Vali Acc: 0.378 Test Loss: 1.609 Test Acc: 0.378
Validation loss decreased (-0.337020 --> -0.377762).  Saving model ...
Epoch: 8 cost time: 0.8957409858703613
Epoch: 8, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.562 Vali Acc: 0.430 Test Loss: 1.562 Test Acc: 0.430
Validation loss decreased (-0.377762 --> -0.429614).  Saving model ...
Epoch: 9 cost time: 0.8657922744750977
Epoch: 9, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.510 Vali Acc: 0.485 Test Loss: 1.510 Test Acc: 0.485
Validation loss decreased (-0.429614 --> -0.485170).  Saving model ...
Epoch: 10 cost time: 0.8726656436920166
Epoch: 10, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.456 Vali Acc: 0.574 Test Loss: 1.456 Test Acc: 0.574
Validation loss decreased (-0.485170 --> -0.574060).  Saving model ...
Epoch: 11 cost time: 0.8151354789733887
Epoch: 11, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.395 Vali Acc: 0.641 Test Loss: 1.395 Test Acc: 0.641
Validation loss decreased (-0.574060 --> -0.640727).  Saving model ...
Epoch: 12 cost time: 0.9529478549957275
Epoch: 12, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.334 Vali Acc: 0.674 Test Loss: 1.334 Test Acc: 0.674
Validation loss decreased (-0.640727 --> -0.674061).  Saving model ...
Epoch: 13 cost time: 0.754509687423706
Epoch: 13, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.269 Vali Acc: 0.748 Test Loss: 1.269 Test Acc: 0.748
Validation loss decreased (-0.674061 --> -0.748135).  Saving model ...
Epoch: 14 cost time: 0.8774054050445557
Epoch: 14, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.202 Vali Acc: 0.756 Test Loss: 1.202 Test Acc: 0.756
Validation loss decreased (-0.748135 --> -0.755544).  Saving model ...
Epoch: 15 cost time: 0.9036977291107178
Epoch: 15, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.139 Vali Acc: 0.807 Test Loss: 1.139 Test Acc: 0.807
Validation loss decreased (-0.755544 --> -0.807396).  Saving model ...
Epoch: 16 cost time: 0.76564621925354
Epoch: 16, Steps: 2 | Train Loss: 1.038 Vali Loss: 1.077 Vali Acc: 0.804 Test Loss: 1.077 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8719239234924316
Epoch: 17, Steps: 2 | Train Loss: 0.992 Vali Loss: 1.015 Vali Acc: 0.826 Test Loss: 1.015 Test Acc: 0.826
Validation loss decreased (-0.807396 --> -0.825916).  Saving model ...
Epoch: 18 cost time: 1.0542900562286377
Epoch: 18, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.953 Vali Acc: 0.852 Test Loss: 0.953 Test Acc: 0.852
Validation loss decreased (-0.825916 --> -0.851842).  Saving model ...
Epoch: 19 cost time: 0.767662763595581
Epoch: 19, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.890 Vali Acc: 0.856 Test Loss: 0.890 Test Acc: 0.856
Validation loss decreased (-0.851842 --> -0.855547).  Saving model ...
Epoch: 20 cost time: 0.75787353515625
Epoch: 20, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.827 Vali Acc: 0.863 Test Loss: 0.827 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862955).  Saving model ...
Epoch: 21 cost time: 0.7344820499420166
Epoch: 21, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.768 Vali Acc: 0.867 Test Loss: 0.768 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866659).  Saving model ...
Epoch: 22 cost time: 0.917372465133667
Epoch: 22, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.712 Vali Acc: 0.885 Test Loss: 0.712 Test Acc: 0.885
Validation loss decreased (-0.866659 --> -0.885178).  Saving model ...
Epoch: 23 cost time: 0.7497758865356445
Epoch: 23, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.661 Vali Acc: 0.896 Test Loss: 0.661 Test Acc: 0.896
Validation loss decreased (-0.885178 --> -0.896290).  Saving model ...
Epoch: 24 cost time: 0.7079339027404785
Epoch: 24, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.617 Vali Acc: 0.900 Test Loss: 0.617 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 25 cost time: 0.8526139259338379
Epoch: 25, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.576 Vali Acc: 0.896 Test Loss: 0.576 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8425624370574951
Epoch: 26, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.543 Vali Acc: 0.893 Test Loss: 0.543 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7153666019439697
Epoch: 27, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.513 Vali Acc: 0.885 Test Loss: 0.513 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8232762813568115
Epoch: 28, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.479 Vali Acc: 0.904 Test Loss: 0.479 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903699).  Saving model ...
Epoch: 29 cost time: 0.7922062873840332
Epoch: 29, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.450 Vali Acc: 0.907 Test Loss: 0.450 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 30 cost time: 0.8963677883148193
Epoch: 30, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.421 Vali Acc: 0.915 Test Loss: 0.421 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 31 cost time: 0.9462184906005859
Epoch: 31, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.396 Vali Acc: 0.922 Test Loss: 0.396 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922218).  Saving model ...
Epoch: 32 cost time: 0.7707538604736328
Epoch: 32, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.375 Vali Acc: 0.930 Test Loss: 0.375 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 33 cost time: 0.9877126216888428
Epoch: 33, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.358 Vali Acc: 0.930 Test Loss: 0.358 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 34 cost time: 0.9018707275390625
Epoch: 34, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.345 Vali Acc: 0.930 Test Loss: 0.345 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 35 cost time: 0.7847485542297363
Epoch: 35, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.337 Vali Acc: 0.930 Test Loss: 0.337 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 36 cost time: 0.7264506816864014
Epoch: 36, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.329 Vali Acc: 0.930 Test Loss: 0.329 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 37 cost time: 0.7324631214141846
Epoch: 37, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.325 Vali Acc: 0.919 Test Loss: 0.325 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0076379776000977
Epoch: 38, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.319 Vali Acc: 0.915 Test Loss: 0.319 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8903300762176514
Epoch: 39, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.312 Vali Acc: 0.915 Test Loss: 0.312 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7764472961425781
Epoch: 40, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.299 Vali Acc: 0.922 Test Loss: 0.299 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.807243824005127
Epoch: 41, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 42 cost time: 0.7817397117614746
Epoch: 42, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.8015220165252686
Epoch: 43, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.8627479076385498
Epoch: 44, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.8488404750823975
Epoch: 45, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.9038774967193604
Epoch: 46, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7308666706085205
Epoch: 47, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.8288254737854004
Epoch: 48, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0082025527954102
Epoch: 49, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 1.1448664665222168
Epoch: 50, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.9084749221801758
Epoch: 51, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.8537828922271729
Epoch: 52, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.246 Vali Acc: 0.926 Test Loss: 0.246 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.7570607662200928
Epoch: 53, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.8645198345184326
Epoch: 54, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 55 cost time: 0.7808706760406494
Epoch: 55, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.8448715209960938
Epoch: 56, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.7443335056304932
Epoch: 57, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.8052823543548584
Epoch: 58, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 1.0934627056121826
Epoch: 59, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.8071718215942383
Epoch: 60, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.9092462062835693
Epoch: 61, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.7455880641937256
Epoch: 62, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 63 cost time: 0.7352097034454346
Epoch: 63, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 0.7656040191650391
Epoch: 64, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.9023454189300537
Epoch: 65, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 1.0784213542938232
Epoch: 66, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.6833136081695557
Epoch: 67, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.8457894325256348
Epoch: 68, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.7830512523651123
Epoch: 69, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.7435405254364014
Epoch: 70, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.8150920867919922
Epoch: 71, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.8617749214172363
Epoch: 72, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.999840259552002
Epoch: 73, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1007402
model size : 5.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.835141658782959
Epoch: 1, Steps: 2 | Train Loss: 1.881 Vali Loss: 1.934 Vali Acc: 0.174 Test Loss: 1.934 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 0.7297346591949463
Epoch: 2, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.897 Vali Acc: 0.159 Test Loss: 1.897 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7341046333312988
Epoch: 3, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.867 Vali Acc: 0.152 Test Loss: 1.867 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.917640209197998
Epoch: 4, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.830 Vali Acc: 0.148 Test Loss: 1.830 Test Acc: 0.148
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9026174545288086
Epoch: 5, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.787 Vali Acc: 0.181 Test Loss: 1.787 Test Acc: 0.181
Validation loss decreased (-0.174055 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.7451233863830566
Epoch: 6, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.742 Vali Acc: 0.181 Test Loss: 1.742 Test Acc: 0.181
Validation loss decreased (-0.181464 --> -0.181464).  Saving model ...
Epoch: 7 cost time: 0.8742682933807373
Epoch: 7, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.699 Vali Acc: 0.326 Test Loss: 1.699 Test Acc: 0.326
Validation loss decreased (-0.181464 --> -0.325909).  Saving model ...
Epoch: 8 cost time: 0.7865457534790039
Epoch: 8, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.655 Vali Acc: 0.404 Test Loss: 1.655 Test Acc: 0.404
Validation loss decreased (-0.325909 --> -0.403687).  Saving model ...
Epoch: 9 cost time: 0.7083492279052734
Epoch: 9, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.612 Vali Acc: 0.452 Test Loss: 1.612 Test Acc: 0.452
Validation loss decreased (-0.403687 --> -0.451836).  Saving model ...
Epoch: 10 cost time: 0.8208863735198975
Epoch: 10, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.569 Vali Acc: 0.507 Test Loss: 1.569 Test Acc: 0.507
Validation loss decreased (-0.451836 --> -0.507392).  Saving model ...
Epoch: 11 cost time: 0.6491239070892334
Epoch: 11, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.524 Vali Acc: 0.544 Test Loss: 1.524 Test Acc: 0.544
Validation loss decreased (-0.507392 --> -0.544429).  Saving model ...
Epoch: 12 cost time: 0.8548340797424316
Epoch: 12, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.474 Vali Acc: 0.611 Test Loss: 1.474 Test Acc: 0.611
Validation loss decreased (-0.544429 --> -0.611096).  Saving model ...
Epoch: 13 cost time: 0.9076645374298096
Epoch: 13, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.421 Vali Acc: 0.648 Test Loss: 1.421 Test Acc: 0.648
Validation loss decreased (-0.611096 --> -0.648134).  Saving model ...
Epoch: 14 cost time: 0.8992016315460205
Epoch: 14, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.364 Vali Acc: 0.722 Test Loss: 1.364 Test Acc: 0.722
Validation loss decreased (-0.648134 --> -0.722209).  Saving model ...
Epoch: 15 cost time: 0.7828629016876221
Epoch: 15, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.304 Vali Acc: 0.759 Test Loss: 1.304 Test Acc: 0.759
Validation loss decreased (-0.722209 --> -0.759246).  Saving model ...
Epoch: 16 cost time: 0.7331540584564209
Epoch: 16, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.241 Vali Acc: 0.796 Test Loss: 1.241 Test Acc: 0.796
Validation loss decreased (-0.759246 --> -0.796284).  Saving model ...
Epoch: 17 cost time: 0.7779233455657959
Epoch: 17, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.177 Vali Acc: 0.811 Test Loss: 1.177 Test Acc: 0.811
Validation loss decreased (-0.796284 --> -0.811099).  Saving model ...
Epoch: 18 cost time: 0.9599823951721191
Epoch: 18, Steps: 2 | Train Loss: 1.139 Vali Loss: 1.115 Vali Acc: 0.826 Test Loss: 1.115 Test Acc: 0.826
Validation loss decreased (-0.811099 --> -0.825915).  Saving model ...
Epoch: 19 cost time: 0.8294885158538818
Epoch: 19, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.054 Vali Acc: 0.844 Test Loss: 1.054 Test Acc: 0.844
Validation loss decreased (-0.825915 --> -0.844434).  Saving model ...
Epoch: 20 cost time: 0.9439723491668701
Epoch: 20, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.994 Vali Acc: 0.819 Test Loss: 0.994 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.771920919418335
Epoch: 21, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.933 Vali Acc: 0.826 Test Loss: 0.933 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7905471324920654
Epoch: 22, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.872 Vali Acc: 0.844 Test Loss: 0.872 Test Acc: 0.844
Validation loss decreased (-0.844434 --> -0.844436).  Saving model ...
Epoch: 23 cost time: 0.7421579360961914
Epoch: 23, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.815 Vali Acc: 0.844 Test Loss: 0.815 Test Acc: 0.844
Validation loss decreased (-0.844436 --> -0.844436).  Saving model ...
Epoch: 24 cost time: 1.187453269958496
Epoch: 24, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.759 Vali Acc: 0.863 Test Loss: 0.759 Test Acc: 0.863
Validation loss decreased (-0.844436 --> -0.862955).  Saving model ...
Epoch: 25 cost time: 0.7989380359649658
Epoch: 25, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.706 Vali Acc: 0.878 Test Loss: 0.706 Test Acc: 0.878
Validation loss decreased (-0.862955 --> -0.877771).  Saving model ...
Epoch: 26 cost time: 0.7259609699249268
Epoch: 26, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.657 Vali Acc: 0.896 Test Loss: 0.657 Test Acc: 0.896
Validation loss decreased (-0.877771 --> -0.896290).  Saving model ...
Epoch: 27 cost time: 0.7530295848846436
Epoch: 27, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.613 Vali Acc: 0.900 Test Loss: 0.613 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 28 cost time: 0.8227822780609131
Epoch: 28, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.573 Vali Acc: 0.904 Test Loss: 0.573 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 29 cost time: 0.7310612201690674
Epoch: 29, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.537 Vali Acc: 0.907 Test Loss: 0.537 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 30 cost time: 0.690908670425415
Epoch: 30, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.506 Vali Acc: 0.911 Test Loss: 0.506 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 31 cost time: 0.8347592353820801
Epoch: 31, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.479 Vali Acc: 0.911 Test Loss: 0.479 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 32 cost time: 0.8168582916259766
Epoch: 32, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.452 Vali Acc: 0.915 Test Loss: 0.452 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 33 cost time: 1.0701484680175781
Epoch: 33, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.429 Vali Acc: 0.922 Test Loss: 0.429 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 34 cost time: 0.9418606758117676
Epoch: 34, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.412 Vali Acc: 0.915 Test Loss: 0.412 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.926724910736084
Epoch: 35, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.395 Vali Acc: 0.911 Test Loss: 0.395 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.865459680557251
Epoch: 36, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.380 Vali Acc: 0.907 Test Loss: 0.380 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7942767143249512
Epoch: 37, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.367 Vali Acc: 0.907 Test Loss: 0.367 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8618054389953613
Epoch: 38, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.354 Vali Acc: 0.919 Test Loss: 0.354 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8253958225250244
Epoch: 39, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.339 Vali Acc: 0.933 Test Loss: 0.339 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933330).  Saving model ...
Epoch: 40 cost time: 0.9665570259094238
Epoch: 40, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.329 Vali Acc: 0.933 Test Loss: 0.329 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 41 cost time: 0.8912279605865479
Epoch: 41, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 42 cost time: 0.7683541774749756
Epoch: 42, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.312 Vali Acc: 0.933 Test Loss: 0.312 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 43 cost time: 1.1054329872131348
Epoch: 43, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.0658745765686035
Epoch: 44, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6958043575286865
Epoch: 45, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.865849494934082
Epoch: 46, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 1.0338854789733887
Epoch: 47, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.977686882019043
Epoch: 48, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.271 Vali Acc: 0.937 Test Loss: 0.271 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 49 cost time: 0.9956488609313965
Epoch: 49, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 50 cost time: 0.8096458911895752
Epoch: 50, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 51 cost time: 0.8140020370483398
Epoch: 51, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 52 cost time: 1.65427827835083
Epoch: 52, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9121971130371094
Epoch: 53, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7935886383056641
Epoch: 54, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 55 cost time: 1.2106249332427979
Epoch: 55, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 56 cost time: 0.8616645336151123
Epoch: 56, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 57 cost time: 0.8797872066497803
Epoch: 57, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.7210650444030762
Epoch: 58, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.8430595397949219
Epoch: 59, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.228 Vali Acc: 0.948 Test Loss: 0.228 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 60 cost time: 0.8151698112487793
Epoch: 60, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8573145866394043
Epoch: 61, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8215694427490234
Epoch: 62, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.8880560398101807
Epoch: 63, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 1.169926643371582
Epoch: 64, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 1.0028414726257324
Epoch: 65, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.8552043437957764
Epoch: 66, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.7437894344329834
Epoch: 67, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.7091455459594727
Epoch: 68, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.7842168807983398
Epoch: 69, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 678890
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4777941703796387
Epoch: 1, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.818 Vali Acc: 0.181 Test Loss: 1.818 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.6495616436004639
Epoch: 2, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.792 Vali Acc: 0.185 Test Loss: 1.792 Test Acc: 0.185
Validation loss decreased (-0.181463 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 0.9954171180725098
Epoch: 3, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.768 Vali Acc: 0.204 Test Loss: 1.768 Test Acc: 0.204
Validation loss decreased (-0.185167 --> -0.203686).  Saving model ...
Epoch: 4 cost time: 0.7583563327789307
Epoch: 4, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.738 Vali Acc: 0.222 Test Loss: 1.738 Test Acc: 0.222
Validation loss decreased (-0.203686 --> -0.222205).  Saving model ...
Epoch: 5 cost time: 0.75740647315979
Epoch: 5, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.702 Vali Acc: 0.259 Test Loss: 1.702 Test Acc: 0.259
Validation loss decreased (-0.222205 --> -0.259242).  Saving model ...
Epoch: 6 cost time: 0.763967752456665
Epoch: 6, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.664 Vali Acc: 0.341 Test Loss: 1.664 Test Acc: 0.341
Validation loss decreased (-0.259242 --> -0.340724).  Saving model ...
Epoch: 7 cost time: 0.6693882942199707
Epoch: 7, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.625 Vali Acc: 0.437 Test Loss: 1.625 Test Acc: 0.437
Validation loss decreased (-0.340724 --> -0.437021).  Saving model ...
Epoch: 8 cost time: 0.8315374851226807
Epoch: 8, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.585 Vali Acc: 0.511 Test Loss: 1.585 Test Acc: 0.511
Validation loss decreased (-0.437021 --> -0.511095).  Saving model ...
Epoch: 9 cost time: 0.7598240375518799
Epoch: 9, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.544 Vali Acc: 0.544 Test Loss: 1.544 Test Acc: 0.544
Validation loss decreased (-0.511095 --> -0.544429).  Saving model ...
Epoch: 10 cost time: 0.7867848873138428
Epoch: 10, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.501 Vali Acc: 0.552 Test Loss: 1.501 Test Acc: 0.552
Validation loss decreased (-0.544429 --> -0.551837).  Saving model ...
Epoch: 11 cost time: 0.7079334259033203
Epoch: 11, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.453 Vali Acc: 0.596 Test Loss: 1.453 Test Acc: 0.596
Validation loss decreased (-0.551837 --> -0.596282).  Saving model ...
Epoch: 12 cost time: 0.6740047931671143
Epoch: 12, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.402 Vali Acc: 0.622 Test Loss: 1.402 Test Acc: 0.622
Validation loss decreased (-0.596282 --> -0.622208).  Saving model ...
Epoch: 13 cost time: 0.6354749202728271
Epoch: 13, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.347 Vali Acc: 0.648 Test Loss: 1.347 Test Acc: 0.648
Validation loss decreased (-0.622208 --> -0.648135).  Saving model ...
Epoch: 14 cost time: 0.6726341247558594
Epoch: 14, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.292 Vali Acc: 0.667 Test Loss: 1.292 Test Acc: 0.667
Validation loss decreased (-0.648135 --> -0.666654).  Saving model ...
Epoch: 15 cost time: 0.7654719352722168
Epoch: 15, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.236 Vali Acc: 0.689 Test Loss: 1.236 Test Acc: 0.689
Validation loss decreased (-0.666654 --> -0.688877).  Saving model ...
Epoch: 16 cost time: 0.7914540767669678
Epoch: 16, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.178 Vali Acc: 0.737 Test Loss: 1.178 Test Acc: 0.737
Validation loss decreased (-0.688877 --> -0.737025).  Saving model ...
Epoch: 17 cost time: 0.6351573467254639
Epoch: 17, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.121 Vali Acc: 0.767 Test Loss: 1.121 Test Acc: 0.767
Validation loss decreased (-0.737025 --> -0.766655).  Saving model ...
Epoch: 18 cost time: 0.7451798915863037
Epoch: 18, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.060 Vali Acc: 0.793 Test Loss: 1.060 Test Acc: 0.793
Validation loss decreased (-0.766655 --> -0.792582).  Saving model ...
Epoch: 19 cost time: 0.7494421005249023
Epoch: 19, Steps: 2 | Train Loss: 0.991 Vali Loss: 0.997 Vali Acc: 0.804 Test Loss: 0.997 Test Acc: 0.804
Validation loss decreased (-0.792582 --> -0.803694).  Saving model ...
Epoch: 20 cost time: 0.6279816627502441
Epoch: 20, Steps: 2 | Train Loss: 0.917 Vali Loss: 0.936 Vali Acc: 0.811 Test Loss: 0.936 Test Acc: 0.811
Validation loss decreased (-0.803694 --> -0.811102).  Saving model ...
Epoch: 21 cost time: 0.7866425514221191
Epoch: 21, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.877 Vali Acc: 0.826 Test Loss: 0.877 Test Acc: 0.826
Validation loss decreased (-0.811102 --> -0.825917).  Saving model ...
Epoch: 22 cost time: 0.9984922409057617
Epoch: 22, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.822 Vali Acc: 0.826 Test Loss: 0.822 Test Acc: 0.826
Validation loss decreased (-0.825917 --> -0.825918).  Saving model ...
Epoch: 23 cost time: 0.7989764213562012
Epoch: 23, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.771 Vali Acc: 0.830 Test Loss: 0.771 Test Acc: 0.830
Validation loss decreased (-0.825918 --> -0.829622).  Saving model ...
Epoch: 24 cost time: 0.7166662216186523
Epoch: 24, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.722 Vali Acc: 0.841 Test Loss: 0.722 Test Acc: 0.841
Validation loss decreased (-0.829622 --> -0.840734).  Saving model ...
Epoch: 25 cost time: 0.8429865837097168
Epoch: 25, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.678 Vali Acc: 0.856 Test Loss: 0.678 Test Acc: 0.856
Validation loss decreased (-0.840734 --> -0.855549).  Saving model ...
Epoch: 26 cost time: 0.717064619064331
Epoch: 26, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.636 Vali Acc: 0.870 Test Loss: 0.636 Test Acc: 0.870
Validation loss decreased (-0.855549 --> -0.870364).  Saving model ...
Epoch: 27 cost time: 0.7541842460632324
Epoch: 27, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.597 Vali Acc: 0.874 Test Loss: 0.597 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 28 cost time: 0.77115797996521
Epoch: 28, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.561 Vali Acc: 0.881 Test Loss: 0.561 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 29 cost time: 0.8078436851501465
Epoch: 29, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.529 Vali Acc: 0.878 Test Loss: 0.529 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0657577514648438
Epoch: 30, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.499 Vali Acc: 0.881 Test Loss: 0.499 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 31 cost time: 0.9027068614959717
Epoch: 31, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.472 Vali Acc: 0.881 Test Loss: 0.472 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881477).  Saving model ...
Epoch: 32 cost time: 0.8585925102233887
Epoch: 32, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.446 Vali Acc: 0.881 Test Loss: 0.446 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 33 cost time: 0.8905038833618164
Epoch: 33, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.422 Vali Acc: 0.885 Test Loss: 0.422 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885181).  Saving model ...
Epoch: 34 cost time: 0.7209217548370361
Epoch: 34, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.402 Vali Acc: 0.904 Test Loss: 0.402 Test Acc: 0.904
Validation loss decreased (-0.885181 --> -0.903700).  Saving model ...
Epoch: 35 cost time: 0.6881527900695801
Epoch: 35, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.385 Vali Acc: 0.904 Test Loss: 0.385 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 36 cost time: 0.6551446914672852
Epoch: 36, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.8073556423187256
Epoch: 37, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.359 Vali Acc: 0.907 Test Loss: 0.359 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 38 cost time: 0.7707979679107666
Epoch: 38, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.351 Vali Acc: 0.904 Test Loss: 0.351 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6859641075134277
Epoch: 39, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.344 Vali Acc: 0.900 Test Loss: 0.344 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7178261280059814
Epoch: 40, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.338 Vali Acc: 0.900 Test Loss: 0.338 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8333687782287598
Epoch: 41, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.331 Vali Acc: 0.900 Test Loss: 0.331 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7424964904785156
Epoch: 42, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.324 Vali Acc: 0.900 Test Loss: 0.324 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9214034080505371
Epoch: 43, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.316 Vali Acc: 0.900 Test Loss: 0.316 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8285753726959229
Epoch: 44, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.307 Vali Acc: 0.907 Test Loss: 0.307 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 45 cost time: 0.7260396480560303
Epoch: 45, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.298 Vali Acc: 0.907 Test Loss: 0.298 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 46 cost time: 0.7306439876556396
Epoch: 46, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.291 Vali Acc: 0.911 Test Loss: 0.291 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 47 cost time: 0.6434202194213867
Epoch: 47, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.286 Vali Acc: 0.904 Test Loss: 0.286 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7716259956359863
Epoch: 48, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.284 Vali Acc: 0.907 Test Loss: 0.284 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7748439311981201
Epoch: 49, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.282 Vali Acc: 0.907 Test Loss: 0.282 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.842139482498169
Epoch: 50, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.283 Vali Acc: 0.904 Test Loss: 0.283 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.7133810520172119
Epoch: 51, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.286 Vali Acc: 0.896 Test Loss: 0.286 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8071181774139404
Epoch: 52, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.288 Vali Acc: 0.896 Test Loss: 0.288 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.7846841812133789
Epoch: 53, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.287 Vali Acc: 0.896 Test Loss: 0.287 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.8298463821411133
Epoch: 54, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.284 Vali Acc: 0.896 Test Loss: 0.284 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.9013519287109375
Epoch: 55, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.7386775016784668
Epoch: 56, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.274 Vali Acc: 0.900 Test Loss: 0.274 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 678314
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0154030323028564
Epoch: 1, Steps: 2 | Train Loss: 1.968 Vali Loss: 1.915 Vali Acc: 0.167 Test Loss: 1.915 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.5992200374603271
Epoch: 2, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.856 Vali Acc: 0.167 Test Loss: 1.856 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.7700657844543457
Epoch: 3, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.808 Vali Acc: 0.178 Test Loss: 1.808 Test Acc: 0.178
Validation loss decreased (-0.166648 --> -0.177760).  Saving model ...
Epoch: 4 cost time: 0.8065905570983887
Epoch: 4, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.754 Vali Acc: 0.293 Test Loss: 1.754 Test Acc: 0.293
Validation loss decreased (-0.177760 --> -0.292575).  Saving model ...
Epoch: 5 cost time: 0.7883031368255615
Epoch: 5, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.700 Vali Acc: 0.356 Test Loss: 1.700 Test Acc: 0.356
Validation loss decreased (-0.292575 --> -0.355539).  Saving model ...
Epoch: 6 cost time: 0.8061292171478271
Epoch: 6, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.656 Vali Acc: 0.400 Test Loss: 1.656 Test Acc: 0.400
Validation loss decreased (-0.355539 --> -0.399983).  Saving model ...
Epoch: 7 cost time: 0.8487780094146729
Epoch: 7, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.616 Vali Acc: 0.474 Test Loss: 1.616 Test Acc: 0.474
Validation loss decreased (-0.399983 --> -0.474058).  Saving model ...
Epoch: 8 cost time: 0.7954967021942139
Epoch: 8, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.581 Vali Acc: 0.470 Test Loss: 1.581 Test Acc: 0.470
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7032420635223389
Epoch: 9, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.545 Vali Acc: 0.444 Test Loss: 1.545 Test Acc: 0.444
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8540005683898926
Epoch: 10, Steps: 2 | Train Loss: 1.516 Vali Loss: 1.505 Vali Acc: 0.489 Test Loss: 1.505 Test Acc: 0.489
Validation loss decreased (-0.474058 --> -0.488874).  Saving model ...
Epoch: 11 cost time: 0.7786462306976318
Epoch: 11, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.461 Vali Acc: 0.511 Test Loss: 1.461 Test Acc: 0.511
Validation loss decreased (-0.488874 --> -0.511097).  Saving model ...
Epoch: 12 cost time: 0.8311583995819092
Epoch: 12, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.411 Vali Acc: 0.574 Test Loss: 1.411 Test Acc: 0.574
Validation loss decreased (-0.511097 --> -0.574060).  Saving model ...
Epoch: 13 cost time: 0.6897242069244385
Epoch: 13, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.355 Vali Acc: 0.619 Test Loss: 1.355 Test Acc: 0.619
Validation loss decreased (-0.574060 --> -0.618505).  Saving model ...
Epoch: 14 cost time: 0.6880402565002441
Epoch: 14, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.295 Vali Acc: 0.696 Test Loss: 1.295 Test Acc: 0.696
Validation loss decreased (-0.618505 --> -0.696283).  Saving model ...
Epoch: 15 cost time: 0.7945592403411865
Epoch: 15, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.236 Vali Acc: 0.767 Test Loss: 1.236 Test Acc: 0.767
Validation loss decreased (-0.696283 --> -0.766654).  Saving model ...
Epoch: 16 cost time: 0.8596134185791016
Epoch: 16, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.176 Vali Acc: 0.793 Test Loss: 1.176 Test Acc: 0.793
Validation loss decreased (-0.766654 --> -0.792581).  Saving model ...
Epoch: 17 cost time: 0.8043718338012695
Epoch: 17, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.115 Vali Acc: 0.811 Test Loss: 1.115 Test Acc: 0.811
Validation loss decreased (-0.792581 --> -0.811100).  Saving model ...
Epoch: 18 cost time: 0.6928985118865967
Epoch: 18, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.053 Vali Acc: 0.826 Test Loss: 1.053 Test Acc: 0.826
Validation loss decreased (-0.811100 --> -0.825915).  Saving model ...
Epoch: 19 cost time: 0.8768551349639893
Epoch: 19, Steps: 2 | Train Loss: 0.950 Vali Loss: 0.992 Vali Acc: 0.841 Test Loss: 0.992 Test Acc: 0.841
Validation loss decreased (-0.825915 --> -0.840731).  Saving model ...
Epoch: 20 cost time: 0.6567332744598389
Epoch: 20, Steps: 2 | Train Loss: 0.901 Vali Loss: 0.929 Vali Acc: 0.859 Test Loss: 0.929 Test Acc: 0.859
Validation loss decreased (-0.840731 --> -0.859250).  Saving model ...
Epoch: 21 cost time: 0.7895410060882568
Epoch: 21, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.867 Vali Acc: 0.874 Test Loss: 0.867 Test Acc: 0.874
Validation loss decreased (-0.859250 --> -0.874065).  Saving model ...
Epoch: 22 cost time: 0.7268834114074707
Epoch: 22, Steps: 2 | Train Loss: 0.744 Vali Loss: 0.807 Vali Acc: 0.881 Test Loss: 0.807 Test Acc: 0.881
Validation loss decreased (-0.874065 --> -0.881473).  Saving model ...
Epoch: 23 cost time: 0.7490918636322021
Epoch: 23, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.750 Vali Acc: 0.896 Test Loss: 0.750 Test Acc: 0.896
Validation loss decreased (-0.881473 --> -0.896289).  Saving model ...
Epoch: 24 cost time: 0.6307759284973145
Epoch: 24, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.698 Vali Acc: 0.896 Test Loss: 0.698 Test Acc: 0.896
Validation loss decreased (-0.896289 --> -0.896289).  Saving model ...
Epoch: 25 cost time: 0.5980989933013916
Epoch: 25, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.648 Vali Acc: 0.900 Test Loss: 0.648 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899994).  Saving model ...
Epoch: 26 cost time: 0.748950719833374
Epoch: 26, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.603 Vali Acc: 0.911 Test Loss: 0.603 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911105).  Saving model ...
Epoch: 27 cost time: 0.703418493270874
Epoch: 27, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.562 Vali Acc: 0.919 Test Loss: 0.562 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 28 cost time: 0.7758839130401611
Epoch: 28, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.525 Vali Acc: 0.911 Test Loss: 0.525 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6942441463470459
Epoch: 29, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.493 Vali Acc: 0.907 Test Loss: 0.493 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7683508396148682
Epoch: 30, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.465 Vali Acc: 0.915 Test Loss: 0.465 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7365908622741699
Epoch: 31, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.438 Vali Acc: 0.919 Test Loss: 0.438 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 32 cost time: 0.7985281944274902
Epoch: 32, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.415 Vali Acc: 0.915 Test Loss: 0.415 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8422424793243408
Epoch: 33, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.395 Vali Acc: 0.930 Test Loss: 0.395 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929626).  Saving model ...
Epoch: 34 cost time: 0.6958353519439697
Epoch: 34, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.378 Vali Acc: 0.941 Test Loss: 0.378 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.724562406539917
Epoch: 35, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.362 Vali Acc: 0.948 Test Loss: 0.362 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 36 cost time: 0.7815477848052979
Epoch: 36, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.347 Vali Acc: 0.948 Test Loss: 0.347 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 37 cost time: 0.8428080081939697
Epoch: 37, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.336 Vali Acc: 0.941 Test Loss: 0.336 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8236668109893799
Epoch: 38, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.326 Vali Acc: 0.930 Test Loss: 0.326 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8190789222717285
Epoch: 39, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7631328105926514
Epoch: 40, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7980515956878662
Epoch: 41, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.298 Vali Acc: 0.937 Test Loss: 0.298 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7639176845550537
Epoch: 42, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7283916473388672
Epoch: 43, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6696784496307373
Epoch: 44, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8111321926116943
Epoch: 45, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6249878406524658
Epoch: 46, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 677738
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.316519021987915
Epoch: 1, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.919 Vali Acc: 0.159 Test Loss: 1.919 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.7379860877990723
Epoch: 2, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.885 Vali Acc: 0.152 Test Loss: 1.885 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7167227268218994
Epoch: 3, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.856 Vali Acc: 0.152 Test Loss: 1.856 Test Acc: 0.152
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7837131023406982
Epoch: 4, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.822 Vali Acc: 0.137 Test Loss: 1.822 Test Acc: 0.137
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.7493462562561035
Epoch: 5, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.785 Vali Acc: 0.163 Test Loss: 1.785 Test Acc: 0.163
Validation loss decreased (-0.159240 --> -0.162945).  Saving model ...
Epoch: 6 cost time: 0.7501993179321289
Epoch: 6, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.748 Vali Acc: 0.270 Test Loss: 1.748 Test Acc: 0.270
Validation loss decreased (-0.162945 --> -0.270353).  Saving model ...
Epoch: 7 cost time: 0.6880977153778076
Epoch: 7, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.711 Vali Acc: 0.333 Test Loss: 1.711 Test Acc: 0.333
Validation loss decreased (-0.270353 --> -0.333316).  Saving model ...
Epoch: 8 cost time: 0.7182517051696777
Epoch: 8, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.674 Vali Acc: 0.389 Test Loss: 1.674 Test Acc: 0.389
Validation loss decreased (-0.333316 --> -0.388872).  Saving model ...
Epoch: 9 cost time: 0.7322194576263428
Epoch: 9, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.638 Vali Acc: 0.422 Test Loss: 1.638 Test Acc: 0.422
Validation loss decreased (-0.388872 --> -0.422206).  Saving model ...
Epoch: 10 cost time: 0.7420825958251953
Epoch: 10, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.600 Vali Acc: 0.437 Test Loss: 1.600 Test Acc: 0.437
Validation loss decreased (-0.422206 --> -0.437021).  Saving model ...
Epoch: 11 cost time: 0.7573847770690918
Epoch: 11, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.557 Vali Acc: 0.470 Test Loss: 1.557 Test Acc: 0.470
Validation loss decreased (-0.437021 --> -0.470355).  Saving model ...
Epoch: 12 cost time: 0.7398273944854736
Epoch: 12, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.514 Vali Acc: 0.493 Test Loss: 1.514 Test Acc: 0.493
Validation loss decreased (-0.470355 --> -0.492577).  Saving model ...
Epoch: 13 cost time: 0.7292585372924805
Epoch: 13, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.470 Vali Acc: 0.526 Test Loss: 1.470 Test Acc: 0.526
Validation loss decreased (-0.492577 --> -0.525911).  Saving model ...
Epoch: 14 cost time: 0.7207231521606445
Epoch: 14, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.419 Vali Acc: 0.574 Test Loss: 1.419 Test Acc: 0.574
Validation loss decreased (-0.525911 --> -0.574060).  Saving model ...
Epoch: 15 cost time: 0.781116247177124
Epoch: 15, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.367 Vali Acc: 0.619 Test Loss: 1.367 Test Acc: 0.619
Validation loss decreased (-0.574060 --> -0.618505).  Saving model ...
Epoch: 16 cost time: 0.6336746215820312
Epoch: 16, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.311 Vali Acc: 0.659 Test Loss: 1.311 Test Acc: 0.659
Validation loss decreased (-0.618505 --> -0.659246).  Saving model ...
Epoch: 17 cost time: 0.7821035385131836
Epoch: 17, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.252 Vali Acc: 0.719 Test Loss: 1.252 Test Acc: 0.719
Validation loss decreased (-0.659246 --> -0.718506).  Saving model ...
Epoch: 18 cost time: 0.8535797595977783
Epoch: 18, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.190 Vali Acc: 0.744 Test Loss: 1.190 Test Acc: 0.744
Validation loss decreased (-0.718506 --> -0.744433).  Saving model ...
Epoch: 19 cost time: 0.6722898483276367
Epoch: 19, Steps: 2 | Train Loss: 1.204 Vali Loss: 1.127 Vali Acc: 0.785 Test Loss: 1.127 Test Acc: 0.785
Validation loss decreased (-0.744433 --> -0.785174).  Saving model ...
Epoch: 20 cost time: 0.6898496150970459
Epoch: 20, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.064 Vali Acc: 0.830 Test Loss: 1.064 Test Acc: 0.830
Validation loss decreased (-0.785174 --> -0.829619).  Saving model ...
Epoch: 21 cost time: 0.641578197479248
Epoch: 21, Steps: 2 | Train Loss: 1.012 Vali Loss: 0.999 Vali Acc: 0.841 Test Loss: 0.999 Test Acc: 0.841
Validation loss decreased (-0.829619 --> -0.840731).  Saving model ...
Epoch: 22 cost time: 0.6152384281158447
Epoch: 22, Steps: 2 | Train Loss: 0.954 Vali Loss: 0.933 Vali Acc: 0.848 Test Loss: 0.933 Test Acc: 0.848
Validation loss decreased (-0.840731 --> -0.848139).  Saving model ...
Epoch: 23 cost time: 0.695636510848999
Epoch: 23, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.873 Vali Acc: 0.844 Test Loss: 0.873 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8801698684692383
Epoch: 24, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.816 Vali Acc: 0.848 Test Loss: 0.816 Test Acc: 0.848
Validation loss decreased (-0.848139 --> -0.848140).  Saving model ...
Epoch: 25 cost time: 0.8102641105651855
Epoch: 25, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.762 Vali Acc: 0.870 Test Loss: 0.762 Test Acc: 0.870
Validation loss decreased (-0.848140 --> -0.870363).  Saving model ...
Epoch: 26 cost time: 0.685187578201294
Epoch: 26, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.708 Vali Acc: 0.893 Test Loss: 0.708 Test Acc: 0.893
Validation loss decreased (-0.870363 --> -0.892586).  Saving model ...
Epoch: 27 cost time: 0.6253886222839355
Epoch: 27, Steps: 2 | Train Loss: 0.605 Vali Loss: 0.658 Vali Acc: 0.915 Test Loss: 0.658 Test Acc: 0.915
Validation loss decreased (-0.892586 --> -0.914808).  Saving model ...
Epoch: 28 cost time: 0.7043430805206299
Epoch: 28, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.615 Vali Acc: 0.919 Test Loss: 0.615 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 29 cost time: 0.8248751163482666
Epoch: 29, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.575 Vali Acc: 0.907 Test Loss: 0.575 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6943607330322266
Epoch: 30, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.540 Vali Acc: 0.919 Test Loss: 0.540 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 31 cost time: 0.7821509838104248
Epoch: 31, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.510 Vali Acc: 0.911 Test Loss: 0.510 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6772065162658691
Epoch: 32, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.484 Vali Acc: 0.900 Test Loss: 0.484 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6402609348297119
Epoch: 33, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.459 Vali Acc: 0.907 Test Loss: 0.459 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7149691581726074
Epoch: 34, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.433 Vali Acc: 0.926 Test Loss: 0.433 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925922).  Saving model ...
Epoch: 35 cost time: 0.6629631519317627
Epoch: 35, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.410 Vali Acc: 0.941 Test Loss: 0.410 Test Acc: 0.941
Validation loss decreased (-0.925922 --> -0.940737).  Saving model ...
Epoch: 36 cost time: 0.6886894702911377
Epoch: 36, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.390 Vali Acc: 0.937 Test Loss: 0.390 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7815303802490234
Epoch: 37, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.372 Vali Acc: 0.933 Test Loss: 0.372 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.8131422996520996
Epoch: 38, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.356 Vali Acc: 0.933 Test Loss: 0.356 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.703963041305542
Epoch: 39, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.342 Vali Acc: 0.933 Test Loss: 0.342 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9438588619232178
Epoch: 40, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 41 cost time: 0.9646396636962891
Epoch: 41, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.321 Vali Acc: 0.937 Test Loss: 0.321 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6239819526672363
Epoch: 42, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.311 Vali Acc: 0.933 Test Loss: 0.311 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7295238971710205
Epoch: 43, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7530107498168945
Epoch: 44, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.293 Vali Acc: 0.933 Test Loss: 0.293 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7300500869750977
Epoch: 45, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.283 Vali Acc: 0.933 Test Loss: 0.283 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7141258716583252
Epoch: 46, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.677772045135498
Epoch: 47, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.271 Vali Acc: 0.937 Test Loss: 0.271 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8713870048522949
Epoch: 48, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.265 Vali Acc: 0.941 Test Loss: 0.265 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 49 cost time: 0.6685378551483154
Epoch: 49, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.8081161975860596
Epoch: 50, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.7133581638336182
Epoch: 51, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.8366632461547852
Epoch: 52, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8843529224395752
Epoch: 53, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.6866154670715332
Epoch: 54, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8006970882415771
Epoch: 55, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.8221619129180908
Epoch: 56, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.7973740100860596
Epoch: 57, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.6971113681793213
Epoch: 58, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6436572074890137
Epoch: 59, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 60 cost time: 0.6185309886932373
Epoch: 60, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6895949840545654
Epoch: 61, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.799281120300293
Epoch: 62, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.7550814151763916
Epoch: 63, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.6774036884307861
Epoch: 64, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.7165603637695312
Epoch: 65, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.666154146194458
Epoch: 66, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.7837116718292236
Epoch: 67, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.7446765899658203
Epoch: 68, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.739316463470459
Epoch: 69, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 677162
model size : 3.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6111490726470947
Epoch: 1, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.780 Vali Acc: 0.263 Test Loss: 1.780 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 0.6448826789855957
Epoch: 2, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.755 Vali Acc: 0.267 Test Loss: 1.755 Test Acc: 0.267
Validation loss decreased (-0.262945 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 0.7290806770324707
Epoch: 3, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.734 Vali Acc: 0.285 Test Loss: 1.734 Test Acc: 0.285
Validation loss decreased (-0.266649 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.8947663307189941
Epoch: 4, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.709 Vali Acc: 0.307 Test Loss: 1.709 Test Acc: 0.307
Validation loss decreased (-0.285168 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.7471578121185303
Epoch: 5, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.682 Vali Acc: 0.326 Test Loss: 1.682 Test Acc: 0.326
Validation loss decreased (-0.307390 --> -0.325909).  Saving model ...
Epoch: 6 cost time: 0.7970359325408936
Epoch: 6, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.653 Vali Acc: 0.374 Test Loss: 1.653 Test Acc: 0.374
Validation loss decreased (-0.325909 --> -0.374058).  Saving model ...
Epoch: 7 cost time: 1.0724155902862549
Epoch: 7, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.622 Vali Acc: 0.426 Test Loss: 1.622 Test Acc: 0.426
Validation loss decreased (-0.374058 --> -0.425910).  Saving model ...
Epoch: 8 cost time: 0.8082170486450195
Epoch: 8, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.589 Vali Acc: 0.515 Test Loss: 1.589 Test Acc: 0.515
Validation loss decreased (-0.425910 --> -0.514799).  Saving model ...
Epoch: 9 cost time: 0.7989938259124756
Epoch: 9, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.555 Vali Acc: 0.641 Test Loss: 1.555 Test Acc: 0.641
Validation loss decreased (-0.514799 --> -0.640725).  Saving model ...
Epoch: 10 cost time: 1.029932975769043
Epoch: 10, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.520 Vali Acc: 0.674 Test Loss: 1.520 Test Acc: 0.674
Validation loss decreased (-0.640725 --> -0.674059).  Saving model ...
Epoch: 11 cost time: 0.7816169261932373
Epoch: 11, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.481 Vali Acc: 0.689 Test Loss: 1.481 Test Acc: 0.689
Validation loss decreased (-0.674059 --> -0.688874).  Saving model ...
Epoch: 12 cost time: 0.8007123470306396
Epoch: 12, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.440 Vali Acc: 0.719 Test Loss: 1.440 Test Acc: 0.719
Validation loss decreased (-0.688874 --> -0.718504).  Saving model ...
Epoch: 13 cost time: 0.8753364086151123
Epoch: 13, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.394 Vali Acc: 0.752 Test Loss: 1.394 Test Acc: 0.752
Validation loss decreased (-0.718504 --> -0.751838).  Saving model ...
Epoch: 14 cost time: 0.7304339408874512
Epoch: 14, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.343 Vali Acc: 0.778 Test Loss: 1.343 Test Acc: 0.778
Validation loss decreased (-0.751838 --> -0.777764).  Saving model ...
Epoch: 15 cost time: 0.8126578330993652
Epoch: 15, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.291 Vali Acc: 0.804 Test Loss: 1.291 Test Acc: 0.804
Validation loss decreased (-0.777764 --> -0.803691).  Saving model ...
Epoch: 16 cost time: 0.92262864112854
Epoch: 16, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.239 Vali Acc: 0.819 Test Loss: 1.239 Test Acc: 0.819
Validation loss decreased (-0.803691 --> -0.818506).  Saving model ...
Epoch: 17 cost time: 0.7351682186126709
Epoch: 17, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.186 Vali Acc: 0.833 Test Loss: 1.186 Test Acc: 0.833
Validation loss decreased (-0.818506 --> -0.833321).  Saving model ...
Epoch: 18 cost time: 0.8455727100372314
Epoch: 18, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.132 Vali Acc: 0.844 Test Loss: 1.132 Test Acc: 0.844
Validation loss decreased (-0.833321 --> -0.844433).  Saving model ...
Epoch: 19 cost time: 0.7363929748535156
Epoch: 19, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.076 Vali Acc: 0.844 Test Loss: 1.076 Test Acc: 0.844
Validation loss decreased (-0.844433 --> -0.844434).  Saving model ...
Epoch: 20 cost time: 0.7360129356384277
Epoch: 20, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.017 Vali Acc: 0.856 Test Loss: 1.017 Test Acc: 0.856
Validation loss decreased (-0.844434 --> -0.855545).  Saving model ...
Epoch: 21 cost time: 0.7805757522583008
Epoch: 21, Steps: 2 | Train Loss: 0.965 Vali Loss: 0.957 Vali Acc: 0.863 Test Loss: 0.957 Test Acc: 0.863
Validation loss decreased (-0.855545 --> -0.862953).  Saving model ...
Epoch: 22 cost time: 0.932138204574585
Epoch: 22, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.898 Vali Acc: 0.874 Test Loss: 0.898 Test Acc: 0.874
Validation loss decreased (-0.862953 --> -0.874065).  Saving model ...
Epoch: 23 cost time: 0.7922303676605225
Epoch: 23, Steps: 2 | Train Loss: 0.791 Vali Loss: 0.842 Vali Acc: 0.893 Test Loss: 0.842 Test Acc: 0.893
Validation loss decreased (-0.874065 --> -0.892584).  Saving model ...
Epoch: 24 cost time: 0.6956877708435059
Epoch: 24, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.787 Vali Acc: 0.900 Test Loss: 0.787 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 25 cost time: 0.9475579261779785
Epoch: 25, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.735 Vali Acc: 0.904 Test Loss: 0.735 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 26 cost time: 0.9858300685882568
Epoch: 26, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.688 Vali Acc: 0.904 Test Loss: 0.688 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 27 cost time: 0.7422208786010742
Epoch: 27, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.642 Vali Acc: 0.911 Test Loss: 0.642 Test Acc: 0.911
Validation loss decreased (-0.903697 --> -0.911105).  Saving model ...
Epoch: 28 cost time: 0.835313081741333
Epoch: 28, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.601 Vali Acc: 0.915 Test Loss: 0.601 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 29 cost time: 0.9474928379058838
Epoch: 29, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.563 Vali Acc: 0.904 Test Loss: 0.563 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7598042488098145
Epoch: 30, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.528 Vali Acc: 0.919 Test Loss: 0.528 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 31 cost time: 0.9050390720367432
Epoch: 31, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.497 Vali Acc: 0.919 Test Loss: 0.497 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 32 cost time: 0.7506592273712158
Epoch: 32, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.467 Vali Acc: 0.922 Test Loss: 0.467 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 33 cost time: 0.6721100807189941
Epoch: 33, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.440 Vali Acc: 0.922 Test Loss: 0.440 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 34 cost time: 0.7940363883972168
Epoch: 34, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.417 Vali Acc: 0.926 Test Loss: 0.417 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 35 cost time: 0.774437427520752
Epoch: 35, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.397 Vali Acc: 0.926 Test Loss: 0.397 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 36 cost time: 1.0075650215148926
Epoch: 36, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.379 Vali Acc: 0.930 Test Loss: 0.379 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 37 cost time: 1.047217845916748
Epoch: 37, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.362 Vali Acc: 0.930 Test Loss: 0.362 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 38 cost time: 0.6770768165588379
Epoch: 38, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.348 Vali Acc: 0.930 Test Loss: 0.348 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 39 cost time: 0.7219536304473877
Epoch: 39, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7807266712188721
Epoch: 40, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9095714092254639
Epoch: 41, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8228068351745605
Epoch: 42, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.308 Vali Acc: 0.922 Test Loss: 0.308 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.8507492542266846
Epoch: 43, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7378804683685303
Epoch: 44, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.8470518589019775
Epoch: 45, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 46 cost time: 0.743675947189331
Epoch: 46, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.270 Vali Acc: 0.941 Test Loss: 0.270 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.8135776519775391
Epoch: 47, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.7632336616516113
Epoch: 48, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.903388500213623
Epoch: 49, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7903454303741455
Epoch: 50, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.8247270584106445
Epoch: 51, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.8201920986175537
Epoch: 52, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 1.1294033527374268
Epoch: 53, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.7840743064880371
Epoch: 54, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.8307840824127197
Epoch: 55, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 1.0913262367248535
Epoch: 56, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.7431700229644775
Epoch: 57, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 513770
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6762139797210693
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.807 Vali Acc: 0.211 Test Loss: 1.807 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.9976458549499512
Epoch: 2, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.788 Vali Acc: 0.207 Test Loss: 1.788 Test Acc: 0.207
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1729700565338135
Epoch: 3, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.771 Vali Acc: 0.233 Test Loss: 1.771 Test Acc: 0.233
Validation loss decreased (-0.211093 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 0.7029180526733398
Epoch: 4, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.752 Vali Acc: 0.237 Test Loss: 1.752 Test Acc: 0.237
Validation loss decreased (-0.233316 --> -0.237020).  Saving model ...
Epoch: 5 cost time: 1.0667226314544678
Epoch: 5, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.726 Vali Acc: 0.285 Test Loss: 1.726 Test Acc: 0.285
Validation loss decreased (-0.237020 --> -0.285168).  Saving model ...
Epoch: 6 cost time: 0.8199684619903564
Epoch: 6, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.697 Vali Acc: 0.311 Test Loss: 1.697 Test Acc: 0.311
Validation loss decreased (-0.285168 --> -0.311094).  Saving model ...
Epoch: 7 cost time: 0.6803948879241943
Epoch: 7, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.666 Vali Acc: 0.315 Test Loss: 1.666 Test Acc: 0.315
Validation loss decreased (-0.311094 --> -0.314798).  Saving model ...
Epoch: 8 cost time: 0.7266590595245361
Epoch: 8, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.634 Vali Acc: 0.333 Test Loss: 1.634 Test Acc: 0.333
Validation loss decreased (-0.314798 --> -0.333317).  Saving model ...
Epoch: 9 cost time: 0.8058338165283203
Epoch: 9, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.599 Vali Acc: 0.459 Test Loss: 1.599 Test Acc: 0.459
Validation loss decreased (-0.333317 --> -0.459243).  Saving model ...
Epoch: 10 cost time: 0.8540236949920654
Epoch: 10, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.563 Vali Acc: 0.548 Test Loss: 1.563 Test Acc: 0.548
Validation loss decreased (-0.459243 --> -0.548133).  Saving model ...
Epoch: 11 cost time: 0.9656705856323242
Epoch: 11, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.526 Vali Acc: 0.574 Test Loss: 1.526 Test Acc: 0.574
Validation loss decreased (-0.548133 --> -0.574059).  Saving model ...
Epoch: 12 cost time: 0.8285675048828125
Epoch: 12, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.486 Vali Acc: 0.593 Test Loss: 1.486 Test Acc: 0.593
Validation loss decreased (-0.574059 --> -0.592578).  Saving model ...
Epoch: 13 cost time: 0.7286171913146973
Epoch: 13, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.444 Vali Acc: 0.626 Test Loss: 1.444 Test Acc: 0.626
Validation loss decreased (-0.592578 --> -0.625911).  Saving model ...
Epoch: 14 cost time: 0.7409985065460205
Epoch: 14, Steps: 2 | Train Loss: 1.395 Vali Loss: 1.401 Vali Acc: 0.681 Test Loss: 1.401 Test Acc: 0.681
Validation loss decreased (-0.625911 --> -0.681467).  Saving model ...
Epoch: 15 cost time: 0.6750552654266357
Epoch: 15, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.356 Vali Acc: 0.737 Test Loss: 1.356 Test Acc: 0.737
Validation loss decreased (-0.681467 --> -0.737023).  Saving model ...
Epoch: 16 cost time: 0.6860711574554443
Epoch: 16, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.309 Vali Acc: 0.763 Test Loss: 1.309 Test Acc: 0.763
Validation loss decreased (-0.737023 --> -0.762950).  Saving model ...
Epoch: 17 cost time: 0.8553855419158936
Epoch: 17, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.260 Vali Acc: 0.781 Test Loss: 1.260 Test Acc: 0.781
Validation loss decreased (-0.762950 --> -0.781469).  Saving model ...
Epoch: 18 cost time: 0.7903621196746826
Epoch: 18, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.207 Vali Acc: 0.811 Test Loss: 1.207 Test Acc: 0.811
Validation loss decreased (-0.781469 --> -0.811099).  Saving model ...
Epoch: 19 cost time: 0.718297004699707
Epoch: 19, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.153 Vali Acc: 0.811 Test Loss: 1.153 Test Acc: 0.811
Validation loss decreased (-0.811099 --> -0.811100).  Saving model ...
Epoch: 20 cost time: 1.178297519683838
Epoch: 20, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.097 Vali Acc: 0.815 Test Loss: 1.097 Test Acc: 0.815
Validation loss decreased (-0.811100 --> -0.814804).  Saving model ...
Epoch: 21 cost time: 0.9173743724822998
Epoch: 21, Steps: 2 | Train Loss: 1.038 Vali Loss: 1.042 Vali Acc: 0.822 Test Loss: 1.042 Test Acc: 0.822
Validation loss decreased (-0.814804 --> -0.822212).  Saving model ...
Epoch: 22 cost time: 0.7813694477081299
Epoch: 22, Steps: 2 | Train Loss: 0.962 Vali Loss: 0.985 Vali Acc: 0.826 Test Loss: 0.985 Test Acc: 0.826
Validation loss decreased (-0.822212 --> -0.825916).  Saving model ...
Epoch: 23 cost time: 0.8092281818389893
Epoch: 23, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.928 Vali Acc: 0.848 Test Loss: 0.928 Test Acc: 0.848
Validation loss decreased (-0.825916 --> -0.848139).  Saving model ...
Epoch: 24 cost time: 0.8551793098449707
Epoch: 24, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.871 Vali Acc: 0.859 Test Loss: 0.871 Test Acc: 0.859
Validation loss decreased (-0.848139 --> -0.859251).  Saving model ...
Epoch: 25 cost time: 0.8766820430755615
Epoch: 25, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.819 Vali Acc: 0.874 Test Loss: 0.819 Test Acc: 0.874
Validation loss decreased (-0.859251 --> -0.874066).  Saving model ...
Epoch: 26 cost time: 0.8269908428192139
Epoch: 26, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.768 Vali Acc: 0.896 Test Loss: 0.768 Test Acc: 0.896
Validation loss decreased (-0.874066 --> -0.896289).  Saving model ...
Epoch: 27 cost time: 0.7986409664154053
Epoch: 27, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.720 Vali Acc: 0.900 Test Loss: 0.720 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 28 cost time: 0.817061185836792
Epoch: 28, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.674 Vali Acc: 0.911 Test Loss: 0.674 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.911104).  Saving model ...
Epoch: 29 cost time: 0.7570369243621826
Epoch: 29, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.630 Vali Acc: 0.911 Test Loss: 0.630 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911105).  Saving model ...
Epoch: 30 cost time: 0.7900238037109375
Epoch: 30, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.591 Vali Acc: 0.915 Test Loss: 0.591 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 31 cost time: 0.8837666511535645
Epoch: 31, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.555 Vali Acc: 0.911 Test Loss: 0.555 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7705695629119873
Epoch: 32, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.522 Vali Acc: 0.911 Test Loss: 0.522 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6955194473266602
Epoch: 33, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.493 Vali Acc: 0.915 Test Loss: 0.493 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 34 cost time: 0.7110567092895508
Epoch: 34, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.467 Vali Acc: 0.911 Test Loss: 0.467 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7529785633087158
Epoch: 35, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.443 Vali Acc: 0.915 Test Loss: 0.443 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 36 cost time: 0.9575693607330322
Epoch: 36, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.423 Vali Acc: 0.911 Test Loss: 0.423 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9228191375732422
Epoch: 37, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.402 Vali Acc: 0.915 Test Loss: 0.402 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 38 cost time: 0.7358343601226807
Epoch: 38, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.382 Vali Acc: 0.919 Test Loss: 0.382 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 39 cost time: 0.9705345630645752
Epoch: 39, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.365 Vali Acc: 0.919 Test Loss: 0.365 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 40 cost time: 0.9254317283630371
Epoch: 40, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.349 Vali Acc: 0.922 Test Loss: 0.349 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 41 cost time: 0.7095987796783447
Epoch: 41, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.334 Vali Acc: 0.933 Test Loss: 0.334 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933330).  Saving model ...
Epoch: 42 cost time: 0.8000683784484863
Epoch: 42, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.325 Vali Acc: 0.922 Test Loss: 0.325 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6699252128601074
Epoch: 43, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.316 Vali Acc: 0.926 Test Loss: 0.316 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9249839782714844
Epoch: 44, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.307 Vali Acc: 0.926 Test Loss: 0.307 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6747431755065918
Epoch: 45, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.300 Vali Acc: 0.926 Test Loss: 0.300 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6830930709838867
Epoch: 46, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.293 Vali Acc: 0.933 Test Loss: 0.293 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 47 cost time: 0.7812538146972656
Epoch: 47, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7848865985870361
Epoch: 48, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.850236177444458
Epoch: 49, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0440011024475098
Epoch: 50, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.827871561050415
Epoch: 51, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 52 cost time: 0.6341245174407959
Epoch: 52, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 53 cost time: 0.7463953495025635
Epoch: 53, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.257 Vali Acc: 0.933 Test Loss: 0.257 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 54 cost time: 0.6186878681182861
Epoch: 54, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 55 cost time: 0.6410493850708008
Epoch: 55, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 56 cost time: 0.816270112991333
Epoch: 56, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 57 cost time: 0.6068563461303711
Epoch: 57, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 58 cost time: 0.6236100196838379
Epoch: 58, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 59 cost time: 0.7521283626556396
Epoch: 59, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 60 cost time: 0.677117109298706
Epoch: 60, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 61 cost time: 0.7085323333740234
Epoch: 61, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 62 cost time: 0.7660064697265625
Epoch: 62, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 63 cost time: 0.6403679847717285
Epoch: 63, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 64 cost time: 0.6265223026275635
Epoch: 64, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 65 cost time: 0.6516125202178955
Epoch: 65, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 66 cost time: 0.7239241600036621
Epoch: 66, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 67 cost time: 0.740835428237915
Epoch: 67, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.6780591011047363
Epoch: 68, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.7130804061889648
Epoch: 69, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.702357292175293
Epoch: 70, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.7953634262084961
Epoch: 71, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.8410735130310059
Epoch: 72, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.7012877464294434
Epoch: 73, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.7048962116241455
Epoch: 74, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 75 cost time: 0.743851900100708
Epoch: 75, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6894030570983887
Epoch: 76, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.81618332862854
Epoch: 77, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.7349584102630615
Epoch: 78, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 79 cost time: 0.9385905265808105
Epoch: 79, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 80 cost time: 0.7836313247680664
Epoch: 80, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 81 cost time: 0.8246705532073975
Epoch: 81, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 82 cost time: 0.7903857231140137
Epoch: 82, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 83 cost time: 0.6631758213043213
Epoch: 83, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 84 cost time: 0.6641178131103516
Epoch: 84, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 85 cost time: 0.7464666366577148
Epoch: 85, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 86 cost time: 0.8518779277801514
Epoch: 86, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 87 cost time: 0.8407695293426514
Epoch: 87, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 88 cost time: 0.8024294376373291
Epoch: 88, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.7187085151672363
Epoch: 89, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.9582338333129883
Epoch: 90, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.6507134437561035
Epoch: 91, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 92 cost time: 0.7238903045654297
Epoch: 92, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 93 cost time: 0.7429039478302002
Epoch: 93, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 94 cost time: 0.8230206966400146
Epoch: 94, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 95 cost time: 0.7282428741455078
Epoch: 95, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 96 cost time: 0.8676517009735107
Epoch: 96, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 97 cost time: 0.7252459526062012
Epoch: 97, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 513194
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3182215690612793
Epoch: 1, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.784 Vali Acc: 0.263 Test Loss: 1.784 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 0.7868843078613281
Epoch: 2, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.765 Vali Acc: 0.289 Test Loss: 1.765 Test Acc: 0.289
Validation loss decreased (-0.262945 --> -0.288871).  Saving model ...
Epoch: 3 cost time: 0.6260390281677246
Epoch: 3, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.747 Vali Acc: 0.307 Test Loss: 1.747 Test Acc: 0.307
Validation loss decreased (-0.288871 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 0.7627010345458984
Epoch: 4, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.726 Vali Acc: 0.337 Test Loss: 1.726 Test Acc: 0.337
Validation loss decreased (-0.307390 --> -0.337020).  Saving model ...
Epoch: 5 cost time: 0.7365610599517822
Epoch: 5, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.701 Vali Acc: 0.385 Test Loss: 1.701 Test Acc: 0.385
Validation loss decreased (-0.337020 --> -0.385168).  Saving model ...
Epoch: 6 cost time: 0.6471142768859863
Epoch: 6, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.675 Vali Acc: 0.400 Test Loss: 1.675 Test Acc: 0.400
Validation loss decreased (-0.385168 --> -0.399983).  Saving model ...
Epoch: 7 cost time: 0.90830397605896
Epoch: 7, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.647 Vali Acc: 0.415 Test Loss: 1.647 Test Acc: 0.415
Validation loss decreased (-0.399983 --> -0.414798).  Saving model ...
Epoch: 8 cost time: 0.6647610664367676
Epoch: 8, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.618 Vali Acc: 0.452 Test Loss: 1.618 Test Acc: 0.452
Validation loss decreased (-0.414798 --> -0.451836).  Saving model ...
Epoch: 9 cost time: 0.7213819026947021
Epoch: 9, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.587 Vali Acc: 0.474 Test Loss: 1.587 Test Acc: 0.474
Validation loss decreased (-0.451836 --> -0.474058).  Saving model ...
Epoch: 10 cost time: 0.7964010238647461
Epoch: 10, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.552 Vali Acc: 0.496 Test Loss: 1.552 Test Acc: 0.496
Validation loss decreased (-0.474058 --> -0.496281).  Saving model ...
Epoch: 11 cost time: 0.7998435497283936
Epoch: 11, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.515 Vali Acc: 0.519 Test Loss: 1.515 Test Acc: 0.519
Validation loss decreased (-0.496281 --> -0.518503).  Saving model ...
Epoch: 12 cost time: 0.8436360359191895
Epoch: 12, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.477 Vali Acc: 0.548 Test Loss: 1.477 Test Acc: 0.548
Validation loss decreased (-0.518503 --> -0.548133).  Saving model ...
Epoch: 13 cost time: 0.724259614944458
Epoch: 13, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.435 Vali Acc: 0.593 Test Loss: 1.435 Test Acc: 0.593
Validation loss decreased (-0.548133 --> -0.592578).  Saving model ...
Epoch: 14 cost time: 0.6127643585205078
Epoch: 14, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.389 Vali Acc: 0.667 Test Loss: 1.389 Test Acc: 0.667
Validation loss decreased (-0.592578 --> -0.666653).  Saving model ...
Epoch: 15 cost time: 0.7334423065185547
Epoch: 15, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.340 Vali Acc: 0.711 Test Loss: 1.340 Test Acc: 0.711
Validation loss decreased (-0.666653 --> -0.711098).  Saving model ...
Epoch: 16 cost time: 0.9091839790344238
Epoch: 16, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.290 Vali Acc: 0.722 Test Loss: 1.290 Test Acc: 0.722
Validation loss decreased (-0.711098 --> -0.722209).  Saving model ...
Epoch: 17 cost time: 0.9323554039001465
Epoch: 17, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.241 Vali Acc: 0.759 Test Loss: 1.241 Test Acc: 0.759
Validation loss decreased (-0.722209 --> -0.759247).  Saving model ...
Epoch: 18 cost time: 0.7991673946380615
Epoch: 18, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.191 Vali Acc: 0.770 Test Loss: 1.191 Test Acc: 0.770
Validation loss decreased (-0.759247 --> -0.770358).  Saving model ...
Epoch: 19 cost time: 0.6930599212646484
Epoch: 19, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.140 Vali Acc: 0.778 Test Loss: 1.140 Test Acc: 0.778
Validation loss decreased (-0.770358 --> -0.777766).  Saving model ...
Epoch: 20 cost time: 0.9518709182739258
Epoch: 20, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.089 Vali Acc: 0.796 Test Loss: 1.089 Test Acc: 0.796
Validation loss decreased (-0.777766 --> -0.796285).  Saving model ...
Epoch: 21 cost time: 0.7963886260986328
Epoch: 21, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.036 Vali Acc: 0.800 Test Loss: 1.036 Test Acc: 0.800
Validation loss decreased (-0.796285 --> -0.799990).  Saving model ...
Epoch: 22 cost time: 0.9076220989227295
Epoch: 22, Steps: 2 | Train Loss: 0.900 Vali Loss: 0.981 Vali Acc: 0.826 Test Loss: 0.981 Test Acc: 0.826
Validation loss decreased (-0.799990 --> -0.825916).  Saving model ...
Epoch: 23 cost time: 0.9595034122467041
Epoch: 23, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.927 Vali Acc: 0.841 Test Loss: 0.927 Test Acc: 0.841
Validation loss decreased (-0.825916 --> -0.840731).  Saving model ...
Epoch: 24 cost time: 0.8455395698547363
Epoch: 24, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.872 Vali Acc: 0.848 Test Loss: 0.872 Test Acc: 0.848
Validation loss decreased (-0.840731 --> -0.848139).  Saving model ...
Epoch: 25 cost time: 0.671900749206543
Epoch: 25, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.818 Vali Acc: 0.867 Test Loss: 0.818 Test Acc: 0.867
Validation loss decreased (-0.848139 --> -0.866658).  Saving model ...
Epoch: 26 cost time: 0.8070175647735596
Epoch: 26, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.767 Vali Acc: 0.881 Test Loss: 0.767 Test Acc: 0.881
Validation loss decreased (-0.866658 --> -0.881474).  Saving model ...
Epoch: 27 cost time: 0.6710615158081055
Epoch: 27, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.721 Vali Acc: 0.896 Test Loss: 0.721 Test Acc: 0.896
Validation loss decreased (-0.881474 --> -0.896289).  Saving model ...
Epoch: 28 cost time: 0.6669273376464844
Epoch: 28, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.674 Vali Acc: 0.922 Test Loss: 0.674 Test Acc: 0.922
Validation loss decreased (-0.896289 --> -0.922215).  Saving model ...
Epoch: 29 cost time: 0.6848719120025635
Epoch: 29, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.632 Vali Acc: 0.919 Test Loss: 0.632 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.741227388381958
Epoch: 30, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.590 Vali Acc: 0.930 Test Loss: 0.590 Test Acc: 0.930
Validation loss decreased (-0.922215 --> -0.929624).  Saving model ...
Epoch: 31 cost time: 0.617746114730835
Epoch: 31, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.554 Vali Acc: 0.933 Test Loss: 0.554 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 32 cost time: 0.8242630958557129
Epoch: 32, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.520 Vali Acc: 0.937 Test Loss: 0.520 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 33 cost time: 0.7202136516571045
Epoch: 33, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.487 Vali Acc: 0.941 Test Loss: 0.487 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 34 cost time: 0.6481008529663086
Epoch: 34, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.458 Vali Acc: 0.933 Test Loss: 0.458 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7147305011749268
Epoch: 35, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.432 Vali Acc: 0.937 Test Loss: 0.432 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.9384722709655762
Epoch: 36, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.410 Vali Acc: 0.944 Test Loss: 0.410 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 37 cost time: 0.6655669212341309
Epoch: 37, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.390 Vali Acc: 0.944 Test Loss: 0.390 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 38 cost time: 0.8350734710693359
Epoch: 38, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.373 Vali Acc: 0.952 Test Loss: 0.373 Test Acc: 0.952
Validation loss decreased (-0.944441 --> -0.951848).  Saving model ...
Epoch: 39 cost time: 0.7082991600036621
Epoch: 39, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.358 Vali Acc: 0.956 Test Loss: 0.358 Test Acc: 0.956
Validation loss decreased (-0.951848 --> -0.955552).  Saving model ...
Epoch: 40 cost time: 0.9543812274932861
Epoch: 40, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.344 Vali Acc: 0.956 Test Loss: 0.344 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 41 cost time: 0.6121046543121338
Epoch: 41, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.331 Vali Acc: 0.956 Test Loss: 0.331 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 42 cost time: 0.878594160079956
Epoch: 42, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.320 Vali Acc: 0.956 Test Loss: 0.320 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 43 cost time: 0.8727030754089355
Epoch: 43, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.308 Vali Acc: 0.952 Test Loss: 0.308 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8507809638977051
Epoch: 44, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.299 Vali Acc: 0.948 Test Loss: 0.299 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6110146045684814
Epoch: 45, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.289 Vali Acc: 0.952 Test Loss: 0.289 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7376105785369873
Epoch: 46, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.281 Vali Acc: 0.956 Test Loss: 0.281 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.7977104187011719
Epoch: 47, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.274 Vali Acc: 0.956 Test Loss: 0.274 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 48 cost time: 0.8555889129638672
Epoch: 48, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.268 Vali Acc: 0.956 Test Loss: 0.268 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 49 cost time: 0.8245506286621094
Epoch: 49, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.264 Vali Acc: 0.952 Test Loss: 0.264 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6692824363708496
Epoch: 50, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.262 Vali Acc: 0.952 Test Loss: 0.262 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.6253197193145752
Epoch: 51, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.259 Vali Acc: 0.956 Test Loss: 0.259 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 52 cost time: 0.8537232875823975
Epoch: 52, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.256 Vali Acc: 0.956 Test Loss: 0.256 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 53 cost time: 0.7721834182739258
Epoch: 53, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.8919308185577393
Epoch: 54, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.7853865623474121
Epoch: 55, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.239 Vali Acc: 0.952 Test Loss: 0.239 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.6367998123168945
Epoch: 56, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.233 Vali Acc: 0.956 Test Loss: 0.233 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 57 cost time: 0.733473539352417
Epoch: 57, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.229 Vali Acc: 0.956 Test Loss: 0.229 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 58 cost time: 0.7797279357910156
Epoch: 58, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.225 Vali Acc: 0.956 Test Loss: 0.225 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 59 cost time: 0.8238348960876465
Epoch: 59, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.223 Vali Acc: 0.956 Test Loss: 0.223 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 60 cost time: 0.8273065090179443
Epoch: 60, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.222 Vali Acc: 0.956 Test Loss: 0.222 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 61 cost time: 0.7264306545257568
Epoch: 61, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.220 Vali Acc: 0.956 Test Loss: 0.220 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 62 cost time: 0.7123935222625732
Epoch: 62, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.219 Vali Acc: 0.952 Test Loss: 0.219 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6415131092071533
Epoch: 63, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.219 Vali Acc: 0.952 Test Loss: 0.219 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.7930238246917725
Epoch: 64, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.9173924922943115
Epoch: 65, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.212 Vali Acc: 0.956 Test Loss: 0.212 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 66 cost time: 0.7168653011322021
Epoch: 66, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 67 cost time: 0.7355139255523682
Epoch: 67, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.206 Vali Acc: 0.959 Test Loss: 0.206 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 68 cost time: 0.780756950378418
Epoch: 68, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 69 cost time: 0.770256519317627
Epoch: 69, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 70 cost time: 0.6221218109130859
Epoch: 70, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.7922415733337402
Epoch: 71, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.7569279670715332
Epoch: 72, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.8451313972473145
Epoch: 73, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.7375471591949463
Epoch: 74, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.8159050941467285
Epoch: 75, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.845571756362915
Epoch: 76, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.9390056133270264
Epoch: 77, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.7877404689788818
Epoch: 78, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.6746902465820312
Epoch: 79, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 512618
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.748236656188965
Epoch: 1, Steps: 2 | Train Loss: 1.985 Vali Loss: 1.947 Vali Acc: 0.170 Test Loss: 1.947 Test Acc: 0.170
Validation loss decreased (inf --> -0.170351).  Saving model ...
Epoch: 2 cost time: 0.739008903503418
Epoch: 2, Steps: 2 | Train Loss: 1.984 Vali Loss: 1.885 Vali Acc: 0.178 Test Loss: 1.885 Test Acc: 0.178
Validation loss decreased (-0.170351 --> -0.177759).  Saving model ...
Epoch: 3 cost time: 0.808037281036377
Epoch: 3, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.838 Vali Acc: 0.185 Test Loss: 1.838 Test Acc: 0.185
Validation loss decreased (-0.177759 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 0.7858519554138184
Epoch: 4, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.788 Vali Acc: 0.189 Test Loss: 1.788 Test Acc: 0.189
Validation loss decreased (-0.185167 --> -0.188871).  Saving model ...
Epoch: 5 cost time: 0.690575361251831
Epoch: 5, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.734 Vali Acc: 0.211 Test Loss: 1.734 Test Acc: 0.211
Validation loss decreased (-0.188871 --> -0.211094).  Saving model ...
Epoch: 6 cost time: 0.7955982685089111
Epoch: 6, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.686 Vali Acc: 0.230 Test Loss: 1.686 Test Acc: 0.230
Validation loss decreased (-0.211094 --> -0.229613).  Saving model ...
Epoch: 7 cost time: 0.7791602611541748
Epoch: 7, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.642 Vali Acc: 0.296 Test Loss: 1.642 Test Acc: 0.296
Validation loss decreased (-0.229613 --> -0.296280).  Saving model ...
Epoch: 8 cost time: 0.707874059677124
Epoch: 8, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.607 Vali Acc: 0.448 Test Loss: 1.607 Test Acc: 0.448
Validation loss decreased (-0.296280 --> -0.448132).  Saving model ...
Epoch: 9 cost time: 0.703427791595459
Epoch: 9, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.579 Vali Acc: 0.470 Test Loss: 1.579 Test Acc: 0.470
Validation loss decreased (-0.448132 --> -0.470355).  Saving model ...
Epoch: 10 cost time: 0.6562268733978271
Epoch: 10, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.552 Vali Acc: 0.496 Test Loss: 1.552 Test Acc: 0.496
Validation loss decreased (-0.470355 --> -0.496281).  Saving model ...
Epoch: 11 cost time: 0.9175879955291748
Epoch: 11, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.523 Vali Acc: 0.526 Test Loss: 1.523 Test Acc: 0.526
Validation loss decreased (-0.496281 --> -0.525911).  Saving model ...
Epoch: 12 cost time: 0.8718197345733643
Epoch: 12, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.487 Vali Acc: 0.541 Test Loss: 1.487 Test Acc: 0.541
Validation loss decreased (-0.525911 --> -0.540726).  Saving model ...
Epoch: 13 cost time: 0.6995477676391602
Epoch: 13, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.446 Vali Acc: 0.574 Test Loss: 1.446 Test Acc: 0.574
Validation loss decreased (-0.540726 --> -0.574060).  Saving model ...
Epoch: 14 cost time: 0.6298964023590088
Epoch: 14, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.398 Vali Acc: 0.596 Test Loss: 1.398 Test Acc: 0.596
Validation loss decreased (-0.574060 --> -0.596282).  Saving model ...
Epoch: 15 cost time: 0.7464447021484375
Epoch: 15, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.346 Vali Acc: 0.644 Test Loss: 1.346 Test Acc: 0.644
Validation loss decreased (-0.596282 --> -0.644431).  Saving model ...
Epoch: 16 cost time: 0.6246340274810791
Epoch: 16, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.292 Vali Acc: 0.700 Test Loss: 1.292 Test Acc: 0.700
Validation loss decreased (-0.644431 --> -0.699987).  Saving model ...
Epoch: 17 cost time: 0.6875436305999756
Epoch: 17, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.237 Vali Acc: 0.726 Test Loss: 1.237 Test Acc: 0.726
Validation loss decreased (-0.699987 --> -0.725914).  Saving model ...
Epoch: 18 cost time: 0.8174264430999756
Epoch: 18, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.185 Vali Acc: 0.796 Test Loss: 1.185 Test Acc: 0.796
Validation loss decreased (-0.725914 --> -0.796284).  Saving model ...
Epoch: 19 cost time: 0.9321479797363281
Epoch: 19, Steps: 2 | Train Loss: 1.076 Vali Loss: 1.134 Vali Acc: 0.807 Test Loss: 1.134 Test Acc: 0.807
Validation loss decreased (-0.796284 --> -0.807396).  Saving model ...
Epoch: 20 cost time: 1.0272464752197266
Epoch: 20, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.086 Vali Acc: 0.789 Test Loss: 1.086 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7277543544769287
Epoch: 21, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.035 Vali Acc: 0.796 Test Loss: 1.035 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6739187240600586
Epoch: 22, Steps: 2 | Train Loss: 0.951 Vali Loss: 0.981 Vali Acc: 0.830 Test Loss: 0.981 Test Acc: 0.830
Validation loss decreased (-0.807396 --> -0.829620).  Saving model ...
Epoch: 23 cost time: 0.7784979343414307
Epoch: 23, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.927 Vali Acc: 0.852 Test Loss: 0.927 Test Acc: 0.852
Validation loss decreased (-0.829620 --> -0.851843).  Saving model ...
Epoch: 24 cost time: 0.7813539505004883
Epoch: 24, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.874 Vali Acc: 0.889 Test Loss: 0.874 Test Acc: 0.889
Validation loss decreased (-0.851843 --> -0.888880).  Saving model ...
Epoch: 25 cost time: 0.7405931949615479
Epoch: 25, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.823 Vali Acc: 0.881 Test Loss: 0.823 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8738453388214111
Epoch: 26, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.772 Vali Acc: 0.881 Test Loss: 0.772 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6633923053741455
Epoch: 27, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.723 Vali Acc: 0.893 Test Loss: 0.723 Test Acc: 0.893
Validation loss decreased (-0.888880 --> -0.892585).  Saving model ...
Epoch: 28 cost time: 0.7913012504577637
Epoch: 28, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.677 Vali Acc: 0.907 Test Loss: 0.677 Test Acc: 0.907
Validation loss decreased (-0.892585 --> -0.907401).  Saving model ...
Epoch: 29 cost time: 0.7374420166015625
Epoch: 29, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.634 Vali Acc: 0.915 Test Loss: 0.634 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914808).  Saving model ...
Epoch: 30 cost time: 0.6774282455444336
Epoch: 30, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.594 Vali Acc: 0.911 Test Loss: 0.594 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7352232933044434
Epoch: 31, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.557 Vali Acc: 0.915 Test Loss: 0.557 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 32 cost time: 0.8288044929504395
Epoch: 32, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.527 Vali Acc: 0.915 Test Loss: 0.527 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914810).  Saving model ...
Epoch: 33 cost time: 0.8344907760620117
Epoch: 33, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.499 Vali Acc: 0.911 Test Loss: 0.499 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.794241189956665
Epoch: 34, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.474 Vali Acc: 0.911 Test Loss: 0.474 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.87424635887146
Epoch: 35, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.451 Vali Acc: 0.911 Test Loss: 0.451 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6843299865722656
Epoch: 36, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.430 Vali Acc: 0.911 Test Loss: 0.430 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6984388828277588
Epoch: 37, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.408 Vali Acc: 0.919 Test Loss: 0.408 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 38 cost time: 0.8325197696685791
Epoch: 38, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.386 Vali Acc: 0.933 Test Loss: 0.386 Test Acc: 0.933
Validation loss decreased (-0.918514 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 0.7755491733551025
Epoch: 39, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.367 Vali Acc: 0.933 Test Loss: 0.367 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 40 cost time: 1.054218053817749
Epoch: 40, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.353 Vali Acc: 0.937 Test Loss: 0.353 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.7405228614807129
Epoch: 41, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.338 Vali Acc: 0.937 Test Loss: 0.338 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 0.8054780960083008
Epoch: 42, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.325 Vali Acc: 0.937 Test Loss: 0.325 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 43 cost time: 0.7768809795379639
Epoch: 43, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.315 Vali Acc: 0.937 Test Loss: 0.315 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 44 cost time: 0.8164100646972656
Epoch: 44, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.305 Vali Acc: 0.933 Test Loss: 0.305 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.9210562705993652
Epoch: 45, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.298 Vali Acc: 0.930 Test Loss: 0.298 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6529695987701416
Epoch: 46, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.290 Vali Acc: 0.926 Test Loss: 0.290 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.68251633644104
Epoch: 47, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7119593620300293
Epoch: 48, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.282 Vali Acc: 0.926 Test Loss: 0.282 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6259522438049316
Epoch: 49, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7622835636138916
Epoch: 50, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.270 Vali Acc: 0.926 Test Loss: 0.270 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.6531736850738525
Epoch: 51, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.693681001663208
Epoch: 52, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.9011893272399902
Epoch: 53, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 512042
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.588674306869507
Epoch: 1, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.889 Vali Acc: 0.119 Test Loss: 1.889 Test Acc: 0.119
Validation loss decreased (inf --> -0.118500).  Saving model ...
Epoch: 2 cost time: 0.7533135414123535
Epoch: 2, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.856 Vali Acc: 0.111 Test Loss: 1.856 Test Acc: 0.111
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6985340118408203
Epoch: 3, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.828 Vali Acc: 0.144 Test Loss: 1.828 Test Acc: 0.144
Validation loss decreased (-0.118500 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 0.7528700828552246
Epoch: 4, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.798 Vali Acc: 0.159 Test Loss: 1.798 Test Acc: 0.159
Validation loss decreased (-0.144426 --> -0.159241).  Saving model ...
Epoch: 5 cost time: 0.7670712471008301
Epoch: 5, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.764 Vali Acc: 0.189 Test Loss: 1.764 Test Acc: 0.189
Validation loss decreased (-0.159241 --> -0.188871).  Saving model ...
Epoch: 6 cost time: 0.6830244064331055
Epoch: 6, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.728 Vali Acc: 0.248 Test Loss: 1.728 Test Acc: 0.248
Validation loss decreased (-0.188871 --> -0.248131).  Saving model ...
Epoch: 7 cost time: 0.7144045829772949
Epoch: 7, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.691 Vali Acc: 0.296 Test Loss: 1.691 Test Acc: 0.296
Validation loss decreased (-0.248131 --> -0.296279).  Saving model ...
Epoch: 8 cost time: 0.7616627216339111
Epoch: 8, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.656 Vali Acc: 0.333 Test Loss: 1.656 Test Acc: 0.333
Validation loss decreased (-0.296279 --> -0.333317).  Saving model ...
Epoch: 9 cost time: 0.7284786701202393
Epoch: 9, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.622 Vali Acc: 0.463 Test Loss: 1.622 Test Acc: 0.463
Validation loss decreased (-0.333317 --> -0.462947).  Saving model ...
Epoch: 10 cost time: 0.7212123870849609
Epoch: 10, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.587 Vali Acc: 0.544 Test Loss: 1.587 Test Acc: 0.544
Validation loss decreased (-0.462947 --> -0.544429).  Saving model ...
Epoch: 11 cost time: 0.9070019721984863
Epoch: 11, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.553 Vali Acc: 0.578 Test Loss: 1.553 Test Acc: 0.578
Validation loss decreased (-0.544429 --> -0.577762).  Saving model ...
Epoch: 12 cost time: 0.6613352298736572
Epoch: 12, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.519 Vali Acc: 0.578 Test Loss: 1.519 Test Acc: 0.578
Validation loss decreased (-0.577762 --> -0.577763).  Saving model ...
Epoch: 13 cost time: 0.6551826000213623
Epoch: 13, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.483 Vali Acc: 0.581 Test Loss: 1.483 Test Acc: 0.581
Validation loss decreased (-0.577763 --> -0.581467).  Saving model ...
Epoch: 14 cost time: 0.7202098369598389
Epoch: 14, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.443 Vali Acc: 0.596 Test Loss: 1.443 Test Acc: 0.596
Validation loss decreased (-0.581467 --> -0.596282).  Saving model ...
Epoch: 15 cost time: 1.1717021465301514
Epoch: 15, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.400 Vali Acc: 0.644 Test Loss: 1.400 Test Acc: 0.644
Validation loss decreased (-0.596282 --> -0.644430).  Saving model ...
Epoch: 16 cost time: 0.6978669166564941
Epoch: 16, Steps: 2 | Train Loss: 1.376 Vali Loss: 1.356 Vali Acc: 0.681 Test Loss: 1.356 Test Acc: 0.681
Validation loss decreased (-0.644430 --> -0.681468).  Saving model ...
Epoch: 17 cost time: 0.8129260540008545
Epoch: 17, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.311 Vali Acc: 0.730 Test Loss: 1.311 Test Acc: 0.730
Validation loss decreased (-0.681468 --> -0.729617).  Saving model ...
Epoch: 18 cost time: 0.860851526260376
Epoch: 18, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.263 Vali Acc: 0.767 Test Loss: 1.263 Test Acc: 0.767
Validation loss decreased (-0.729617 --> -0.766654).  Saving model ...
Epoch: 19 cost time: 0.6649336814880371
Epoch: 19, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.214 Vali Acc: 0.804 Test Loss: 1.214 Test Acc: 0.804
Validation loss decreased (-0.766654 --> -0.803692).  Saving model ...
Epoch: 20 cost time: 0.8783755302429199
Epoch: 20, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.162 Vali Acc: 0.811 Test Loss: 1.162 Test Acc: 0.811
Validation loss decreased (-0.803692 --> -0.811099).  Saving model ...
Epoch: 21 cost time: 0.7263059616088867
Epoch: 21, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.107 Vali Acc: 0.837 Test Loss: 1.107 Test Acc: 0.837
Validation loss decreased (-0.811099 --> -0.837026).  Saving model ...
Epoch: 22 cost time: 0.740471601486206
Epoch: 22, Steps: 2 | Train Loss: 0.953 Vali Loss: 1.052 Vali Acc: 0.859 Test Loss: 1.052 Test Acc: 0.859
Validation loss decreased (-0.837026 --> -0.859249).  Saving model ...
Epoch: 23 cost time: 0.8356740474700928
Epoch: 23, Steps: 2 | Train Loss: 0.969 Vali Loss: 0.998 Vali Acc: 0.852 Test Loss: 0.998 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7213311195373535
Epoch: 24, Steps: 2 | Train Loss: 0.944 Vali Loss: 0.943 Vali Acc: 0.852 Test Loss: 0.943 Test Acc: 0.852
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8282153606414795
Epoch: 25, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.893 Vali Acc: 0.848 Test Loss: 0.893 Test Acc: 0.848
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7418148517608643
Epoch: 26, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.842 Vali Acc: 0.859 Test Loss: 0.842 Test Acc: 0.859
Validation loss decreased (-0.859249 --> -0.859251).  Saving model ...
Epoch: 27 cost time: 0.7500717639923096
Epoch: 27, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.793 Vali Acc: 0.881 Test Loss: 0.793 Test Acc: 0.881
Validation loss decreased (-0.859251 --> -0.881474).  Saving model ...
Epoch: 28 cost time: 0.9703872203826904
Epoch: 28, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.747 Vali Acc: 0.900 Test Loss: 0.747 Test Acc: 0.900
Validation loss decreased (-0.881474 --> -0.899993).  Saving model ...
Epoch: 29 cost time: 0.7845511436462402
Epoch: 29, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.702 Vali Acc: 0.911 Test Loss: 0.702 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.911104).  Saving model ...
Epoch: 30 cost time: 0.7891712188720703
Epoch: 30, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.661 Vali Acc: 0.926 Test Loss: 0.661 Test Acc: 0.926
Validation loss decreased (-0.911104 --> -0.925919).  Saving model ...
Epoch: 31 cost time: 0.756227970123291
Epoch: 31, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.622 Vali Acc: 0.937 Test Loss: 0.622 Test Acc: 0.937
Validation loss decreased (-0.925919 --> -0.937031).  Saving model ...
Epoch: 32 cost time: 0.771669864654541
Epoch: 32, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.587 Vali Acc: 0.911 Test Loss: 0.587 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0349628925323486
Epoch: 33, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.553 Vali Acc: 0.937 Test Loss: 0.553 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 34 cost time: 0.8507640361785889
Epoch: 34, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.522 Vali Acc: 0.937 Test Loss: 0.522 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 35 cost time: 0.7955160140991211
Epoch: 35, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.494 Vali Acc: 0.937 Test Loss: 0.494 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 36 cost time: 0.9310708045959473
Epoch: 36, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.468 Vali Acc: 0.937 Test Loss: 0.468 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 37 cost time: 0.9224433898925781
Epoch: 37, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.445 Vali Acc: 0.944 Test Loss: 0.445 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944440).  Saving model ...
Epoch: 38 cost time: 0.8652048110961914
Epoch: 38, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.425 Vali Acc: 0.944 Test Loss: 0.425 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 39 cost time: 0.7845232486724854
Epoch: 39, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.406 Vali Acc: 0.944 Test Loss: 0.406 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 40 cost time: 0.9612216949462891
Epoch: 40, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.392 Vali Acc: 0.941 Test Loss: 0.392 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8655712604522705
Epoch: 41, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.378 Vali Acc: 0.941 Test Loss: 0.378 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8639898300170898
Epoch: 42, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.364 Vali Acc: 0.941 Test Loss: 0.364 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.9282631874084473
Epoch: 43, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.352 Vali Acc: 0.941 Test Loss: 0.352 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7671768665313721
Epoch: 44, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.338 Vali Acc: 0.944 Test Loss: 0.338 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 45 cost time: 0.8792099952697754
Epoch: 45, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.326 Vali Acc: 0.948 Test Loss: 0.326 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 46 cost time: 0.8562238216400146
Epoch: 46, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.315 Vali Acc: 0.948 Test Loss: 0.315 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 47 cost time: 0.8303987979888916
Epoch: 47, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.305 Vali Acc: 0.948 Test Loss: 0.305 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 48 cost time: 0.8994121551513672
Epoch: 48, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.296 Vali Acc: 0.952 Test Loss: 0.296 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 49 cost time: 0.6904745101928711
Epoch: 49, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.288 Vali Acc: 0.952 Test Loss: 0.288 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 50 cost time: 0.7671999931335449
Epoch: 50, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.283 Vali Acc: 0.952 Test Loss: 0.283 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 51 cost time: 0.8410470485687256
Epoch: 51, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.278 Vali Acc: 0.948 Test Loss: 0.278 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7253777980804443
Epoch: 52, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.272 Vali Acc: 0.952 Test Loss: 0.272 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 53 cost time: 0.667064905166626
Epoch: 53, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.267 Vali Acc: 0.952 Test Loss: 0.267 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 54 cost time: 0.7134349346160889
Epoch: 54, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.265 Vali Acc: 0.948 Test Loss: 0.265 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.7384450435638428
Epoch: 55, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.260 Vali Acc: 0.948 Test Loss: 0.260 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8589422702789307
Epoch: 56, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.256 Vali Acc: 0.948 Test Loss: 0.256 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 1.0147781372070312
Epoch: 57, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.251 Vali Acc: 0.952 Test Loss: 0.251 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 58 cost time: 0.8436288833618164
Epoch: 58, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.249 Vali Acc: 0.952 Test Loss: 0.249 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 59 cost time: 0.8229081630706787
Epoch: 59, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 60 cost time: 0.760953426361084
Epoch: 60, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.241 Vali Acc: 0.952 Test Loss: 0.241 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 61 cost time: 0.7930333614349365
Epoch: 61, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.239 Vali Acc: 0.952 Test Loss: 0.239 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 62 cost time: 0.7550325393676758
Epoch: 62, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.238 Vali Acc: 0.952 Test Loss: 0.238 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 63 cost time: 0.6992428302764893
Epoch: 63, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.234 Vali Acc: 0.952 Test Loss: 0.234 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 64 cost time: 0.7819850444793701
Epoch: 64, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 65 cost time: 0.8410911560058594
Epoch: 65, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.230 Vali Acc: 0.952 Test Loss: 0.230 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 66 cost time: 0.7454373836517334
Epoch: 66, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.228 Vali Acc: 0.952 Test Loss: 0.228 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 67 cost time: 0.6235218048095703
Epoch: 67, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 68 cost time: 0.6983752250671387
Epoch: 68, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.223 Vali Acc: 0.952 Test Loss: 0.223 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 69 cost time: 0.7349915504455566
Epoch: 69, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 70 cost time: 0.6263346672058105
Epoch: 70, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 71 cost time: 0.6904397010803223
Epoch: 71, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.213 Vali Acc: 0.952 Test Loss: 0.213 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 72 cost time: 0.7682144641876221
Epoch: 72, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 73 cost time: 0.7849552631378174
Epoch: 73, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 74 cost time: 0.7106695175170898
Epoch: 74, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 75 cost time: 0.6671435832977295
Epoch: 75, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 76 cost time: 0.8178224563598633
Epoch: 76, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 77 cost time: 0.6928985118865967
Epoch: 77, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.6723976135253906
Epoch: 78, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 79 cost time: 0.7380614280700684
Epoch: 79, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.8485209941864014
Epoch: 80, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.6481113433837891
Epoch: 81, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.204 Vali Acc: 0.956 Test Loss: 0.204 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.720961332321167
Epoch: 82, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.784752368927002
Epoch: 83, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 84 cost time: 0.7307653427124023
Epoch: 84, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 85 cost time: 1.1284315586090088
Epoch: 85, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 86 cost time: 0.768169641494751
Epoch: 86, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 87 cost time: 0.7206580638885498
Epoch: 87, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 88 cost time: 0.8003957271575928
Epoch: 88, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 431210
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.747620105743408
Epoch: 1, Steps: 2 | Train Loss: 2.026 Vali Loss: 1.980 Vali Acc: 0.170 Test Loss: 1.980 Test Acc: 0.170
Validation loss decreased (inf --> -0.170351).  Saving model ...
Epoch: 2 cost time: 0.628462553024292
Epoch: 2, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.943 Vali Acc: 0.174 Test Loss: 1.943 Test Acc: 0.174
Validation loss decreased (-0.170351 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 0.627166748046875
Epoch: 3, Steps: 2 | Train Loss: 1.963 Vali Loss: 1.912 Vali Acc: 0.185 Test Loss: 1.912 Test Acc: 0.185
Validation loss decreased (-0.174055 --> -0.185166).  Saving model ...
Epoch: 4 cost time: 0.8520536422729492
Epoch: 4, Steps: 2 | Train Loss: 1.964 Vali Loss: 1.881 Vali Acc: 0.204 Test Loss: 1.881 Test Acc: 0.204
Validation loss decreased (-0.185166 --> -0.203685).  Saving model ...
Epoch: 5 cost time: 0.7502543926239014
Epoch: 5, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.845 Vali Acc: 0.219 Test Loss: 1.845 Test Acc: 0.219
Validation loss decreased (-0.203685 --> -0.218500).  Saving model ...
Epoch: 6 cost time: 0.7512619495391846
Epoch: 6, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.807 Vali Acc: 0.244 Test Loss: 1.807 Test Acc: 0.244
Validation loss decreased (-0.218500 --> -0.244426).  Saving model ...
Epoch: 7 cost time: 0.6568117141723633
Epoch: 7, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.771 Vali Acc: 0.311 Test Loss: 1.771 Test Acc: 0.311
Validation loss decreased (-0.244426 --> -0.311093).  Saving model ...
Epoch: 8 cost time: 0.7361516952514648
Epoch: 8, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.737 Vali Acc: 0.330 Test Loss: 1.737 Test Acc: 0.330
Validation loss decreased (-0.311093 --> -0.329612).  Saving model ...
Epoch: 9 cost time: 0.8305716514587402
Epoch: 9, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.705 Vali Acc: 0.333 Test Loss: 1.705 Test Acc: 0.333
Validation loss decreased (-0.329612 --> -0.333316).  Saving model ...
Epoch: 10 cost time: 0.7147362232208252
Epoch: 10, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.673 Vali Acc: 0.319 Test Loss: 1.673 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.875504732131958
Epoch: 11, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.641 Vali Acc: 0.370 Test Loss: 1.641 Test Acc: 0.370
Validation loss decreased (-0.333316 --> -0.370354).  Saving model ...
Epoch: 12 cost time: 0.8470015525817871
Epoch: 12, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.607 Vali Acc: 0.433 Test Loss: 1.607 Test Acc: 0.433
Validation loss decreased (-0.370354 --> -0.433317).  Saving model ...
Epoch: 13 cost time: 0.7983765602111816
Epoch: 13, Steps: 2 | Train Loss: 1.572 Vali Loss: 1.572 Vali Acc: 0.504 Test Loss: 1.572 Test Acc: 0.504
Validation loss decreased (-0.433317 --> -0.503688).  Saving model ...
Epoch: 14 cost time: 0.7101719379425049
Epoch: 14, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.534 Vali Acc: 0.611 Test Loss: 1.534 Test Acc: 0.611
Validation loss decreased (-0.503688 --> -0.611096).  Saving model ...
Epoch: 15 cost time: 0.781735897064209
Epoch: 15, Steps: 2 | Train Loss: 1.510 Vali Loss: 1.494 Vali Acc: 0.707 Test Loss: 1.494 Test Acc: 0.707
Validation loss decreased (-0.611096 --> -0.707392).  Saving model ...
Epoch: 16 cost time: 0.7380516529083252
Epoch: 16, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.454 Vali Acc: 0.722 Test Loss: 1.454 Test Acc: 0.722
Validation loss decreased (-0.707392 --> -0.722208).  Saving model ...
Epoch: 17 cost time: 0.7223513126373291
Epoch: 17, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.412 Vali Acc: 0.756 Test Loss: 1.412 Test Acc: 0.756
Validation loss decreased (-0.722208 --> -0.755541).  Saving model ...
Epoch: 18 cost time: 0.8592827320098877
Epoch: 18, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.369 Vali Acc: 0.759 Test Loss: 1.369 Test Acc: 0.759
Validation loss decreased (-0.755541 --> -0.759246).  Saving model ...
Epoch: 19 cost time: 0.7749371528625488
Epoch: 19, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.323 Vali Acc: 0.774 Test Loss: 1.323 Test Acc: 0.774
Validation loss decreased (-0.759246 --> -0.774061).  Saving model ...
Epoch: 20 cost time: 1.0961198806762695
Epoch: 20, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.274 Vali Acc: 0.774 Test Loss: 1.274 Test Acc: 0.774
Validation loss decreased (-0.774061 --> -0.774061).  Saving model ...
Epoch: 21 cost time: 0.7138900756835938
Epoch: 21, Steps: 2 | Train Loss: 1.210 Vali Loss: 1.225 Vali Acc: 0.778 Test Loss: 1.225 Test Acc: 0.778
Validation loss decreased (-0.774061 --> -0.777766).  Saving model ...
Epoch: 22 cost time: 0.9932076930999756
Epoch: 22, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.173 Vali Acc: 0.800 Test Loss: 1.173 Test Acc: 0.800
Validation loss decreased (-0.777766 --> -0.799988).  Saving model ...
Epoch: 23 cost time: 0.7694907188415527
Epoch: 23, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.120 Vali Acc: 0.819 Test Loss: 1.120 Test Acc: 0.819
Validation loss decreased (-0.799988 --> -0.818507).  Saving model ...
Epoch: 24 cost time: 0.860933780670166
Epoch: 24, Steps: 2 | Train Loss: 1.027 Vali Loss: 1.065 Vali Acc: 0.848 Test Loss: 1.065 Test Acc: 0.848
Validation loss decreased (-0.818507 --> -0.848137).  Saving model ...
Epoch: 25 cost time: 0.826298713684082
Epoch: 25, Steps: 2 | Train Loss: 0.990 Vali Loss: 1.011 Vali Acc: 0.856 Test Loss: 1.011 Test Acc: 0.856
Validation loss decreased (-0.848137 --> -0.855545).  Saving model ...
Epoch: 26 cost time: 0.9251422882080078
Epoch: 26, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.959 Vali Acc: 0.874 Test Loss: 0.959 Test Acc: 0.874
Validation loss decreased (-0.855545 --> -0.874064).  Saving model ...
Epoch: 27 cost time: 0.903761625289917
Epoch: 27, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.906 Vali Acc: 0.896 Test Loss: 0.906 Test Acc: 0.896
Validation loss decreased (-0.874064 --> -0.896287).  Saving model ...
Epoch: 28 cost time: 0.77372145652771
Epoch: 28, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.856 Vali Acc: 0.904 Test Loss: 0.856 Test Acc: 0.904
Validation loss decreased (-0.896287 --> -0.903695).  Saving model ...
Epoch: 29 cost time: 0.9646437168121338
Epoch: 29, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.805 Vali Acc: 0.907 Test Loss: 0.805 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907399).  Saving model ...
Epoch: 30 cost time: 0.9072339534759521
Epoch: 30, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.758 Vali Acc: 0.904 Test Loss: 0.758 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8796710968017578
Epoch: 31, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.712 Vali Acc: 0.896 Test Loss: 0.712 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8195748329162598
Epoch: 32, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.671 Vali Acc: 0.889 Test Loss: 0.671 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1929740905761719
Epoch: 33, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.630 Vali Acc: 0.896 Test Loss: 0.630 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8905198574066162
Epoch: 34, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.593 Vali Acc: 0.896 Test Loss: 0.593 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.0513741970062256
Epoch: 35, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.558 Vali Acc: 0.904 Test Loss: 0.558 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8218080997467041
Epoch: 36, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.527 Vali Acc: 0.907 Test Loss: 0.527 Test Acc: 0.907
Validation loss decreased (-0.907399 --> -0.907402).  Saving model ...
Epoch: 37 cost time: 0.9798712730407715
Epoch: 37, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.496 Vali Acc: 0.933 Test Loss: 0.496 Test Acc: 0.933
Validation loss decreased (-0.907402 --> -0.933328).  Saving model ...
Epoch: 38 cost time: 0.9923670291900635
Epoch: 38, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.468 Vali Acc: 0.937 Test Loss: 0.468 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 39 cost time: 0.6875054836273193
Epoch: 39, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.442 Vali Acc: 0.937 Test Loss: 0.442 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 40 cost time: 0.719078540802002
Epoch: 40, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.420 Vali Acc: 0.937 Test Loss: 0.420 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 41 cost time: 0.9276502132415771
Epoch: 41, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.402 Vali Acc: 0.937 Test Loss: 0.402 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 42 cost time: 0.8072702884674072
Epoch: 42, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.386 Vali Acc: 0.937 Test Loss: 0.386 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 43 cost time: 0.6671772003173828
Epoch: 43, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.369 Vali Acc: 0.937 Test Loss: 0.369 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 44 cost time: 1.0276806354522705
Epoch: 44, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.355 Vali Acc: 0.937 Test Loss: 0.355 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 45 cost time: 0.7288529872894287
Epoch: 45, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.343 Vali Acc: 0.933 Test Loss: 0.343 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8504934310913086
Epoch: 46, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.332 Vali Acc: 0.937 Test Loss: 0.332 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 47 cost time: 0.720057487487793
Epoch: 47, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.8859267234802246
Epoch: 48, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.317 Vali Acc: 0.941 Test Loss: 0.317 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 49 cost time: 0.9397578239440918
Epoch: 49, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.312 Vali Acc: 0.941 Test Loss: 0.312 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.8952460289001465
Epoch: 50, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.307 Vali Acc: 0.941 Test Loss: 0.307 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 51 cost time: 0.9550213813781738
Epoch: 51, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.302 Vali Acc: 0.941 Test Loss: 0.302 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 52 cost time: 0.9386787414550781
Epoch: 52, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 53 cost time: 1.047996997833252
Epoch: 53, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.288 Vali Acc: 0.941 Test Loss: 0.288 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 54 cost time: 1.0212488174438477
Epoch: 54, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.284 Vali Acc: 0.941 Test Loss: 0.284 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 55 cost time: 0.9670164585113525
Epoch: 55, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.280 Vali Acc: 0.941 Test Loss: 0.280 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 56 cost time: 0.8442964553833008
Epoch: 56, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 57 cost time: 0.8579878807067871
Epoch: 57, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 58 cost time: 0.8688786029815674
Epoch: 58, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.8861186504364014
Epoch: 59, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.264 Vali Acc: 0.948 Test Loss: 0.264 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 60 cost time: 0.9231548309326172
Epoch: 60, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.259 Vali Acc: 0.948 Test Loss: 0.259 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 61 cost time: 0.8870961666107178
Epoch: 61, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 62 cost time: 0.8312275409698486
Epoch: 62, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.250 Vali Acc: 0.952 Test Loss: 0.250 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 63 cost time: 0.7223701477050781
Epoch: 63, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.247 Vali Acc: 0.956 Test Loss: 0.247 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 64 cost time: 0.8484945297241211
Epoch: 64, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.246 Vali Acc: 0.952 Test Loss: 0.246 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 1.0214359760284424
Epoch: 65, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.8634445667266846
Epoch: 66, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.246 Vali Acc: 0.948 Test Loss: 0.246 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.988764762878418
Epoch: 67, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.7993690967559814
Epoch: 68, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.8966741561889648
Epoch: 69, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.242 Vali Acc: 0.948 Test Loss: 0.242 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 1.1480743885040283
Epoch: 70, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.240 Vali Acc: 0.948 Test Loss: 0.240 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.9747874736785889
Epoch: 71, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.7922699451446533
Epoch: 72, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.235 Vali Acc: 0.952 Test Loss: 0.235 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.1380608081817627
Epoch: 73, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 430634
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.450801372528076
Epoch: 1, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.744 Vali Acc: 0.174 Test Loss: 1.744 Test Acc: 0.174
Validation loss decreased (inf --> -0.174057).  Saving model ...
Epoch: 2 cost time: 0.8775713443756104
Epoch: 2, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.713 Vali Acc: 0.178 Test Loss: 1.713 Test Acc: 0.178
Validation loss decreased (-0.174057 --> -0.177761).  Saving model ...
Epoch: 3 cost time: 0.6825389862060547
Epoch: 3, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.690 Vali Acc: 0.196 Test Loss: 1.690 Test Acc: 0.196
Validation loss decreased (-0.177761 --> -0.196279).  Saving model ...
Epoch: 4 cost time: 0.9147214889526367
Epoch: 4, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.665 Vali Acc: 0.259 Test Loss: 1.665 Test Acc: 0.259
Validation loss decreased (-0.196279 --> -0.259243).  Saving model ...
Epoch: 5 cost time: 0.8052675724029541
Epoch: 5, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.637 Vali Acc: 0.307 Test Loss: 1.637 Test Acc: 0.307
Validation loss decreased (-0.259243 --> -0.307391).  Saving model ...
Epoch: 6 cost time: 0.8664567470550537
Epoch: 6, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.608 Vali Acc: 0.407 Test Loss: 1.608 Test Acc: 0.407
Validation loss decreased (-0.307391 --> -0.407391).  Saving model ...
Epoch: 7 cost time: 0.8905630111694336
Epoch: 7, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.578 Vali Acc: 0.533 Test Loss: 1.578 Test Acc: 0.533
Validation loss decreased (-0.407391 --> -0.533318).  Saving model ...
Epoch: 8 cost time: 0.6999349594116211
Epoch: 8, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.550 Vali Acc: 0.622 Test Loss: 1.550 Test Acc: 0.622
Validation loss decreased (-0.533318 --> -0.622207).  Saving model ...
Epoch: 9 cost time: 0.8501336574554443
Epoch: 9, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.522 Vali Acc: 0.656 Test Loss: 1.522 Test Acc: 0.656
Validation loss decreased (-0.622207 --> -0.655540).  Saving model ...
Epoch: 10 cost time: 0.9677178859710693
Epoch: 10, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.494 Vali Acc: 0.667 Test Loss: 1.494 Test Acc: 0.667
Validation loss decreased (-0.655540 --> -0.666652).  Saving model ...
Epoch: 11 cost time: 0.9832549095153809
Epoch: 11, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.462 Vali Acc: 0.689 Test Loss: 1.462 Test Acc: 0.689
Validation loss decreased (-0.666652 --> -0.688874).  Saving model ...
Epoch: 12 cost time: 0.8281030654907227
Epoch: 12, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.428 Vali Acc: 0.689 Test Loss: 1.428 Test Acc: 0.689
Validation loss decreased (-0.688874 --> -0.688875).  Saving model ...
Epoch: 13 cost time: 0.9444224834442139
Epoch: 13, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.392 Vali Acc: 0.711 Test Loss: 1.392 Test Acc: 0.711
Validation loss decreased (-0.688875 --> -0.711097).  Saving model ...
Epoch: 14 cost time: 0.7369980812072754
Epoch: 14, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.354 Vali Acc: 0.748 Test Loss: 1.354 Test Acc: 0.748
Validation loss decreased (-0.711097 --> -0.748135).  Saving model ...
Epoch: 15 cost time: 1.0070524215698242
Epoch: 15, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.313 Vali Acc: 0.770 Test Loss: 1.313 Test Acc: 0.770
Validation loss decreased (-0.748135 --> -0.770357).  Saving model ...
Epoch: 16 cost time: 0.8192427158355713
Epoch: 16, Steps: 2 | Train Loss: 1.247 Vali Loss: 1.269 Vali Acc: 0.804 Test Loss: 1.269 Test Acc: 0.804
Validation loss decreased (-0.770357 --> -0.803691).  Saving model ...
Epoch: 17 cost time: 1.4814870357513428
Epoch: 17, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.224 Vali Acc: 0.837 Test Loss: 1.224 Test Acc: 0.837
Validation loss decreased (-0.803691 --> -0.837025).  Saving model ...
Epoch: 18 cost time: 0.892103910446167
Epoch: 18, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.180 Vali Acc: 0.874 Test Loss: 1.180 Test Acc: 0.874
Validation loss decreased (-0.837025 --> -0.874062).  Saving model ...
Epoch: 19 cost time: 0.6667783260345459
Epoch: 19, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.133 Vali Acc: 0.893 Test Loss: 1.133 Test Acc: 0.893
Validation loss decreased (-0.874062 --> -0.892581).  Saving model ...
Epoch: 20 cost time: 1.2226183414459229
Epoch: 20, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.087 Vali Acc: 0.885 Test Loss: 1.087 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9167630672454834
Epoch: 21, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.039 Vali Acc: 0.889 Test Loss: 1.039 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0106704235076904
Epoch: 22, Steps: 2 | Train Loss: 0.944 Vali Loss: 0.990 Vali Acc: 0.900 Test Loss: 0.990 Test Acc: 0.900
Validation loss decreased (-0.892581 --> -0.899990).  Saving model ...
Epoch: 23 cost time: 0.8266677856445312
Epoch: 23, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.941 Vali Acc: 0.900 Test Loss: 0.941 Test Acc: 0.900
Validation loss decreased (-0.899990 --> -0.899991).  Saving model ...
Epoch: 24 cost time: 0.7378640174865723
Epoch: 24, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.891 Vali Acc: 0.907 Test Loss: 0.891 Test Acc: 0.907
Validation loss decreased (-0.899991 --> -0.907398).  Saving model ...
Epoch: 25 cost time: 1.2104129791259766
Epoch: 25, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.842 Vali Acc: 0.907 Test Loss: 0.842 Test Acc: 0.907
Validation loss decreased (-0.907398 --> -0.907399).  Saving model ...
Epoch: 26 cost time: 0.8316595554351807
Epoch: 26, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.793 Vali Acc: 0.919 Test Loss: 0.793 Test Acc: 0.919
Validation loss decreased (-0.907399 --> -0.918511).  Saving model ...
Epoch: 27 cost time: 0.9181244373321533
Epoch: 27, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.746 Vali Acc: 0.919 Test Loss: 0.746 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918511).  Saving model ...
Epoch: 28 cost time: 0.741887092590332
Epoch: 28, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.701 Vali Acc: 0.922 Test Loss: 0.701 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922215).  Saving model ...
Epoch: 29 cost time: 0.7108583450317383
Epoch: 29, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.659 Vali Acc: 0.922 Test Loss: 0.659 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922216).  Saving model ...
Epoch: 30 cost time: 0.8136160373687744
Epoch: 30, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.619 Vali Acc: 0.926 Test Loss: 0.619 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 31 cost time: 1.035229206085205
Epoch: 31, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.582 Vali Acc: 0.933 Test Loss: 0.582 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 32 cost time: 0.7770793437957764
Epoch: 32, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.548 Vali Acc: 0.930 Test Loss: 0.548 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.82253098487854
Epoch: 33, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.517 Vali Acc: 0.930 Test Loss: 0.517 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.715583086013794
Epoch: 34, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.489 Vali Acc: 0.930 Test Loss: 0.489 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8287472724914551
Epoch: 35, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.463 Vali Acc: 0.941 Test Loss: 0.463 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 36 cost time: 0.6739459037780762
Epoch: 36, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.440 Vali Acc: 0.937 Test Loss: 0.440 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0834579467773438
Epoch: 37, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.421 Vali Acc: 0.941 Test Loss: 0.421 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 38 cost time: 0.8642797470092773
Epoch: 38, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.403 Vali Acc: 0.937 Test Loss: 0.403 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7871339321136475
Epoch: 39, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.387 Vali Acc: 0.937 Test Loss: 0.387 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9304695129394531
Epoch: 40, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.372 Vali Acc: 0.937 Test Loss: 0.372 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.8524487018585205
Epoch: 41, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.359 Vali Acc: 0.941 Test Loss: 0.359 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 42 cost time: 1.0068669319152832
Epoch: 42, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.347 Vali Acc: 0.937 Test Loss: 0.347 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9798591136932373
Epoch: 43, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.333 Vali Acc: 0.937 Test Loss: 0.333 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9029712677001953
Epoch: 44, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.322 Vali Acc: 0.941 Test Loss: 0.322 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.7913198471069336
Epoch: 45, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.312 Vali Acc: 0.941 Test Loss: 0.312 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.6827995777130127
Epoch: 46, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.303 Vali Acc: 0.941 Test Loss: 0.303 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.8185169696807861
Epoch: 47, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.293 Vali Acc: 0.941 Test Loss: 0.293 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.8632683753967285
Epoch: 48, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.285 Vali Acc: 0.941 Test Loss: 0.285 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 49 cost time: 0.8647027015686035
Epoch: 49, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.280 Vali Acc: 0.941 Test Loss: 0.280 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.7793185710906982
Epoch: 50, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 1.0203511714935303
Epoch: 51, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 52 cost time: 0.8212337493896484
Epoch: 52, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.266 Vali Acc: 0.941 Test Loss: 0.266 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 53 cost time: 0.7665107250213623
Epoch: 53, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 54 cost time: 0.7188968658447266
Epoch: 54, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 55 cost time: 0.750274658203125
Epoch: 55, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 56 cost time: 0.7837202548980713
Epoch: 56, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 57 cost time: 0.7621145248413086
Epoch: 57, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 58 cost time: 0.934377908706665
Epoch: 58, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 59 cost time: 0.7866942882537842
Epoch: 59, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 60 cost time: 0.7921643257141113
Epoch: 60, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 61 cost time: 0.6489150524139404
Epoch: 61, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 62 cost time: 0.7794132232666016
Epoch: 62, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 63 cost time: 0.8110992908477783
Epoch: 63, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
Validation loss decreased (-0.944442 --> -0.951850).  Saving model ...
Epoch: 64 cost time: 0.8434963226318359
Epoch: 64, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.9539375305175781
Epoch: 65, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.7158160209655762
Epoch: 66, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.9328064918518066
Epoch: 67, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.8633143901824951
Epoch: 68, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.8822803497314453
Epoch: 69, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.7040708065032959
Epoch: 70, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.7864975929260254
Epoch: 71, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.9578256607055664
Epoch: 72, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.8306670188903809
Epoch: 73, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 430058
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6585936546325684
Epoch: 1, Steps: 2 | Train Loss: 2.030 Vali Loss: 1.996 Vali Acc: 0.167 Test Loss: 1.996 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.7246499061584473
Epoch: 2, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.964 Vali Acc: 0.167 Test Loss: 1.964 Test Acc: 0.167
Validation loss decreased (-0.166647 --> -0.166647).  Saving model ...
Epoch: 3 cost time: 0.7825784683227539
Epoch: 3, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.935 Vali Acc: 0.167 Test Loss: 1.935 Test Acc: 0.167
Validation loss decreased (-0.166647 --> -0.166647).  Saving model ...
Epoch: 4 cost time: 0.9233431816101074
Epoch: 4, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.904 Vali Acc: 0.185 Test Loss: 1.904 Test Acc: 0.185
Validation loss decreased (-0.166647 --> -0.185166).  Saving model ...
Epoch: 5 cost time: 0.8386592864990234
Epoch: 5, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.868 Vali Acc: 0.189 Test Loss: 1.868 Test Acc: 0.189
Validation loss decreased (-0.185166 --> -0.188870).  Saving model ...
Epoch: 6 cost time: 0.7419915199279785
Epoch: 6, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.832 Vali Acc: 0.219 Test Loss: 1.832 Test Acc: 0.219
Validation loss decreased (-0.188870 --> -0.218500).  Saving model ...
Epoch: 7 cost time: 0.7034339904785156
Epoch: 7, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.798 Vali Acc: 0.215 Test Loss: 1.798 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8206079006195068
Epoch: 8, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.764 Vali Acc: 0.226 Test Loss: 1.764 Test Acc: 0.226
Validation loss decreased (-0.218500 --> -0.225908).  Saving model ...
Epoch: 9 cost time: 0.9906871318817139
Epoch: 9, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.732 Vali Acc: 0.226 Test Loss: 1.732 Test Acc: 0.226
Validation loss decreased (-0.225908 --> -0.225909).  Saving model ...
Epoch: 10 cost time: 0.8171279430389404
Epoch: 10, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.698 Vali Acc: 0.248 Test Loss: 1.698 Test Acc: 0.248
Validation loss decreased (-0.225909 --> -0.248131).  Saving model ...
Epoch: 11 cost time: 0.7981240749359131
Epoch: 11, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.665 Vali Acc: 0.322 Test Loss: 1.665 Test Acc: 0.322
Validation loss decreased (-0.248131 --> -0.322206).  Saving model ...
Epoch: 12 cost time: 0.7012615203857422
Epoch: 12, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.630 Vali Acc: 0.393 Test Loss: 1.630 Test Acc: 0.393
Validation loss decreased (-0.322206 --> -0.392576).  Saving model ...
Epoch: 13 cost time: 0.7414047718048096
Epoch: 13, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.591 Vali Acc: 0.563 Test Loss: 1.591 Test Acc: 0.563
Validation loss decreased (-0.392576 --> -0.562947).  Saving model ...
Epoch: 14 cost time: 0.7214415073394775
Epoch: 14, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.551 Vali Acc: 0.685 Test Loss: 1.551 Test Acc: 0.685
Validation loss decreased (-0.562947 --> -0.685170).  Saving model ...
Epoch: 15 cost time: 0.8615939617156982
Epoch: 15, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.510 Vali Acc: 0.737 Test Loss: 1.510 Test Acc: 0.737
Validation loss decreased (-0.685170 --> -0.737022).  Saving model ...
Epoch: 16 cost time: 0.9939000606536865
Epoch: 16, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.464 Vali Acc: 0.781 Test Loss: 1.464 Test Acc: 0.781
Validation loss decreased (-0.737022 --> -0.781467).  Saving model ...
Epoch: 17 cost time: 0.9124557971954346
Epoch: 17, Steps: 2 | Train Loss: 1.356 Vali Loss: 1.417 Vali Acc: 0.800 Test Loss: 1.417 Test Acc: 0.800
Validation loss decreased (-0.781467 --> -0.799986).  Saving model ...
Epoch: 18 cost time: 0.7260184288024902
Epoch: 18, Steps: 2 | Train Loss: 1.375 Vali Loss: 1.369 Vali Acc: 0.807 Test Loss: 1.369 Test Acc: 0.807
Validation loss decreased (-0.799986 --> -0.807394).  Saving model ...
Epoch: 19 cost time: 0.7066996097564697
Epoch: 19, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.321 Vali Acc: 0.807 Test Loss: 1.321 Test Acc: 0.807
Validation loss decreased (-0.807394 --> -0.807394).  Saving model ...
Epoch: 20 cost time: 0.8906846046447754
Epoch: 20, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.272 Vali Acc: 0.804 Test Loss: 1.272 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.878793478012085
Epoch: 21, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.222 Vali Acc: 0.796 Test Loss: 1.222 Test Acc: 0.796
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8205044269561768
Epoch: 22, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.170 Vali Acc: 0.789 Test Loss: 1.170 Test Acc: 0.789
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9629101753234863
Epoch: 23, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.115 Vali Acc: 0.789 Test Loss: 1.115 Test Acc: 0.789
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.990729808807373
Epoch: 24, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.057 Vali Acc: 0.800 Test Loss: 1.057 Test Acc: 0.800
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1473658084869385
Epoch: 25, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.997 Vali Acc: 0.822 Test Loss: 0.997 Test Acc: 0.822
Validation loss decreased (-0.807394 --> -0.822212).  Saving model ...
Epoch: 26 cost time: 0.9036462306976318
Epoch: 26, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.937 Vali Acc: 0.848 Test Loss: 0.937 Test Acc: 0.848
Validation loss decreased (-0.822212 --> -0.848139).  Saving model ...
Epoch: 27 cost time: 0.7283830642700195
Epoch: 27, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.877 Vali Acc: 0.893 Test Loss: 0.877 Test Acc: 0.893
Validation loss decreased (-0.848139 --> -0.892584).  Saving model ...
Epoch: 28 cost time: 0.8205883502960205
Epoch: 28, Steps: 2 | Train Loss: 0.783 Vali Loss: 0.819 Vali Acc: 0.915 Test Loss: 0.819 Test Acc: 0.915
Validation loss decreased (-0.892584 --> -0.914807).  Saving model ...
Epoch: 29 cost time: 0.6702861785888672
Epoch: 29, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.766 Vali Acc: 0.919 Test Loss: 0.766 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918511).  Saving model ...
Epoch: 30 cost time: 0.8787534236907959
Epoch: 30, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.713 Vali Acc: 0.919 Test Loss: 0.713 Test Acc: 0.919
Validation loss decreased (-0.918511 --> -0.918511).  Saving model ...
Epoch: 31 cost time: 1.0048906803131104
Epoch: 31, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.665 Vali Acc: 0.911 Test Loss: 0.665 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7329227924346924
Epoch: 32, Steps: 2 | Train Loss: 0.543 Vali Loss: 0.620 Vali Acc: 0.904 Test Loss: 0.620 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9430935382843018
Epoch: 33, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.578 Vali Acc: 0.922 Test Loss: 0.578 Test Acc: 0.922
Validation loss decreased (-0.918511 --> -0.922216).  Saving model ...
Epoch: 34 cost time: 0.7974715232849121
Epoch: 34, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.540 Vali Acc: 0.919 Test Loss: 0.540 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7700784206390381
Epoch: 35, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.504 Vali Acc: 0.930 Test Loss: 0.504 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929625).  Saving model ...
Epoch: 36 cost time: 0.7565689086914062
Epoch: 36, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.474 Vali Acc: 0.926 Test Loss: 0.474 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.9735090732574463
Epoch: 37, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.446 Vali Acc: 0.930 Test Loss: 0.446 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 38 cost time: 0.9869260787963867
Epoch: 38, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.420 Vali Acc: 0.933 Test Loss: 0.420 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 39 cost time: 0.6656403541564941
Epoch: 39, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.398 Vali Acc: 0.937 Test Loss: 0.398 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 40 cost time: 0.7545998096466064
Epoch: 40, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.377 Vali Acc: 0.941 Test Loss: 0.377 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 41 cost time: 0.7396345138549805
Epoch: 41, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.359 Vali Acc: 0.937 Test Loss: 0.359 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8311395645141602
Epoch: 42, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.346 Vali Acc: 0.941 Test Loss: 0.346 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 43 cost time: 0.8464546203613281
Epoch: 43, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 44 cost time: 0.9841194152832031
Epoch: 44, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 45 cost time: 0.7657454013824463
Epoch: 45, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.310 Vali Acc: 0.941 Test Loss: 0.310 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.800029993057251
Epoch: 46, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.301 Vali Acc: 0.941 Test Loss: 0.301 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7851693630218506
Epoch: 47, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.294 Vali Acc: 0.937 Test Loss: 0.294 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8528189659118652
Epoch: 48, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.287 Vali Acc: 0.937 Test Loss: 0.287 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6722118854522705
Epoch: 49, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.180793285369873
Epoch: 50, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.7250142097473145
Epoch: 51, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.270 Vali Acc: 0.933 Test Loss: 0.270 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.7323288917541504
Epoch: 52, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.262 Vali Acc: 0.941 Test Loss: 0.262 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.0616748332977295
Epoch: 53, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.256 Vali Acc: 0.941 Test Loss: 0.256 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.8118593692779541
Epoch: 54, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 429482
model size : 2.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2822771072387695
Epoch: 1, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.746 Vali Acc: 0.244 Test Loss: 1.746 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.7137556076049805
Epoch: 2, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.727 Vali Acc: 0.267 Test Loss: 1.727 Test Acc: 0.267
Validation loss decreased (-0.244427 --> -0.266649).  Saving model ...
Epoch: 3 cost time: 0.7723405361175537
Epoch: 3, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.710 Vali Acc: 0.293 Test Loss: 1.710 Test Acc: 0.293
Validation loss decreased (-0.266649 --> -0.292575).  Saving model ...
Epoch: 4 cost time: 0.970189094543457
Epoch: 4, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.688 Vali Acc: 0.319 Test Loss: 1.688 Test Acc: 0.319
Validation loss decreased (-0.292575 --> -0.318502).  Saving model ...
Epoch: 5 cost time: 0.8709025382995605
Epoch: 5, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.661 Vali Acc: 0.363 Test Loss: 1.661 Test Acc: 0.363
Validation loss decreased (-0.318502 --> -0.362946).  Saving model ...
Epoch: 6 cost time: 0.799811601638794
Epoch: 6, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.631 Vali Acc: 0.419 Test Loss: 1.631 Test Acc: 0.419
Validation loss decreased (-0.362946 --> -0.418502).  Saving model ...
Epoch: 7 cost time: 0.9387373924255371
Epoch: 7, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.601 Vali Acc: 0.437 Test Loss: 1.601 Test Acc: 0.437
Validation loss decreased (-0.418502 --> -0.437021).  Saving model ...
Epoch: 8 cost time: 0.7970292568206787
Epoch: 8, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.572 Vali Acc: 0.426 Test Loss: 1.572 Test Acc: 0.426
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.868783712387085
Epoch: 9, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.542 Vali Acc: 0.452 Test Loss: 1.542 Test Acc: 0.452
Validation loss decreased (-0.437021 --> -0.451836).  Saving model ...
Epoch: 10 cost time: 0.9019579887390137
Epoch: 10, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.512 Vali Acc: 0.467 Test Loss: 1.512 Test Acc: 0.467
Validation loss decreased (-0.451836 --> -0.466652).  Saving model ...
Epoch: 11 cost time: 0.9976387023925781
Epoch: 11, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.479 Vali Acc: 0.485 Test Loss: 1.479 Test Acc: 0.485
Validation loss decreased (-0.466652 --> -0.485170).  Saving model ...
Epoch: 12 cost time: 0.880211353302002
Epoch: 12, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.442 Vali Acc: 0.511 Test Loss: 1.442 Test Acc: 0.511
Validation loss decreased (-0.485170 --> -0.511097).  Saving model ...
Epoch: 13 cost time: 0.7880558967590332
Epoch: 13, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.401 Vali Acc: 0.541 Test Loss: 1.401 Test Acc: 0.541
Validation loss decreased (-0.511097 --> -0.540727).  Saving model ...
Epoch: 14 cost time: 0.6617870330810547
Epoch: 14, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.360 Vali Acc: 0.581 Test Loss: 1.360 Test Acc: 0.581
Validation loss decreased (-0.540727 --> -0.581468).  Saving model ...
Epoch: 15 cost time: 0.8804595470428467
Epoch: 15, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.318 Vali Acc: 0.615 Test Loss: 1.318 Test Acc: 0.615
Validation loss decreased (-0.581468 --> -0.614802).  Saving model ...
Epoch: 16 cost time: 0.8127310276031494
Epoch: 16, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.274 Vali Acc: 0.667 Test Loss: 1.274 Test Acc: 0.667
Validation loss decreased (-0.614802 --> -0.666654).  Saving model ...
Epoch: 17 cost time: 0.8528120517730713
Epoch: 17, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.228 Vali Acc: 0.715 Test Loss: 1.228 Test Acc: 0.715
Validation loss decreased (-0.666654 --> -0.714803).  Saving model ...
Epoch: 18 cost time: 0.8014898300170898
Epoch: 18, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.182 Vali Acc: 0.752 Test Loss: 1.182 Test Acc: 0.752
Validation loss decreased (-0.714803 --> -0.751840).  Saving model ...
Epoch: 19 cost time: 0.795403003692627
Epoch: 19, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.136 Vali Acc: 0.767 Test Loss: 1.136 Test Acc: 0.767
Validation loss decreased (-0.751840 --> -0.766655).  Saving model ...
Epoch: 20 cost time: 0.8940975666046143
Epoch: 20, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.090 Vali Acc: 0.767 Test Loss: 1.090 Test Acc: 0.767
Validation loss decreased (-0.766655 --> -0.766656).  Saving model ...
Epoch: 21 cost time: 0.6913795471191406
Epoch: 21, Steps: 2 | Train Loss: 0.972 Vali Loss: 1.045 Vali Acc: 0.774 Test Loss: 1.045 Test Acc: 0.774
Validation loss decreased (-0.766656 --> -0.774064).  Saving model ...
Epoch: 22 cost time: 0.7339932918548584
Epoch: 22, Steps: 2 | Train Loss: 0.973 Vali Loss: 1.001 Vali Acc: 0.793 Test Loss: 1.001 Test Acc: 0.793
Validation loss decreased (-0.774064 --> -0.792583).  Saving model ...
Epoch: 23 cost time: 1.0018770694732666
Epoch: 23, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.958 Vali Acc: 0.807 Test Loss: 0.958 Test Acc: 0.807
Validation loss decreased (-0.792583 --> -0.807398).  Saving model ...
Epoch: 24 cost time: 0.8862850666046143
Epoch: 24, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.918 Vali Acc: 0.822 Test Loss: 0.918 Test Acc: 0.822
Validation loss decreased (-0.807398 --> -0.822213).  Saving model ...
Epoch: 25 cost time: 0.7301332950592041
Epoch: 25, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.879 Vali Acc: 0.826 Test Loss: 0.879 Test Acc: 0.826
Validation loss decreased (-0.822213 --> -0.825917).  Saving model ...
Epoch: 26 cost time: 0.8112871646881104
Epoch: 26, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.841 Vali Acc: 0.848 Test Loss: 0.841 Test Acc: 0.848
Validation loss decreased (-0.825917 --> -0.848140).  Saving model ...
Epoch: 27 cost time: 0.7834880352020264
Epoch: 27, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.806 Vali Acc: 0.848 Test Loss: 0.806 Test Acc: 0.848
Validation loss decreased (-0.848140 --> -0.848140).  Saving model ...
Epoch: 28 cost time: 0.766779899597168
Epoch: 28, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.774 Vali Acc: 0.863 Test Loss: 0.774 Test Acc: 0.863
Validation loss decreased (-0.848140 --> -0.862955).  Saving model ...
Epoch: 29 cost time: 0.9564075469970703
Epoch: 29, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.743 Vali Acc: 0.874 Test Loss: 0.743 Test Acc: 0.874
Validation loss decreased (-0.862955 --> -0.874067).  Saving model ...
Epoch: 30 cost time: 0.7457778453826904
Epoch: 30, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.715 Vali Acc: 0.878 Test Loss: 0.715 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877771).  Saving model ...
Epoch: 31 cost time: 0.7515451908111572
Epoch: 31, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.689 Vali Acc: 0.893 Test Loss: 0.689 Test Acc: 0.893
Validation loss decreased (-0.877771 --> -0.892586).  Saving model ...
Epoch: 32 cost time: 0.671736478805542
Epoch: 32, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.665 Vali Acc: 0.907 Test Loss: 0.665 Test Acc: 0.907
Validation loss decreased (-0.892586 --> -0.907401).  Saving model ...
Epoch: 33 cost time: 0.7017612457275391
Epoch: 33, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.643 Vali Acc: 0.907 Test Loss: 0.643 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907401).  Saving model ...
Epoch: 34 cost time: 0.7218329906463623
Epoch: 34, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.622 Vali Acc: 0.900 Test Loss: 0.622 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.0856554508209229
Epoch: 35, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.603 Vali Acc: 0.900 Test Loss: 0.603 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8444375991821289
Epoch: 36, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.585 Vali Acc: 0.900 Test Loss: 0.585 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.8118176460266113
Epoch: 37, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.568 Vali Acc: 0.896 Test Loss: 0.568 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7804038524627686
Epoch: 38, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.552 Vali Acc: 0.896 Test Loss: 0.552 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7004351615905762
Epoch: 39, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.537 Vali Acc: 0.900 Test Loss: 0.537 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7509472370147705
Epoch: 40, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.521 Vali Acc: 0.907 Test Loss: 0.521 Test Acc: 0.907
Validation loss decreased (-0.907401 --> -0.907402).  Saving model ...
Epoch: 41 cost time: 0.982882022857666
Epoch: 41, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.505 Vali Acc: 0.915 Test Loss: 0.505 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 42 cost time: 0.7625854015350342
Epoch: 42, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.491 Vali Acc: 0.915 Test Loss: 0.491 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 43 cost time: 0.7062211036682129
Epoch: 43, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.478 Vali Acc: 0.915 Test Loss: 0.478 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 44 cost time: 0.6813259124755859
Epoch: 44, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.464 Vali Acc: 0.919 Test Loss: 0.464 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 45 cost time: 0.6646029949188232
Epoch: 45, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.452 Vali Acc: 0.915 Test Loss: 0.452 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6766262054443359
Epoch: 46, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.441 Vali Acc: 0.922 Test Loss: 0.441 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 47 cost time: 0.7183170318603516
Epoch: 47, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.430 Vali Acc: 0.922 Test Loss: 0.430 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 48 cost time: 0.7056834697723389
Epoch: 48, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.422 Vali Acc: 0.926 Test Loss: 0.422 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 49 cost time: 0.7113349437713623
Epoch: 49, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.414 Vali Acc: 0.922 Test Loss: 0.414 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.9263162612915039
Epoch: 50, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.406 Vali Acc: 0.922 Test Loss: 0.406 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.9127695560455322
Epoch: 51, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.400 Vali Acc: 0.922 Test Loss: 0.400 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.7664146423339844
Epoch: 52, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.393 Vali Acc: 0.922 Test Loss: 0.393 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.894136905670166
Epoch: 53, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.387 Vali Acc: 0.922 Test Loss: 0.387 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.785097599029541
Epoch: 54, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.380 Vali Acc: 0.922 Test Loss: 0.380 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 1.0839035511016846
Epoch: 55, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.373 Vali Acc: 0.922 Test Loss: 0.373 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.6922671794891357
Epoch: 56, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.366 Vali Acc: 0.919 Test Loss: 0.366 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.7605807781219482
Epoch: 57, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.360 Vali Acc: 0.919 Test Loss: 0.360 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.7366254329681396
Epoch: 58, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.354 Vali Acc: 0.919 Test Loss: 0.354 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 425226
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8204920291900635
Epoch: 1, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.816 Vali Acc: 0.211 Test Loss: 1.816 Test Acc: 0.211
Validation loss decreased (inf --> -0.211093).  Saving model ...
Epoch: 2 cost time: 0.8223793506622314
Epoch: 2, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.800 Vali Acc: 0.256 Test Loss: 1.800 Test Acc: 0.256
Validation loss decreased (-0.211093 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 0.7014319896697998
Epoch: 3, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.783 Vali Acc: 0.270 Test Loss: 1.783 Test Acc: 0.270
Validation loss decreased (-0.255538 --> -0.270353).  Saving model ...
Epoch: 4 cost time: 0.8143329620361328
Epoch: 4, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.762 Vali Acc: 0.307 Test Loss: 1.762 Test Acc: 0.307
Validation loss decreased (-0.270353 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.833266019821167
Epoch: 5, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.736 Vali Acc: 0.330 Test Loss: 1.736 Test Acc: 0.330
Validation loss decreased (-0.307390 --> -0.329612).  Saving model ...
Epoch: 6 cost time: 0.7653741836547852
Epoch: 6, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.708 Vali Acc: 0.333 Test Loss: 1.708 Test Acc: 0.333
Validation loss decreased (-0.329612 --> -0.333316).  Saving model ...
Epoch: 7 cost time: 0.8069329261779785
Epoch: 7, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.679 Vali Acc: 0.370 Test Loss: 1.679 Test Acc: 0.370
Validation loss decreased (-0.333316 --> -0.370354).  Saving model ...
Epoch: 8 cost time: 0.8279409408569336
Epoch: 8, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.649 Vali Acc: 0.407 Test Loss: 1.649 Test Acc: 0.407
Validation loss decreased (-0.370354 --> -0.407391).  Saving model ...
Epoch: 9 cost time: 0.7143495082855225
Epoch: 9, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.618 Vali Acc: 0.489 Test Loss: 1.618 Test Acc: 0.489
Validation loss decreased (-0.407391 --> -0.488873).  Saving model ...
Epoch: 10 cost time: 0.8246641159057617
Epoch: 10, Steps: 2 | Train Loss: 1.599 Vali Loss: 1.585 Vali Acc: 0.530 Test Loss: 1.585 Test Acc: 0.530
Validation loss decreased (-0.488873 --> -0.529614).  Saving model ...
Epoch: 11 cost time: 0.8033077716827393
Epoch: 11, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.548 Vali Acc: 0.574 Test Loss: 1.548 Test Acc: 0.574
Validation loss decreased (-0.529614 --> -0.574059).  Saving model ...
Epoch: 12 cost time: 0.6754882335662842
Epoch: 12, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.507 Vali Acc: 0.607 Test Loss: 1.507 Test Acc: 0.607
Validation loss decreased (-0.574059 --> -0.607392).  Saving model ...
Epoch: 13 cost time: 0.7335004806518555
Epoch: 13, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.462 Vali Acc: 0.637 Test Loss: 1.462 Test Acc: 0.637
Validation loss decreased (-0.607392 --> -0.637022).  Saving model ...
Epoch: 14 cost time: 0.7055587768554688
Epoch: 14, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.414 Vali Acc: 0.678 Test Loss: 1.414 Test Acc: 0.678
Validation loss decreased (-0.637022 --> -0.677764).  Saving model ...
Epoch: 15 cost time: 0.791867733001709
Epoch: 15, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.366 Vali Acc: 0.704 Test Loss: 1.366 Test Acc: 0.704
Validation loss decreased (-0.677764 --> -0.703690).  Saving model ...
Epoch: 16 cost time: 0.9024708271026611
Epoch: 16, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.315 Vali Acc: 0.733 Test Loss: 1.315 Test Acc: 0.733
Validation loss decreased (-0.703690 --> -0.733320).  Saving model ...
Epoch: 17 cost time: 0.801863431930542
Epoch: 17, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.262 Vali Acc: 0.759 Test Loss: 1.262 Test Acc: 0.759
Validation loss decreased (-0.733320 --> -0.759247).  Saving model ...
Epoch: 18 cost time: 0.808307409286499
Epoch: 18, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.209 Vali Acc: 0.778 Test Loss: 1.209 Test Acc: 0.778
Validation loss decreased (-0.759247 --> -0.777766).  Saving model ...
Epoch: 19 cost time: 0.8410196304321289
Epoch: 19, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.156 Vali Acc: 0.800 Test Loss: 1.156 Test Acc: 0.800
Validation loss decreased (-0.777766 --> -0.799988).  Saving model ...
Epoch: 20 cost time: 0.7553598880767822
Epoch: 20, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.105 Vali Acc: 0.815 Test Loss: 1.105 Test Acc: 0.815
Validation loss decreased (-0.799988 --> -0.814804).  Saving model ...
Epoch: 21 cost time: 0.8212566375732422
Epoch: 21, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.056 Vali Acc: 0.819 Test Loss: 1.056 Test Acc: 0.819
Validation loss decreased (-0.814804 --> -0.818508).  Saving model ...
Epoch: 22 cost time: 1.0022609233856201
Epoch: 22, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.009 Vali Acc: 0.833 Test Loss: 1.009 Test Acc: 0.833
Validation loss decreased (-0.818508 --> -0.833323).  Saving model ...
Epoch: 23 cost time: 0.8153457641601562
Epoch: 23, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.964 Vali Acc: 0.837 Test Loss: 0.964 Test Acc: 0.837
Validation loss decreased (-0.833323 --> -0.837027).  Saving model ...
Epoch: 24 cost time: 0.8591392040252686
Epoch: 24, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.922 Vali Acc: 0.841 Test Loss: 0.922 Test Acc: 0.841
Validation loss decreased (-0.837027 --> -0.840732).  Saving model ...
Epoch: 25 cost time: 0.8426022529602051
Epoch: 25, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.880 Vali Acc: 0.852 Test Loss: 0.880 Test Acc: 0.852
Validation loss decreased (-0.840732 --> -0.851843).  Saving model ...
Epoch: 26 cost time: 0.8660192489624023
Epoch: 26, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.840 Vali Acc: 0.863 Test Loss: 0.840 Test Acc: 0.863
Validation loss decreased (-0.851843 --> -0.862955).  Saving model ...
Epoch: 27 cost time: 0.7468438148498535
Epoch: 27, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.800 Vali Acc: 0.874 Test Loss: 0.800 Test Acc: 0.874
Validation loss decreased (-0.862955 --> -0.874066).  Saving model ...
Epoch: 28 cost time: 0.9385457038879395
Epoch: 28, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.764 Vali Acc: 0.874 Test Loss: 0.764 Test Acc: 0.874
Validation loss decreased (-0.874066 --> -0.874066).  Saving model ...
Epoch: 29 cost time: 1.063218116760254
Epoch: 29, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.730 Vali Acc: 0.874 Test Loss: 0.730 Test Acc: 0.874
Validation loss decreased (-0.874066 --> -0.874067).  Saving model ...
Epoch: 30 cost time: 0.6598765850067139
Epoch: 30, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.698 Vali Acc: 0.885 Test Loss: 0.698 Test Acc: 0.885
Validation loss decreased (-0.874067 --> -0.885178).  Saving model ...
Epoch: 31 cost time: 0.9082202911376953
Epoch: 31, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.669 Vali Acc: 0.893 Test Loss: 0.669 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 32 cost time: 0.6521701812744141
Epoch: 32, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.642 Vali Acc: 0.896 Test Loss: 0.642 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 33 cost time: 0.870858907699585
Epoch: 33, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.618 Vali Acc: 0.889 Test Loss: 0.618 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8228659629821777
Epoch: 34, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.595 Vali Acc: 0.893 Test Loss: 0.595 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.870049238204956
Epoch: 35, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.573 Vali Acc: 0.889 Test Loss: 0.573 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.9748616218566895
Epoch: 36, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.553 Vali Acc: 0.896 Test Loss: 0.553 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896291).  Saving model ...
Epoch: 37 cost time: 0.7573480606079102
Epoch: 37, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.535 Vali Acc: 0.900 Test Loss: 0.535 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 38 cost time: 0.9917874336242676
Epoch: 38, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.518 Vali Acc: 0.900 Test Loss: 0.518 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 39 cost time: 0.8236880302429199
Epoch: 39, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.503 Vali Acc: 0.915 Test Loss: 0.503 Test Acc: 0.915
Validation loss decreased (-0.899995 --> -0.914810).  Saving model ...
Epoch: 40 cost time: 0.989501953125
Epoch: 40, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.489 Vali Acc: 0.911 Test Loss: 0.489 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.911426305770874
Epoch: 41, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.477 Vali Acc: 0.904 Test Loss: 0.477 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.8137423992156982
Epoch: 42, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.464 Vali Acc: 0.904 Test Loss: 0.464 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8039493560791016
Epoch: 43, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.451 Vali Acc: 0.907 Test Loss: 0.451 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8700554370880127
Epoch: 44, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.439 Vali Acc: 0.904 Test Loss: 0.439 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.029306173324585
Epoch: 45, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.427 Vali Acc: 0.904 Test Loss: 0.427 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7291626930236816
Epoch: 46, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.417 Vali Acc: 0.907 Test Loss: 0.417 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.8956761360168457
Epoch: 47, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.406 Vali Acc: 0.907 Test Loss: 0.406 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.9997031688690186
Epoch: 48, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.396 Vali Acc: 0.919 Test Loss: 0.396 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918515).  Saving model ...
Epoch: 49 cost time: 0.8271033763885498
Epoch: 49, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.388 Vali Acc: 0.915 Test Loss: 0.388 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.8723678588867188
Epoch: 50, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.380 Vali Acc: 0.911 Test Loss: 0.380 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.8284988403320312
Epoch: 51, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.373 Vali Acc: 0.911 Test Loss: 0.373 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.9049932956695557
Epoch: 52, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.366 Vali Acc: 0.911 Test Loss: 0.366 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.8469369411468506
Epoch: 53, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.359 Vali Acc: 0.911 Test Loss: 0.359 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.815406322479248
Epoch: 54, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.352 Vali Acc: 0.922 Test Loss: 0.352 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 55 cost time: 0.9116954803466797
Epoch: 55, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.347 Vali Acc: 0.919 Test Loss: 0.347 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.8501362800598145
Epoch: 56, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 57 cost time: 0.6093971729278564
Epoch: 57, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.338 Vali Acc: 0.933 Test Loss: 0.338 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933330).  Saving model ...
Epoch: 58 cost time: 0.777122974395752
Epoch: 58, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.332 Vali Acc: 0.930 Test Loss: 0.332 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.7623019218444824
Epoch: 59, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.326 Vali Acc: 0.930 Test Loss: 0.326 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.911236047744751
Epoch: 60, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.321 Vali Acc: 0.930 Test Loss: 0.321 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 1.0585362911224365
Epoch: 61, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 1.1284615993499756
Epoch: 62, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.311 Vali Acc: 0.919 Test Loss: 0.311 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.993706226348877
Epoch: 63, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.8279762268066406
Epoch: 64, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.9945576190948486
Epoch: 65, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.7338547706604004
Epoch: 66, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.8433108329772949
Epoch: 67, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 424938
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6084558963775635
Epoch: 1, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.872 Vali Acc: 0.167 Test Loss: 1.872 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.7530901432037354
Epoch: 2, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.838 Vali Acc: 0.167 Test Loss: 1.838 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.7973475456237793
Epoch: 3, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.808 Vali Acc: 0.167 Test Loss: 1.808 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 0.889817476272583
Epoch: 4, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.772 Vali Acc: 0.174 Test Loss: 1.772 Test Acc: 0.174
Validation loss decreased (-0.166649 --> -0.174056).  Saving model ...
Epoch: 5 cost time: 0.6563165187835693
Epoch: 5, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.732 Vali Acc: 0.193 Test Loss: 1.732 Test Acc: 0.193
Validation loss decreased (-0.174056 --> -0.192575).  Saving model ...
Epoch: 6 cost time: 0.7350997924804688
Epoch: 6, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.694 Vali Acc: 0.285 Test Loss: 1.694 Test Acc: 0.285
Validation loss decreased (-0.192575 --> -0.285168).  Saving model ...
Epoch: 7 cost time: 0.7600722312927246
Epoch: 7, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.660 Vali Acc: 0.367 Test Loss: 1.660 Test Acc: 0.367
Validation loss decreased (-0.285168 --> -0.366650).  Saving model ...
Epoch: 8 cost time: 0.5815021991729736
Epoch: 8, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.626 Vali Acc: 0.470 Test Loss: 1.626 Test Acc: 0.470
Validation loss decreased (-0.366650 --> -0.470354).  Saving model ...
Epoch: 9 cost time: 0.7311327457427979
Epoch: 9, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.594 Vali Acc: 0.478 Test Loss: 1.594 Test Acc: 0.478
Validation loss decreased (-0.470354 --> -0.477762).  Saving model ...
Epoch: 10 cost time: 0.9641728401184082
Epoch: 10, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.561 Vali Acc: 0.504 Test Loss: 1.561 Test Acc: 0.504
Validation loss decreased (-0.477762 --> -0.503688).  Saving model ...
Epoch: 11 cost time: 0.8682293891906738
Epoch: 11, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.527 Vali Acc: 0.548 Test Loss: 1.527 Test Acc: 0.548
Validation loss decreased (-0.503688 --> -0.548133).  Saving model ...
Epoch: 12 cost time: 0.9180083274841309
Epoch: 12, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.488 Vali Acc: 0.619 Test Loss: 1.488 Test Acc: 0.619
Validation loss decreased (-0.548133 --> -0.618504).  Saving model ...
Epoch: 13 cost time: 0.8308506011962891
Epoch: 13, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.447 Vali Acc: 0.663 Test Loss: 1.447 Test Acc: 0.663
Validation loss decreased (-0.618504 --> -0.662948).  Saving model ...
Epoch: 14 cost time: 0.9287645816802979
Epoch: 14, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.403 Vali Acc: 0.726 Test Loss: 1.403 Test Acc: 0.726
Validation loss decreased (-0.662948 --> -0.725912).  Saving model ...
Epoch: 15 cost time: 0.8451981544494629
Epoch: 15, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.359 Vali Acc: 0.759 Test Loss: 1.359 Test Acc: 0.759
Validation loss decreased (-0.725912 --> -0.759246).  Saving model ...
Epoch: 16 cost time: 0.8328664302825928
Epoch: 16, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.315 Vali Acc: 0.793 Test Loss: 1.315 Test Acc: 0.793
Validation loss decreased (-0.759246 --> -0.792579).  Saving model ...
Epoch: 17 cost time: 0.9116411209106445
Epoch: 17, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.269 Vali Acc: 0.804 Test Loss: 1.269 Test Acc: 0.804
Validation loss decreased (-0.792579 --> -0.803691).  Saving model ...
Epoch: 18 cost time: 0.6968128681182861
Epoch: 18, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.223 Vali Acc: 0.844 Test Loss: 1.223 Test Acc: 0.844
Validation loss decreased (-0.803691 --> -0.844432).  Saving model ...
Epoch: 19 cost time: 0.8889148235321045
Epoch: 19, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.177 Vali Acc: 0.848 Test Loss: 1.177 Test Acc: 0.848
Validation loss decreased (-0.844432 --> -0.848136).  Saving model ...
Epoch: 20 cost time: 1.1071264743804932
Epoch: 20, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.130 Vali Acc: 0.867 Test Loss: 1.130 Test Acc: 0.867
Validation loss decreased (-0.848136 --> -0.866655).  Saving model ...
Epoch: 21 cost time: 0.6378476619720459
Epoch: 21, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.083 Vali Acc: 0.874 Test Loss: 1.083 Test Acc: 0.874
Validation loss decreased (-0.866655 --> -0.874063).  Saving model ...
Epoch: 22 cost time: 1.0292332172393799
Epoch: 22, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.035 Vali Acc: 0.874 Test Loss: 1.035 Test Acc: 0.874
Validation loss decreased (-0.874063 --> -0.874064).  Saving model ...
Epoch: 23 cost time: 1.0293478965759277
Epoch: 23, Steps: 2 | Train Loss: 0.924 Vali Loss: 0.988 Vali Acc: 0.885 Test Loss: 0.988 Test Acc: 0.885
Validation loss decreased (-0.874064 --> -0.885175).  Saving model ...
Epoch: 24 cost time: 0.7353348731994629
Epoch: 24, Steps: 2 | Train Loss: 0.932 Vali Loss: 0.944 Vali Acc: 0.885 Test Loss: 0.944 Test Acc: 0.885
Validation loss decreased (-0.885175 --> -0.885176).  Saving model ...
Epoch: 25 cost time: 0.8271520137786865
Epoch: 25, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.900 Vali Acc: 0.889 Test Loss: 0.900 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888880).  Saving model ...
Epoch: 26 cost time: 0.7525665760040283
Epoch: 26, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.860 Vali Acc: 0.889 Test Loss: 0.860 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888880).  Saving model ...
Epoch: 27 cost time: 0.8569478988647461
Epoch: 27, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.821 Vali Acc: 0.896 Test Loss: 0.821 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 28 cost time: 0.7486588954925537
Epoch: 28, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.786 Vali Acc: 0.881 Test Loss: 0.786 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.08819580078125
Epoch: 29, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.753 Vali Acc: 0.878 Test Loss: 0.753 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8910036087036133
Epoch: 30, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.722 Vali Acc: 0.878 Test Loss: 0.722 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7333943843841553
Epoch: 31, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.694 Vali Acc: 0.881 Test Loss: 0.694 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8403561115264893
Epoch: 32, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.666 Vali Acc: 0.889 Test Loss: 0.666 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.9900088310241699
Epoch: 33, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.640 Vali Acc: 0.889 Test Loss: 0.640 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.847221851348877
Epoch: 34, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.617 Vali Acc: 0.885 Test Loss: 0.617 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.9071199893951416
Epoch: 35, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.594 Vali Acc: 0.893 Test Loss: 0.594 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8353438377380371
Epoch: 36, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.573 Vali Acc: 0.893 Test Loss: 0.573 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8319034576416016
Epoch: 37, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.554 Vali Acc: 0.904 Test Loss: 0.554 Test Acc: 0.904
Validation loss decreased (-0.896288 --> -0.903698).  Saving model ...
Epoch: 38 cost time: 0.6714720726013184
Epoch: 38, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.536 Vali Acc: 0.904 Test Loss: 0.536 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 39 cost time: 0.8192861080169678
Epoch: 39, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.518 Vali Acc: 0.911 Test Loss: 0.518 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 40 cost time: 0.7878644466400146
Epoch: 40, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.503 Vali Acc: 0.907 Test Loss: 0.503 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7688472270965576
Epoch: 41, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.488 Vali Acc: 0.915 Test Loss: 0.488 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 42 cost time: 0.6830446720123291
Epoch: 42, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.473 Vali Acc: 0.907 Test Loss: 0.473 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.8251595497131348
Epoch: 43, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.461 Vali Acc: 0.907 Test Loss: 0.461 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.8202733993530273
Epoch: 44, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.451 Vali Acc: 0.907 Test Loss: 0.451 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.8320722579956055
Epoch: 45, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.441 Vali Acc: 0.911 Test Loss: 0.441 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.7555954456329346
Epoch: 46, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.433 Vali Acc: 0.915 Test Loss: 0.433 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 47 cost time: 0.7281506061553955
Epoch: 47, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.424 Vali Acc: 0.915 Test Loss: 0.424 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 48 cost time: 0.854344367980957
Epoch: 48, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.416 Vali Acc: 0.911 Test Loss: 0.416 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8147289752960205
Epoch: 49, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.410 Vali Acc: 0.900 Test Loss: 0.410 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7363479137420654
Epoch: 50, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.401 Vali Acc: 0.907 Test Loss: 0.401 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.9327080249786377
Epoch: 51, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.392 Vali Acc: 0.915 Test Loss: 0.392 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 52 cost time: 0.7305152416229248
Epoch: 52, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.382 Vali Acc: 0.915 Test Loss: 0.382 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 53 cost time: 0.7826807498931885
Epoch: 53, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.373 Vali Acc: 0.919 Test Loss: 0.373 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 54 cost time: 0.6954126358032227
Epoch: 54, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.366 Vali Acc: 0.926 Test Loss: 0.366 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925922).  Saving model ...
Epoch: 55 cost time: 0.8348903656005859
Epoch: 55, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.359 Vali Acc: 0.930 Test Loss: 0.359 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 56 cost time: 0.6617224216461182
Epoch: 56, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.353 Vali Acc: 0.930 Test Loss: 0.353 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 57 cost time: 0.6512746810913086
Epoch: 57, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.348 Vali Acc: 0.922 Test Loss: 0.348 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.93221116065979
Epoch: 58, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.343 Vali Acc: 0.926 Test Loss: 0.343 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.9762270450592041
Epoch: 59, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.336 Vali Acc: 0.933 Test Loss: 0.336 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 60 cost time: 0.8348727226257324
Epoch: 60, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.329 Vali Acc: 0.933 Test Loss: 0.329 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 61 cost time: 0.9493303298950195
Epoch: 61, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.325 Vali Acc: 0.937 Test Loss: 0.325 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 62 cost time: 0.73097825050354
Epoch: 62, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.320 Vali Acc: 0.937 Test Loss: 0.320 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 63 cost time: 0.8361499309539795
Epoch: 63, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.316 Vali Acc: 0.933 Test Loss: 0.316 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7975101470947266
Epoch: 64, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.311 Vali Acc: 0.930 Test Loss: 0.311 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.7321090698242188
Epoch: 65, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.307 Vali Acc: 0.930 Test Loss: 0.307 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.8032453060150146
Epoch: 66, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.7828998565673828
Epoch: 67, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.298 Vali Acc: 0.930 Test Loss: 0.298 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.7110910415649414
Epoch: 68, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.6131103038787842
Epoch: 69, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.291 Vali Acc: 0.937 Test Loss: 0.291 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 70 cost time: 0.6006870269775391
Epoch: 70, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.287 Vali Acc: 0.941 Test Loss: 0.287 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 71 cost time: 0.7648847103118896
Epoch: 71, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.284 Vali Acc: 0.941 Test Loss: 0.284 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 72 cost time: 0.9228358268737793
Epoch: 72, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 0.789325475692749
Epoch: 73, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.281 Vali Acc: 0.941 Test Loss: 0.281 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7978649139404297
Epoch: 74, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 75 cost time: 0.8980703353881836
Epoch: 75, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.278 Vali Acc: 0.941 Test Loss: 0.278 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7908027172088623
Epoch: 76, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.7880780696868896
Epoch: 77, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 0.7873930931091309
Epoch: 78, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 79 cost time: 0.7510919570922852
Epoch: 79, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.257 Vali Acc: 0.948 Test Loss: 0.257 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 80 cost time: 0.6151020526885986
Epoch: 80, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.254 Vali Acc: 0.948 Test Loss: 0.254 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 81 cost time: 0.6497185230255127
Epoch: 81, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 82 cost time: 0.9807155132293701
Epoch: 82, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 83 cost time: 0.8319694995880127
Epoch: 83, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.882568359375
Epoch: 84, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.8230891227722168
Epoch: 85, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.6981055736541748
Epoch: 86, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 1.0011701583862305
Epoch: 87, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 88 cost time: 0.8254179954528809
Epoch: 88, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 1.0129449367523193
Epoch: 89, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 90 cost time: 0.8833427429199219
Epoch: 90, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 91 cost time: 0.7711889743804932
Epoch: 91, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 92 cost time: 0.6739456653594971
Epoch: 92, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 1.0033268928527832
Epoch: 93, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.8227043151855469
Epoch: 94, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 95 cost time: 0.8886871337890625
Epoch: 95, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 96 cost time: 0.772529125213623
Epoch: 96, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 97 cost time: 0.7394881248474121
Epoch: 97, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 98 cost time: 0.8304154872894287
Epoch: 98, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 99 cost time: 0.8333423137664795
Epoch: 99, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.8743703365325928
Epoch: 100, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.225 Vali Acc: 0.948 Test Loss: 0.225 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 424650
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.794771432876587
Epoch: 1, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.945 Vali Acc: 0.096 Test Loss: 1.945 Test Acc: 0.096
Validation loss decreased (inf --> -0.096277).  Saving model ...
Epoch: 2 cost time: 0.9843227863311768
Epoch: 2, Steps: 2 | Train Loss: 1.984 Vali Loss: 1.919 Vali Acc: 0.122 Test Loss: 1.919 Test Acc: 0.122
Validation loss decreased (-0.096277 --> -0.122203).  Saving model ...
Epoch: 3 cost time: 0.7524209022521973
Epoch: 3, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.898 Vali Acc: 0.119 Test Loss: 1.898 Test Acc: 0.119
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8338801860809326
Epoch: 4, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.870 Vali Acc: 0.119 Test Loss: 1.870 Test Acc: 0.119
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.8324575424194336
Epoch: 5, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.838 Vali Acc: 0.130 Test Loss: 1.838 Test Acc: 0.130
Validation loss decreased (-0.122203 --> -0.129611).  Saving model ...
Epoch: 6 cost time: 0.8507235050201416
Epoch: 6, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.805 Vali Acc: 0.167 Test Loss: 1.805 Test Acc: 0.167
Validation loss decreased (-0.129611 --> -0.166649).  Saving model ...
Epoch: 7 cost time: 0.8169171810150146
Epoch: 7, Steps: 2 | Train Loss: 1.791 Vali Loss: 1.772 Vali Acc: 0.215 Test Loss: 1.772 Test Acc: 0.215
Validation loss decreased (-0.166649 --> -0.214797).  Saving model ...
Epoch: 8 cost time: 0.7132384777069092
Epoch: 8, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.743 Vali Acc: 0.248 Test Loss: 1.743 Test Acc: 0.248
Validation loss decreased (-0.214797 --> -0.248131).  Saving model ...
Epoch: 9 cost time: 0.7963919639587402
Epoch: 9, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.713 Vali Acc: 0.274 Test Loss: 1.713 Test Acc: 0.274
Validation loss decreased (-0.248131 --> -0.274057).  Saving model ...
Epoch: 10 cost time: 0.703411340713501
Epoch: 10, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.682 Vali Acc: 0.315 Test Loss: 1.682 Test Acc: 0.315
Validation loss decreased (-0.274057 --> -0.314798).  Saving model ...
Epoch: 11 cost time: 0.6841859817504883
Epoch: 11, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.651 Vali Acc: 0.356 Test Loss: 1.651 Test Acc: 0.356
Validation loss decreased (-0.314798 --> -0.355539).  Saving model ...
Epoch: 12 cost time: 0.7336664199829102
Epoch: 12, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.615 Vali Acc: 0.381 Test Loss: 1.615 Test Acc: 0.381
Validation loss decreased (-0.355539 --> -0.381465).  Saving model ...
Epoch: 13 cost time: 0.7748329639434814
Epoch: 13, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.576 Vali Acc: 0.463 Test Loss: 1.576 Test Acc: 0.463
Validation loss decreased (-0.381465 --> -0.462947).  Saving model ...
Epoch: 14 cost time: 0.8562526702880859
Epoch: 14, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.535 Vali Acc: 0.596 Test Loss: 1.535 Test Acc: 0.596
Validation loss decreased (-0.462947 --> -0.596281).  Saving model ...
Epoch: 15 cost time: 0.9562616348266602
Epoch: 15, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.492 Vali Acc: 0.637 Test Loss: 1.492 Test Acc: 0.637
Validation loss decreased (-0.596281 --> -0.637022).  Saving model ...
Epoch: 16 cost time: 0.80948805809021
Epoch: 16, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.446 Vali Acc: 0.663 Test Loss: 1.446 Test Acc: 0.663
Validation loss decreased (-0.637022 --> -0.662949).  Saving model ...
Epoch: 17 cost time: 0.6370329856872559
Epoch: 17, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.398 Vali Acc: 0.689 Test Loss: 1.398 Test Acc: 0.689
Validation loss decreased (-0.662949 --> -0.688875).  Saving model ...
Epoch: 18 cost time: 0.7374169826507568
Epoch: 18, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.350 Vali Acc: 0.715 Test Loss: 1.350 Test Acc: 0.715
Validation loss decreased (-0.688875 --> -0.714801).  Saving model ...
Epoch: 19 cost time: 0.8347787857055664
Epoch: 19, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.300 Vali Acc: 0.741 Test Loss: 1.300 Test Acc: 0.741
Validation loss decreased (-0.714801 --> -0.740728).  Saving model ...
Epoch: 20 cost time: 0.8083255290985107
Epoch: 20, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.249 Vali Acc: 0.774 Test Loss: 1.249 Test Acc: 0.774
Validation loss decreased (-0.740728 --> -0.774062).  Saving model ...
Epoch: 21 cost time: 0.7612812519073486
Epoch: 21, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.197 Vali Acc: 0.774 Test Loss: 1.197 Test Acc: 0.774
Validation loss decreased (-0.774062 --> -0.774062).  Saving model ...
Epoch: 22 cost time: 0.8653714656829834
Epoch: 22, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.144 Vali Acc: 0.793 Test Loss: 1.144 Test Acc: 0.793
Validation loss decreased (-0.774062 --> -0.792581).  Saving model ...
Epoch: 23 cost time: 0.7738437652587891
Epoch: 23, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.093 Vali Acc: 0.793 Test Loss: 1.093 Test Acc: 0.793
Validation loss decreased (-0.792581 --> -0.792582).  Saving model ...
Epoch: 24 cost time: 0.8235311508178711
Epoch: 24, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.042 Vali Acc: 0.815 Test Loss: 1.042 Test Acc: 0.815
Validation loss decreased (-0.792582 --> -0.814804).  Saving model ...
Epoch: 25 cost time: 0.7967743873596191
Epoch: 25, Steps: 2 | Train Loss: 0.908 Vali Loss: 0.993 Vali Acc: 0.848 Test Loss: 0.993 Test Acc: 0.848
Validation loss decreased (-0.814804 --> -0.848138).  Saving model ...
Epoch: 26 cost time: 0.8979432582855225
Epoch: 26, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.947 Vali Acc: 0.874 Test Loss: 0.947 Test Acc: 0.874
Validation loss decreased (-0.848138 --> -0.874065).  Saving model ...
Epoch: 27 cost time: 0.9260132312774658
Epoch: 27, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.902 Vali Acc: 0.889 Test Loss: 0.902 Test Acc: 0.889
Validation loss decreased (-0.874065 --> -0.888880).  Saving model ...
Epoch: 28 cost time: 0.680584192276001
Epoch: 28, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.860 Vali Acc: 0.896 Test Loss: 0.860 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 29 cost time: 0.8366141319274902
Epoch: 29, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.820 Vali Acc: 0.896 Test Loss: 0.820 Test Acc: 0.896
Validation loss decreased (-0.896288 --> -0.896288).  Saving model ...
Epoch: 30 cost time: 0.6902604103088379
Epoch: 30, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.783 Vali Acc: 0.893 Test Loss: 0.783 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8534259796142578
Epoch: 31, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.749 Vali Acc: 0.893 Test Loss: 0.749 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7922635078430176
Epoch: 32, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.716 Vali Acc: 0.900 Test Loss: 0.716 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899993).  Saving model ...
Epoch: 33 cost time: 0.89963698387146
Epoch: 33, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.686 Vali Acc: 0.900 Test Loss: 0.686 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 34 cost time: 0.9330093860626221
Epoch: 34, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.660 Vali Acc: 0.896 Test Loss: 0.660 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9117879867553711
Epoch: 35, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.633 Vali Acc: 0.911 Test Loss: 0.633 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.911105).  Saving model ...
Epoch: 36 cost time: 0.7373771667480469
Epoch: 36, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.609 Vali Acc: 0.919 Test Loss: 0.609 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918512).  Saving model ...
Epoch: 37 cost time: 0.7354655265808105
Epoch: 37, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.586 Vali Acc: 0.911 Test Loss: 0.586 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8259780406951904
Epoch: 38, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.566 Vali Acc: 0.907 Test Loss: 0.566 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7175099849700928
Epoch: 39, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.547 Vali Acc: 0.911 Test Loss: 0.547 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.874222993850708
Epoch: 40, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.530 Vali Acc: 0.911 Test Loss: 0.530 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9296252727508545
Epoch: 41, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.515 Vali Acc: 0.915 Test Loss: 0.515 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.0283563137054443
Epoch: 42, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.501 Vali Acc: 0.911 Test Loss: 0.501 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8065593242645264
Epoch: 43, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.488 Vali Acc: 0.915 Test Loss: 0.488 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7777035236358643
Epoch: 44, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.475 Vali Acc: 0.919 Test Loss: 0.475 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918514).  Saving model ...
Epoch: 45 cost time: 0.8056089878082275
Epoch: 45, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.463 Vali Acc: 0.919 Test Loss: 0.463 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 46 cost time: 0.7252964973449707
Epoch: 46, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.453 Vali Acc: 0.919 Test Loss: 0.453 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 47 cost time: 0.6844990253448486
Epoch: 47, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.443 Vali Acc: 0.922 Test Loss: 0.443 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 48 cost time: 0.79060959815979
Epoch: 48, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.434 Vali Acc: 0.922 Test Loss: 0.434 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 49 cost time: 0.790353536605835
Epoch: 49, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.426 Vali Acc: 0.922 Test Loss: 0.426 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 50 cost time: 0.6507258415222168
Epoch: 50, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.420 Vali Acc: 0.926 Test Loss: 0.420 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 51 cost time: 0.7714424133300781
Epoch: 51, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.411 Vali Acc: 0.926 Test Loss: 0.411 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 52 cost time: 0.8518579006195068
Epoch: 52, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.404 Vali Acc: 0.930 Test Loss: 0.404 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 53 cost time: 0.7221972942352295
Epoch: 53, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.394 Vali Acc: 0.933 Test Loss: 0.394 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933329).  Saving model ...
Epoch: 54 cost time: 0.8965647220611572
Epoch: 54, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.383 Vali Acc: 0.937 Test Loss: 0.383 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 55 cost time: 0.8739585876464844
Epoch: 55, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.375 Vali Acc: 0.933 Test Loss: 0.375 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.766132116317749
Epoch: 56, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.367 Vali Acc: 0.941 Test Loss: 0.367 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 57 cost time: 0.7316882610321045
Epoch: 57, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.359 Vali Acc: 0.937 Test Loss: 0.359 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.9065313339233398
Epoch: 58, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.354 Vali Acc: 0.941 Test Loss: 0.354 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 59 cost time: 0.7380015850067139
Epoch: 59, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.349 Vali Acc: 0.944 Test Loss: 0.349 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 60 cost time: 0.7917506694793701
Epoch: 60, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.342 Vali Acc: 0.941 Test Loss: 0.342 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.9864821434020996
Epoch: 61, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.335 Vali Acc: 0.948 Test Loss: 0.335 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 62 cost time: 0.844881534576416
Epoch: 62, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.330 Vali Acc: 0.948 Test Loss: 0.330 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 63 cost time: 0.7498326301574707
Epoch: 63, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.326 Vali Acc: 0.948 Test Loss: 0.326 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 64 cost time: 0.787682294845581
Epoch: 64, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.323 Vali Acc: 0.944 Test Loss: 0.323 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.7080833911895752
Epoch: 65, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.320 Vali Acc: 0.948 Test Loss: 0.320 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 66 cost time: 0.9249527454376221
Epoch: 66, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.316 Vali Acc: 0.948 Test Loss: 0.316 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 67 cost time: 0.8434305191040039
Epoch: 67, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8174526691436768
Epoch: 68, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.306 Vali Acc: 0.948 Test Loss: 0.306 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 69 cost time: 0.7769317626953125
Epoch: 69, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.302 Vali Acc: 0.948 Test Loss: 0.302 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 70 cost time: 0.8982839584350586
Epoch: 70, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.298 Vali Acc: 0.948 Test Loss: 0.298 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 71 cost time: 0.853365421295166
Epoch: 71, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.295 Vali Acc: 0.952 Test Loss: 0.295 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 72 cost time: 0.8316476345062256
Epoch: 72, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.292 Vali Acc: 0.952 Test Loss: 0.292 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 73 cost time: 0.6994423866271973
Epoch: 73, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.289 Vali Acc: 0.952 Test Loss: 0.289 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 74 cost time: 0.7882723808288574
Epoch: 74, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.287 Vali Acc: 0.948 Test Loss: 0.287 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.9611871242523193
Epoch: 75, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.282 Vali Acc: 0.952 Test Loss: 0.282 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 76 cost time: 0.788360595703125
Epoch: 76, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.279 Vali Acc: 0.956 Test Loss: 0.279 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 77 cost time: 0.8334348201751709
Epoch: 77, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.274 Vali Acc: 0.952 Test Loss: 0.274 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.8147439956665039
Epoch: 78, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.269 Vali Acc: 0.948 Test Loss: 0.269 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.6293368339538574
Epoch: 79, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.266 Vali Acc: 0.952 Test Loss: 0.266 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.8198115825653076
Epoch: 80, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.264 Vali Acc: 0.956 Test Loss: 0.264 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 81 cost time: 0.7143490314483643
Epoch: 81, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.262 Vali Acc: 0.959 Test Loss: 0.262 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 82 cost time: 1.0606474876403809
Epoch: 82, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.262 Vali Acc: 0.956 Test Loss: 0.262 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 1.0185410976409912
Epoch: 83, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.263 Vali Acc: 0.956 Test Loss: 0.263 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.9220261573791504
Epoch: 84, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.263 Vali Acc: 0.948 Test Loss: 0.263 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 1.0417873859405518
Epoch: 85, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.262 Vali Acc: 0.948 Test Loss: 0.262 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.6865038871765137
Epoch: 86, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.258 Vali Acc: 0.952 Test Loss: 0.258 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.8190140724182129
Epoch: 87, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.255 Vali Acc: 0.948 Test Loss: 0.255 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.7667341232299805
Epoch: 88, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.8456804752349854
Epoch: 89, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.6992542743682861
Epoch: 90, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.250 Vali Acc: 0.952 Test Loss: 0.250 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.8391673564910889
Epoch: 91, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.248 Vali Acc: 0.948 Test Loss: 0.248 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 424362
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3659305572509766
Epoch: 1, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.844 Vali Acc: 0.281 Test Loss: 1.844 Test Acc: 0.281
Validation loss decreased (inf --> -0.281463).  Saving model ...
Epoch: 2 cost time: 0.8392047882080078
Epoch: 2, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.821 Vali Acc: 0.304 Test Loss: 1.821 Test Acc: 0.304
Validation loss decreased (-0.281463 --> -0.303685).  Saving model ...
Epoch: 3 cost time: 0.7587993144989014
Epoch: 3, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.803 Vali Acc: 0.322 Test Loss: 1.803 Test Acc: 0.322
Validation loss decreased (-0.303685 --> -0.322204).  Saving model ...
Epoch: 4 cost time: 0.7965819835662842
Epoch: 4, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.785 Vali Acc: 0.337 Test Loss: 1.785 Test Acc: 0.337
Validation loss decreased (-0.322204 --> -0.337019).  Saving model ...
Epoch: 5 cost time: 0.7100377082824707
Epoch: 5, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.761 Vali Acc: 0.367 Test Loss: 1.761 Test Acc: 0.367
Validation loss decreased (-0.337019 --> -0.366649).  Saving model ...
Epoch: 6 cost time: 0.713118314743042
Epoch: 6, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.735 Vali Acc: 0.400 Test Loss: 1.735 Test Acc: 0.400
Validation loss decreased (-0.366649 --> -0.399983).  Saving model ...
Epoch: 7 cost time: 0.6935896873474121
Epoch: 7, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.707 Vali Acc: 0.419 Test Loss: 1.707 Test Acc: 0.419
Validation loss decreased (-0.399983 --> -0.418501).  Saving model ...
Epoch: 8 cost time: 0.6748621463775635
Epoch: 8, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.679 Vali Acc: 0.489 Test Loss: 1.679 Test Acc: 0.489
Validation loss decreased (-0.418501 --> -0.488872).  Saving model ...
Epoch: 9 cost time: 0.6983811855316162
Epoch: 9, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.652 Vali Acc: 0.537 Test Loss: 1.652 Test Acc: 0.537
Validation loss decreased (-0.488872 --> -0.537021).  Saving model ...
Epoch: 10 cost time: 0.7093133926391602
Epoch: 10, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.626 Vali Acc: 0.574 Test Loss: 1.626 Test Acc: 0.574
Validation loss decreased (-0.537021 --> -0.574058).  Saving model ...
Epoch: 11 cost time: 0.8238954544067383
Epoch: 11, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.601 Vali Acc: 0.589 Test Loss: 1.601 Test Acc: 0.589
Validation loss decreased (-0.574058 --> -0.588873).  Saving model ...
Epoch: 12 cost time: 0.720836877822876
Epoch: 12, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.577 Vali Acc: 0.615 Test Loss: 1.577 Test Acc: 0.615
Validation loss decreased (-0.588873 --> -0.614799).  Saving model ...
Epoch: 13 cost time: 0.7783658504486084
Epoch: 13, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.553 Vali Acc: 0.619 Test Loss: 1.553 Test Acc: 0.619
Validation loss decreased (-0.614799 --> -0.618503).  Saving model ...
Epoch: 14 cost time: 0.6358578205108643
Epoch: 14, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.529 Vali Acc: 0.652 Test Loss: 1.529 Test Acc: 0.652
Validation loss decreased (-0.618503 --> -0.651837).  Saving model ...
Epoch: 15 cost time: 0.8973557949066162
Epoch: 15, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.503 Vali Acc: 0.663 Test Loss: 1.503 Test Acc: 0.663
Validation loss decreased (-0.651837 --> -0.662948).  Saving model ...
Epoch: 16 cost time: 0.7285552024841309
Epoch: 16, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.474 Vali Acc: 0.678 Test Loss: 1.474 Test Acc: 0.678
Validation loss decreased (-0.662948 --> -0.677763).  Saving model ...
Epoch: 17 cost time: 0.698171854019165
Epoch: 17, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.444 Vali Acc: 0.696 Test Loss: 1.444 Test Acc: 0.696
Validation loss decreased (-0.677763 --> -0.696282).  Saving model ...
Epoch: 18 cost time: 0.6237573623657227
Epoch: 18, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.411 Vali Acc: 0.707 Test Loss: 1.411 Test Acc: 0.707
Validation loss decreased (-0.696282 --> -0.707393).  Saving model ...
Epoch: 19 cost time: 0.7651474475860596
Epoch: 19, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.375 Vali Acc: 0.733 Test Loss: 1.375 Test Acc: 0.733
Validation loss decreased (-0.707393 --> -0.733320).  Saving model ...
Epoch: 20 cost time: 0.7289083003997803
Epoch: 20, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.339 Vali Acc: 0.763 Test Loss: 1.339 Test Acc: 0.763
Validation loss decreased (-0.733320 --> -0.762950).  Saving model ...
Epoch: 21 cost time: 0.8327229022979736
Epoch: 21, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.302 Vali Acc: 0.752 Test Loss: 1.302 Test Acc: 0.752
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7992775440216064
Epoch: 22, Steps: 2 | Train Loss: 1.226 Vali Loss: 1.264 Vali Acc: 0.756 Test Loss: 1.264 Test Acc: 0.756
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6755988597869873
Epoch: 23, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.224 Vali Acc: 0.756 Test Loss: 1.224 Test Acc: 0.756
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8964457511901855
Epoch: 24, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.183 Vali Acc: 0.763 Test Loss: 1.183 Test Acc: 0.763
Validation loss decreased (-0.762950 --> -0.762951).  Saving model ...
Epoch: 25 cost time: 0.7935116291046143
Epoch: 25, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.142 Vali Acc: 0.781 Test Loss: 1.142 Test Acc: 0.781
Validation loss decreased (-0.762951 --> -0.781470).  Saving model ...
Epoch: 26 cost time: 0.8459603786468506
Epoch: 26, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.102 Vali Acc: 0.793 Test Loss: 1.102 Test Acc: 0.793
Validation loss decreased (-0.781470 --> -0.792582).  Saving model ...
Epoch: 27 cost time: 0.8077397346496582
Epoch: 27, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.061 Vali Acc: 0.807 Test Loss: 1.061 Test Acc: 0.807
Validation loss decreased (-0.792582 --> -0.807397).  Saving model ...
Epoch: 28 cost time: 0.7660415172576904
Epoch: 28, Steps: 2 | Train Loss: 0.944 Vali Loss: 1.022 Vali Acc: 0.819 Test Loss: 1.022 Test Acc: 0.819
Validation loss decreased (-0.807397 --> -0.818508).  Saving model ...
Epoch: 29 cost time: 0.6470398902893066
Epoch: 29, Steps: 2 | Train Loss: 0.857 Vali Loss: 0.982 Vali Acc: 0.833 Test Loss: 0.982 Test Acc: 0.833
Validation loss decreased (-0.818508 --> -0.833324).  Saving model ...
Epoch: 30 cost time: 0.6851828098297119
Epoch: 30, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.944 Vali Acc: 0.841 Test Loss: 0.944 Test Acc: 0.841
Validation loss decreased (-0.833324 --> -0.840731).  Saving model ...
Epoch: 31 cost time: 0.5850300788879395
Epoch: 31, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.908 Vali Acc: 0.859 Test Loss: 0.908 Test Acc: 0.859
Validation loss decreased (-0.840731 --> -0.859250).  Saving model ...
Epoch: 32 cost time: 0.741213321685791
Epoch: 32, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.872 Vali Acc: 0.867 Test Loss: 0.872 Test Acc: 0.867
Validation loss decreased (-0.859250 --> -0.866658).  Saving model ...
Epoch: 33 cost time: 0.8055820465087891
Epoch: 33, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.838 Vali Acc: 0.874 Test Loss: 0.838 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 34 cost time: 0.8653898239135742
Epoch: 34, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.805 Vali Acc: 0.878 Test Loss: 0.805 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877770).  Saving model ...
Epoch: 35 cost time: 0.7706670761108398
Epoch: 35, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.774 Vali Acc: 0.881 Test Loss: 0.774 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 36 cost time: 0.7501931190490723
Epoch: 36, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.745 Vali Acc: 0.885 Test Loss: 0.745 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 37 cost time: 0.7966899871826172
Epoch: 37, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.718 Vali Acc: 0.893 Test Loss: 0.718 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892585).  Saving model ...
Epoch: 38 cost time: 0.6389801502227783
Epoch: 38, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.692 Vali Acc: 0.900 Test Loss: 0.692 Test Acc: 0.900
Validation loss decreased (-0.892585 --> -0.899993).  Saving model ...
Epoch: 39 cost time: 0.7526459693908691
Epoch: 39, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.669 Vali Acc: 0.900 Test Loss: 0.669 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 40 cost time: 0.9004273414611816
Epoch: 40, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.647 Vali Acc: 0.896 Test Loss: 0.647 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7863588333129883
Epoch: 41, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.626 Vali Acc: 0.904 Test Loss: 0.626 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 42 cost time: 0.7096219062805176
Epoch: 42, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.606 Vali Acc: 0.904 Test Loss: 0.606 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 43 cost time: 0.794579267501831
Epoch: 43, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.588 Vali Acc: 0.907 Test Loss: 0.588 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 44 cost time: 0.6860306262969971
Epoch: 44, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.571 Vali Acc: 0.904 Test Loss: 0.571 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7008843421936035
Epoch: 45, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.555 Vali Acc: 0.900 Test Loss: 0.555 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6991167068481445
Epoch: 46, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.66949462890625
Epoch: 47, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.525 Vali Acc: 0.904 Test Loss: 0.525 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7904233932495117
Epoch: 48, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7737929821014404
Epoch: 49, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.499 Vali Acc: 0.904 Test Loss: 0.499 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7881855964660645
Epoch: 50, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.487 Vali Acc: 0.904 Test Loss: 0.487 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.819882869720459
Epoch: 51, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.475 Vali Acc: 0.911 Test Loss: 0.475 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 52 cost time: 0.9087934494018555
Epoch: 52, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.463 Vali Acc: 0.911 Test Loss: 0.463 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 53 cost time: 0.8895940780639648
Epoch: 53, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.452 Vali Acc: 0.915 Test Loss: 0.452 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 54 cost time: 0.9773201942443848
Epoch: 54, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.443 Vali Acc: 0.915 Test Loss: 0.443 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 55 cost time: 0.8659870624542236
Epoch: 55, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.433 Vali Acc: 0.915 Test Loss: 0.433 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 56 cost time: 0.8033654689788818
Epoch: 56, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.426 Vali Acc: 0.915 Test Loss: 0.426 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 57 cost time: 0.866873025894165
Epoch: 57, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.418 Vali Acc: 0.911 Test Loss: 0.418 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.812549352645874
Epoch: 58, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.410 Vali Acc: 0.911 Test Loss: 0.410 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 59 cost time: 0.8145804405212402
Epoch: 59, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.404 Vali Acc: 0.911 Test Loss: 0.404 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 60 cost time: 0.7585163116455078
Epoch: 60, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.397 Vali Acc: 0.911 Test Loss: 0.397 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 61 cost time: 0.774878978729248
Epoch: 61, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.388 Vali Acc: 0.911 Test Loss: 0.388 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 62 cost time: 0.8013410568237305
Epoch: 62, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.381 Vali Acc: 0.915 Test Loss: 0.381 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 63 cost time: 0.9069130420684814
Epoch: 63, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.373 Vali Acc: 0.915 Test Loss: 0.373 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 64 cost time: 0.8524219989776611
Epoch: 64, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.367 Vali Acc: 0.915 Test Loss: 0.367 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 65 cost time: 0.8647663593292236
Epoch: 65, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.361 Vali Acc: 0.919 Test Loss: 0.361 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 66 cost time: 0.9209342002868652
Epoch: 66, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.356 Vali Acc: 0.919 Test Loss: 0.356 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 67 cost time: 0.874476432800293
Epoch: 67, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.350 Vali Acc: 0.922 Test Loss: 0.350 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 68 cost time: 0.8349440097808838
Epoch: 68, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.346 Vali Acc: 0.922 Test Loss: 0.346 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 69 cost time: 0.8285720348358154
Epoch: 69, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 70 cost time: 0.8209960460662842
Epoch: 70, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.339 Vali Acc: 0.915 Test Loss: 0.339 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.736173152923584
Epoch: 71, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.335 Vali Acc: 0.915 Test Loss: 0.335 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.9930355548858643
Epoch: 72, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.333 Vali Acc: 0.911 Test Loss: 0.333 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.7386646270751953
Epoch: 73, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.328 Vali Acc: 0.911 Test Loss: 0.328 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.7215728759765625
Epoch: 74, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.323 Vali Acc: 0.911 Test Loss: 0.323 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.7243971824645996
Epoch: 75, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.9106993675231934
Epoch: 76, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 77 cost time: 0.8640232086181641
Epoch: 77, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.306 Vali Acc: 0.930 Test Loss: 0.306 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 78 cost time: 0.6874094009399414
Epoch: 78, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 79 cost time: 0.6570260524749756
Epoch: 79, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.298 Vali Acc: 0.930 Test Loss: 0.298 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 80 cost time: 0.8838508129119873
Epoch: 80, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 81 cost time: 0.7151110172271729
Epoch: 81, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 82 cost time: 0.6729869842529297
Epoch: 82, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 83 cost time: 0.7529044151306152
Epoch: 83, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.288 Vali Acc: 0.930 Test Loss: 0.288 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 84 cost time: 0.5981206893920898
Epoch: 84, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.7951769828796387
Epoch: 85, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.285 Vali Acc: 0.926 Test Loss: 0.285 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.7460188865661621
Epoch: 86, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.6506068706512451
Epoch: 87, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.8514940738677979
Epoch: 88, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.7474849224090576
Epoch: 89, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.281 Vali Acc: 0.930 Test Loss: 0.281 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 90 cost time: 0.7218992710113525
Epoch: 90, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 91 cost time: 0.7462847232818604
Epoch: 91, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.276 Vali Acc: 0.930 Test Loss: 0.276 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 92 cost time: 0.7062761783599854
Epoch: 92, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 93 cost time: 0.7585623264312744
Epoch: 93, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 94 cost time: 0.709697961807251
Epoch: 94, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 95 cost time: 0.7231302261352539
Epoch: 95, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 96 cost time: 0.8725242614746094
Epoch: 96, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.8741741180419922
Epoch: 97, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.258 Vali Acc: 0.930 Test Loss: 0.258 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 1.0377509593963623
Epoch: 98, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.7998158931732178
Epoch: 99, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.8700516223907471
Epoch: 100, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 258826
model size : 1.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6539695262908936
Epoch: 1, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.943 Vali Acc: 0.256 Test Loss: 1.943 Test Acc: 0.256
Validation loss decreased (inf --> -0.255536).  Saving model ...
Epoch: 2 cost time: 0.7633974552154541
Epoch: 2, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.913 Vali Acc: 0.267 Test Loss: 1.913 Test Acc: 0.267
Validation loss decreased (-0.255536 --> -0.266648).  Saving model ...
Epoch: 3 cost time: 0.7307281494140625
Epoch: 3, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.887 Vali Acc: 0.278 Test Loss: 1.887 Test Acc: 0.278
Validation loss decreased (-0.266648 --> -0.277759).  Saving model ...
Epoch: 4 cost time: 0.6529707908630371
Epoch: 4, Steps: 2 | Train Loss: 1.925 Vali Loss: 1.858 Vali Acc: 0.274 Test Loss: 1.858 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5489201545715332
Epoch: 5, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.823 Vali Acc: 0.281 Test Loss: 1.823 Test Acc: 0.281
Validation loss decreased (-0.277759 --> -0.281463).  Saving model ...
Epoch: 6 cost time: 0.7913942337036133
Epoch: 6, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.787 Vali Acc: 0.281 Test Loss: 1.787 Test Acc: 0.281
Validation loss decreased (-0.281463 --> -0.281464).  Saving model ...
Epoch: 7 cost time: 0.6706228256225586
Epoch: 7, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.749 Vali Acc: 0.293 Test Loss: 1.749 Test Acc: 0.293
Validation loss decreased (-0.281464 --> -0.292575).  Saving model ...
Epoch: 8 cost time: 0.8749408721923828
Epoch: 8, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.713 Vali Acc: 0.304 Test Loss: 1.713 Test Acc: 0.304
Validation loss decreased (-0.292575 --> -0.303687).  Saving model ...
Epoch: 9 cost time: 0.751690149307251
Epoch: 9, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.679 Vali Acc: 0.337 Test Loss: 1.679 Test Acc: 0.337
Validation loss decreased (-0.303687 --> -0.337020).  Saving model ...
Epoch: 10 cost time: 0.6917896270751953
Epoch: 10, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.648 Vali Acc: 0.426 Test Loss: 1.648 Test Acc: 0.426
Validation loss decreased (-0.337020 --> -0.425909).  Saving model ...
Epoch: 11 cost time: 0.7928988933563232
Epoch: 11, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.620 Vali Acc: 0.519 Test Loss: 1.620 Test Acc: 0.519
Validation loss decreased (-0.425909 --> -0.518502).  Saving model ...
Epoch: 12 cost time: 0.7772669792175293
Epoch: 12, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.594 Vali Acc: 0.541 Test Loss: 1.594 Test Acc: 0.541
Validation loss decreased (-0.518502 --> -0.540725).  Saving model ...
Epoch: 13 cost time: 0.673283576965332
Epoch: 13, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.568 Vali Acc: 0.522 Test Loss: 1.568 Test Acc: 0.522
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7395713329315186
Epoch: 14, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.540 Vali Acc: 0.530 Test Loss: 1.540 Test Acc: 0.530
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7582888603210449
Epoch: 15, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.513 Vali Acc: 0.533 Test Loss: 1.513 Test Acc: 0.533
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8411104679107666
Epoch: 16, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.483 Vali Acc: 0.544 Test Loss: 1.483 Test Acc: 0.544
Validation loss decreased (-0.540725 --> -0.544430).  Saving model ...
Epoch: 17 cost time: 0.6769161224365234
Epoch: 17, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.451 Vali Acc: 0.567 Test Loss: 1.451 Test Acc: 0.567
Validation loss decreased (-0.544430 --> -0.566652).  Saving model ...
Epoch: 18 cost time: 0.8343298435211182
Epoch: 18, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.414 Vali Acc: 0.619 Test Loss: 1.414 Test Acc: 0.619
Validation loss decreased (-0.566652 --> -0.618504).  Saving model ...
Epoch: 19 cost time: 0.658898115158081
Epoch: 19, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.375 Vali Acc: 0.674 Test Loss: 1.375 Test Acc: 0.674
Validation loss decreased (-0.618504 --> -0.674060).  Saving model ...
Epoch: 20 cost time: 0.6672301292419434
Epoch: 20, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.332 Vali Acc: 0.722 Test Loss: 1.332 Test Acc: 0.722
Validation loss decreased (-0.674060 --> -0.722209).  Saving model ...
Epoch: 21 cost time: 0.6117854118347168
Epoch: 21, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.289 Vali Acc: 0.752 Test Loss: 1.289 Test Acc: 0.752
Validation loss decreased (-0.722209 --> -0.751839).  Saving model ...
Epoch: 22 cost time: 0.6875150203704834
Epoch: 22, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.244 Vali Acc: 0.793 Test Loss: 1.244 Test Acc: 0.793
Validation loss decreased (-0.751839 --> -0.792580).  Saving model ...
Epoch: 23 cost time: 0.7261593341827393
Epoch: 23, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.198 Vali Acc: 0.804 Test Loss: 1.198 Test Acc: 0.804
Validation loss decreased (-0.792580 --> -0.803692).  Saving model ...
Epoch: 24 cost time: 0.7345449924468994
Epoch: 24, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.150 Vali Acc: 0.815 Test Loss: 1.150 Test Acc: 0.815
Validation loss decreased (-0.803692 --> -0.814803).  Saving model ...
Epoch: 25 cost time: 0.5762956142425537
Epoch: 25, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.101 Vali Acc: 0.819 Test Loss: 1.101 Test Acc: 0.819
Validation loss decreased (-0.814803 --> -0.818508).  Saving model ...
Epoch: 26 cost time: 0.7476463317871094
Epoch: 26, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.052 Vali Acc: 0.819 Test Loss: 1.052 Test Acc: 0.819
Validation loss decreased (-0.818508 --> -0.818508).  Saving model ...
Epoch: 27 cost time: 0.6723535060882568
Epoch: 27, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.002 Vali Acc: 0.819 Test Loss: 1.002 Test Acc: 0.819
Validation loss decreased (-0.818508 --> -0.818508).  Saving model ...
Epoch: 28 cost time: 0.7239952087402344
Epoch: 28, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.954 Vali Acc: 0.826 Test Loss: 0.954 Test Acc: 0.826
Validation loss decreased (-0.818508 --> -0.825916).  Saving model ...
Epoch: 29 cost time: 0.8000421524047852
Epoch: 29, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.908 Vali Acc: 0.830 Test Loss: 0.908 Test Acc: 0.830
Validation loss decreased (-0.825916 --> -0.829621).  Saving model ...
Epoch: 30 cost time: 0.6484849452972412
Epoch: 30, Steps: 2 | Train Loss: 0.792 Vali Loss: 0.864 Vali Acc: 0.833 Test Loss: 0.864 Test Acc: 0.833
Validation loss decreased (-0.829621 --> -0.833325).  Saving model ...
Epoch: 31 cost time: 0.7569499015808105
Epoch: 31, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.823 Vali Acc: 0.833 Test Loss: 0.823 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833325).  Saving model ...
Epoch: 32 cost time: 0.7086021900177002
Epoch: 32, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.786 Vali Acc: 0.837 Test Loss: 0.786 Test Acc: 0.837
Validation loss decreased (-0.833325 --> -0.837029).  Saving model ...
Epoch: 33 cost time: 0.6254591941833496
Epoch: 33, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.752 Vali Acc: 0.830 Test Loss: 0.752 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.729947566986084
Epoch: 34, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.721 Vali Acc: 0.830 Test Loss: 0.721 Test Acc: 0.830
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.9711194038391113
Epoch: 35, Steps: 2 | Train Loss: 0.578 Vali Loss: 0.692 Vali Acc: 0.833 Test Loss: 0.692 Test Acc: 0.833
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.762415885925293
Epoch: 36, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.666 Vali Acc: 0.848 Test Loss: 0.666 Test Acc: 0.848
Validation loss decreased (-0.837029 --> -0.848141).  Saving model ...
Epoch: 37 cost time: 0.698286771774292
Epoch: 37, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.641 Vali Acc: 0.844 Test Loss: 0.641 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.845836877822876
Epoch: 38, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.619 Vali Acc: 0.848 Test Loss: 0.619 Test Acc: 0.848
Validation loss decreased (-0.848141 --> -0.848142).  Saving model ...
Epoch: 39 cost time: 0.9517853260040283
Epoch: 39, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.598 Vali Acc: 0.859 Test Loss: 0.598 Test Acc: 0.859
Validation loss decreased (-0.848142 --> -0.859253).  Saving model ...
Epoch: 40 cost time: 0.6435775756835938
Epoch: 40, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.578 Vali Acc: 0.867 Test Loss: 0.578 Test Acc: 0.867
Validation loss decreased (-0.859253 --> -0.866661).  Saving model ...
Epoch: 41 cost time: 0.6867735385894775
Epoch: 41, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.560 Vali Acc: 0.867 Test Loss: 0.560 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 42 cost time: 0.6567394733428955
Epoch: 42, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.544 Vali Acc: 0.889 Test Loss: 0.544 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888883).  Saving model ...
Epoch: 43 cost time: 0.7588818073272705
Epoch: 43, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.529 Vali Acc: 0.889 Test Loss: 0.529 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 44 cost time: 0.6868681907653809
Epoch: 44, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.515 Vali Acc: 0.889 Test Loss: 0.515 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 45 cost time: 0.7118704319000244
Epoch: 45, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 46 cost time: 0.7914671897888184
Epoch: 46, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.491 Vali Acc: 0.896 Test Loss: 0.491 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.7337710857391357
Epoch: 47, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.480 Vali Acc: 0.900 Test Loss: 0.480 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 48 cost time: 0.6775577068328857
Epoch: 48, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.469 Vali Acc: 0.904 Test Loss: 0.469 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 49 cost time: 0.8431408405303955
Epoch: 49, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.460 Vali Acc: 0.904 Test Loss: 0.460 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 50 cost time: 0.5766749382019043
Epoch: 50, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.451 Vali Acc: 0.904 Test Loss: 0.451 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 51 cost time: 0.5711829662322998
Epoch: 51, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.443 Vali Acc: 0.907 Test Loss: 0.443 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 52 cost time: 0.6968746185302734
Epoch: 52, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.436 Vali Acc: 0.911 Test Loss: 0.436 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 53 cost time: 0.6015970706939697
Epoch: 53, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.429 Vali Acc: 0.911 Test Loss: 0.429 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 54 cost time: 0.7654962539672852
Epoch: 54, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.422 Vali Acc: 0.911 Test Loss: 0.422 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 55 cost time: 0.8102178573608398
Epoch: 55, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.416 Vali Acc: 0.911 Test Loss: 0.416 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 56 cost time: 0.6003782749176025
Epoch: 56, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.409 Vali Acc: 0.911 Test Loss: 0.409 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 57 cost time: 0.5128660202026367
Epoch: 57, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.403 Vali Acc: 0.911 Test Loss: 0.403 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 58 cost time: 0.6347973346710205
Epoch: 58, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.397 Vali Acc: 0.911 Test Loss: 0.397 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 59 cost time: 0.7567262649536133
Epoch: 59, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.391 Vali Acc: 0.911 Test Loss: 0.391 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 60 cost time: 0.8167712688446045
Epoch: 60, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.386 Vali Acc: 0.911 Test Loss: 0.386 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 61 cost time: 0.7246472835540771
Epoch: 61, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.380 Vali Acc: 0.907 Test Loss: 0.380 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.8218250274658203
Epoch: 62, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.375 Vali Acc: 0.911 Test Loss: 0.375 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 63 cost time: 0.737220048904419
Epoch: 63, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.371 Vali Acc: 0.907 Test Loss: 0.371 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.7075417041778564
Epoch: 64, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.366 Vali Acc: 0.911 Test Loss: 0.366 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 65 cost time: 0.883552074432373
Epoch: 65, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.361 Vali Acc: 0.907 Test Loss: 0.361 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.6634294986724854
Epoch: 66, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.356 Vali Acc: 0.907 Test Loss: 0.356 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.737391471862793
Epoch: 67, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.352 Vali Acc: 0.911 Test Loss: 0.352 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 68 cost time: 0.650139331817627
Epoch: 68, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.348 Vali Acc: 0.911 Test Loss: 0.348 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 69 cost time: 0.5583059787750244
Epoch: 69, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.345 Vali Acc: 0.911 Test Loss: 0.345 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 70 cost time: 0.7023632526397705
Epoch: 70, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.341 Vali Acc: 0.915 Test Loss: 0.341 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914811).  Saving model ...
Epoch: 71 cost time: 0.6165025234222412
Epoch: 71, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.339 Vali Acc: 0.915 Test Loss: 0.339 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 72 cost time: 0.6958951950073242
Epoch: 72, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.336 Vali Acc: 0.915 Test Loss: 0.336 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 73 cost time: 0.7385246753692627
Epoch: 73, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.333 Vali Acc: 0.915 Test Loss: 0.333 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 74 cost time: 0.6188218593597412
Epoch: 74, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.330 Vali Acc: 0.915 Test Loss: 0.330 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 75 cost time: 0.7234199047088623
Epoch: 75, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7865924835205078
Epoch: 76, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.324 Vali Acc: 0.907 Test Loss: 0.324 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.7148888111114502
Epoch: 77, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 78 cost time: 0.7452764511108398
Epoch: 78, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.314 Vali Acc: 0.915 Test Loss: 0.314 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 79 cost time: 0.6827750205993652
Epoch: 79, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.312 Vali Acc: 0.919 Test Loss: 0.312 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918515).  Saving model ...
Epoch: 80 cost time: 0.8086893558502197
Epoch: 80, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.309 Vali Acc: 0.915 Test Loss: 0.309 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.870262622833252
Epoch: 81, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 82 cost time: 0.9002664089202881
Epoch: 82, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.305 Vali Acc: 0.919 Test Loss: 0.305 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 83 cost time: 0.8735494613647461
Epoch: 83, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 84 cost time: 0.7554190158843994
Epoch: 84, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.304 Vali Acc: 0.919 Test Loss: 0.304 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.7670540809631348
Epoch: 85, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.8464734554290771
Epoch: 86, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.8970410823822021
Epoch: 87, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.301 Vali Acc: 0.919 Test Loss: 0.301 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.8222637176513672
Epoch: 88, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.298 Vali Acc: 0.919 Test Loss: 0.298 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.7737874984741211
Epoch: 89, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.294 Vali Acc: 0.919 Test Loss: 0.294 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.7026190757751465
Epoch: 90, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.290 Vali Acc: 0.915 Test Loss: 0.290 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.7131743431091309
Epoch: 91, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.287 Vali Acc: 0.919 Test Loss: 0.287 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 0.7395591735839844
Epoch: 92, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.285 Vali Acc: 0.919 Test Loss: 0.285 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 0.7319109439849854
Epoch: 93, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.283 Vali Acc: 0.919 Test Loss: 0.283 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 258538
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.338270902633667
Epoch: 1, Steps: 2 | Train Loss: 1.988 Vali Loss: 2.019 Vali Acc: 0.167 Test Loss: 2.019 Test Acc: 0.167
Validation loss decreased (inf --> -0.166646).  Saving model ...
Epoch: 2 cost time: 0.7061972618103027
Epoch: 2, Steps: 2 | Train Loss: 1.977 Vali Loss: 1.988 Vali Acc: 0.167 Test Loss: 1.988 Test Acc: 0.167
Validation loss decreased (-0.166646 --> -0.166647).  Saving model ...
Epoch: 3 cost time: 0.7788143157958984
Epoch: 3, Steps: 2 | Train Loss: 2.010 Vali Loss: 1.964 Vali Acc: 0.167 Test Loss: 1.964 Test Acc: 0.167
Validation loss decreased (-0.166647 --> -0.166647).  Saving model ...
Epoch: 4 cost time: 0.598738431930542
Epoch: 4, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.939 Vali Acc: 0.167 Test Loss: 1.939 Test Acc: 0.167
Validation loss decreased (-0.166647 --> -0.166647).  Saving model ...
Epoch: 5 cost time: 0.6114413738250732
Epoch: 5, Steps: 2 | Train Loss: 1.981 Vali Loss: 1.908 Vali Acc: 0.167 Test Loss: 1.908 Test Acc: 0.167
Validation loss decreased (-0.166647 --> -0.166648).  Saving model ...
Epoch: 6 cost time: 0.6434636116027832
Epoch: 6, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.875 Vali Acc: 0.163 Test Loss: 1.875 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6215014457702637
Epoch: 7, Steps: 2 | Train Loss: 1.916 Vali Loss: 1.844 Vali Acc: 0.200 Test Loss: 1.844 Test Acc: 0.200
Validation loss decreased (-0.166648 --> -0.199982).  Saving model ...
Epoch: 8 cost time: 0.5811340808868408
Epoch: 8, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.816 Vali Acc: 0.270 Test Loss: 1.816 Test Acc: 0.270
Validation loss decreased (-0.199982 --> -0.270352).  Saving model ...
Epoch: 9 cost time: 0.6199367046356201
Epoch: 9, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.789 Vali Acc: 0.270 Test Loss: 1.789 Test Acc: 0.270
Validation loss decreased (-0.270352 --> -0.270352).  Saving model ...
Epoch: 10 cost time: 0.7215144634246826
Epoch: 10, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.765 Vali Acc: 0.281 Test Loss: 1.765 Test Acc: 0.281
Validation loss decreased (-0.270352 --> -0.281464).  Saving model ...
Epoch: 11 cost time: 0.7819030284881592
Epoch: 11, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.743 Vali Acc: 0.289 Test Loss: 1.743 Test Acc: 0.289
Validation loss decreased (-0.281464 --> -0.288871).  Saving model ...
Epoch: 12 cost time: 0.7261767387390137
Epoch: 12, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.722 Vali Acc: 0.315 Test Loss: 1.722 Test Acc: 0.315
Validation loss decreased (-0.288871 --> -0.314798).  Saving model ...
Epoch: 13 cost time: 0.7160799503326416
Epoch: 13, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.703 Vali Acc: 0.344 Test Loss: 1.703 Test Acc: 0.344
Validation loss decreased (-0.314798 --> -0.344427).  Saving model ...
Epoch: 14 cost time: 0.6612522602081299
Epoch: 14, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.682 Vali Acc: 0.370 Test Loss: 1.682 Test Acc: 0.370
Validation loss decreased (-0.344427 --> -0.370354).  Saving model ...
Epoch: 15 cost time: 0.6762089729309082
Epoch: 15, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.660 Vali Acc: 0.385 Test Loss: 1.660 Test Acc: 0.385
Validation loss decreased (-0.370354 --> -0.385169).  Saving model ...
Epoch: 16 cost time: 0.6867396831512451
Epoch: 16, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.636 Vali Acc: 0.411 Test Loss: 1.636 Test Acc: 0.411
Validation loss decreased (-0.385169 --> -0.411095).  Saving model ...
Epoch: 17 cost time: 0.6668798923492432
Epoch: 17, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.610 Vali Acc: 0.437 Test Loss: 1.610 Test Acc: 0.437
Validation loss decreased (-0.411095 --> -0.437021).  Saving model ...
Epoch: 18 cost time: 0.773123025894165
Epoch: 18, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.582 Vali Acc: 0.470 Test Loss: 1.582 Test Acc: 0.470
Validation loss decreased (-0.437021 --> -0.470355).  Saving model ...
Epoch: 19 cost time: 0.8687009811401367
Epoch: 19, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.553 Vali Acc: 0.500 Test Loss: 1.553 Test Acc: 0.500
Validation loss decreased (-0.470355 --> -0.499984).  Saving model ...
Epoch: 20 cost time: 0.7563364505767822
Epoch: 20, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.522 Vali Acc: 0.559 Test Loss: 1.522 Test Acc: 0.559
Validation loss decreased (-0.499984 --> -0.559244).  Saving model ...
Epoch: 21 cost time: 0.7238919734954834
Epoch: 21, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.493 Vali Acc: 0.593 Test Loss: 1.493 Test Acc: 0.593
Validation loss decreased (-0.559244 --> -0.592578).  Saving model ...
Epoch: 22 cost time: 0.9377291202545166
Epoch: 22, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.462 Vali Acc: 0.596 Test Loss: 1.462 Test Acc: 0.596
Validation loss decreased (-0.592578 --> -0.596282).  Saving model ...
Epoch: 23 cost time: 0.7714195251464844
Epoch: 23, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.430 Vali Acc: 0.644 Test Loss: 1.430 Test Acc: 0.644
Validation loss decreased (-0.596282 --> -0.644430).  Saving model ...
Epoch: 24 cost time: 0.7471749782562256
Epoch: 24, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.394 Vali Acc: 0.678 Test Loss: 1.394 Test Acc: 0.678
Validation loss decreased (-0.644430 --> -0.677764).  Saving model ...
Epoch: 25 cost time: 0.8261711597442627
Epoch: 25, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.356 Vali Acc: 0.711 Test Loss: 1.356 Test Acc: 0.711
Validation loss decreased (-0.677764 --> -0.711098).  Saving model ...
Epoch: 26 cost time: 0.6433067321777344
Epoch: 26, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.315 Vali Acc: 0.733 Test Loss: 1.315 Test Acc: 0.733
Validation loss decreased (-0.711098 --> -0.733320).  Saving model ...
Epoch: 27 cost time: 0.9187555313110352
Epoch: 27, Steps: 2 | Train Loss: 1.235 Vali Loss: 1.272 Vali Acc: 0.759 Test Loss: 1.272 Test Acc: 0.759
Validation loss decreased (-0.733320 --> -0.759247).  Saving model ...
Epoch: 28 cost time: 0.7198257446289062
Epoch: 28, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.227 Vali Acc: 0.800 Test Loss: 1.227 Test Acc: 0.800
Validation loss decreased (-0.759247 --> -0.799988).  Saving model ...
Epoch: 29 cost time: 0.7758004665374756
Epoch: 29, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.181 Vali Acc: 0.819 Test Loss: 1.181 Test Acc: 0.819
Validation loss decreased (-0.799988 --> -0.818507).  Saving model ...
Epoch: 30 cost time: 0.6399099826812744
Epoch: 30, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.134 Vali Acc: 0.844 Test Loss: 1.134 Test Acc: 0.844
Validation loss decreased (-0.818507 --> -0.844433).  Saving model ...
Epoch: 31 cost time: 0.7204432487487793
Epoch: 31, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.089 Vali Acc: 0.848 Test Loss: 1.089 Test Acc: 0.848
Validation loss decreased (-0.844433 --> -0.848137).  Saving model ...
Epoch: 32 cost time: 0.7276768684387207
Epoch: 32, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.044 Vali Acc: 0.859 Test Loss: 1.044 Test Acc: 0.859
Validation loss decreased (-0.848137 --> -0.859249).  Saving model ...
Epoch: 33 cost time: 0.7579479217529297
Epoch: 33, Steps: 2 | Train Loss: 0.955 Vali Loss: 1.000 Vali Acc: 0.878 Test Loss: 1.000 Test Acc: 0.878
Validation loss decreased (-0.859249 --> -0.877768).  Saving model ...
Epoch: 34 cost time: 0.5669353008270264
Epoch: 34, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.958 Vali Acc: 0.878 Test Loss: 0.958 Test Acc: 0.878
Validation loss decreased (-0.877768 --> -0.877768).  Saving model ...
Epoch: 35 cost time: 0.6651027202606201
Epoch: 35, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.915 Vali Acc: 0.881 Test Loss: 0.915 Test Acc: 0.881
Validation loss decreased (-0.877768 --> -0.881472).  Saving model ...
Epoch: 36 cost time: 0.7565779685974121
Epoch: 36, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.876 Vali Acc: 0.885 Test Loss: 0.876 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 37 cost time: 0.5884559154510498
Epoch: 37, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.839 Vali Acc: 0.889 Test Loss: 0.839 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888881).  Saving model ...
Epoch: 38 cost time: 0.6815061569213867
Epoch: 38, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.803 Vali Acc: 0.896 Test Loss: 0.803 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896288).  Saving model ...
Epoch: 39 cost time: 0.6533699035644531
Epoch: 39, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.770 Vali Acc: 0.907 Test Loss: 0.770 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907400).  Saving model ...
Epoch: 40 cost time: 0.677872896194458
Epoch: 40, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.738 Vali Acc: 0.915 Test Loss: 0.738 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914807).  Saving model ...
Epoch: 41 cost time: 1.0003890991210938
Epoch: 41, Steps: 2 | Train Loss: 0.604 Vali Loss: 0.708 Vali Acc: 0.915 Test Loss: 0.708 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 42 cost time: 0.7916567325592041
Epoch: 42, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.680 Vali Acc: 0.915 Test Loss: 0.680 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 43 cost time: 0.7980451583862305
Epoch: 43, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.655 Vali Acc: 0.915 Test Loss: 0.655 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 44 cost time: 0.9402358531951904
Epoch: 44, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.632 Vali Acc: 0.915 Test Loss: 0.632 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 45 cost time: 0.6325805187225342
Epoch: 45, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.610 Vali Acc: 0.919 Test Loss: 0.610 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 46 cost time: 0.7480549812316895
Epoch: 46, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.591 Vali Acc: 0.919 Test Loss: 0.591 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 47 cost time: 0.7695720195770264
Epoch: 47, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.573 Vali Acc: 0.919 Test Loss: 0.573 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 48 cost time: 0.8817808628082275
Epoch: 48, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.558 Vali Acc: 0.904 Test Loss: 0.558 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.8120365142822266
Epoch: 49, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.542 Vali Acc: 0.904 Test Loss: 0.542 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.7941994667053223
Epoch: 50, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.7049524784088135
Epoch: 51, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.512 Vali Acc: 0.904 Test Loss: 0.512 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6683330535888672
Epoch: 52, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.498 Vali Acc: 0.904 Test Loss: 0.498 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.6456549167633057
Epoch: 53, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.486 Vali Acc: 0.907 Test Loss: 0.486 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6912598609924316
Epoch: 54, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.475 Vali Acc: 0.907 Test Loss: 0.475 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.6195774078369141
Epoch: 55, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.463 Vali Acc: 0.907 Test Loss: 0.463 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.6312968730926514
Epoch: 56, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.452 Vali Acc: 0.907 Test Loss: 0.452 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.7271196842193604
Epoch: 57, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.442 Vali Acc: 0.907 Test Loss: 0.442 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 258250
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5793557167053223
Epoch: 1, Steps: 2 | Train Loss: 1.910 Vali Loss: 1.909 Vali Acc: 0.152 Test Loss: 1.909 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.5769228935241699
Epoch: 2, Steps: 2 | Train Loss: 1.987 Vali Loss: 1.895 Vali Acc: 0.156 Test Loss: 1.895 Test Acc: 0.156
Validation loss decreased (-0.151833 --> -0.155537).  Saving model ...
Epoch: 3 cost time: 0.5899720191955566
Epoch: 3, Steps: 2 | Train Loss: 1.977 Vali Loss: 1.884 Vali Acc: 0.148 Test Loss: 1.884 Test Acc: 0.148
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5894660949707031
Epoch: 4, Steps: 2 | Train Loss: 1.963 Vali Loss: 1.870 Vali Acc: 0.148 Test Loss: 1.870 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6989908218383789
Epoch: 5, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.853 Vali Acc: 0.156 Test Loss: 1.853 Test Acc: 0.156
Validation loss decreased (-0.155537 --> -0.155537).  Saving model ...
Epoch: 6 cost time: 0.7384738922119141
Epoch: 6, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.833 Vali Acc: 0.170 Test Loss: 1.833 Test Acc: 0.170
Validation loss decreased (-0.155537 --> -0.170352).  Saving model ...
Epoch: 7 cost time: 0.568505048751831
Epoch: 7, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.814 Vali Acc: 0.181 Test Loss: 1.814 Test Acc: 0.181
Validation loss decreased (-0.170352 --> -0.181463).  Saving model ...
Epoch: 8 cost time: 0.8496625423431396
Epoch: 8, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.794 Vali Acc: 0.196 Test Loss: 1.794 Test Acc: 0.196
Validation loss decreased (-0.181463 --> -0.196278).  Saving model ...
Epoch: 9 cost time: 0.726294994354248
Epoch: 9, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.774 Vali Acc: 0.219 Test Loss: 1.774 Test Acc: 0.219
Validation loss decreased (-0.196278 --> -0.218501).  Saving model ...
Epoch: 10 cost time: 0.6549692153930664
Epoch: 10, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.754 Vali Acc: 0.263 Test Loss: 1.754 Test Acc: 0.263
Validation loss decreased (-0.218501 --> -0.262945).  Saving model ...
Epoch: 11 cost time: 0.762925386428833
Epoch: 11, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.733 Vali Acc: 0.274 Test Loss: 1.733 Test Acc: 0.274
Validation loss decreased (-0.262945 --> -0.274057).  Saving model ...
Epoch: 12 cost time: 0.5870404243469238
Epoch: 12, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.710 Vali Acc: 0.296 Test Loss: 1.710 Test Acc: 0.296
Validation loss decreased (-0.274057 --> -0.296279).  Saving model ...
Epoch: 13 cost time: 0.795184850692749
Epoch: 13, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.687 Vali Acc: 0.270 Test Loss: 1.687 Test Acc: 0.270
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6733360290527344
Epoch: 14, Steps: 2 | Train Loss: 1.621 Vali Loss: 1.664 Vali Acc: 0.304 Test Loss: 1.664 Test Acc: 0.304
Validation loss decreased (-0.296279 --> -0.303687).  Saving model ...
Epoch: 15 cost time: 0.6270589828491211
Epoch: 15, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.638 Vali Acc: 0.367 Test Loss: 1.638 Test Acc: 0.367
Validation loss decreased (-0.303687 --> -0.366650).  Saving model ...
Epoch: 16 cost time: 0.633364200592041
Epoch: 16, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.612 Vali Acc: 0.456 Test Loss: 1.612 Test Acc: 0.456
Validation loss decreased (-0.366650 --> -0.455539).  Saving model ...
Epoch: 17 cost time: 0.6504888534545898
Epoch: 17, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.585 Vali Acc: 0.493 Test Loss: 1.585 Test Acc: 0.493
Validation loss decreased (-0.455539 --> -0.492577).  Saving model ...
Epoch: 18 cost time: 0.6582601070404053
Epoch: 18, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.556 Vali Acc: 0.530 Test Loss: 1.556 Test Acc: 0.530
Validation loss decreased (-0.492577 --> -0.529614).  Saving model ...
Epoch: 19 cost time: 0.6643161773681641
Epoch: 19, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.527 Vali Acc: 0.563 Test Loss: 1.527 Test Acc: 0.563
Validation loss decreased (-0.529614 --> -0.562948).  Saving model ...
Epoch: 20 cost time: 0.6236977577209473
Epoch: 20, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.496 Vali Acc: 0.600 Test Loss: 1.496 Test Acc: 0.600
Validation loss decreased (-0.562948 --> -0.599985).  Saving model ...
Epoch: 21 cost time: 0.6447579860687256
Epoch: 21, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.464 Vali Acc: 0.626 Test Loss: 1.464 Test Acc: 0.626
Validation loss decreased (-0.599985 --> -0.625911).  Saving model ...
Epoch: 22 cost time: 0.6834845542907715
Epoch: 22, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.431 Vali Acc: 0.663 Test Loss: 1.431 Test Acc: 0.663
Validation loss decreased (-0.625911 --> -0.662949).  Saving model ...
Epoch: 23 cost time: 0.6616823673248291
Epoch: 23, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.396 Vali Acc: 0.678 Test Loss: 1.396 Test Acc: 0.678
Validation loss decreased (-0.662949 --> -0.677764).  Saving model ...
Epoch: 24 cost time: 0.6757628917694092
Epoch: 24, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.360 Vali Acc: 0.711 Test Loss: 1.360 Test Acc: 0.711
Validation loss decreased (-0.677764 --> -0.711098).  Saving model ...
Epoch: 25 cost time: 0.7217447757720947
Epoch: 25, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.323 Vali Acc: 0.741 Test Loss: 1.323 Test Acc: 0.741
Validation loss decreased (-0.711098 --> -0.740728).  Saving model ...
Epoch: 26 cost time: 0.6669821739196777
Epoch: 26, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.286 Vali Acc: 0.759 Test Loss: 1.286 Test Acc: 0.759
Validation loss decreased (-0.740728 --> -0.759246).  Saving model ...
Epoch: 27 cost time: 0.6053111553192139
Epoch: 27, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.247 Vali Acc: 0.785 Test Loss: 1.247 Test Acc: 0.785
Validation loss decreased (-0.759246 --> -0.785173).  Saving model ...
Epoch: 28 cost time: 0.7457828521728516
Epoch: 28, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.206 Vali Acc: 0.800 Test Loss: 1.206 Test Acc: 0.800
Validation loss decreased (-0.785173 --> -0.799988).  Saving model ...
Epoch: 29 cost time: 0.6403131484985352
Epoch: 29, Steps: 2 | Train Loss: 1.061 Vali Loss: 1.164 Vali Acc: 0.811 Test Loss: 1.164 Test Acc: 0.811
Validation loss decreased (-0.799988 --> -0.811099).  Saving model ...
Epoch: 30 cost time: 0.7200024127960205
Epoch: 30, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.123 Vali Acc: 0.796 Test Loss: 1.123 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7749214172363281
Epoch: 31, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.080 Vali Acc: 0.819 Test Loss: 1.080 Test Acc: 0.819
Validation loss decreased (-0.811099 --> -0.818508).  Saving model ...
Epoch: 32 cost time: 0.7067587375640869
Epoch: 32, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.039 Vali Acc: 0.822 Test Loss: 1.039 Test Acc: 0.822
Validation loss decreased (-0.818508 --> -0.822212).  Saving model ...
Epoch: 33 cost time: 0.6023147106170654
Epoch: 33, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.998 Vali Acc: 0.833 Test Loss: 0.998 Test Acc: 0.833
Validation loss decreased (-0.822212 --> -0.833323).  Saving model ...
Epoch: 34 cost time: 0.616039514541626
Epoch: 34, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.959 Vali Acc: 0.852 Test Loss: 0.959 Test Acc: 0.852
Validation loss decreased (-0.833323 --> -0.851842).  Saving model ...
Epoch: 35 cost time: 0.5865001678466797
Epoch: 35, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.922 Vali Acc: 0.848 Test Loss: 0.922 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6486964225769043
Epoch: 36, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.886 Vali Acc: 0.837 Test Loss: 0.886 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.725132942199707
Epoch: 37, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.853 Vali Acc: 0.841 Test Loss: 0.853 Test Acc: 0.841
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.663433313369751
Epoch: 38, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.820 Vali Acc: 0.859 Test Loss: 0.820 Test Acc: 0.859
Validation loss decreased (-0.851842 --> -0.859251).  Saving model ...
Epoch: 39 cost time: 0.6689958572387695
Epoch: 39, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.790 Vali Acc: 0.867 Test Loss: 0.790 Test Acc: 0.867
Validation loss decreased (-0.859251 --> -0.866659).  Saving model ...
Epoch: 40 cost time: 0.6575758457183838
Epoch: 40, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.761 Vali Acc: 0.870 Test Loss: 0.761 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 41 cost time: 0.6296093463897705
Epoch: 41, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.734 Vali Acc: 0.874 Test Loss: 0.734 Test Acc: 0.874
Validation loss decreased (-0.870363 --> -0.874067).  Saving model ...
Epoch: 42 cost time: 0.8546898365020752
Epoch: 42, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.708 Vali Acc: 0.870 Test Loss: 0.708 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6801440715789795
Epoch: 43, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.684 Vali Acc: 0.874 Test Loss: 0.684 Test Acc: 0.874
Validation loss decreased (-0.874067 --> -0.874067).  Saving model ...
Epoch: 44 cost time: 0.6363227367401123
Epoch: 44, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.659 Vali Acc: 0.881 Test Loss: 0.659 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881475).  Saving model ...
Epoch: 45 cost time: 0.8245460987091064
Epoch: 45, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.635 Vali Acc: 0.881 Test Loss: 0.635 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881475).  Saving model ...
Epoch: 46 cost time: 0.6221864223480225
Epoch: 46, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.612 Vali Acc: 0.900 Test Loss: 0.612 Test Acc: 0.900
Validation loss decreased (-0.881475 --> -0.899994).  Saving model ...
Epoch: 47 cost time: 0.726917028427124
Epoch: 47, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.591 Vali Acc: 0.896 Test Loss: 0.591 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.8708508014678955
Epoch: 48, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.572 Vali Acc: 0.904 Test Loss: 0.572 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 49 cost time: 0.8327615261077881
Epoch: 49, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.554 Vali Acc: 0.900 Test Loss: 0.554 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7610073089599609
Epoch: 50, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.539 Vali Acc: 0.900 Test Loss: 0.539 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7778472900390625
Epoch: 51, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.524 Vali Acc: 0.904 Test Loss: 0.524 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 52 cost time: 0.718513011932373
Epoch: 52, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.510 Vali Acc: 0.904 Test Loss: 0.510 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903699).  Saving model ...
Epoch: 53 cost time: 0.6748330593109131
Epoch: 53, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.497 Vali Acc: 0.907 Test Loss: 0.497 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907402).  Saving model ...
Epoch: 54 cost time: 0.7172999382019043
Epoch: 54, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.484 Vali Acc: 0.907 Test Loss: 0.484 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 55 cost time: 0.794792652130127
Epoch: 55, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.472 Vali Acc: 0.907 Test Loss: 0.472 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 56 cost time: 0.6348283290863037
Epoch: 56, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.459 Vali Acc: 0.911 Test Loss: 0.459 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 57 cost time: 0.7622284889221191
Epoch: 57, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.449 Vali Acc: 0.911 Test Loss: 0.449 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 58 cost time: 0.6967501640319824
Epoch: 58, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.440 Vali Acc: 0.915 Test Loss: 0.440 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914810).  Saving model ...
Epoch: 59 cost time: 0.760195255279541
Epoch: 59, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.430 Vali Acc: 0.915 Test Loss: 0.430 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 60 cost time: 0.82505202293396
Epoch: 60, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.422 Vali Acc: 0.915 Test Loss: 0.422 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 61 cost time: 0.5996983051300049
Epoch: 61, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.414 Vali Acc: 0.915 Test Loss: 0.414 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 62 cost time: 0.7695112228393555
Epoch: 62, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.407 Vali Acc: 0.915 Test Loss: 0.407 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 63 cost time: 0.6179735660552979
Epoch: 63, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.401 Vali Acc: 0.915 Test Loss: 0.401 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 64 cost time: 0.6771111488342285
Epoch: 64, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.392 Vali Acc: 0.915 Test Loss: 0.392 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 65 cost time: 0.9351792335510254
Epoch: 65, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.383 Vali Acc: 0.922 Test Loss: 0.383 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922218).  Saving model ...
Epoch: 66 cost time: 0.6633353233337402
Epoch: 66, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.376 Vali Acc: 0.919 Test Loss: 0.376 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8091626167297363
Epoch: 67, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.369 Vali Acc: 0.919 Test Loss: 0.369 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.6972465515136719
Epoch: 68, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.363 Vali Acc: 0.922 Test Loss: 0.363 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 69 cost time: 0.6482532024383545
Epoch: 69, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 70 cost time: 0.8313877582550049
Epoch: 70, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.351 Vali Acc: 0.926 Test Loss: 0.351 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925922).  Saving model ...
Epoch: 71 cost time: 0.8691084384918213
Epoch: 71, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.347 Vali Acc: 0.926 Test Loss: 0.347 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 72 cost time: 0.6929783821105957
Epoch: 72, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.345 Vali Acc: 0.930 Test Loss: 0.345 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 73 cost time: 0.8204176425933838
Epoch: 73, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.344 Vali Acc: 0.919 Test Loss: 0.344 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.7196455001831055
Epoch: 74, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.343 Vali Acc: 0.919 Test Loss: 0.343 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.6167383193969727
Epoch: 75, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.340 Vali Acc: 0.922 Test Loss: 0.340 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.5906226634979248
Epoch: 76, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.333 Vali Acc: 0.926 Test Loss: 0.333 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.6406357288360596
Epoch: 77, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.6370706558227539
Epoch: 78, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.320 Vali Acc: 0.926 Test Loss: 0.320 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.7539098262786865
Epoch: 79, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.313 Vali Acc: 0.937 Test Loss: 0.313 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 80 cost time: 0.8097882270812988
Epoch: 80, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.8388330936431885
Epoch: 81, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.8683092594146729
Epoch: 82, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.299 Vali Acc: 0.926 Test Loss: 0.299 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 83 cost time: 0.6190271377563477
Epoch: 83, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.297 Vali Acc: 0.926 Test Loss: 0.297 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 84 cost time: 0.6986982822418213
Epoch: 84, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 85 cost time: 0.5806014537811279
Epoch: 85, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 86 cost time: 0.6395223140716553
Epoch: 86, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 87 cost time: 0.8180627822875977
Epoch: 87, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 88 cost time: 0.7552998065948486
Epoch: 88, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 89 cost time: 0.6981325149536133
Epoch: 89, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 257962
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.099896192550659
Epoch: 1, Steps: 2 | Train Loss: 1.988 Vali Loss: 1.879 Vali Acc: 0.189 Test Loss: 1.879 Test Acc: 0.189
Validation loss decreased (inf --> -0.188870).  Saving model ...
Epoch: 2 cost time: 0.9025464057922363
Epoch: 2, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.845 Vali Acc: 0.230 Test Loss: 1.845 Test Acc: 0.230
Validation loss decreased (-0.188870 --> -0.229611).  Saving model ...
Epoch: 3 cost time: 0.8117971420288086
Epoch: 3, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.820 Vali Acc: 0.244 Test Loss: 1.820 Test Acc: 0.244
Validation loss decreased (-0.229611 --> -0.244426).  Saving model ...
Epoch: 4 cost time: 1.0119264125823975
Epoch: 4, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.800 Vali Acc: 0.259 Test Loss: 1.800 Test Acc: 0.259
Validation loss decreased (-0.244426 --> -0.259241).  Saving model ...
Epoch: 5 cost time: 0.8025455474853516
Epoch: 5, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.775 Vali Acc: 0.304 Test Loss: 1.775 Test Acc: 0.304
Validation loss decreased (-0.259241 --> -0.303686).  Saving model ...
Epoch: 6 cost time: 0.9167072772979736
Epoch: 6, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.748 Vali Acc: 0.348 Test Loss: 1.748 Test Acc: 0.348
Validation loss decreased (-0.303686 --> -0.348131).  Saving model ...
Epoch: 7 cost time: 0.6554446220397949
Epoch: 7, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.721 Vali Acc: 0.378 Test Loss: 1.721 Test Acc: 0.378
Validation loss decreased (-0.348131 --> -0.377761).  Saving model ...
Epoch: 8 cost time: 0.9579193592071533
Epoch: 8, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.695 Vali Acc: 0.422 Test Loss: 1.695 Test Acc: 0.422
Validation loss decreased (-0.377761 --> -0.422205).  Saving model ...
Epoch: 9 cost time: 0.7813959121704102
Epoch: 9, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.672 Vali Acc: 0.441 Test Loss: 1.672 Test Acc: 0.441
Validation loss decreased (-0.422205 --> -0.440724).  Saving model ...
Epoch: 10 cost time: 0.7916920185089111
Epoch: 10, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.651 Vali Acc: 0.467 Test Loss: 1.651 Test Acc: 0.467
Validation loss decreased (-0.440724 --> -0.466650).  Saving model ...
Epoch: 11 cost time: 0.818833589553833
Epoch: 11, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.630 Vali Acc: 0.470 Test Loss: 1.630 Test Acc: 0.470
Validation loss decreased (-0.466650 --> -0.470354).  Saving model ...
Epoch: 12 cost time: 1.0578405857086182
Epoch: 12, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.611 Vali Acc: 0.467 Test Loss: 1.611 Test Acc: 0.467
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8348608016967773
Epoch: 13, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.591 Vali Acc: 0.481 Test Loss: 1.591 Test Acc: 0.481
Validation loss decreased (-0.470354 --> -0.481466).  Saving model ...
Epoch: 14 cost time: 0.7496631145477295
Epoch: 14, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.570 Vali Acc: 0.478 Test Loss: 1.570 Test Acc: 0.478
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7164719104766846
Epoch: 15, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.549 Vali Acc: 0.515 Test Loss: 1.549 Test Acc: 0.515
Validation loss decreased (-0.481466 --> -0.514799).  Saving model ...
Epoch: 16 cost time: 0.920985221862793
Epoch: 16, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.526 Vali Acc: 0.548 Test Loss: 1.526 Test Acc: 0.548
Validation loss decreased (-0.514799 --> -0.548133).  Saving model ...
Epoch: 17 cost time: 0.6954977512359619
Epoch: 17, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.503 Vali Acc: 0.593 Test Loss: 1.503 Test Acc: 0.593
Validation loss decreased (-0.548133 --> -0.592578).  Saving model ...
Epoch: 18 cost time: 0.6338284015655518
Epoch: 18, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.480 Vali Acc: 0.637 Test Loss: 1.480 Test Acc: 0.637
Validation loss decreased (-0.592578 --> -0.637022).  Saving model ...
Epoch: 19 cost time: 0.800724983215332
Epoch: 19, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.454 Vali Acc: 0.648 Test Loss: 1.454 Test Acc: 0.648
Validation loss decreased (-0.637022 --> -0.648134).  Saving model ...
Epoch: 20 cost time: 0.7903556823730469
Epoch: 20, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.427 Vali Acc: 0.689 Test Loss: 1.427 Test Acc: 0.689
Validation loss decreased (-0.648134 --> -0.688875).  Saving model ...
Epoch: 21 cost time: 0.7778944969177246
Epoch: 21, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.398 Vali Acc: 0.726 Test Loss: 1.398 Test Acc: 0.726
Validation loss decreased (-0.688875 --> -0.725912).  Saving model ...
Epoch: 22 cost time: 0.6725735664367676
Epoch: 22, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.368 Vali Acc: 0.756 Test Loss: 1.368 Test Acc: 0.756
Validation loss decreased (-0.725912 --> -0.755542).  Saving model ...
Epoch: 23 cost time: 0.8123433589935303
Epoch: 23, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.336 Vali Acc: 0.774 Test Loss: 1.336 Test Acc: 0.774
Validation loss decreased (-0.755542 --> -0.774061).  Saving model ...
Epoch: 24 cost time: 0.9157865047454834
Epoch: 24, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.304 Vali Acc: 0.781 Test Loss: 1.304 Test Acc: 0.781
Validation loss decreased (-0.774061 --> -0.781468).  Saving model ...
Epoch: 25 cost time: 0.8377957344055176
Epoch: 25, Steps: 2 | Train Loss: 1.285 Vali Loss: 1.270 Vali Acc: 0.796 Test Loss: 1.270 Test Acc: 0.796
Validation loss decreased (-0.781468 --> -0.796284).  Saving model ...
Epoch: 26 cost time: 1.0490105152130127
Epoch: 26, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.236 Vali Acc: 0.807 Test Loss: 1.236 Test Acc: 0.807
Validation loss decreased (-0.796284 --> -0.807395).  Saving model ...
Epoch: 27 cost time: 0.8673808574676514
Epoch: 27, Steps: 2 | Train Loss: 1.146 Vali Loss: 1.201 Vali Acc: 0.826 Test Loss: 1.201 Test Acc: 0.826
Validation loss decreased (-0.807395 --> -0.825914).  Saving model ...
Epoch: 28 cost time: 0.8291728496551514
Epoch: 28, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.167 Vali Acc: 0.819 Test Loss: 1.167 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7599372863769531
Epoch: 29, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.133 Vali Acc: 0.844 Test Loss: 1.133 Test Acc: 0.844
Validation loss decreased (-0.825914 --> -0.844433).  Saving model ...
Epoch: 30 cost time: 0.8922786712646484
Epoch: 30, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.098 Vali Acc: 0.859 Test Loss: 1.098 Test Acc: 0.859
Validation loss decreased (-0.844433 --> -0.859248).  Saving model ...
Epoch: 31 cost time: 0.8180837631225586
Epoch: 31, Steps: 2 | Train Loss: 1.012 Vali Loss: 1.063 Vali Acc: 0.856 Test Loss: 1.063 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9495320320129395
Epoch: 32, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.027 Vali Acc: 0.863 Test Loss: 1.027 Test Acc: 0.863
Validation loss decreased (-0.859248 --> -0.862953).  Saving model ...
Epoch: 33 cost time: 0.8959529399871826
Epoch: 33, Steps: 2 | Train Loss: 0.919 Vali Loss: 0.992 Vali Acc: 0.863 Test Loss: 0.992 Test Acc: 0.863
Validation loss decreased (-0.862953 --> -0.862953).  Saving model ...
Epoch: 34 cost time: 0.7068531513214111
Epoch: 34, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.959 Vali Acc: 0.881 Test Loss: 0.959 Test Acc: 0.881
Validation loss decreased (-0.862953 --> -0.881472).  Saving model ...
Epoch: 35 cost time: 0.9737703800201416
Epoch: 35, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.926 Vali Acc: 0.889 Test Loss: 0.926 Test Acc: 0.889
Validation loss decreased (-0.881472 --> -0.888880).  Saving model ...
Epoch: 36 cost time: 0.6843044757843018
Epoch: 36, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.893 Vali Acc: 0.889 Test Loss: 0.893 Test Acc: 0.889
Validation loss decreased (-0.888880 --> -0.888880).  Saving model ...
Epoch: 37 cost time: 0.7681772708892822
Epoch: 37, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.862 Vali Acc: 0.881 Test Loss: 0.862 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8146088123321533
Epoch: 38, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.832 Vali Acc: 0.885 Test Loss: 0.832 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7079951763153076
Epoch: 39, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.802 Vali Acc: 0.881 Test Loss: 0.802 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6604633331298828
Epoch: 40, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.772 Vali Acc: 0.896 Test Loss: 0.772 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896289).  Saving model ...
Epoch: 41 cost time: 0.7197051048278809
Epoch: 41, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.745 Vali Acc: 0.889 Test Loss: 0.745 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7941064834594727
Epoch: 42, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.719 Vali Acc: 0.904 Test Loss: 0.719 Test Acc: 0.904
Validation loss decreased (-0.896289 --> -0.903697).  Saving model ...
Epoch: 43 cost time: 0.7757842540740967
Epoch: 43, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.695 Vali Acc: 0.896 Test Loss: 0.695 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8611128330230713
Epoch: 44, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.672 Vali Acc: 0.896 Test Loss: 0.672 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8843173980712891
Epoch: 45, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.651 Vali Acc: 0.893 Test Loss: 0.651 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.8648021221160889
Epoch: 46, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.631 Vali Acc: 0.889 Test Loss: 0.631 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8869233131408691
Epoch: 47, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.613 Vali Acc: 0.885 Test Loss: 0.613 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.8262255191802979
Epoch: 48, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.595 Vali Acc: 0.885 Test Loss: 0.595 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.9013702869415283
Epoch: 49, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.578 Vali Acc: 0.881 Test Loss: 0.578 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6517643928527832
Epoch: 50, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.562 Vali Acc: 0.885 Test Loss: 0.562 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.7585349082946777
Epoch: 51, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.545 Vali Acc: 0.889 Test Loss: 0.545 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.7497692108154297
Epoch: 52, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.529 Vali Acc: 0.893 Test Loss: 0.529 Test Acc: 0.893
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 175626
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.105696439743042
Epoch: 1, Steps: 2 | Train Loss: 1.958 Vali Loss: 1.886 Vali Acc: 0.222 Test Loss: 1.886 Test Acc: 0.222
Validation loss decreased (inf --> -0.222203).  Saving model ...
Epoch: 2 cost time: 0.6253588199615479
Epoch: 2, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.864 Vali Acc: 0.219 Test Loss: 1.864 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5939373970031738
Epoch: 3, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.849 Vali Acc: 0.219 Test Loss: 1.849 Test Acc: 0.219
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8267562389373779
Epoch: 4, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.835 Vali Acc: 0.233 Test Loss: 1.835 Test Acc: 0.233
Validation loss decreased (-0.222203 --> -0.233315).  Saving model ...
Epoch: 5 cost time: 0.666729211807251
Epoch: 5, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.816 Vali Acc: 0.233 Test Loss: 1.816 Test Acc: 0.233
Validation loss decreased (-0.233315 --> -0.233315).  Saving model ...
Epoch: 6 cost time: 0.7370321750640869
Epoch: 6, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.796 Vali Acc: 0.230 Test Loss: 1.796 Test Acc: 0.230
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8842952251434326
Epoch: 7, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.776 Vali Acc: 0.226 Test Loss: 1.776 Test Acc: 0.226
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6763479709625244
Epoch: 8, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.754 Vali Acc: 0.226 Test Loss: 1.754 Test Acc: 0.226
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.6306922435760498
Epoch: 9, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.731 Vali Acc: 0.233 Test Loss: 1.731 Test Acc: 0.233
Validation loss decreased (-0.233315 --> -0.233316).  Saving model ...
Epoch: 10 cost time: 0.6236190795898438
Epoch: 10, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.708 Vali Acc: 0.241 Test Loss: 1.708 Test Acc: 0.241
Validation loss decreased (-0.233316 --> -0.240724).  Saving model ...
Epoch: 11 cost time: 0.8862273693084717
Epoch: 11, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.685 Vali Acc: 0.281 Test Loss: 1.685 Test Acc: 0.281
Validation loss decreased (-0.240724 --> -0.281465).  Saving model ...
Epoch: 12 cost time: 0.8304426670074463
Epoch: 12, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.662 Vali Acc: 0.330 Test Loss: 1.662 Test Acc: 0.330
Validation loss decreased (-0.281465 --> -0.329613).  Saving model ...
Epoch: 13 cost time: 0.6331586837768555
Epoch: 13, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.639 Vali Acc: 0.415 Test Loss: 1.639 Test Acc: 0.415
Validation loss decreased (-0.329613 --> -0.414798).  Saving model ...
Epoch: 14 cost time: 0.773552656173706
Epoch: 14, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.615 Vali Acc: 0.459 Test Loss: 1.615 Test Acc: 0.459
Validation loss decreased (-0.414798 --> -0.459243).  Saving model ...
Epoch: 15 cost time: 0.7233176231384277
Epoch: 15, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.590 Vali Acc: 0.474 Test Loss: 1.590 Test Acc: 0.474
Validation loss decreased (-0.459243 --> -0.474058).  Saving model ...
Epoch: 16 cost time: 0.7068634033203125
Epoch: 16, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.565 Vali Acc: 0.493 Test Loss: 1.565 Test Acc: 0.493
Validation loss decreased (-0.474058 --> -0.492577).  Saving model ...
Epoch: 17 cost time: 0.866797685623169
Epoch: 17, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.537 Vali Acc: 0.530 Test Loss: 1.537 Test Acc: 0.530
Validation loss decreased (-0.492577 --> -0.529614).  Saving model ...
Epoch: 18 cost time: 0.6903531551361084
Epoch: 18, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.508 Vali Acc: 0.533 Test Loss: 1.508 Test Acc: 0.533
Validation loss decreased (-0.529614 --> -0.533318).  Saving model ...
Epoch: 19 cost time: 0.8381636142730713
Epoch: 19, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.477 Vali Acc: 0.556 Test Loss: 1.477 Test Acc: 0.556
Validation loss decreased (-0.533318 --> -0.555541).  Saving model ...
Epoch: 20 cost time: 0.7973899841308594
Epoch: 20, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.444 Vali Acc: 0.585 Test Loss: 1.444 Test Acc: 0.585
Validation loss decreased (-0.555541 --> -0.585171).  Saving model ...
Epoch: 21 cost time: 0.9670701026916504
Epoch: 21, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.410 Vali Acc: 0.600 Test Loss: 1.410 Test Acc: 0.600
Validation loss decreased (-0.585171 --> -0.599986).  Saving model ...
Epoch: 22 cost time: 0.7901065349578857
Epoch: 22, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.375 Vali Acc: 0.622 Test Loss: 1.375 Test Acc: 0.622
Validation loss decreased (-0.599986 --> -0.622208).  Saving model ...
Epoch: 23 cost time: 0.749516487121582
Epoch: 23, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.340 Vali Acc: 0.663 Test Loss: 1.340 Test Acc: 0.663
Validation loss decreased (-0.622208 --> -0.662950).  Saving model ...
Epoch: 24 cost time: 0.6828899383544922
Epoch: 24, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.302 Vali Acc: 0.689 Test Loss: 1.302 Test Acc: 0.689
Validation loss decreased (-0.662950 --> -0.688876).  Saving model ...
Epoch: 25 cost time: 0.930870532989502
Epoch: 25, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.264 Vali Acc: 0.707 Test Loss: 1.264 Test Acc: 0.707
Validation loss decreased (-0.688876 --> -0.707395).  Saving model ...
Epoch: 26 cost time: 0.7898159027099609
Epoch: 26, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.225 Vali Acc: 0.741 Test Loss: 1.225 Test Acc: 0.741
Validation loss decreased (-0.707395 --> -0.740728).  Saving model ...
Epoch: 27 cost time: 0.629833459854126
Epoch: 27, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.185 Vali Acc: 0.756 Test Loss: 1.185 Test Acc: 0.756
Validation loss decreased (-0.740728 --> -0.755544).  Saving model ...
Epoch: 28 cost time: 0.9087505340576172
Epoch: 28, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.146 Vali Acc: 0.778 Test Loss: 1.146 Test Acc: 0.778
Validation loss decreased (-0.755544 --> -0.777766).  Saving model ...
Epoch: 29 cost time: 0.9811549186706543
Epoch: 29, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.107 Vali Acc: 0.793 Test Loss: 1.107 Test Acc: 0.793
Validation loss decreased (-0.777766 --> -0.792582).  Saving model ...
Epoch: 30 cost time: 1.005321741104126
Epoch: 30, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.069 Vali Acc: 0.804 Test Loss: 1.069 Test Acc: 0.804
Validation loss decreased (-0.792582 --> -0.803693).  Saving model ...
Epoch: 31 cost time: 0.9926443099975586
Epoch: 31, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.031 Vali Acc: 0.800 Test Loss: 1.031 Test Acc: 0.800
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9860415458679199
Epoch: 32, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.994 Vali Acc: 0.807 Test Loss: 0.994 Test Acc: 0.807
Validation loss decreased (-0.803693 --> -0.807397).  Saving model ...
Epoch: 33 cost time: 0.8424608707427979
Epoch: 33, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.958 Vali Acc: 0.807 Test Loss: 0.958 Test Acc: 0.807
Validation loss decreased (-0.807397 --> -0.807398).  Saving model ...
Epoch: 34 cost time: 0.9088280200958252
Epoch: 34, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.922 Vali Acc: 0.815 Test Loss: 0.922 Test Acc: 0.815
Validation loss decreased (-0.807398 --> -0.814806).  Saving model ...
Epoch: 35 cost time: 0.7241404056549072
Epoch: 35, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.888 Vali Acc: 0.826 Test Loss: 0.888 Test Acc: 0.826
Validation loss decreased (-0.814806 --> -0.825917).  Saving model ...
Epoch: 36 cost time: 0.699617862701416
Epoch: 36, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.855 Vali Acc: 0.837 Test Loss: 0.855 Test Acc: 0.837
Validation loss decreased (-0.825917 --> -0.837028).  Saving model ...
Epoch: 37 cost time: 0.7173929214477539
Epoch: 37, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.824 Vali Acc: 0.841 Test Loss: 0.824 Test Acc: 0.841
Validation loss decreased (-0.837028 --> -0.840733).  Saving model ...
Epoch: 38 cost time: 0.6207222938537598
Epoch: 38, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.794 Vali Acc: 0.844 Test Loss: 0.794 Test Acc: 0.844
Validation loss decreased (-0.840733 --> -0.844437).  Saving model ...
Epoch: 39 cost time: 0.7978417873382568
Epoch: 39, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.766 Vali Acc: 0.844 Test Loss: 0.766 Test Acc: 0.844
Validation loss decreased (-0.844437 --> -0.844437).  Saving model ...
Epoch: 40 cost time: 0.658836841583252
Epoch: 40, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.740 Vali Acc: 0.848 Test Loss: 0.740 Test Acc: 0.848
Validation loss decreased (-0.844437 --> -0.848141).  Saving model ...
Epoch: 41 cost time: 0.5918750762939453
Epoch: 41, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.716 Vali Acc: 0.859 Test Loss: 0.716 Test Acc: 0.859
Validation loss decreased (-0.848141 --> -0.859252).  Saving model ...
Epoch: 42 cost time: 0.7773032188415527
Epoch: 42, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.693 Vali Acc: 0.859 Test Loss: 0.693 Test Acc: 0.859
Validation loss decreased (-0.859252 --> -0.859252).  Saving model ...
Epoch: 43 cost time: 0.6382367610931396
Epoch: 43, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.672 Vali Acc: 0.863 Test Loss: 0.672 Test Acc: 0.863
Validation loss decreased (-0.859252 --> -0.862956).  Saving model ...
Epoch: 44 cost time: 0.8315775394439697
Epoch: 44, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.652 Vali Acc: 0.863 Test Loss: 0.652 Test Acc: 0.863
Validation loss decreased (-0.862956 --> -0.862956).  Saving model ...
Epoch: 45 cost time: 0.8239080905914307
Epoch: 45, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.633 Vali Acc: 0.863 Test Loss: 0.633 Test Acc: 0.863
Validation loss decreased (-0.862956 --> -0.862957).  Saving model ...
Epoch: 46 cost time: 0.9171192646026611
Epoch: 46, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.616 Vali Acc: 0.874 Test Loss: 0.616 Test Acc: 0.874
Validation loss decreased (-0.862957 --> -0.874068).  Saving model ...
Epoch: 47 cost time: 0.6545805931091309
Epoch: 47, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.600 Vali Acc: 0.878 Test Loss: 0.600 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 48 cost time: 0.6724205017089844
Epoch: 48, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.586 Vali Acc: 0.878 Test Loss: 0.586 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 49 cost time: 0.7379999160766602
Epoch: 49, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.571 Vali Acc: 0.881 Test Loss: 0.571 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 50 cost time: 0.7815814018249512
Epoch: 50, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.556 Vali Acc: 0.881 Test Loss: 0.556 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 51 cost time: 1.055579662322998
Epoch: 51, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.542 Vali Acc: 0.885 Test Loss: 0.542 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 52 cost time: 0.7905135154724121
Epoch: 52, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.529 Vali Acc: 0.881 Test Loss: 0.529 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.8602044582366943
Epoch: 53, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.515 Vali Acc: 0.885 Test Loss: 0.515 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 54 cost time: 0.7005774974822998
Epoch: 54, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.504 Vali Acc: 0.893 Test Loss: 0.504 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892588).  Saving model ...
Epoch: 55 cost time: 0.8904151916503906
Epoch: 55, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.492 Vali Acc: 0.893 Test Loss: 0.492 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 56 cost time: 0.7658302783966064
Epoch: 56, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.482 Vali Acc: 0.889 Test Loss: 0.482 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7542359828948975
Epoch: 57, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.472 Vali Acc: 0.893 Test Loss: 0.472 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 58 cost time: 0.8084056377410889
Epoch: 58, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.463 Vali Acc: 0.896 Test Loss: 0.463 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 59 cost time: 0.6787068843841553
Epoch: 59, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.454 Vali Acc: 0.904 Test Loss: 0.454 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903699).  Saving model ...
Epoch: 60 cost time: 0.6938817501068115
Epoch: 60, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.445 Vali Acc: 0.904 Test Loss: 0.445 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 61 cost time: 0.7731094360351562
Epoch: 61, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.438 Vali Acc: 0.904 Test Loss: 0.438 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 62 cost time: 0.9505283832550049
Epoch: 62, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.430 Vali Acc: 0.904 Test Loss: 0.430 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 63 cost time: 0.803809404373169
Epoch: 63, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.424 Vali Acc: 0.907 Test Loss: 0.424 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 64 cost time: 0.7280173301696777
Epoch: 64, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.418 Vali Acc: 0.904 Test Loss: 0.418 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.6647961139678955
Epoch: 65, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.415 Vali Acc: 0.911 Test Loss: 0.415 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 66 cost time: 0.6194384098052979
Epoch: 66, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.411 Vali Acc: 0.907 Test Loss: 0.411 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.7961056232452393
Epoch: 67, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.407 Vali Acc: 0.907 Test Loss: 0.407 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.7388415336608887
Epoch: 68, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.402 Vali Acc: 0.907 Test Loss: 0.402 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.8050904273986816
Epoch: 69, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.396 Vali Acc: 0.904 Test Loss: 0.396 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.75937819480896
Epoch: 70, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.392 Vali Acc: 0.907 Test Loss: 0.392 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 71 cost time: 0.8070590496063232
Epoch: 71, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.386 Vali Acc: 0.904 Test Loss: 0.386 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 72 cost time: 0.7604362964630127
Epoch: 72, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.380 Vali Acc: 0.911 Test Loss: 0.380 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 73 cost time: 0.6979191303253174
Epoch: 73, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.374 Vali Acc: 0.911 Test Loss: 0.374 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 74 cost time: 0.8069257736206055
Epoch: 74, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 75 cost time: 0.8159425258636475
Epoch: 75, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.360 Vali Acc: 0.919 Test Loss: 0.360 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 76 cost time: 0.870375394821167
Epoch: 76, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.353 Vali Acc: 0.922 Test Loss: 0.353 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 77 cost time: 0.7019121646881104
Epoch: 77, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.348 Vali Acc: 0.922 Test Loss: 0.348 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 78 cost time: 0.9105474948883057
Epoch: 78, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 79 cost time: 0.6831908226013184
Epoch: 79, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 80 cost time: 0.7344424724578857
Epoch: 80, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.338 Vali Acc: 0.922 Test Loss: 0.338 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 81 cost time: 1.1400539875030518
Epoch: 81, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.335 Vali Acc: 0.922 Test Loss: 0.335 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 82 cost time: 0.7206902503967285
Epoch: 82, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.332 Vali Acc: 0.922 Test Loss: 0.332 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 83 cost time: 0.6500082015991211
Epoch: 83, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 84 cost time: 0.7488417625427246
Epoch: 84, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.326 Vali Acc: 0.922 Test Loss: 0.326 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 85 cost time: 0.7052156925201416
Epoch: 85, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.324 Vali Acc: 0.926 Test Loss: 0.324 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 86 cost time: 0.6141948699951172
Epoch: 86, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 87 cost time: 0.5734577178955078
Epoch: 87, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.319 Vali Acc: 0.926 Test Loss: 0.319 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 88 cost time: 0.7606551647186279
Epoch: 88, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.317 Vali Acc: 0.926 Test Loss: 0.317 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 89 cost time: 0.7811870574951172
Epoch: 89, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.315 Vali Acc: 0.926 Test Loss: 0.315 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 90 cost time: 0.8335912227630615
Epoch: 90, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.311 Vali Acc: 0.926 Test Loss: 0.311 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 91 cost time: 0.9001901149749756
Epoch: 91, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.308 Vali Acc: 0.926 Test Loss: 0.308 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 92 cost time: 0.7832610607147217
Epoch: 92, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 93 cost time: 1.0088531970977783
Epoch: 93, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.304 Vali Acc: 0.926 Test Loss: 0.304 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 94 cost time: 0.694286584854126
Epoch: 94, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.303 Vali Acc: 0.926 Test Loss: 0.303 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 95 cost time: 0.7217614650726318
Epoch: 95, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 96 cost time: 0.8187198638916016
Epoch: 96, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 97 cost time: 0.7950413227081299
Epoch: 97, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 98 cost time: 0.8078610897064209
Epoch: 98, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 99 cost time: 0.9705731868743896
Epoch: 99, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 100 cost time: 0.8855001926422119
Epoch: 100, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 175338
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.400228261947632
Epoch: 1, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.803 Vali Acc: 0.296 Test Loss: 1.803 Test Acc: 0.296
Validation loss decreased (inf --> -0.296278).  Saving model ...
Epoch: 2 cost time: 0.6805355548858643
Epoch: 2, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.789 Vali Acc: 0.304 Test Loss: 1.789 Test Acc: 0.304
Validation loss decreased (-0.296278 --> -0.303686).  Saving model ...
Epoch: 3 cost time: 0.7919001579284668
Epoch: 3, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.780 Vali Acc: 0.311 Test Loss: 1.780 Test Acc: 0.311
Validation loss decreased (-0.303686 --> -0.311093).  Saving model ...
Epoch: 4 cost time: 0.6655528545379639
Epoch: 4, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.771 Vali Acc: 0.315 Test Loss: 1.771 Test Acc: 0.315
Validation loss decreased (-0.311093 --> -0.314797).  Saving model ...
Epoch: 5 cost time: 0.8443887233734131
Epoch: 5, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.759 Vali Acc: 0.322 Test Loss: 1.759 Test Acc: 0.322
Validation loss decreased (-0.314797 --> -0.322205).  Saving model ...
Epoch: 6 cost time: 0.7889330387115479
Epoch: 6, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.747 Vali Acc: 0.311 Test Loss: 1.747 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7331104278564453
Epoch: 7, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.734 Vali Acc: 0.330 Test Loss: 1.734 Test Acc: 0.330
Validation loss decreased (-0.322205 --> -0.329612).  Saving model ...
Epoch: 8 cost time: 0.6773836612701416
Epoch: 8, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.720 Vali Acc: 0.307 Test Loss: 1.720 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6544740200042725
Epoch: 9, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.706 Vali Acc: 0.296 Test Loss: 1.706 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8111433982849121
Epoch: 10, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.692 Vali Acc: 0.296 Test Loss: 1.692 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7804529666900635
Epoch: 11, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.677 Vali Acc: 0.344 Test Loss: 1.677 Test Acc: 0.344
Validation loss decreased (-0.329612 --> -0.344428).  Saving model ...
Epoch: 12 cost time: 0.6525177955627441
Epoch: 12, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.662 Vali Acc: 0.381 Test Loss: 1.662 Test Acc: 0.381
Validation loss decreased (-0.344428 --> -0.381465).  Saving model ...
Epoch: 13 cost time: 0.5613675117492676
Epoch: 13, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.647 Vali Acc: 0.411 Test Loss: 1.647 Test Acc: 0.411
Validation loss decreased (-0.381465 --> -0.411095).  Saving model ...
Epoch: 14 cost time: 0.6830224990844727
Epoch: 14, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.632 Vali Acc: 0.433 Test Loss: 1.632 Test Acc: 0.433
Validation loss decreased (-0.411095 --> -0.433317).  Saving model ...
Epoch: 15 cost time: 0.6540279388427734
Epoch: 15, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.615 Vali Acc: 0.459 Test Loss: 1.615 Test Acc: 0.459
Validation loss decreased (-0.433317 --> -0.459243).  Saving model ...
Epoch: 16 cost time: 0.7078511714935303
Epoch: 16, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.597 Vali Acc: 0.489 Test Loss: 1.597 Test Acc: 0.489
Validation loss decreased (-0.459243 --> -0.488873).  Saving model ...
Epoch: 17 cost time: 0.6631226539611816
Epoch: 17, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.578 Vali Acc: 0.511 Test Loss: 1.578 Test Acc: 0.511
Validation loss decreased (-0.488873 --> -0.511095).  Saving model ...
Epoch: 18 cost time: 0.673137903213501
Epoch: 18, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.558 Vali Acc: 0.533 Test Loss: 1.558 Test Acc: 0.533
Validation loss decreased (-0.511095 --> -0.533318).  Saving model ...
Epoch: 19 cost time: 0.6075515747070312
Epoch: 19, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.537 Vali Acc: 0.548 Test Loss: 1.537 Test Acc: 0.548
Validation loss decreased (-0.533318 --> -0.548133).  Saving model ...
Epoch: 20 cost time: 0.5817837715148926
Epoch: 20, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.514 Vali Acc: 0.585 Test Loss: 1.514 Test Acc: 0.585
Validation loss decreased (-0.548133 --> -0.585170).  Saving model ...
Epoch: 21 cost time: 0.5261132717132568
Epoch: 21, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.489 Vali Acc: 0.611 Test Loss: 1.489 Test Acc: 0.611
Validation loss decreased (-0.585170 --> -0.611096).  Saving model ...
Epoch: 22 cost time: 0.7082464694976807
Epoch: 22, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.463 Vali Acc: 0.648 Test Loss: 1.463 Test Acc: 0.648
Validation loss decreased (-0.611096 --> -0.648134).  Saving model ...
Epoch: 23 cost time: 0.9862899780273438
Epoch: 23, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.436 Vali Acc: 0.663 Test Loss: 1.436 Test Acc: 0.663
Validation loss decreased (-0.648134 --> -0.662949).  Saving model ...
Epoch: 24 cost time: 0.643486499786377
Epoch: 24, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.408 Vali Acc: 0.678 Test Loss: 1.408 Test Acc: 0.678
Validation loss decreased (-0.662949 --> -0.677764).  Saving model ...
Epoch: 25 cost time: 0.5906896591186523
Epoch: 25, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.378 Vali Acc: 0.693 Test Loss: 1.378 Test Acc: 0.693
Validation loss decreased (-0.677764 --> -0.692579).  Saving model ...
Epoch: 26 cost time: 0.7264866828918457
Epoch: 26, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.348 Vali Acc: 0.696 Test Loss: 1.348 Test Acc: 0.696
Validation loss decreased (-0.692579 --> -0.696283).  Saving model ...
Epoch: 27 cost time: 0.80961012840271
Epoch: 27, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.317 Vali Acc: 0.719 Test Loss: 1.317 Test Acc: 0.719
Validation loss decreased (-0.696283 --> -0.718505).  Saving model ...
Epoch: 28 cost time: 0.889204740524292
Epoch: 28, Steps: 2 | Train Loss: 1.264 Vali Loss: 1.284 Vali Acc: 0.744 Test Loss: 1.284 Test Acc: 0.744
Validation loss decreased (-0.718505 --> -0.744432).  Saving model ...
Epoch: 29 cost time: 0.6707427501678467
Epoch: 29, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.249 Vali Acc: 0.767 Test Loss: 1.249 Test Acc: 0.767
Validation loss decreased (-0.744432 --> -0.766654).  Saving model ...
Epoch: 30 cost time: 0.7057244777679443
Epoch: 30, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.215 Vali Acc: 0.796 Test Loss: 1.215 Test Acc: 0.796
Validation loss decreased (-0.766654 --> -0.796284).  Saving model ...
Epoch: 31 cost time: 0.6156198978424072
Epoch: 31, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.180 Vali Acc: 0.793 Test Loss: 1.180 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6519412994384766
Epoch: 32, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.144 Vali Acc: 0.800 Test Loss: 1.144 Test Acc: 0.800
Validation loss decreased (-0.796284 --> -0.799989).  Saving model ...
Epoch: 33 cost time: 0.810783863067627
Epoch: 33, Steps: 2 | Train Loss: 1.071 Vali Loss: 1.108 Vali Acc: 0.807 Test Loss: 1.108 Test Acc: 0.807
Validation loss decreased (-0.799989 --> -0.807396).  Saving model ...
Epoch: 34 cost time: 0.7571372985839844
Epoch: 34, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.071 Vali Acc: 0.826 Test Loss: 1.071 Test Acc: 0.826
Validation loss decreased (-0.807396 --> -0.825915).  Saving model ...
Epoch: 35 cost time: 0.7074213027954102
Epoch: 35, Steps: 2 | Train Loss: 0.998 Vali Loss: 1.035 Vali Acc: 0.822 Test Loss: 1.035 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7211141586303711
Epoch: 36, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.999 Vali Acc: 0.833 Test Loss: 0.999 Test Acc: 0.833
Validation loss decreased (-0.825915 --> -0.833323).  Saving model ...
Epoch: 37 cost time: 0.7709102630615234
Epoch: 37, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.964 Vali Acc: 0.837 Test Loss: 0.964 Test Acc: 0.837
Validation loss decreased (-0.833323 --> -0.837027).  Saving model ...
Epoch: 38 cost time: 0.7364327907562256
Epoch: 38, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.929 Vali Acc: 0.841 Test Loss: 0.929 Test Acc: 0.841
Validation loss decreased (-0.837027 --> -0.840731).  Saving model ...
Epoch: 39 cost time: 0.6122016906738281
Epoch: 39, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.894 Vali Acc: 0.837 Test Loss: 0.894 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6322424411773682
Epoch: 40, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.860 Vali Acc: 0.837 Test Loss: 0.860 Test Acc: 0.837
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7063722610473633
Epoch: 41, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.828 Vali Acc: 0.856 Test Loss: 0.828 Test Acc: 0.856
Validation loss decreased (-0.840731 --> -0.855547).  Saving model ...
Epoch: 42 cost time: 0.7522556781768799
Epoch: 42, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.797 Vali Acc: 0.867 Test Loss: 0.797 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866659).  Saving model ...
Epoch: 43 cost time: 0.6509284973144531
Epoch: 43, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.767 Vali Acc: 0.881 Test Loss: 0.767 Test Acc: 0.881
Validation loss decreased (-0.866659 --> -0.881474).  Saving model ...
Epoch: 44 cost time: 0.616203784942627
Epoch: 44, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.739 Vali Acc: 0.889 Test Loss: 0.739 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888881).  Saving model ...
Epoch: 45 cost time: 0.6457359790802002
Epoch: 45, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.713 Vali Acc: 0.885 Test Loss: 0.713 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8248071670532227
Epoch: 46, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.688 Vali Acc: 0.885 Test Loss: 0.688 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6055881977081299
Epoch: 47, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.664 Vali Acc: 0.885 Test Loss: 0.664 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8097705841064453
Epoch: 48, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.641 Vali Acc: 0.885 Test Loss: 0.641 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.8032102584838867
Epoch: 49, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.620 Vali Acc: 0.885 Test Loss: 0.620 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7148089408874512
Epoch: 50, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.600 Vali Acc: 0.885 Test Loss: 0.600 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.7730491161346436
Epoch: 51, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.581 Vali Acc: 0.889 Test Loss: 0.581 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888883).  Saving model ...
Epoch: 52 cost time: 0.7257134914398193
Epoch: 52, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.564 Vali Acc: 0.893 Test Loss: 0.564 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 53 cost time: 0.6489732265472412
Epoch: 53, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.549 Vali Acc: 0.904 Test Loss: 0.549 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903698).  Saving model ...
Epoch: 54 cost time: 0.7777020931243896
Epoch: 54, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.534 Vali Acc: 0.900 Test Loss: 0.534 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.8147456645965576
Epoch: 55, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.520 Vali Acc: 0.900 Test Loss: 0.520 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.8493087291717529
Epoch: 56, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.507 Vali Acc: 0.911 Test Loss: 0.507 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 57 cost time: 0.5976943969726562
Epoch: 57, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.496 Vali Acc: 0.907 Test Loss: 0.496 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6804955005645752
Epoch: 58, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.485 Vali Acc: 0.911 Test Loss: 0.485 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 59 cost time: 0.6722395420074463
Epoch: 59, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.474 Vali Acc: 0.911 Test Loss: 0.474 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 60 cost time: 0.6990494728088379
Epoch: 60, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.465 Vali Acc: 0.911 Test Loss: 0.465 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 61 cost time: 0.8904168605804443
Epoch: 61, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.455 Vali Acc: 0.911 Test Loss: 0.455 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 62 cost time: 0.6723856925964355
Epoch: 62, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.445 Vali Acc: 0.911 Test Loss: 0.445 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 63 cost time: 0.5905091762542725
Epoch: 63, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.436 Vali Acc: 0.911 Test Loss: 0.436 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 64 cost time: 0.6784589290618896
Epoch: 64, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.428 Vali Acc: 0.911 Test Loss: 0.428 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 65 cost time: 0.6637063026428223
Epoch: 65, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.418 Vali Acc: 0.911 Test Loss: 0.418 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 66 cost time: 0.6425652503967285
Epoch: 66, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.410 Vali Acc: 0.915 Test Loss: 0.410 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 67 cost time: 0.6499533653259277
Epoch: 67, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.403 Vali Acc: 0.915 Test Loss: 0.403 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 68 cost time: 0.7462120056152344
Epoch: 68, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.399 Vali Acc: 0.911 Test Loss: 0.399 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.8149995803833008
Epoch: 69, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.393 Vali Acc: 0.911 Test Loss: 0.393 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.682551383972168
Epoch: 70, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.388 Vali Acc: 0.911 Test Loss: 0.388 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.7181587219238281
Epoch: 71, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.381 Vali Acc: 0.911 Test Loss: 0.381 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.7569854259490967
Epoch: 72, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.376 Vali Acc: 0.911 Test Loss: 0.376 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.8838274478912354
Epoch: 73, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.371 Vali Acc: 0.915 Test Loss: 0.371 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 74 cost time: 0.7498254776000977
Epoch: 74, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 75 cost time: 0.7612817287445068
Epoch: 75, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.363 Vali Acc: 0.919 Test Loss: 0.363 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 76 cost time: 0.7575500011444092
Epoch: 76, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.359 Vali Acc: 0.919 Test Loss: 0.359 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 77 cost time: 0.6532864570617676
Epoch: 77, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.354 Vali Acc: 0.919 Test Loss: 0.354 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 78 cost time: 0.6420860290527344
Epoch: 78, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.350 Vali Acc: 0.919 Test Loss: 0.350 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 79 cost time: 0.6942040920257568
Epoch: 79, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.344 Vali Acc: 0.919 Test Loss: 0.344 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 80 cost time: 0.7165992259979248
Epoch: 80, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.340 Vali Acc: 0.922 Test Loss: 0.340 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 81 cost time: 0.7299704551696777
Epoch: 81, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.335 Vali Acc: 0.922 Test Loss: 0.335 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 82 cost time: 0.7165324687957764
Epoch: 82, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.332 Vali Acc: 0.922 Test Loss: 0.332 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 83 cost time: 0.7538018226623535
Epoch: 83, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.329 Vali Acc: 0.922 Test Loss: 0.329 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 84 cost time: 0.8125917911529541
Epoch: 84, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 85 cost time: 0.585552453994751
Epoch: 85, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 86 cost time: 0.7776627540588379
Epoch: 86, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.320 Vali Acc: 0.926 Test Loss: 0.320 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 87 cost time: 0.7566766738891602
Epoch: 87, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.316 Vali Acc: 0.926 Test Loss: 0.316 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 88 cost time: 0.7370262145996094
Epoch: 88, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.313 Vali Acc: 0.926 Test Loss: 0.313 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 89 cost time: 0.7144701480865479
Epoch: 89, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 90 cost time: 0.584155797958374
Epoch: 90, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 91 cost time: 0.8572981357574463
Epoch: 91, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 92 cost time: 0.6085600852966309
Epoch: 92, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.304 Vali Acc: 0.926 Test Loss: 0.304 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 93 cost time: 0.760953426361084
Epoch: 93, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.303 Vali Acc: 0.926 Test Loss: 0.303 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 94 cost time: 0.7169272899627686
Epoch: 94, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.7122848033905029
Epoch: 95, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.300 Vali Acc: 0.926 Test Loss: 0.300 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 96 cost time: 0.6445868015289307
Epoch: 96, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 97 cost time: 0.7699780464172363
Epoch: 97, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 98 cost time: 0.6528239250183105
Epoch: 98, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 99 cost time: 0.6980407238006592
Epoch: 99, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 100 cost time: 0.6542477607727051
Epoch: 100, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 175050
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2532894611358643
Epoch: 1, Steps: 2 | Train Loss: 2.007 Vali Loss: 1.913 Vali Acc: 0.178 Test Loss: 1.913 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.8897144794464111
Epoch: 2, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.893 Vali Acc: 0.185 Test Loss: 1.893 Test Acc: 0.185
Validation loss decreased (-0.177759 --> -0.185166).  Saving model ...
Epoch: 3 cost time: 0.8628389835357666
Epoch: 3, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.878 Vali Acc: 0.178 Test Loss: 1.878 Test Acc: 0.178
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6835391521453857
Epoch: 4, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.865 Vali Acc: 0.170 Test Loss: 1.865 Test Acc: 0.170
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6718435287475586
Epoch: 5, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.849 Vali Acc: 0.163 Test Loss: 1.849 Test Acc: 0.163
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.7669532299041748
Epoch: 6, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.831 Vali Acc: 0.174 Test Loss: 1.831 Test Acc: 0.174
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 0.6971282958984375
Epoch: 7, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.813 Vali Acc: 0.193 Test Loss: 1.813 Test Acc: 0.193
Validation loss decreased (-0.185166 --> -0.192574).  Saving model ...
Epoch: 8 cost time: 0.6855318546295166
Epoch: 8, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.796 Vali Acc: 0.207 Test Loss: 1.796 Test Acc: 0.207
Validation loss decreased (-0.192574 --> -0.207389).  Saving model ...
Epoch: 9 cost time: 0.7026078701019287
Epoch: 9, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.777 Vali Acc: 0.219 Test Loss: 1.777 Test Acc: 0.219
Validation loss decreased (-0.207389 --> -0.218501).  Saving model ...
Epoch: 10 cost time: 0.7159159183502197
Epoch: 10, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.760 Vali Acc: 0.233 Test Loss: 1.760 Test Acc: 0.233
Validation loss decreased (-0.218501 --> -0.233316).  Saving model ...
Epoch: 11 cost time: 1.0144236087799072
Epoch: 11, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.742 Vali Acc: 0.256 Test Loss: 1.742 Test Acc: 0.256
Validation loss decreased (-0.233316 --> -0.255538).  Saving model ...
Epoch: 12 cost time: 0.6588540077209473
Epoch: 12, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.723 Vali Acc: 0.278 Test Loss: 1.723 Test Acc: 0.278
Validation loss decreased (-0.255538 --> -0.277761).  Saving model ...
Epoch: 13 cost time: 0.5766351222991943
Epoch: 13, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.705 Vali Acc: 0.311 Test Loss: 1.705 Test Acc: 0.311
Validation loss decreased (-0.277761 --> -0.311094).  Saving model ...
Epoch: 14 cost time: 0.7667357921600342
Epoch: 14, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.687 Vali Acc: 0.374 Test Loss: 1.687 Test Acc: 0.374
Validation loss decreased (-0.311094 --> -0.374057).  Saving model ...
Epoch: 15 cost time: 0.6524138450622559
Epoch: 15, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.669 Vali Acc: 0.396 Test Loss: 1.669 Test Acc: 0.396
Validation loss decreased (-0.374057 --> -0.396280).  Saving model ...
Epoch: 16 cost time: 0.9042675495147705
Epoch: 16, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.651 Vali Acc: 0.437 Test Loss: 1.651 Test Acc: 0.437
Validation loss decreased (-0.396280 --> -0.437021).  Saving model ...
Epoch: 17 cost time: 0.8426418304443359
Epoch: 17, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.631 Vali Acc: 0.441 Test Loss: 1.631 Test Acc: 0.441
Validation loss decreased (-0.437021 --> -0.440724).  Saving model ...
Epoch: 18 cost time: 0.7989389896392822
Epoch: 18, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.610 Vali Acc: 0.463 Test Loss: 1.610 Test Acc: 0.463
Validation loss decreased (-0.440724 --> -0.462947).  Saving model ...
Epoch: 19 cost time: 0.9030447006225586
Epoch: 19, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.587 Vali Acc: 0.478 Test Loss: 1.587 Test Acc: 0.478
Validation loss decreased (-0.462947 --> -0.477762).  Saving model ...
Epoch: 20 cost time: 0.6755907535552979
Epoch: 20, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.563 Vali Acc: 0.515 Test Loss: 1.563 Test Acc: 0.515
Validation loss decreased (-0.477762 --> -0.514799).  Saving model ...
Epoch: 21 cost time: 0.7969210147857666
Epoch: 21, Steps: 2 | Train Loss: 1.601 Vali Loss: 1.538 Vali Acc: 0.541 Test Loss: 1.538 Test Acc: 0.541
Validation loss decreased (-0.514799 --> -0.540725).  Saving model ...
Epoch: 22 cost time: 0.7600624561309814
Epoch: 22, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.512 Vali Acc: 0.581 Test Loss: 1.512 Test Acc: 0.581
Validation loss decreased (-0.540725 --> -0.581466).  Saving model ...
Epoch: 23 cost time: 0.8653049468994141
Epoch: 23, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.485 Vali Acc: 0.604 Test Loss: 1.485 Test Acc: 0.604
Validation loss decreased (-0.581466 --> -0.603689).  Saving model ...
Epoch: 24 cost time: 0.8097472190856934
Epoch: 24, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.456 Vali Acc: 0.641 Test Loss: 1.456 Test Acc: 0.641
Validation loss decreased (-0.603689 --> -0.640726).  Saving model ...
Epoch: 25 cost time: 0.7274751663208008
Epoch: 25, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.426 Vali Acc: 0.674 Test Loss: 1.426 Test Acc: 0.674
Validation loss decreased (-0.640726 --> -0.674060).  Saving model ...
Epoch: 26 cost time: 0.8694133758544922
Epoch: 26, Steps: 2 | Train Loss: 1.362 Vali Loss: 1.396 Vali Acc: 0.678 Test Loss: 1.396 Test Acc: 0.678
Validation loss decreased (-0.674060 --> -0.677764).  Saving model ...
Epoch: 27 cost time: 0.7438371181488037
Epoch: 27, Steps: 2 | Train Loss: 1.349 Vali Loss: 1.365 Vali Acc: 0.700 Test Loss: 1.365 Test Acc: 0.700
Validation loss decreased (-0.677764 --> -0.699986).  Saving model ...
Epoch: 28 cost time: 0.6541686058044434
Epoch: 28, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.332 Vali Acc: 0.719 Test Loss: 1.332 Test Acc: 0.719
Validation loss decreased (-0.699986 --> -0.718505).  Saving model ...
Epoch: 29 cost time: 0.7040855884552002
Epoch: 29, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.296 Vali Acc: 0.741 Test Loss: 1.296 Test Acc: 0.741
Validation loss decreased (-0.718505 --> -0.740728).  Saving model ...
Epoch: 30 cost time: 0.804856538772583
Epoch: 30, Steps: 2 | Train Loss: 1.204 Vali Loss: 1.260 Vali Acc: 0.763 Test Loss: 1.260 Test Acc: 0.763
Validation loss decreased (-0.740728 --> -0.762950).  Saving model ...
Epoch: 31 cost time: 0.7219336032867432
Epoch: 31, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.222 Vali Acc: 0.774 Test Loss: 1.222 Test Acc: 0.774
Validation loss decreased (-0.762950 --> -0.774062).  Saving model ...
Epoch: 32 cost time: 0.8004851341247559
Epoch: 32, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.185 Vali Acc: 0.789 Test Loss: 1.185 Test Acc: 0.789
Validation loss decreased (-0.774062 --> -0.788877).  Saving model ...
Epoch: 33 cost time: 0.7092697620391846
Epoch: 33, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.148 Vali Acc: 0.789 Test Loss: 1.148 Test Acc: 0.789
Validation loss decreased (-0.788877 --> -0.788877).  Saving model ...
Epoch: 34 cost time: 0.7416472434997559
Epoch: 34, Steps: 2 | Train Loss: 1.054 Vali Loss: 1.110 Vali Acc: 0.800 Test Loss: 1.110 Test Acc: 0.800
Validation loss decreased (-0.788877 --> -0.799989).  Saving model ...
Epoch: 35 cost time: 0.7246901988983154
Epoch: 35, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.072 Vali Acc: 0.815 Test Loss: 1.072 Test Acc: 0.815
Validation loss decreased (-0.799989 --> -0.814804).  Saving model ...
Epoch: 36 cost time: 0.805640459060669
Epoch: 36, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.034 Vali Acc: 0.819 Test Loss: 1.034 Test Acc: 0.819
Validation loss decreased (-0.814804 --> -0.818508).  Saving model ...
Epoch: 37 cost time: 0.7685823440551758
Epoch: 37, Steps: 2 | Train Loss: 0.982 Vali Loss: 0.996 Vali Acc: 0.833 Test Loss: 0.996 Test Acc: 0.833
Validation loss decreased (-0.818508 --> -0.833323).  Saving model ...
Epoch: 38 cost time: 1.1854755878448486
Epoch: 38, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.958 Vali Acc: 0.852 Test Loss: 0.958 Test Acc: 0.852
Validation loss decreased (-0.833323 --> -0.851842).  Saving model ...
Epoch: 39 cost time: 0.9054064750671387
Epoch: 39, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.920 Vali Acc: 0.856 Test Loss: 0.920 Test Acc: 0.856
Validation loss decreased (-0.851842 --> -0.855546).  Saving model ...
Epoch: 40 cost time: 0.7695324420928955
Epoch: 40, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.882 Vali Acc: 0.867 Test Loss: 0.882 Test Acc: 0.867
Validation loss decreased (-0.855546 --> -0.866658).  Saving model ...
Epoch: 41 cost time: 0.8986301422119141
Epoch: 41, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.846 Vali Acc: 0.874 Test Loss: 0.846 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 42 cost time: 0.9398977756500244
Epoch: 42, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.811 Vali Acc: 0.904 Test Loss: 0.811 Test Acc: 0.904
Validation loss decreased (-0.874066 --> -0.903696).  Saving model ...
Epoch: 43 cost time: 0.6866450309753418
Epoch: 43, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.778 Vali Acc: 0.900 Test Loss: 0.778 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9781413078308105
Epoch: 44, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.748 Vali Acc: 0.893 Test Loss: 0.748 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.197925090789795
Epoch: 45, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.719 Vali Acc: 0.893 Test Loss: 0.719 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7902481555938721
Epoch: 46, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.691 Vali Acc: 0.893 Test Loss: 0.691 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7668507099151611
Epoch: 47, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.665 Vali Acc: 0.900 Test Loss: 0.665 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.7991657257080078
Epoch: 48, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6041386127471924
Epoch: 49, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.619 Vali Acc: 0.900 Test Loss: 0.619 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6417760848999023
Epoch: 50, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.598 Vali Acc: 0.915 Test Loss: 0.598 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914809).  Saving model ...
Epoch: 51 cost time: 0.6923754215240479
Epoch: 51, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.579 Vali Acc: 0.907 Test Loss: 0.579 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.8117177486419678
Epoch: 52, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.561 Vali Acc: 0.911 Test Loss: 0.561 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.9148924350738525
Epoch: 53, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.544 Vali Acc: 0.911 Test Loss: 0.544 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.8830311298370361
Epoch: 54, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.529 Vali Acc: 0.911 Test Loss: 0.529 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.7997512817382812
Epoch: 55, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.515 Vali Acc: 0.907 Test Loss: 0.515 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.6524558067321777
Epoch: 56, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.501 Vali Acc: 0.907 Test Loss: 0.501 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.723325252532959
Epoch: 57, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.488 Vali Acc: 0.911 Test Loss: 0.488 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.6140499114990234
Epoch: 58, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.475 Vali Acc: 0.919 Test Loss: 0.475 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918514).  Saving model ...
Epoch: 59 cost time: 0.6225380897521973
Epoch: 59, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.464 Vali Acc: 0.915 Test Loss: 0.464 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.8071367740631104
Epoch: 60, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.453 Vali Acc: 0.915 Test Loss: 0.453 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6711769104003906
Epoch: 61, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.445 Vali Acc: 0.911 Test Loss: 0.445 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.9551646709442139
Epoch: 62, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.436 Vali Acc: 0.915 Test Loss: 0.436 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.8702530860900879
Epoch: 63, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.428 Vali Acc: 0.915 Test Loss: 0.428 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.7907230854034424
Epoch: 64, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.419 Vali Acc: 0.915 Test Loss: 0.419 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.8234701156616211
Epoch: 65, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.410 Vali Acc: 0.919 Test Loss: 0.410 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 66 cost time: 0.6758420467376709
Epoch: 66, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.402 Vali Acc: 0.915 Test Loss: 0.402 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.8158142566680908
Epoch: 67, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.395 Vali Acc: 0.919 Test Loss: 0.395 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 68 cost time: 0.7062408924102783
Epoch: 68, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.388 Vali Acc: 0.919 Test Loss: 0.388 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 69 cost time: 0.7369177341461182
Epoch: 69, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.382 Vali Acc: 0.919 Test Loss: 0.382 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 70 cost time: 0.6141190528869629
Epoch: 70, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.377 Vali Acc: 0.926 Test Loss: 0.377 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925922).  Saving model ...
Epoch: 71 cost time: 0.7752230167388916
Epoch: 71, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.373 Vali Acc: 0.926 Test Loss: 0.373 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 72 cost time: 0.8614771366119385
Epoch: 72, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.368 Vali Acc: 0.926 Test Loss: 0.368 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 73 cost time: 0.7262349128723145
Epoch: 73, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.363 Vali Acc: 0.930 Test Loss: 0.363 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 74 cost time: 0.8358681201934814
Epoch: 74, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.358 Vali Acc: 0.930 Test Loss: 0.358 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 75 cost time: 0.9112367630004883
Epoch: 75, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.352 Vali Acc: 0.933 Test Loss: 0.352 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 76 cost time: 0.8087782859802246
Epoch: 76, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.347 Vali Acc: 0.930 Test Loss: 0.347 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7989170551300049
Epoch: 77, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.341 Vali Acc: 0.933 Test Loss: 0.341 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 78 cost time: 0.7778127193450928
Epoch: 78, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.336 Vali Acc: 0.933 Test Loss: 0.336 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 79 cost time: 0.792147159576416
Epoch: 79, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.331 Vali Acc: 0.933 Test Loss: 0.331 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 80 cost time: 0.718531608581543
Epoch: 80, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.326 Vali Acc: 0.933 Test Loss: 0.326 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 81 cost time: 0.6792500019073486
Epoch: 81, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.322 Vali Acc: 0.933 Test Loss: 0.322 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 82 cost time: 0.8397877216339111
Epoch: 82, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.318 Vali Acc: 0.933 Test Loss: 0.318 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 83 cost time: 0.8593668937683105
Epoch: 83, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 84 cost time: 0.8945167064666748
Epoch: 84, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.312 Vali Acc: 0.933 Test Loss: 0.312 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 85 cost time: 0.915989875793457
Epoch: 85, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.310 Vali Acc: 0.933 Test Loss: 0.310 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 86 cost time: 0.8235640525817871
Epoch: 86, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 87 cost time: 0.6534223556518555
Epoch: 87, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.306 Vali Acc: 0.933 Test Loss: 0.306 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 88 cost time: 0.6476473808288574
Epoch: 88, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.304 Vali Acc: 0.933 Test Loss: 0.304 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 89 cost time: 0.7069947719573975
Epoch: 89, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 90 cost time: 1.0010266304016113
Epoch: 90, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 91 cost time: 0.8713958263397217
Epoch: 91, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.296 Vali Acc: 0.933 Test Loss: 0.296 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 92 cost time: 0.8680920600891113
Epoch: 92, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 93 cost time: 0.6566522121429443
Epoch: 93, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 94 cost time: 0.6231381893157959
Epoch: 94, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.287 Vali Acc: 0.937 Test Loss: 0.287 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 95 cost time: 0.5931470394134521
Epoch: 95, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 96 cost time: 0.7778518199920654
Epoch: 96, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 97 cost time: 0.6908376216888428
Epoch: 97, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 98 cost time: 0.7190995216369629
Epoch: 98, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.7146685123443604
Epoch: 99, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.717980146408081
Epoch: 100, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 174762
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4875266551971436
Epoch: 1, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.892 Vali Acc: 0.100 Test Loss: 1.892 Test Acc: 0.100
Validation loss decreased (inf --> -0.099981).  Saving model ...
Epoch: 2 cost time: 0.6933290958404541
Epoch: 2, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.872 Vali Acc: 0.096 Test Loss: 1.872 Test Acc: 0.096
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6824815273284912
Epoch: 3, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.858 Vali Acc: 0.119 Test Loss: 1.858 Test Acc: 0.119
Validation loss decreased (-0.099981 --> -0.118500).  Saving model ...
Epoch: 4 cost time: 0.5890936851501465
Epoch: 4, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.847 Vali Acc: 0.122 Test Loss: 1.847 Test Acc: 0.122
Validation loss decreased (-0.118500 --> -0.122204).  Saving model ...
Epoch: 5 cost time: 0.6928207874298096
Epoch: 5, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.833 Vali Acc: 0.152 Test Loss: 1.833 Test Acc: 0.152
Validation loss decreased (-0.122204 --> -0.151834).  Saving model ...
Epoch: 6 cost time: 0.6678066253662109
Epoch: 6, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.817 Vali Acc: 0.163 Test Loss: 1.817 Test Acc: 0.163
Validation loss decreased (-0.151834 --> -0.162945).  Saving model ...
Epoch: 7 cost time: 0.6804723739624023
Epoch: 7, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.800 Vali Acc: 0.152 Test Loss: 1.800 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7560830116271973
Epoch: 8, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.783 Vali Acc: 0.170 Test Loss: 1.783 Test Acc: 0.170
Validation loss decreased (-0.162945 --> -0.170353).  Saving model ...
Epoch: 9 cost time: 0.664475679397583
Epoch: 9, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.765 Vali Acc: 0.185 Test Loss: 1.765 Test Acc: 0.185
Validation loss decreased (-0.170353 --> -0.185168).  Saving model ...
Epoch: 10 cost time: 0.6701900959014893
Epoch: 10, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.747 Vali Acc: 0.200 Test Loss: 1.747 Test Acc: 0.200
Validation loss decreased (-0.185168 --> -0.199983).  Saving model ...
Epoch: 11 cost time: 0.8109676837921143
Epoch: 11, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.728 Vali Acc: 0.244 Test Loss: 1.728 Test Acc: 0.244
Validation loss decreased (-0.199983 --> -0.244427).  Saving model ...
Epoch: 12 cost time: 0.6973955631256104
Epoch: 12, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.709 Vali Acc: 0.259 Test Loss: 1.709 Test Acc: 0.259
Validation loss decreased (-0.244427 --> -0.259242).  Saving model ...
Epoch: 13 cost time: 0.771937370300293
Epoch: 13, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.689 Vali Acc: 0.281 Test Loss: 1.689 Test Acc: 0.281
Validation loss decreased (-0.259242 --> -0.281465).  Saving model ...
Epoch: 14 cost time: 0.7315471172332764
Epoch: 14, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.668 Vali Acc: 0.307 Test Loss: 1.668 Test Acc: 0.307
Validation loss decreased (-0.281465 --> -0.307391).  Saving model ...
Epoch: 15 cost time: 0.6531379222869873
Epoch: 15, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.647 Vali Acc: 0.330 Test Loss: 1.647 Test Acc: 0.330
Validation loss decreased (-0.307391 --> -0.329613).  Saving model ...
Epoch: 16 cost time: 0.6719069480895996
Epoch: 16, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.624 Vali Acc: 0.385 Test Loss: 1.624 Test Acc: 0.385
Validation loss decreased (-0.329613 --> -0.385169).  Saving model ...
Epoch: 17 cost time: 0.6316208839416504
Epoch: 17, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.600 Vali Acc: 0.430 Test Loss: 1.600 Test Acc: 0.430
Validation loss decreased (-0.385169 --> -0.429614).  Saving model ...
Epoch: 18 cost time: 0.6338517665863037
Epoch: 18, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.575 Vali Acc: 0.463 Test Loss: 1.575 Test Acc: 0.463
Validation loss decreased (-0.429614 --> -0.462947).  Saving model ...
Epoch: 19 cost time: 0.6300663948059082
Epoch: 19, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.548 Vali Acc: 0.485 Test Loss: 1.548 Test Acc: 0.485
Validation loss decreased (-0.462947 --> -0.485170).  Saving model ...
Epoch: 20 cost time: 0.576873779296875
Epoch: 20, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.522 Vali Acc: 0.530 Test Loss: 1.522 Test Acc: 0.530
Validation loss decreased (-0.485170 --> -0.529614).  Saving model ...
Epoch: 21 cost time: 0.6851439476013184
Epoch: 21, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.494 Vali Acc: 0.563 Test Loss: 1.494 Test Acc: 0.563
Validation loss decreased (-0.529614 --> -0.562948).  Saving model ...
Epoch: 22 cost time: 0.7856941223144531
Epoch: 22, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.464 Vali Acc: 0.593 Test Loss: 1.464 Test Acc: 0.593
Validation loss decreased (-0.562948 --> -0.592578).  Saving model ...
Epoch: 23 cost time: 0.711237907409668
Epoch: 23, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.435 Vali Acc: 0.619 Test Loss: 1.435 Test Acc: 0.619
Validation loss decreased (-0.592578 --> -0.618504).  Saving model ...
Epoch: 24 cost time: 0.7325685024261475
Epoch: 24, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.404 Vali Acc: 0.622 Test Loss: 1.404 Test Acc: 0.622
Validation loss decreased (-0.618504 --> -0.622208).  Saving model ...
Epoch: 25 cost time: 0.9054117202758789
Epoch: 25, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.373 Vali Acc: 0.656 Test Loss: 1.373 Test Acc: 0.656
Validation loss decreased (-0.622208 --> -0.655542).  Saving model ...
Epoch: 26 cost time: 0.7284564971923828
Epoch: 26, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.340 Vali Acc: 0.681 Test Loss: 1.340 Test Acc: 0.681
Validation loss decreased (-0.655542 --> -0.681468).  Saving model ...
Epoch: 27 cost time: 0.6204016208648682
Epoch: 27, Steps: 2 | Train Loss: 1.309 Vali Loss: 1.307 Vali Acc: 0.719 Test Loss: 1.307 Test Acc: 0.719
Validation loss decreased (-0.681468 --> -0.718505).  Saving model ...
Epoch: 28 cost time: 0.6840143203735352
Epoch: 28, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.272 Vali Acc: 0.730 Test Loss: 1.272 Test Acc: 0.730
Validation loss decreased (-0.718505 --> -0.729617).  Saving model ...
Epoch: 29 cost time: 0.7795844078063965
Epoch: 29, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.237 Vali Acc: 0.733 Test Loss: 1.237 Test Acc: 0.733
Validation loss decreased (-0.729617 --> -0.733321).  Saving model ...
Epoch: 30 cost time: 0.7237527370452881
Epoch: 30, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.200 Vali Acc: 0.744 Test Loss: 1.200 Test Acc: 0.744
Validation loss decreased (-0.733321 --> -0.744432).  Saving model ...
Epoch: 31 cost time: 0.8066282272338867
Epoch: 31, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.163 Vali Acc: 0.756 Test Loss: 1.163 Test Acc: 0.756
Validation loss decreased (-0.744432 --> -0.755544).  Saving model ...
Epoch: 32 cost time: 0.6778008937835693
Epoch: 32, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.126 Vali Acc: 0.774 Test Loss: 1.126 Test Acc: 0.774
Validation loss decreased (-0.755544 --> -0.774063).  Saving model ...
Epoch: 33 cost time: 0.6243062019348145
Epoch: 33, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.088 Vali Acc: 0.781 Test Loss: 1.088 Test Acc: 0.781
Validation loss decreased (-0.774063 --> -0.781471).  Saving model ...
Epoch: 34 cost time: 0.7456839084625244
Epoch: 34, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.052 Vali Acc: 0.796 Test Loss: 1.052 Test Acc: 0.796
Validation loss decreased (-0.781471 --> -0.796286).  Saving model ...
Epoch: 35 cost time: 0.622502326965332
Epoch: 35, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.016 Vali Acc: 0.793 Test Loss: 1.016 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6508831977844238
Epoch: 36, Steps: 2 | Train Loss: 0.956 Vali Loss: 0.980 Vali Acc: 0.789 Test Loss: 0.980 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5980916023254395
Epoch: 37, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.946 Vali Acc: 0.804 Test Loss: 0.946 Test Acc: 0.804
Validation loss decreased (-0.796286 --> -0.803694).  Saving model ...
Epoch: 38 cost time: 0.6450939178466797
Epoch: 38, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.912 Vali Acc: 0.811 Test Loss: 0.912 Test Acc: 0.811
Validation loss decreased (-0.803694 --> -0.811102).  Saving model ...
Epoch: 39 cost time: 0.7295801639556885
Epoch: 39, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.879 Vali Acc: 0.815 Test Loss: 0.879 Test Acc: 0.815
Validation loss decreased (-0.811102 --> -0.814806).  Saving model ...
Epoch: 40 cost time: 0.7248413562774658
Epoch: 40, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.847 Vali Acc: 0.822 Test Loss: 0.847 Test Acc: 0.822
Validation loss decreased (-0.814806 --> -0.822214).  Saving model ...
Epoch: 41 cost time: 0.7521352767944336
Epoch: 41, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.817 Vali Acc: 0.819 Test Loss: 0.817 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6689765453338623
Epoch: 42, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.788 Vali Acc: 0.833 Test Loss: 0.788 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833325).  Saving model ...
Epoch: 43 cost time: 0.7520802021026611
Epoch: 43, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.761 Vali Acc: 0.833 Test Loss: 0.761 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833326).  Saving model ...
Epoch: 44 cost time: 0.7122297286987305
Epoch: 44, Steps: 2 | Train Loss: 0.640 Vali Loss: 0.735 Vali Acc: 0.841 Test Loss: 0.735 Test Acc: 0.841
Validation loss decreased (-0.833326 --> -0.840733).  Saving model ...
Epoch: 45 cost time: 0.7093439102172852
Epoch: 45, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.709 Vali Acc: 0.841 Test Loss: 0.709 Test Acc: 0.841
Validation loss decreased (-0.840733 --> -0.840734).  Saving model ...
Epoch: 46 cost time: 0.7069225311279297
Epoch: 46, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.685 Vali Acc: 0.852 Test Loss: 0.685 Test Acc: 0.852
Validation loss decreased (-0.840734 --> -0.851845).  Saving model ...
Epoch: 47 cost time: 0.71016526222229
Epoch: 47, Steps: 2 | Train Loss: 0.541 Vali Loss: 0.663 Vali Acc: 0.863 Test Loss: 0.663 Test Acc: 0.863
Validation loss decreased (-0.851845 --> -0.862956).  Saving model ...
Epoch: 48 cost time: 0.7016768455505371
Epoch: 48, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.641 Vali Acc: 0.874 Test Loss: 0.641 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874068).  Saving model ...
Epoch: 49 cost time: 0.8058233261108398
Epoch: 49, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.621 Vali Acc: 0.874 Test Loss: 0.621 Test Acc: 0.874
Validation loss decreased (-0.874068 --> -0.874068).  Saving model ...
Epoch: 50 cost time: 0.7518360614776611
Epoch: 50, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.602 Vali Acc: 0.867 Test Loss: 0.602 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.8050129413604736
Epoch: 51, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.584 Vali Acc: 0.867 Test Loss: 0.584 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7254133224487305
Epoch: 52, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
Validation loss decreased (-0.874068 --> -0.877772).  Saving model ...
Epoch: 53 cost time: 0.6975419521331787
Epoch: 53, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.552 Vali Acc: 0.878 Test Loss: 0.552 Test Acc: 0.878
Validation loss decreased (-0.877772 --> -0.877772).  Saving model ...
Epoch: 54 cost time: 0.8776378631591797
Epoch: 54, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.538 Vali Acc: 0.881 Test Loss: 0.538 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 55 cost time: 0.742835283279419
Epoch: 55, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.524 Vali Acc: 0.889 Test Loss: 0.524 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 56 cost time: 0.7371165752410889
Epoch: 56, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.511 Vali Acc: 0.889 Test Loss: 0.511 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 57 cost time: 0.5920267105102539
Epoch: 57, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.498 Vali Acc: 0.896 Test Loss: 0.498 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896291).  Saving model ...
Epoch: 58 cost time: 0.7300131320953369
Epoch: 58, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.487 Vali Acc: 0.904 Test Loss: 0.487 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 59 cost time: 0.640514612197876
Epoch: 59, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.477 Vali Acc: 0.904 Test Loss: 0.477 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 60 cost time: 0.6529395580291748
Epoch: 60, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.468 Vali Acc: 0.896 Test Loss: 0.468 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.8634216785430908
Epoch: 61, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.460 Vali Acc: 0.896 Test Loss: 0.460 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.8106563091278076
Epoch: 62, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.451 Vali Acc: 0.900 Test Loss: 0.451 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.6973810195922852
Epoch: 63, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.442 Vali Acc: 0.904 Test Loss: 0.442 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 64 cost time: 0.6585423946380615
Epoch: 64, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.434 Vali Acc: 0.907 Test Loss: 0.434 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 65 cost time: 0.7854909896850586
Epoch: 65, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.426 Vali Acc: 0.907 Test Loss: 0.426 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 66 cost time: 0.8916223049163818
Epoch: 66, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.419 Vali Acc: 0.907 Test Loss: 0.419 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 67 cost time: 0.843679666519165
Epoch: 67, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.413 Vali Acc: 0.907 Test Loss: 0.413 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 68 cost time: 0.6243064403533936
Epoch: 68, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.406 Vali Acc: 0.904 Test Loss: 0.406 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.7243566513061523
Epoch: 69, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.400 Vali Acc: 0.907 Test Loss: 0.400 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 70 cost time: 1.1282250881195068
Epoch: 70, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.394 Vali Acc: 0.915 Test Loss: 0.394 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 71 cost time: 0.7607176303863525
Epoch: 71, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.388 Vali Acc: 0.915 Test Loss: 0.388 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 72 cost time: 0.7081897258758545
Epoch: 72, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 73 cost time: 0.700465202331543
Epoch: 73, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.375 Vali Acc: 0.919 Test Loss: 0.375 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 74 cost time: 0.6000931262969971
Epoch: 74, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.369 Vali Acc: 0.919 Test Loss: 0.369 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 75 cost time: 0.7349309921264648
Epoch: 75, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.364 Vali Acc: 0.922 Test Loss: 0.364 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 76 cost time: 0.742178201675415
Epoch: 76, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 77 cost time: 0.7843880653381348
Epoch: 77, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 78 cost time: 0.7587952613830566
Epoch: 78, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.349 Vali Acc: 0.922 Test Loss: 0.349 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 79 cost time: 0.6569945812225342
Epoch: 79, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 80 cost time: 0.6687884330749512
Epoch: 80, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.339 Vali Acc: 0.922 Test Loss: 0.339 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 81 cost time: 0.6093201637268066
Epoch: 81, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929626).  Saving model ...
Epoch: 82 cost time: 0.5956215858459473
Epoch: 82, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.333 Vali Acc: 0.926 Test Loss: 0.333 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.6347098350524902
Epoch: 83, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.330 Vali Acc: 0.919 Test Loss: 0.330 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 1.068436861038208
Epoch: 84, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.326 Vali Acc: 0.919 Test Loss: 0.326 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.7471907138824463
Epoch: 85, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.322 Vali Acc: 0.922 Test Loss: 0.322 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.8235929012298584
Epoch: 86, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.318 Vali Acc: 0.922 Test Loss: 0.318 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.7420933246612549
Epoch: 87, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.7616775035858154
Epoch: 88, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.310 Vali Acc: 0.922 Test Loss: 0.310 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.8755125999450684
Epoch: 89, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.307 Vali Acc: 0.922 Test Loss: 0.307 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.805757999420166
Epoch: 90, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.305 Vali Acc: 0.922 Test Loss: 0.305 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.7805831432342529
Epoch: 91, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.303 Vali Acc: 0.919 Test Loss: 0.303 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 134026
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.424281358718872
Epoch: 1, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.944 Vali Acc: 0.126 Test Loss: 1.944 Test Acc: 0.126
Validation loss decreased (inf --> -0.125906).  Saving model ...
Epoch: 2 cost time: 0.7290074825286865
Epoch: 2, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.921 Vali Acc: 0.133 Test Loss: 1.921 Test Acc: 0.133
Validation loss decreased (-0.125906 --> -0.133314).  Saving model ...
Epoch: 3 cost time: 0.8129415512084961
Epoch: 3, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.905 Vali Acc: 0.152 Test Loss: 1.905 Test Acc: 0.152
Validation loss decreased (-0.133314 --> -0.151833).  Saving model ...
Epoch: 4 cost time: 0.7643532752990723
Epoch: 4, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.891 Vali Acc: 0.159 Test Loss: 1.891 Test Acc: 0.159
Validation loss decreased (-0.151833 --> -0.159240).  Saving model ...
Epoch: 5 cost time: 0.9284610748291016
Epoch: 5, Steps: 2 | Train Loss: 1.964 Vali Loss: 1.874 Vali Acc: 0.174 Test Loss: 1.874 Test Acc: 0.174
Validation loss decreased (-0.159240 --> -0.174055).  Saving model ...
Epoch: 6 cost time: 0.6961638927459717
Epoch: 6, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.853 Vali Acc: 0.189 Test Loss: 1.853 Test Acc: 0.189
Validation loss decreased (-0.174055 --> -0.188870).  Saving model ...
Epoch: 7 cost time: 0.6691763401031494
Epoch: 7, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.831 Vali Acc: 0.219 Test Loss: 1.831 Test Acc: 0.219
Validation loss decreased (-0.188870 --> -0.218500).  Saving model ...
Epoch: 8 cost time: 0.6472866535186768
Epoch: 8, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.807 Vali Acc: 0.241 Test Loss: 1.807 Test Acc: 0.241
Validation loss decreased (-0.218500 --> -0.240723).  Saving model ...
Epoch: 9 cost time: 0.7698233127593994
Epoch: 9, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.782 Vali Acc: 0.267 Test Loss: 1.782 Test Acc: 0.267
Validation loss decreased (-0.240723 --> -0.266649).  Saving model ...
Epoch: 10 cost time: 0.7117471694946289
Epoch: 10, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.757 Vali Acc: 0.281 Test Loss: 1.757 Test Acc: 0.281
Validation loss decreased (-0.266649 --> -0.281464).  Saving model ...
Epoch: 11 cost time: 0.9620048999786377
Epoch: 11, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.731 Vali Acc: 0.293 Test Loss: 1.731 Test Acc: 0.293
Validation loss decreased (-0.281464 --> -0.292575).  Saving model ...
Epoch: 12 cost time: 1.049809217453003
Epoch: 12, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.706 Vali Acc: 0.296 Test Loss: 1.706 Test Acc: 0.296
Validation loss decreased (-0.292575 --> -0.296279).  Saving model ...
Epoch: 13 cost time: 0.7301633358001709
Epoch: 13, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.681 Vali Acc: 0.311 Test Loss: 1.681 Test Acc: 0.311
Validation loss decreased (-0.296279 --> -0.311094).  Saving model ...
Epoch: 14 cost time: 0.7714712619781494
Epoch: 14, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.655 Vali Acc: 0.333 Test Loss: 1.655 Test Acc: 0.333
Validation loss decreased (-0.311094 --> -0.333317).  Saving model ...
Epoch: 15 cost time: 0.6305356025695801
Epoch: 15, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.629 Vali Acc: 0.367 Test Loss: 1.629 Test Acc: 0.367
Validation loss decreased (-0.333317 --> -0.366650).  Saving model ...
Epoch: 16 cost time: 0.8047432899475098
Epoch: 16, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.602 Vali Acc: 0.415 Test Loss: 1.602 Test Acc: 0.415
Validation loss decreased (-0.366650 --> -0.414799).  Saving model ...
Epoch: 17 cost time: 0.7189207077026367
Epoch: 17, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.575 Vali Acc: 0.474 Test Loss: 1.575 Test Acc: 0.474
Validation loss decreased (-0.414799 --> -0.474058).  Saving model ...
Epoch: 18 cost time: 0.7178277969360352
Epoch: 18, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.548 Vali Acc: 0.511 Test Loss: 1.548 Test Acc: 0.511
Validation loss decreased (-0.474058 --> -0.511096).  Saving model ...
Epoch: 19 cost time: 0.5786254405975342
Epoch: 19, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.520 Vali Acc: 0.552 Test Loss: 1.520 Test Acc: 0.552
Validation loss decreased (-0.511096 --> -0.551837).  Saving model ...
Epoch: 20 cost time: 0.6571407318115234
Epoch: 20, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.492 Vali Acc: 0.593 Test Loss: 1.492 Test Acc: 0.593
Validation loss decreased (-0.551837 --> -0.592578).  Saving model ...
Epoch: 21 cost time: 0.8039824962615967
Epoch: 21, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.463 Vali Acc: 0.619 Test Loss: 1.463 Test Acc: 0.619
Validation loss decreased (-0.592578 --> -0.618504).  Saving model ...
Epoch: 22 cost time: 0.7412283420562744
Epoch: 22, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.432 Vali Acc: 0.633 Test Loss: 1.432 Test Acc: 0.633
Validation loss decreased (-0.618504 --> -0.633319).  Saving model ...
Epoch: 23 cost time: 0.7490255832672119
Epoch: 23, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.400 Vali Acc: 0.648 Test Loss: 1.400 Test Acc: 0.648
Validation loss decreased (-0.633319 --> -0.648134).  Saving model ...
Epoch: 24 cost time: 0.7454221248626709
Epoch: 24, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.367 Vali Acc: 0.678 Test Loss: 1.367 Test Acc: 0.678
Validation loss decreased (-0.648134 --> -0.677764).  Saving model ...
Epoch: 25 cost time: 0.8115859031677246
Epoch: 25, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.334 Vali Acc: 0.707 Test Loss: 1.334 Test Acc: 0.707
Validation loss decreased (-0.677764 --> -0.707394).  Saving model ...
Epoch: 26 cost time: 0.7463521957397461
Epoch: 26, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.301 Vali Acc: 0.737 Test Loss: 1.301 Test Acc: 0.737
Validation loss decreased (-0.707394 --> -0.737024).  Saving model ...
Epoch: 27 cost time: 0.7464327812194824
Epoch: 27, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.267 Vali Acc: 0.752 Test Loss: 1.267 Test Acc: 0.752
Validation loss decreased (-0.737024 --> -0.751839).  Saving model ...
Epoch: 28 cost time: 0.7308132648468018
Epoch: 28, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.232 Vali Acc: 0.763 Test Loss: 1.232 Test Acc: 0.763
Validation loss decreased (-0.751839 --> -0.762951).  Saving model ...
Epoch: 29 cost time: 0.8362526893615723
Epoch: 29, Steps: 2 | Train Loss: 1.110 Vali Loss: 1.197 Vali Acc: 0.778 Test Loss: 1.197 Test Acc: 0.778
Validation loss decreased (-0.762951 --> -0.777766).  Saving model ...
Epoch: 30 cost time: 0.7776100635528564
Epoch: 30, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.161 Vali Acc: 0.789 Test Loss: 1.161 Test Acc: 0.789
Validation loss decreased (-0.777766 --> -0.788877).  Saving model ...
Epoch: 31 cost time: 0.6204640865325928
Epoch: 31, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.126 Vali Acc: 0.796 Test Loss: 1.126 Test Acc: 0.796
Validation loss decreased (-0.788877 --> -0.796285).  Saving model ...
Epoch: 32 cost time: 0.8252291679382324
Epoch: 32, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.091 Vali Acc: 0.807 Test Loss: 1.091 Test Acc: 0.807
Validation loss decreased (-0.796285 --> -0.807396).  Saving model ...
Epoch: 33 cost time: 0.5905389785766602
Epoch: 33, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.056 Vali Acc: 0.815 Test Loss: 1.056 Test Acc: 0.815
Validation loss decreased (-0.807396 --> -0.814804).  Saving model ...
Epoch: 34 cost time: 0.6741199493408203
Epoch: 34, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.022 Vali Acc: 0.826 Test Loss: 1.022 Test Acc: 0.826
Validation loss decreased (-0.814804 --> -0.825916).  Saving model ...
Epoch: 35 cost time: 0.653693675994873
Epoch: 35, Steps: 2 | Train Loss: 0.852 Vali Loss: 0.988 Vali Acc: 0.830 Test Loss: 0.988 Test Acc: 0.830
Validation loss decreased (-0.825916 --> -0.829620).  Saving model ...
Epoch: 36 cost time: 0.6458048820495605
Epoch: 36, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.955 Vali Acc: 0.833 Test Loss: 0.955 Test Acc: 0.833
Validation loss decreased (-0.829620 --> -0.833324).  Saving model ...
Epoch: 37 cost time: 0.8105823993682861
Epoch: 37, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.923 Vali Acc: 0.841 Test Loss: 0.923 Test Acc: 0.841
Validation loss decreased (-0.833324 --> -0.840732).  Saving model ...
Epoch: 38 cost time: 0.6812601089477539
Epoch: 38, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.892 Vali Acc: 0.830 Test Loss: 0.892 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.76995849609375
Epoch: 39, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.862 Vali Acc: 0.844 Test Loss: 0.862 Test Acc: 0.844
Validation loss decreased (-0.840732 --> -0.844436).  Saving model ...
Epoch: 40 cost time: 0.6254630088806152
Epoch: 40, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.833 Vali Acc: 0.852 Test Loss: 0.833 Test Acc: 0.852
Validation loss decreased (-0.844436 --> -0.851844).  Saving model ...
Epoch: 41 cost time: 0.7332038879394531
Epoch: 41, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.805 Vali Acc: 0.852 Test Loss: 0.805 Test Acc: 0.852
Validation loss decreased (-0.851844 --> -0.851844).  Saving model ...
Epoch: 42 cost time: 0.6438271999359131
Epoch: 42, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.779 Vali Acc: 0.852 Test Loss: 0.779 Test Acc: 0.852
Validation loss decreased (-0.851844 --> -0.851844).  Saving model ...
Epoch: 43 cost time: 0.6545493602752686
Epoch: 43, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.754 Vali Acc: 0.874 Test Loss: 0.754 Test Acc: 0.874
Validation loss decreased (-0.851844 --> -0.874067).  Saving model ...
Epoch: 44 cost time: 0.7020001411437988
Epoch: 44, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.731 Vali Acc: 0.878 Test Loss: 0.731 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877770).  Saving model ...
Epoch: 45 cost time: 0.7885334491729736
Epoch: 45, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.708 Vali Acc: 0.874 Test Loss: 0.708 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6901178359985352
Epoch: 46, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.687 Vali Acc: 0.885 Test Loss: 0.687 Test Acc: 0.885
Validation loss decreased (-0.877770 --> -0.885178).  Saving model ...
Epoch: 47 cost time: 1.0321455001831055
Epoch: 47, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.667 Vali Acc: 0.885 Test Loss: 0.667 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885179).  Saving model ...
Epoch: 48 cost time: 0.7432985305786133
Epoch: 48, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.647 Vali Acc: 0.885 Test Loss: 0.647 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 49 cost time: 0.6767258644104004
Epoch: 49, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.630 Vali Acc: 0.893 Test Loss: 0.630 Test Acc: 0.893
Validation loss decreased (-0.885179 --> -0.892586).  Saving model ...
Epoch: 50 cost time: 0.7283546924591064
Epoch: 50, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.613 Vali Acc: 0.893 Test Loss: 0.613 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892586).  Saving model ...
Epoch: 51 cost time: 0.7749927043914795
Epoch: 51, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.598 Vali Acc: 0.889 Test Loss: 0.598 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7944660186767578
Epoch: 52, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.583 Vali Acc: 0.889 Test Loss: 0.583 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7414023876190186
Epoch: 53, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.568 Vali Acc: 0.893 Test Loss: 0.568 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 54 cost time: 0.861553430557251
Epoch: 54, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.555 Vali Acc: 0.889 Test Loss: 0.555 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6451585292816162
Epoch: 55, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.543 Vali Acc: 0.885 Test Loss: 0.543 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.7424399852752686
Epoch: 56, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.530 Vali Acc: 0.885 Test Loss: 0.530 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6620380878448486
Epoch: 57, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.519 Vali Acc: 0.893 Test Loss: 0.519 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 58 cost time: 0.7039904594421387
Epoch: 58, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.507 Vali Acc: 0.896 Test Loss: 0.507 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 59 cost time: 0.9026305675506592
Epoch: 59, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.497 Vali Acc: 0.900 Test Loss: 0.497 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 60 cost time: 0.6791067123413086
Epoch: 60, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.486 Vali Acc: 0.904 Test Loss: 0.486 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 61 cost time: 0.894047737121582
Epoch: 61, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7127470970153809
Epoch: 62, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.467 Vali Acc: 0.896 Test Loss: 0.467 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.8363280296325684
Epoch: 63, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.458 Vali Acc: 0.900 Test Loss: 0.458 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.9351916313171387
Epoch: 64, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.711801290512085
Epoch: 65, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.441 Vali Acc: 0.900 Test Loss: 0.441 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.8383429050445557
Epoch: 66, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.737224817276001
Epoch: 67, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.427 Vali Acc: 0.900 Test Loss: 0.427 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.8626065254211426
Epoch: 68, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.421 Vali Acc: 0.900 Test Loss: 0.421 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.7212204933166504
Epoch: 69, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.414 Vali Acc: 0.900 Test Loss: 0.414 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.6366496086120605
Epoch: 70, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 133738
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2202212810516357
Epoch: 1, Steps: 2 | Train Loss: 2.001 Vali Loss: 2.013 Vali Acc: 0.300 Test Loss: 2.013 Test Acc: 0.300
Validation loss decreased (inf --> -0.299980).  Saving model ...
Epoch: 2 cost time: 0.6322124004364014
Epoch: 2, Steps: 2 | Train Loss: 1.987 Vali Loss: 1.983 Vali Acc: 0.300 Test Loss: 1.983 Test Acc: 0.300
Validation loss decreased (-0.299980 --> -0.299980).  Saving model ...
Epoch: 3 cost time: 0.5599157810211182
Epoch: 3, Steps: 2 | Train Loss: 2.033 Vali Loss: 1.960 Vali Acc: 0.307 Test Loss: 1.960 Test Acc: 0.307
Validation loss decreased (-0.299980 --> -0.307388).  Saving model ...
Epoch: 4 cost time: 0.6321759223937988
Epoch: 4, Steps: 2 | Train Loss: 1.955 Vali Loss: 1.941 Vali Acc: 0.307 Test Loss: 1.941 Test Acc: 0.307
Validation loss decreased (-0.307388 --> -0.307388).  Saving model ...
Epoch: 5 cost time: 0.6259787082672119
Epoch: 5, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.918 Vali Acc: 0.315 Test Loss: 1.918 Test Acc: 0.315
Validation loss decreased (-0.307388 --> -0.314796).  Saving model ...
Epoch: 6 cost time: 0.6001012325286865
Epoch: 6, Steps: 2 | Train Loss: 1.981 Vali Loss: 1.890 Vali Acc: 0.315 Test Loss: 1.890 Test Acc: 0.315
Validation loss decreased (-0.314796 --> -0.314796).  Saving model ...
Epoch: 7 cost time: 0.6084933280944824
Epoch: 7, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.860 Vali Acc: 0.322 Test Loss: 1.860 Test Acc: 0.322
Validation loss decreased (-0.314796 --> -0.322204).  Saving model ...
Epoch: 8 cost time: 0.6968672275543213
Epoch: 8, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.829 Vali Acc: 0.352 Test Loss: 1.829 Test Acc: 0.352
Validation loss decreased (-0.322204 --> -0.351834).  Saving model ...
Epoch: 9 cost time: 0.6517271995544434
Epoch: 9, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.798 Vali Acc: 0.437 Test Loss: 1.798 Test Acc: 0.437
Validation loss decreased (-0.351834 --> -0.437019).  Saving model ...
Epoch: 10 cost time: 0.663764238357544
Epoch: 10, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.769 Vali Acc: 0.470 Test Loss: 1.769 Test Acc: 0.470
Validation loss decreased (-0.437019 --> -0.470353).  Saving model ...
Epoch: 11 cost time: 0.5951519012451172
Epoch: 11, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.738 Vali Acc: 0.493 Test Loss: 1.738 Test Acc: 0.493
Validation loss decreased (-0.470353 --> -0.492575).  Saving model ...
Epoch: 12 cost time: 0.657526969909668
Epoch: 12, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.709 Vali Acc: 0.515 Test Loss: 1.709 Test Acc: 0.515
Validation loss decreased (-0.492575 --> -0.514798).  Saving model ...
Epoch: 13 cost time: 0.6280148029327393
Epoch: 13, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.681 Vali Acc: 0.522 Test Loss: 1.681 Test Acc: 0.522
Validation loss decreased (-0.514798 --> -0.522205).  Saving model ...
Epoch: 14 cost time: 0.8830099105834961
Epoch: 14, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.654 Vali Acc: 0.533 Test Loss: 1.654 Test Acc: 0.533
Validation loss decreased (-0.522205 --> -0.533317).  Saving model ...
Epoch: 15 cost time: 0.7353816032409668
Epoch: 15, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.628 Vali Acc: 0.533 Test Loss: 1.628 Test Acc: 0.533
Validation loss decreased (-0.533317 --> -0.533317).  Saving model ...
Epoch: 16 cost time: 0.7892730236053467
Epoch: 16, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.602 Vali Acc: 0.544 Test Loss: 1.602 Test Acc: 0.544
Validation loss decreased (-0.533317 --> -0.544428).  Saving model ...
Epoch: 17 cost time: 0.6322455406188965
Epoch: 17, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.577 Vali Acc: 0.567 Test Loss: 1.577 Test Acc: 0.567
Validation loss decreased (-0.544428 --> -0.566651).  Saving model ...
Epoch: 18 cost time: 0.7744545936584473
Epoch: 18, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.552 Vali Acc: 0.563 Test Loss: 1.552 Test Acc: 0.563
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6687502861022949
Epoch: 19, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.528 Vali Acc: 0.567 Test Loss: 1.528 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566651).  Saving model ...
Epoch: 20 cost time: 0.7965414524078369
Epoch: 20, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.502 Vali Acc: 0.556 Test Loss: 1.502 Test Acc: 0.556
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9486982822418213
Epoch: 21, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.476 Vali Acc: 0.548 Test Loss: 1.476 Test Acc: 0.548
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8183867931365967
Epoch: 22, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.449 Vali Acc: 0.567 Test Loss: 1.449 Test Acc: 0.567
Validation loss decreased (-0.566651 --> -0.566652).  Saving model ...
Epoch: 23 cost time: 0.8874945640563965
Epoch: 23, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.421 Vali Acc: 0.570 Test Loss: 1.421 Test Acc: 0.570
Validation loss decreased (-0.566652 --> -0.570356).  Saving model ...
Epoch: 24 cost time: 0.639768123626709
Epoch: 24, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.391 Vali Acc: 0.581 Test Loss: 1.391 Test Acc: 0.581
Validation loss decreased (-0.570356 --> -0.581468).  Saving model ...
Epoch: 25 cost time: 0.669313907623291
Epoch: 25, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.361 Vali Acc: 0.596 Test Loss: 1.361 Test Acc: 0.596
Validation loss decreased (-0.581468 --> -0.596283).  Saving model ...
Epoch: 26 cost time: 0.7287952899932861
Epoch: 26, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.329 Vali Acc: 0.611 Test Loss: 1.329 Test Acc: 0.611
Validation loss decreased (-0.596283 --> -0.611098).  Saving model ...
Epoch: 27 cost time: 0.6396653652191162
Epoch: 27, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.297 Vali Acc: 0.622 Test Loss: 1.297 Test Acc: 0.622
Validation loss decreased (-0.611098 --> -0.622209).  Saving model ...
Epoch: 28 cost time: 0.8163113594055176
Epoch: 28, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.264 Vali Acc: 0.644 Test Loss: 1.264 Test Acc: 0.644
Validation loss decreased (-0.622209 --> -0.644432).  Saving model ...
Epoch: 29 cost time: 0.9062609672546387
Epoch: 29, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.232 Vali Acc: 0.667 Test Loss: 1.232 Test Acc: 0.667
Validation loss decreased (-0.644432 --> -0.666654).  Saving model ...
Epoch: 30 cost time: 0.7412765026092529
Epoch: 30, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.199 Vali Acc: 0.689 Test Loss: 1.199 Test Acc: 0.689
Validation loss decreased (-0.666654 --> -0.688877).  Saving model ...
Epoch: 31 cost time: 0.8546807765960693
Epoch: 31, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.164 Vali Acc: 0.704 Test Loss: 1.164 Test Acc: 0.704
Validation loss decreased (-0.688877 --> -0.703692).  Saving model ...
Epoch: 32 cost time: 0.7408359050750732
Epoch: 32, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.130 Vali Acc: 0.719 Test Loss: 1.130 Test Acc: 0.719
Validation loss decreased (-0.703692 --> -0.718507).  Saving model ...
Epoch: 33 cost time: 0.7563331127166748
Epoch: 33, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.096 Vali Acc: 0.719 Test Loss: 1.096 Test Acc: 0.719
Validation loss decreased (-0.718507 --> -0.718508).  Saving model ...
Epoch: 34 cost time: 0.7078874111175537
Epoch: 34, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.061 Vali Acc: 0.726 Test Loss: 1.061 Test Acc: 0.726
Validation loss decreased (-0.718508 --> -0.725915).  Saving model ...
Epoch: 35 cost time: 0.7369875907897949
Epoch: 35, Steps: 2 | Train Loss: 0.981 Vali Loss: 1.027 Vali Acc: 0.752 Test Loss: 1.027 Test Acc: 0.752
Validation loss decreased (-0.725915 --> -0.751842).  Saving model ...
Epoch: 36 cost time: 0.6642169952392578
Epoch: 36, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.993 Vali Acc: 0.759 Test Loss: 0.993 Test Acc: 0.759
Validation loss decreased (-0.751842 --> -0.759249).  Saving model ...
Epoch: 37 cost time: 0.7333035469055176
Epoch: 37, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.959 Vali Acc: 0.781 Test Loss: 0.959 Test Acc: 0.781
Validation loss decreased (-0.759249 --> -0.781472).  Saving model ...
Epoch: 38 cost time: 0.7183771133422852
Epoch: 38, Steps: 2 | Train Loss: 0.863 Vali Loss: 0.926 Vali Acc: 0.789 Test Loss: 0.926 Test Acc: 0.789
Validation loss decreased (-0.781472 --> -0.788880).  Saving model ...
Epoch: 39 cost time: 0.6797583103179932
Epoch: 39, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.896 Vali Acc: 0.796 Test Loss: 0.896 Test Acc: 0.796
Validation loss decreased (-0.788880 --> -0.796287).  Saving model ...
Epoch: 40 cost time: 0.6477828025817871
Epoch: 40, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.865 Vali Acc: 0.804 Test Loss: 0.865 Test Acc: 0.804
Validation loss decreased (-0.796287 --> -0.803695).  Saving model ...
Epoch: 41 cost time: 0.7102539539337158
Epoch: 41, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.836 Vali Acc: 0.815 Test Loss: 0.836 Test Acc: 0.815
Validation loss decreased (-0.803695 --> -0.814806).  Saving model ...
Epoch: 42 cost time: 0.6788535118103027
Epoch: 42, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.807 Vali Acc: 0.822 Test Loss: 0.807 Test Acc: 0.822
Validation loss decreased (-0.814806 --> -0.822214).  Saving model ...
Epoch: 43 cost time: 0.69297194480896
Epoch: 43, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.780 Vali Acc: 0.822 Test Loss: 0.780 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822214).  Saving model ...
Epoch: 44 cost time: 0.6453807353973389
Epoch: 44, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.754 Vali Acc: 0.837 Test Loss: 0.754 Test Acc: 0.837
Validation loss decreased (-0.822214 --> -0.837029).  Saving model ...
Epoch: 45 cost time: 0.8056545257568359
Epoch: 45, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.729 Vali Acc: 0.841 Test Loss: 0.729 Test Acc: 0.841
Validation loss decreased (-0.837029 --> -0.840733).  Saving model ...
Epoch: 46 cost time: 0.7005887031555176
Epoch: 46, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.705 Vali Acc: 0.844 Test Loss: 0.705 Test Acc: 0.844
Validation loss decreased (-0.840733 --> -0.844437).  Saving model ...
Epoch: 47 cost time: 0.750514030456543
Epoch: 47, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.682 Vali Acc: 0.841 Test Loss: 0.682 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6260762214660645
Epoch: 48, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.661 Vali Acc: 0.852 Test Loss: 0.661 Test Acc: 0.852
Validation loss decreased (-0.844437 --> -0.851845).  Saving model ...
Epoch: 49 cost time: 0.6592600345611572
Epoch: 49, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.641 Vali Acc: 0.856 Test Loss: 0.641 Test Acc: 0.856
Validation loss decreased (-0.851845 --> -0.855549).  Saving model ...
Epoch: 50 cost time: 0.7200453281402588
Epoch: 50, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.621 Vali Acc: 0.859 Test Loss: 0.621 Test Acc: 0.859
Validation loss decreased (-0.855549 --> -0.859253).  Saving model ...
Epoch: 51 cost time: 0.7421324253082275
Epoch: 51, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.603 Vali Acc: 0.874 Test Loss: 0.603 Test Acc: 0.874
Validation loss decreased (-0.859253 --> -0.874068).  Saving model ...
Epoch: 52 cost time: 0.754335880279541
Epoch: 52, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.585 Vali Acc: 0.881 Test Loss: 0.585 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 53 cost time: 0.7573809623718262
Epoch: 53, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.569 Vali Acc: 0.878 Test Loss: 0.569 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7215125560760498
Epoch: 54, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.554 Vali Acc: 0.878 Test Loss: 0.554 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.831963300704956
Epoch: 55, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.540 Vali Acc: 0.878 Test Loss: 0.540 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.7615170478820801
Epoch: 56, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.526 Vali Acc: 0.881 Test Loss: 0.526 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 57 cost time: 0.7300601005554199
Epoch: 57, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.514 Vali Acc: 0.881 Test Loss: 0.514 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 58 cost time: 0.7634973526000977
Epoch: 58, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.502 Vali Acc: 0.881 Test Loss: 0.502 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 59 cost time: 0.7216916084289551
Epoch: 59, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.491 Vali Acc: 0.885 Test Loss: 0.491 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 60 cost time: 0.6799635887145996
Epoch: 60, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.480 Vali Acc: 0.889 Test Loss: 0.480 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 61 cost time: 0.7437934875488281
Epoch: 61, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.470 Vali Acc: 0.889 Test Loss: 0.470 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 62 cost time: 0.7412276268005371
Epoch: 62, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.460 Vali Acc: 0.885 Test Loss: 0.460 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.7454240322113037
Epoch: 63, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.451 Vali Acc: 0.893 Test Loss: 0.451 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 64 cost time: 0.7679920196533203
Epoch: 64, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.441 Vali Acc: 0.904 Test Loss: 0.441 Test Acc: 0.904
Validation loss decreased (-0.892588 --> -0.903699).  Saving model ...
Epoch: 65 cost time: 0.8034746646881104
Epoch: 65, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.431 Vali Acc: 0.900 Test Loss: 0.431 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.9030053615570068
Epoch: 66, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.421 Vali Acc: 0.907 Test Loss: 0.421 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 67 cost time: 0.9120762348175049
Epoch: 67, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.413 Vali Acc: 0.904 Test Loss: 0.413 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.8610100746154785
Epoch: 68, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.404 Vali Acc: 0.904 Test Loss: 0.404 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6877131462097168
Epoch: 69, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.396 Vali Acc: 0.911 Test Loss: 0.396 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 70 cost time: 0.5721173286437988
Epoch: 70, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.387 Vali Acc: 0.911 Test Loss: 0.387 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 71 cost time: 0.6899020671844482
Epoch: 71, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.380 Vali Acc: 0.911 Test Loss: 0.380 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 72 cost time: 0.69606614112854
Epoch: 72, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.374 Vali Acc: 0.911 Test Loss: 0.374 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 73 cost time: 0.8186905384063721
Epoch: 73, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.369 Vali Acc: 0.915 Test Loss: 0.369 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 74 cost time: 0.9037971496582031
Epoch: 74, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.363 Vali Acc: 0.915 Test Loss: 0.363 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 75 cost time: 0.8155181407928467
Epoch: 75, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.358 Vali Acc: 0.915 Test Loss: 0.358 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 76 cost time: 0.6651525497436523
Epoch: 76, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.354 Vali Acc: 0.911 Test Loss: 0.354 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.7338912487030029
Epoch: 77, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.349 Vali Acc: 0.915 Test Loss: 0.349 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 78 cost time: 0.6323823928833008
Epoch: 78, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.342 Vali Acc: 0.915 Test Loss: 0.342 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 79 cost time: 0.8292219638824463
Epoch: 79, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
Validation loss decreased (-0.914811 --> -0.929626).  Saving model ...
Epoch: 80 cost time: 0.8406341075897217
Epoch: 80, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.332 Vali Acc: 0.933 Test Loss: 0.332 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 81 cost time: 0.7612147331237793
Epoch: 81, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.329 Vali Acc: 0.933 Test Loss: 0.329 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 82 cost time: 0.7742984294891357
Epoch: 82, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.325 Vali Acc: 0.933 Test Loss: 0.325 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 83 cost time: 0.6027429103851318
Epoch: 83, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.322 Vali Acc: 0.930 Test Loss: 0.322 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6140244007110596
Epoch: 84, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.318 Vali Acc: 0.930 Test Loss: 0.318 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.6988101005554199
Epoch: 85, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.6681761741638184
Epoch: 86, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.610236644744873
Epoch: 87, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.306 Vali Acc: 0.930 Test Loss: 0.306 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.5509769916534424
Epoch: 88, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.697021484375
Epoch: 89, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.298 Vali Acc: 0.930 Test Loss: 0.298 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.602294921875
Epoch: 90, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.69869065284729
Epoch: 91, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.296 Vali Acc: 0.930 Test Loss: 0.296 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.7613775730133057
Epoch: 92, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 133450
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1120314598083496
Epoch: 1, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.877 Vali Acc: 0.170 Test Loss: 1.877 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.646061897277832
Epoch: 2, Steps: 2 | Train Loss: 1.903 Vali Loss: 1.851 Vali Acc: 0.174 Test Loss: 1.851 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.6973075866699219
Epoch: 3, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.831 Vali Acc: 0.178 Test Loss: 1.831 Test Acc: 0.178
Validation loss decreased (-0.174056 --> -0.177759).  Saving model ...
Epoch: 4 cost time: 0.7589859962463379
Epoch: 4, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.815 Vali Acc: 0.178 Test Loss: 1.815 Test Acc: 0.178
Validation loss decreased (-0.177759 --> -0.177760).  Saving model ...
Epoch: 5 cost time: 0.9350244998931885
Epoch: 5, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.795 Vali Acc: 0.181 Test Loss: 1.795 Test Acc: 0.181
Validation loss decreased (-0.177760 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.8348674774169922
Epoch: 6, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.773 Vali Acc: 0.181 Test Loss: 1.773 Test Acc: 0.181
Validation loss decreased (-0.181464 --> -0.181464).  Saving model ...
Epoch: 7 cost time: 0.8080244064331055
Epoch: 7, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.750 Vali Acc: 0.196 Test Loss: 1.750 Test Acc: 0.196
Validation loss decreased (-0.181464 --> -0.196279).  Saving model ...
Epoch: 8 cost time: 0.6055631637573242
Epoch: 8, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.726 Vali Acc: 0.252 Test Loss: 1.726 Test Acc: 0.252
Validation loss decreased (-0.196279 --> -0.251835).  Saving model ...
Epoch: 9 cost time: 0.6805222034454346
Epoch: 9, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.703 Vali Acc: 0.315 Test Loss: 1.703 Test Acc: 0.315
Validation loss decreased (-0.251835 --> -0.314798).  Saving model ...
Epoch: 10 cost time: 0.8735113143920898
Epoch: 10, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.680 Vali Acc: 0.381 Test Loss: 1.680 Test Acc: 0.381
Validation loss decreased (-0.314798 --> -0.381465).  Saving model ...
Epoch: 11 cost time: 0.7137415409088135
Epoch: 11, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.657 Vali Acc: 0.419 Test Loss: 1.657 Test Acc: 0.419
Validation loss decreased (-0.381465 --> -0.418502).  Saving model ...
Epoch: 12 cost time: 0.8088283538818359
Epoch: 12, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.635 Vali Acc: 0.467 Test Loss: 1.635 Test Acc: 0.467
Validation loss decreased (-0.418502 --> -0.466650).  Saving model ...
Epoch: 13 cost time: 0.7809603214263916
Epoch: 13, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.613 Vali Acc: 0.496 Test Loss: 1.613 Test Acc: 0.496
Validation loss decreased (-0.466650 --> -0.496280).  Saving model ...
Epoch: 14 cost time: 0.7396705150604248
Epoch: 14, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.592 Vali Acc: 0.526 Test Loss: 1.592 Test Acc: 0.526
Validation loss decreased (-0.496280 --> -0.525910).  Saving model ...
Epoch: 15 cost time: 0.7534377574920654
Epoch: 15, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.570 Vali Acc: 0.563 Test Loss: 1.570 Test Acc: 0.563
Validation loss decreased (-0.525910 --> -0.562947).  Saving model ...
Epoch: 16 cost time: 0.7936270236968994
Epoch: 16, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.547 Vali Acc: 0.611 Test Loss: 1.547 Test Acc: 0.611
Validation loss decreased (-0.562947 --> -0.611096).  Saving model ...
Epoch: 17 cost time: 0.7501628398895264
Epoch: 17, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.523 Vali Acc: 0.633 Test Loss: 1.523 Test Acc: 0.633
Validation loss decreased (-0.611096 --> -0.633318).  Saving model ...
Epoch: 18 cost time: 0.7244839668273926
Epoch: 18, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.499 Vali Acc: 0.674 Test Loss: 1.499 Test Acc: 0.674
Validation loss decreased (-0.633318 --> -0.674059).  Saving model ...
Epoch: 19 cost time: 0.7841715812683105
Epoch: 19, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.473 Vali Acc: 0.685 Test Loss: 1.473 Test Acc: 0.685
Validation loss decreased (-0.674059 --> -0.685170).  Saving model ...
Epoch: 20 cost time: 1.0098562240600586
Epoch: 20, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.447 Vali Acc: 0.707 Test Loss: 1.447 Test Acc: 0.707
Validation loss decreased (-0.685170 --> -0.707393).  Saving model ...
Epoch: 21 cost time: 0.7392668724060059
Epoch: 21, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.418 Vali Acc: 0.722 Test Loss: 1.418 Test Acc: 0.722
Validation loss decreased (-0.707393 --> -0.722208).  Saving model ...
Epoch: 22 cost time: 0.7328720092773438
Epoch: 22, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.389 Vali Acc: 0.741 Test Loss: 1.389 Test Acc: 0.741
Validation loss decreased (-0.722208 --> -0.740727).  Saving model ...
Epoch: 23 cost time: 0.7687549591064453
Epoch: 23, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.358 Vali Acc: 0.767 Test Loss: 1.358 Test Acc: 0.767
Validation loss decreased (-0.740727 --> -0.766653).  Saving model ...
Epoch: 24 cost time: 0.8333051204681396
Epoch: 24, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.328 Vali Acc: 0.781 Test Loss: 1.328 Test Acc: 0.781
Validation loss decreased (-0.766653 --> -0.781468).  Saving model ...
Epoch: 25 cost time: 0.6734499931335449
Epoch: 25, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.296 Vali Acc: 0.781 Test Loss: 1.296 Test Acc: 0.781
Validation loss decreased (-0.781468 --> -0.781469).  Saving model ...
Epoch: 26 cost time: 0.8642027378082275
Epoch: 26, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.264 Vali Acc: 0.800 Test Loss: 1.264 Test Acc: 0.800
Validation loss decreased (-0.781469 --> -0.799987).  Saving model ...
Epoch: 27 cost time: 0.8888943195343018
Epoch: 27, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.231 Vali Acc: 0.807 Test Loss: 1.231 Test Acc: 0.807
Validation loss decreased (-0.799987 --> -0.807395).  Saving model ...
Epoch: 28 cost time: 0.7432460784912109
Epoch: 28, Steps: 2 | Train Loss: 1.199 Vali Loss: 1.197 Vali Acc: 0.811 Test Loss: 1.197 Test Acc: 0.811
Validation loss decreased (-0.807395 --> -0.811099).  Saving model ...
Epoch: 29 cost time: 0.7264528274536133
Epoch: 29, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.162 Vali Acc: 0.819 Test Loss: 1.162 Test Acc: 0.819
Validation loss decreased (-0.811099 --> -0.818507).  Saving model ...
Epoch: 30 cost time: 0.6880264282226562
Epoch: 30, Steps: 2 | Train Loss: 1.081 Vali Loss: 1.127 Vali Acc: 0.819 Test Loss: 1.127 Test Acc: 0.819
Validation loss decreased (-0.818507 --> -0.818507).  Saving model ...
Epoch: 31 cost time: 0.6628015041351318
Epoch: 31, Steps: 2 | Train Loss: 1.065 Vali Loss: 1.093 Vali Acc: 0.837 Test Loss: 1.093 Test Acc: 0.837
Validation loss decreased (-0.818507 --> -0.837026).  Saving model ...
Epoch: 32 cost time: 0.7194106578826904
Epoch: 32, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.058 Vali Acc: 0.830 Test Loss: 1.058 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6897351741790771
Epoch: 33, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.024 Vali Acc: 0.844 Test Loss: 1.024 Test Acc: 0.844
Validation loss decreased (-0.837026 --> -0.844434).  Saving model ...
Epoch: 34 cost time: 0.6829812526702881
Epoch: 34, Steps: 2 | Train Loss: 0.964 Vali Loss: 0.989 Vali Acc: 0.844 Test Loss: 0.989 Test Acc: 0.844
Validation loss decreased (-0.844434 --> -0.844435).  Saving model ...
Epoch: 35 cost time: 0.7378115653991699
Epoch: 35, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.955 Vali Acc: 0.856 Test Loss: 0.955 Test Acc: 0.856
Validation loss decreased (-0.844435 --> -0.855546).  Saving model ...
Epoch: 36 cost time: 0.8967130184173584
Epoch: 36, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.922 Vali Acc: 0.867 Test Loss: 0.922 Test Acc: 0.867
Validation loss decreased (-0.855546 --> -0.866657).  Saving model ...
Epoch: 37 cost time: 0.772028923034668
Epoch: 37, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.890 Vali Acc: 0.867 Test Loss: 0.890 Test Acc: 0.867
Validation loss decreased (-0.866657 --> -0.866658).  Saving model ...
Epoch: 38 cost time: 0.7412559986114502
Epoch: 38, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.860 Vali Acc: 0.856 Test Loss: 0.860 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7065508365631104
Epoch: 39, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.830 Vali Acc: 0.859 Test Loss: 0.830 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8618566989898682
Epoch: 40, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.801 Vali Acc: 0.867 Test Loss: 0.801 Test Acc: 0.867
Validation loss decreased (-0.866658 --> -0.866659).  Saving model ...
Epoch: 41 cost time: 0.6988632678985596
Epoch: 41, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.773 Vali Acc: 0.867 Test Loss: 0.773 Test Acc: 0.867
Validation loss decreased (-0.866659 --> -0.866659).  Saving model ...
Epoch: 42 cost time: 0.6748437881469727
Epoch: 42, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.746 Vali Acc: 0.870 Test Loss: 0.746 Test Acc: 0.870
Validation loss decreased (-0.866659 --> -0.870363).  Saving model ...
Epoch: 43 cost time: 0.7754569053649902
Epoch: 43, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.721 Vali Acc: 0.870 Test Loss: 0.721 Test Acc: 0.870
Validation loss decreased (-0.870363 --> -0.870363).  Saving model ...
Epoch: 44 cost time: 0.7767796516418457
Epoch: 44, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.697 Vali Acc: 0.885 Test Loss: 0.697 Test Acc: 0.885
Validation loss decreased (-0.870363 --> -0.885178).  Saving model ...
Epoch: 45 cost time: 0.9435293674468994
Epoch: 45, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.675 Vali Acc: 0.878 Test Loss: 0.675 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.901616096496582
Epoch: 46, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.655 Vali Acc: 0.878 Test Loss: 0.655 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6486251354217529
Epoch: 47, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.635 Vali Acc: 0.878 Test Loss: 0.635 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.713078498840332
Epoch: 48, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.617 Vali Acc: 0.874 Test Loss: 0.617 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2546610832214355
Epoch: 49, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.598 Vali Acc: 0.885 Test Loss: 0.598 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885179).  Saving model ...
Epoch: 50 cost time: 0.8535866737365723
Epoch: 50, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.579 Vali Acc: 0.889 Test Loss: 0.579 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 51 cost time: 0.619636058807373
Epoch: 51, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.562 Vali Acc: 0.896 Test Loss: 0.562 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 52 cost time: 0.8917868137359619
Epoch: 52, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.547 Vali Acc: 0.896 Test Loss: 0.547 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 53 cost time: 0.9572937488555908
Epoch: 53, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.533 Vali Acc: 0.904 Test Loss: 0.533 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903698).  Saving model ...
Epoch: 54 cost time: 0.8188035488128662
Epoch: 54, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.519 Vali Acc: 0.911 Test Loss: 0.519 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 55 cost time: 0.8107790946960449
Epoch: 55, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.507 Vali Acc: 0.919 Test Loss: 0.507 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918513).  Saving model ...
Epoch: 56 cost time: 0.7310276031494141
Epoch: 56, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.496 Vali Acc: 0.919 Test Loss: 0.496 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918514).  Saving model ...
Epoch: 57 cost time: 0.7700510025024414
Epoch: 57, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.485 Vali Acc: 0.922 Test Loss: 0.485 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922217).  Saving model ...
Epoch: 58 cost time: 0.7125773429870605
Epoch: 58, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.475 Vali Acc: 0.922 Test Loss: 0.475 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 59 cost time: 0.6998488903045654
Epoch: 59, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.465 Vali Acc: 0.919 Test Loss: 0.465 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.781804084777832
Epoch: 60, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.455 Vali Acc: 0.922 Test Loss: 0.455 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 61 cost time: 0.7385690212249756
Epoch: 61, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.446 Vali Acc: 0.922 Test Loss: 0.446 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 62 cost time: 0.7008376121520996
Epoch: 62, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.438 Vali Acc: 0.922 Test Loss: 0.438 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 63 cost time: 0.7988908290863037
Epoch: 63, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.429 Vali Acc: 0.926 Test Loss: 0.429 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 64 cost time: 0.8128225803375244
Epoch: 64, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.422 Vali Acc: 0.926 Test Loss: 0.422 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 65 cost time: 0.7428522109985352
Epoch: 65, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.415 Vali Acc: 0.922 Test Loss: 0.415 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.8164002895355225
Epoch: 66, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.409 Vali Acc: 0.926 Test Loss: 0.409 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 67 cost time: 0.9909234046936035
Epoch: 67, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.402 Vali Acc: 0.930 Test Loss: 0.402 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 68 cost time: 0.8294587135314941
Epoch: 68, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.395 Vali Acc: 0.930 Test Loss: 0.395 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 69 cost time: 0.8682122230529785
Epoch: 69, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.389 Vali Acc: 0.922 Test Loss: 0.389 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6641693115234375
Epoch: 70, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.383 Vali Acc: 0.922 Test Loss: 0.383 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.8086206912994385
Epoch: 71, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.377 Vali Acc: 0.930 Test Loss: 0.377 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 72 cost time: 0.8298075199127197
Epoch: 72, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.372 Vali Acc: 0.930 Test Loss: 0.372 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 73 cost time: 0.6736977100372314
Epoch: 73, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.367 Vali Acc: 0.930 Test Loss: 0.367 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 74 cost time: 0.8106653690338135
Epoch: 74, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.362 Vali Acc: 0.930 Test Loss: 0.362 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 75 cost time: 0.8444154262542725
Epoch: 75, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.358 Vali Acc: 0.930 Test Loss: 0.358 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 76 cost time: 0.7201344966888428
Epoch: 76, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.354 Vali Acc: 0.930 Test Loss: 0.354 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 77 cost time: 0.7291333675384521
Epoch: 77, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.350 Vali Acc: 0.930 Test Loss: 0.350 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 78 cost time: 0.6366655826568604
Epoch: 78, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.345 Vali Acc: 0.930 Test Loss: 0.345 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 79 cost time: 0.6729061603546143
Epoch: 79, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 80 cost time: 0.704155445098877
Epoch: 80, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.338 Vali Acc: 0.926 Test Loss: 0.338 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.7425382137298584
Epoch: 81, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.334 Vali Acc: 0.926 Test Loss: 0.334 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.7859225273132324
Epoch: 82, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.331 Vali Acc: 0.930 Test Loss: 0.331 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 83 cost time: 0.8454146385192871
Epoch: 83, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.7368171215057373
Epoch: 84, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.7365868091583252
Epoch: 85, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.8744072914123535
Epoch: 86, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.318 Vali Acc: 0.926 Test Loss: 0.318 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.7646126747131348
Epoch: 87, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.7949228286743164
Epoch: 88, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.8489115238189697
Epoch: 89, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.307 Vali Acc: 0.922 Test Loss: 0.307 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.7779359817504883
Epoch: 90, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.7223472595214844
Epoch: 91, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.6068415641784668
Epoch: 92, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.298 Vali Acc: 0.919 Test Loss: 0.298 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 133162
model size : 1.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.258971691131592
Epoch: 1, Steps: 2 | Train Loss: 1.909 Vali Loss: 1.768 Vali Acc: 0.270 Test Loss: 1.768 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 0.5847525596618652
Epoch: 2, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.684 Vali Acc: 0.344 Test Loss: 1.684 Test Acc: 0.344
Validation loss decreased (-0.270353 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 0.7884867191314697
Epoch: 3, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.610 Vali Acc: 0.407 Test Loss: 1.610 Test Acc: 0.407
Validation loss decreased (-0.344428 --> -0.407391).  Saving model ...
Epoch: 4 cost time: 0.769650936126709
Epoch: 4, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.529 Vali Acc: 0.456 Test Loss: 1.529 Test Acc: 0.456
Validation loss decreased (-0.407391 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 0.6598398685455322
Epoch: 5, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.450 Vali Acc: 0.578 Test Loss: 1.450 Test Acc: 0.578
Validation loss decreased (-0.455540 --> -0.577763).  Saving model ...
Epoch: 6 cost time: 0.6890552043914795
Epoch: 6, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.344 Vali Acc: 0.656 Test Loss: 1.344 Test Acc: 0.656
Validation loss decreased (-0.577763 --> -0.655542).  Saving model ...
Epoch: 7 cost time: 0.6857795715332031
Epoch: 7, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.215 Vali Acc: 0.756 Test Loss: 1.215 Test Acc: 0.756
Validation loss decreased (-0.655542 --> -0.755543).  Saving model ...
Epoch: 8 cost time: 0.6805851459503174
Epoch: 8, Steps: 2 | Train Loss: 1.160 Vali Loss: 1.088 Vali Acc: 0.822 Test Loss: 1.088 Test Acc: 0.822
Validation loss decreased (-0.755543 --> -0.822211).  Saving model ...
Epoch: 9 cost time: 0.6702077388763428
Epoch: 9, Steps: 2 | Train Loss: 1.006 Vali Loss: 0.978 Vali Acc: 0.796 Test Loss: 0.978 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5645122528076172
Epoch: 10, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.873 Vali Acc: 0.800 Test Loss: 0.873 Test Acc: 0.800
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7428009510040283
Epoch: 11, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.774 Vali Acc: 0.848 Test Loss: 0.774 Test Acc: 0.848
Validation loss decreased (-0.822211 --> -0.848140).  Saving model ...
Epoch: 12 cost time: 0.6579859256744385
Epoch: 12, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.695 Vali Acc: 0.852 Test Loss: 0.695 Test Acc: 0.852
Validation loss decreased (-0.848140 --> -0.851845).  Saving model ...
Epoch: 13 cost time: 0.6111018657684326
Epoch: 13, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.614 Vali Acc: 0.904 Test Loss: 0.614 Test Acc: 0.904
Validation loss decreased (-0.851845 --> -0.903698).  Saving model ...
Epoch: 14 cost time: 0.7951004505157471
Epoch: 14, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.541 Vali Acc: 0.933 Test Loss: 0.541 Test Acc: 0.933
Validation loss decreased (-0.903698 --> -0.933328).  Saving model ...
Epoch: 15 cost time: 0.7022733688354492
Epoch: 15, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.481 Vali Acc: 0.933 Test Loss: 0.481 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 16 cost time: 0.7953977584838867
Epoch: 16, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.429 Vali Acc: 0.944 Test Loss: 0.429 Test Acc: 0.944
Validation loss decreased (-0.933329 --> -0.944440).  Saving model ...
Epoch: 17 cost time: 0.6865153312683105
Epoch: 17, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.379 Vali Acc: 0.944 Test Loss: 0.379 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.5918927192687988
Epoch: 18, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.338 Vali Acc: 0.941 Test Loss: 0.338 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7526915073394775
Epoch: 19, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.316 Vali Acc: 0.926 Test Loss: 0.316 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7080063819885254
Epoch: 20, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6227343082427979
Epoch: 21, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7062077522277832
Epoch: 22, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.8163485527038574
Epoch: 23, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6468961238861084
Epoch: 24, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7369022369384766
Epoch: 25, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5996475219726562
Epoch: 26, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7732856273651123
Epoch: 27, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7271485328674316
Epoch: 28, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5667307376861572
Epoch: 29, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7561910152435303
Epoch: 30, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.6746315956115723
Epoch: 31, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.566948413848877
Epoch: 32, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6217260360717773
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5549349784851074
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.711543083190918
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7057044506072998
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6745438575744629
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6609649658203125
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.6059112548828125
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.6970765590667725
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 4802590
model size : 23.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.332979679107666
Epoch: 1, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.807 Vali Acc: 0.193 Test Loss: 1.807 Test Acc: 0.193
Validation loss decreased (inf --> -0.192575).  Saving model ...
Epoch: 2 cost time: 0.605257511138916
Epoch: 2, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.751 Vali Acc: 0.244 Test Loss: 1.751 Test Acc: 0.244
Validation loss decreased (-0.192575 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 0.6367731094360352
Epoch: 3, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.691 Vali Acc: 0.341 Test Loss: 1.691 Test Acc: 0.341
Validation loss decreased (-0.244427 --> -0.340724).  Saving model ...
Epoch: 4 cost time: 0.6915237903594971
Epoch: 4, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.606 Vali Acc: 0.437 Test Loss: 1.606 Test Acc: 0.437
Validation loss decreased (-0.340724 --> -0.437021).  Saving model ...
Epoch: 5 cost time: 0.9059238433837891
Epoch: 5, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.516 Vali Acc: 0.541 Test Loss: 1.516 Test Acc: 0.541
Validation loss decreased (-0.437021 --> -0.540726).  Saving model ...
Epoch: 6 cost time: 0.7831201553344727
Epoch: 6, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.423 Vali Acc: 0.570 Test Loss: 1.423 Test Acc: 0.570
Validation loss decreased (-0.540726 --> -0.570356).  Saving model ...
Epoch: 7 cost time: 0.722942590713501
Epoch: 7, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.298 Vali Acc: 0.619 Test Loss: 1.298 Test Acc: 0.619
Validation loss decreased (-0.570356 --> -0.618506).  Saving model ...
Epoch: 8 cost time: 0.7745375633239746
Epoch: 8, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.164 Vali Acc: 0.763 Test Loss: 1.164 Test Acc: 0.763
Validation loss decreased (-0.618506 --> -0.762951).  Saving model ...
Epoch: 9 cost time: 0.6689853668212891
Epoch: 9, Steps: 2 | Train Loss: 1.147 Vali Loss: 1.039 Vali Acc: 0.815 Test Loss: 1.039 Test Acc: 0.815
Validation loss decreased (-0.762951 --> -0.814804).  Saving model ...
Epoch: 10 cost time: 0.7677671909332275
Epoch: 10, Steps: 2 | Train Loss: 0.926 Vali Loss: 0.934 Vali Acc: 0.833 Test Loss: 0.934 Test Acc: 0.833
Validation loss decreased (-0.814804 --> -0.833324).  Saving model ...
Epoch: 11 cost time: 0.8195765018463135
Epoch: 11, Steps: 2 | Train Loss: 0.845 Vali Loss: 0.839 Vali Acc: 0.841 Test Loss: 0.839 Test Acc: 0.841
Validation loss decreased (-0.833324 --> -0.840732).  Saving model ...
Epoch: 12 cost time: 0.655693531036377
Epoch: 12, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.744 Vali Acc: 0.881 Test Loss: 0.744 Test Acc: 0.881
Validation loss decreased (-0.840732 --> -0.881474).  Saving model ...
Epoch: 13 cost time: 0.7413809299468994
Epoch: 13, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.664 Vali Acc: 0.907 Test Loss: 0.664 Test Acc: 0.907
Validation loss decreased (-0.881474 --> -0.907401).  Saving model ...
Epoch: 14 cost time: 0.7901253700256348
Epoch: 14, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.590 Vali Acc: 0.911 Test Loss: 0.590 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 15 cost time: 0.6934540271759033
Epoch: 15, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.517 Vali Acc: 0.926 Test Loss: 0.517 Test Acc: 0.926
Validation loss decreased (-0.911105 --> -0.925921).  Saving model ...
Epoch: 16 cost time: 0.62959885597229
Epoch: 16, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.460 Vali Acc: 0.930 Test Loss: 0.460 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 17 cost time: 0.6880381107330322
Epoch: 17, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.409 Vali Acc: 0.919 Test Loss: 0.409 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6452996730804443
Epoch: 18, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.355 Vali Acc: 0.926 Test Loss: 0.355 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7015664577484131
Epoch: 19, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.315 Vali Acc: 0.930 Test Loss: 0.315 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 20 cost time: 0.7499227523803711
Epoch: 20, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.292 Vali Acc: 0.922 Test Loss: 0.292 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6102571487426758
Epoch: 21, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5976026058197021
Epoch: 22, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940738).  Saving model ...
Epoch: 23 cost time: 0.6803958415985107
Epoch: 23, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.733696699142456
Epoch: 24, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.7141358852386475
Epoch: 25, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7587184906005859
Epoch: 26, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7765324115753174
Epoch: 27, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.7478415966033936
Epoch: 28, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 29 cost time: 0.646453857421875
Epoch: 29, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6963634490966797
Epoch: 30, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6898443698883057
Epoch: 31, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7348620891571045
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.750934362411499
Epoch: 33, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.6341691017150879
Epoch: 34, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.6327335834503174
Epoch: 35, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7104225158691406
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7565114498138428
Epoch: 37, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 38 cost time: 0.6127521991729736
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6784894466400146
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6243488788604736
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 41 cost time: 0.9720773696899414
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.7537977695465088
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6321635246276855
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.784416913986206
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6733779907226562
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.838883638381958
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7120895385742188
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.7279958724975586
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.6884300708770752
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.6078281402587891
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 4801054
model size : 23.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3393003940582275
Epoch: 1, Steps: 2 | Train Loss: 2.060 Vali Loss: 1.969 Vali Acc: 0.181 Test Loss: 1.969 Test Acc: 0.181
Validation loss decreased (inf --> -0.181462).  Saving model ...
Epoch: 2 cost time: 0.775982141494751
Epoch: 2, Steps: 2 | Train Loss: 1.955 Vali Loss: 1.872 Vali Acc: 0.222 Test Loss: 1.872 Test Acc: 0.222
Validation loss decreased (-0.181462 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 0.8377416133880615
Epoch: 3, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.781 Vali Acc: 0.252 Test Loss: 1.781 Test Acc: 0.252
Validation loss decreased (-0.222204 --> -0.251834).  Saving model ...
Epoch: 4 cost time: 0.6208193302154541
Epoch: 4, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.669 Vali Acc: 0.274 Test Loss: 1.669 Test Acc: 0.274
Validation loss decreased (-0.251834 --> -0.274057).  Saving model ...
Epoch: 5 cost time: 0.5744740962982178
Epoch: 5, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.568 Vali Acc: 0.359 Test Loss: 1.568 Test Acc: 0.359
Validation loss decreased (-0.274057 --> -0.359244).  Saving model ...
Epoch: 6 cost time: 0.6945648193359375
Epoch: 6, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.471 Vali Acc: 0.519 Test Loss: 1.471 Test Acc: 0.519
Validation loss decreased (-0.359244 --> -0.518504).  Saving model ...
Epoch: 7 cost time: 0.8353049755096436
Epoch: 7, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.368 Vali Acc: 0.563 Test Loss: 1.368 Test Acc: 0.563
Validation loss decreased (-0.518504 --> -0.562949).  Saving model ...
Epoch: 8 cost time: 0.6650018692016602
Epoch: 8, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.228 Vali Acc: 0.663 Test Loss: 1.228 Test Acc: 0.663
Validation loss decreased (-0.562949 --> -0.662951).  Saving model ...
Epoch: 9 cost time: 0.7923305034637451
Epoch: 9, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.077 Vali Acc: 0.756 Test Loss: 1.077 Test Acc: 0.756
Validation loss decreased (-0.662951 --> -0.755545).  Saving model ...
Epoch: 10 cost time: 0.7110590934753418
Epoch: 10, Steps: 2 | Train Loss: 0.951 Vali Loss: 0.951 Vali Acc: 0.800 Test Loss: 0.951 Test Acc: 0.800
Validation loss decreased (-0.755545 --> -0.799990).  Saving model ...
Epoch: 11 cost time: 0.7052969932556152
Epoch: 11, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.849 Vali Acc: 0.796 Test Loss: 0.849 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7701303958892822
Epoch: 12, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.749 Vali Acc: 0.878 Test Loss: 0.749 Test Acc: 0.878
Validation loss decreased (-0.799990 --> -0.877770).  Saving model ...
Epoch: 13 cost time: 0.6581826210021973
Epoch: 13, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.659 Vali Acc: 0.911 Test Loss: 0.659 Test Acc: 0.911
Validation loss decreased (-0.877770 --> -0.911105).  Saving model ...
Epoch: 14 cost time: 0.6951353549957275
Epoch: 14, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.582 Vali Acc: 0.944 Test Loss: 0.582 Test Acc: 0.944
Validation loss decreased (-0.911105 --> -0.944439).  Saving model ...
Epoch: 15 cost time: 0.6384143829345703
Epoch: 15, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.519 Vali Acc: 0.904 Test Loss: 0.519 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6545653343200684
Epoch: 16, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.458 Vali Acc: 0.926 Test Loss: 0.458 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7163536548614502
Epoch: 17, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.400 Vali Acc: 0.941 Test Loss: 0.400 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.732213020324707
Epoch: 18, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.364 Vali Acc: 0.930 Test Loss: 0.364 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6208035945892334
Epoch: 19, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.313 Vali Acc: 0.956 Test Loss: 0.313 Test Acc: 0.956
Validation loss decreased (-0.944439 --> -0.955552).  Saving model ...
Epoch: 20 cost time: 0.6937553882598877
Epoch: 20, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9476220607757568
Epoch: 21, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7518706321716309
Epoch: 22, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9307036399841309
Epoch: 23, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.207 Vali Acc: 0.952 Test Loss: 0.207 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8002066612243652
Epoch: 24, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.562237024307251
Epoch: 25, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6848869323730469
Epoch: 26, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6064915657043457
Epoch: 27, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8155465126037598
Epoch: 28, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7483456134796143
Epoch: 29, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 4799518
model size : 23.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.124344825744629
Epoch: 1, Steps: 2 | Train Loss: 2.056 Vali Loss: 1.923 Vali Acc: 0.137 Test Loss: 1.923 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 0.7617759704589844
Epoch: 2, Steps: 2 | Train Loss: 1.911 Vali Loss: 1.857 Vali Acc: 0.148 Test Loss: 1.857 Test Acc: 0.148
Validation loss decreased (-0.137018 --> -0.148130).  Saving model ...
Epoch: 3 cost time: 0.6232681274414062
Epoch: 3, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.790 Vali Acc: 0.193 Test Loss: 1.790 Test Acc: 0.193
Validation loss decreased (-0.148130 --> -0.192575).  Saving model ...
Epoch: 4 cost time: 0.6679732799530029
Epoch: 4, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.703 Vali Acc: 0.267 Test Loss: 1.703 Test Acc: 0.267
Validation loss decreased (-0.192575 --> -0.266650).  Saving model ...
Epoch: 5 cost time: 0.7363319396972656
Epoch: 5, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.604 Vali Acc: 0.348 Test Loss: 1.604 Test Acc: 0.348
Validation loss decreased (-0.266650 --> -0.348132).  Saving model ...
Epoch: 6 cost time: 0.6862130165100098
Epoch: 6, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.488 Vali Acc: 0.515 Test Loss: 1.488 Test Acc: 0.515
Validation loss decreased (-0.348132 --> -0.514800).  Saving model ...
Epoch: 7 cost time: 0.5475804805755615
Epoch: 7, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.347 Vali Acc: 0.656 Test Loss: 1.347 Test Acc: 0.656
Validation loss decreased (-0.514800 --> -0.655542).  Saving model ...
Epoch: 8 cost time: 0.6285459995269775
Epoch: 8, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.204 Vali Acc: 0.811 Test Loss: 1.204 Test Acc: 0.811
Validation loss decreased (-0.655542 --> -0.811099).  Saving model ...
Epoch: 9 cost time: 0.6827824115753174
Epoch: 9, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.076 Vali Acc: 0.844 Test Loss: 1.076 Test Acc: 0.844
Validation loss decreased (-0.811099 --> -0.844434).  Saving model ...
Epoch: 10 cost time: 0.7337250709533691
Epoch: 10, Steps: 2 | Train Loss: 0.972 Vali Loss: 0.955 Vali Acc: 0.863 Test Loss: 0.955 Test Acc: 0.863
Validation loss decreased (-0.844434 --> -0.862953).  Saving model ...
Epoch: 11 cost time: 0.5801525115966797
Epoch: 11, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.852 Vali Acc: 0.859 Test Loss: 0.852 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5366842746734619
Epoch: 12, Steps: 2 | Train Loss: 0.730 Vali Loss: 0.745 Vali Acc: 0.904 Test Loss: 0.745 Test Acc: 0.904
Validation loss decreased (-0.862953 --> -0.903696).  Saving model ...
Epoch: 13 cost time: 0.6365070343017578
Epoch: 13, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.652 Vali Acc: 0.915 Test Loss: 0.652 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914808).  Saving model ...
Epoch: 14 cost time: 0.7920892238616943
Epoch: 14, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.574 Vali Acc: 0.915 Test Loss: 0.574 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 15 cost time: 0.7058565616607666
Epoch: 15, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.502 Vali Acc: 0.948 Test Loss: 0.502 Test Acc: 0.948
Validation loss decreased (-0.914809 --> -0.948143).  Saving model ...
Epoch: 16 cost time: 0.7561347484588623
Epoch: 16, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.447 Vali Acc: 0.948 Test Loss: 0.447 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 17 cost time: 0.7268867492675781
Epoch: 17, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.404 Vali Acc: 0.933 Test Loss: 0.404 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6694676876068115
Epoch: 18, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.350 Vali Acc: 0.959 Test Loss: 0.350 Test Acc: 0.959
Validation loss decreased (-0.948144 --> -0.959256).  Saving model ...
Epoch: 19 cost time: 0.6990833282470703
Epoch: 19, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.306 Vali Acc: 0.959 Test Loss: 0.306 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959256).  Saving model ...
Epoch: 20 cost time: 0.6529603004455566
Epoch: 20, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.273 Vali Acc: 0.959 Test Loss: 0.273 Test Acc: 0.959
Validation loss decreased (-0.959256 --> -0.959257).  Saving model ...
Epoch: 21 cost time: 0.700587272644043
Epoch: 21, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6978609561920166
Epoch: 22, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8914468288421631
Epoch: 23, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6548938751220703
Epoch: 24, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.960172176361084
Epoch: 25, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7311866283416748
Epoch: 26, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7037093639373779
Epoch: 27, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7027804851531982
Epoch: 28, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5867471694946289
Epoch: 29, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.605787992477417
Epoch: 30, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 4797982
model size : 23.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.05865740776062
Epoch: 1, Steps: 2 | Train Loss: 2.051 Vali Loss: 1.923 Vali Acc: 0.167 Test Loss: 1.923 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.6870079040527344
Epoch: 2, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.836 Vali Acc: 0.167 Test Loss: 1.836 Test Acc: 0.167
Validation loss decreased (-0.166647 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.6681389808654785
Epoch: 3, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.762 Vali Acc: 0.237 Test Loss: 1.762 Test Acc: 0.237
Validation loss decreased (-0.166648 --> -0.237019).  Saving model ...
Epoch: 4 cost time: 0.6827905178070068
Epoch: 4, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.667 Vali Acc: 0.367 Test Loss: 1.667 Test Acc: 0.367
Validation loss decreased (-0.237019 --> -0.366650).  Saving model ...
Epoch: 5 cost time: 0.7331171035766602
Epoch: 5, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.568 Vali Acc: 0.485 Test Loss: 1.568 Test Acc: 0.485
Validation loss decreased (-0.366650 --> -0.485170).  Saving model ...
Epoch: 6 cost time: 0.7203807830810547
Epoch: 6, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.470 Vali Acc: 0.552 Test Loss: 1.470 Test Acc: 0.552
Validation loss decreased (-0.485170 --> -0.551837).  Saving model ...
Epoch: 7 cost time: 0.6145873069763184
Epoch: 7, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.353 Vali Acc: 0.607 Test Loss: 1.353 Test Acc: 0.607
Validation loss decreased (-0.551837 --> -0.607394).  Saving model ...
Epoch: 8 cost time: 0.6649503707885742
Epoch: 8, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.219 Vali Acc: 0.770 Test Loss: 1.219 Test Acc: 0.770
Validation loss decreased (-0.607394 --> -0.770358).  Saving model ...
Epoch: 9 cost time: 0.6925456523895264
Epoch: 9, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.099 Vali Acc: 0.844 Test Loss: 1.099 Test Acc: 0.844
Validation loss decreased (-0.770358 --> -0.844433).  Saving model ...
Epoch: 10 cost time: 0.6757075786590576
Epoch: 10, Steps: 2 | Train Loss: 0.989 Vali Loss: 0.990 Vali Acc: 0.893 Test Loss: 0.990 Test Acc: 0.893
Validation loss decreased (-0.844433 --> -0.892583).  Saving model ...
Epoch: 11 cost time: 0.7694342136383057
Epoch: 11, Steps: 2 | Train Loss: 0.857 Vali Loss: 0.890 Vali Acc: 0.878 Test Loss: 0.890 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7818973064422607
Epoch: 12, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.787 Vali Acc: 0.911 Test Loss: 0.787 Test Acc: 0.911
Validation loss decreased (-0.892583 --> -0.911103).  Saving model ...
Epoch: 13 cost time: 0.6805040836334229
Epoch: 13, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.695 Vali Acc: 0.930 Test Loss: 0.695 Test Acc: 0.930
Validation loss decreased (-0.911103 --> -0.929623).  Saving model ...
Epoch: 14 cost time: 0.599036455154419
Epoch: 14, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.612 Vali Acc: 0.930 Test Loss: 0.612 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 15 cost time: 0.5647215843200684
Epoch: 15, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.541 Vali Acc: 0.937 Test Loss: 0.541 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 16 cost time: 0.5715532302856445
Epoch: 16, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.475 Vali Acc: 0.948 Test Loss: 0.475 Test Acc: 0.948
Validation loss decreased (-0.937032 --> -0.948143).  Saving model ...
Epoch: 17 cost time: 0.6103115081787109
Epoch: 17, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.417 Vali Acc: 0.948 Test Loss: 0.417 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 18 cost time: 0.68656325340271
Epoch: 18, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.374 Vali Acc: 0.948 Test Loss: 0.374 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 19 cost time: 0.5864133834838867
Epoch: 19, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.340 Vali Acc: 0.937 Test Loss: 0.340 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7326462268829346
Epoch: 20, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.312 Vali Acc: 0.922 Test Loss: 0.312 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6376407146453857
Epoch: 21, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6650543212890625
Epoch: 22, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8141462802886963
Epoch: 23, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.224 Vali Acc: 0.952 Test Loss: 0.224 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.7582435607910156
Epoch: 24, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6873180866241455
Epoch: 25, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7074217796325684
Epoch: 26, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5913667678833008
Epoch: 27, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5990660190582275
Epoch: 28, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6145596504211426
Epoch: 29, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6012322902679443
Epoch: 30, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6257965564727783
Epoch: 31, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6795761585235596
Epoch: 32, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7113552093505859
Epoch: 33, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 4014622
model size : 20.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7409656047821045
Epoch: 1, Steps: 2 | Train Loss: 2.085 Vali Loss: 1.964 Vali Acc: 0.137 Test Loss: 1.964 Test Acc: 0.137
Validation loss decreased (inf --> -0.137017).  Saving model ...
Epoch: 2 cost time: 0.7219901084899902
Epoch: 2, Steps: 2 | Train Loss: 1.947 Vali Loss: 1.890 Vali Acc: 0.159 Test Loss: 1.890 Test Acc: 0.159
Validation loss decreased (-0.137017 --> -0.159240).  Saving model ...
Epoch: 3 cost time: 0.7771110534667969
Epoch: 3, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.816 Vali Acc: 0.181 Test Loss: 1.816 Test Acc: 0.181
Validation loss decreased (-0.159240 --> -0.181463).  Saving model ...
Epoch: 4 cost time: 0.6634571552276611
Epoch: 4, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.721 Vali Acc: 0.315 Test Loss: 1.721 Test Acc: 0.315
Validation loss decreased (-0.181463 --> -0.314798).  Saving model ...
Epoch: 5 cost time: 1.060868263244629
Epoch: 5, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.626 Vali Acc: 0.389 Test Loss: 1.626 Test Acc: 0.389
Validation loss decreased (-0.314798 --> -0.388873).  Saving model ...
Epoch: 6 cost time: 0.6043777465820312
Epoch: 6, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.525 Vali Acc: 0.507 Test Loss: 1.525 Test Acc: 0.507
Validation loss decreased (-0.388873 --> -0.507392).  Saving model ...
Epoch: 7 cost time: 0.6628444194793701
Epoch: 7, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.411 Vali Acc: 0.574 Test Loss: 1.411 Test Acc: 0.574
Validation loss decreased (-0.507392 --> -0.574060).  Saving model ...
Epoch: 8 cost time: 0.6829681396484375
Epoch: 8, Steps: 2 | Train Loss: 1.365 Vali Loss: 1.278 Vali Acc: 0.656 Test Loss: 1.278 Test Acc: 0.656
Validation loss decreased (-0.574060 --> -0.655543).  Saving model ...
Epoch: 9 cost time: 0.8724758625030518
Epoch: 9, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.151 Vali Acc: 0.763 Test Loss: 1.151 Test Acc: 0.763
Validation loss decreased (-0.655543 --> -0.762951).  Saving model ...
Epoch: 10 cost time: 0.9595801830291748
Epoch: 10, Steps: 2 | Train Loss: 1.046 Vali Loss: 1.043 Vali Acc: 0.748 Test Loss: 1.043 Test Acc: 0.748
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.689889669418335
Epoch: 11, Steps: 2 | Train Loss: 0.919 Vali Loss: 0.944 Vali Acc: 0.763 Test Loss: 0.944 Test Acc: 0.763
Validation loss decreased (-0.762951 --> -0.762954).  Saving model ...
Epoch: 12 cost time: 0.8232035636901855
Epoch: 12, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.839 Vali Acc: 0.859 Test Loss: 0.839 Test Acc: 0.859
Validation loss decreased (-0.762954 --> -0.859251).  Saving model ...
Epoch: 13 cost time: 1.0271646976470947
Epoch: 13, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.743 Vali Acc: 0.933 Test Loss: 0.743 Test Acc: 0.933
Validation loss decreased (-0.859251 --> -0.933326).  Saving model ...
Epoch: 14 cost time: 0.7453796863555908
Epoch: 14, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.660 Vali Acc: 0.922 Test Loss: 0.660 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0313918590545654
Epoch: 15, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.600 Vali Acc: 0.874 Test Loss: 0.600 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8632915019989014
Epoch: 16, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.533 Vali Acc: 0.904 Test Loss: 0.533 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7455451488494873
Epoch: 17, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.470 Vali Acc: 0.922 Test Loss: 0.470 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7874031066894531
Epoch: 18, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.423 Vali Acc: 0.926 Test Loss: 0.423 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2817401885986328
Epoch: 19, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.374 Vali Acc: 0.944 Test Loss: 0.374 Test Acc: 0.944
Validation loss decreased (-0.933326 --> -0.944441).  Saving model ...
Epoch: 20 cost time: 0.7975597381591797
Epoch: 20, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.338 Vali Acc: 0.941 Test Loss: 0.338 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8087766170501709
Epoch: 21, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.313 Vali Acc: 0.930 Test Loss: 0.313 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7141401767730713
Epoch: 22, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9964237213134766
Epoch: 23, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.786189079284668
Epoch: 24, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 25 cost time: 0.8324398994445801
Epoch: 25, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7886953353881836
Epoch: 26, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9226045608520508
Epoch: 27, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7072205543518066
Epoch: 28, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8273546695709229
Epoch: 29, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6465628147125244
Epoch: 30, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7752587795257568
Epoch: 31, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.9134457111358643
Epoch: 32, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8824970722198486
Epoch: 33, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7851431369781494
Epoch: 34, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 4013086
model size : 20.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.539824962615967
Epoch: 1, Steps: 2 | Train Loss: 2.112 Vali Loss: 1.994 Vali Acc: 0.167 Test Loss: 1.994 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.7558989524841309
Epoch: 2, Steps: 2 | Train Loss: 1.950 Vali Loss: 1.888 Vali Acc: 0.174 Test Loss: 1.888 Test Acc: 0.174
Validation loss decreased (-0.166647 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 0.8300671577453613
Epoch: 3, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.800 Vali Acc: 0.237 Test Loss: 1.800 Test Acc: 0.237
Validation loss decreased (-0.174055 --> -0.237019).  Saving model ...
Epoch: 4 cost time: 0.635385274887085
Epoch: 4, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.706 Vali Acc: 0.296 Test Loss: 1.706 Test Acc: 0.296
Validation loss decreased (-0.237019 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 0.7826104164123535
Epoch: 5, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.620 Vali Acc: 0.330 Test Loss: 1.620 Test Acc: 0.330
Validation loss decreased (-0.296279 --> -0.329613).  Saving model ...
Epoch: 6 cost time: 0.8556761741638184
Epoch: 6, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.532 Vali Acc: 0.433 Test Loss: 1.532 Test Acc: 0.433
Validation loss decreased (-0.329613 --> -0.433318).  Saving model ...
Epoch: 7 cost time: 0.9044084548950195
Epoch: 7, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.413 Vali Acc: 0.530 Test Loss: 1.413 Test Acc: 0.530
Validation loss decreased (-0.433318 --> -0.529615).  Saving model ...
Epoch: 8 cost time: 0.7964754104614258
Epoch: 8, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.267 Vali Acc: 0.700 Test Loss: 1.267 Test Acc: 0.700
Validation loss decreased (-0.529615 --> -0.699987).  Saving model ...
Epoch: 9 cost time: 0.8790171146392822
Epoch: 9, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.130 Vali Acc: 0.811 Test Loss: 1.130 Test Acc: 0.811
Validation loss decreased (-0.699987 --> -0.811100).  Saving model ...
Epoch: 10 cost time: 0.7682147026062012
Epoch: 10, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.021 Vali Acc: 0.796 Test Loss: 1.021 Test Acc: 0.796
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.939971923828125
Epoch: 11, Steps: 2 | Train Loss: 0.933 Vali Loss: 0.934 Vali Acc: 0.789 Test Loss: 0.934 Test Acc: 0.789
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.04457688331604
Epoch: 12, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.835 Vali Acc: 0.859 Test Loss: 0.835 Test Acc: 0.859
Validation loss decreased (-0.811100 --> -0.859251).  Saving model ...
Epoch: 13 cost time: 1.0183284282684326
Epoch: 13, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.734 Vali Acc: 0.885 Test Loss: 0.734 Test Acc: 0.885
Validation loss decreased (-0.859251 --> -0.885178).  Saving model ...
Epoch: 14 cost time: 0.5833067893981934
Epoch: 14, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.642 Vali Acc: 0.885 Test Loss: 0.642 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885179).  Saving model ...
Epoch: 15 cost time: 0.7077279090881348
Epoch: 15, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.564 Vali Acc: 0.911 Test Loss: 0.564 Test Acc: 0.911
Validation loss decreased (-0.885179 --> -0.911105).  Saving model ...
Epoch: 16 cost time: 0.8436367511749268
Epoch: 16, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.495 Vali Acc: 0.937 Test Loss: 0.495 Test Acc: 0.937
Validation loss decreased (-0.911105 --> -0.937032).  Saving model ...
Epoch: 17 cost time: 0.9495651721954346
Epoch: 17, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.433 Vali Acc: 0.944 Test Loss: 0.433 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944440).  Saving model ...
Epoch: 18 cost time: 0.8237333297729492
Epoch: 18, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.377 Vali Acc: 0.941 Test Loss: 0.377 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6653196811676025
Epoch: 19, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.339 Vali Acc: 0.933 Test Loss: 0.339 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6952409744262695
Epoch: 20, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.8615636825561523
Epoch: 21, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8470199108123779
Epoch: 22, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7777376174926758
Epoch: 23, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944442).  Saving model ...
Epoch: 24 cost time: 0.6773169040679932
Epoch: 24, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.6923923492431641
Epoch: 25, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8526804447174072
Epoch: 26, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0211293697357178
Epoch: 27, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7013022899627686
Epoch: 28, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6922562122344971
Epoch: 29, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6960787773132324
Epoch: 30, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5686590671539307
Epoch: 31, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7473664283752441
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6765842437744141
Epoch: 33, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6599140167236328
Epoch: 34, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 4011550
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4622864723205566
Epoch: 1, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.762 Vali Acc: 0.170 Test Loss: 1.762 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.5669586658477783
Epoch: 2, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.696 Vali Acc: 0.241 Test Loss: 1.696 Test Acc: 0.241
Validation loss decreased (-0.170353 --> -0.240724).  Saving model ...
Epoch: 3 cost time: 0.5661797523498535
Epoch: 3, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.638 Vali Acc: 0.359 Test Loss: 1.638 Test Acc: 0.359
Validation loss decreased (-0.240724 --> -0.359243).  Saving model ...
Epoch: 4 cost time: 0.70804762840271
Epoch: 4, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.566 Vali Acc: 0.459 Test Loss: 1.566 Test Acc: 0.459
Validation loss decreased (-0.359243 --> -0.459244).  Saving model ...
Epoch: 5 cost time: 0.6704192161560059
Epoch: 5, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.479 Vali Acc: 0.519 Test Loss: 1.479 Test Acc: 0.519
Validation loss decreased (-0.459244 --> -0.518504).  Saving model ...
Epoch: 6 cost time: 0.5546741485595703
Epoch: 6, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.377 Vali Acc: 0.652 Test Loss: 1.377 Test Acc: 0.652
Validation loss decreased (-0.518504 --> -0.651838).  Saving model ...
Epoch: 7 cost time: 0.7722444534301758
Epoch: 7, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.265 Vali Acc: 0.726 Test Loss: 1.265 Test Acc: 0.726
Validation loss decreased (-0.651838 --> -0.725913).  Saving model ...
Epoch: 8 cost time: 0.8615984916687012
Epoch: 8, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.154 Vali Acc: 0.733 Test Loss: 1.154 Test Acc: 0.733
Validation loss decreased (-0.725913 --> -0.733322).  Saving model ...
Epoch: 9 cost time: 0.8986728191375732
Epoch: 9, Steps: 2 | Train Loss: 1.091 Vali Loss: 1.043 Vali Acc: 0.793 Test Loss: 1.043 Test Acc: 0.793
Validation loss decreased (-0.733322 --> -0.792582).  Saving model ...
Epoch: 10 cost time: 0.8488333225250244
Epoch: 10, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.947 Vali Acc: 0.863 Test Loss: 0.947 Test Acc: 0.863
Validation loss decreased (-0.792582 --> -0.862953).  Saving model ...
Epoch: 11 cost time: 0.5601966381072998
Epoch: 11, Steps: 2 | Train Loss: 0.833 Vali Loss: 0.860 Vali Acc: 0.881 Test Loss: 0.860 Test Acc: 0.881
Validation loss decreased (-0.862953 --> -0.881473).  Saving model ...
Epoch: 12 cost time: 0.7506344318389893
Epoch: 12, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.769 Vali Acc: 0.904 Test Loss: 0.769 Test Acc: 0.904
Validation loss decreased (-0.881473 --> -0.903696).  Saving model ...
Epoch: 13 cost time: 0.6838607788085938
Epoch: 13, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.682 Vali Acc: 0.915 Test Loss: 0.682 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914808).  Saving model ...
Epoch: 14 cost time: 0.6267578601837158
Epoch: 14, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.605 Vali Acc: 0.922 Test Loss: 0.605 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 15 cost time: 0.862088680267334
Epoch: 15, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.542 Vali Acc: 0.915 Test Loss: 0.542 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7654235363006592
Epoch: 16, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.479 Vali Acc: 0.933 Test Loss: 0.479 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933329).  Saving model ...
Epoch: 17 cost time: 0.7144615650177002
Epoch: 17, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.426 Vali Acc: 0.937 Test Loss: 0.426 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 18 cost time: 0.8468642234802246
Epoch: 18, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.389 Vali Acc: 0.933 Test Loss: 0.389 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6532971858978271
Epoch: 19, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.349 Vali Acc: 0.926 Test Loss: 0.349 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8865089416503906
Epoch: 20, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6186819076538086
Epoch: 21, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 22 cost time: 0.6176285743713379
Epoch: 22, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
Validation loss decreased (-0.937034 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.749004602432251
Epoch: 23, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 1.0136332511901855
Epoch: 24, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7298886775970459
Epoch: 25, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.231 Vali Acc: 0.919 Test Loss: 0.231 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7541553974151611
Epoch: 26, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6641960144042969
Epoch: 27, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1133849620819092
Epoch: 28, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8000619411468506
Epoch: 29, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7300026416778564
Epoch: 30, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.175 Vali Acc: 0.933 Test Loss: 0.175 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5405700206756592
Epoch: 31, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.926 Test Loss: 0.183 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7065267562866211
Epoch: 32, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.926 Test Loss: 0.192 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9188814163208008
Epoch: 33, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 4010014
model size : 20.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.05808687210083
Epoch: 1, Steps: 2 | Train Loss: 2.197 Vali Loss: 2.060 Vali Acc: 0.159 Test Loss: 2.060 Test Acc: 0.159
Validation loss decreased (inf --> -0.159239).  Saving model ...
Epoch: 2 cost time: 0.5775630474090576
Epoch: 2, Steps: 2 | Train Loss: 2.056 Vali Loss: 1.950 Vali Acc: 0.130 Test Loss: 1.950 Test Acc: 0.130
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.7523937225341797
Epoch: 3, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.856 Vali Acc: 0.148 Test Loss: 1.856 Test Acc: 0.148
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.6291992664337158
Epoch: 4, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.744 Vali Acc: 0.215 Test Loss: 1.744 Test Acc: 0.215
Validation loss decreased (-0.159239 --> -0.214797).  Saving model ...
Epoch: 5 cost time: 0.5464248657226562
Epoch: 5, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.654 Vali Acc: 0.348 Test Loss: 1.654 Test Acc: 0.348
Validation loss decreased (-0.214797 --> -0.348132).  Saving model ...
Epoch: 6 cost time: 0.6290340423583984
Epoch: 6, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.575 Vali Acc: 0.444 Test Loss: 1.575 Test Acc: 0.444
Validation loss decreased (-0.348132 --> -0.444429).  Saving model ...
Epoch: 7 cost time: 0.6048679351806641
Epoch: 7, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.489 Vali Acc: 0.493 Test Loss: 1.489 Test Acc: 0.493
Validation loss decreased (-0.444429 --> -0.492578).  Saving model ...
Epoch: 8 cost time: 0.5845715999603271
Epoch: 8, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.368 Vali Acc: 0.604 Test Loss: 1.368 Test Acc: 0.604
Validation loss decreased (-0.492578 --> -0.603690).  Saving model ...
Epoch: 9 cost time: 0.6675412654876709
Epoch: 9, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.231 Vali Acc: 0.707 Test Loss: 1.231 Test Acc: 0.707
Validation loss decreased (-0.603690 --> -0.707395).  Saving model ...
Epoch: 10 cost time: 0.8405194282531738
Epoch: 10, Steps: 2 | Train Loss: 1.098 Vali Loss: 1.092 Vali Acc: 0.785 Test Loss: 1.092 Test Acc: 0.785
Validation loss decreased (-0.707395 --> -0.785174).  Saving model ...
Epoch: 11 cost time: 0.7020549774169922
Epoch: 11, Steps: 2 | Train Loss: 0.993 Vali Loss: 0.980 Vali Acc: 0.804 Test Loss: 0.980 Test Acc: 0.804
Validation loss decreased (-0.785174 --> -0.803694).  Saving model ...
Epoch: 12 cost time: 0.6011936664581299
Epoch: 12, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.880 Vali Acc: 0.789 Test Loss: 0.880 Test Acc: 0.789
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6206369400024414
Epoch: 13, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.786 Vali Acc: 0.807 Test Loss: 0.786 Test Acc: 0.807
Validation loss decreased (-0.803694 --> -0.807400).  Saving model ...
Epoch: 14 cost time: 0.6947240829467773
Epoch: 14, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.694 Vali Acc: 0.867 Test Loss: 0.694 Test Acc: 0.867
Validation loss decreased (-0.807400 --> -0.866660).  Saving model ...
Epoch: 15 cost time: 0.5880224704742432
Epoch: 15, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.617 Vali Acc: 0.922 Test Loss: 0.617 Test Acc: 0.922
Validation loss decreased (-0.866660 --> -0.922216).  Saving model ...
Epoch: 16 cost time: 0.6507935523986816
Epoch: 16, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.559 Vali Acc: 0.889 Test Loss: 0.559 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6060166358947754
Epoch: 17, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.504 Vali Acc: 0.919 Test Loss: 0.504 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8438153266906738
Epoch: 18, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.448 Vali Acc: 0.944 Test Loss: 0.448 Test Acc: 0.944
Validation loss decreased (-0.922216 --> -0.944440).  Saving model ...
Epoch: 19 cost time: 0.8454933166503906
Epoch: 19, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.414 Vali Acc: 0.911 Test Loss: 0.414 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7458658218383789
Epoch: 20, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.389 Vali Acc: 0.885 Test Loss: 0.389 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.683971643447876
Epoch: 21, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.340 Vali Acc: 0.900 Test Loss: 0.340 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6441128253936768
Epoch: 22, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7086400985717773
Epoch: 23, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.267 Vali Acc: 0.956 Test Loss: 0.267 Test Acc: 0.956
Validation loss decreased (-0.944440 --> -0.955553).  Saving model ...
Epoch: 24 cost time: 0.7979030609130859
Epoch: 24, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.249 Vali Acc: 0.948 Test Loss: 0.249 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7099392414093018
Epoch: 25, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7664217948913574
Epoch: 26, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.246 Vali Acc: 0.915 Test Loss: 0.246 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6877193450927734
Epoch: 27, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.233 Vali Acc: 0.915 Test Loss: 0.233 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6525001525878906
Epoch: 28, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7415440082550049
Epoch: 29, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7185487747192383
Epoch: 30, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9423813819885254
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.9427263736724854
Epoch: 32, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8163104057312012
Epoch: 33, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 3620638
model size : 18.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3974835872650146
Epoch: 1, Steps: 2 | Train Loss: 1.955 Vali Loss: 1.856 Vali Acc: 0.256 Test Loss: 1.856 Test Acc: 0.256
Validation loss decreased (inf --> -0.255537).  Saving model ...
Epoch: 2 cost time: 0.8918137550354004
Epoch: 2, Steps: 2 | Train Loss: 1.896 Vali Loss: 1.811 Vali Acc: 0.274 Test Loss: 1.811 Test Acc: 0.274
Validation loss decreased (-0.255537 --> -0.274056).  Saving model ...
Epoch: 3 cost time: 0.5574142932891846
Epoch: 3, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.764 Vali Acc: 0.296 Test Loss: 1.764 Test Acc: 0.296
Validation loss decreased (-0.274056 --> -0.296279).  Saving model ...
Epoch: 4 cost time: 0.6713390350341797
Epoch: 4, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.692 Vali Acc: 0.315 Test Loss: 1.692 Test Acc: 0.315
Validation loss decreased (-0.296279 --> -0.314798).  Saving model ...
Epoch: 5 cost time: 0.6071856021881104
Epoch: 5, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.606 Vali Acc: 0.393 Test Loss: 1.606 Test Acc: 0.393
Validation loss decreased (-0.314798 --> -0.392577).  Saving model ...
Epoch: 6 cost time: 0.7121081352233887
Epoch: 6, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.502 Vali Acc: 0.570 Test Loss: 1.502 Test Acc: 0.570
Validation loss decreased (-0.392577 --> -0.570355).  Saving model ...
Epoch: 7 cost time: 0.5479316711425781
Epoch: 7, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.379 Vali Acc: 0.759 Test Loss: 1.379 Test Acc: 0.759
Validation loss decreased (-0.570355 --> -0.759245).  Saving model ...
Epoch: 8 cost time: 0.718853235244751
Epoch: 8, Steps: 2 | Train Loss: 1.307 Vali Loss: 1.254 Vali Acc: 0.844 Test Loss: 1.254 Test Acc: 0.844
Validation loss decreased (-0.759245 --> -0.844432).  Saving model ...
Epoch: 9 cost time: 0.5757732391357422
Epoch: 9, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.135 Vali Acc: 0.859 Test Loss: 1.135 Test Acc: 0.859
Validation loss decreased (-0.844432 --> -0.859248).  Saving model ...
Epoch: 10 cost time: 0.7037346363067627
Epoch: 10, Steps: 2 | Train Loss: 1.036 Vali Loss: 1.026 Vali Acc: 0.837 Test Loss: 1.026 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6365184783935547
Epoch: 11, Steps: 2 | Train Loss: 0.967 Vali Loss: 0.923 Vali Acc: 0.870 Test Loss: 0.923 Test Acc: 0.870
Validation loss decreased (-0.859248 --> -0.870361).  Saving model ...
Epoch: 12 cost time: 0.7055294513702393
Epoch: 12, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.831 Vali Acc: 0.881 Test Loss: 0.831 Test Acc: 0.881
Validation loss decreased (-0.870361 --> -0.881473).  Saving model ...
Epoch: 13 cost time: 0.6321718692779541
Epoch: 13, Steps: 2 | Train Loss: 0.692 Vali Loss: 0.737 Vali Acc: 0.915 Test Loss: 0.737 Test Acc: 0.915
Validation loss decreased (-0.881473 --> -0.914807).  Saving model ...
Epoch: 14 cost time: 0.6966331005096436
Epoch: 14, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.655 Vali Acc: 0.915 Test Loss: 0.655 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 15 cost time: 0.5601472854614258
Epoch: 15, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.575 Vali Acc: 0.937 Test Loss: 0.575 Test Acc: 0.937
Validation loss decreased (-0.914808 --> -0.937031).  Saving model ...
Epoch: 16 cost time: 0.7276628017425537
Epoch: 16, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.505 Vali Acc: 0.937 Test Loss: 0.505 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 17 cost time: 0.7345671653747559
Epoch: 17, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6740703582763672
Epoch: 18, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.418 Vali Acc: 0.911 Test Loss: 0.418 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6787889003753662
Epoch: 19, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.360 Vali Acc: 0.963 Test Loss: 0.360 Test Acc: 0.963
Validation loss decreased (-0.937032 --> -0.962959).  Saving model ...
Epoch: 20 cost time: 0.6952159404754639
Epoch: 20, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.318 Vali Acc: 0.963 Test Loss: 0.318 Test Acc: 0.963
Validation loss decreased (-0.962959 --> -0.962960).  Saving model ...
Epoch: 21 cost time: 0.662372350692749
Epoch: 21, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.285 Vali Acc: 0.952 Test Loss: 0.285 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7091081142425537
Epoch: 22, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.270 Vali Acc: 0.926 Test Loss: 0.270 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5818603038787842
Epoch: 23, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5867159366607666
Epoch: 24, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6997780799865723
Epoch: 25, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6189088821411133
Epoch: 26, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7347066402435303
Epoch: 27, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7529375553131104
Epoch: 28, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6107180118560791
Epoch: 29, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7807979583740234
Epoch: 30, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 3619102
model size : 18.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3841421604156494
Epoch: 1, Steps: 2 | Train Loss: 1.910 Vali Loss: 1.820 Vali Acc: 0.170 Test Loss: 1.820 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.7256982326507568
Epoch: 2, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.747 Vali Acc: 0.207 Test Loss: 1.747 Test Acc: 0.207
Validation loss decreased (-0.170352 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.649254560470581
Epoch: 3, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.689 Vali Acc: 0.274 Test Loss: 1.689 Test Acc: 0.274
Validation loss decreased (-0.207390 --> -0.274057).  Saving model ...
Epoch: 4 cost time: 0.6299734115600586
Epoch: 4, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.620 Vali Acc: 0.493 Test Loss: 1.620 Test Acc: 0.493
Validation loss decreased (-0.274057 --> -0.492576).  Saving model ...
Epoch: 5 cost time: 0.5598042011260986
Epoch: 5, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.546 Vali Acc: 0.444 Test Loss: 1.546 Test Acc: 0.444
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.6362385749816895
Epoch: 6, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.455 Vali Acc: 0.463 Test Loss: 1.455 Test Acc: 0.463
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.6755163669586182
Epoch: 7, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.346 Vali Acc: 0.548 Test Loss: 1.346 Test Acc: 0.548
Validation loss decreased (-0.492576 --> -0.548135).  Saving model ...
Epoch: 8 cost time: 0.7768280506134033
Epoch: 8, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.223 Vali Acc: 0.696 Test Loss: 1.223 Test Acc: 0.696
Validation loss decreased (-0.548135 --> -0.696284).  Saving model ...
Epoch: 9 cost time: 0.5955877304077148
Epoch: 9, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.105 Vali Acc: 0.848 Test Loss: 1.105 Test Acc: 0.848
Validation loss decreased (-0.696284 --> -0.848137).  Saving model ...
Epoch: 10 cost time: 0.7015743255615234
Epoch: 10, Steps: 2 | Train Loss: 1.041 Vali Loss: 0.998 Vali Acc: 0.852 Test Loss: 0.998 Test Acc: 0.852
Validation loss decreased (-0.848137 --> -0.851842).  Saving model ...
Epoch: 11 cost time: 0.6047945022583008
Epoch: 11, Steps: 2 | Train Loss: 0.881 Vali Loss: 0.898 Vali Acc: 0.863 Test Loss: 0.898 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862954).  Saving model ...
Epoch: 12 cost time: 0.6900937557220459
Epoch: 12, Steps: 2 | Train Loss: 0.796 Vali Loss: 0.807 Vali Acc: 0.856 Test Loss: 0.807 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7021801471710205
Epoch: 13, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.723 Vali Acc: 0.907 Test Loss: 0.723 Test Acc: 0.907
Validation loss decreased (-0.862954 --> -0.907400).  Saving model ...
Epoch: 14 cost time: 0.7506299018859863
Epoch: 14, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.648 Vali Acc: 0.933 Test Loss: 0.648 Test Acc: 0.933
Validation loss decreased (-0.907400 --> -0.933327).  Saving model ...
Epoch: 15 cost time: 0.65413498878479
Epoch: 15, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.589 Vali Acc: 0.933 Test Loss: 0.589 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933327).  Saving model ...
Epoch: 16 cost time: 0.6087610721588135
Epoch: 16, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.528 Vali Acc: 0.937 Test Loss: 0.528 Test Acc: 0.937
Validation loss decreased (-0.933327 --> -0.937032).  Saving model ...
Epoch: 17 cost time: 0.5802018642425537
Epoch: 17, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.467 Vali Acc: 0.941 Test Loss: 0.467 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 18 cost time: 0.5689163208007812
Epoch: 18, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.417 Vali Acc: 0.944 Test Loss: 0.417 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 19 cost time: 0.7673494815826416
Epoch: 19, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.377 Vali Acc: 0.933 Test Loss: 0.377 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7462217807769775
Epoch: 20, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.342 Vali Acc: 0.922 Test Loss: 0.342 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6899561882019043
Epoch: 21, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.304 Vali Acc: 0.937 Test Loss: 0.304 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7399981021881104
Epoch: 22, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8876419067382812
Epoch: 23, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7264645099639893
Epoch: 24, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
Validation loss decreased (-0.944440 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.8991920948028564
Epoch: 25, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7030467987060547
Epoch: 26, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7493553161621094
Epoch: 27, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6471185684204102
Epoch: 28, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7946634292602539
Epoch: 29, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.728877067565918
Epoch: 30, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6267404556274414
Epoch: 31, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7095692157745361
Epoch: 32, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.9429984092712402
Epoch: 33, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7857418060302734
Epoch: 34, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 3617566
model size : 18.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.628811836242676
Epoch: 1, Steps: 2 | Train Loss: 2.036 Vali Loss: 1.936 Vali Acc: 0.163 Test Loss: 1.936 Test Acc: 0.163
Validation loss decreased (inf --> -0.162944).  Saving model ...
Epoch: 2 cost time: 0.583143949508667
Epoch: 2, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.859 Vali Acc: 0.152 Test Loss: 1.859 Test Acc: 0.152
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5804884433746338
Epoch: 3, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.780 Vali Acc: 0.200 Test Loss: 1.780 Test Acc: 0.200
Validation loss decreased (-0.162944 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.7165577411651611
Epoch: 4, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.679 Vali Acc: 0.322 Test Loss: 1.679 Test Acc: 0.322
Validation loss decreased (-0.199982 --> -0.322205).  Saving model ...
Epoch: 5 cost time: 0.5993475914001465
Epoch: 5, Steps: 2 | Train Loss: 1.672 Vali Loss: 1.587 Vali Acc: 0.444 Test Loss: 1.587 Test Acc: 0.444
Validation loss decreased (-0.322205 --> -0.444429).  Saving model ...
Epoch: 6 cost time: 0.6798794269561768
Epoch: 6, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.513 Vali Acc: 0.322 Test Loss: 1.513 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5892927646636963
Epoch: 7, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.415 Vali Acc: 0.367 Test Loss: 1.415 Test Acc: 0.367
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8516266345977783
Epoch: 8, Steps: 2 | Train Loss: 1.298 Vali Loss: 1.283 Vali Acc: 0.585 Test Loss: 1.283 Test Acc: 0.585
Validation loss decreased (-0.444429 --> -0.585172).  Saving model ...
Epoch: 9 cost time: 0.7404444217681885
Epoch: 9, Steps: 2 | Train Loss: 1.110 Vali Loss: 1.137 Vali Acc: 0.833 Test Loss: 1.137 Test Acc: 0.833
Validation loss decreased (-0.585172 --> -0.833322).  Saving model ...
Epoch: 10 cost time: 0.6272013187408447
Epoch: 10, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.021 Vali Acc: 0.870 Test Loss: 1.021 Test Acc: 0.870
Validation loss decreased (-0.833322 --> -0.870360).  Saving model ...
Epoch: 11 cost time: 0.6601715087890625
Epoch: 11, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.918 Vali Acc: 0.885 Test Loss: 0.918 Test Acc: 0.885
Validation loss decreased (-0.870360 --> -0.885176).  Saving model ...
Epoch: 12 cost time: 0.7918670177459717
Epoch: 12, Steps: 2 | Train Loss: 0.804 Vali Loss: 0.814 Vali Acc: 0.926 Test Loss: 0.814 Test Acc: 0.926
Validation loss decreased (-0.885176 --> -0.925918).  Saving model ...
Epoch: 13 cost time: 0.6002190113067627
Epoch: 13, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.722 Vali Acc: 0.944 Test Loss: 0.722 Test Acc: 0.944
Validation loss decreased (-0.925918 --> -0.944437).  Saving model ...
Epoch: 14 cost time: 0.6534078121185303
Epoch: 14, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.652 Vali Acc: 0.922 Test Loss: 0.652 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6474778652191162
Epoch: 15, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.586 Vali Acc: 0.922 Test Loss: 0.586 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5806427001953125
Epoch: 16, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.520 Vali Acc: 0.926 Test Loss: 0.520 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5980403423309326
Epoch: 17, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.466 Vali Acc: 0.919 Test Loss: 0.466 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.5422313213348389
Epoch: 18, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.417 Vali Acc: 0.922 Test Loss: 0.417 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.5983254909515381
Epoch: 19, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.361 Vali Acc: 0.948 Test Loss: 0.361 Test Acc: 0.948
Validation loss decreased (-0.944437 --> -0.948145).  Saving model ...
Epoch: 20 cost time: 0.5659811496734619
Epoch: 20, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.319 Vali Acc: 0.956 Test Loss: 0.319 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955552).  Saving model ...
Epoch: 21 cost time: 0.6795215606689453
Epoch: 21, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.288 Vali Acc: 0.956 Test Loss: 0.288 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 22 cost time: 0.7757112979888916
Epoch: 22, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6101119518280029
Epoch: 23, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7910811901092529
Epoch: 24, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8866801261901855
Epoch: 25, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7598841190338135
Epoch: 26, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5721433162689209
Epoch: 27, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6376395225524902
Epoch: 28, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6784117221832275
Epoch: 29, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6585462093353271
Epoch: 30, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.6841230392456055
Epoch: 31, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 3616030
model size : 18.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.872957944869995
Epoch: 1, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.695 Vali Acc: 0.333 Test Loss: 1.695 Test Acc: 0.333
Validation loss decreased (inf --> -0.333316).  Saving model ...
Epoch: 2 cost time: 0.7707204818725586
Epoch: 2, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.629 Vali Acc: 0.378 Test Loss: 1.629 Test Acc: 0.378
Validation loss decreased (-0.333316 --> -0.377761).  Saving model ...
Epoch: 3 cost time: 0.6335775852203369
Epoch: 3, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.575 Vali Acc: 0.481 Test Loss: 1.575 Test Acc: 0.481
Validation loss decreased (-0.377761 --> -0.481466).  Saving model ...
Epoch: 4 cost time: 0.5906555652618408
Epoch: 4, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.504 Vali Acc: 0.652 Test Loss: 1.504 Test Acc: 0.652
Validation loss decreased (-0.481466 --> -0.651837).  Saving model ...
Epoch: 5 cost time: 0.7093334197998047
Epoch: 5, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.423 Vali Acc: 0.678 Test Loss: 1.423 Test Acc: 0.678
Validation loss decreased (-0.651837 --> -0.677764).  Saving model ...
Epoch: 6 cost time: 0.6135530471801758
Epoch: 6, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.333 Vali Acc: 0.685 Test Loss: 1.333 Test Acc: 0.685
Validation loss decreased (-0.677764 --> -0.685172).  Saving model ...
Epoch: 7 cost time: 0.7632081508636475
Epoch: 7, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.237 Vali Acc: 0.756 Test Loss: 1.237 Test Acc: 0.756
Validation loss decreased (-0.685172 --> -0.755543).  Saving model ...
Epoch: 8 cost time: 0.656940221786499
Epoch: 8, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.132 Vali Acc: 0.878 Test Loss: 1.132 Test Acc: 0.878
Validation loss decreased (-0.755543 --> -0.877766).  Saving model ...
Epoch: 9 cost time: 0.6418118476867676
Epoch: 9, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.032 Vali Acc: 0.885 Test Loss: 1.032 Test Acc: 0.885
Validation loss decreased (-0.877766 --> -0.885175).  Saving model ...
Epoch: 10 cost time: 0.6930067539215088
Epoch: 10, Steps: 2 | Train Loss: 0.919 Vali Loss: 0.937 Vali Acc: 0.885 Test Loss: 0.937 Test Acc: 0.885
Validation loss decreased (-0.885175 --> -0.885176).  Saving model ...
Epoch: 11 cost time: 0.6520512104034424
Epoch: 11, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.848 Vali Acc: 0.904 Test Loss: 0.848 Test Acc: 0.904
Validation loss decreased (-0.885176 --> -0.903695).  Saving model ...
Epoch: 12 cost time: 0.6084654331207275
Epoch: 12, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.768 Vali Acc: 0.896 Test Loss: 0.768 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6644182205200195
Epoch: 13, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.691 Vali Acc: 0.893 Test Loss: 0.691 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6014189720153809
Epoch: 14, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.614 Vali Acc: 0.922 Test Loss: 0.614 Test Acc: 0.922
Validation loss decreased (-0.903695 --> -0.922216).  Saving model ...
Epoch: 15 cost time: 0.6584386825561523
Epoch: 15, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.554 Vali Acc: 0.926 Test Loss: 0.554 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 16 cost time: 0.6251344680786133
Epoch: 16, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.503 Vali Acc: 0.919 Test Loss: 0.503 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8367564678192139
Epoch: 17, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.447 Vali Acc: 0.937 Test Loss: 0.447 Test Acc: 0.937
Validation loss decreased (-0.925920 --> -0.937033).  Saving model ...
Epoch: 18 cost time: 0.8508105278015137
Epoch: 18, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.401 Vali Acc: 0.933 Test Loss: 0.401 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8123726844787598
Epoch: 19, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.369 Vali Acc: 0.941 Test Loss: 0.369 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 20 cost time: 0.6990501880645752
Epoch: 20, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.338 Vali Acc: 0.937 Test Loss: 0.338 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8172869682312012
Epoch: 21, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.294 Vali Acc: 0.948 Test Loss: 0.294 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 22 cost time: 0.7481732368469238
Epoch: 22, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6249809265136719
Epoch: 23, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6704487800598145
Epoch: 24, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7563230991363525
Epoch: 25, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6925737857818604
Epoch: 26, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.198 Vali Acc: 0.952 Test Loss: 0.198 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.6157636642456055
Epoch: 27, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5933935642242432
Epoch: 28, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7332284450531006
Epoch: 29, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7046735286712646
Epoch: 30, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.919 Test Loss: 0.222 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5840952396392822
Epoch: 31, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7547357082366943
Epoch: 32, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6073834896087646
Epoch: 33, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6739256381988525
Epoch: 34, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8323624134063721
Epoch: 35, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6356902122497559
Epoch: 36, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 3423646
model size : 18.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.086839437484741
Epoch: 1, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.889 Vali Acc: 0.085 Test Loss: 1.889 Test Acc: 0.085
Validation loss decreased (inf --> -0.085166).  Saving model ...
Epoch: 2 cost time: 0.6075761318206787
Epoch: 2, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.833 Vali Acc: 0.156 Test Loss: 1.833 Test Acc: 0.156
Validation loss decreased (-0.085166 --> -0.155537).  Saving model ...
Epoch: 3 cost time: 0.5161068439483643
Epoch: 3, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.777 Vali Acc: 0.226 Test Loss: 1.777 Test Acc: 0.226
Validation loss decreased (-0.155537 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.5560920238494873
Epoch: 4, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.703 Vali Acc: 0.256 Test Loss: 1.703 Test Acc: 0.256
Validation loss decreased (-0.225908 --> -0.255539).  Saving model ...
Epoch: 5 cost time: 0.6822521686553955
Epoch: 5, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.622 Vali Acc: 0.381 Test Loss: 1.622 Test Acc: 0.381
Validation loss decreased (-0.255539 --> -0.381465).  Saving model ...
Epoch: 6 cost time: 0.568979024887085
Epoch: 6, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.530 Vali Acc: 0.504 Test Loss: 1.530 Test Acc: 0.504
Validation loss decreased (-0.381465 --> -0.503688).  Saving model ...
Epoch: 7 cost time: 0.6655144691467285
Epoch: 7, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.421 Vali Acc: 0.626 Test Loss: 1.421 Test Acc: 0.626
Validation loss decreased (-0.503688 --> -0.625912).  Saving model ...
Epoch: 8 cost time: 0.6509456634521484
Epoch: 8, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.299 Vali Acc: 0.744 Test Loss: 1.299 Test Acc: 0.744
Validation loss decreased (-0.625912 --> -0.744431).  Saving model ...
Epoch: 9 cost time: 0.533776044845581
Epoch: 9, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.184 Vali Acc: 0.819 Test Loss: 1.184 Test Acc: 0.819
Validation loss decreased (-0.744431 --> -0.818507).  Saving model ...
Epoch: 10 cost time: 0.6126358509063721
Epoch: 10, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.079 Vali Acc: 0.819 Test Loss: 1.079 Test Acc: 0.819
Validation loss decreased (-0.818507 --> -0.818508).  Saving model ...
Epoch: 11 cost time: 0.6416363716125488
Epoch: 11, Steps: 2 | Train Loss: 0.947 Vali Loss: 0.979 Vali Acc: 0.822 Test Loss: 0.979 Test Acc: 0.822
Validation loss decreased (-0.818508 --> -0.822212).  Saving model ...
Epoch: 12 cost time: 0.5426015853881836
Epoch: 12, Steps: 2 | Train Loss: 0.890 Vali Loss: 0.887 Vali Acc: 0.841 Test Loss: 0.887 Test Acc: 0.841
Validation loss decreased (-0.822212 --> -0.840732).  Saving model ...
Epoch: 13 cost time: 0.5822081565856934
Epoch: 13, Steps: 2 | Train Loss: 0.785 Vali Loss: 0.791 Vali Acc: 0.911 Test Loss: 0.791 Test Acc: 0.911
Validation loss decreased (-0.840732 --> -0.911103).  Saving model ...
Epoch: 14 cost time: 0.5727269649505615
Epoch: 14, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.704 Vali Acc: 0.944 Test Loss: 0.704 Test Acc: 0.944
Validation loss decreased (-0.911103 --> -0.944437).  Saving model ...
Epoch: 15 cost time: 0.6598315238952637
Epoch: 15, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.630 Vali Acc: 0.937 Test Loss: 0.630 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5444009304046631
Epoch: 16, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.567 Vali Acc: 0.937 Test Loss: 0.567 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6220650672912598
Epoch: 17, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.509 Vali Acc: 0.948 Test Loss: 0.509 Test Acc: 0.948
Validation loss decreased (-0.944437 --> -0.948143).  Saving model ...
Epoch: 18 cost time: 0.5592434406280518
Epoch: 18, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.456 Vali Acc: 0.948 Test Loss: 0.456 Test Acc: 0.948
Validation loss decreased (-0.948143 --> -0.948144).  Saving model ...
Epoch: 19 cost time: 0.5782260894775391
Epoch: 19, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.412 Vali Acc: 0.941 Test Loss: 0.412 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6046082973480225
Epoch: 20, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.380 Vali Acc: 0.937 Test Loss: 0.380 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5761759281158447
Epoch: 21, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.356 Vali Acc: 0.930 Test Loss: 0.356 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5303177833557129
Epoch: 22, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.322 Vali Acc: 0.933 Test Loss: 0.322 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5587868690490723
Epoch: 23, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6229610443115234
Epoch: 24, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7147507667541504
Epoch: 25, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.577430009841919
Epoch: 26, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6525063514709473
Epoch: 27, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6118378639221191
Epoch: 28, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 3422110
model size : 18.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9596936702728271
Epoch: 1, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.867 Vali Acc: 0.041 Test Loss: 1.867 Test Acc: 0.041
Validation loss decreased (inf --> -0.040722).  Saving model ...
Epoch: 2 cost time: 0.6070094108581543
Epoch: 2, Steps: 2 | Train Loss: 1.859 Vali Loss: 1.820 Vali Acc: 0.085 Test Loss: 1.820 Test Acc: 0.085
Validation loss decreased (-0.040722 --> -0.085167).  Saving model ...
Epoch: 3 cost time: 0.6165056228637695
Epoch: 3, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.771 Vali Acc: 0.156 Test Loss: 1.771 Test Acc: 0.156
Validation loss decreased (-0.085167 --> -0.155538).  Saving model ...
Epoch: 4 cost time: 0.6440291404724121
Epoch: 4, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.699 Vali Acc: 0.307 Test Loss: 1.699 Test Acc: 0.307
Validation loss decreased (-0.155538 --> -0.307390).  Saving model ...
Epoch: 5 cost time: 0.63863205909729
Epoch: 5, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.607 Vali Acc: 0.485 Test Loss: 1.607 Test Acc: 0.485
Validation loss decreased (-0.307390 --> -0.485169).  Saving model ...
Epoch: 6 cost time: 0.9350669384002686
Epoch: 6, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.501 Vali Acc: 0.648 Test Loss: 1.501 Test Acc: 0.648
Validation loss decreased (-0.485169 --> -0.648133).  Saving model ...
Epoch: 7 cost time: 0.7575435638427734
Epoch: 7, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.385 Vali Acc: 0.715 Test Loss: 1.385 Test Acc: 0.715
Validation loss decreased (-0.648133 --> -0.714801).  Saving model ...
Epoch: 8 cost time: 0.7114613056182861
Epoch: 8, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.271 Vali Acc: 0.756 Test Loss: 1.271 Test Acc: 0.756
Validation loss decreased (-0.714801 --> -0.755543).  Saving model ...
Epoch: 9 cost time: 0.5585875511169434
Epoch: 9, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.157 Vali Acc: 0.811 Test Loss: 1.157 Test Acc: 0.811
Validation loss decreased (-0.755543 --> -0.811100).  Saving model ...
Epoch: 10 cost time: 0.6474056243896484
Epoch: 10, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.050 Vali Acc: 0.859 Test Loss: 1.050 Test Acc: 0.859
Validation loss decreased (-0.811100 --> -0.859249).  Saving model ...
Epoch: 11 cost time: 0.8025772571563721
Epoch: 11, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.953 Vali Acc: 0.889 Test Loss: 0.953 Test Acc: 0.889
Validation loss decreased (-0.859249 --> -0.888879).  Saving model ...
Epoch: 12 cost time: 0.7786638736724854
Epoch: 12, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.859 Vali Acc: 0.900 Test Loss: 0.859 Test Acc: 0.900
Validation loss decreased (-0.888879 --> -0.899991).  Saving model ...
Epoch: 13 cost time: 0.7113635540008545
Epoch: 13, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.769 Vali Acc: 0.922 Test Loss: 0.769 Test Acc: 0.922
Validation loss decreased (-0.899991 --> -0.922215).  Saving model ...
Epoch: 14 cost time: 0.7359542846679688
Epoch: 14, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.684 Vali Acc: 0.948 Test Loss: 0.684 Test Acc: 0.948
Validation loss decreased (-0.922215 --> -0.948141).  Saving model ...
Epoch: 15 cost time: 0.7336480617523193
Epoch: 15, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.608 Vali Acc: 0.937 Test Loss: 0.608 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5961053371429443
Epoch: 16, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.554 Vali Acc: 0.900 Test Loss: 0.554 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6351563930511475
Epoch: 17, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.492 Vali Acc: 0.930 Test Loss: 0.492 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6805617809295654
Epoch: 18, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.436 Vali Acc: 0.944 Test Loss: 0.436 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7498502731323242
Epoch: 19, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.390 Vali Acc: 0.959 Test Loss: 0.390 Test Acc: 0.959
Validation loss decreased (-0.948141 --> -0.959255).  Saving model ...
Epoch: 20 cost time: 0.6984682083129883
Epoch: 20, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.350 Vali Acc: 0.956 Test Loss: 0.350 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6519873142242432
Epoch: 21, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.321 Vali Acc: 0.933 Test Loss: 0.321 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7670838832855225
Epoch: 22, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.312 Vali Acc: 0.919 Test Loss: 0.312 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8331847190856934
Epoch: 23, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7339398860931396
Epoch: 24, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8028359413146973
Epoch: 25, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.221 Vali Acc: 0.959 Test Loss: 0.221 Test Acc: 0.959
Validation loss decreased (-0.959255 --> -0.959257).  Saving model ...
Epoch: 26 cost time: 0.7335033416748047
Epoch: 26, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6239991188049316
Epoch: 27, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6853475570678711
Epoch: 28, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6015849113464355
Epoch: 29, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6267309188842773
Epoch: 30, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7056772708892822
Epoch: 31, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5823135375976562
Epoch: 32, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.7427389621734619
Epoch: 33, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6227278709411621
Epoch: 34, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7311367988586426
Epoch: 35, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 3420574
model size : 18.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0119035243988037
Epoch: 1, Steps: 2 | Train Loss: 1.991 Vali Loss: 1.863 Vali Acc: 0.219 Test Loss: 1.863 Test Acc: 0.219
Validation loss decreased (inf --> -0.218500).  Saving model ...
Epoch: 2 cost time: 0.6814076900482178
Epoch: 2, Steps: 2 | Train Loss: 1.822 Vali Loss: 1.807 Vali Acc: 0.222 Test Loss: 1.807 Test Acc: 0.222
Validation loss decreased (-0.218500 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 0.6533842086791992
Epoch: 3, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.755 Vali Acc: 0.267 Test Loss: 1.755 Test Acc: 0.267
Validation loss decreased (-0.222204 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.6923742294311523
Epoch: 4, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.684 Vali Acc: 0.330 Test Loss: 1.684 Test Acc: 0.330
Validation loss decreased (-0.266649 --> -0.329613).  Saving model ...
Epoch: 5 cost time: 0.7150695323944092
Epoch: 5, Steps: 2 | Train Loss: 1.669 Vali Loss: 1.597 Vali Acc: 0.433 Test Loss: 1.597 Test Acc: 0.433
Validation loss decreased (-0.329613 --> -0.433317).  Saving model ...
Epoch: 6 cost time: 0.7523281574249268
Epoch: 6, Steps: 2 | Train Loss: 1.568 Vali Loss: 1.497 Vali Acc: 0.593 Test Loss: 1.497 Test Acc: 0.593
Validation loss decreased (-0.433317 --> -0.592578).  Saving model ...
Epoch: 7 cost time: 0.675346851348877
Epoch: 7, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.385 Vali Acc: 0.663 Test Loss: 1.385 Test Acc: 0.663
Validation loss decreased (-0.592578 --> -0.662949).  Saving model ...
Epoch: 8 cost time: 0.5764648914337158
Epoch: 8, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.270 Vali Acc: 0.711 Test Loss: 1.270 Test Acc: 0.711
Validation loss decreased (-0.662949 --> -0.711098).  Saving model ...
Epoch: 9 cost time: 0.7026798725128174
Epoch: 9, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.155 Vali Acc: 0.796 Test Loss: 1.155 Test Acc: 0.796
Validation loss decreased (-0.711098 --> -0.796285).  Saving model ...
Epoch: 10 cost time: 0.7090177536010742
Epoch: 10, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.044 Vali Acc: 0.819 Test Loss: 1.044 Test Acc: 0.819
Validation loss decreased (-0.796285 --> -0.818508).  Saving model ...
Epoch: 11 cost time: 0.6998255252838135
Epoch: 11, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.943 Vali Acc: 0.815 Test Loss: 0.943 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8151745796203613
Epoch: 12, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.853 Vali Acc: 0.841 Test Loss: 0.853 Test Acc: 0.841
Validation loss decreased (-0.818508 --> -0.840732).  Saving model ...
Epoch: 13 cost time: 0.7266561985015869
Epoch: 13, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.769 Vali Acc: 0.863 Test Loss: 0.769 Test Acc: 0.863
Validation loss decreased (-0.840732 --> -0.862955).  Saving model ...
Epoch: 14 cost time: 0.6622166633605957
Epoch: 14, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.693 Vali Acc: 0.863 Test Loss: 0.693 Test Acc: 0.863
Validation loss decreased (-0.862955 --> -0.862956).  Saving model ...
Epoch: 15 cost time: 0.8146965503692627
Epoch: 15, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.617 Vali Acc: 0.907 Test Loss: 0.617 Test Acc: 0.907
Validation loss decreased (-0.862956 --> -0.907401).  Saving model ...
Epoch: 16 cost time: 0.650841474533081
Epoch: 16, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.547 Vali Acc: 0.919 Test Loss: 0.547 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 17 cost time: 0.8261682987213135
Epoch: 17, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.487 Vali Acc: 0.922 Test Loss: 0.487 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 18 cost time: 0.7496740818023682
Epoch: 18, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.431 Vali Acc: 0.941 Test Loss: 0.431 Test Acc: 0.941
Validation loss decreased (-0.922217 --> -0.940736).  Saving model ...
Epoch: 19 cost time: 0.9001412391662598
Epoch: 19, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.390 Vali Acc: 0.930 Test Loss: 0.390 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6390411853790283
Epoch: 20, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.368 Vali Acc: 0.930 Test Loss: 0.368 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7848167419433594
Epoch: 21, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6500329971313477
Epoch: 22, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.318 Vali Acc: 0.904 Test Loss: 0.318 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7182128429412842
Epoch: 23, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8276243209838867
Epoch: 24, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940738).  Saving model ...
Epoch: 25 cost time: 0.8087825775146484
Epoch: 25, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.228 Vali Acc: 0.952 Test Loss: 0.228 Test Acc: 0.952
Validation loss decreased (-0.940738 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.7204205989837646
Epoch: 26, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6374092102050781
Epoch: 27, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6279375553131104
Epoch: 28, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8421509265899658
Epoch: 29, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.247 Vali Acc: 0.904 Test Loss: 0.247 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7497529983520508
Epoch: 30, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.232 Vali Acc: 0.915 Test Loss: 0.232 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7022140026092529
Epoch: 31, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.0350162982940674
Epoch: 32, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6861684322357178
Epoch: 33, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6503963470458984
Epoch: 34, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.690349817276001
Epoch: 35, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 3419038
model size : 17.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1537227630615234
Epoch: 1, Steps: 2 | Train Loss: 1.966 Vali Loss: 1.889 Vali Acc: 0.111 Test Loss: 1.889 Test Acc: 0.111
Validation loss decreased (inf --> -0.111092).  Saving model ...
Epoch: 2 cost time: 0.6620774269104004
Epoch: 2, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.848 Vali Acc: 0.137 Test Loss: 1.848 Test Acc: 0.137
Validation loss decreased (-0.111092 --> -0.137019).  Saving model ...
Epoch: 3 cost time: 0.6754148006439209
Epoch: 3, Steps: 2 | Train Loss: 1.912 Vali Loss: 1.812 Vali Acc: 0.185 Test Loss: 1.812 Test Acc: 0.185
Validation loss decreased (-0.137019 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 0.6321642398834229
Epoch: 4, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.765 Vali Acc: 0.215 Test Loss: 1.765 Test Acc: 0.215
Validation loss decreased (-0.185167 --> -0.214797).  Saving model ...
Epoch: 5 cost time: 0.5075747966766357
Epoch: 5, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.711 Vali Acc: 0.289 Test Loss: 1.711 Test Acc: 0.289
Validation loss decreased (-0.214797 --> -0.288872).  Saving model ...
Epoch: 6 cost time: 0.540870189666748
Epoch: 6, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.650 Vali Acc: 0.356 Test Loss: 1.650 Test Acc: 0.356
Validation loss decreased (-0.288872 --> -0.355539).  Saving model ...
Epoch: 7 cost time: 0.5135464668273926
Epoch: 7, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.582 Vali Acc: 0.426 Test Loss: 1.582 Test Acc: 0.426
Validation loss decreased (-0.355539 --> -0.425910).  Saving model ...
Epoch: 8 cost time: 0.6928384304046631
Epoch: 8, Steps: 2 | Train Loss: 1.602 Vali Loss: 1.509 Vali Acc: 0.463 Test Loss: 1.509 Test Acc: 0.463
Validation loss decreased (-0.425910 --> -0.462948).  Saving model ...
Epoch: 9 cost time: 0.7748508453369141
Epoch: 9, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.429 Vali Acc: 0.600 Test Loss: 1.429 Test Acc: 0.600
Validation loss decreased (-0.462948 --> -0.599986).  Saving model ...
Epoch: 10 cost time: 0.5442187786102295
Epoch: 10, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.344 Vali Acc: 0.744 Test Loss: 1.344 Test Acc: 0.744
Validation loss decreased (-0.599986 --> -0.744431).  Saving model ...
Epoch: 11 cost time: 0.7706053256988525
Epoch: 11, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.260 Vali Acc: 0.778 Test Loss: 1.260 Test Acc: 0.778
Validation loss decreased (-0.744431 --> -0.777765).  Saving model ...
Epoch: 12 cost time: 0.6221857070922852
Epoch: 12, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.174 Vali Acc: 0.837 Test Loss: 1.174 Test Acc: 0.837
Validation loss decreased (-0.777765 --> -0.837025).  Saving model ...
Epoch: 13 cost time: 0.6154341697692871
Epoch: 13, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.090 Vali Acc: 0.863 Test Loss: 1.090 Test Acc: 0.863
Validation loss decreased (-0.837025 --> -0.862952).  Saving model ...
Epoch: 14 cost time: 0.7527282238006592
Epoch: 14, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.006 Vali Acc: 0.881 Test Loss: 1.006 Test Acc: 0.881
Validation loss decreased (-0.862952 --> -0.881471).  Saving model ...
Epoch: 15 cost time: 0.5429790019989014
Epoch: 15, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.923 Vali Acc: 0.904 Test Loss: 0.923 Test Acc: 0.904
Validation loss decreased (-0.881471 --> -0.903694).  Saving model ...
Epoch: 16 cost time: 0.5447471141815186
Epoch: 16, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.840 Vali Acc: 0.922 Test Loss: 0.840 Test Acc: 0.922
Validation loss decreased (-0.903694 --> -0.922214).  Saving model ...
Epoch: 17 cost time: 0.5994102954864502
Epoch: 17, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.764 Vali Acc: 0.926 Test Loss: 0.764 Test Acc: 0.926
Validation loss decreased (-0.922214 --> -0.925918).  Saving model ...
Epoch: 18 cost time: 0.5415730476379395
Epoch: 18, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.694 Vali Acc: 0.919 Test Loss: 0.694 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5720341205596924
Epoch: 19, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.627 Vali Acc: 0.933 Test Loss: 0.627 Test Acc: 0.933
Validation loss decreased (-0.925918 --> -0.933327).  Saving model ...
Epoch: 20 cost time: 0.5344204902648926
Epoch: 20, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.568 Vali Acc: 0.959 Test Loss: 0.568 Test Acc: 0.959
Validation loss decreased (-0.933327 --> -0.959254).  Saving model ...
Epoch: 21 cost time: 0.5157549381256104
Epoch: 21, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.514 Vali Acc: 0.956 Test Loss: 0.514 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6599709987640381
Epoch: 22, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.468 Vali Acc: 0.937 Test Loss: 0.468 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7770912647247314
Epoch: 23, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.428 Vali Acc: 0.933 Test Loss: 0.428 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7373611927032471
Epoch: 24, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.388 Vali Acc: 0.944 Test Loss: 0.388 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6261651515960693
Epoch: 25, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.357 Vali Acc: 0.941 Test Loss: 0.357 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.613816499710083
Epoch: 26, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.323 Vali Acc: 0.952 Test Loss: 0.323 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5401558876037598
Epoch: 27, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.297 Vali Acc: 0.952 Test Loss: 0.297 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5253901481628418
Epoch: 28, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.275 Vali Acc: 0.952 Test Loss: 0.275 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6481974124908447
Epoch: 29, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.260 Vali Acc: 0.941 Test Loss: 0.260 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5885300636291504
Epoch: 30, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 1616414
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0695910453796387
Epoch: 1, Steps: 2 | Train Loss: 1.978 Vali Loss: 1.891 Vali Acc: 0.081 Test Loss: 1.891 Test Acc: 0.081
Validation loss decreased (inf --> -0.081463).  Saving model ...
Epoch: 2 cost time: 0.608553409576416
Epoch: 2, Steps: 2 | Train Loss: 1.937 Vali Loss: 1.847 Vali Acc: 0.085 Test Loss: 1.847 Test Acc: 0.085
Validation loss decreased (-0.081463 --> -0.085167).  Saving model ...
Epoch: 3 cost time: 0.6012423038482666
Epoch: 3, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.808 Vali Acc: 0.089 Test Loss: 1.808 Test Acc: 0.089
Validation loss decreased (-0.085167 --> -0.088871).  Saving model ...
Epoch: 4 cost time: 0.6920957565307617
Epoch: 4, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.763 Vali Acc: 0.137 Test Loss: 1.763 Test Acc: 0.137
Validation loss decreased (-0.088871 --> -0.137019).  Saving model ...
Epoch: 5 cost time: 0.6061725616455078
Epoch: 5, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.713 Vali Acc: 0.196 Test Loss: 1.713 Test Acc: 0.196
Validation loss decreased (-0.137019 --> -0.196279).  Saving model ...
Epoch: 6 cost time: 0.7025554180145264
Epoch: 6, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.656 Vali Acc: 0.259 Test Loss: 1.656 Test Acc: 0.259
Validation loss decreased (-0.196279 --> -0.259243).  Saving model ...
Epoch: 7 cost time: 0.6317102909088135
Epoch: 7, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.594 Vali Acc: 0.385 Test Loss: 1.594 Test Acc: 0.385
Validation loss decreased (-0.259243 --> -0.385169).  Saving model ...
Epoch: 8 cost time: 0.5922961235046387
Epoch: 8, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.524 Vali Acc: 0.493 Test Loss: 1.524 Test Acc: 0.493
Validation loss decreased (-0.385169 --> -0.492577).  Saving model ...
Epoch: 9 cost time: 0.6501696109771729
Epoch: 9, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.445 Vali Acc: 0.607 Test Loss: 1.445 Test Acc: 0.607
Validation loss decreased (-0.492577 --> -0.607393).  Saving model ...
Epoch: 10 cost time: 0.699129581451416
Epoch: 10, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.359 Vali Acc: 0.719 Test Loss: 1.359 Test Acc: 0.719
Validation loss decreased (-0.607393 --> -0.718505).  Saving model ...
Epoch: 11 cost time: 0.7086179256439209
Epoch: 11, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.272 Vali Acc: 0.767 Test Loss: 1.272 Test Acc: 0.767
Validation loss decreased (-0.718505 --> -0.766654).  Saving model ...
Epoch: 12 cost time: 0.6028282642364502
Epoch: 12, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.186 Vali Acc: 0.781 Test Loss: 1.186 Test Acc: 0.781
Validation loss decreased (-0.766654 --> -0.781470).  Saving model ...
Epoch: 13 cost time: 0.6514542102813721
Epoch: 13, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.100 Vali Acc: 0.804 Test Loss: 1.100 Test Acc: 0.804
Validation loss decreased (-0.781470 --> -0.803693).  Saving model ...
Epoch: 14 cost time: 0.5943524837493896
Epoch: 14, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.017 Vali Acc: 0.837 Test Loss: 1.017 Test Acc: 0.837
Validation loss decreased (-0.803693 --> -0.837027).  Saving model ...
Epoch: 15 cost time: 0.5610852241516113
Epoch: 15, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.936 Vali Acc: 0.878 Test Loss: 0.936 Test Acc: 0.878
Validation loss decreased (-0.837027 --> -0.877768).  Saving model ...
Epoch: 16 cost time: 0.6304748058319092
Epoch: 16, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.859 Vali Acc: 0.878 Test Loss: 0.859 Test Acc: 0.878
Validation loss decreased (-0.877768 --> -0.877769).  Saving model ...
Epoch: 17 cost time: 0.7220091819763184
Epoch: 17, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.789 Vali Acc: 0.889 Test Loss: 0.789 Test Acc: 0.889
Validation loss decreased (-0.877769 --> -0.888881).  Saving model ...
Epoch: 18 cost time: 0.6917505264282227
Epoch: 18, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.722 Vali Acc: 0.896 Test Loss: 0.722 Test Acc: 0.896
Validation loss decreased (-0.888881 --> -0.896289).  Saving model ...
Epoch: 19 cost time: 0.7286901473999023
Epoch: 19, Steps: 2 | Train Loss: 0.564 Vali Loss: 0.655 Vali Acc: 0.911 Test Loss: 0.655 Test Acc: 0.911
Validation loss decreased (-0.896289 --> -0.911105).  Saving model ...
Epoch: 20 cost time: 0.6001837253570557
Epoch: 20, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.595 Vali Acc: 0.941 Test Loss: 0.595 Test Acc: 0.941
Validation loss decreased (-0.911105 --> -0.940735).  Saving model ...
Epoch: 21 cost time: 0.5960748195648193
Epoch: 21, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.538 Vali Acc: 0.941 Test Loss: 0.538 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940735).  Saving model ...
Epoch: 22 cost time: 0.6021628379821777
Epoch: 22, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.486 Vali Acc: 0.941 Test Loss: 0.486 Test Acc: 0.941
Validation loss decreased (-0.940735 --> -0.940736).  Saving model ...
Epoch: 23 cost time: 0.647611141204834
Epoch: 23, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.442 Vali Acc: 0.941 Test Loss: 0.442 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 24 cost time: 0.6985957622528076
Epoch: 24, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.404 Vali Acc: 0.933 Test Loss: 0.404 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5974884033203125
Epoch: 25, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.367 Vali Acc: 0.933 Test Loss: 0.367 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8094513416290283
Epoch: 26, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.333 Vali Acc: 0.948 Test Loss: 0.333 Test Acc: 0.948
Validation loss decreased (-0.940736 --> -0.948145).  Saving model ...
Epoch: 27 cost time: 0.7199821472167969
Epoch: 27, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.309 Vali Acc: 0.948 Test Loss: 0.309 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 28 cost time: 0.6375641822814941
Epoch: 28, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7400004863739014
Epoch: 29, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6961171627044678
Epoch: 30, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5853438377380371
Epoch: 31, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7372772693634033
Epoch: 32, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6783401966094971
Epoch: 33, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6289248466491699
Epoch: 34, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7445278167724609
Epoch: 35, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.8435935974121094
Epoch: 36, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.6206119060516357
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6919658184051514
Epoch: 38, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7450523376464844
Epoch: 39, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6575345993041992
Epoch: 40, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.747791051864624
Epoch: 41, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5840601921081543
Epoch: 42, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7714653015136719
Epoch: 43, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.712655782699585
Epoch: 44, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8584012985229492
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7486624717712402
Epoch: 46, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 1615646
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1447463035583496
Epoch: 1, Steps: 2 | Train Loss: 2.046 Vali Loss: 1.966 Vali Acc: 0.126 Test Loss: 1.966 Test Acc: 0.126
Validation loss decreased (inf --> -0.125906).  Saving model ...
Epoch: 2 cost time: 0.6126728057861328
Epoch: 2, Steps: 2 | Train Loss: 2.002 Vali Loss: 1.917 Vali Acc: 0.130 Test Loss: 1.917 Test Acc: 0.130
Validation loss decreased (-0.125906 --> -0.129610).  Saving model ...
Epoch: 3 cost time: 0.5757861137390137
Epoch: 3, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.867 Vali Acc: 0.141 Test Loss: 1.867 Test Acc: 0.141
Validation loss decreased (-0.129610 --> -0.140722).  Saving model ...
Epoch: 4 cost time: 0.582122802734375
Epoch: 4, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.805 Vali Acc: 0.163 Test Loss: 1.805 Test Acc: 0.163
Validation loss decreased (-0.140722 --> -0.162945).  Saving model ...
Epoch: 5 cost time: 0.5228819847106934
Epoch: 5, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.740 Vali Acc: 0.219 Test Loss: 1.740 Test Acc: 0.219
Validation loss decreased (-0.162945 --> -0.218501).  Saving model ...
Epoch: 6 cost time: 0.6856462955474854
Epoch: 6, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.681 Vali Acc: 0.281 Test Loss: 1.681 Test Acc: 0.281
Validation loss decreased (-0.218501 --> -0.281465).  Saving model ...
Epoch: 7 cost time: 0.5133876800537109
Epoch: 7, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.621 Vali Acc: 0.393 Test Loss: 1.621 Test Acc: 0.393
Validation loss decreased (-0.281465 --> -0.392576).  Saving model ...
Epoch: 8 cost time: 0.6649961471557617
Epoch: 8, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.557 Vali Acc: 0.467 Test Loss: 1.557 Test Acc: 0.467
Validation loss decreased (-0.392576 --> -0.466651).  Saving model ...
Epoch: 9 cost time: 0.8470413684844971
Epoch: 9, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.479 Vali Acc: 0.530 Test Loss: 1.479 Test Acc: 0.530
Validation loss decreased (-0.466651 --> -0.529615).  Saving model ...
Epoch: 10 cost time: 0.5370893478393555
Epoch: 10, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.392 Vali Acc: 0.593 Test Loss: 1.392 Test Acc: 0.593
Validation loss decreased (-0.529615 --> -0.592579).  Saving model ...
Epoch: 11 cost time: 0.6907062530517578
Epoch: 11, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.300 Vali Acc: 0.711 Test Loss: 1.300 Test Acc: 0.711
Validation loss decreased (-0.592579 --> -0.711098).  Saving model ...
Epoch: 12 cost time: 0.6312847137451172
Epoch: 12, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.212 Vali Acc: 0.778 Test Loss: 1.212 Test Acc: 0.778
Validation loss decreased (-0.711098 --> -0.777766).  Saving model ...
Epoch: 13 cost time: 0.6536068916320801
Epoch: 13, Steps: 2 | Train Loss: 1.085 Vali Loss: 1.128 Vali Acc: 0.807 Test Loss: 1.128 Test Acc: 0.807
Validation loss decreased (-0.777766 --> -0.807396).  Saving model ...
Epoch: 14 cost time: 0.6595056056976318
Epoch: 14, Steps: 2 | Train Loss: 1.027 Vali Loss: 1.047 Vali Acc: 0.811 Test Loss: 1.047 Test Acc: 0.811
Validation loss decreased (-0.807396 --> -0.811101).  Saving model ...
Epoch: 15 cost time: 0.7098379135131836
Epoch: 15, Steps: 2 | Train Loss: 0.943 Vali Loss: 0.969 Vali Acc: 0.841 Test Loss: 0.969 Test Acc: 0.841
Validation loss decreased (-0.811101 --> -0.840731).  Saving model ...
Epoch: 16 cost time: 0.6780545711517334
Epoch: 16, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.895 Vali Acc: 0.893 Test Loss: 0.895 Test Acc: 0.893
Validation loss decreased (-0.840731 --> -0.892584).  Saving model ...
Epoch: 17 cost time: 0.6575236320495605
Epoch: 17, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.826 Vali Acc: 0.885 Test Loss: 0.826 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6005001068115234
Epoch: 18, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.758 Vali Acc: 0.922 Test Loss: 0.758 Test Acc: 0.922
Validation loss decreased (-0.892584 --> -0.922215).  Saving model ...
Epoch: 19 cost time: 0.6559929847717285
Epoch: 19, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.694 Vali Acc: 0.922 Test Loss: 0.694 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922215).  Saving model ...
Epoch: 20 cost time: 0.5608212947845459
Epoch: 20, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.635 Vali Acc: 0.930 Test Loss: 0.635 Test Acc: 0.930
Validation loss decreased (-0.922215 --> -0.929623).  Saving model ...
Epoch: 21 cost time: 0.5848779678344727
Epoch: 21, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.578 Vali Acc: 0.919 Test Loss: 0.578 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7505357265472412
Epoch: 22, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.525 Vali Acc: 0.933 Test Loss: 0.525 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933328).  Saving model ...
Epoch: 23 cost time: 0.6219534873962402
Epoch: 23, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.480 Vali Acc: 0.930 Test Loss: 0.480 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6630814075469971
Epoch: 24, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.437 Vali Acc: 0.941 Test Loss: 0.437 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 25 cost time: 0.5622162818908691
Epoch: 25, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.400 Vali Acc: 0.944 Test Loss: 0.400 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 26 cost time: 0.5969333648681641
Epoch: 26, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.373 Vali Acc: 0.933 Test Loss: 0.373 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6969084739685059
Epoch: 27, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.349 Vali Acc: 0.933 Test Loss: 0.349 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.725088357925415
Epoch: 28, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.321 Vali Acc: 0.930 Test Loss: 0.321 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6546471118927002
Epoch: 29, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.293 Vali Acc: 0.941 Test Loss: 0.293 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6218616962432861
Epoch: 30, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.264 Vali Acc: 0.952 Test Loss: 0.264 Test Acc: 0.952
Validation loss decreased (-0.944440 --> -0.951849).  Saving model ...
Epoch: 31 cost time: 0.5921115875244141
Epoch: 31, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 32 cost time: 0.5901403427124023
Epoch: 32, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4957563877105713
Epoch: 33, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6710548400878906
Epoch: 34, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6818583011627197
Epoch: 35, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5577301979064941
Epoch: 36, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6816315650939941
Epoch: 37, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.824556827545166
Epoch: 38, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.6845312118530273
Epoch: 39, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9441213607788086
Epoch: 40, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9270381927490234
Epoch: 41, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1614878
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2107503414154053
Epoch: 1, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.788 Vali Acc: 0.263 Test Loss: 1.788 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 0.7704832553863525
Epoch: 2, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.755 Vali Acc: 0.274 Test Loss: 1.755 Test Acc: 0.274
Validation loss decreased (-0.262945 --> -0.274057).  Saving model ...
Epoch: 3 cost time: 0.7005393505096436
Epoch: 3, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.721 Vali Acc: 0.348 Test Loss: 1.721 Test Acc: 0.348
Validation loss decreased (-0.274057 --> -0.348131).  Saving model ...
Epoch: 4 cost time: 0.6045997142791748
Epoch: 4, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.677 Vali Acc: 0.381 Test Loss: 1.677 Test Acc: 0.381
Validation loss decreased (-0.348131 --> -0.381465).  Saving model ...
Epoch: 5 cost time: 0.6180968284606934
Epoch: 5, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.623 Vali Acc: 0.437 Test Loss: 1.623 Test Acc: 0.437
Validation loss decreased (-0.381465 --> -0.437021).  Saving model ...
Epoch: 6 cost time: 0.6352376937866211
Epoch: 6, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.566 Vali Acc: 0.485 Test Loss: 1.566 Test Acc: 0.485
Validation loss decreased (-0.437021 --> -0.485170).  Saving model ...
Epoch: 7 cost time: 0.6924028396606445
Epoch: 7, Steps: 2 | Train Loss: 1.498 Vali Loss: 1.506 Vali Acc: 0.552 Test Loss: 1.506 Test Acc: 0.552
Validation loss decreased (-0.485170 --> -0.551837).  Saving model ...
Epoch: 8 cost time: 0.7232887744903564
Epoch: 8, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.438 Vali Acc: 0.607 Test Loss: 1.438 Test Acc: 0.607
Validation loss decreased (-0.551837 --> -0.607393).  Saving model ...
Epoch: 9 cost time: 0.5925500392913818
Epoch: 9, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.365 Vali Acc: 0.700 Test Loss: 1.365 Test Acc: 0.700
Validation loss decreased (-0.607393 --> -0.699986).  Saving model ...
Epoch: 10 cost time: 0.6516869068145752
Epoch: 10, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.289 Vali Acc: 0.774 Test Loss: 1.289 Test Acc: 0.774
Validation loss decreased (-0.699986 --> -0.774061).  Saving model ...
Epoch: 11 cost time: 0.5965960025787354
Epoch: 11, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.215 Vali Acc: 0.804 Test Loss: 1.215 Test Acc: 0.804
Validation loss decreased (-0.774061 --> -0.803692).  Saving model ...
Epoch: 12 cost time: 0.6081204414367676
Epoch: 12, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.144 Vali Acc: 0.819 Test Loss: 1.144 Test Acc: 0.819
Validation loss decreased (-0.803692 --> -0.818507).  Saving model ...
Epoch: 13 cost time: 0.5924367904663086
Epoch: 13, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.075 Vali Acc: 0.822 Test Loss: 1.075 Test Acc: 0.822
Validation loss decreased (-0.818507 --> -0.822211).  Saving model ...
Epoch: 14 cost time: 0.6160006523132324
Epoch: 14, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.008 Vali Acc: 0.811 Test Loss: 1.008 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6449739933013916
Epoch: 15, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.934 Vali Acc: 0.852 Test Loss: 0.934 Test Acc: 0.852
Validation loss decreased (-0.822211 --> -0.851843).  Saving model ...
Epoch: 16 cost time: 0.6668014526367188
Epoch: 16, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.856 Vali Acc: 0.896 Test Loss: 0.856 Test Acc: 0.896
Validation loss decreased (-0.851843 --> -0.896288).  Saving model ...
Epoch: 17 cost time: 0.8519070148468018
Epoch: 17, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.786 Vali Acc: 0.919 Test Loss: 0.786 Test Acc: 0.919
Validation loss decreased (-0.896288 --> -0.918511).  Saving model ...
Epoch: 18 cost time: 0.6581478118896484
Epoch: 18, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.720 Vali Acc: 0.930 Test Loss: 0.720 Test Acc: 0.930
Validation loss decreased (-0.918511 --> -0.929622).  Saving model ...
Epoch: 19 cost time: 0.6146252155303955
Epoch: 19, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.659 Vali Acc: 0.930 Test Loss: 0.659 Test Acc: 0.930
Validation loss decreased (-0.929622 --> -0.929623).  Saving model ...
Epoch: 20 cost time: 0.547600269317627
Epoch: 20, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.604 Vali Acc: 0.922 Test Loss: 0.604 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7374835014343262
Epoch: 21, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.552 Vali Acc: 0.926 Test Loss: 0.552 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6004347801208496
Epoch: 22, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.502 Vali Acc: 0.930 Test Loss: 0.502 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929625).  Saving model ...
Epoch: 23 cost time: 0.7710437774658203
Epoch: 23, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.461 Vali Acc: 0.922 Test Loss: 0.461 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8431429862976074
Epoch: 24, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.418 Vali Acc: 0.933 Test Loss: 0.418 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 25 cost time: 0.694220781326294
Epoch: 25, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.381 Vali Acc: 0.941 Test Loss: 0.381 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 26 cost time: 0.5393686294555664
Epoch: 26, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.347 Vali Acc: 0.944 Test Loss: 0.347 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 27 cost time: 0.6512429714202881
Epoch: 27, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.320 Vali Acc: 0.944 Test Loss: 0.320 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 28 cost time: 0.6952009201049805
Epoch: 28, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.298 Vali Acc: 0.941 Test Loss: 0.298 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5637857913970947
Epoch: 29, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6509625911712646
Epoch: 30, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.592663049697876
Epoch: 31, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.5679409503936768
Epoch: 32, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6644754409790039
Epoch: 33, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.5822529792785645
Epoch: 34, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8916428089141846
Epoch: 35, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6581144332885742
Epoch: 36, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6162993907928467
Epoch: 37, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1614110
model size : 8.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.310873508453369
Epoch: 1, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.832 Vali Acc: 0.189 Test Loss: 1.832 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.8473553657531738
Epoch: 2, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.798 Vali Acc: 0.204 Test Loss: 1.798 Test Acc: 0.204
Validation loss decreased (-0.188871 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.600754976272583
Epoch: 3, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.768 Vali Acc: 0.207 Test Loss: 1.768 Test Acc: 0.207
Validation loss decreased (-0.203686 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.678168773651123
Epoch: 4, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.728 Vali Acc: 0.248 Test Loss: 1.728 Test Acc: 0.248
Validation loss decreased (-0.207390 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 0.6113007068634033
Epoch: 5, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.681 Vali Acc: 0.352 Test Loss: 1.681 Test Acc: 0.352
Validation loss decreased (-0.248131 --> -0.351835).  Saving model ...
Epoch: 6 cost time: 0.6900200843811035
Epoch: 6, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.631 Vali Acc: 0.426 Test Loss: 1.631 Test Acc: 0.426
Validation loss decreased (-0.351835 --> -0.425910).  Saving model ...
Epoch: 7 cost time: 0.6065521240234375
Epoch: 7, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.574 Vali Acc: 0.470 Test Loss: 1.574 Test Acc: 0.470
Validation loss decreased (-0.425910 --> -0.470355).  Saving model ...
Epoch: 8 cost time: 0.7035276889801025
Epoch: 8, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.514 Vali Acc: 0.519 Test Loss: 1.514 Test Acc: 0.519
Validation loss decreased (-0.470355 --> -0.518503).  Saving model ...
Epoch: 9 cost time: 0.5419032573699951
Epoch: 9, Steps: 2 | Train Loss: 1.446 Vali Loss: 1.445 Vali Acc: 0.570 Test Loss: 1.445 Test Acc: 0.570
Validation loss decreased (-0.518503 --> -0.570356).  Saving model ...
Epoch: 10 cost time: 0.5615139007568359
Epoch: 10, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.369 Vali Acc: 0.644 Test Loss: 1.369 Test Acc: 0.644
Validation loss decreased (-0.570356 --> -0.644431).  Saving model ...
Epoch: 11 cost time: 0.5922846794128418
Epoch: 11, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.292 Vali Acc: 0.685 Test Loss: 1.292 Test Acc: 0.685
Validation loss decreased (-0.644431 --> -0.685172).  Saving model ...
Epoch: 12 cost time: 0.7498626708984375
Epoch: 12, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.215 Vali Acc: 0.741 Test Loss: 1.215 Test Acc: 0.741
Validation loss decreased (-0.685172 --> -0.740729).  Saving model ...
Epoch: 13 cost time: 0.6333138942718506
Epoch: 13, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.140 Vali Acc: 0.785 Test Loss: 1.140 Test Acc: 0.785
Validation loss decreased (-0.740729 --> -0.785174).  Saving model ...
Epoch: 14 cost time: 0.7749755382537842
Epoch: 14, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.067 Vali Acc: 0.815 Test Loss: 1.067 Test Acc: 0.815
Validation loss decreased (-0.785174 --> -0.814804).  Saving model ...
Epoch: 15 cost time: 0.7408111095428467
Epoch: 15, Steps: 2 | Train Loss: 0.969 Vali Loss: 0.997 Vali Acc: 0.852 Test Loss: 0.997 Test Acc: 0.852
Validation loss decreased (-0.814804 --> -0.851842).  Saving model ...
Epoch: 16 cost time: 0.7312664985656738
Epoch: 16, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.931 Vali Acc: 0.874 Test Loss: 0.931 Test Acc: 0.874
Validation loss decreased (-0.851842 --> -0.874065).  Saving model ...
Epoch: 17 cost time: 0.6961400508880615
Epoch: 17, Steps: 2 | Train Loss: 0.860 Vali Loss: 0.866 Vali Acc: 0.870 Test Loss: 0.866 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7530620098114014
Epoch: 18, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.808 Vali Acc: 0.874 Test Loss: 0.808 Test Acc: 0.874
Validation loss decreased (-0.874065 --> -0.874066).  Saving model ...
Epoch: 19 cost time: 0.7697460651397705
Epoch: 19, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.748 Vali Acc: 0.889 Test Loss: 0.748 Test Acc: 0.889
Validation loss decreased (-0.874066 --> -0.888881).  Saving model ...
Epoch: 20 cost time: 0.6960229873657227
Epoch: 20, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.689 Vali Acc: 0.911 Test Loss: 0.689 Test Acc: 0.911
Validation loss decreased (-0.888881 --> -0.911104).  Saving model ...
Epoch: 21 cost time: 0.5431225299835205
Epoch: 21, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.634 Vali Acc: 0.915 Test Loss: 0.634 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 22 cost time: 0.8239786624908447
Epoch: 22, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.578 Vali Acc: 0.926 Test Loss: 0.578 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925920).  Saving model ...
Epoch: 23 cost time: 0.6761224269866943
Epoch: 23, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.530 Vali Acc: 0.930 Test Loss: 0.530 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 24 cost time: 0.7444803714752197
Epoch: 24, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.482 Vali Acc: 0.930 Test Loss: 0.482 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 25 cost time: 0.6246805191040039
Epoch: 25, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.440 Vali Acc: 0.937 Test Loss: 0.440 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 26 cost time: 0.6359717845916748
Epoch: 26, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.402 Vali Acc: 0.937 Test Loss: 0.402 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 27 cost time: 0.6742959022521973
Epoch: 27, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.370 Vali Acc: 0.941 Test Loss: 0.370 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 28 cost time: 0.7954118251800537
Epoch: 28, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.338 Vali Acc: 0.937 Test Loss: 0.338 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6987831592559814
Epoch: 29, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.315 Vali Acc: 0.933 Test Loss: 0.315 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6783039569854736
Epoch: 30, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7328708171844482
Epoch: 31, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6513581275939941
Epoch: 32, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.269 Vali Acc: 0.933 Test Loss: 0.269 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8269867897033691
Epoch: 33, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7729637622833252
Epoch: 34, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7649538516998291
Epoch: 35, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7709512710571289
Epoch: 36, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8190674781799316
Epoch: 37, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 1221662
model size : 7.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2662742137908936
Epoch: 1, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.837 Vali Acc: 0.241 Test Loss: 1.837 Test Acc: 0.241
Validation loss decreased (inf --> -0.240722).  Saving model ...
Epoch: 2 cost time: 0.5576155185699463
Epoch: 2, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.793 Vali Acc: 0.219 Test Loss: 1.793 Test Acc: 0.219
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6885058879852295
Epoch: 3, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.755 Vali Acc: 0.233 Test Loss: 1.755 Test Acc: 0.233
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.8003082275390625
Epoch: 4, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.709 Vali Acc: 0.278 Test Loss: 1.709 Test Acc: 0.278
Validation loss decreased (-0.240722 --> -0.277761).  Saving model ...
Epoch: 5 cost time: 0.6740329265594482
Epoch: 5, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.659 Vali Acc: 0.352 Test Loss: 1.659 Test Acc: 0.352
Validation loss decreased (-0.277761 --> -0.351835).  Saving model ...
Epoch: 6 cost time: 0.605689287185669
Epoch: 6, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.610 Vali Acc: 0.433 Test Loss: 1.610 Test Acc: 0.433
Validation loss decreased (-0.351835 --> -0.433317).  Saving model ...
Epoch: 7 cost time: 0.7285933494567871
Epoch: 7, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.557 Vali Acc: 0.530 Test Loss: 1.557 Test Acc: 0.530
Validation loss decreased (-0.433317 --> -0.529614).  Saving model ...
Epoch: 8 cost time: 0.6056060791015625
Epoch: 8, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.498 Vali Acc: 0.581 Test Loss: 1.498 Test Acc: 0.581
Validation loss decreased (-0.529614 --> -0.581467).  Saving model ...
Epoch: 9 cost time: 0.5502111911773682
Epoch: 9, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.425 Vali Acc: 0.689 Test Loss: 1.425 Test Acc: 0.689
Validation loss decreased (-0.581467 --> -0.688875).  Saving model ...
Epoch: 10 cost time: 0.6267287731170654
Epoch: 10, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.344 Vali Acc: 0.759 Test Loss: 1.344 Test Acc: 0.759
Validation loss decreased (-0.688875 --> -0.759246).  Saving model ...
Epoch: 11 cost time: 0.5902678966522217
Epoch: 11, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.262 Vali Acc: 0.822 Test Loss: 1.262 Test Acc: 0.822
Validation loss decreased (-0.759246 --> -0.822210).  Saving model ...
Epoch: 12 cost time: 0.6546263694763184
Epoch: 12, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.182 Vali Acc: 0.863 Test Loss: 1.182 Test Acc: 0.863
Validation loss decreased (-0.822210 --> -0.862951).  Saving model ...
Epoch: 13 cost time: 0.5291926860809326
Epoch: 13, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.106 Vali Acc: 0.878 Test Loss: 1.106 Test Acc: 0.878
Validation loss decreased (-0.862951 --> -0.877767).  Saving model ...
Epoch: 14 cost time: 0.5618298053741455
Epoch: 14, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.030 Vali Acc: 0.881 Test Loss: 1.030 Test Acc: 0.881
Validation loss decreased (-0.877767 --> -0.881471).  Saving model ...
Epoch: 15 cost time: 0.7005274295806885
Epoch: 15, Steps: 2 | Train Loss: 0.964 Vali Loss: 0.960 Vali Acc: 0.859 Test Loss: 0.960 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6501667499542236
Epoch: 16, Steps: 2 | Train Loss: 0.858 Vali Loss: 0.886 Vali Acc: 0.885 Test Loss: 0.886 Test Acc: 0.885
Validation loss decreased (-0.881471 --> -0.885176).  Saving model ...
Epoch: 17 cost time: 0.5931339263916016
Epoch: 17, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.816 Vali Acc: 0.937 Test Loss: 0.816 Test Acc: 0.937
Validation loss decreased (-0.885176 --> -0.937029).  Saving model ...
Epoch: 18 cost time: 0.6747028827667236
Epoch: 18, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.754 Vali Acc: 0.922 Test Loss: 0.754 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.5870192050933838
Epoch: 19, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.693 Vali Acc: 0.919 Test Loss: 0.693 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7068874835968018
Epoch: 20, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.633 Vali Acc: 0.933 Test Loss: 0.633 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6647734642028809
Epoch: 21, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.577 Vali Acc: 0.948 Test Loss: 0.577 Test Acc: 0.948
Validation loss decreased (-0.937029 --> -0.948142).  Saving model ...
Epoch: 22 cost time: 0.6031801700592041
Epoch: 22, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.528 Vali Acc: 0.948 Test Loss: 0.528 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948143).  Saving model ...
Epoch: 23 cost time: 0.8288462162017822
Epoch: 23, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.485 Vali Acc: 0.941 Test Loss: 0.485 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6957836151123047
Epoch: 24, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.445 Vali Acc: 0.941 Test Loss: 0.445 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7118246555328369
Epoch: 25, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.410 Vali Acc: 0.941 Test Loss: 0.410 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6341896057128906
Epoch: 26, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.375 Vali Acc: 0.952 Test Loss: 0.375 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951848).  Saving model ...
Epoch: 27 cost time: 0.7933328151702881
Epoch: 27, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.343 Vali Acc: 0.952 Test Loss: 0.343 Test Acc: 0.952
Validation loss decreased (-0.951848 --> -0.951848).  Saving model ...
Epoch: 28 cost time: 0.775921106338501
Epoch: 28, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.313 Vali Acc: 0.959 Test Loss: 0.313 Test Acc: 0.959
Validation loss decreased (-0.951848 --> -0.959256).  Saving model ...
Epoch: 29 cost time: 0.7319929599761963
Epoch: 29, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.292 Vali Acc: 0.948 Test Loss: 0.292 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5905649662017822
Epoch: 30, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.273 Vali Acc: 0.952 Test Loss: 0.273 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.657761812210083
Epoch: 31, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.257 Vali Acc: 0.952 Test Loss: 0.257 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0918240547180176
Epoch: 32, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.244 Vali Acc: 0.956 Test Loss: 0.244 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.5245850086212158
Epoch: 33, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.234 Vali Acc: 0.952 Test Loss: 0.234 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7105333805084229
Epoch: 34, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.227 Vali Acc: 0.948 Test Loss: 0.227 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7485251426696777
Epoch: 35, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.219 Vali Acc: 0.948 Test Loss: 0.219 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5547518730163574
Epoch: 36, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.6553585529327393
Epoch: 37, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.5404026508331299
Epoch: 38, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 1220894
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.239307403564453
Epoch: 1, Steps: 2 | Train Loss: 1.988 Vali Loss: 1.885 Vali Acc: 0.181 Test Loss: 1.885 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.5053839683532715
Epoch: 2, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.846 Vali Acc: 0.222 Test Loss: 1.846 Test Acc: 0.222
Validation loss decreased (-0.181463 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 0.5343585014343262
Epoch: 3, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.808 Vali Acc: 0.263 Test Loss: 1.808 Test Acc: 0.263
Validation loss decreased (-0.222204 --> -0.262945).  Saving model ...
Epoch: 4 cost time: 0.565598726272583
Epoch: 4, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.760 Vali Acc: 0.326 Test Loss: 1.760 Test Acc: 0.326
Validation loss decreased (-0.262945 --> -0.325908).  Saving model ...
Epoch: 5 cost time: 0.5247311592102051
Epoch: 5, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.707 Vali Acc: 0.385 Test Loss: 1.707 Test Acc: 0.385
Validation loss decreased (-0.325908 --> -0.385168).  Saving model ...
Epoch: 6 cost time: 0.4654371738433838
Epoch: 6, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.651 Vali Acc: 0.437 Test Loss: 1.651 Test Acc: 0.437
Validation loss decreased (-0.385168 --> -0.437021).  Saving model ...
Epoch: 7 cost time: 0.528416633605957
Epoch: 7, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.592 Vali Acc: 0.411 Test Loss: 1.592 Test Acc: 0.411
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.546816349029541
Epoch: 8, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.526 Vali Acc: 0.448 Test Loss: 1.526 Test Acc: 0.448
Validation loss decreased (-0.437021 --> -0.448133).  Saving model ...
Epoch: 9 cost time: 0.5399441719055176
Epoch: 9, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.455 Vali Acc: 0.593 Test Loss: 1.455 Test Acc: 0.593
Validation loss decreased (-0.448133 --> -0.592578).  Saving model ...
Epoch: 10 cost time: 0.6809964179992676
Epoch: 10, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.381 Vali Acc: 0.693 Test Loss: 1.381 Test Acc: 0.693
Validation loss decreased (-0.592578 --> -0.692579).  Saving model ...
Epoch: 11 cost time: 0.7635560035705566
Epoch: 11, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.306 Vali Acc: 0.763 Test Loss: 1.306 Test Acc: 0.763
Validation loss decreased (-0.692579 --> -0.762950).  Saving model ...
Epoch: 12 cost time: 0.7873125076293945
Epoch: 12, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.232 Vali Acc: 0.815 Test Loss: 1.232 Test Acc: 0.815
Validation loss decreased (-0.762950 --> -0.814802).  Saving model ...
Epoch: 13 cost time: 0.4694643020629883
Epoch: 13, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.158 Vali Acc: 0.841 Test Loss: 1.158 Test Acc: 0.841
Validation loss decreased (-0.814802 --> -0.840729).  Saving model ...
Epoch: 14 cost time: 0.475492000579834
Epoch: 14, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.083 Vali Acc: 0.856 Test Loss: 1.083 Test Acc: 0.856
Validation loss decreased (-0.840729 --> -0.855545).  Saving model ...
Epoch: 15 cost time: 0.5205090045928955
Epoch: 15, Steps: 2 | Train Loss: 1.004 Vali Loss: 1.011 Vali Acc: 0.878 Test Loss: 1.011 Test Acc: 0.878
Validation loss decreased (-0.855545 --> -0.877768).  Saving model ...
Epoch: 16 cost time: 0.5711534023284912
Epoch: 16, Steps: 2 | Train Loss: 0.858 Vali Loss: 0.939 Vali Acc: 0.885 Test Loss: 0.939 Test Acc: 0.885
Validation loss decreased (-0.877768 --> -0.885176).  Saving model ...
Epoch: 17 cost time: 0.5989656448364258
Epoch: 17, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.870 Vali Acc: 0.904 Test Loss: 0.870 Test Acc: 0.904
Validation loss decreased (-0.885176 --> -0.903695).  Saving model ...
Epoch: 18 cost time: 0.5307862758636475
Epoch: 18, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.803 Vali Acc: 0.922 Test Loss: 0.803 Test Acc: 0.922
Validation loss decreased (-0.903695 --> -0.922214).  Saving model ...
Epoch: 19 cost time: 0.6229538917541504
Epoch: 19, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.743 Vali Acc: 0.930 Test Loss: 0.743 Test Acc: 0.930
Validation loss decreased (-0.922214 --> -0.929622).  Saving model ...
Epoch: 20 cost time: 0.619178295135498
Epoch: 20, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.684 Vali Acc: 0.933 Test Loss: 0.684 Test Acc: 0.933
Validation loss decreased (-0.929622 --> -0.933326).  Saving model ...
Epoch: 21 cost time: 0.5155866146087646
Epoch: 21, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.630 Vali Acc: 0.933 Test Loss: 0.630 Test Acc: 0.933
Validation loss decreased (-0.933326 --> -0.933327).  Saving model ...
Epoch: 22 cost time: 0.4829075336456299
Epoch: 22, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.577 Vali Acc: 0.944 Test Loss: 0.577 Test Acc: 0.944
Validation loss decreased (-0.933327 --> -0.944439).  Saving model ...
Epoch: 23 cost time: 0.53951096534729
Epoch: 23, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.530 Vali Acc: 0.941 Test Loss: 0.530 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5209553241729736
Epoch: 24, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.488 Vali Acc: 0.941 Test Loss: 0.488 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.543281078338623
Epoch: 25, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.456 Vali Acc: 0.933 Test Loss: 0.456 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5981369018554688
Epoch: 26, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.420 Vali Acc: 0.941 Test Loss: 0.420 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5957705974578857
Epoch: 27, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.386 Vali Acc: 0.937 Test Loss: 0.386 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5265476703643799
Epoch: 28, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.353 Vali Acc: 0.941 Test Loss: 0.353 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5650022029876709
Epoch: 29, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944441).  Saving model ...
Epoch: 30 cost time: 0.5244004726409912
Epoch: 30, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5071456432342529
Epoch: 31, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.290 Vali Acc: 0.941 Test Loss: 0.290 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.525521993637085
Epoch: 32, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.278 Vali Acc: 0.937 Test Loss: 0.278 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7069137096405029
Epoch: 33, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7851572036743164
Epoch: 34, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6101818084716797
Epoch: 35, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9418079853057861
Epoch: 36, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.6909940242767334
Epoch: 37, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5621428489685059
Epoch: 38, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6364037990570068
Epoch: 39, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6571478843688965
Epoch: 40, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6494443416595459
Epoch: 41, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7661442756652832
Epoch: 42, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.6255993843078613
Epoch: 43, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7416286468505859
Epoch: 44, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6642274856567383
Epoch: 45, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6412177085876465
Epoch: 46, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5326004028320312
Epoch: 47, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.561042308807373
Epoch: 48, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.5764811038970947
Epoch: 49, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1220126
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1139767169952393
Epoch: 1, Steps: 2 | Train Loss: 1.975 Vali Loss: 1.917 Vali Acc: 0.148 Test Loss: 1.917 Test Acc: 0.148
Validation loss decreased (inf --> -0.148129).  Saving model ...
Epoch: 2 cost time: 0.6168944835662842
Epoch: 2, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.870 Vali Acc: 0.174 Test Loss: 1.870 Test Acc: 0.174
Validation loss decreased (-0.148129 --> -0.174055).  Saving model ...
Epoch: 3 cost time: 0.5806143283843994
Epoch: 3, Steps: 2 | Train Loss: 1.932 Vali Loss: 1.832 Vali Acc: 0.193 Test Loss: 1.832 Test Acc: 0.193
Validation loss decreased (-0.174055 --> -0.192574).  Saving model ...
Epoch: 4 cost time: 0.6856563091278076
Epoch: 4, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.789 Vali Acc: 0.241 Test Loss: 1.789 Test Acc: 0.241
Validation loss decreased (-0.192574 --> -0.240723).  Saving model ...
Epoch: 5 cost time: 0.6699597835540771
Epoch: 5, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.739 Vali Acc: 0.270 Test Loss: 1.739 Test Acc: 0.270
Validation loss decreased (-0.240723 --> -0.270353).  Saving model ...
Epoch: 6 cost time: 0.8956303596496582
Epoch: 6, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.685 Vali Acc: 0.322 Test Loss: 1.685 Test Acc: 0.322
Validation loss decreased (-0.270353 --> -0.322205).  Saving model ...
Epoch: 7 cost time: 0.5895471572875977
Epoch: 7, Steps: 2 | Train Loss: 1.692 Vali Loss: 1.627 Vali Acc: 0.419 Test Loss: 1.627 Test Acc: 0.419
Validation loss decreased (-0.322205 --> -0.418502).  Saving model ...
Epoch: 8 cost time: 0.6205103397369385
Epoch: 8, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.561 Vali Acc: 0.548 Test Loss: 1.561 Test Acc: 0.548
Validation loss decreased (-0.418502 --> -0.548133).  Saving model ...
Epoch: 9 cost time: 0.6641049385070801
Epoch: 9, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.488 Vali Acc: 0.637 Test Loss: 1.488 Test Acc: 0.637
Validation loss decreased (-0.548133 --> -0.637022).  Saving model ...
Epoch: 10 cost time: 0.6225428581237793
Epoch: 10, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.412 Vali Acc: 0.685 Test Loss: 1.412 Test Acc: 0.685
Validation loss decreased (-0.637022 --> -0.685171).  Saving model ...
Epoch: 11 cost time: 0.5876598358154297
Epoch: 11, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.334 Vali Acc: 0.741 Test Loss: 1.334 Test Acc: 0.741
Validation loss decreased (-0.685171 --> -0.740727).  Saving model ...
Epoch: 12 cost time: 0.6354546546936035
Epoch: 12, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.258 Vali Acc: 0.785 Test Loss: 1.258 Test Acc: 0.785
Validation loss decreased (-0.740727 --> -0.785173).  Saving model ...
Epoch: 13 cost time: 0.633770227432251
Epoch: 13, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.183 Vali Acc: 0.796 Test Loss: 1.183 Test Acc: 0.796
Validation loss decreased (-0.785173 --> -0.796284).  Saving model ...
Epoch: 14 cost time: 0.5615549087524414
Epoch: 14, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.107 Vali Acc: 0.815 Test Loss: 1.107 Test Acc: 0.815
Validation loss decreased (-0.796284 --> -0.814804).  Saving model ...
Epoch: 15 cost time: 0.588517427444458
Epoch: 15, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.034 Vali Acc: 0.822 Test Loss: 1.034 Test Acc: 0.822
Validation loss decreased (-0.814804 --> -0.822212).  Saving model ...
Epoch: 16 cost time: 0.7307813167572021
Epoch: 16, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.963 Vali Acc: 0.830 Test Loss: 0.963 Test Acc: 0.830
Validation loss decreased (-0.822212 --> -0.829620).  Saving model ...
Epoch: 17 cost time: 0.5076014995574951
Epoch: 17, Steps: 2 | Train Loss: 0.848 Vali Loss: 0.890 Vali Acc: 0.867 Test Loss: 0.890 Test Acc: 0.867
Validation loss decreased (-0.829620 --> -0.866658).  Saving model ...
Epoch: 18 cost time: 0.7342181205749512
Epoch: 18, Steps: 2 | Train Loss: 0.712 Vali Loss: 0.822 Vali Acc: 0.893 Test Loss: 0.822 Test Acc: 0.893
Validation loss decreased (-0.866658 --> -0.892584).  Saving model ...
Epoch: 19 cost time: 0.5897929668426514
Epoch: 19, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.759 Vali Acc: 0.922 Test Loss: 0.759 Test Acc: 0.922
Validation loss decreased (-0.892584 --> -0.922215).  Saving model ...
Epoch: 20 cost time: 0.622514009475708
Epoch: 20, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.699 Vali Acc: 0.933 Test Loss: 0.699 Test Acc: 0.933
Validation loss decreased (-0.922215 --> -0.933326).  Saving model ...
Epoch: 21 cost time: 0.7531862258911133
Epoch: 21, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.644 Vali Acc: 0.922 Test Loss: 0.644 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7139906883239746
Epoch: 22, Steps: 2 | Train Loss: 0.457 Vali Loss: 0.594 Vali Acc: 0.915 Test Loss: 0.594 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8168008327484131
Epoch: 23, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.542 Vali Acc: 0.922 Test Loss: 0.542 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7652938365936279
Epoch: 24, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.492 Vali Acc: 0.933 Test Loss: 0.492 Test Acc: 0.933
Validation loss decreased (-0.933326 --> -0.933328).  Saving model ...
Epoch: 25 cost time: 0.7322654724121094
Epoch: 25, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.447 Vali Acc: 0.937 Test Loss: 0.447 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937033).  Saving model ...
Epoch: 26 cost time: 0.6722917556762695
Epoch: 26, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.410 Vali Acc: 0.930 Test Loss: 0.410 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8275444507598877
Epoch: 27, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.380 Vali Acc: 0.915 Test Loss: 0.380 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6533277034759521
Epoch: 28, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.350 Vali Acc: 0.922 Test Loss: 0.350 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6793708801269531
Epoch: 29, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.315 Vali Acc: 0.937 Test Loss: 0.315 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 30 cost time: 0.6550004482269287
Epoch: 30, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.8515791893005371
Epoch: 31, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7983498573303223
Epoch: 32, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6640222072601318
Epoch: 33, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.7966001033782959
Epoch: 34, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.726381778717041
Epoch: 35, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6266977787017822
Epoch: 36, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6210417747497559
Epoch: 37, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6688153743743896
Epoch: 38, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7693312168121338
Epoch: 39, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.6579263210296631
Epoch: 40, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.8007309436798096
Epoch: 41, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.7002696990966797
Epoch: 42, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 43 cost time: 0.6775736808776855
Epoch: 43, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 44 cost time: 0.5681383609771729
Epoch: 44, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 45 cost time: 0.6421937942504883
Epoch: 45, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8392033576965332
Epoch: 46, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7812271118164062
Epoch: 47, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6712934970855713
Epoch: 48, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6382713317871094
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.7090027332305908
Epoch: 50, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.6071310043334961
Epoch: 51, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6821262836456299
Epoch: 52, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.6569609642028809
Epoch: 53, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5831873416900635
Epoch: 54, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1219358
model size : 7.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9874529838562012
Epoch: 1, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.919 Vali Acc: 0.137 Test Loss: 1.919 Test Acc: 0.137
Validation loss decreased (inf --> -0.137018).  Saving model ...
Epoch: 2 cost time: 0.5677509307861328
Epoch: 2, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.885 Vali Acc: 0.156 Test Loss: 1.885 Test Acc: 0.156
Validation loss decreased (-0.137018 --> -0.155537).  Saving model ...
Epoch: 3 cost time: 0.6605727672576904
Epoch: 3, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.851 Vali Acc: 0.204 Test Loss: 1.851 Test Acc: 0.204
Validation loss decreased (-0.155537 --> -0.203685).  Saving model ...
Epoch: 4 cost time: 0.6709940433502197
Epoch: 4, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.810 Vali Acc: 0.259 Test Loss: 1.810 Test Acc: 0.259
Validation loss decreased (-0.203685 --> -0.259241).  Saving model ...
Epoch: 5 cost time: 0.6292099952697754
Epoch: 5, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.759 Vali Acc: 0.319 Test Loss: 1.759 Test Acc: 0.319
Validation loss decreased (-0.259241 --> -0.318501).  Saving model ...
Epoch: 6 cost time: 0.7325878143310547
Epoch: 6, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.703 Vali Acc: 0.370 Test Loss: 1.703 Test Acc: 0.370
Validation loss decreased (-0.318501 --> -0.370353).  Saving model ...
Epoch: 7 cost time: 0.554063081741333
Epoch: 7, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.644 Vali Acc: 0.404 Test Loss: 1.644 Test Acc: 0.404
Validation loss decreased (-0.370353 --> -0.403687).  Saving model ...
Epoch: 8 cost time: 0.6122579574584961
Epoch: 8, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.581 Vali Acc: 0.496 Test Loss: 1.581 Test Acc: 0.496
Validation loss decreased (-0.403687 --> -0.496280).  Saving model ...
Epoch: 9 cost time: 0.5427970886230469
Epoch: 9, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.517 Vali Acc: 0.585 Test Loss: 1.517 Test Acc: 0.585
Validation loss decreased (-0.496280 --> -0.585170).  Saving model ...
Epoch: 10 cost time: 0.5397570133209229
Epoch: 10, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.448 Vali Acc: 0.693 Test Loss: 1.448 Test Acc: 0.693
Validation loss decreased (-0.585170 --> -0.692578).  Saving model ...
Epoch: 11 cost time: 0.6514546871185303
Epoch: 11, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.378 Vali Acc: 0.756 Test Loss: 1.378 Test Acc: 0.756
Validation loss decreased (-0.692578 --> -0.755542).  Saving model ...
Epoch: 12 cost time: 0.8504588603973389
Epoch: 12, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.307 Vali Acc: 0.778 Test Loss: 1.307 Test Acc: 0.778
Validation loss decreased (-0.755542 --> -0.777765).  Saving model ...
Epoch: 13 cost time: 0.7272317409515381
Epoch: 13, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.232 Vali Acc: 0.793 Test Loss: 1.232 Test Acc: 0.793
Validation loss decreased (-0.777765 --> -0.792580).  Saving model ...
Epoch: 14 cost time: 0.6698086261749268
Epoch: 14, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.158 Vali Acc: 0.811 Test Loss: 1.158 Test Acc: 0.811
Validation loss decreased (-0.792580 --> -0.811100).  Saving model ...
Epoch: 15 cost time: 0.5923593044281006
Epoch: 15, Steps: 2 | Train Loss: 0.977 Vali Loss: 1.085 Vali Acc: 0.863 Test Loss: 1.085 Test Acc: 0.863
Validation loss decreased (-0.811100 --> -0.862952).  Saving model ...
Epoch: 16 cost time: 0.6705005168914795
Epoch: 16, Steps: 2 | Train Loss: 0.911 Vali Loss: 1.014 Vali Acc: 0.881 Test Loss: 1.014 Test Acc: 0.881
Validation loss decreased (-0.862952 --> -0.881471).  Saving model ...
Epoch: 17 cost time: 0.5090596675872803
Epoch: 17, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.944 Vali Acc: 0.893 Test Loss: 0.944 Test Acc: 0.893
Validation loss decreased (-0.881471 --> -0.892583).  Saving model ...
Epoch: 18 cost time: 0.5749528408050537
Epoch: 18, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.881 Vali Acc: 0.885 Test Loss: 0.881 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6497700214385986
Epoch: 19, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.821 Vali Acc: 0.896 Test Loss: 0.821 Test Acc: 0.896
Validation loss decreased (-0.892583 --> -0.896288).  Saving model ...
Epoch: 20 cost time: 0.6069633960723877
Epoch: 20, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.760 Vali Acc: 0.904 Test Loss: 0.760 Test Acc: 0.904
Validation loss decreased (-0.896288 --> -0.903696).  Saving model ...
Epoch: 21 cost time: 0.6245510578155518
Epoch: 21, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.698 Vali Acc: 0.915 Test Loss: 0.698 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914808).  Saving model ...
Epoch: 22 cost time: 0.6360304355621338
Epoch: 22, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.641 Vali Acc: 0.904 Test Loss: 0.641 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5771005153656006
Epoch: 23, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.587 Vali Acc: 0.915 Test Loss: 0.587 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 24 cost time: 0.5951588153839111
Epoch: 24, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.543 Vali Acc: 0.922 Test Loss: 0.543 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.5293610095977783
Epoch: 25, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.496 Vali Acc: 0.930 Test Loss: 0.496 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 26 cost time: 0.5938990116119385
Epoch: 26, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.455 Vali Acc: 0.937 Test Loss: 0.455 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937032).  Saving model ...
Epoch: 27 cost time: 0.7672030925750732
Epoch: 27, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.424 Vali Acc: 0.930 Test Loss: 0.424 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.634415864944458
Epoch: 28, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.405 Vali Acc: 0.915 Test Loss: 0.405 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6679224967956543
Epoch: 29, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.379 Vali Acc: 0.922 Test Loss: 0.379 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6103742122650146
Epoch: 30, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.345 Vali Acc: 0.937 Test Loss: 0.345 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.5965032577514648
Epoch: 31, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.318 Vali Acc: 0.937 Test Loss: 0.318 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.5886228084564209
Epoch: 32, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.297 Vali Acc: 0.948 Test Loss: 0.297 Test Acc: 0.948
Validation loss decreased (-0.937034 --> -0.948145).  Saving model ...
Epoch: 33 cost time: 0.6094310283660889
Epoch: 33, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.284 Vali Acc: 0.941 Test Loss: 0.284 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6402902603149414
Epoch: 34, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6472885608673096
Epoch: 35, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6459932327270508
Epoch: 36, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7569210529327393
Epoch: 37, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.572878360748291
Epoch: 38, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6088972091674805
Epoch: 39, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.6100752353668213
Epoch: 40, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.6899704933166504
Epoch: 41, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5809299945831299
Epoch: 42, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 1024286
model size : 6.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9960224628448486
Epoch: 1, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.911 Vali Acc: 0.096 Test Loss: 1.911 Test Acc: 0.096
Validation loss decreased (inf --> -0.096277).  Saving model ...
Epoch: 2 cost time: 0.8494226932525635
Epoch: 2, Steps: 2 | Train Loss: 1.930 Vali Loss: 1.871 Vali Acc: 0.104 Test Loss: 1.871 Test Acc: 0.104
Validation loss decreased (-0.096277 --> -0.103685).  Saving model ...
Epoch: 3 cost time: 0.6627397537231445
Epoch: 3, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.836 Vali Acc: 0.104 Test Loss: 1.836 Test Acc: 0.104
Validation loss decreased (-0.103685 --> -0.103685).  Saving model ...
Epoch: 4 cost time: 0.6149394512176514
Epoch: 4, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.793 Vali Acc: 0.144 Test Loss: 1.793 Test Acc: 0.144
Validation loss decreased (-0.103685 --> -0.144427).  Saving model ...
Epoch: 5 cost time: 0.6761472225189209
Epoch: 5, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.743 Vali Acc: 0.222 Test Loss: 1.743 Test Acc: 0.222
Validation loss decreased (-0.144427 --> -0.222205).  Saving model ...
Epoch: 6 cost time: 0.620685338973999
Epoch: 6, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.688 Vali Acc: 0.322 Test Loss: 1.688 Test Acc: 0.322
Validation loss decreased (-0.222205 --> -0.322205).  Saving model ...
Epoch: 7 cost time: 0.6077103614807129
Epoch: 7, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.627 Vali Acc: 0.381 Test Loss: 1.627 Test Acc: 0.381
Validation loss decreased (-0.322205 --> -0.381465).  Saving model ...
Epoch: 8 cost time: 0.6931970119476318
Epoch: 8, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.564 Vali Acc: 0.507 Test Loss: 1.564 Test Acc: 0.507
Validation loss decreased (-0.381465 --> -0.507392).  Saving model ...
Epoch: 9 cost time: 0.6453616619110107
Epoch: 9, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.493 Vali Acc: 0.619 Test Loss: 1.493 Test Acc: 0.619
Validation loss decreased (-0.507392 --> -0.618504).  Saving model ...
Epoch: 10 cost time: 0.6172521114349365
Epoch: 10, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.420 Vali Acc: 0.681 Test Loss: 1.420 Test Acc: 0.681
Validation loss decreased (-0.618504 --> -0.681467).  Saving model ...
Epoch: 11 cost time: 0.7626452445983887
Epoch: 11, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.349 Vali Acc: 0.719 Test Loss: 1.349 Test Acc: 0.719
Validation loss decreased (-0.681467 --> -0.718505).  Saving model ...
Epoch: 12 cost time: 0.6275129318237305
Epoch: 12, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.278 Vali Acc: 0.781 Test Loss: 1.278 Test Acc: 0.781
Validation loss decreased (-0.718505 --> -0.781469).  Saving model ...
Epoch: 13 cost time: 0.7506365776062012
Epoch: 13, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.210 Vali Acc: 0.811 Test Loss: 1.210 Test Acc: 0.811
Validation loss decreased (-0.781469 --> -0.811099).  Saving model ...
Epoch: 14 cost time: 0.5823636054992676
Epoch: 14, Steps: 2 | Train Loss: 1.125 Vali Loss: 1.144 Vali Acc: 0.830 Test Loss: 1.144 Test Acc: 0.830
Validation loss decreased (-0.811099 --> -0.829618).  Saving model ...
Epoch: 15 cost time: 0.6195840835571289
Epoch: 15, Steps: 2 | Train Loss: 0.999 Vali Loss: 1.078 Vali Acc: 0.863 Test Loss: 1.078 Test Acc: 0.863
Validation loss decreased (-0.829618 --> -0.862952).  Saving model ...
Epoch: 16 cost time: 0.7542304992675781
Epoch: 16, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.012 Vali Acc: 0.874 Test Loss: 1.012 Test Acc: 0.874
Validation loss decreased (-0.862952 --> -0.874064).  Saving model ...
Epoch: 17 cost time: 0.604058027267456
Epoch: 17, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.946 Vali Acc: 0.893 Test Loss: 0.946 Test Acc: 0.893
Validation loss decreased (-0.874064 --> -0.892583).  Saving model ...
Epoch: 18 cost time: 0.5997214317321777
Epoch: 18, Steps: 2 | Train Loss: 0.796 Vali Loss: 0.883 Vali Acc: 0.904 Test Loss: 0.883 Test Acc: 0.904
Validation loss decreased (-0.892583 --> -0.903695).  Saving model ...
Epoch: 19 cost time: 0.6760671138763428
Epoch: 19, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.821 Vali Acc: 0.907 Test Loss: 0.821 Test Acc: 0.907
Validation loss decreased (-0.903695 --> -0.907399).  Saving model ...
Epoch: 20 cost time: 0.6328082084655762
Epoch: 20, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.762 Vali Acc: 0.911 Test Loss: 0.762 Test Acc: 0.911
Validation loss decreased (-0.907399 --> -0.911103).  Saving model ...
Epoch: 21 cost time: 0.5734536647796631
Epoch: 21, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.705 Vali Acc: 0.922 Test Loss: 0.705 Test Acc: 0.922
Validation loss decreased (-0.911103 --> -0.922215).  Saving model ...
Epoch: 22 cost time: 0.6457030773162842
Epoch: 22, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.649 Vali Acc: 0.941 Test Loss: 0.649 Test Acc: 0.941
Validation loss decreased (-0.922215 --> -0.940734).  Saving model ...
Epoch: 23 cost time: 0.5284969806671143
Epoch: 23, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.600 Vali Acc: 0.944 Test Loss: 0.600 Test Acc: 0.944
Validation loss decreased (-0.940734 --> -0.944438).  Saving model ...
Epoch: 24 cost time: 0.7108509540557861
Epoch: 24, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.554 Vali Acc: 0.941 Test Loss: 0.554 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6468079090118408
Epoch: 25, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.510 Vali Acc: 0.956 Test Loss: 0.510 Test Acc: 0.956
Validation loss decreased (-0.944438 --> -0.955550).  Saving model ...
Epoch: 26 cost time: 0.6875574588775635
Epoch: 26, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.471 Vali Acc: 0.956 Test Loss: 0.471 Test Acc: 0.956
Validation loss decreased (-0.955550 --> -0.955551).  Saving model ...
Epoch: 27 cost time: 0.6762425899505615
Epoch: 27, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.436 Vali Acc: 0.941 Test Loss: 0.436 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6031994819641113
Epoch: 28, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.404 Vali Acc: 0.944 Test Loss: 0.404 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6525673866271973
Epoch: 29, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.372 Vali Acc: 0.948 Test Loss: 0.372 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6133129596710205
Epoch: 30, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.343 Vali Acc: 0.956 Test Loss: 0.343 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955552).  Saving model ...
Epoch: 31 cost time: 0.5909848213195801
Epoch: 31, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.318 Vali Acc: 0.952 Test Loss: 0.318 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6474764347076416
Epoch: 32, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.297 Vali Acc: 0.952 Test Loss: 0.297 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7369215488433838
Epoch: 33, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.278 Vali Acc: 0.956 Test Loss: 0.278 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 34 cost time: 0.666517972946167
Epoch: 34, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.260 Vali Acc: 0.959 Test Loss: 0.260 Test Acc: 0.959
Validation loss decreased (-0.955553 --> -0.959257).  Saving model ...
Epoch: 35 cost time: 0.7938826084136963
Epoch: 35, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.250 Vali Acc: 0.956 Test Loss: 0.250 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7072315216064453
Epoch: 36, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6113574504852295
Epoch: 37, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6623501777648926
Epoch: 38, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6924364566802979
Epoch: 39, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6205477714538574
Epoch: 40, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6940040588378906
Epoch: 41, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7557437419891357
Epoch: 42, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.6612598896026611
Epoch: 43, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.6235120296478271
Epoch: 44, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 1023518
model size : 6.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.368638277053833
Epoch: 1, Steps: 2 | Train Loss: 1.993 Vali Loss: 1.943 Vali Acc: 0.219 Test Loss: 1.943 Test Acc: 0.219
Validation loss decreased (inf --> -0.218499).  Saving model ...
Epoch: 2 cost time: 0.602247953414917
Epoch: 2, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.891 Vali Acc: 0.274 Test Loss: 1.891 Test Acc: 0.274
Validation loss decreased (-0.218499 --> -0.274055).  Saving model ...
Epoch: 3 cost time: 0.5551414489746094
Epoch: 3, Steps: 2 | Train Loss: 1.843 Vali Loss: 1.847 Vali Acc: 0.341 Test Loss: 1.847 Test Acc: 0.341
Validation loss decreased (-0.274055 --> -0.340722).  Saving model ...
Epoch: 4 cost time: 0.5595963001251221
Epoch: 4, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.796 Vali Acc: 0.385 Test Loss: 1.796 Test Acc: 0.385
Validation loss decreased (-0.340722 --> -0.385167).  Saving model ...
Epoch: 5 cost time: 0.6044259071350098
Epoch: 5, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.742 Vali Acc: 0.437 Test Loss: 1.742 Test Acc: 0.437
Validation loss decreased (-0.385167 --> -0.437020).  Saving model ...
Epoch: 6 cost time: 0.6186695098876953
Epoch: 6, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.686 Vali Acc: 0.456 Test Loss: 1.686 Test Acc: 0.456
Validation loss decreased (-0.437020 --> -0.455539).  Saving model ...
Epoch: 7 cost time: 0.6551187038421631
Epoch: 7, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.627 Vali Acc: 0.426 Test Loss: 1.627 Test Acc: 0.426
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7699093818664551
Epoch: 8, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.566 Vali Acc: 0.411 Test Loss: 1.566 Test Acc: 0.411
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6438882350921631
Epoch: 9, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.501 Vali Acc: 0.559 Test Loss: 1.501 Test Acc: 0.559
Validation loss decreased (-0.455539 --> -0.559244).  Saving model ...
Epoch: 10 cost time: 0.6229248046875
Epoch: 10, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.431 Vali Acc: 0.667 Test Loss: 1.431 Test Acc: 0.667
Validation loss decreased (-0.559244 --> -0.666652).  Saving model ...
Epoch: 11 cost time: 0.5580687522888184
Epoch: 11, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.362 Vali Acc: 0.715 Test Loss: 1.362 Test Acc: 0.715
Validation loss decreased (-0.666652 --> -0.714801).  Saving model ...
Epoch: 12 cost time: 0.741523265838623
Epoch: 12, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.292 Vali Acc: 0.781 Test Loss: 1.292 Test Acc: 0.781
Validation loss decreased (-0.714801 --> -0.781469).  Saving model ...
Epoch: 13 cost time: 0.6354596614837646
Epoch: 13, Steps: 2 | Train Loss: 1.224 Vali Loss: 1.221 Vali Acc: 0.841 Test Loss: 1.221 Test Acc: 0.841
Validation loss decreased (-0.781469 --> -0.840729).  Saving model ...
Epoch: 14 cost time: 0.5824873447418213
Epoch: 14, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.148 Vali Acc: 0.878 Test Loss: 1.148 Test Acc: 0.878
Validation loss decreased (-0.840729 --> -0.877766).  Saving model ...
Epoch: 15 cost time: 0.5761620998382568
Epoch: 15, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.079 Vali Acc: 0.889 Test Loss: 1.079 Test Acc: 0.889
Validation loss decreased (-0.877766 --> -0.888878).  Saving model ...
Epoch: 16 cost time: 0.6726315021514893
Epoch: 16, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.012 Vali Acc: 0.889 Test Loss: 1.012 Test Acc: 0.889
Validation loss decreased (-0.888878 --> -0.888879).  Saving model ...
Epoch: 17 cost time: 0.6433305740356445
Epoch: 17, Steps: 2 | Train Loss: 0.920 Vali Loss: 0.944 Vali Acc: 0.889 Test Loss: 0.944 Test Acc: 0.889
Validation loss decreased (-0.888879 --> -0.888879).  Saving model ...
Epoch: 18 cost time: 0.6596689224243164
Epoch: 18, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.878 Vali Acc: 0.904 Test Loss: 0.878 Test Acc: 0.904
Validation loss decreased (-0.888879 --> -0.903695).  Saving model ...
Epoch: 19 cost time: 0.6184890270233154
Epoch: 19, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.816 Vali Acc: 0.937 Test Loss: 0.816 Test Acc: 0.937
Validation loss decreased (-0.903695 --> -0.937029).  Saving model ...
Epoch: 20 cost time: 0.5538308620452881
Epoch: 20, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.757 Vali Acc: 0.937 Test Loss: 0.757 Test Acc: 0.937
Validation loss decreased (-0.937029 --> -0.937029).  Saving model ...
Epoch: 21 cost time: 0.6070349216461182
Epoch: 21, Steps: 2 | Train Loss: 0.631 Vali Loss: 0.701 Vali Acc: 0.930 Test Loss: 0.701 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6452038288116455
Epoch: 22, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.648 Vali Acc: 0.926 Test Loss: 0.648 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6314749717712402
Epoch: 23, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.595 Vali Acc: 0.944 Test Loss: 0.595 Test Acc: 0.944
Validation loss decreased (-0.937029 --> -0.944438).  Saving model ...
Epoch: 24 cost time: 0.6918282508850098
Epoch: 24, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.544 Vali Acc: 0.956 Test Loss: 0.544 Test Acc: 0.956
Validation loss decreased (-0.944438 --> -0.955550).  Saving model ...
Epoch: 25 cost time: 0.6497156620025635
Epoch: 25, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.502 Vali Acc: 0.952 Test Loss: 0.502 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.641801118850708
Epoch: 26, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.465 Vali Acc: 0.944 Test Loss: 0.465 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6212828159332275
Epoch: 27, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.426 Vali Acc: 0.952 Test Loss: 0.426 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5603237152099609
Epoch: 28, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.389 Vali Acc: 0.952 Test Loss: 0.389 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6916930675506592
Epoch: 29, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.362 Vali Acc: 0.948 Test Loss: 0.362 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5277938842773438
Epoch: 30, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.335 Vali Acc: 0.948 Test Loss: 0.335 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6554083824157715
Epoch: 31, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.313 Vali Acc: 0.948 Test Loss: 0.313 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.556175708770752
Epoch: 32, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.295 Vali Acc: 0.944 Test Loss: 0.295 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6222565174102783
Epoch: 33, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.280 Vali Acc: 0.933 Test Loss: 0.280 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5717778205871582
Epoch: 34, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 1022750
model size : 6.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.898862361907959
Epoch: 1, Steps: 2 | Train Loss: 2.110 Vali Loss: 2.004 Vali Acc: 0.178 Test Loss: 2.004 Test Acc: 0.178
Validation loss decreased (inf --> -0.177758).  Saving model ...
Epoch: 2 cost time: 0.6549181938171387
Epoch: 2, Steps: 2 | Train Loss: 1.961 Vali Loss: 1.950 Vali Acc: 0.196 Test Loss: 1.950 Test Acc: 0.196
Validation loss decreased (-0.177758 --> -0.196277).  Saving model ...
Epoch: 3 cost time: 0.5538461208343506
Epoch: 3, Steps: 2 | Train Loss: 1.957 Vali Loss: 1.906 Vali Acc: 0.215 Test Loss: 1.906 Test Acc: 0.215
Validation loss decreased (-0.196277 --> -0.214796).  Saving model ...
Epoch: 4 cost time: 0.6822404861450195
Epoch: 4, Steps: 2 | Train Loss: 1.974 Vali Loss: 1.860 Vali Acc: 0.244 Test Loss: 1.860 Test Acc: 0.244
Validation loss decreased (-0.214796 --> -0.244426).  Saving model ...
Epoch: 5 cost time: 0.5977029800415039
Epoch: 5, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.810 Vali Acc: 0.285 Test Loss: 1.810 Test Acc: 0.285
Validation loss decreased (-0.244426 --> -0.285167).  Saving model ...
Epoch: 6 cost time: 0.6414585113525391
Epoch: 6, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.761 Vali Acc: 0.252 Test Loss: 1.761 Test Acc: 0.252
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6862633228302002
Epoch: 7, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.709 Vali Acc: 0.252 Test Loss: 1.709 Test Acc: 0.252
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7620339393615723
Epoch: 8, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.653 Vali Acc: 0.337 Test Loss: 1.653 Test Acc: 0.337
Validation loss decreased (-0.285167 --> -0.337021).  Saving model ...
Epoch: 9 cost time: 0.5503153800964355
Epoch: 9, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.588 Vali Acc: 0.459 Test Loss: 1.588 Test Acc: 0.459
Validation loss decreased (-0.337021 --> -0.459243).  Saving model ...
Epoch: 10 cost time: 0.6174430847167969
Epoch: 10, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.516 Vali Acc: 0.544 Test Loss: 1.516 Test Acc: 0.544
Validation loss decreased (-0.459243 --> -0.544429).  Saving model ...
Epoch: 11 cost time: 0.5799758434295654
Epoch: 11, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.442 Vali Acc: 0.611 Test Loss: 1.442 Test Acc: 0.611
Validation loss decreased (-0.544429 --> -0.611097).  Saving model ...
Epoch: 12 cost time: 0.5911767482757568
Epoch: 12, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.369 Vali Acc: 0.696 Test Loss: 1.369 Test Acc: 0.696
Validation loss decreased (-0.611097 --> -0.696283).  Saving model ...
Epoch: 13 cost time: 0.6401617527008057
Epoch: 13, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.296 Vali Acc: 0.733 Test Loss: 1.296 Test Acc: 0.733
Validation loss decreased (-0.696283 --> -0.733320).  Saving model ...
Epoch: 14 cost time: 0.5535190105438232
Epoch: 14, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.221 Vali Acc: 0.793 Test Loss: 1.221 Test Acc: 0.793
Validation loss decreased (-0.733320 --> -0.792580).  Saving model ...
Epoch: 15 cost time: 0.7790586948394775
Epoch: 15, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.146 Vali Acc: 0.837 Test Loss: 1.146 Test Acc: 0.837
Validation loss decreased (-0.792580 --> -0.837026).  Saving model ...
Epoch: 16 cost time: 0.6105501651763916
Epoch: 16, Steps: 2 | Train Loss: 1.016 Vali Loss: 1.075 Vali Acc: 0.859 Test Loss: 1.075 Test Acc: 0.859
Validation loss decreased (-0.837026 --> -0.859249).  Saving model ...
Epoch: 17 cost time: 0.6094210147857666
Epoch: 17, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.006 Vali Acc: 0.885 Test Loss: 1.006 Test Acc: 0.885
Validation loss decreased (-0.859249 --> -0.885175).  Saving model ...
Epoch: 18 cost time: 0.5726878643035889
Epoch: 18, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.938 Vali Acc: 0.893 Test Loss: 0.938 Test Acc: 0.893
Validation loss decreased (-0.885175 --> -0.892583).  Saving model ...
Epoch: 19 cost time: 0.6566982269287109
Epoch: 19, Steps: 2 | Train Loss: 0.791 Vali Loss: 0.871 Vali Acc: 0.907 Test Loss: 0.871 Test Acc: 0.907
Validation loss decreased (-0.892583 --> -0.907399).  Saving model ...
Epoch: 20 cost time: 0.6171140670776367
Epoch: 20, Steps: 2 | Train Loss: 0.714 Vali Loss: 0.807 Vali Acc: 0.911 Test Loss: 0.807 Test Acc: 0.911
Validation loss decreased (-0.907399 --> -0.911103).  Saving model ...
Epoch: 21 cost time: 0.5254766941070557
Epoch: 21, Steps: 2 | Train Loss: 0.637 Vali Loss: 0.747 Vali Acc: 0.911 Test Loss: 0.747 Test Acc: 0.911
Validation loss decreased (-0.911103 --> -0.911104).  Saving model ...
Epoch: 22 cost time: 0.584928035736084
Epoch: 22, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.692 Vali Acc: 0.904 Test Loss: 0.692 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8152642250061035
Epoch: 23, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.634 Vali Acc: 0.919 Test Loss: 0.634 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918512).  Saving model ...
Epoch: 24 cost time: 0.6198937892913818
Epoch: 24, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.580 Vali Acc: 0.919 Test Loss: 0.580 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 25 cost time: 0.6991734504699707
Epoch: 25, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.532 Vali Acc: 0.926 Test Loss: 0.532 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 26 cost time: 0.6366016864776611
Epoch: 26, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.488 Vali Acc: 0.930 Test Loss: 0.488 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 27 cost time: 0.5978779792785645
Epoch: 27, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.450 Vali Acc: 0.930 Test Loss: 0.450 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 28 cost time: 0.5304341316223145
Epoch: 28, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.411 Vali Acc: 0.944 Test Loss: 0.411 Test Acc: 0.944
Validation loss decreased (-0.929625 --> -0.944440).  Saving model ...
Epoch: 29 cost time: 0.773871898651123
Epoch: 29, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.378 Vali Acc: 0.948 Test Loss: 0.378 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 30 cost time: 0.5366346836090088
Epoch: 30, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.353 Vali Acc: 0.944 Test Loss: 0.353 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.583909273147583
Epoch: 31, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.330 Vali Acc: 0.944 Test Loss: 0.330 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6996011734008789
Epoch: 32, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.307 Vali Acc: 0.948 Test Loss: 0.307 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 33 cost time: 0.5321083068847656
Epoch: 33, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.288 Vali Acc: 0.952 Test Loss: 0.288 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.6107861995697021
Epoch: 34, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.269 Vali Acc: 0.952 Test Loss: 0.269 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.6854681968688965
Epoch: 35, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.256 Vali Acc: 0.956 Test Loss: 0.256 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 36 cost time: 0.5586202144622803
Epoch: 36, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 37 cost time: 0.6227240562438965
Epoch: 37, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.233 Vali Acc: 0.956 Test Loss: 0.233 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 38 cost time: 0.6090695858001709
Epoch: 38, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.227 Vali Acc: 0.956 Test Loss: 0.227 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 39 cost time: 0.574838399887085
Epoch: 39, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6159634590148926
Epoch: 40, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.219 Vali Acc: 0.948 Test Loss: 0.219 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5975816249847412
Epoch: 41, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.613166332244873
Epoch: 42, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6303462982177734
Epoch: 43, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6609628200531006
Epoch: 44, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6246535778045654
Epoch: 45, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6204214096069336
Epoch: 46, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.7477483749389648
Epoch: 47, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6713924407958984
Epoch: 48, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 1021982
model size : 6.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7057719230651855
Epoch: 1, Steps: 2 | Train Loss: 2.108 Vali Loss: 1.991 Vali Acc: 0.170 Test Loss: 1.991 Test Acc: 0.170
Validation loss decreased (inf --> -0.170350).  Saving model ...
Epoch: 2 cost time: 0.8104262351989746
Epoch: 2, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.939 Vali Acc: 0.159 Test Loss: 1.939 Test Acc: 0.159
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.8113100528717041
Epoch: 3, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.895 Vali Acc: 0.167 Test Loss: 1.895 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7815682888031006
Epoch: 4, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.847 Vali Acc: 0.196 Test Loss: 1.847 Test Acc: 0.196
Validation loss decreased (-0.170350 --> -0.196278).  Saving model ...
Epoch: 5 cost time: 0.9236228466033936
Epoch: 5, Steps: 2 | Train Loss: 1.898 Vali Loss: 1.793 Vali Acc: 0.215 Test Loss: 1.793 Test Acc: 0.215
Validation loss decreased (-0.196278 --> -0.214797).  Saving model ...
Epoch: 6 cost time: 0.691678524017334
Epoch: 6, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.739 Vali Acc: 0.281 Test Loss: 1.739 Test Acc: 0.281
Validation loss decreased (-0.214797 --> -0.281464).  Saving model ...
Epoch: 7 cost time: 0.6022806167602539
Epoch: 7, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.688 Vali Acc: 0.337 Test Loss: 1.688 Test Acc: 0.337
Validation loss decreased (-0.281464 --> -0.337020).  Saving model ...
Epoch: 8 cost time: 0.606703519821167
Epoch: 8, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.637 Vali Acc: 0.437 Test Loss: 1.637 Test Acc: 0.437
Validation loss decreased (-0.337020 --> -0.437021).  Saving model ...
Epoch: 9 cost time: 0.7181315422058105
Epoch: 9, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.579 Vali Acc: 0.496 Test Loss: 1.579 Test Acc: 0.496
Validation loss decreased (-0.437021 --> -0.496281).  Saving model ...
Epoch: 10 cost time: 0.6186516284942627
Epoch: 10, Steps: 2 | Train Loss: 1.517 Vali Loss: 1.507 Vali Acc: 0.507 Test Loss: 1.507 Test Acc: 0.507
Validation loss decreased (-0.496281 --> -0.507392).  Saving model ...
Epoch: 11 cost time: 0.6305081844329834
Epoch: 11, Steps: 2 | Train Loss: 1.425 Vali Loss: 1.431 Vali Acc: 0.574 Test Loss: 1.431 Test Acc: 0.574
Validation loss decreased (-0.507392 --> -0.574060).  Saving model ...
Epoch: 12 cost time: 1.0518534183502197
Epoch: 12, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.359 Vali Acc: 0.667 Test Loss: 1.359 Test Acc: 0.667
Validation loss decreased (-0.574060 --> -0.666653).  Saving model ...
Epoch: 13 cost time: 0.6676783561706543
Epoch: 13, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.287 Vali Acc: 0.726 Test Loss: 1.287 Test Acc: 0.726
Validation loss decreased (-0.666653 --> -0.725913).  Saving model ...
Epoch: 14 cost time: 0.5814428329467773
Epoch: 14, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.217 Vali Acc: 0.800 Test Loss: 1.217 Test Acc: 0.800
Validation loss decreased (-0.725913 --> -0.799988).  Saving model ...
Epoch: 15 cost time: 0.6299901008605957
Epoch: 15, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.146 Vali Acc: 0.807 Test Loss: 1.146 Test Acc: 0.807
Validation loss decreased (-0.799988 --> -0.807396).  Saving model ...
Epoch: 16 cost time: 0.6217660903930664
Epoch: 16, Steps: 2 | Train Loss: 1.055 Vali Loss: 1.078 Vali Acc: 0.852 Test Loss: 1.078 Test Acc: 0.852
Validation loss decreased (-0.807396 --> -0.851841).  Saving model ...
Epoch: 17 cost time: 0.6356265544891357
Epoch: 17, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.008 Vali Acc: 0.870 Test Loss: 1.008 Test Acc: 0.870
Validation loss decreased (-0.851841 --> -0.870360).  Saving model ...
Epoch: 18 cost time: 1.0428364276885986
Epoch: 18, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.941 Vali Acc: 0.885 Test Loss: 0.941 Test Acc: 0.885
Validation loss decreased (-0.870360 --> -0.885176).  Saving model ...
Epoch: 19 cost time: 0.8016629219055176
Epoch: 19, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.877 Vali Acc: 0.874 Test Loss: 0.877 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7038102149963379
Epoch: 20, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.816 Vali Acc: 0.889 Test Loss: 0.816 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888881).  Saving model ...
Epoch: 21 cost time: 0.7401533126831055
Epoch: 21, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.759 Vali Acc: 0.889 Test Loss: 0.759 Test Acc: 0.889
Validation loss decreased (-0.888881 --> -0.888881).  Saving model ...
Epoch: 22 cost time: 0.5310521125793457
Epoch: 22, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.704 Vali Acc: 0.900 Test Loss: 0.704 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899993).  Saving model ...
Epoch: 23 cost time: 0.7492647171020508
Epoch: 23, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.653 Vali Acc: 0.911 Test Loss: 0.653 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.911105).  Saving model ...
Epoch: 24 cost time: 0.6276156902313232
Epoch: 24, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.606 Vali Acc: 0.911 Test Loss: 0.606 Test Acc: 0.911
Validation loss decreased (-0.911105 --> -0.911105).  Saving model ...
Epoch: 25 cost time: 0.7027587890625
Epoch: 25, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.562 Vali Acc: 0.919 Test Loss: 0.562 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 26 cost time: 0.6425251960754395
Epoch: 26, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.521 Vali Acc: 0.926 Test Loss: 0.521 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 27 cost time: 0.561063289642334
Epoch: 27, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.482 Vali Acc: 0.933 Test Loss: 0.482 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 28 cost time: 0.5753552913665771
Epoch: 28, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.448 Vali Acc: 0.926 Test Loss: 0.448 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6991982460021973
Epoch: 29, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.419 Vali Acc: 0.930 Test Loss: 0.419 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6644976139068604
Epoch: 30, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.393 Vali Acc: 0.926 Test Loss: 0.393 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7290937900543213
Epoch: 31, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.373 Vali Acc: 0.922 Test Loss: 0.373 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8230817317962646
Epoch: 32, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.344 Vali Acc: 0.933 Test Loss: 0.344 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 33 cost time: 0.8716092109680176
Epoch: 33, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 34 cost time: 0.6644251346588135
Epoch: 34, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.6701314449310303
Epoch: 35, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5587730407714844
Epoch: 36, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.613717794418335
Epoch: 37, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7411081790924072
Epoch: 38, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0182874202728271
Epoch: 39, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8019614219665527
Epoch: 40, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6118309497833252
Epoch: 41, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.55137038230896
Epoch: 42, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.852747917175293
Epoch: 43, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8386285305023193
Epoch: 44, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 925598
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3122851848602295
Epoch: 1, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.856 Vali Acc: 0.200 Test Loss: 1.856 Test Acc: 0.200
Validation loss decreased (inf --> -0.199981).  Saving model ...
Epoch: 2 cost time: 0.7771785259246826
Epoch: 2, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.802 Vali Acc: 0.219 Test Loss: 1.802 Test Acc: 0.219
Validation loss decreased (-0.199981 --> -0.218500).  Saving model ...
Epoch: 3 cost time: 0.8089089393615723
Epoch: 3, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.760 Vali Acc: 0.278 Test Loss: 1.760 Test Acc: 0.278
Validation loss decreased (-0.218500 --> -0.277760).  Saving model ...
Epoch: 4 cost time: 0.6925992965698242
Epoch: 4, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.713 Vali Acc: 0.363 Test Loss: 1.713 Test Acc: 0.363
Validation loss decreased (-0.277760 --> -0.362946).  Saving model ...
Epoch: 5 cost time: 0.5753133296966553
Epoch: 5, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.661 Vali Acc: 0.441 Test Loss: 1.661 Test Acc: 0.441
Validation loss decreased (-0.362946 --> -0.440724).  Saving model ...
Epoch: 6 cost time: 0.5742583274841309
Epoch: 6, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.610 Vali Acc: 0.470 Test Loss: 1.610 Test Acc: 0.470
Validation loss decreased (-0.440724 --> -0.470354).  Saving model ...
Epoch: 7 cost time: 0.773871898651123
Epoch: 7, Steps: 2 | Train Loss: 1.606 Vali Loss: 1.560 Vali Acc: 0.515 Test Loss: 1.560 Test Acc: 0.515
Validation loss decreased (-0.470354 --> -0.514799).  Saving model ...
Epoch: 8 cost time: 0.5876903533935547
Epoch: 8, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.507 Vali Acc: 0.552 Test Loss: 1.507 Test Acc: 0.552
Validation loss decreased (-0.514799 --> -0.551837).  Saving model ...
Epoch: 9 cost time: 0.5832552909851074
Epoch: 9, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.447 Vali Acc: 0.619 Test Loss: 1.447 Test Acc: 0.619
Validation loss decreased (-0.551837 --> -0.618504).  Saving model ...
Epoch: 10 cost time: 0.568988561630249
Epoch: 10, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.380 Vali Acc: 0.689 Test Loss: 1.380 Test Acc: 0.689
Validation loss decreased (-0.618504 --> -0.688875).  Saving model ...
Epoch: 11 cost time: 0.5532596111297607
Epoch: 11, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.310 Vali Acc: 0.719 Test Loss: 1.310 Test Acc: 0.719
Validation loss decreased (-0.688875 --> -0.718505).  Saving model ...
Epoch: 12 cost time: 0.6544327735900879
Epoch: 12, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.240 Vali Acc: 0.789 Test Loss: 1.240 Test Acc: 0.789
Validation loss decreased (-0.718505 --> -0.788876).  Saving model ...
Epoch: 13 cost time: 0.6477916240692139
Epoch: 13, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.173 Vali Acc: 0.789 Test Loss: 1.173 Test Acc: 0.789
Validation loss decreased (-0.788876 --> -0.788877).  Saving model ...
Epoch: 14 cost time: 0.7945654392242432
Epoch: 14, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.109 Vali Acc: 0.804 Test Loss: 1.109 Test Acc: 0.804
Validation loss decreased (-0.788877 --> -0.803693).  Saving model ...
Epoch: 15 cost time: 0.6183505058288574
Epoch: 15, Steps: 2 | Train Loss: 0.985 Vali Loss: 1.048 Vali Acc: 0.822 Test Loss: 1.048 Test Acc: 0.822
Validation loss decreased (-0.803693 --> -0.822212).  Saving model ...
Epoch: 16 cost time: 0.5447227954864502
Epoch: 16, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.987 Vali Acc: 0.844 Test Loss: 0.987 Test Acc: 0.844
Validation loss decreased (-0.822212 --> -0.844435).  Saving model ...
Epoch: 17 cost time: 0.5919902324676514
Epoch: 17, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.921 Vali Acc: 0.893 Test Loss: 0.921 Test Acc: 0.893
Validation loss decreased (-0.844435 --> -0.892583).  Saving model ...
Epoch: 18 cost time: 0.5338320732116699
Epoch: 18, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.857 Vali Acc: 0.896 Test Loss: 0.857 Test Acc: 0.896
Validation loss decreased (-0.892583 --> -0.896288).  Saving model ...
Epoch: 19 cost time: 0.5517618656158447
Epoch: 19, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.797 Vali Acc: 0.915 Test Loss: 0.797 Test Acc: 0.915
Validation loss decreased (-0.896288 --> -0.914807).  Saving model ...
Epoch: 20 cost time: 0.6348445415496826
Epoch: 20, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.739 Vali Acc: 0.922 Test Loss: 0.739 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922215).  Saving model ...
Epoch: 21 cost time: 0.689845085144043
Epoch: 21, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.688 Vali Acc: 0.915 Test Loss: 0.688 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6146621704101562
Epoch: 22, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.637 Vali Acc: 0.937 Test Loss: 0.637 Test Acc: 0.937
Validation loss decreased (-0.922215 --> -0.937031).  Saving model ...
Epoch: 23 cost time: 0.5609512329101562
Epoch: 23, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.589 Vali Acc: 0.948 Test Loss: 0.589 Test Acc: 0.948
Validation loss decreased (-0.937031 --> -0.948142).  Saving model ...
Epoch: 24 cost time: 0.605400800704956
Epoch: 24, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.547 Vali Acc: 0.944 Test Loss: 0.547 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5581858158111572
Epoch: 25, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.506 Vali Acc: 0.941 Test Loss: 0.506 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6241810321807861
Epoch: 26, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.470 Vali Acc: 0.933 Test Loss: 0.470 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6554985046386719
Epoch: 27, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.435 Vali Acc: 0.937 Test Loss: 0.435 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.763507604598999
Epoch: 28, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.407 Vali Acc: 0.941 Test Loss: 0.407 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6043844223022461
Epoch: 29, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.376 Vali Acc: 0.944 Test Loss: 0.376 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5663683414459229
Epoch: 30, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.349 Vali Acc: 0.948 Test Loss: 0.349 Test Acc: 0.948
Validation loss decreased (-0.948142 --> -0.948145).  Saving model ...
Epoch: 31 cost time: 0.5107808113098145
Epoch: 31, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.323 Vali Acc: 0.948 Test Loss: 0.323 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 0.5586297512054443
Epoch: 32, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.301 Vali Acc: 0.956 Test Loss: 0.301 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955553).  Saving model ...
Epoch: 33 cost time: 0.55283522605896
Epoch: 33, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.285 Vali Acc: 0.956 Test Loss: 0.285 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 34 cost time: 0.6731219291687012
Epoch: 34, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.270 Vali Acc: 0.956 Test Loss: 0.270 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 35 cost time: 0.7360455989837646
Epoch: 35, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.255 Vali Acc: 0.956 Test Loss: 0.255 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 36 cost time: 0.722797155380249
Epoch: 36, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.243 Vali Acc: 0.956 Test Loss: 0.243 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 37 cost time: 0.6816377639770508
Epoch: 37, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.234 Vali Acc: 0.956 Test Loss: 0.234 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 38 cost time: 0.602102518081665
Epoch: 38, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.226 Vali Acc: 0.956 Test Loss: 0.226 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 39 cost time: 0.625737190246582
Epoch: 39, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.221 Vali Acc: 0.952 Test Loss: 0.221 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6430151462554932
Epoch: 40, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.9435510635375977
Epoch: 41, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6476233005523682
Epoch: 42, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6419143676757812
Epoch: 43, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7237727642059326
Epoch: 44, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.5905814170837402
Epoch: 45, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5969972610473633
Epoch: 46, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6139359474182129
Epoch: 47, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.591649055480957
Epoch: 48, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 924830
model size : 6.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.272794008255005
Epoch: 1, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.755 Vali Acc: 0.233 Test Loss: 1.755 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 0.6717357635498047
Epoch: 2, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.728 Vali Acc: 0.281 Test Loss: 1.728 Test Acc: 0.281
Validation loss decreased (-0.233316 --> -0.281464).  Saving model ...
Epoch: 3 cost time: 0.5691423416137695
Epoch: 3, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.702 Vali Acc: 0.322 Test Loss: 1.702 Test Acc: 0.322
Validation loss decreased (-0.281464 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 0.7289524078369141
Epoch: 4, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.672 Vali Acc: 0.367 Test Loss: 1.672 Test Acc: 0.367
Validation loss decreased (-0.322205 --> -0.366650).  Saving model ...
Epoch: 5 cost time: 0.5919249057769775
Epoch: 5, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.633 Vali Acc: 0.422 Test Loss: 1.633 Test Acc: 0.422
Validation loss decreased (-0.366650 --> -0.422206).  Saving model ...
Epoch: 6 cost time: 0.49406981468200684
Epoch: 6, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.587 Vali Acc: 0.496 Test Loss: 1.587 Test Acc: 0.496
Validation loss decreased (-0.422206 --> -0.496280).  Saving model ...
Epoch: 7 cost time: 0.6154396533966064
Epoch: 7, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.536 Vali Acc: 0.578 Test Loss: 1.536 Test Acc: 0.578
Validation loss decreased (-0.496280 --> -0.577762).  Saving model ...
Epoch: 8 cost time: 0.46837520599365234
Epoch: 8, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.480 Vali Acc: 0.622 Test Loss: 1.480 Test Acc: 0.622
Validation loss decreased (-0.577762 --> -0.622207).  Saving model ...
Epoch: 9 cost time: 0.5364274978637695
Epoch: 9, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.422 Vali Acc: 0.652 Test Loss: 1.422 Test Acc: 0.652
Validation loss decreased (-0.622207 --> -0.651838).  Saving model ...
Epoch: 10 cost time: 0.7137854099273682
Epoch: 10, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.363 Vali Acc: 0.685 Test Loss: 1.363 Test Acc: 0.685
Validation loss decreased (-0.651838 --> -0.685172).  Saving model ...
Epoch: 11 cost time: 0.6655664443969727
Epoch: 11, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.299 Vali Acc: 0.707 Test Loss: 1.299 Test Acc: 0.707
Validation loss decreased (-0.685172 --> -0.707394).  Saving model ...
Epoch: 12 cost time: 0.6183485984802246
Epoch: 12, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.235 Vali Acc: 0.741 Test Loss: 1.235 Test Acc: 0.741
Validation loss decreased (-0.707394 --> -0.740728).  Saving model ...
Epoch: 13 cost time: 0.6050076484680176
Epoch: 13, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.169 Vali Acc: 0.763 Test Loss: 1.169 Test Acc: 0.763
Validation loss decreased (-0.740728 --> -0.762951).  Saving model ...
Epoch: 14 cost time: 0.6164605617523193
Epoch: 14, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.104 Vali Acc: 0.789 Test Loss: 1.104 Test Acc: 0.789
Validation loss decreased (-0.762951 --> -0.788878).  Saving model ...
Epoch: 15 cost time: 0.4918069839477539
Epoch: 15, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.040 Vali Acc: 0.819 Test Loss: 1.040 Test Acc: 0.819
Validation loss decreased (-0.788878 --> -0.818508).  Saving model ...
Epoch: 16 cost time: 0.5917465686798096
Epoch: 16, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.977 Vali Acc: 0.830 Test Loss: 0.977 Test Acc: 0.830
Validation loss decreased (-0.818508 --> -0.829620).  Saving model ...
Epoch: 17 cost time: 0.5799922943115234
Epoch: 17, Steps: 2 | Train Loss: 0.835 Vali Loss: 0.915 Vali Acc: 0.841 Test Loss: 0.915 Test Acc: 0.841
Validation loss decreased (-0.829620 --> -0.840732).  Saving model ...
Epoch: 18 cost time: 0.5537295341491699
Epoch: 18, Steps: 2 | Train Loss: 0.791 Vali Loss: 0.858 Vali Acc: 0.848 Test Loss: 0.858 Test Acc: 0.848
Validation loss decreased (-0.840732 --> -0.848140).  Saving model ...
Epoch: 19 cost time: 0.5790326595306396
Epoch: 19, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.802 Vali Acc: 0.844 Test Loss: 0.802 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7471749782562256
Epoch: 20, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.747 Vali Acc: 0.870 Test Loss: 0.747 Test Acc: 0.870
Validation loss decreased (-0.848140 --> -0.870363).  Saving model ...
Epoch: 21 cost time: 0.5173568725585938
Epoch: 21, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.693 Vali Acc: 0.893 Test Loss: 0.693 Test Acc: 0.893
Validation loss decreased (-0.870363 --> -0.892586).  Saving model ...
Epoch: 22 cost time: 0.627150297164917
Epoch: 22, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.639 Vali Acc: 0.911 Test Loss: 0.639 Test Acc: 0.911
Validation loss decreased (-0.892586 --> -0.911105).  Saving model ...
Epoch: 23 cost time: 0.6378397941589355
Epoch: 23, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.589 Vali Acc: 0.904 Test Loss: 0.589 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5774915218353271
Epoch: 24, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.545 Vali Acc: 0.907 Test Loss: 0.545 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6773161888122559
Epoch: 25, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.505 Vali Acc: 0.907 Test Loss: 0.505 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6669669151306152
Epoch: 26, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.471 Vali Acc: 0.907 Test Loss: 0.471 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.6931889057159424
Epoch: 27, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.430 Vali Acc: 0.926 Test Loss: 0.430 Test Acc: 0.926
Validation loss decreased (-0.911105 --> -0.925922).  Saving model ...
Epoch: 28 cost time: 0.7243242263793945
Epoch: 28, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.392 Vali Acc: 0.933 Test Loss: 0.392 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933329).  Saving model ...
Epoch: 29 cost time: 0.5620162487030029
Epoch: 29, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.363 Vali Acc: 0.941 Test Loss: 0.363 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 30 cost time: 0.6453280448913574
Epoch: 30, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.340 Vali Acc: 0.941 Test Loss: 0.340 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 31 cost time: 0.6547012329101562
Epoch: 31, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.323 Vali Acc: 0.944 Test Loss: 0.323 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 32 cost time: 0.5416693687438965
Epoch: 32, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.309 Vali Acc: 0.941 Test Loss: 0.309 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.634084939956665
Epoch: 33, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.291 Vali Acc: 0.937 Test Loss: 0.291 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6470046043395996
Epoch: 34, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.272 Vali Acc: 0.941 Test Loss: 0.272 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9053759574890137
Epoch: 35, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7415986061096191
Epoch: 36, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6275172233581543
Epoch: 37, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8961760997772217
Epoch: 38, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6118001937866211
Epoch: 39, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6597905158996582
Epoch: 40, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6878073215484619
Epoch: 41, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6423637866973877
Epoch: 42, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.696183443069458
Epoch: 43, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6918110847473145
Epoch: 44, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5926992893218994
Epoch: 45, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.5638124942779541
Epoch: 46, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7252843379974365
Epoch: 47, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7246255874633789
Epoch: 48, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.731907844543457
Epoch: 49, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 924062
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4197425842285156
Epoch: 1, Steps: 2 | Train Loss: 1.729 Vali Loss: 1.667 Vali Acc: 0.319 Test Loss: 1.667 Test Acc: 0.319
Validation loss decreased (inf --> -0.318502).  Saving model ...
Epoch: 2 cost time: 0.7041378021240234
Epoch: 2, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.640 Vali Acc: 0.344 Test Loss: 1.640 Test Acc: 0.344
Validation loss decreased (-0.318502 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 0.5807435512542725
Epoch: 3, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.614 Vali Acc: 0.393 Test Loss: 1.614 Test Acc: 0.393
Validation loss decreased (-0.344428 --> -0.392576).  Saving model ...
Epoch: 4 cost time: 0.5772206783294678
Epoch: 4, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.578 Vali Acc: 0.441 Test Loss: 1.578 Test Acc: 0.441
Validation loss decreased (-0.392576 --> -0.440725).  Saving model ...
Epoch: 5 cost time: 0.7228131294250488
Epoch: 5, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.536 Vali Acc: 0.522 Test Loss: 1.536 Test Acc: 0.522
Validation loss decreased (-0.440725 --> -0.522207).  Saving model ...
Epoch: 6 cost time: 0.5806996822357178
Epoch: 6, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.491 Vali Acc: 0.604 Test Loss: 1.491 Test Acc: 0.604
Validation loss decreased (-0.522207 --> -0.603689).  Saving model ...
Epoch: 7 cost time: 0.6234381198883057
Epoch: 7, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.445 Vali Acc: 0.685 Test Loss: 1.445 Test Acc: 0.685
Validation loss decreased (-0.603689 --> -0.685171).  Saving model ...
Epoch: 8 cost time: 0.7396247386932373
Epoch: 8, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.393 Vali Acc: 0.730 Test Loss: 1.393 Test Acc: 0.730
Validation loss decreased (-0.685171 --> -0.729616).  Saving model ...
Epoch: 9 cost time: 0.9688317775726318
Epoch: 9, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.335 Vali Acc: 0.763 Test Loss: 1.335 Test Acc: 0.763
Validation loss decreased (-0.729616 --> -0.762950).  Saving model ...
Epoch: 10 cost time: 0.7082722187042236
Epoch: 10, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.273 Vali Acc: 0.774 Test Loss: 1.273 Test Acc: 0.774
Validation loss decreased (-0.762950 --> -0.774061).  Saving model ...
Epoch: 11 cost time: 0.7595126628875732
Epoch: 11, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.210 Vali Acc: 0.796 Test Loss: 1.210 Test Acc: 0.796
Validation loss decreased (-0.774061 --> -0.796284).  Saving model ...
Epoch: 12 cost time: 0.7403488159179688
Epoch: 12, Steps: 2 | Train Loss: 1.174 Vali Loss: 1.146 Vali Acc: 0.804 Test Loss: 1.146 Test Acc: 0.804
Validation loss decreased (-0.796284 --> -0.803692).  Saving model ...
Epoch: 13 cost time: 0.7448954582214355
Epoch: 13, Steps: 2 | Train Loss: 1.024 Vali Loss: 1.085 Vali Acc: 0.815 Test Loss: 1.085 Test Acc: 0.815
Validation loss decreased (-0.803692 --> -0.814804).  Saving model ...
Epoch: 14 cost time: 0.7828371524810791
Epoch: 14, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.025 Vali Acc: 0.804 Test Loss: 1.025 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7653450965881348
Epoch: 15, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.964 Vali Acc: 0.833 Test Loss: 0.964 Test Acc: 0.833
Validation loss decreased (-0.814804 --> -0.833324).  Saving model ...
Epoch: 16 cost time: 1.0330207347869873
Epoch: 16, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.904 Vali Acc: 0.848 Test Loss: 0.904 Test Acc: 0.848
Validation loss decreased (-0.833324 --> -0.848139).  Saving model ...
Epoch: 17 cost time: 1.0025756359100342
Epoch: 17, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.845 Vali Acc: 0.863 Test Loss: 0.845 Test Acc: 0.863
Validation loss decreased (-0.848139 --> -0.862955).  Saving model ...
Epoch: 18 cost time: 0.9175665378570557
Epoch: 18, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.790 Vali Acc: 0.904 Test Loss: 0.790 Test Acc: 0.904
Validation loss decreased (-0.862955 --> -0.903696).  Saving model ...
Epoch: 19 cost time: 0.6451098918914795
Epoch: 19, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.738 Vali Acc: 0.926 Test Loss: 0.738 Test Acc: 0.926
Validation loss decreased (-0.903696 --> -0.925919).  Saving model ...
Epoch: 20 cost time: 0.6230225563049316
Epoch: 20, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.689 Vali Acc: 0.907 Test Loss: 0.689 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6092789173126221
Epoch: 21, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.643 Vali Acc: 0.926 Test Loss: 0.643 Test Acc: 0.926
Validation loss decreased (-0.925919 --> -0.925919).  Saving model ...
Epoch: 22 cost time: 0.6290121078491211
Epoch: 22, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.600 Vali Acc: 0.933 Test Loss: 0.600 Test Acc: 0.933
Validation loss decreased (-0.925919 --> -0.933327).  Saving model ...
Epoch: 23 cost time: 0.7398977279663086
Epoch: 23, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.558 Vali Acc: 0.941 Test Loss: 0.558 Test Acc: 0.941
Validation loss decreased (-0.933327 --> -0.940735).  Saving model ...
Epoch: 24 cost time: 0.6941702365875244
Epoch: 24, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.521 Vali Acc: 0.944 Test Loss: 0.521 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 25 cost time: 0.8175783157348633
Epoch: 25, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.486 Vali Acc: 0.941 Test Loss: 0.486 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6351954936981201
Epoch: 26, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.454 Vali Acc: 0.944 Test Loss: 0.454 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 27 cost time: 0.7857241630554199
Epoch: 27, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.424 Vali Acc: 0.937 Test Loss: 0.424 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.808870792388916
Epoch: 28, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.397 Vali Acc: 0.937 Test Loss: 0.397 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7830417156219482
Epoch: 29, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.369 Vali Acc: 0.941 Test Loss: 0.369 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7191970348358154
Epoch: 30, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.345 Vali Acc: 0.941 Test Loss: 0.345 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8030233383178711
Epoch: 31, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.320 Vali Acc: 0.948 Test Loss: 0.320 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 0.6666660308837891
Epoch: 32, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.300 Vali Acc: 0.956 Test Loss: 0.300 Test Acc: 0.956
Validation loss decreased (-0.948145 --> -0.955553).  Saving model ...
Epoch: 33 cost time: 0.851813793182373
Epoch: 33, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.284 Vali Acc: 0.948 Test Loss: 0.284 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5804717540740967
Epoch: 34, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6578307151794434
Epoch: 35, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7012405395507812
Epoch: 36, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6181740760803223
Epoch: 37, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7134134769439697
Epoch: 38, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.7530598640441895
Epoch: 39, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5947692394256592
Epoch: 40, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5566601753234863
Epoch: 41, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5895919799804688
Epoch: 42, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 923294
model size : 6.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.125077962875366
Epoch: 1, Steps: 2 | Train Loss: 1.879 Vali Loss: 1.865 Vali Acc: 0.181 Test Loss: 1.865 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.6350686550140381
Epoch: 2, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.827 Vali Acc: 0.196 Test Loss: 1.827 Test Acc: 0.196
Validation loss decreased (-0.181463 --> -0.196278).  Saving model ...
Epoch: 3 cost time: 0.5315444469451904
Epoch: 3, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.797 Vali Acc: 0.226 Test Loss: 1.797 Test Acc: 0.226
Validation loss decreased (-0.196278 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.5823864936828613
Epoch: 4, Steps: 2 | Train Loss: 1.898 Vali Loss: 1.764 Vali Acc: 0.248 Test Loss: 1.764 Test Acc: 0.248
Validation loss decreased (-0.225908 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 0.5355038642883301
Epoch: 5, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.727 Vali Acc: 0.293 Test Loss: 1.727 Test Acc: 0.293
Validation loss decreased (-0.248131 --> -0.292575).  Saving model ...
Epoch: 6 cost time: 0.6875519752502441
Epoch: 6, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.689 Vali Acc: 0.385 Test Loss: 1.689 Test Acc: 0.385
Validation loss decreased (-0.292575 --> -0.385168).  Saving model ...
Epoch: 7 cost time: 0.6051087379455566
Epoch: 7, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.649 Vali Acc: 0.507 Test Loss: 1.649 Test Acc: 0.507
Validation loss decreased (-0.385168 --> -0.507391).  Saving model ...
Epoch: 8 cost time: 0.5227668285369873
Epoch: 8, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.607 Vali Acc: 0.537 Test Loss: 1.607 Test Acc: 0.537
Validation loss decreased (-0.507391 --> -0.537021).  Saving model ...
Epoch: 9 cost time: 0.541649580001831
Epoch: 9, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.564 Vali Acc: 0.581 Test Loss: 1.564 Test Acc: 0.581
Validation loss decreased (-0.537021 --> -0.581466).  Saving model ...
Epoch: 10 cost time: 0.5857961177825928
Epoch: 10, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.519 Vali Acc: 0.604 Test Loss: 1.519 Test Acc: 0.604
Validation loss decreased (-0.581466 --> -0.603689).  Saving model ...
Epoch: 11 cost time: 0.5858967304229736
Epoch: 11, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.468 Vali Acc: 0.611 Test Loss: 1.468 Test Acc: 0.611
Validation loss decreased (-0.603689 --> -0.611096).  Saving model ...
Epoch: 12 cost time: 0.6419057846069336
Epoch: 12, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.414 Vali Acc: 0.674 Test Loss: 1.414 Test Acc: 0.674
Validation loss decreased (-0.611096 --> -0.674060).  Saving model ...
Epoch: 13 cost time: 0.7319304943084717
Epoch: 13, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.356 Vali Acc: 0.715 Test Loss: 1.356 Test Acc: 0.715
Validation loss decreased (-0.674060 --> -0.714801).  Saving model ...
Epoch: 14 cost time: 0.6227171421051025
Epoch: 14, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.295 Vali Acc: 0.767 Test Loss: 1.295 Test Acc: 0.767
Validation loss decreased (-0.714801 --> -0.766654).  Saving model ...
Epoch: 15 cost time: 0.5549278259277344
Epoch: 15, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.235 Vali Acc: 0.807 Test Loss: 1.235 Test Acc: 0.807
Validation loss decreased (-0.766654 --> -0.807395).  Saving model ...
Epoch: 16 cost time: 0.7211868762969971
Epoch: 16, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.175 Vali Acc: 0.819 Test Loss: 1.175 Test Acc: 0.819
Validation loss decreased (-0.807395 --> -0.818507).  Saving model ...
Epoch: 17 cost time: 0.5595591068267822
Epoch: 17, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.115 Vali Acc: 0.837 Test Loss: 1.115 Test Acc: 0.837
Validation loss decreased (-0.818507 --> -0.837026).  Saving model ...
Epoch: 18 cost time: 0.6598019599914551
Epoch: 18, Steps: 2 | Train Loss: 1.037 Vali Loss: 1.054 Vali Acc: 0.852 Test Loss: 1.054 Test Acc: 0.852
Validation loss decreased (-0.837026 --> -0.851841).  Saving model ...
Epoch: 19 cost time: 0.656313419342041
Epoch: 19, Steps: 2 | Train Loss: 0.981 Vali Loss: 0.997 Vali Acc: 0.867 Test Loss: 0.997 Test Acc: 0.867
Validation loss decreased (-0.851841 --> -0.866657).  Saving model ...
Epoch: 20 cost time: 0.6762135028839111
Epoch: 20, Steps: 2 | Train Loss: 0.901 Vali Loss: 0.939 Vali Acc: 0.889 Test Loss: 0.939 Test Acc: 0.889
Validation loss decreased (-0.866657 --> -0.888880).  Saving model ...
Epoch: 21 cost time: 0.8111081123352051
Epoch: 21, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.882 Vali Acc: 0.896 Test Loss: 0.882 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896287).  Saving model ...
Epoch: 22 cost time: 0.628075361251831
Epoch: 22, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.830 Vali Acc: 0.896 Test Loss: 0.830 Test Acc: 0.896
Validation loss decreased (-0.896287 --> -0.896288).  Saving model ...
Epoch: 23 cost time: 0.5901098251342773
Epoch: 23, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.778 Vali Acc: 0.889 Test Loss: 0.778 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7789208889007568
Epoch: 24, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.726 Vali Acc: 0.896 Test Loss: 0.726 Test Acc: 0.896
Validation loss decreased (-0.896288 --> -0.896289).  Saving model ...
Epoch: 25 cost time: 0.6754539012908936
Epoch: 25, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.675 Vali Acc: 0.900 Test Loss: 0.675 Test Acc: 0.900
Validation loss decreased (-0.896289 --> -0.899993).  Saving model ...
Epoch: 26 cost time: 0.5337696075439453
Epoch: 26, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.627 Vali Acc: 0.915 Test Loss: 0.627 Test Acc: 0.915
Validation loss decreased (-0.899993 --> -0.914809).  Saving model ...
Epoch: 27 cost time: 0.5930788516998291
Epoch: 27, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.582 Vali Acc: 0.926 Test Loss: 0.582 Test Acc: 0.926
Validation loss decreased (-0.914809 --> -0.925920).  Saving model ...
Epoch: 28 cost time: 0.7242650985717773
Epoch: 28, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.541 Vali Acc: 0.930 Test Loss: 0.541 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 29 cost time: 0.7367489337921143
Epoch: 29, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.502 Vali Acc: 0.930 Test Loss: 0.502 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 30 cost time: 0.4994227886199951
Epoch: 30, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.468 Vali Acc: 0.926 Test Loss: 0.468 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6222712993621826
Epoch: 31, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.438 Vali Acc: 0.926 Test Loss: 0.438 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5344970226287842
Epoch: 32, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.414 Vali Acc: 0.930 Test Loss: 0.414 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 33 cost time: 0.5441606044769287
Epoch: 33, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.388 Vali Acc: 0.933 Test Loss: 0.388 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 34 cost time: 0.5370984077453613
Epoch: 34, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.365 Vali Acc: 0.933 Test Loss: 0.365 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 35 cost time: 0.5077939033508301
Epoch: 35, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.342 Vali Acc: 0.933 Test Loss: 0.342 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 36 cost time: 0.5738344192504883
Epoch: 36, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.324 Vali Acc: 0.930 Test Loss: 0.324 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.580904483795166
Epoch: 37, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.307 Vali Acc: 0.941 Test Loss: 0.307 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.6566736698150635
Epoch: 38, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.293 Vali Acc: 0.941 Test Loss: 0.293 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 39 cost time: 0.5796530246734619
Epoch: 39, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6114041805267334
Epoch: 40, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.271 Vali Acc: 0.937 Test Loss: 0.271 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.5938162803649902
Epoch: 41, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5576164722442627
Epoch: 42, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.5788347721099854
Epoch: 43, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7825872898101807
Epoch: 44, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6222898960113525
Epoch: 45, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.5345115661621094
Epoch: 46, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5000224113464355
Epoch: 47, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.526270866394043
Epoch: 48, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 613150
model size : 3.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8863253593444824
Epoch: 1, Steps: 2 | Train Loss: 1.898 Vali Loss: 1.908 Vali Acc: 0.219 Test Loss: 1.908 Test Acc: 0.219
Validation loss decreased (inf --> -0.218499).  Saving model ...
Epoch: 2 cost time: 0.6460838317871094
Epoch: 2, Steps: 2 | Train Loss: 1.933 Vali Loss: 1.875 Vali Acc: 0.237 Test Loss: 1.875 Test Acc: 0.237
Validation loss decreased (-0.218499 --> -0.237018).  Saving model ...
Epoch: 3 cost time: 0.718308687210083
Epoch: 3, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.848 Vali Acc: 0.244 Test Loss: 1.848 Test Acc: 0.244
Validation loss decreased (-0.237018 --> -0.244426).  Saving model ...
Epoch: 4 cost time: 0.5772559642791748
Epoch: 4, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.817 Vali Acc: 0.248 Test Loss: 1.817 Test Acc: 0.248
Validation loss decreased (-0.244426 --> -0.248130).  Saving model ...
Epoch: 5 cost time: 0.6452620029449463
Epoch: 5, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.778 Vali Acc: 0.281 Test Loss: 1.778 Test Acc: 0.281
Validation loss decreased (-0.248130 --> -0.281464).  Saving model ...
Epoch: 6 cost time: 0.6058657169342041
Epoch: 6, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.737 Vali Acc: 0.330 Test Loss: 1.737 Test Acc: 0.330
Validation loss decreased (-0.281464 --> -0.329612).  Saving model ...
Epoch: 7 cost time: 0.5883467197418213
Epoch: 7, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.699 Vali Acc: 0.330 Test Loss: 1.699 Test Acc: 0.330
Validation loss decreased (-0.329612 --> -0.329613).  Saving model ...
Epoch: 8 cost time: 0.540463924407959
Epoch: 8, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.660 Vali Acc: 0.315 Test Loss: 1.660 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6338951587677002
Epoch: 9, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.618 Vali Acc: 0.393 Test Loss: 1.618 Test Acc: 0.393
Validation loss decreased (-0.329613 --> -0.392576).  Saving model ...
Epoch: 10 cost time: 0.6095798015594482
Epoch: 10, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.576 Vali Acc: 0.456 Test Loss: 1.576 Test Acc: 0.456
Validation loss decreased (-0.392576 --> -0.455540).  Saving model ...
Epoch: 11 cost time: 0.5497782230377197
Epoch: 11, Steps: 2 | Train Loss: 1.503 Vali Loss: 1.531 Vali Acc: 0.544 Test Loss: 1.531 Test Acc: 0.544
Validation loss decreased (-0.455540 --> -0.544429).  Saving model ...
Epoch: 12 cost time: 0.5194778442382812
Epoch: 12, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.484 Vali Acc: 0.563 Test Loss: 1.484 Test Acc: 0.563
Validation loss decreased (-0.544429 --> -0.562948).  Saving model ...
Epoch: 13 cost time: 0.5440759658813477
Epoch: 13, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.434 Vali Acc: 0.593 Test Loss: 1.434 Test Acc: 0.593
Validation loss decreased (-0.562948 --> -0.592578).  Saving model ...
Epoch: 14 cost time: 0.6672019958496094
Epoch: 14, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.381 Vali Acc: 0.681 Test Loss: 1.381 Test Acc: 0.681
Validation loss decreased (-0.592578 --> -0.681468).  Saving model ...
Epoch: 15 cost time: 0.5489668846130371
Epoch: 15, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.329 Vali Acc: 0.733 Test Loss: 1.329 Test Acc: 0.733
Validation loss decreased (-0.681468 --> -0.733320).  Saving model ...
Epoch: 16 cost time: 0.6943185329437256
Epoch: 16, Steps: 2 | Train Loss: 1.229 Vali Loss: 1.274 Vali Acc: 0.774 Test Loss: 1.274 Test Acc: 0.774
Validation loss decreased (-0.733320 --> -0.774061).  Saving model ...
Epoch: 17 cost time: 0.7299423217773438
Epoch: 17, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.218 Vali Acc: 0.807 Test Loss: 1.218 Test Acc: 0.807
Validation loss decreased (-0.774061 --> -0.807395).  Saving model ...
Epoch: 18 cost time: 0.6495461463928223
Epoch: 18, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.162 Vali Acc: 0.804 Test Loss: 1.162 Test Acc: 0.804
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.600879430770874
Epoch: 19, Steps: 2 | Train Loss: 1.025 Vali Loss: 1.105 Vali Acc: 0.822 Test Loss: 1.105 Test Acc: 0.822
Validation loss decreased (-0.807395 --> -0.822211).  Saving model ...
Epoch: 20 cost time: 0.624171257019043
Epoch: 20, Steps: 2 | Train Loss: 0.973 Vali Loss: 1.045 Vali Acc: 0.844 Test Loss: 1.045 Test Acc: 0.844
Validation loss decreased (-0.822211 --> -0.844434).  Saving model ...
Epoch: 21 cost time: 0.5465168952941895
Epoch: 21, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.983 Vali Acc: 0.863 Test Loss: 0.983 Test Acc: 0.863
Validation loss decreased (-0.844434 --> -0.862953).  Saving model ...
Epoch: 22 cost time: 0.5387430191040039
Epoch: 22, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.923 Vali Acc: 0.874 Test Loss: 0.923 Test Acc: 0.874
Validation loss decreased (-0.862953 --> -0.874065).  Saving model ...
Epoch: 23 cost time: 0.6515064239501953
Epoch: 23, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.864 Vali Acc: 0.904 Test Loss: 0.864 Test Acc: 0.904
Validation loss decreased (-0.874065 --> -0.903695).  Saving model ...
Epoch: 24 cost time: 0.6107046604156494
Epoch: 24, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.808 Vali Acc: 0.911 Test Loss: 0.808 Test Acc: 0.911
Validation loss decreased (-0.903695 --> -0.911103).  Saving model ...
Epoch: 25 cost time: 0.6869816780090332
Epoch: 25, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.753 Vali Acc: 0.907 Test Loss: 0.753 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9373588562011719
Epoch: 26, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.701 Vali Acc: 0.919 Test Loss: 0.701 Test Acc: 0.919
Validation loss decreased (-0.911103 --> -0.918512).  Saving model ...
Epoch: 27 cost time: 0.5650634765625
Epoch: 27, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.652 Vali Acc: 0.933 Test Loss: 0.652 Test Acc: 0.933
Validation loss decreased (-0.918512 --> -0.933327).  Saving model ...
Epoch: 28 cost time: 0.5916264057159424
Epoch: 28, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.603 Vali Acc: 0.941 Test Loss: 0.603 Test Acc: 0.941
Validation loss decreased (-0.933327 --> -0.940735).  Saving model ...
Epoch: 29 cost time: 0.6225907802581787
Epoch: 29, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.558 Vali Acc: 0.944 Test Loss: 0.558 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 30 cost time: 0.6739249229431152
Epoch: 30, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.517 Vali Acc: 0.948 Test Loss: 0.517 Test Acc: 0.948
Validation loss decreased (-0.944439 --> -0.948143).  Saving model ...
Epoch: 31 cost time: 0.7815866470336914
Epoch: 31, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.479 Vali Acc: 0.944 Test Loss: 0.479 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8965339660644531
Epoch: 32, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.447 Vali Acc: 0.952 Test Loss: 0.447 Test Acc: 0.952
Validation loss decreased (-0.948143 --> -0.951847).  Saving model ...
Epoch: 33 cost time: 0.7020907402038574
Epoch: 33, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.419 Vali Acc: 0.948 Test Loss: 0.419 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8093605041503906
Epoch: 34, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.393 Vali Acc: 0.948 Test Loss: 0.393 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8187546730041504
Epoch: 35, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.368 Vali Acc: 0.956 Test Loss: 0.368 Test Acc: 0.956
Validation loss decreased (-0.951847 --> -0.955552).  Saving model ...
Epoch: 36 cost time: 0.662348747253418
Epoch: 36, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.346 Vali Acc: 0.956 Test Loss: 0.346 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 37 cost time: 0.763624906539917
Epoch: 37, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.328 Vali Acc: 0.952 Test Loss: 0.328 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8812484741210938
Epoch: 38, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.312 Vali Acc: 0.952 Test Loss: 0.312 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7025578022003174
Epoch: 39, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.299 Vali Acc: 0.948 Test Loss: 0.299 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7486181259155273
Epoch: 40, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.287 Vali Acc: 0.944 Test Loss: 0.287 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9003148078918457
Epoch: 41, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.275 Vali Acc: 0.948 Test Loss: 0.275 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.961838960647583
Epoch: 42, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8993782997131348
Epoch: 43, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6471085548400879
Epoch: 44, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8542113304138184
Epoch: 45, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.246 Vali Acc: 0.948 Test Loss: 0.246 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.766533374786377
Epoch: 46, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 612766
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2073729038238525
Epoch: 1, Steps: 2 | Train Loss: 1.973 Vali Loss: 1.872 Vali Acc: 0.304 Test Loss: 1.872 Test Acc: 0.304
Validation loss decreased (inf --> -0.303685).  Saving model ...
Epoch: 2 cost time: 0.5886693000793457
Epoch: 2, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.841 Vali Acc: 0.333 Test Loss: 1.841 Test Acc: 0.333
Validation loss decreased (-0.303685 --> -0.333315).  Saving model ...
Epoch: 3 cost time: 0.5627703666687012
Epoch: 3, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.814 Vali Acc: 0.341 Test Loss: 1.814 Test Acc: 0.341
Validation loss decreased (-0.333315 --> -0.340723).  Saving model ...
Epoch: 4 cost time: 0.8689029216766357
Epoch: 4, Steps: 2 | Train Loss: 1.864 Vali Loss: 1.780 Vali Acc: 0.396 Test Loss: 1.780 Test Acc: 0.396
Validation loss decreased (-0.340723 --> -0.396278).  Saving model ...
Epoch: 5 cost time: 0.5848031044006348
Epoch: 5, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.738 Vali Acc: 0.415 Test Loss: 1.738 Test Acc: 0.415
Validation loss decreased (-0.396278 --> -0.414797).  Saving model ...
Epoch: 6 cost time: 0.6708903312683105
Epoch: 6, Steps: 2 | Train Loss: 1.766 Vali Loss: 1.696 Vali Acc: 0.422 Test Loss: 1.696 Test Acc: 0.422
Validation loss decreased (-0.414797 --> -0.422205).  Saving model ...
Epoch: 7 cost time: 0.6437952518463135
Epoch: 7, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.653 Vali Acc: 0.393 Test Loss: 1.653 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6358096599578857
Epoch: 8, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.612 Vali Acc: 0.404 Test Loss: 1.612 Test Acc: 0.404
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6654293537139893
Epoch: 9, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.567 Vali Acc: 0.474 Test Loss: 1.567 Test Acc: 0.474
Validation loss decreased (-0.422205 --> -0.474058).  Saving model ...
Epoch: 10 cost time: 0.6859254837036133
Epoch: 10, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.520 Vali Acc: 0.563 Test Loss: 1.520 Test Acc: 0.563
Validation loss decreased (-0.474058 --> -0.562948).  Saving model ...
Epoch: 11 cost time: 0.6974895000457764
Epoch: 11, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.469 Vali Acc: 0.652 Test Loss: 1.469 Test Acc: 0.652
Validation loss decreased (-0.562948 --> -0.651837).  Saving model ...
Epoch: 12 cost time: 0.6471729278564453
Epoch: 12, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.414 Vali Acc: 0.707 Test Loss: 1.414 Test Acc: 0.707
Validation loss decreased (-0.651837 --> -0.707393).  Saving model ...
Epoch: 13 cost time: 0.5466306209564209
Epoch: 13, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.357 Vali Acc: 0.752 Test Loss: 1.357 Test Acc: 0.752
Validation loss decreased (-0.707393 --> -0.751838).  Saving model ...
Epoch: 14 cost time: 0.6650948524475098
Epoch: 14, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.297 Vali Acc: 0.789 Test Loss: 1.297 Test Acc: 0.789
Validation loss decreased (-0.751838 --> -0.788876).  Saving model ...
Epoch: 15 cost time: 0.6399633884429932
Epoch: 15, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.237 Vali Acc: 0.819 Test Loss: 1.237 Test Acc: 0.819
Validation loss decreased (-0.788876 --> -0.818506).  Saving model ...
Epoch: 16 cost time: 0.6358902454376221
Epoch: 16, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.175 Vali Acc: 0.822 Test Loss: 1.175 Test Acc: 0.822
Validation loss decreased (-0.818506 --> -0.822210).  Saving model ...
Epoch: 17 cost time: 0.6998419761657715
Epoch: 17, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.114 Vali Acc: 0.811 Test Loss: 1.114 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7445435523986816
Epoch: 18, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.054 Vali Acc: 0.837 Test Loss: 1.054 Test Acc: 0.837
Validation loss decreased (-0.822210 --> -0.837027).  Saving model ...
Epoch: 19 cost time: 0.5837719440460205
Epoch: 19, Steps: 2 | Train Loss: 0.983 Vali Loss: 0.995 Vali Acc: 0.837 Test Loss: 0.995 Test Acc: 0.837
Validation loss decreased (-0.837027 --> -0.837027).  Saving model ...
Epoch: 20 cost time: 0.5812268257141113
Epoch: 20, Steps: 2 | Train Loss: 0.916 Vali Loss: 0.936 Vali Acc: 0.867 Test Loss: 0.936 Test Acc: 0.867
Validation loss decreased (-0.837027 --> -0.866657).  Saving model ...
Epoch: 21 cost time: 0.5461142063140869
Epoch: 21, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.880 Vali Acc: 0.885 Test Loss: 0.880 Test Acc: 0.885
Validation loss decreased (-0.866657 --> -0.885176).  Saving model ...
Epoch: 22 cost time: 0.6294102668762207
Epoch: 22, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.824 Vali Acc: 0.893 Test Loss: 0.824 Test Acc: 0.893
Validation loss decreased (-0.885176 --> -0.892584).  Saving model ...
Epoch: 23 cost time: 0.6502020359039307
Epoch: 23, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.769 Vali Acc: 0.893 Test Loss: 0.769 Test Acc: 0.893
Validation loss decreased (-0.892584 --> -0.892585).  Saving model ...
Epoch: 24 cost time: 0.6808137893676758
Epoch: 24, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.719 Vali Acc: 0.904 Test Loss: 0.719 Test Acc: 0.904
Validation loss decreased (-0.892585 --> -0.903697).  Saving model ...
Epoch: 25 cost time: 0.5687422752380371
Epoch: 25, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.672 Vali Acc: 0.919 Test Loss: 0.672 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918512).  Saving model ...
Epoch: 26 cost time: 0.5562736988067627
Epoch: 26, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.628 Vali Acc: 0.926 Test Loss: 0.628 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 27 cost time: 0.7360291481018066
Epoch: 27, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.586 Vali Acc: 0.930 Test Loss: 0.586 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 28 cost time: 0.6309447288513184
Epoch: 28, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.548 Vali Acc: 0.933 Test Loss: 0.548 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 29 cost time: 0.7086617946624756
Epoch: 29, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.511 Vali Acc: 0.933 Test Loss: 0.511 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 30 cost time: 0.6311378479003906
Epoch: 30, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.478 Vali Acc: 0.937 Test Loss: 0.478 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 31 cost time: 0.6275560855865479
Epoch: 31, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.448 Vali Acc: 0.941 Test Loss: 0.448 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 32 cost time: 0.6703588962554932
Epoch: 32, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.420 Vali Acc: 0.937 Test Loss: 0.420 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7603261470794678
Epoch: 33, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.396 Vali Acc: 0.941 Test Loss: 0.396 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 34 cost time: 0.6480104923248291
Epoch: 34, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.375 Vali Acc: 0.941 Test Loss: 0.375 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.7140884399414062
Epoch: 35, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.355 Vali Acc: 0.944 Test Loss: 0.355 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 36 cost time: 0.6636145114898682
Epoch: 36, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.338 Vali Acc: 0.944 Test Loss: 0.338 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 37 cost time: 0.6720476150512695
Epoch: 37, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.323 Vali Acc: 0.948 Test Loss: 0.323 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 38 cost time: 0.6498572826385498
Epoch: 38, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.310 Vali Acc: 0.948 Test Loss: 0.310 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 39 cost time: 0.8514771461486816
Epoch: 39, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7565245628356934
Epoch: 40, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.290 Vali Acc: 0.937 Test Loss: 0.290 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7329304218292236
Epoch: 41, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.281 Vali Acc: 0.937 Test Loss: 0.281 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.8930954933166504
Epoch: 42, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.271 Vali Acc: 0.937 Test Loss: 0.271 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6795110702514648
Epoch: 43, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.595707893371582
Epoch: 44, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.252 Vali Acc: 0.948 Test Loss: 0.252 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.5970563888549805
Epoch: 45, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.245 Vali Acc: 0.948 Test Loss: 0.245 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.5281598567962646
Epoch: 46, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.238 Vali Acc: 0.952 Test Loss: 0.238 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 47 cost time: 0.601344108581543
Epoch: 47, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.232 Vali Acc: 0.952 Test Loss: 0.232 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.6875910758972168
Epoch: 48, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.228 Vali Acc: 0.952 Test Loss: 0.228 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.6998069286346436
Epoch: 49, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.5415363311767578
Epoch: 50, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7359509468078613
Epoch: 51, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.6621577739715576
Epoch: 52, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.7129344940185547
Epoch: 53, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7036349773406982
Epoch: 54, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.6799070835113525
Epoch: 55, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.7258365154266357
Epoch: 56, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.5958418846130371
Epoch: 57, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.636667013168335
Epoch: 58, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 1.087876319885254
Epoch: 59, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 60 cost time: 0.6163935661315918
Epoch: 60, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 61 cost time: 0.5820374488830566
Epoch: 61, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.5795578956604004
Epoch: 62, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.738365650177002
Epoch: 63, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.6525628566741943
Epoch: 64, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.6272921562194824
Epoch: 65, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.6121501922607422
Epoch: 66, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.7476091384887695
Epoch: 67, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.6348235607147217
Epoch: 68, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.5269441604614258
Epoch: 69, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.7115790843963623
Epoch: 70, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 612382
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2695744037628174
Epoch: 1, Steps: 2 | Train Loss: 2.133 Vali Loss: 1.977 Vali Acc: 0.104 Test Loss: 1.977 Test Acc: 0.104
Validation loss decreased (inf --> -0.103684).  Saving model ...
Epoch: 2 cost time: 0.5281267166137695
Epoch: 2, Steps: 2 | Train Loss: 1.922 Vali Loss: 1.926 Vali Acc: 0.074 Test Loss: 1.926 Test Acc: 0.074
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.5669221878051758
Epoch: 3, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.886 Vali Acc: 0.093 Test Loss: 1.886 Test Acc: 0.093
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.688227653503418
Epoch: 4, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.845 Vali Acc: 0.122 Test Loss: 1.845 Test Acc: 0.122
Validation loss decreased (-0.103684 --> -0.122204).  Saving model ...
Epoch: 5 cost time: 0.6839239597320557
Epoch: 5, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.801 Vali Acc: 0.152 Test Loss: 1.801 Test Acc: 0.152
Validation loss decreased (-0.122204 --> -0.151834).  Saving model ...
Epoch: 6 cost time: 0.724545955657959
Epoch: 6, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.755 Vali Acc: 0.200 Test Loss: 1.755 Test Acc: 0.200
Validation loss decreased (-0.151834 --> -0.199982).  Saving model ...
Epoch: 7 cost time: 0.7721405029296875
Epoch: 7, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.711 Vali Acc: 0.226 Test Loss: 1.711 Test Acc: 0.226
Validation loss decreased (-0.199982 --> -0.225909).  Saving model ...
Epoch: 8 cost time: 0.6980037689208984
Epoch: 8, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.670 Vali Acc: 0.270 Test Loss: 1.670 Test Acc: 0.270
Validation loss decreased (-0.225909 --> -0.270354).  Saving model ...
Epoch: 9 cost time: 0.7488951683044434
Epoch: 9, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.629 Vali Acc: 0.307 Test Loss: 1.629 Test Acc: 0.307
Validation loss decreased (-0.270354 --> -0.307391).  Saving model ...
Epoch: 10 cost time: 0.6586759090423584
Epoch: 10, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.584 Vali Acc: 0.381 Test Loss: 1.584 Test Acc: 0.381
Validation loss decreased (-0.307391 --> -0.381466).  Saving model ...
Epoch: 11 cost time: 0.6799678802490234
Epoch: 11, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.536 Vali Acc: 0.422 Test Loss: 1.536 Test Acc: 0.422
Validation loss decreased (-0.381466 --> -0.422207).  Saving model ...
Epoch: 12 cost time: 0.5722057819366455
Epoch: 12, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.483 Vali Acc: 0.556 Test Loss: 1.483 Test Acc: 0.556
Validation loss decreased (-0.422207 --> -0.555541).  Saving model ...
Epoch: 13 cost time: 0.6987655162811279
Epoch: 13, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.424 Vali Acc: 0.622 Test Loss: 1.424 Test Acc: 0.622
Validation loss decreased (-0.555541 --> -0.622208).  Saving model ...
Epoch: 14 cost time: 0.6330108642578125
Epoch: 14, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.363 Vali Acc: 0.685 Test Loss: 1.363 Test Acc: 0.685
Validation loss decreased (-0.622208 --> -0.685172).  Saving model ...
Epoch: 15 cost time: 0.6997103691101074
Epoch: 15, Steps: 2 | Train Loss: 1.284 Vali Loss: 1.298 Vali Acc: 0.733 Test Loss: 1.298 Test Acc: 0.733
Validation loss decreased (-0.685172 --> -0.733320).  Saving model ...
Epoch: 16 cost time: 0.8258583545684814
Epoch: 16, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.235 Vali Acc: 0.767 Test Loss: 1.235 Test Acc: 0.767
Validation loss decreased (-0.733320 --> -0.766654).  Saving model ...
Epoch: 17 cost time: 0.9192295074462891
Epoch: 17, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.174 Vali Acc: 0.781 Test Loss: 1.174 Test Acc: 0.781
Validation loss decreased (-0.766654 --> -0.781470).  Saving model ...
Epoch: 18 cost time: 0.7057662010192871
Epoch: 18, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.114 Vali Acc: 0.778 Test Loss: 1.114 Test Acc: 0.778
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.646416425704956
Epoch: 19, Steps: 2 | Train Loss: 1.002 Vali Loss: 1.051 Vali Acc: 0.785 Test Loss: 1.051 Test Acc: 0.785
Validation loss decreased (-0.781470 --> -0.785175).  Saving model ...
Epoch: 20 cost time: 0.6682384014129639
Epoch: 20, Steps: 2 | Train Loss: 0.944 Vali Loss: 0.987 Vali Acc: 0.800 Test Loss: 0.987 Test Acc: 0.800
Validation loss decreased (-0.785175 --> -0.799990).  Saving model ...
Epoch: 21 cost time: 0.7424860000610352
Epoch: 21, Steps: 2 | Train Loss: 0.868 Vali Loss: 0.925 Vali Acc: 0.822 Test Loss: 0.925 Test Acc: 0.822
Validation loss decreased (-0.799990 --> -0.822213).  Saving model ...
Epoch: 22 cost time: 0.7725963592529297
Epoch: 22, Steps: 2 | Train Loss: 0.783 Vali Loss: 0.865 Vali Acc: 0.852 Test Loss: 0.865 Test Acc: 0.852
Validation loss decreased (-0.822213 --> -0.851843).  Saving model ...
Epoch: 23 cost time: 0.6309936046600342
Epoch: 23, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.808 Vali Acc: 0.874 Test Loss: 0.808 Test Acc: 0.874
Validation loss decreased (-0.851843 --> -0.874066).  Saving model ...
Epoch: 24 cost time: 0.7130098342895508
Epoch: 24, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.754 Vali Acc: 0.867 Test Loss: 0.754 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7601652145385742
Epoch: 25, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.701 Vali Acc: 0.859 Test Loss: 0.701 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6372554302215576
Epoch: 26, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.652 Vali Acc: 0.878 Test Loss: 0.652 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877771).  Saving model ...
Epoch: 27 cost time: 0.7649877071380615
Epoch: 27, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.605 Vali Acc: 0.889 Test Loss: 0.605 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888883).  Saving model ...
Epoch: 28 cost time: 0.6405768394470215
Epoch: 28, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.561 Vali Acc: 0.904 Test Loss: 0.561 Test Acc: 0.904
Validation loss decreased (-0.888883 --> -0.903698).  Saving model ...
Epoch: 29 cost time: 0.5245471000671387
Epoch: 29, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.524 Vali Acc: 0.915 Test Loss: 0.524 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914810).  Saving model ...
Epoch: 30 cost time: 0.7293670177459717
Epoch: 30, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.490 Vali Acc: 0.911 Test Loss: 0.490 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6225228309631348
Epoch: 31, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.463 Vali Acc: 0.907 Test Loss: 0.463 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5613577365875244
Epoch: 32, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.434 Vali Acc: 0.911 Test Loss: 0.434 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6209948062896729
Epoch: 33, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.407 Vali Acc: 0.922 Test Loss: 0.407 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 34 cost time: 0.6952853202819824
Epoch: 34, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.384 Vali Acc: 0.930 Test Loss: 0.384 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 35 cost time: 0.6494004726409912
Epoch: 35, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.363 Vali Acc: 0.930 Test Loss: 0.363 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 36 cost time: 0.5872461795806885
Epoch: 36, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.344 Vali Acc: 0.933 Test Loss: 0.344 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 0.6083743572235107
Epoch: 37, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.327 Vali Acc: 0.948 Test Loss: 0.327 Test Acc: 0.948
Validation loss decreased (-0.933330 --> -0.948145).  Saving model ...
Epoch: 38 cost time: 0.6178851127624512
Epoch: 38, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.313 Vali Acc: 0.941 Test Loss: 0.313 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5443525314331055
Epoch: 39, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.301 Vali Acc: 0.944 Test Loss: 0.301 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6388068199157715
Epoch: 40, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.293 Vali Acc: 0.937 Test Loss: 0.293 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.732494592666626
Epoch: 41, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.287 Vali Acc: 0.941 Test Loss: 0.287 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.7196481227874756
Epoch: 42, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8158836364746094
Epoch: 43, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.276 Vali Acc: 0.922 Test Loss: 0.276 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6245095729827881
Epoch: 44, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.5981597900390625
Epoch: 45, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.5249326229095459
Epoch: 46, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.5196044445037842
Epoch: 47, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 611998
model size : 3.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.16679310798645
Epoch: 1, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.895 Vali Acc: 0.252 Test Loss: 1.895 Test Acc: 0.252
Validation loss decreased (inf --> -0.251833).  Saving model ...
Epoch: 2 cost time: 0.5806691646575928
Epoch: 2, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.853 Vali Acc: 0.256 Test Loss: 1.853 Test Acc: 0.256
Validation loss decreased (-0.251833 --> -0.255537).  Saving model ...
Epoch: 3 cost time: 0.6424517631530762
Epoch: 3, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.821 Vali Acc: 0.274 Test Loss: 1.821 Test Acc: 0.274
Validation loss decreased (-0.255537 --> -0.274056).  Saving model ...
Epoch: 4 cost time: 0.50404953956604
Epoch: 4, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.787 Vali Acc: 0.300 Test Loss: 1.787 Test Acc: 0.300
Validation loss decreased (-0.274056 --> -0.299982).  Saving model ...
Epoch: 5 cost time: 0.5931429862976074
Epoch: 5, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.747 Vali Acc: 0.315 Test Loss: 1.747 Test Acc: 0.315
Validation loss decreased (-0.299982 --> -0.314797).  Saving model ...
Epoch: 6 cost time: 0.5249824523925781
Epoch: 6, Steps: 2 | Train Loss: 1.677 Vali Loss: 1.707 Vali Acc: 0.304 Test Loss: 1.707 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5925807952880859
Epoch: 7, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.667 Vali Acc: 0.333 Test Loss: 1.667 Test Acc: 0.333
Validation loss decreased (-0.314797 --> -0.333317).  Saving model ...
Epoch: 8 cost time: 0.49912142753601074
Epoch: 8, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.626 Vali Acc: 0.348 Test Loss: 1.626 Test Acc: 0.348
Validation loss decreased (-0.333317 --> -0.348132).  Saving model ...
Epoch: 9 cost time: 0.7128334045410156
Epoch: 9, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.585 Vali Acc: 0.456 Test Loss: 1.585 Test Acc: 0.456
Validation loss decreased (-0.348132 --> -0.455540).  Saving model ...
Epoch: 10 cost time: 0.6743764877319336
Epoch: 10, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.545 Vali Acc: 0.556 Test Loss: 1.545 Test Acc: 0.556
Validation loss decreased (-0.455540 --> -0.555540).  Saving model ...
Epoch: 11 cost time: 0.550114631652832
Epoch: 11, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.501 Vali Acc: 0.611 Test Loss: 1.501 Test Acc: 0.611
Validation loss decreased (-0.555540 --> -0.611096).  Saving model ...
Epoch: 12 cost time: 0.6080646514892578
Epoch: 12, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.456 Vali Acc: 0.659 Test Loss: 1.456 Test Acc: 0.659
Validation loss decreased (-0.611096 --> -0.659245).  Saving model ...
Epoch: 13 cost time: 0.6547341346740723
Epoch: 13, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.408 Vali Acc: 0.700 Test Loss: 1.408 Test Acc: 0.700
Validation loss decreased (-0.659245 --> -0.699986).  Saving model ...
Epoch: 14 cost time: 0.5388600826263428
Epoch: 14, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.358 Vali Acc: 0.748 Test Loss: 1.358 Test Acc: 0.748
Validation loss decreased (-0.699986 --> -0.748135).  Saving model ...
Epoch: 15 cost time: 0.7176089286804199
Epoch: 15, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.304 Vali Acc: 0.778 Test Loss: 1.304 Test Acc: 0.778
Validation loss decreased (-0.748135 --> -0.777765).  Saving model ...
Epoch: 16 cost time: 0.656865119934082
Epoch: 16, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.250 Vali Acc: 0.807 Test Loss: 1.250 Test Acc: 0.807
Validation loss decreased (-0.777765 --> -0.807395).  Saving model ...
Epoch: 17 cost time: 0.613816499710083
Epoch: 17, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.196 Vali Acc: 0.815 Test Loss: 1.196 Test Acc: 0.815
Validation loss decreased (-0.807395 --> -0.814803).  Saving model ...
Epoch: 18 cost time: 0.5787138938903809
Epoch: 18, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.141 Vali Acc: 0.822 Test Loss: 1.141 Test Acc: 0.822
Validation loss decreased (-0.814803 --> -0.822211).  Saving model ...
Epoch: 19 cost time: 0.5396263599395752
Epoch: 19, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.087 Vali Acc: 0.826 Test Loss: 1.087 Test Acc: 0.826
Validation loss decreased (-0.822211 --> -0.825915).  Saving model ...
Epoch: 20 cost time: 0.5455851554870605
Epoch: 20, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.035 Vali Acc: 0.837 Test Loss: 1.035 Test Acc: 0.837
Validation loss decreased (-0.825915 --> -0.837027).  Saving model ...
Epoch: 21 cost time: 0.5042521953582764
Epoch: 21, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.985 Vali Acc: 0.841 Test Loss: 0.985 Test Acc: 0.841
Validation loss decreased (-0.837027 --> -0.840731).  Saving model ...
Epoch: 22 cost time: 0.6148853302001953
Epoch: 22, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.930 Vali Acc: 0.881 Test Loss: 0.930 Test Acc: 0.881
Validation loss decreased (-0.840731 --> -0.881472).  Saving model ...
Epoch: 23 cost time: 0.5979783535003662
Epoch: 23, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.875 Vali Acc: 0.896 Test Loss: 0.875 Test Acc: 0.896
Validation loss decreased (-0.881472 --> -0.896288).  Saving model ...
Epoch: 24 cost time: 0.6064679622650146
Epoch: 24, Steps: 2 | Train Loss: 0.762 Vali Loss: 0.823 Vali Acc: 0.915 Test Loss: 0.823 Test Acc: 0.915
Validation loss decreased (-0.896288 --> -0.914807).  Saving model ...
Epoch: 25 cost time: 0.8791813850402832
Epoch: 25, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.772 Vali Acc: 0.933 Test Loss: 0.772 Test Acc: 0.933
Validation loss decreased (-0.914807 --> -0.933326).  Saving model ...
Epoch: 26 cost time: 0.7020890712738037
Epoch: 26, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.723 Vali Acc: 0.926 Test Loss: 0.723 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6088035106658936
Epoch: 27, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.675 Vali Acc: 0.930 Test Loss: 0.675 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.55287766456604
Epoch: 28, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.630 Vali Acc: 0.919 Test Loss: 0.630 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6350739002227783
Epoch: 29, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.590 Vali Acc: 0.919 Test Loss: 0.590 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.514369010925293
Epoch: 30, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.552 Vali Acc: 0.922 Test Loss: 0.552 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.525343656539917
Epoch: 31, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.516 Vali Acc: 0.922 Test Loss: 0.516 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5848138332366943
Epoch: 32, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.480 Vali Acc: 0.930 Test Loss: 0.480 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5932486057281494
Epoch: 33, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.447 Vali Acc: 0.937 Test Loss: 0.447 Test Acc: 0.937
Validation loss decreased (-0.933326 --> -0.937033).  Saving model ...
Epoch: 34 cost time: 0.49686598777770996
Epoch: 34, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.416 Vali Acc: 0.941 Test Loss: 0.416 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.5338850021362305
Epoch: 35, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.391 Vali Acc: 0.948 Test Loss: 0.391 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948144).  Saving model ...
Epoch: 36 cost time: 0.6191239356994629
Epoch: 36, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.369 Vali Acc: 0.952 Test Loss: 0.369 Test Acc: 0.952
Validation loss decreased (-0.948144 --> -0.951848).  Saving model ...
Epoch: 37 cost time: 0.5427260398864746
Epoch: 37, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.349 Vali Acc: 0.944 Test Loss: 0.349 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5934064388275146
Epoch: 38, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.333 Vali Acc: 0.944 Test Loss: 0.333 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6181044578552246
Epoch: 39, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6621389389038086
Epoch: 40, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.311 Vali Acc: 0.941 Test Loss: 0.311 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8163774013519287
Epoch: 41, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6781187057495117
Epoch: 42, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5848660469055176
Epoch: 43, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7475664615631104
Epoch: 44, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.6395394802093506
Epoch: 45, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6467328071594238
Epoch: 46, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 415006
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0923233032226562
Epoch: 1, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.876 Vali Acc: 0.204 Test Loss: 1.876 Test Acc: 0.204
Validation loss decreased (inf --> -0.203685).  Saving model ...
Epoch: 2 cost time: 0.5917415618896484
Epoch: 2, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.845 Vali Acc: 0.267 Test Loss: 1.845 Test Acc: 0.267
Validation loss decreased (-0.203685 --> -0.266648).  Saving model ...
Epoch: 3 cost time: 0.5997641086578369
Epoch: 3, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.823 Vali Acc: 0.300 Test Loss: 1.823 Test Acc: 0.300
Validation loss decreased (-0.266648 --> -0.299982).  Saving model ...
Epoch: 4 cost time: 0.6671645641326904
Epoch: 4, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.798 Vali Acc: 0.307 Test Loss: 1.798 Test Acc: 0.307
Validation loss decreased (-0.299982 --> -0.307389).  Saving model ...
Epoch: 5 cost time: 0.7833716869354248
Epoch: 5, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.769 Vali Acc: 0.333 Test Loss: 1.769 Test Acc: 0.333
Validation loss decreased (-0.307389 --> -0.333316).  Saving model ...
Epoch: 6 cost time: 0.8653180599212646
Epoch: 6, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.736 Vali Acc: 0.359 Test Loss: 1.736 Test Acc: 0.359
Validation loss decreased (-0.333316 --> -0.359242).  Saving model ...
Epoch: 7 cost time: 0.801910400390625
Epoch: 7, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.700 Vali Acc: 0.378 Test Loss: 1.700 Test Acc: 0.378
Validation loss decreased (-0.359242 --> -0.377761).  Saving model ...
Epoch: 8 cost time: 0.6729609966278076
Epoch: 8, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.662 Vali Acc: 0.404 Test Loss: 1.662 Test Acc: 0.404
Validation loss decreased (-0.377761 --> -0.403687).  Saving model ...
Epoch: 9 cost time: 0.8766825199127197
Epoch: 9, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.621 Vali Acc: 0.422 Test Loss: 1.621 Test Acc: 0.422
Validation loss decreased (-0.403687 --> -0.422206).  Saving model ...
Epoch: 10 cost time: 0.8671982288360596
Epoch: 10, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.579 Vali Acc: 0.481 Test Loss: 1.579 Test Acc: 0.481
Validation loss decreased (-0.422206 --> -0.481466).  Saving model ...
Epoch: 11 cost time: 0.6024875640869141
Epoch: 11, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.535 Vali Acc: 0.541 Test Loss: 1.535 Test Acc: 0.541
Validation loss decreased (-0.481466 --> -0.540725).  Saving model ...
Epoch: 12 cost time: 0.6632962226867676
Epoch: 12, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.488 Vali Acc: 0.559 Test Loss: 1.488 Test Acc: 0.559
Validation loss decreased (-0.540725 --> -0.559244).  Saving model ...
Epoch: 13 cost time: 0.4832472801208496
Epoch: 13, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.438 Vali Acc: 0.600 Test Loss: 1.438 Test Acc: 0.600
Validation loss decreased (-0.559244 --> -0.599986).  Saving model ...
Epoch: 14 cost time: 0.6847691535949707
Epoch: 14, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.386 Vali Acc: 0.652 Test Loss: 1.386 Test Acc: 0.652
Validation loss decreased (-0.599986 --> -0.651838).  Saving model ...
Epoch: 15 cost time: 0.6386048793792725
Epoch: 15, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.332 Vali Acc: 0.707 Test Loss: 1.332 Test Acc: 0.707
Validation loss decreased (-0.651838 --> -0.707394).  Saving model ...
Epoch: 16 cost time: 0.6881351470947266
Epoch: 16, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.279 Vali Acc: 0.748 Test Loss: 1.279 Test Acc: 0.748
Validation loss decreased (-0.707394 --> -0.748135).  Saving model ...
Epoch: 17 cost time: 0.6262903213500977
Epoch: 17, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.227 Vali Acc: 0.752 Test Loss: 1.227 Test Acc: 0.752
Validation loss decreased (-0.748135 --> -0.751840).  Saving model ...
Epoch: 18 cost time: 0.6762599945068359
Epoch: 18, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.176 Vali Acc: 0.785 Test Loss: 1.176 Test Acc: 0.785
Validation loss decreased (-0.751840 --> -0.785173).  Saving model ...
Epoch: 19 cost time: 0.6857829093933105
Epoch: 19, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.125 Vali Acc: 0.807 Test Loss: 1.125 Test Acc: 0.807
Validation loss decreased (-0.785173 --> -0.807396).  Saving model ...
Epoch: 20 cost time: 0.5369658470153809
Epoch: 20, Steps: 2 | Train Loss: 0.997 Vali Loss: 1.075 Vali Acc: 0.815 Test Loss: 1.075 Test Acc: 0.815
Validation loss decreased (-0.807396 --> -0.814804).  Saving model ...
Epoch: 21 cost time: 0.7778365612030029
Epoch: 21, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.024 Vali Acc: 0.841 Test Loss: 1.024 Test Acc: 0.841
Validation loss decreased (-0.814804 --> -0.840730).  Saving model ...
Epoch: 22 cost time: 0.6794390678405762
Epoch: 22, Steps: 2 | Train Loss: 0.892 Vali Loss: 0.972 Vali Acc: 0.859 Test Loss: 0.972 Test Acc: 0.859
Validation loss decreased (-0.840730 --> -0.859250).  Saving model ...
Epoch: 23 cost time: 0.5886611938476562
Epoch: 23, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.918 Vali Acc: 0.881 Test Loss: 0.918 Test Acc: 0.881
Validation loss decreased (-0.859250 --> -0.881472).  Saving model ...
Epoch: 24 cost time: 0.5569674968719482
Epoch: 24, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.866 Vali Acc: 0.893 Test Loss: 0.866 Test Acc: 0.893
Validation loss decreased (-0.881472 --> -0.892584).  Saving model ...
Epoch: 25 cost time: 0.8218183517456055
Epoch: 25, Steps: 2 | Train Loss: 0.681 Vali Loss: 0.817 Vali Acc: 0.904 Test Loss: 0.817 Test Acc: 0.904
Validation loss decreased (-0.892584 --> -0.903696).  Saving model ...
Epoch: 26 cost time: 0.9253406524658203
Epoch: 26, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.767 Vali Acc: 0.907 Test Loss: 0.767 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 27 cost time: 0.6501367092132568
Epoch: 27, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.718 Vali Acc: 0.915 Test Loss: 0.718 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 28 cost time: 0.6215250492095947
Epoch: 28, Steps: 2 | Train Loss: 0.590 Vali Loss: 0.671 Vali Acc: 0.919 Test Loss: 0.671 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 29 cost time: 0.6063346862792969
Epoch: 29, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.627 Vali Acc: 0.915 Test Loss: 0.627 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6931941509246826
Epoch: 30, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.584 Vali Acc: 0.919 Test Loss: 0.584 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 31 cost time: 0.6147298812866211
Epoch: 31, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.546 Vali Acc: 0.915 Test Loss: 0.546 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6882860660552979
Epoch: 32, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.510 Vali Acc: 0.926 Test Loss: 0.510 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 33 cost time: 0.6694097518920898
Epoch: 33, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.478 Vali Acc: 0.926 Test Loss: 0.478 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 34 cost time: 0.6211540699005127
Epoch: 34, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.450 Vali Acc: 0.922 Test Loss: 0.450 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7010352611541748
Epoch: 35, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.425 Vali Acc: 0.926 Test Loss: 0.425 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 36 cost time: 0.6674373149871826
Epoch: 36, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.401 Vali Acc: 0.926 Test Loss: 0.401 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 37 cost time: 0.5993518829345703
Epoch: 37, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.381 Vali Acc: 0.930 Test Loss: 0.381 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 38 cost time: 0.6407127380371094
Epoch: 38, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.361 Vali Acc: 0.933 Test Loss: 0.361 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 39 cost time: 0.797816276550293
Epoch: 39, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.344 Vali Acc: 0.933 Test Loss: 0.344 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 40 cost time: 0.6522846221923828
Epoch: 40, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.329 Vali Acc: 0.937 Test Loss: 0.329 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.6772596836090088
Epoch: 41, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.319 Vali Acc: 0.933 Test Loss: 0.319 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6485631465911865
Epoch: 42, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9170327186584473
Epoch: 43, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.690150260925293
Epoch: 44, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.7347075939178467
Epoch: 45, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.288 Vali Acc: 0.930 Test Loss: 0.288 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6880216598510742
Epoch: 46, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.7531278133392334
Epoch: 47, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5924773216247559
Epoch: 48, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 49 cost time: 0.7721753120422363
Epoch: 49, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 50 cost time: 0.6121752262115479
Epoch: 50, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 51 cost time: 0.5864906311035156
Epoch: 51, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 52 cost time: 0.907656192779541
Epoch: 52, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 53 cost time: 0.5857915878295898
Epoch: 53, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 54 cost time: 0.6083729267120361
Epoch: 54, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 55 cost time: 0.5736238956451416
Epoch: 55, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 56 cost time: 0.7831063270568848
Epoch: 56, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 57 cost time: 0.6325528621673584
Epoch: 57, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.7478189468383789
Epoch: 58, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 59 cost time: 0.6060631275177002
Epoch: 59, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7221262454986572
Epoch: 60, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6425502300262451
Epoch: 61, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.679011344909668
Epoch: 62, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.641359806060791
Epoch: 63, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.6378204822540283
Epoch: 64, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.6562049388885498
Epoch: 65, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.7752368450164795
Epoch: 66, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.6918621063232422
Epoch: 67, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.6897673606872559
Epoch: 68, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 69 cost time: 0.6105279922485352
Epoch: 69, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.5935280323028564
Epoch: 70, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.4970419406890869
Epoch: 71, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.5018384456634521
Epoch: 72, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.9685890674591064
Epoch: 73, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.7512457370758057
Epoch: 74, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.6625063419342041
Epoch: 75, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.5806922912597656
Epoch: 76, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.697047233581543
Epoch: 77, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 1.1150906085968018
Epoch: 78, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 414622
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.322693347930908
Epoch: 1, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.829 Vali Acc: 0.156 Test Loss: 1.829 Test Acc: 0.156
Validation loss decreased (inf --> -0.155537).  Saving model ...
Epoch: 2 cost time: 0.5558156967163086
Epoch: 2, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.793 Vali Acc: 0.137 Test Loss: 1.793 Test Acc: 0.137
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.504157543182373
Epoch: 3, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.764 Vali Acc: 0.104 Test Loss: 1.764 Test Acc: 0.104
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.7686295509338379
Epoch: 4, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.734 Vali Acc: 0.104 Test Loss: 1.734 Test Acc: 0.104
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6031954288482666
Epoch: 5, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.701 Vali Acc: 0.181 Test Loss: 1.701 Test Acc: 0.181
Validation loss decreased (-0.155537 --> -0.181464).  Saving model ...
Epoch: 6 cost time: 0.5447413921356201
Epoch: 6, Steps: 2 | Train Loss: 1.698 Vali Loss: 1.666 Vali Acc: 0.256 Test Loss: 1.666 Test Acc: 0.256
Validation loss decreased (-0.181464 --> -0.255539).  Saving model ...
Epoch: 7 cost time: 0.6833546161651611
Epoch: 7, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.631 Vali Acc: 0.400 Test Loss: 1.631 Test Acc: 0.400
Validation loss decreased (-0.255539 --> -0.399984).  Saving model ...
Epoch: 8 cost time: 0.5417101383209229
Epoch: 8, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.596 Vali Acc: 0.444 Test Loss: 1.596 Test Acc: 0.444
Validation loss decreased (-0.399984 --> -0.444428).  Saving model ...
Epoch: 9 cost time: 0.6156833171844482
Epoch: 9, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.560 Vali Acc: 0.456 Test Loss: 1.560 Test Acc: 0.456
Validation loss decreased (-0.444428 --> -0.455540).  Saving model ...
Epoch: 10 cost time: 0.6917712688446045
Epoch: 10, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.524 Vali Acc: 0.474 Test Loss: 1.524 Test Acc: 0.474
Validation loss decreased (-0.455540 --> -0.474059).  Saving model ...
Epoch: 11 cost time: 0.5539414882659912
Epoch: 11, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.485 Vali Acc: 0.522 Test Loss: 1.485 Test Acc: 0.522
Validation loss decreased (-0.474059 --> -0.522207).  Saving model ...
Epoch: 12 cost time: 0.7380287647247314
Epoch: 12, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.441 Vali Acc: 0.548 Test Loss: 1.441 Test Acc: 0.548
Validation loss decreased (-0.522207 --> -0.548134).  Saving model ...
Epoch: 13 cost time: 0.6170899868011475
Epoch: 13, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.396 Vali Acc: 0.585 Test Loss: 1.396 Test Acc: 0.585
Validation loss decreased (-0.548134 --> -0.585171).  Saving model ...
Epoch: 14 cost time: 0.5765297412872314
Epoch: 14, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.347 Vali Acc: 0.600 Test Loss: 1.347 Test Acc: 0.600
Validation loss decreased (-0.585171 --> -0.599987).  Saving model ...
Epoch: 15 cost time: 0.5603139400482178
Epoch: 15, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.299 Vali Acc: 0.637 Test Loss: 1.299 Test Acc: 0.637
Validation loss decreased (-0.599987 --> -0.637024).  Saving model ...
Epoch: 16 cost time: 0.8048813343048096
Epoch: 16, Steps: 2 | Train Loss: 1.202 Vali Loss: 1.249 Vali Acc: 0.689 Test Loss: 1.249 Test Acc: 0.689
Validation loss decreased (-0.637024 --> -0.688876).  Saving model ...
Epoch: 17 cost time: 0.7301514148712158
Epoch: 17, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.199 Vali Acc: 0.733 Test Loss: 1.199 Test Acc: 0.733
Validation loss decreased (-0.688876 --> -0.733321).  Saving model ...
Epoch: 18 cost time: 0.6055631637573242
Epoch: 18, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.148 Vali Acc: 0.793 Test Loss: 1.148 Test Acc: 0.793
Validation loss decreased (-0.733321 --> -0.792581).  Saving model ...
Epoch: 19 cost time: 0.589099645614624
Epoch: 19, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.098 Vali Acc: 0.819 Test Loss: 1.098 Test Acc: 0.819
Validation loss decreased (-0.792581 --> -0.818508).  Saving model ...
Epoch: 20 cost time: 0.534351110458374
Epoch: 20, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.047 Vali Acc: 0.837 Test Loss: 1.047 Test Acc: 0.837
Validation loss decreased (-0.818508 --> -0.837027).  Saving model ...
Epoch: 21 cost time: 0.5124492645263672
Epoch: 21, Steps: 2 | Train Loss: 0.950 Vali Loss: 0.996 Vali Acc: 0.859 Test Loss: 0.996 Test Acc: 0.859
Validation loss decreased (-0.837027 --> -0.859249).  Saving model ...
Epoch: 22 cost time: 0.6115589141845703
Epoch: 22, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.943 Vali Acc: 0.859 Test Loss: 0.943 Test Acc: 0.859
Validation loss decreased (-0.859249 --> -0.859250).  Saving model ...
Epoch: 23 cost time: 0.5763297080993652
Epoch: 23, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.893 Vali Acc: 0.878 Test Loss: 0.893 Test Acc: 0.878
Validation loss decreased (-0.859250 --> -0.877769).  Saving model ...
Epoch: 24 cost time: 0.5864968299865723
Epoch: 24, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.841 Vali Acc: 0.907 Test Loss: 0.841 Test Acc: 0.907
Validation loss decreased (-0.877769 --> -0.907399).  Saving model ...
Epoch: 25 cost time: 0.608393669128418
Epoch: 25, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.792 Vali Acc: 0.900 Test Loss: 0.792 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5845010280609131
Epoch: 26, Steps: 2 | Train Loss: 0.674 Vali Loss: 0.746 Vali Acc: 0.907 Test Loss: 0.746 Test Acc: 0.907
Validation loss decreased (-0.907399 --> -0.907400).  Saving model ...
Epoch: 27 cost time: 0.5490841865539551
Epoch: 27, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.703 Vali Acc: 0.922 Test Loss: 0.703 Test Acc: 0.922
Validation loss decreased (-0.907400 --> -0.922215).  Saving model ...
Epoch: 28 cost time: 0.537369966506958
Epoch: 28, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.660 Vali Acc: 0.926 Test Loss: 0.660 Test Acc: 0.926
Validation loss decreased (-0.922215 --> -0.925919).  Saving model ...
Epoch: 29 cost time: 0.6779758930206299
Epoch: 29, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.619 Vali Acc: 0.937 Test Loss: 0.619 Test Acc: 0.937
Validation loss decreased (-0.925919 --> -0.937031).  Saving model ...
Epoch: 30 cost time: 0.6246514320373535
Epoch: 30, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.581 Vali Acc: 0.933 Test Loss: 0.581 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5419280529022217
Epoch: 31, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.546 Vali Acc: 0.941 Test Loss: 0.546 Test Acc: 0.941
Validation loss decreased (-0.937031 --> -0.940735).  Saving model ...
Epoch: 32 cost time: 0.6491835117340088
Epoch: 32, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.513 Vali Acc: 0.944 Test Loss: 0.513 Test Acc: 0.944
Validation loss decreased (-0.940735 --> -0.944439).  Saving model ...
Epoch: 33 cost time: 0.5809235572814941
Epoch: 33, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.483 Vali Acc: 0.937 Test Loss: 0.483 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7022194862365723
Epoch: 34, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.453 Vali Acc: 0.944 Test Loss: 0.453 Test Acc: 0.944
Validation loss decreased (-0.944439 --> -0.944440).  Saving model ...
Epoch: 35 cost time: 0.7565631866455078
Epoch: 35, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.427 Vali Acc: 0.944 Test Loss: 0.427 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 36 cost time: 0.6409251689910889
Epoch: 36, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.403 Vali Acc: 0.944 Test Loss: 0.403 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 37 cost time: 0.5831637382507324
Epoch: 37, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.382 Vali Acc: 0.941 Test Loss: 0.382 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5724825859069824
Epoch: 38, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.361 Vali Acc: 0.948 Test Loss: 0.361 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948145).  Saving model ...
Epoch: 39 cost time: 0.5482771396636963
Epoch: 39, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.344 Vali Acc: 0.948 Test Loss: 0.344 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 40 cost time: 0.6420333385467529
Epoch: 40, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.328 Vali Acc: 0.944 Test Loss: 0.328 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6333651542663574
Epoch: 41, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.312 Vali Acc: 0.944 Test Loss: 0.312 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6825211048126221
Epoch: 42, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.299 Vali Acc: 0.944 Test Loss: 0.299 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7635259628295898
Epoch: 43, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.288 Vali Acc: 0.944 Test Loss: 0.288 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6392955780029297
Epoch: 44, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7203032970428467
Epoch: 45, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7274580001831055
Epoch: 46, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5580248832702637
Epoch: 47, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.57694411277771
Epoch: 48, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.5706448554992676
Epoch: 49, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 414238
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1258938312530518
Epoch: 1, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.771 Vali Acc: 0.230 Test Loss: 1.771 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.6080846786499023
Epoch: 2, Steps: 2 | Train Loss: 1.821 Vali Loss: 1.739 Vali Acc: 0.244 Test Loss: 1.739 Test Acc: 0.244
Validation loss decreased (-0.229612 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 0.606560468673706
Epoch: 3, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.712 Vali Acc: 0.248 Test Loss: 1.712 Test Acc: 0.248
Validation loss decreased (-0.244427 --> -0.248131).  Saving model ...
Epoch: 4 cost time: 0.6119339466094971
Epoch: 4, Steps: 2 | Train Loss: 1.718 Vali Loss: 1.682 Vali Acc: 0.270 Test Loss: 1.682 Test Acc: 0.270
Validation loss decreased (-0.248131 --> -0.270354).  Saving model ...
Epoch: 5 cost time: 0.5719993114471436
Epoch: 5, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.646 Vali Acc: 0.263 Test Loss: 1.646 Test Acc: 0.263
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7288188934326172
Epoch: 6, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.606 Vali Acc: 0.319 Test Loss: 1.606 Test Acc: 0.319
Validation loss decreased (-0.270354 --> -0.318502).  Saving model ...
Epoch: 7 cost time: 0.6597373485565186
Epoch: 7, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.566 Vali Acc: 0.385 Test Loss: 1.566 Test Acc: 0.385
Validation loss decreased (-0.318502 --> -0.385170).  Saving model ...
Epoch: 8 cost time: 0.6245548725128174
Epoch: 8, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.528 Vali Acc: 0.541 Test Loss: 1.528 Test Acc: 0.541
Validation loss decreased (-0.385170 --> -0.540725).  Saving model ...
Epoch: 9 cost time: 0.5308570861816406
Epoch: 9, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.490 Vali Acc: 0.607 Test Loss: 1.490 Test Acc: 0.607
Validation loss decreased (-0.540725 --> -0.607393).  Saving model ...
Epoch: 10 cost time: 0.6289691925048828
Epoch: 10, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.452 Vali Acc: 0.585 Test Loss: 1.452 Test Acc: 0.585
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6169569492340088
Epoch: 11, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.411 Vali Acc: 0.593 Test Loss: 1.411 Test Acc: 0.593
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5037047863006592
Epoch: 12, Steps: 2 | Train Loss: 1.438 Vali Loss: 1.366 Vali Acc: 0.637 Test Loss: 1.366 Test Acc: 0.637
Validation loss decreased (-0.607393 --> -0.637023).  Saving model ...
Epoch: 13 cost time: 0.5260682106018066
Epoch: 13, Steps: 2 | Train Loss: 1.334 Vali Loss: 1.321 Vali Acc: 0.667 Test Loss: 1.321 Test Acc: 0.667
Validation loss decreased (-0.637023 --> -0.666653).  Saving model ...
Epoch: 14 cost time: 0.5376112461090088
Epoch: 14, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.272 Vali Acc: 0.719 Test Loss: 1.272 Test Acc: 0.719
Validation loss decreased (-0.666653 --> -0.718506).  Saving model ...
Epoch: 15 cost time: 0.5830540657043457
Epoch: 15, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.221 Vali Acc: 0.756 Test Loss: 1.221 Test Acc: 0.756
Validation loss decreased (-0.718506 --> -0.755543).  Saving model ...
Epoch: 16 cost time: 0.647200345993042
Epoch: 16, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.168 Vali Acc: 0.778 Test Loss: 1.168 Test Acc: 0.778
Validation loss decreased (-0.755543 --> -0.777766).  Saving model ...
Epoch: 17 cost time: 0.8542301654815674
Epoch: 17, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.117 Vali Acc: 0.789 Test Loss: 1.117 Test Acc: 0.789
Validation loss decreased (-0.777766 --> -0.788878).  Saving model ...
Epoch: 18 cost time: 0.6471316814422607
Epoch: 18, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.065 Vali Acc: 0.770 Test Loss: 1.065 Test Acc: 0.770
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7496578693389893
Epoch: 19, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.014 Vali Acc: 0.789 Test Loss: 1.014 Test Acc: 0.789
Validation loss decreased (-0.788878 --> -0.788879).  Saving model ...
Epoch: 20 cost time: 0.7048048973083496
Epoch: 20, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.963 Vali Acc: 0.800 Test Loss: 0.963 Test Acc: 0.800
Validation loss decreased (-0.788879 --> -0.799990).  Saving model ...
Epoch: 21 cost time: 0.7152812480926514
Epoch: 21, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.911 Vali Acc: 0.833 Test Loss: 0.911 Test Acc: 0.833
Validation loss decreased (-0.799990 --> -0.833324).  Saving model ...
Epoch: 22 cost time: 0.6488151550292969
Epoch: 22, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.861 Vali Acc: 0.848 Test Loss: 0.861 Test Acc: 0.848
Validation loss decreased (-0.833324 --> -0.848140).  Saving model ...
Epoch: 23 cost time: 0.7695856094360352
Epoch: 23, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.812 Vali Acc: 0.863 Test Loss: 0.812 Test Acc: 0.863
Validation loss decreased (-0.848140 --> -0.862955).  Saving model ...
Epoch: 24 cost time: 0.7125029563903809
Epoch: 24, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.765 Vali Acc: 0.885 Test Loss: 0.765 Test Acc: 0.885
Validation loss decreased (-0.862955 --> -0.885178).  Saving model ...
Epoch: 25 cost time: 0.5532093048095703
Epoch: 25, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.721 Vali Acc: 0.885 Test Loss: 0.721 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885178).  Saving model ...
Epoch: 26 cost time: 0.6652693748474121
Epoch: 26, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.681 Vali Acc: 0.893 Test Loss: 0.681 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 27 cost time: 0.6198587417602539
Epoch: 27, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.643 Vali Acc: 0.889 Test Loss: 0.643 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7860326766967773
Epoch: 28, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.605 Vali Acc: 0.889 Test Loss: 0.605 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7019515037536621
Epoch: 29, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.571 Vali Acc: 0.893 Test Loss: 0.571 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 30 cost time: 0.6118712425231934
Epoch: 30, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.535 Vali Acc: 0.900 Test Loss: 0.535 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 31 cost time: 0.8364267349243164
Epoch: 31, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.501 Vali Acc: 0.907 Test Loss: 0.501 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907402).  Saving model ...
Epoch: 32 cost time: 0.554112434387207
Epoch: 32, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.468 Vali Acc: 0.922 Test Loss: 0.468 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922218).  Saving model ...
Epoch: 33 cost time: 0.6682155132293701
Epoch: 33, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.438 Vali Acc: 0.941 Test Loss: 0.438 Test Acc: 0.941
Validation loss decreased (-0.922218 --> -0.940736).  Saving model ...
Epoch: 34 cost time: 0.6667277812957764
Epoch: 34, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.412 Vali Acc: 0.941 Test Loss: 0.412 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940737).  Saving model ...
Epoch: 35 cost time: 0.7454228401184082
Epoch: 35, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.388 Vali Acc: 0.937 Test Loss: 0.388 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6152513027191162
Epoch: 36, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.367 Vali Acc: 0.944 Test Loss: 0.367 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 37 cost time: 0.6632964611053467
Epoch: 37, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.349 Vali Acc: 0.937 Test Loss: 0.349 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5974814891815186
Epoch: 38, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.334 Vali Acc: 0.930 Test Loss: 0.334 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6849877834320068
Epoch: 39, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.643695592880249
Epoch: 40, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.312 Vali Acc: 0.922 Test Loss: 0.312 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5750181674957275
Epoch: 41, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.8573052883148193
Epoch: 42, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.287 Vali Acc: 0.930 Test Loss: 0.287 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.028130292892456
Epoch: 43, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.0192697048187256
Epoch: 44, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.825023889541626
Epoch: 45, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.257 Vali Acc: 0.941 Test Loss: 0.257 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7003846168518066
Epoch: 46, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 413854
model size : 2.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0931379795074463
Epoch: 1, Steps: 2 | Train Loss: 2.126 Vali Loss: 2.093 Vali Acc: 0.044 Test Loss: 2.093 Test Acc: 0.044
Validation loss decreased (inf --> -0.044424).  Saving model ...
Epoch: 2 cost time: 0.547590970993042
Epoch: 2, Steps: 2 | Train Loss: 2.087 Vali Loss: 2.056 Vali Acc: 0.037 Test Loss: 2.056 Test Acc: 0.037
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.491025447845459
Epoch: 3, Steps: 2 | Train Loss: 2.003 Vali Loss: 2.031 Vali Acc: 0.037 Test Loss: 2.031 Test Acc: 0.037
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.4911017417907715
Epoch: 4, Steps: 2 | Train Loss: 1.970 Vali Loss: 2.004 Vali Acc: 0.041 Test Loss: 2.004 Test Acc: 0.041
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.5749125480651855
Epoch: 5, Steps: 2 | Train Loss: 1.984 Vali Loss: 1.969 Vali Acc: 0.056 Test Loss: 1.969 Test Acc: 0.056
Validation loss decreased (-0.044424 --> -0.055536).  Saving model ...
Epoch: 6 cost time: 0.5524499416351318
Epoch: 6, Steps: 2 | Train Loss: 1.975 Vali Loss: 1.931 Vali Acc: 0.078 Test Loss: 1.931 Test Acc: 0.078
Validation loss decreased (-0.055536 --> -0.077758).  Saving model ...
Epoch: 7 cost time: 0.5534994602203369
Epoch: 7, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.890 Vali Acc: 0.100 Test Loss: 1.890 Test Acc: 0.100
Validation loss decreased (-0.077758 --> -0.099981).  Saving model ...
Epoch: 8 cost time: 0.6046810150146484
Epoch: 8, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.848 Vali Acc: 0.130 Test Loss: 1.848 Test Acc: 0.130
Validation loss decreased (-0.099981 --> -0.129611).  Saving model ...
Epoch: 9 cost time: 0.5396802425384521
Epoch: 9, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.804 Vali Acc: 0.167 Test Loss: 1.804 Test Acc: 0.167
Validation loss decreased (-0.129611 --> -0.166649).  Saving model ...
Epoch: 10 cost time: 0.7040066719055176
Epoch: 10, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.761 Vali Acc: 0.215 Test Loss: 1.761 Test Acc: 0.215
Validation loss decreased (-0.166649 --> -0.214797).  Saving model ...
Epoch: 11 cost time: 0.6576464176177979
Epoch: 11, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.719 Vali Acc: 0.259 Test Loss: 1.719 Test Acc: 0.259
Validation loss decreased (-0.214797 --> -0.259242).  Saving model ...
Epoch: 12 cost time: 0.512476921081543
Epoch: 12, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.677 Vali Acc: 0.319 Test Loss: 1.677 Test Acc: 0.319
Validation loss decreased (-0.259242 --> -0.318502).  Saving model ...
Epoch: 13 cost time: 0.49877095222473145
Epoch: 13, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.632 Vali Acc: 0.374 Test Loss: 1.632 Test Acc: 0.374
Validation loss decreased (-0.318502 --> -0.374058).  Saving model ...
Epoch: 14 cost time: 0.6393623352050781
Epoch: 14, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.584 Vali Acc: 0.500 Test Loss: 1.584 Test Acc: 0.500
Validation loss decreased (-0.374058 --> -0.499984).  Saving model ...
Epoch: 15 cost time: 0.5236175060272217
Epoch: 15, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.534 Vali Acc: 0.593 Test Loss: 1.534 Test Acc: 0.593
Validation loss decreased (-0.499984 --> -0.592577).  Saving model ...
Epoch: 16 cost time: 0.6564819812774658
Epoch: 16, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.483 Vali Acc: 0.652 Test Loss: 1.483 Test Acc: 0.652
Validation loss decreased (-0.592577 --> -0.651837).  Saving model ...
Epoch: 17 cost time: 0.6586196422576904
Epoch: 17, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.431 Vali Acc: 0.663 Test Loss: 1.431 Test Acc: 0.663
Validation loss decreased (-0.651837 --> -0.662949).  Saving model ...
Epoch: 18 cost time: 0.5481569766998291
Epoch: 18, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.378 Vali Acc: 0.689 Test Loss: 1.378 Test Acc: 0.689
Validation loss decreased (-0.662949 --> -0.688875).  Saving model ...
Epoch: 19 cost time: 0.6420938968658447
Epoch: 19, Steps: 2 | Train Loss: 1.303 Vali Loss: 1.328 Vali Acc: 0.711 Test Loss: 1.328 Test Acc: 0.711
Validation loss decreased (-0.688875 --> -0.711098).  Saving model ...
Epoch: 20 cost time: 0.7248294353485107
Epoch: 20, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.275 Vali Acc: 0.744 Test Loss: 1.275 Test Acc: 0.744
Validation loss decreased (-0.711098 --> -0.744432).  Saving model ...
Epoch: 21 cost time: 0.5058624744415283
Epoch: 21, Steps: 2 | Train Loss: 1.137 Vali Loss: 1.223 Vali Acc: 0.770 Test Loss: 1.223 Test Acc: 0.770
Validation loss decreased (-0.744432 --> -0.770358).  Saving model ...
Epoch: 22 cost time: 0.54705810546875
Epoch: 22, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.171 Vali Acc: 0.778 Test Loss: 1.171 Test Acc: 0.778
Validation loss decreased (-0.770358 --> -0.777766).  Saving model ...
Epoch: 23 cost time: 0.4820277690887451
Epoch: 23, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.120 Vali Acc: 0.796 Test Loss: 1.120 Test Acc: 0.796
Validation loss decreased (-0.777766 --> -0.796285).  Saving model ...
Epoch: 24 cost time: 0.5408539772033691
Epoch: 24, Steps: 2 | Train Loss: 0.953 Vali Loss: 1.070 Vali Acc: 0.796 Test Loss: 1.070 Test Acc: 0.796
Validation loss decreased (-0.796285 --> -0.796286).  Saving model ...
Epoch: 25 cost time: 0.5308506488800049
Epoch: 25, Steps: 2 | Train Loss: 0.909 Vali Loss: 1.020 Vali Acc: 0.811 Test Loss: 1.020 Test Acc: 0.811
Validation loss decreased (-0.796286 --> -0.811101).  Saving model ...
Epoch: 26 cost time: 0.7717788219451904
Epoch: 26, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.968 Vali Acc: 0.833 Test Loss: 0.968 Test Acc: 0.833
Validation loss decreased (-0.811101 --> -0.833324).  Saving model ...
Epoch: 27 cost time: 0.593407154083252
Epoch: 27, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.919 Vali Acc: 0.841 Test Loss: 0.919 Test Acc: 0.841
Validation loss decreased (-0.833324 --> -0.840732).  Saving model ...
Epoch: 28 cost time: 0.6676821708679199
Epoch: 28, Steps: 2 | Train Loss: 0.754 Vali Loss: 0.867 Vali Acc: 0.859 Test Loss: 0.867 Test Acc: 0.859
Validation loss decreased (-0.840732 --> -0.859251).  Saving model ...
Epoch: 29 cost time: 0.6062092781066895
Epoch: 29, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.813 Vali Acc: 0.893 Test Loss: 0.813 Test Acc: 0.893
Validation loss decreased (-0.859251 --> -0.892584).  Saving model ...
Epoch: 30 cost time: 0.5451231002807617
Epoch: 30, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.762 Vali Acc: 0.907 Test Loss: 0.762 Test Acc: 0.907
Validation loss decreased (-0.892584 --> -0.907400).  Saving model ...
Epoch: 31 cost time: 0.5465970039367676
Epoch: 31, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.714 Vali Acc: 0.904 Test Loss: 0.714 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5855855941772461
Epoch: 32, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.669 Vali Acc: 0.904 Test Loss: 0.669 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6202268600463867
Epoch: 33, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.628 Vali Acc: 0.904 Test Loss: 0.628 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.575237512588501
Epoch: 34, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.589 Vali Acc: 0.904 Test Loss: 0.589 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5952868461608887
Epoch: 35, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.554 Vali Acc: 0.919 Test Loss: 0.554 Test Acc: 0.919
Validation loss decreased (-0.907400 --> -0.918513).  Saving model ...
Epoch: 36 cost time: 0.5656039714813232
Epoch: 36, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.522 Vali Acc: 0.926 Test Loss: 0.522 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 37 cost time: 0.6732127666473389
Epoch: 37, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.492 Vali Acc: 0.926 Test Loss: 0.492 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 38 cost time: 0.66695237159729
Epoch: 38, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.467 Vali Acc: 0.922 Test Loss: 0.467 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7939198017120361
Epoch: 39, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.445 Vali Acc: 0.919 Test Loss: 0.445 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.9688990116119385
Epoch: 40, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.424 Vali Acc: 0.919 Test Loss: 0.424 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6203675270080566
Epoch: 41, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.402 Vali Acc: 0.919 Test Loss: 0.402 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6190686225891113
Epoch: 42, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.380 Vali Acc: 0.922 Test Loss: 0.380 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.5862929821014404
Epoch: 43, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.362 Vali Acc: 0.926 Test Loss: 0.362 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 44 cost time: 0.6263012886047363
Epoch: 44, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5157830715179443
Epoch: 45, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.328 Vali Acc: 0.930 Test Loss: 0.328 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 46 cost time: 0.5622696876525879
Epoch: 46, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.315 Vali Acc: 0.930 Test Loss: 0.315 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 47 cost time: 0.5624241828918457
Epoch: 47, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 48 cost time: 0.5648238658905029
Epoch: 48, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 49 cost time: 0.6309363842010498
Epoch: 49, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7133541107177734
Epoch: 50, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.560413122177124
Epoch: 51, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8462553024291992
Epoch: 52, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.49848270416259766
Epoch: 53, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.7117447853088379
Epoch: 54, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.5765070915222168
Epoch: 55, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.598630428314209
Epoch: 56, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.5423142910003662
Epoch: 57, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.6541898250579834
Epoch: 58, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 315934
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2752339839935303
Epoch: 1, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.858 Vali Acc: 0.107 Test Loss: 1.858 Test Acc: 0.107
Validation loss decreased (inf --> -0.107389).  Saving model ...
Epoch: 2 cost time: 0.5577471256256104
Epoch: 2, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.834 Vali Acc: 0.107 Test Loss: 1.834 Test Acc: 0.107
Validation loss decreased (-0.107389 --> -0.107389).  Saving model ...
Epoch: 3 cost time: 0.6735849380493164
Epoch: 3, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.816 Vali Acc: 0.111 Test Loss: 1.816 Test Acc: 0.111
Validation loss decreased (-0.107389 --> -0.111093).  Saving model ...
Epoch: 4 cost time: 0.6462364196777344
Epoch: 4, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.797 Vali Acc: 0.115 Test Loss: 1.797 Test Acc: 0.115
Validation loss decreased (-0.111093 --> -0.114797).  Saving model ...
Epoch: 5 cost time: 0.6725339889526367
Epoch: 5, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.773 Vali Acc: 0.141 Test Loss: 1.773 Test Acc: 0.141
Validation loss decreased (-0.114797 --> -0.140723).  Saving model ...
Epoch: 6 cost time: 0.5886263847351074
Epoch: 6, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.747 Vali Acc: 0.193 Test Loss: 1.747 Test Acc: 0.193
Validation loss decreased (-0.140723 --> -0.192575).  Saving model ...
Epoch: 7 cost time: 0.5445160865783691
Epoch: 7, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.717 Vali Acc: 0.274 Test Loss: 1.717 Test Acc: 0.274
Validation loss decreased (-0.192575 --> -0.274057).  Saving model ...
Epoch: 8 cost time: 0.5419607162475586
Epoch: 8, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.683 Vali Acc: 0.344 Test Loss: 1.683 Test Acc: 0.344
Validation loss decreased (-0.274057 --> -0.344428).  Saving model ...
Epoch: 9 cost time: 0.673121452331543
Epoch: 9, Steps: 2 | Train Loss: 1.646 Vali Loss: 1.647 Vali Acc: 0.404 Test Loss: 1.647 Test Acc: 0.404
Validation loss decreased (-0.344428 --> -0.403687).  Saving model ...
Epoch: 10 cost time: 0.6200778484344482
Epoch: 10, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.608 Vali Acc: 0.485 Test Loss: 1.608 Test Acc: 0.485
Validation loss decreased (-0.403687 --> -0.485169).  Saving model ...
Epoch: 11 cost time: 0.5574467182159424
Epoch: 11, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.567 Vali Acc: 0.541 Test Loss: 1.567 Test Acc: 0.541
Validation loss decreased (-0.485169 --> -0.540725).  Saving model ...
Epoch: 12 cost time: 0.6663150787353516
Epoch: 12, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.525 Vali Acc: 0.593 Test Loss: 1.525 Test Acc: 0.593
Validation loss decreased (-0.540725 --> -0.592577).  Saving model ...
Epoch: 13 cost time: 0.6476864814758301
Epoch: 13, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.482 Vali Acc: 0.633 Test Loss: 1.482 Test Acc: 0.633
Validation loss decreased (-0.592577 --> -0.633319).  Saving model ...
Epoch: 14 cost time: 0.6074264049530029
Epoch: 14, Steps: 2 | Train Loss: 1.393 Vali Loss: 1.438 Vali Acc: 0.674 Test Loss: 1.438 Test Acc: 0.674
Validation loss decreased (-0.633319 --> -0.674060).  Saving model ...
Epoch: 15 cost time: 0.6394615173339844
Epoch: 15, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.393 Vali Acc: 0.711 Test Loss: 1.393 Test Acc: 0.711
Validation loss decreased (-0.674060 --> -0.711097).  Saving model ...
Epoch: 16 cost time: 0.658405065536499
Epoch: 16, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.348 Vali Acc: 0.741 Test Loss: 1.348 Test Acc: 0.741
Validation loss decreased (-0.711097 --> -0.740727).  Saving model ...
Epoch: 17 cost time: 0.6976602077484131
Epoch: 17, Steps: 2 | Train Loss: 1.273 Vali Loss: 1.300 Vali Acc: 0.759 Test Loss: 1.300 Test Acc: 0.759
Validation loss decreased (-0.740727 --> -0.759246).  Saving model ...
Epoch: 18 cost time: 0.7637531757354736
Epoch: 18, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.252 Vali Acc: 0.759 Test Loss: 1.252 Test Acc: 0.759
Validation loss decreased (-0.759246 --> -0.759247).  Saving model ...
Epoch: 19 cost time: 0.6599571704864502
Epoch: 19, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.203 Vali Acc: 0.770 Test Loss: 1.203 Test Acc: 0.770
Validation loss decreased (-0.759247 --> -0.770358).  Saving model ...
Epoch: 20 cost time: 0.7158467769622803
Epoch: 20, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.153 Vali Acc: 0.785 Test Loss: 1.153 Test Acc: 0.785
Validation loss decreased (-0.770358 --> -0.785174).  Saving model ...
Epoch: 21 cost time: 0.5970871448516846
Epoch: 21, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.102 Vali Acc: 0.819 Test Loss: 1.102 Test Acc: 0.819
Validation loss decreased (-0.785174 --> -0.818508).  Saving model ...
Epoch: 22 cost time: 0.6214375495910645
Epoch: 22, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.052 Vali Acc: 0.833 Test Loss: 1.052 Test Acc: 0.833
Validation loss decreased (-0.818508 --> -0.833323).  Saving model ...
Epoch: 23 cost time: 0.5338196754455566
Epoch: 23, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.003 Vali Acc: 0.837 Test Loss: 1.003 Test Acc: 0.837
Validation loss decreased (-0.833323 --> -0.837027).  Saving model ...
Epoch: 24 cost time: 0.5256242752075195
Epoch: 24, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.951 Vali Acc: 0.848 Test Loss: 0.951 Test Acc: 0.848
Validation loss decreased (-0.837027 --> -0.848139).  Saving model ...
Epoch: 25 cost time: 0.5289335250854492
Epoch: 25, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.900 Vali Acc: 0.867 Test Loss: 0.900 Test Acc: 0.867
Validation loss decreased (-0.848139 --> -0.866658).  Saving model ...
Epoch: 26 cost time: 0.45073843002319336
Epoch: 26, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.851 Vali Acc: 0.904 Test Loss: 0.851 Test Acc: 0.904
Validation loss decreased (-0.866658 --> -0.903695).  Saving model ...
Epoch: 27 cost time: 0.6425902843475342
Epoch: 27, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.802 Vali Acc: 0.919 Test Loss: 0.802 Test Acc: 0.919
Validation loss decreased (-0.903695 --> -0.918510).  Saving model ...
Epoch: 28 cost time: 0.6032593250274658
Epoch: 28, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.756 Vali Acc: 0.933 Test Loss: 0.756 Test Acc: 0.933
Validation loss decreased (-0.918510 --> -0.933326).  Saving model ...
Epoch: 29 cost time: 0.646242618560791
Epoch: 29, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.714 Vali Acc: 0.930 Test Loss: 0.714 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6001462936401367
Epoch: 30, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.675 Vali Acc: 0.926 Test Loss: 0.675 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6431369781494141
Epoch: 31, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.633 Vali Acc: 0.944 Test Loss: 0.633 Test Acc: 0.944
Validation loss decreased (-0.933326 --> -0.944438).  Saving model ...
Epoch: 32 cost time: 0.6788763999938965
Epoch: 32, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.595 Vali Acc: 0.944 Test Loss: 0.595 Test Acc: 0.944
Validation loss decreased (-0.944438 --> -0.944438).  Saving model ...
Epoch: 33 cost time: 0.5328836441040039
Epoch: 33, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.559 Vali Acc: 0.952 Test Loss: 0.559 Test Acc: 0.952
Validation loss decreased (-0.944438 --> -0.951846).  Saving model ...
Epoch: 34 cost time: 0.5164089202880859
Epoch: 34, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.526 Vali Acc: 0.952 Test Loss: 0.526 Test Acc: 0.952
Validation loss decreased (-0.951846 --> -0.951847).  Saving model ...
Epoch: 35 cost time: 0.6293156147003174
Epoch: 35, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.497 Vali Acc: 0.952 Test Loss: 0.497 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951847).  Saving model ...
Epoch: 36 cost time: 0.6845767498016357
Epoch: 36, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.469 Vali Acc: 0.948 Test Loss: 0.469 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6529793739318848
Epoch: 37, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.445 Vali Acc: 0.944 Test Loss: 0.445 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6730384826660156
Epoch: 38, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.423 Vali Acc: 0.941 Test Loss: 0.423 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.864574670791626
Epoch: 39, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.403 Vali Acc: 0.941 Test Loss: 0.403 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.8078732490539551
Epoch: 40, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.384 Vali Acc: 0.941 Test Loss: 0.384 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8911886215209961
Epoch: 41, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.363 Vali Acc: 0.948 Test Loss: 0.363 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6891846656799316
Epoch: 42, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.345 Vali Acc: 0.941 Test Loss: 0.345 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.6466879844665527
Epoch: 43, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.328 Vali Acc: 0.952 Test Loss: 0.328 Test Acc: 0.952
Validation loss decreased (-0.951847 --> -0.951849).  Saving model ...
Epoch: 44 cost time: 0.6564650535583496
Epoch: 44, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.315 Vali Acc: 0.956 Test Loss: 0.315 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955552).  Saving model ...
Epoch: 45 cost time: 0.6948678493499756
Epoch: 45, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.305 Vali Acc: 0.952 Test Loss: 0.305 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8568515777587891
Epoch: 46, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.297 Vali Acc: 0.944 Test Loss: 0.297 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.7194292545318604
Epoch: 47, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.289 Vali Acc: 0.944 Test Loss: 0.289 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.6476168632507324
Epoch: 48, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.7184579372406006
Epoch: 49, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.6803507804870605
Epoch: 50, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.274 Vali Acc: 0.937 Test Loss: 0.274 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.7350857257843018
Epoch: 51, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.269 Vali Acc: 0.941 Test Loss: 0.269 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.6956882476806641
Epoch: 52, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.7544527053833008
Epoch: 53, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.7018454074859619
Epoch: 54, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 315550
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.316225290298462
Epoch: 1, Steps: 2 | Train Loss: 1.910 Vali Loss: 1.870 Vali Acc: 0.144 Test Loss: 1.870 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.6870861053466797
Epoch: 2, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.836 Vali Acc: 0.141 Test Loss: 1.836 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6801373958587646
Epoch: 3, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.812 Vali Acc: 0.144 Test Loss: 1.812 Test Acc: 0.144
Validation loss decreased (-0.144426 --> -0.144426).  Saving model ...
Epoch: 4 cost time: 0.6054301261901855
Epoch: 4, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.787 Vali Acc: 0.159 Test Loss: 1.787 Test Acc: 0.159
Validation loss decreased (-0.144426 --> -0.159241).  Saving model ...
Epoch: 5 cost time: 0.5820920467376709
Epoch: 5, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.756 Vali Acc: 0.215 Test Loss: 1.756 Test Acc: 0.215
Validation loss decreased (-0.159241 --> -0.214797).  Saving model ...
Epoch: 6 cost time: 0.6694772243499756
Epoch: 6, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.722 Vali Acc: 0.319 Test Loss: 1.722 Test Acc: 0.319
Validation loss decreased (-0.214797 --> -0.318501).  Saving model ...
Epoch: 7 cost time: 0.5921618938446045
Epoch: 7, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.686 Vali Acc: 0.378 Test Loss: 1.686 Test Acc: 0.378
Validation loss decreased (-0.318501 --> -0.377761).  Saving model ...
Epoch: 8 cost time: 0.6244709491729736
Epoch: 8, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.647 Vali Acc: 0.411 Test Loss: 1.647 Test Acc: 0.411
Validation loss decreased (-0.377761 --> -0.411095).  Saving model ...
Epoch: 9 cost time: 0.5955207347869873
Epoch: 9, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.607 Vali Acc: 0.481 Test Loss: 1.607 Test Acc: 0.481
Validation loss decreased (-0.411095 --> -0.481465).  Saving model ...
Epoch: 10 cost time: 0.6556403636932373
Epoch: 10, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.564 Vali Acc: 0.537 Test Loss: 1.564 Test Acc: 0.537
Validation loss decreased (-0.481465 --> -0.537021).  Saving model ...
Epoch: 11 cost time: 0.6288726329803467
Epoch: 11, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.520 Vali Acc: 0.563 Test Loss: 1.520 Test Acc: 0.563
Validation loss decreased (-0.537021 --> -0.562948).  Saving model ...
Epoch: 12 cost time: 0.5429549217224121
Epoch: 12, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.476 Vali Acc: 0.619 Test Loss: 1.476 Test Acc: 0.619
Validation loss decreased (-0.562948 --> -0.618504).  Saving model ...
Epoch: 13 cost time: 0.7717013359069824
Epoch: 13, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.429 Vali Acc: 0.659 Test Loss: 1.429 Test Acc: 0.659
Validation loss decreased (-0.618504 --> -0.659245).  Saving model ...
Epoch: 14 cost time: 0.7333166599273682
Epoch: 14, Steps: 2 | Train Loss: 1.415 Vali Loss: 1.383 Vali Acc: 0.700 Test Loss: 1.383 Test Acc: 0.700
Validation loss decreased (-0.659245 --> -0.699986).  Saving model ...
Epoch: 15 cost time: 0.5435018539428711
Epoch: 15, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.336 Vali Acc: 0.748 Test Loss: 1.336 Test Acc: 0.748
Validation loss decreased (-0.699986 --> -0.748135).  Saving model ...
Epoch: 16 cost time: 0.5661258697509766
Epoch: 16, Steps: 2 | Train Loss: 1.320 Vali Loss: 1.288 Vali Acc: 0.778 Test Loss: 1.288 Test Acc: 0.778
Validation loss decreased (-0.748135 --> -0.777765).  Saving model ...
Epoch: 17 cost time: 0.6302680969238281
Epoch: 17, Steps: 2 | Train Loss: 1.200 Vali Loss: 1.240 Vali Acc: 0.793 Test Loss: 1.240 Test Acc: 0.793
Validation loss decreased (-0.777765 --> -0.792580).  Saving model ...
Epoch: 18 cost time: 0.790748119354248
Epoch: 18, Steps: 2 | Train Loss: 1.167 Vali Loss: 1.193 Vali Acc: 0.830 Test Loss: 1.193 Test Acc: 0.830
Validation loss decreased (-0.792580 --> -0.829618).  Saving model ...
Epoch: 19 cost time: 0.5831046104431152
Epoch: 19, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.145 Vali Acc: 0.856 Test Loss: 1.145 Test Acc: 0.856
Validation loss decreased (-0.829618 --> -0.855544).  Saving model ...
Epoch: 20 cost time: 0.5946798324584961
Epoch: 20, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.096 Vali Acc: 0.863 Test Loss: 1.096 Test Acc: 0.863
Validation loss decreased (-0.855544 --> -0.862952).  Saving model ...
Epoch: 21 cost time: 0.5372591018676758
Epoch: 21, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.048 Vali Acc: 0.867 Test Loss: 1.048 Test Acc: 0.867
Validation loss decreased (-0.862952 --> -0.866656).  Saving model ...
Epoch: 22 cost time: 0.5637049674987793
Epoch: 22, Steps: 2 | Train Loss: 1.028 Vali Loss: 1.001 Vali Acc: 0.874 Test Loss: 1.001 Test Acc: 0.874
Validation loss decreased (-0.866656 --> -0.874064).  Saving model ...
Epoch: 23 cost time: 0.6998481750488281
Epoch: 23, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.955 Vali Acc: 0.885 Test Loss: 0.955 Test Acc: 0.885
Validation loss decreased (-0.874064 --> -0.885176).  Saving model ...
Epoch: 24 cost time: 0.5538640022277832
Epoch: 24, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.907 Vali Acc: 0.904 Test Loss: 0.907 Test Acc: 0.904
Validation loss decreased (-0.885176 --> -0.903695).  Saving model ...
Epoch: 25 cost time: 0.5436618328094482
Epoch: 25, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.862 Vali Acc: 0.904 Test Loss: 0.862 Test Acc: 0.904
Validation loss decreased (-0.903695 --> -0.903695).  Saving model ...
Epoch: 26 cost time: 0.5394976139068604
Epoch: 26, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.816 Vali Acc: 0.900 Test Loss: 0.816 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6686639785766602
Epoch: 27, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.771 Vali Acc: 0.904 Test Loss: 0.771 Test Acc: 0.904
Validation loss decreased (-0.903695 --> -0.903696).  Saving model ...
Epoch: 28 cost time: 0.5551896095275879
Epoch: 28, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.728 Vali Acc: 0.900 Test Loss: 0.728 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.47249412536621094
Epoch: 29, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.686 Vali Acc: 0.915 Test Loss: 0.686 Test Acc: 0.915
Validation loss decreased (-0.903696 --> -0.914808).  Saving model ...
Epoch: 30 cost time: 0.7045438289642334
Epoch: 30, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.646 Vali Acc: 0.922 Test Loss: 0.646 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 31 cost time: 0.6667101383209229
Epoch: 31, Steps: 2 | Train Loss: 0.502 Vali Loss: 0.610 Vali Acc: 0.911 Test Loss: 0.610 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.692033052444458
Epoch: 32, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.574 Vali Acc: 0.911 Test Loss: 0.574 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6223244667053223
Epoch: 33, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.539 Vali Acc: 0.930 Test Loss: 0.539 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 34 cost time: 0.7281262874603271
Epoch: 34, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.507 Vali Acc: 0.933 Test Loss: 0.507 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 35 cost time: 0.9748106002807617
Epoch: 35, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.477 Vali Acc: 0.941 Test Loss: 0.477 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 36 cost time: 0.7254958152770996
Epoch: 36, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.451 Vali Acc: 0.933 Test Loss: 0.451 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6576001644134521
Epoch: 37, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.425 Vali Acc: 0.941 Test Loss: 0.425 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 38 cost time: 0.7295322418212891
Epoch: 38, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.402 Vali Acc: 0.944 Test Loss: 0.402 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 39 cost time: 0.6560556888580322
Epoch: 39, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.382 Vali Acc: 0.948 Test Loss: 0.382 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 40 cost time: 0.56410813331604
Epoch: 40, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.365 Vali Acc: 0.941 Test Loss: 0.365 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.8057115077972412
Epoch: 41, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.348 Vali Acc: 0.941 Test Loss: 0.348 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6781690120697021
Epoch: 42, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.333 Vali Acc: 0.937 Test Loss: 0.333 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8369038105010986
Epoch: 43, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.319 Vali Acc: 0.937 Test Loss: 0.319 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.6501696109771729
Epoch: 44, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5924577713012695
Epoch: 45, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6420021057128906
Epoch: 46, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6380424499511719
Epoch: 47, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.276 Vali Acc: 0.937 Test Loss: 0.276 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7423460483551025
Epoch: 48, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.266 Vali Acc: 0.941 Test Loss: 0.266 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.6931116580963135
Epoch: 49, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 315166
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2231028079986572
Epoch: 1, Steps: 2 | Train Loss: 2.013 Vali Loss: 1.883 Vali Acc: 0.256 Test Loss: 1.883 Test Acc: 0.256
Validation loss decreased (inf --> -0.255537).  Saving model ...
Epoch: 2 cost time: 0.547431468963623
Epoch: 2, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.827 Vali Acc: 0.270 Test Loss: 1.827 Test Acc: 0.270
Validation loss decreased (-0.255537 --> -0.270352).  Saving model ...
Epoch: 3 cost time: 0.6689867973327637
Epoch: 3, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.788 Vali Acc: 0.281 Test Loss: 1.788 Test Acc: 0.281
Validation loss decreased (-0.270352 --> -0.281464).  Saving model ...
Epoch: 4 cost time: 0.6498656272888184
Epoch: 4, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.749 Vali Acc: 0.281 Test Loss: 1.749 Test Acc: 0.281
Validation loss decreased (-0.281464 --> -0.281464).  Saving model ...
Epoch: 5 cost time: 0.6508445739746094
Epoch: 5, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.703 Vali Acc: 0.296 Test Loss: 1.703 Test Acc: 0.296
Validation loss decreased (-0.281464 --> -0.296279).  Saving model ...
Epoch: 6 cost time: 0.5098459720611572
Epoch: 6, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.656 Vali Acc: 0.393 Test Loss: 1.656 Test Acc: 0.393
Validation loss decreased (-0.296279 --> -0.392576).  Saving model ...
Epoch: 7 cost time: 0.6399130821228027
Epoch: 7, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.611 Vali Acc: 0.548 Test Loss: 1.611 Test Acc: 0.548
Validation loss decreased (-0.392576 --> -0.548132).  Saving model ...
Epoch: 8 cost time: 0.720869779586792
Epoch: 8, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.568 Vali Acc: 0.589 Test Loss: 1.568 Test Acc: 0.589
Validation loss decreased (-0.548132 --> -0.588873).  Saving model ...
Epoch: 9 cost time: 0.5603072643280029
Epoch: 9, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.528 Vali Acc: 0.589 Test Loss: 1.528 Test Acc: 0.589
Validation loss decreased (-0.588873 --> -0.588874).  Saving model ...
Epoch: 10 cost time: 0.47034573554992676
Epoch: 10, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.489 Vali Acc: 0.619 Test Loss: 1.489 Test Acc: 0.619
Validation loss decreased (-0.588874 --> -0.618504).  Saving model ...
Epoch: 11 cost time: 0.5508570671081543
Epoch: 11, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.449 Vali Acc: 0.663 Test Loss: 1.449 Test Acc: 0.663
Validation loss decreased (-0.618504 --> -0.662948).  Saving model ...
Epoch: 12 cost time: 0.7012300491333008
Epoch: 12, Steps: 2 | Train Loss: 1.412 Vali Loss: 1.409 Vali Acc: 0.670 Test Loss: 1.409 Test Acc: 0.670
Validation loss decreased (-0.662948 --> -0.670356).  Saving model ...
Epoch: 13 cost time: 0.5290365219116211
Epoch: 13, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.367 Vali Acc: 0.667 Test Loss: 1.367 Test Acc: 0.667
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4772155284881592
Epoch: 14, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.321 Vali Acc: 0.681 Test Loss: 1.321 Test Acc: 0.681
Validation loss decreased (-0.670356 --> -0.681468).  Saving model ...
Epoch: 15 cost time: 0.6396572589874268
Epoch: 15, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.272 Vali Acc: 0.707 Test Loss: 1.272 Test Acc: 0.707
Validation loss decreased (-0.681468 --> -0.707395).  Saving model ...
Epoch: 16 cost time: 0.7289004325866699
Epoch: 16, Steps: 2 | Train Loss: 1.217 Vali Loss: 1.221 Vali Acc: 0.730 Test Loss: 1.221 Test Acc: 0.730
Validation loss decreased (-0.707395 --> -0.729617).  Saving model ...
Epoch: 17 cost time: 0.6272644996643066
Epoch: 17, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.171 Vali Acc: 0.756 Test Loss: 1.171 Test Acc: 0.756
Validation loss decreased (-0.729617 --> -0.755544).  Saving model ...
Epoch: 18 cost time: 0.5983524322509766
Epoch: 18, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.122 Vali Acc: 0.781 Test Loss: 1.122 Test Acc: 0.781
Validation loss decreased (-0.755544 --> -0.781470).  Saving model ...
Epoch: 19 cost time: 0.6200129985809326
Epoch: 19, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.073 Vali Acc: 0.793 Test Loss: 1.073 Test Acc: 0.793
Validation loss decreased (-0.781470 --> -0.792582).  Saving model ...
Epoch: 20 cost time: 0.6699924468994141
Epoch: 20, Steps: 2 | Train Loss: 0.941 Vali Loss: 1.026 Vali Acc: 0.804 Test Loss: 1.026 Test Acc: 0.804
Validation loss decreased (-0.792582 --> -0.803693).  Saving model ...
Epoch: 21 cost time: 0.6669414043426514
Epoch: 21, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.982 Vali Acc: 0.811 Test Loss: 0.982 Test Acc: 0.811
Validation loss decreased (-0.803693 --> -0.811101).  Saving model ...
Epoch: 22 cost time: 0.7459392547607422
Epoch: 22, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.937 Vali Acc: 0.826 Test Loss: 0.937 Test Acc: 0.826
Validation loss decreased (-0.811101 --> -0.825917).  Saving model ...
Epoch: 23 cost time: 0.5560281276702881
Epoch: 23, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.893 Vali Acc: 0.830 Test Loss: 0.893 Test Acc: 0.830
Validation loss decreased (-0.825917 --> -0.829621).  Saving model ...
Epoch: 24 cost time: 0.6479949951171875
Epoch: 24, Steps: 2 | Train Loss: 0.794 Vali Loss: 0.850 Vali Acc: 0.837 Test Loss: 0.850 Test Acc: 0.837
Validation loss decreased (-0.829621 --> -0.837029).  Saving model ...
Epoch: 25 cost time: 0.7139179706573486
Epoch: 25, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.807 Vali Acc: 0.837 Test Loss: 0.807 Test Acc: 0.837
Validation loss decreased (-0.837029 --> -0.837029).  Saving model ...
Epoch: 26 cost time: 0.6023755073547363
Epoch: 26, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.763 Vali Acc: 0.848 Test Loss: 0.763 Test Acc: 0.848
Validation loss decreased (-0.837029 --> -0.848141).  Saving model ...
Epoch: 27 cost time: 0.5500290393829346
Epoch: 27, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.719 Vali Acc: 0.856 Test Loss: 0.719 Test Acc: 0.856
Validation loss decreased (-0.848141 --> -0.855548).  Saving model ...
Epoch: 28 cost time: 0.808680534362793
Epoch: 28, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.676 Vali Acc: 0.889 Test Loss: 0.676 Test Acc: 0.889
Validation loss decreased (-0.855548 --> -0.888882).  Saving model ...
Epoch: 29 cost time: 0.7353084087371826
Epoch: 29, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.637 Vali Acc: 0.900 Test Loss: 0.637 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899994).  Saving model ...
Epoch: 30 cost time: 0.6048085689544678
Epoch: 30, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.601 Vali Acc: 0.915 Test Loss: 0.601 Test Acc: 0.915
Validation loss decreased (-0.899994 --> -0.914809).  Saving model ...
Epoch: 31 cost time: 0.6883182525634766
Epoch: 31, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.569 Vali Acc: 0.907 Test Loss: 0.569 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9166460037231445
Epoch: 32, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.539 Vali Acc: 0.922 Test Loss: 0.539 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 33 cost time: 0.596118688583374
Epoch: 33, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.510 Vali Acc: 0.922 Test Loss: 0.510 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 34 cost time: 0.6385951042175293
Epoch: 34, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.483 Vali Acc: 0.919 Test Loss: 0.483 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7186143398284912
Epoch: 35, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.459 Vali Acc: 0.919 Test Loss: 0.459 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5738415718078613
Epoch: 36, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.436 Vali Acc: 0.915 Test Loss: 0.436 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6258411407470703
Epoch: 37, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.413 Vali Acc: 0.922 Test Loss: 0.413 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 38 cost time: 0.4454514980316162
Epoch: 38, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.391 Vali Acc: 0.941 Test Loss: 0.391 Test Acc: 0.941
Validation loss decreased (-0.922218 --> -0.940737).  Saving model ...
Epoch: 39 cost time: 0.5675337314605713
Epoch: 39, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.373 Vali Acc: 0.937 Test Loss: 0.373 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.671628475189209
Epoch: 40, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.357 Vali Acc: 0.941 Test Loss: 0.357 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 41 cost time: 0.7602813243865967
Epoch: 41, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.343 Vali Acc: 0.937 Test Loss: 0.343 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.609241247177124
Epoch: 42, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.332 Vali Acc: 0.937 Test Loss: 0.332 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8202483654022217
Epoch: 43, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6373753547668457
Epoch: 44, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.317 Vali Acc: 0.926 Test Loss: 0.317 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.6529574394226074
Epoch: 45, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.7769579887390137
Epoch: 46, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.297 Vali Acc: 0.926 Test Loss: 0.297 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6349246501922607
Epoch: 47, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.286 Vali Acc: 0.933 Test Loss: 0.286 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6306197643280029
Epoch: 48, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.276 Vali Acc: 0.933 Test Loss: 0.276 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.7043585777282715
Epoch: 49, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.6425626277923584
Epoch: 50, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 314782
model size : 2.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.070465087890625
Epoch: 1, Steps: 2 | Train Loss: 2.004 Vali Loss: 2.021 Vali Acc: 0.167 Test Loss: 2.021 Test Acc: 0.167
Validation loss decreased (inf --> -0.166646).  Saving model ...
Epoch: 2 cost time: 0.5818593502044678
Epoch: 2, Steps: 2 | Train Loss: 1.982 Vali Loss: 1.972 Vali Acc: 0.167 Test Loss: 1.972 Test Acc: 0.167
Validation loss decreased (-0.166646 --> -0.166647).  Saving model ...
Epoch: 3 cost time: 0.5128998756408691
Epoch: 3, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.938 Vali Acc: 0.170 Test Loss: 1.938 Test Acc: 0.170
Validation loss decreased (-0.166647 --> -0.170351).  Saving model ...
Epoch: 4 cost time: 0.6704628467559814
Epoch: 4, Steps: 2 | Train Loss: 1.912 Vali Loss: 1.910 Vali Acc: 0.170 Test Loss: 1.910 Test Acc: 0.170
Validation loss decreased (-0.170351 --> -0.170351).  Saving model ...
Epoch: 5 cost time: 0.6017410755157471
Epoch: 5, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.877 Vali Acc: 0.174 Test Loss: 1.877 Test Acc: 0.174
Validation loss decreased (-0.170351 --> -0.174055).  Saving model ...
Epoch: 6 cost time: 0.6429808139801025
Epoch: 6, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.843 Vali Acc: 0.185 Test Loss: 1.843 Test Acc: 0.185
Validation loss decreased (-0.174055 --> -0.185167).  Saving model ...
Epoch: 7 cost time: 0.5563535690307617
Epoch: 7, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.808 Vali Acc: 0.200 Test Loss: 1.808 Test Acc: 0.200
Validation loss decreased (-0.185167 --> -0.199982).  Saving model ...
Epoch: 8 cost time: 0.6122086048126221
Epoch: 8, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.773 Vali Acc: 0.200 Test Loss: 1.773 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199982).  Saving model ...
Epoch: 9 cost time: 0.49248266220092773
Epoch: 9, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.738 Vali Acc: 0.200 Test Loss: 1.738 Test Acc: 0.200
Validation loss decreased (-0.199982 --> -0.199983).  Saving model ...
Epoch: 10 cost time: 0.6168897151947021
Epoch: 10, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.703 Vali Acc: 0.222 Test Loss: 1.703 Test Acc: 0.222
Validation loss decreased (-0.199983 --> -0.222205).  Saving model ...
Epoch: 11 cost time: 0.6095819473266602
Epoch: 11, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.668 Vali Acc: 0.293 Test Loss: 1.668 Test Acc: 0.293
Validation loss decreased (-0.222205 --> -0.292576).  Saving model ...
Epoch: 12 cost time: 0.5784595012664795
Epoch: 12, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.629 Vali Acc: 0.393 Test Loss: 1.629 Test Acc: 0.393
Validation loss decreased (-0.292576 --> -0.392576).  Saving model ...
Epoch: 13 cost time: 0.6030373573303223
Epoch: 13, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.589 Vali Acc: 0.463 Test Loss: 1.589 Test Acc: 0.463
Validation loss decreased (-0.392576 --> -0.462947).  Saving model ...
Epoch: 14 cost time: 0.755648136138916
Epoch: 14, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.548 Vali Acc: 0.507 Test Loss: 1.548 Test Acc: 0.507
Validation loss decreased (-0.462947 --> -0.507392).  Saving model ...
Epoch: 15 cost time: 0.6135101318359375
Epoch: 15, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.506 Vali Acc: 0.544 Test Loss: 1.506 Test Acc: 0.544
Validation loss decreased (-0.507392 --> -0.544429).  Saving model ...
Epoch: 16 cost time: 0.6813743114471436
Epoch: 16, Steps: 2 | Train Loss: 1.426 Vali Loss: 1.463 Vali Acc: 0.589 Test Loss: 1.463 Test Acc: 0.589
Validation loss decreased (-0.544429 --> -0.588874).  Saving model ...
Epoch: 17 cost time: 0.64825439453125
Epoch: 17, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.420 Vali Acc: 0.637 Test Loss: 1.420 Test Acc: 0.637
Validation loss decreased (-0.588874 --> -0.637023).  Saving model ...
Epoch: 18 cost time: 0.6169960498809814
Epoch: 18, Steps: 2 | Train Loss: 1.370 Vali Loss: 1.376 Vali Acc: 0.689 Test Loss: 1.376 Test Acc: 0.689
Validation loss decreased (-0.637023 --> -0.688875).  Saving model ...
Epoch: 19 cost time: 0.549933671951294
Epoch: 19, Steps: 2 | Train Loss: 1.270 Vali Loss: 1.331 Vali Acc: 0.733 Test Loss: 1.331 Test Acc: 0.733
Validation loss decreased (-0.688875 --> -0.733320).  Saving model ...
Epoch: 20 cost time: 0.5336990356445312
Epoch: 20, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.288 Vali Acc: 0.741 Test Loss: 1.288 Test Acc: 0.741
Validation loss decreased (-0.733320 --> -0.740728).  Saving model ...
Epoch: 21 cost time: 0.6149849891662598
Epoch: 21, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.244 Vali Acc: 0.759 Test Loss: 1.244 Test Acc: 0.759
Validation loss decreased (-0.740728 --> -0.759247).  Saving model ...
Epoch: 22 cost time: 0.5288078784942627
Epoch: 22, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.198 Vali Acc: 0.789 Test Loss: 1.198 Test Acc: 0.789
Validation loss decreased (-0.759247 --> -0.788877).  Saving model ...
Epoch: 23 cost time: 0.6366760730743408
Epoch: 23, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.152 Vali Acc: 0.804 Test Loss: 1.152 Test Acc: 0.804
Validation loss decreased (-0.788877 --> -0.803692).  Saving model ...
Epoch: 24 cost time: 0.6259620189666748
Epoch: 24, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.106 Vali Acc: 0.833 Test Loss: 1.106 Test Acc: 0.833
Validation loss decreased (-0.803692 --> -0.833322).  Saving model ...
Epoch: 25 cost time: 0.6342654228210449
Epoch: 25, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.059 Vali Acc: 0.844 Test Loss: 1.059 Test Acc: 0.844
Validation loss decreased (-0.833322 --> -0.844434).  Saving model ...
Epoch: 26 cost time: 0.8046820163726807
Epoch: 26, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.011 Vali Acc: 0.841 Test Loss: 1.011 Test Acc: 0.841
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6594283580780029
Epoch: 27, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.965 Vali Acc: 0.852 Test Loss: 0.965 Test Acc: 0.852
Validation loss decreased (-0.844434 --> -0.851842).  Saving model ...
Epoch: 28 cost time: 0.6715352535247803
Epoch: 28, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.919 Vali Acc: 0.856 Test Loss: 0.919 Test Acc: 0.856
Validation loss decreased (-0.851842 --> -0.855546).  Saving model ...
Epoch: 29 cost time: 0.6047418117523193
Epoch: 29, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.873 Vali Acc: 0.870 Test Loss: 0.873 Test Acc: 0.870
Validation loss decreased (-0.855546 --> -0.870362).  Saving model ...
Epoch: 30 cost time: 0.5859847068786621
Epoch: 30, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.830 Vali Acc: 0.863 Test Loss: 0.830 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.8141446113586426
Epoch: 31, Steps: 2 | Train Loss: 0.683 Vali Loss: 0.786 Vali Acc: 0.885 Test Loss: 0.786 Test Acc: 0.885
Validation loss decreased (-0.870362 --> -0.885177).  Saving model ...
Epoch: 32 cost time: 0.594902753829956
Epoch: 32, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.744 Vali Acc: 0.885 Test Loss: 0.744 Test Acc: 0.885
Validation loss decreased (-0.885177 --> -0.885178).  Saving model ...
Epoch: 33 cost time: 0.5754482746124268
Epoch: 33, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.702 Vali Acc: 0.885 Test Loss: 0.702 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885178).  Saving model ...
Epoch: 34 cost time: 0.5008285045623779
Epoch: 34, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.662 Vali Acc: 0.893 Test Loss: 0.662 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 35 cost time: 0.6146390438079834
Epoch: 35, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.622 Vali Acc: 0.904 Test Loss: 0.622 Test Acc: 0.904
Validation loss decreased (-0.892586 --> -0.903697).  Saving model ...
Epoch: 36 cost time: 0.5353677272796631
Epoch: 36, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.585 Vali Acc: 0.915 Test Loss: 0.585 Test Acc: 0.915
Validation loss decreased (-0.903697 --> -0.914809).  Saving model ...
Epoch: 37 cost time: 0.48606157302856445
Epoch: 37, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.552 Vali Acc: 0.922 Test Loss: 0.552 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 38 cost time: 0.5469973087310791
Epoch: 38, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.521 Vali Acc: 0.922 Test Loss: 0.521 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 39 cost time: 0.6525797843933105
Epoch: 39, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.491 Vali Acc: 0.937 Test Loss: 0.491 Test Acc: 0.937
Validation loss decreased (-0.922217 --> -0.937032).  Saving model ...
Epoch: 40 cost time: 0.563016414642334
Epoch: 40, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.464 Vali Acc: 0.944 Test Loss: 0.464 Test Acc: 0.944
Validation loss decreased (-0.937032 --> -0.944440).  Saving model ...
Epoch: 41 cost time: 0.5632061958312988
Epoch: 41, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.440 Vali Acc: 0.933 Test Loss: 0.440 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6074128150939941
Epoch: 42, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.419 Vali Acc: 0.937 Test Loss: 0.419 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.684140682220459
Epoch: 43, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.399 Vali Acc: 0.941 Test Loss: 0.399 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.6470344066619873
Epoch: 44, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.382 Vali Acc: 0.944 Test Loss: 0.382 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944441).  Saving model ...
Epoch: 45 cost time: 0.586226224899292
Epoch: 45, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.367 Vali Acc: 0.944 Test Loss: 0.367 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 46 cost time: 0.7388267517089844
Epoch: 46, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.353 Vali Acc: 0.941 Test Loss: 0.353 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5510973930358887
Epoch: 47, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.339 Vali Acc: 0.941 Test Loss: 0.339 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5444142818450928
Epoch: 48, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.536508321762085
Epoch: 49, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.316 Vali Acc: 0.941 Test Loss: 0.316 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.588587760925293
Epoch: 50, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.7618956565856934
Epoch: 51, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.294 Vali Acc: 0.944 Test Loss: 0.294 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.6781752109527588
Epoch: 52, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.285 Vali Acc: 0.952 Test Loss: 0.285 Test Acc: 0.952
Validation loss decreased (-0.944442 --> -0.951849).  Saving model ...
Epoch: 53 cost time: 0.5852386951446533
Epoch: 53, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.278 Vali Acc: 0.952 Test Loss: 0.278 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 54 cost time: 0.7499380111694336
Epoch: 54, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.271 Vali Acc: 0.952 Test Loss: 0.271 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 55 cost time: 0.6561558246612549
Epoch: 55, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.265 Vali Acc: 0.952 Test Loss: 0.265 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 56 cost time: 0.5834202766418457
Epoch: 56, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.259 Vali Acc: 0.952 Test Loss: 0.259 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 57 cost time: 0.5579664707183838
Epoch: 57, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 58 cost time: 0.46886157989501953
Epoch: 58, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.250 Vali Acc: 0.952 Test Loss: 0.250 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 59 cost time: 0.5437259674072266
Epoch: 59, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5676777362823486
Epoch: 60, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7193408012390137
Epoch: 61, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.7990658283233643
Epoch: 62, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.6792681217193604
Epoch: 63, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.7167642116546631
Epoch: 64, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.746549129486084
Epoch: 65, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.7592310905456543
Epoch: 66, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.225 Vali Acc: 0.952 Test Loss: 0.225 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 67 cost time: 0.5108230113983154
Epoch: 67, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.5443985462188721
Epoch: 68, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.220 Vali Acc: 0.948 Test Loss: 0.220 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.5599784851074219
Epoch: 69, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.6688940525054932
Epoch: 70, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.7463057041168213
Epoch: 71, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.6965365409851074
Epoch: 72, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.832432746887207
Epoch: 73, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.8370978832244873
Epoch: 74, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.6650195121765137
Epoch: 75, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.6442999839782715
Epoch: 76, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 266398
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.987022876739502
Epoch: 1, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.840 Vali Acc: 0.159 Test Loss: 1.840 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 0.6503746509552002
Epoch: 2, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.809 Vali Acc: 0.174 Test Loss: 1.809 Test Acc: 0.174
Validation loss decreased (-0.159241 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.5659115314483643
Epoch: 3, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.784 Vali Acc: 0.189 Test Loss: 1.784 Test Acc: 0.189
Validation loss decreased (-0.174056 --> -0.188871).  Saving model ...
Epoch: 4 cost time: 0.5802879333496094
Epoch: 4, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.762 Vali Acc: 0.211 Test Loss: 1.762 Test Acc: 0.211
Validation loss decreased (-0.188871 --> -0.211093).  Saving model ...
Epoch: 5 cost time: 0.5551531314849854
Epoch: 5, Steps: 2 | Train Loss: 1.666 Vali Loss: 1.735 Vali Acc: 0.278 Test Loss: 1.735 Test Acc: 0.278
Validation loss decreased (-0.211093 --> -0.277760).  Saving model ...
Epoch: 6 cost time: 0.6050779819488525
Epoch: 6, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.705 Vali Acc: 0.363 Test Loss: 1.705 Test Acc: 0.363
Validation loss decreased (-0.277760 --> -0.362946).  Saving model ...
Epoch: 7 cost time: 0.578118085861206
Epoch: 7, Steps: 2 | Train Loss: 1.663 Vali Loss: 1.674 Vali Acc: 0.381 Test Loss: 1.674 Test Acc: 0.381
Validation loss decreased (-0.362946 --> -0.381465).  Saving model ...
Epoch: 8 cost time: 0.6596593856811523
Epoch: 8, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.641 Vali Acc: 0.422 Test Loss: 1.641 Test Acc: 0.422
Validation loss decreased (-0.381465 --> -0.422206).  Saving model ...
Epoch: 9 cost time: 0.6598381996154785
Epoch: 9, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.607 Vali Acc: 0.459 Test Loss: 1.607 Test Acc: 0.459
Validation loss decreased (-0.422206 --> -0.459243).  Saving model ...
Epoch: 10 cost time: 0.6584506034851074
Epoch: 10, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.570 Vali Acc: 0.511 Test Loss: 1.570 Test Acc: 0.511
Validation loss decreased (-0.459243 --> -0.511095).  Saving model ...
Epoch: 11 cost time: 0.5869748592376709
Epoch: 11, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.531 Vali Acc: 0.567 Test Loss: 1.531 Test Acc: 0.567
Validation loss decreased (-0.511095 --> -0.566651).  Saving model ...
Epoch: 12 cost time: 0.5798702239990234
Epoch: 12, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.492 Vali Acc: 0.581 Test Loss: 1.492 Test Acc: 0.581
Validation loss decreased (-0.566651 --> -0.581467).  Saving model ...
Epoch: 13 cost time: 0.5314607620239258
Epoch: 13, Steps: 2 | Train Loss: 1.343 Vali Loss: 1.451 Vali Acc: 0.626 Test Loss: 1.451 Test Acc: 0.626
Validation loss decreased (-0.581467 --> -0.625911).  Saving model ...
Epoch: 14 cost time: 0.5084106922149658
Epoch: 14, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.408 Vali Acc: 0.663 Test Loss: 1.408 Test Acc: 0.663
Validation loss decreased (-0.625911 --> -0.662949).  Saving model ...
Epoch: 15 cost time: 0.8517870903015137
Epoch: 15, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.364 Vali Acc: 0.711 Test Loss: 1.364 Test Acc: 0.711
Validation loss decreased (-0.662949 --> -0.711097).  Saving model ...
Epoch: 16 cost time: 0.674065351486206
Epoch: 16, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.319 Vali Acc: 0.744 Test Loss: 1.319 Test Acc: 0.744
Validation loss decreased (-0.711097 --> -0.744431).  Saving model ...
Epoch: 17 cost time: 0.5999481678009033
Epoch: 17, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.274 Vali Acc: 0.763 Test Loss: 1.274 Test Acc: 0.763
Validation loss decreased (-0.744431 --> -0.762950).  Saving model ...
Epoch: 18 cost time: 0.6723225116729736
Epoch: 18, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.232 Vali Acc: 0.781 Test Loss: 1.232 Test Acc: 0.781
Validation loss decreased (-0.762950 --> -0.781469).  Saving model ...
Epoch: 19 cost time: 0.5626640319824219
Epoch: 19, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.190 Vali Acc: 0.804 Test Loss: 1.190 Test Acc: 0.804
Validation loss decreased (-0.781469 --> -0.803692).  Saving model ...
Epoch: 20 cost time: 0.5916948318481445
Epoch: 20, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.147 Vali Acc: 0.822 Test Loss: 1.147 Test Acc: 0.822
Validation loss decreased (-0.803692 --> -0.822211).  Saving model ...
Epoch: 21 cost time: 0.5356094837188721
Epoch: 21, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.104 Vali Acc: 0.822 Test Loss: 1.104 Test Acc: 0.822
Validation loss decreased (-0.822211 --> -0.822211).  Saving model ...
Epoch: 22 cost time: 0.5530786514282227
Epoch: 22, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.060 Vali Acc: 0.841 Test Loss: 1.060 Test Acc: 0.841
Validation loss decreased (-0.822211 --> -0.840730).  Saving model ...
Epoch: 23 cost time: 0.763197660446167
Epoch: 23, Steps: 2 | Train Loss: 0.917 Vali Loss: 1.016 Vali Acc: 0.852 Test Loss: 1.016 Test Acc: 0.852
Validation loss decreased (-0.840730 --> -0.851842).  Saving model ...
Epoch: 24 cost time: 0.6173741817474365
Epoch: 24, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.972 Vali Acc: 0.863 Test Loss: 0.972 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862953).  Saving model ...
Epoch: 25 cost time: 0.5137693881988525
Epoch: 25, Steps: 2 | Train Loss: 0.804 Vali Loss: 0.930 Vali Acc: 0.881 Test Loss: 0.930 Test Acc: 0.881
Validation loss decreased (-0.862953 --> -0.881472).  Saving model ...
Epoch: 26 cost time: 0.5796120166778564
Epoch: 26, Steps: 2 | Train Loss: 0.778 Vali Loss: 0.887 Vali Acc: 0.885 Test Loss: 0.887 Test Acc: 0.885
Validation loss decreased (-0.881472 --> -0.885176).  Saving model ...
Epoch: 27 cost time: 0.6485710144042969
Epoch: 27, Steps: 2 | Train Loss: 0.716 Vali Loss: 0.845 Vali Acc: 0.896 Test Loss: 0.845 Test Acc: 0.896
Validation loss decreased (-0.885176 --> -0.896288).  Saving model ...
Epoch: 28 cost time: 0.5450534820556641
Epoch: 28, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.802 Vali Acc: 0.889 Test Loss: 0.802 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6846671104431152
Epoch: 29, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.759 Vali Acc: 0.889 Test Loss: 0.759 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8076667785644531
Epoch: 30, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.717 Vali Acc: 0.893 Test Loss: 0.717 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5818226337432861
Epoch: 31, Steps: 2 | Train Loss: 0.556 Vali Loss: 0.677 Vali Acc: 0.889 Test Loss: 0.677 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.708869218826294
Epoch: 32, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.640 Vali Acc: 0.900 Test Loss: 0.640 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899994).  Saving model ...
Epoch: 33 cost time: 0.58054518699646
Epoch: 33, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.605 Vali Acc: 0.904 Test Loss: 0.605 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 34 cost time: 0.5289425849914551
Epoch: 34, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.572 Vali Acc: 0.907 Test Loss: 0.572 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 35 cost time: 0.7292335033416748
Epoch: 35, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.541 Vali Acc: 0.911 Test Loss: 0.541 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 36 cost time: 0.6366887092590332
Epoch: 36, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.513 Vali Acc: 0.911 Test Loss: 0.513 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 37 cost time: 0.6623978614807129
Epoch: 37, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.488 Vali Acc: 0.907 Test Loss: 0.488 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7684178352355957
Epoch: 38, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.466 Vali Acc: 0.904 Test Loss: 0.466 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6368489265441895
Epoch: 39, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.808943510055542
Epoch: 40, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.426 Vali Acc: 0.904 Test Loss: 0.426 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7865383625030518
Epoch: 41, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.408 Vali Acc: 0.907 Test Loss: 0.408 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6177139282226562
Epoch: 42, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.390 Vali Acc: 0.911 Test Loss: 0.390 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 43 cost time: 0.5173730850219727
Epoch: 43, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.371 Vali Acc: 0.919 Test Loss: 0.371 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 44 cost time: 0.6603164672851562
Epoch: 44, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.356 Vali Acc: 0.922 Test Loss: 0.356 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 45 cost time: 0.7089672088623047
Epoch: 45, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.342 Vali Acc: 0.926 Test Loss: 0.342 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 46 cost time: 0.557417631149292
Epoch: 46, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.331 Vali Acc: 0.930 Test Loss: 0.331 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929626).  Saving model ...
Epoch: 47 cost time: 0.676180362701416
Epoch: 47, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.320 Vali Acc: 0.926 Test Loss: 0.320 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.622800350189209
Epoch: 48, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.7541463375091553
Epoch: 49, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5564942359924316
Epoch: 50, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.6307692527770996
Epoch: 51, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.8700370788574219
Epoch: 52, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.287 Vali Acc: 0.915 Test Loss: 0.287 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.6147570610046387
Epoch: 53, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.284 Vali Acc: 0.915 Test Loss: 0.284 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.6887650489807129
Epoch: 54, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.283 Vali Acc: 0.907 Test Loss: 0.283 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.5900900363922119
Epoch: 55, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.280 Vali Acc: 0.907 Test Loss: 0.280 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.5806570053100586
Epoch: 56, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.276 Vali Acc: 0.907 Test Loss: 0.276 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 266014
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.602627992630005
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.804 Vali Acc: 0.281 Test Loss: 1.804 Test Acc: 0.281
Validation loss decreased (inf --> -0.281463).  Saving model ...
Epoch: 2 cost time: 0.6603841781616211
Epoch: 2, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.767 Vali Acc: 0.304 Test Loss: 1.767 Test Acc: 0.304
Validation loss decreased (-0.281463 --> -0.303686).  Saving model ...
Epoch: 3 cost time: 0.621859073638916
Epoch: 3, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.744 Vali Acc: 0.307 Test Loss: 1.744 Test Acc: 0.307
Validation loss decreased (-0.303686 --> -0.307390).  Saving model ...
Epoch: 4 cost time: 0.6250522136688232
Epoch: 4, Steps: 2 | Train Loss: 1.787 Vali Loss: 1.722 Vali Acc: 0.315 Test Loss: 1.722 Test Acc: 0.315
Validation loss decreased (-0.307390 --> -0.314798).  Saving model ...
Epoch: 5 cost time: 0.5760462284088135
Epoch: 5, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.695 Vali Acc: 0.326 Test Loss: 1.695 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325909).  Saving model ...
Epoch: 6 cost time: 0.6245088577270508
Epoch: 6, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.665 Vali Acc: 0.337 Test Loss: 1.665 Test Acc: 0.337
Validation loss decreased (-0.325909 --> -0.337020).  Saving model ...
Epoch: 7 cost time: 0.6312241554260254
Epoch: 7, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.634 Vali Acc: 0.415 Test Loss: 1.634 Test Acc: 0.415
Validation loss decreased (-0.337020 --> -0.414798).  Saving model ...
Epoch: 8 cost time: 0.765052080154419
Epoch: 8, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.602 Vali Acc: 0.489 Test Loss: 1.602 Test Acc: 0.489
Validation loss decreased (-0.414798 --> -0.488873).  Saving model ...
Epoch: 9 cost time: 0.6288623809814453
Epoch: 9, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.567 Vali Acc: 0.515 Test Loss: 1.567 Test Acc: 0.515
Validation loss decreased (-0.488873 --> -0.514799).  Saving model ...
Epoch: 10 cost time: 0.5650217533111572
Epoch: 10, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.532 Vali Acc: 0.541 Test Loss: 1.532 Test Acc: 0.541
Validation loss decreased (-0.514799 --> -0.540725).  Saving model ...
Epoch: 11 cost time: 0.6421182155609131
Epoch: 11, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.496 Vali Acc: 0.559 Test Loss: 1.496 Test Acc: 0.559
Validation loss decreased (-0.540725 --> -0.559244).  Saving model ...
Epoch: 12 cost time: 0.8295214176177979
Epoch: 12, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.459 Vali Acc: 0.585 Test Loss: 1.459 Test Acc: 0.585
Validation loss decreased (-0.559244 --> -0.585171).  Saving model ...
Epoch: 13 cost time: 0.6214087009429932
Epoch: 13, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.420 Vali Acc: 0.600 Test Loss: 1.420 Test Acc: 0.600
Validation loss decreased (-0.585171 --> -0.599986).  Saving model ...
Epoch: 14 cost time: 0.6398768424987793
Epoch: 14, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.380 Vali Acc: 0.630 Test Loss: 1.380 Test Acc: 0.630
Validation loss decreased (-0.599986 --> -0.629616).  Saving model ...
Epoch: 15 cost time: 0.6828329563140869
Epoch: 15, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.338 Vali Acc: 0.644 Test Loss: 1.338 Test Acc: 0.644
Validation loss decreased (-0.629616 --> -0.644431).  Saving model ...
Epoch: 16 cost time: 0.6909620761871338
Epoch: 16, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.295 Vali Acc: 0.652 Test Loss: 1.295 Test Acc: 0.652
Validation loss decreased (-0.644431 --> -0.651839).  Saving model ...
Epoch: 17 cost time: 0.7271161079406738
Epoch: 17, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.251 Vali Acc: 0.689 Test Loss: 1.251 Test Acc: 0.689
Validation loss decreased (-0.651839 --> -0.688876).  Saving model ...
Epoch: 18 cost time: 0.6436338424682617
Epoch: 18, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.206 Vali Acc: 0.733 Test Loss: 1.206 Test Acc: 0.733
Validation loss decreased (-0.688876 --> -0.733321).  Saving model ...
Epoch: 19 cost time: 0.6510825157165527
Epoch: 19, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.161 Vali Acc: 0.781 Test Loss: 1.161 Test Acc: 0.781
Validation loss decreased (-0.733321 --> -0.781470).  Saving model ...
Epoch: 20 cost time: 0.668022871017456
Epoch: 20, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.116 Vali Acc: 0.800 Test Loss: 1.116 Test Acc: 0.800
Validation loss decreased (-0.781470 --> -0.799989).  Saving model ...
Epoch: 21 cost time: 0.5795249938964844
Epoch: 21, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.070 Vali Acc: 0.811 Test Loss: 1.070 Test Acc: 0.811
Validation loss decreased (-0.799989 --> -0.811100).  Saving model ...
Epoch: 22 cost time: 0.6834545135498047
Epoch: 22, Steps: 2 | Train Loss: 0.978 Vali Loss: 1.024 Vali Acc: 0.844 Test Loss: 1.024 Test Acc: 0.844
Validation loss decreased (-0.811100 --> -0.844434).  Saving model ...
Epoch: 23 cost time: 0.6885108947753906
Epoch: 23, Steps: 2 | Train Loss: 0.903 Vali Loss: 0.979 Vali Acc: 0.863 Test Loss: 0.979 Test Acc: 0.863
Validation loss decreased (-0.844434 --> -0.862953).  Saving model ...
Epoch: 24 cost time: 0.6533496379852295
Epoch: 24, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.936 Vali Acc: 0.863 Test Loss: 0.936 Test Acc: 0.863
Validation loss decreased (-0.862953 --> -0.862954).  Saving model ...
Epoch: 25 cost time: 0.6406600475311279
Epoch: 25, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.893 Vali Acc: 0.874 Test Loss: 0.893 Test Acc: 0.874
Validation loss decreased (-0.862954 --> -0.874065).  Saving model ...
Epoch: 26 cost time: 0.7001843452453613
Epoch: 26, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.849 Vali Acc: 0.867 Test Loss: 0.849 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6676537990570068
Epoch: 27, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.806 Vali Acc: 0.878 Test Loss: 0.806 Test Acc: 0.878
Validation loss decreased (-0.874065 --> -0.877770).  Saving model ...
Epoch: 28 cost time: 0.6499848365783691
Epoch: 28, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.765 Vali Acc: 0.889 Test Loss: 0.765 Test Acc: 0.889
Validation loss decreased (-0.877770 --> -0.888881).  Saving model ...
Epoch: 29 cost time: 0.6125185489654541
Epoch: 29, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.724 Vali Acc: 0.915 Test Loss: 0.724 Test Acc: 0.915
Validation loss decreased (-0.888881 --> -0.914808).  Saving model ...
Epoch: 30 cost time: 0.5575196743011475
Epoch: 30, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.682 Vali Acc: 0.930 Test Loss: 0.682 Test Acc: 0.930
Validation loss decreased (-0.914808 --> -0.929623).  Saving model ...
Epoch: 31 cost time: 0.7335512638092041
Epoch: 31, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.642 Vali Acc: 0.930 Test Loss: 0.642 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 32 cost time: 0.5811877250671387
Epoch: 32, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.605 Vali Acc: 0.926 Test Loss: 0.605 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7315371036529541
Epoch: 33, Steps: 2 | Train Loss: 0.433 Vali Loss: 0.570 Vali Acc: 0.919 Test Loss: 0.570 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6841952800750732
Epoch: 34, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.538 Vali Acc: 0.926 Test Loss: 0.538 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6839146614074707
Epoch: 35, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.508 Vali Acc: 0.933 Test Loss: 0.508 Test Acc: 0.933
Validation loss decreased (-0.929623 --> -0.933328).  Saving model ...
Epoch: 36 cost time: 0.7991280555725098
Epoch: 36, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.480 Vali Acc: 0.941 Test Loss: 0.480 Test Acc: 0.941
Validation loss decreased (-0.933328 --> -0.940736).  Saving model ...
Epoch: 37 cost time: 0.5123953819274902
Epoch: 37, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.453 Vali Acc: 0.944 Test Loss: 0.453 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 38 cost time: 0.6522696018218994
Epoch: 38, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.431 Vali Acc: 0.941 Test Loss: 0.431 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6431975364685059
Epoch: 39, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.409 Vali Acc: 0.948 Test Loss: 0.409 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 40 cost time: 0.689103364944458
Epoch: 40, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.387 Vali Acc: 0.944 Test Loss: 0.387 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6305546760559082
Epoch: 41, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.368 Vali Acc: 0.941 Test Loss: 0.368 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6115922927856445
Epoch: 42, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.350 Vali Acc: 0.944 Test Loss: 0.350 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7006025314331055
Epoch: 43, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.335 Vali Acc: 0.944 Test Loss: 0.335 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5641381740570068
Epoch: 44, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.322 Vali Acc: 0.944 Test Loss: 0.322 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.623645544052124
Epoch: 45, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.311 Vali Acc: 0.941 Test Loss: 0.311 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.7238063812255859
Epoch: 46, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.302 Vali Acc: 0.941 Test Loss: 0.302 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.6524989604949951
Epoch: 47, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.295 Vali Acc: 0.933 Test Loss: 0.295 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.566232442855835
Epoch: 48, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.5674288272857666
Epoch: 49, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 265630
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6097939014434814
Epoch: 1, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.812 Vali Acc: 0.278 Test Loss: 1.812 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 0.6839859485626221
Epoch: 2, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.772 Vali Acc: 0.289 Test Loss: 1.772 Test Acc: 0.289
Validation loss decreased (-0.277760 --> -0.288871).  Saving model ...
Epoch: 3 cost time: 0.7266786098480225
Epoch: 3, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.743 Vali Acc: 0.293 Test Loss: 1.743 Test Acc: 0.293
Validation loss decreased (-0.288871 --> -0.292575).  Saving model ...
Epoch: 4 cost time: 0.6356453895568848
Epoch: 4, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.716 Vali Acc: 0.289 Test Loss: 1.716 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.8349764347076416
Epoch: 5, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.684 Vali Acc: 0.311 Test Loss: 1.684 Test Acc: 0.311
Validation loss decreased (-0.292575 --> -0.311094).  Saving model ...
Epoch: 6 cost time: 0.693181037902832
Epoch: 6, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.650 Vali Acc: 0.311 Test Loss: 1.650 Test Acc: 0.311
Validation loss decreased (-0.311094 --> -0.311095).  Saving model ...
Epoch: 7 cost time: 0.7018201351165771
Epoch: 7, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.613 Vali Acc: 0.389 Test Loss: 1.613 Test Acc: 0.389
Validation loss decreased (-0.311095 --> -0.388873).  Saving model ...
Epoch: 8 cost time: 0.6996045112609863
Epoch: 8, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.578 Vali Acc: 0.470 Test Loss: 1.578 Test Acc: 0.470
Validation loss decreased (-0.388873 --> -0.470355).  Saving model ...
Epoch: 9 cost time: 0.5991542339324951
Epoch: 9, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.542 Vali Acc: 0.541 Test Loss: 1.542 Test Acc: 0.541
Validation loss decreased (-0.470355 --> -0.540725).  Saving model ...
Epoch: 10 cost time: 0.7012827396392822
Epoch: 10, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.505 Vali Acc: 0.574 Test Loss: 1.505 Test Acc: 0.574
Validation loss decreased (-0.540725 --> -0.574059).  Saving model ...
Epoch: 11 cost time: 0.5247068405151367
Epoch: 11, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.469 Vali Acc: 0.619 Test Loss: 1.469 Test Acc: 0.619
Validation loss decreased (-0.574059 --> -0.618504).  Saving model ...
Epoch: 12 cost time: 0.7710022926330566
Epoch: 12, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.432 Vali Acc: 0.644 Test Loss: 1.432 Test Acc: 0.644
Validation loss decreased (-0.618504 --> -0.644430).  Saving model ...
Epoch: 13 cost time: 0.6386289596557617
Epoch: 13, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.392 Vali Acc: 0.652 Test Loss: 1.392 Test Acc: 0.652
Validation loss decreased (-0.644430 --> -0.651838).  Saving model ...
Epoch: 14 cost time: 0.6115930080413818
Epoch: 14, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.352 Vali Acc: 0.681 Test Loss: 1.352 Test Acc: 0.681
Validation loss decreased (-0.651838 --> -0.681468).  Saving model ...
Epoch: 15 cost time: 0.6348702907562256
Epoch: 15, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.308 Vali Acc: 0.741 Test Loss: 1.308 Test Acc: 0.741
Validation loss decreased (-0.681468 --> -0.740728).  Saving model ...
Epoch: 16 cost time: 0.7156527042388916
Epoch: 16, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.262 Vali Acc: 0.767 Test Loss: 1.262 Test Acc: 0.767
Validation loss decreased (-0.740728 --> -0.766654).  Saving model ...
Epoch: 17 cost time: 0.5389108657836914
Epoch: 17, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.218 Vali Acc: 0.778 Test Loss: 1.218 Test Acc: 0.778
Validation loss decreased (-0.766654 --> -0.777766).  Saving model ...
Epoch: 18 cost time: 0.5837416648864746
Epoch: 18, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.174 Vali Acc: 0.807 Test Loss: 1.174 Test Acc: 0.807
Validation loss decreased (-0.777766 --> -0.807396).  Saving model ...
Epoch: 19 cost time: 0.5360977649688721
Epoch: 19, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.131 Vali Acc: 0.819 Test Loss: 1.131 Test Acc: 0.819
Validation loss decreased (-0.807396 --> -0.818507).  Saving model ...
Epoch: 20 cost time: 0.6007425785064697
Epoch: 20, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.089 Vali Acc: 0.826 Test Loss: 1.089 Test Acc: 0.826
Validation loss decreased (-0.818507 --> -0.825915).  Saving model ...
Epoch: 21 cost time: 0.6671023368835449
Epoch: 21, Steps: 2 | Train Loss: 0.977 Vali Loss: 1.046 Vali Acc: 0.852 Test Loss: 1.046 Test Acc: 0.852
Validation loss decreased (-0.825915 --> -0.851841).  Saving model ...
Epoch: 22 cost time: 0.5677857398986816
Epoch: 22, Steps: 2 | Train Loss: 0.923 Vali Loss: 1.003 Vali Acc: 0.874 Test Loss: 1.003 Test Acc: 0.874
Validation loss decreased (-0.851841 --> -0.874064).  Saving model ...
Epoch: 23 cost time: 0.6103661060333252
Epoch: 23, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.958 Vali Acc: 0.874 Test Loss: 0.958 Test Acc: 0.874
Validation loss decreased (-0.874064 --> -0.874064).  Saving model ...
Epoch: 24 cost time: 0.594226598739624
Epoch: 24, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.915 Vali Acc: 0.881 Test Loss: 0.915 Test Acc: 0.881
Validation loss decreased (-0.874064 --> -0.881472).  Saving model ...
Epoch: 25 cost time: 0.6682441234588623
Epoch: 25, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.873 Vali Acc: 0.889 Test Loss: 0.873 Test Acc: 0.889
Validation loss decreased (-0.881472 --> -0.888880).  Saving model ...
Epoch: 26 cost time: 0.6112964153289795
Epoch: 26, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.830 Vali Acc: 0.900 Test Loss: 0.830 Test Acc: 0.900
Validation loss decreased (-0.888880 --> -0.899992).  Saving model ...
Epoch: 27 cost time: 0.653418779373169
Epoch: 27, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.789 Vali Acc: 0.900 Test Loss: 0.789 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899992).  Saving model ...
Epoch: 28 cost time: 0.6934657096862793
Epoch: 28, Steps: 2 | Train Loss: 0.664 Vali Loss: 0.747 Vali Acc: 0.904 Test Loss: 0.747 Test Acc: 0.904
Validation loss decreased (-0.899992 --> -0.903696).  Saving model ...
Epoch: 29 cost time: 0.5496277809143066
Epoch: 29, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.707 Vali Acc: 0.911 Test Loss: 0.707 Test Acc: 0.911
Validation loss decreased (-0.903696 --> -0.911104).  Saving model ...
Epoch: 30 cost time: 0.6232888698577881
Epoch: 30, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.670 Vali Acc: 0.900 Test Loss: 0.670 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6866035461425781
Epoch: 31, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.634 Vali Acc: 0.896 Test Loss: 0.634 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.692352294921875
Epoch: 32, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.599 Vali Acc: 0.907 Test Loss: 0.599 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7157478332519531
Epoch: 33, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.568 Vali Acc: 0.904 Test Loss: 0.568 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.7888021469116211
Epoch: 34, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.535 Vali Acc: 0.919 Test Loss: 0.535 Test Acc: 0.919
Validation loss decreased (-0.911104 --> -0.918513).  Saving model ...
Epoch: 35 cost time: 0.6399264335632324
Epoch: 35, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.505 Vali Acc: 0.933 Test Loss: 0.505 Test Acc: 0.933
Validation loss decreased (-0.918513 --> -0.933328).  Saving model ...
Epoch: 36 cost time: 0.6005446910858154
Epoch: 36, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.478 Vali Acc: 0.937 Test Loss: 0.478 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 37 cost time: 0.5332045555114746
Epoch: 37, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.454 Vali Acc: 0.933 Test Loss: 0.454 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5792279243469238
Epoch: 38, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.433 Vali Acc: 0.930 Test Loss: 0.433 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6205565929412842
Epoch: 39, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.413 Vali Acc: 0.933 Test Loss: 0.413 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7583842277526855
Epoch: 40, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.395 Vali Acc: 0.933 Test Loss: 0.395 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6455867290496826
Epoch: 41, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.376 Vali Acc: 0.937 Test Loss: 0.376 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 42 cost time: 0.6569578647613525
Epoch: 42, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.359 Vali Acc: 0.941 Test Loss: 0.359 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 43 cost time: 0.5556375980377197
Epoch: 43, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.346 Vali Acc: 0.933 Test Loss: 0.346 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6404614448547363
Epoch: 44, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.332 Vali Acc: 0.937 Test Loss: 0.332 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.588552713394165
Epoch: 45, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.321 Vali Acc: 0.933 Test Loss: 0.321 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.624774694442749
Epoch: 46, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.312 Vali Acc: 0.933 Test Loss: 0.312 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.7536365985870361
Epoch: 47, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.303 Vali Acc: 0.933 Test Loss: 0.303 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6455795764923096
Epoch: 48, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6210315227508545
Epoch: 49, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.286 Vali Acc: 0.937 Test Loss: 0.286 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.6928129196166992
Epoch: 50, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6478009223937988
Epoch: 51, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.7352652549743652
Epoch: 52, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 265246
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1507062911987305
Epoch: 1, Steps: 2 | Train Loss: 2.057 Vali Loss: 2.020 Vali Acc: 0.115 Test Loss: 2.020 Test Acc: 0.115
Validation loss decreased (inf --> -0.114795).  Saving model ...
Epoch: 2 cost time: 0.5690178871154785
Epoch: 2, Steps: 2 | Train Loss: 2.064 Vali Loss: 1.995 Vali Acc: 0.130 Test Loss: 1.995 Test Acc: 0.130
Validation loss decreased (-0.114795 --> -0.129610).  Saving model ...
Epoch: 3 cost time: 0.5274796485900879
Epoch: 3, Steps: 2 | Train Loss: 1.989 Vali Loss: 1.977 Vali Acc: 0.126 Test Loss: 1.977 Test Acc: 0.126
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.7157533168792725
Epoch: 4, Steps: 2 | Train Loss: 1.965 Vali Loss: 1.959 Vali Acc: 0.126 Test Loss: 1.959 Test Acc: 0.126
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.6318531036376953
Epoch: 5, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.938 Vali Acc: 0.133 Test Loss: 1.938 Test Acc: 0.133
Validation loss decreased (-0.129610 --> -0.133314).  Saving model ...
Epoch: 6 cost time: 0.5969827175140381
Epoch: 6, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.914 Vali Acc: 0.137 Test Loss: 1.914 Test Acc: 0.137
Validation loss decreased (-0.133314 --> -0.137018).  Saving model ...
Epoch: 7 cost time: 0.6228346824645996
Epoch: 7, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.888 Vali Acc: 0.148 Test Loss: 1.888 Test Acc: 0.148
Validation loss decreased (-0.137018 --> -0.148129).  Saving model ...
Epoch: 8 cost time: 0.5606138706207275
Epoch: 8, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.861 Vali Acc: 0.141 Test Loss: 1.861 Test Acc: 0.141
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6791446208953857
Epoch: 9, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.833 Vali Acc: 0.130 Test Loss: 1.833 Test Acc: 0.130
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6358625888824463
Epoch: 10, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.804 Vali Acc: 0.141 Test Loss: 1.804 Test Acc: 0.141
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7054731845855713
Epoch: 11, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.775 Vali Acc: 0.178 Test Loss: 1.775 Test Acc: 0.178
Validation loss decreased (-0.148129 --> -0.177760).  Saving model ...
Epoch: 12 cost time: 0.6192514896392822
Epoch: 12, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.746 Vali Acc: 0.211 Test Loss: 1.746 Test Acc: 0.211
Validation loss decreased (-0.177760 --> -0.211094).  Saving model ...
Epoch: 13 cost time: 0.5874834060668945
Epoch: 13, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.716 Vali Acc: 0.259 Test Loss: 1.716 Test Acc: 0.259
Validation loss decreased (-0.211094 --> -0.259242).  Saving model ...
Epoch: 14 cost time: 0.5435640811920166
Epoch: 14, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.684 Vali Acc: 0.341 Test Loss: 1.684 Test Acc: 0.341
Validation loss decreased (-0.259242 --> -0.340724).  Saving model ...
Epoch: 15 cost time: 0.5880677700042725
Epoch: 15, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.651 Vali Acc: 0.415 Test Loss: 1.651 Test Acc: 0.415
Validation loss decreased (-0.340724 --> -0.414798).  Saving model ...
Epoch: 16 cost time: 0.6807911396026611
Epoch: 16, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.616 Vali Acc: 0.459 Test Loss: 1.616 Test Acc: 0.459
Validation loss decreased (-0.414798 --> -0.459243).  Saving model ...
Epoch: 17 cost time: 0.6954915523529053
Epoch: 17, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.580 Vali Acc: 0.522 Test Loss: 1.580 Test Acc: 0.522
Validation loss decreased (-0.459243 --> -0.522206).  Saving model ...
Epoch: 18 cost time: 0.641211986541748
Epoch: 18, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.544 Vali Acc: 0.570 Test Loss: 1.544 Test Acc: 0.570
Validation loss decreased (-0.522206 --> -0.570355).  Saving model ...
Epoch: 19 cost time: 0.848106861114502
Epoch: 19, Steps: 2 | Train Loss: 1.452 Vali Loss: 1.506 Vali Acc: 0.637 Test Loss: 1.506 Test Acc: 0.637
Validation loss decreased (-0.570355 --> -0.637022).  Saving model ...
Epoch: 20 cost time: 0.6884188652038574
Epoch: 20, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.467 Vali Acc: 0.663 Test Loss: 1.467 Test Acc: 0.663
Validation loss decreased (-0.637022 --> -0.662948).  Saving model ...
Epoch: 21 cost time: 0.601285457611084
Epoch: 21, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.427 Vali Acc: 0.704 Test Loss: 1.427 Test Acc: 0.704
Validation loss decreased (-0.662948 --> -0.703689).  Saving model ...
Epoch: 22 cost time: 0.6538589000701904
Epoch: 22, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.387 Vali Acc: 0.741 Test Loss: 1.387 Test Acc: 0.741
Validation loss decreased (-0.703689 --> -0.740727).  Saving model ...
Epoch: 23 cost time: 0.5197720527648926
Epoch: 23, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.345 Vali Acc: 0.756 Test Loss: 1.345 Test Acc: 0.756
Validation loss decreased (-0.740727 --> -0.755542).  Saving model ...
Epoch: 24 cost time: 0.4833235740661621
Epoch: 24, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.300 Vali Acc: 0.770 Test Loss: 1.300 Test Acc: 0.770
Validation loss decreased (-0.755542 --> -0.770357).  Saving model ...
Epoch: 25 cost time: 0.7788252830505371
Epoch: 25, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.257 Vali Acc: 0.789 Test Loss: 1.257 Test Acc: 0.789
Validation loss decreased (-0.770357 --> -0.788876).  Saving model ...
Epoch: 26 cost time: 0.6517167091369629
Epoch: 26, Steps: 2 | Train Loss: 1.145 Vali Loss: 1.211 Vali Acc: 0.796 Test Loss: 1.211 Test Acc: 0.796
Validation loss decreased (-0.788876 --> -0.796284).  Saving model ...
Epoch: 27 cost time: 0.5178496837615967
Epoch: 27, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.165 Vali Acc: 0.811 Test Loss: 1.165 Test Acc: 0.811
Validation loss decreased (-0.796284 --> -0.811099).  Saving model ...
Epoch: 28 cost time: 0.6432673931121826
Epoch: 28, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.119 Vali Acc: 0.830 Test Loss: 1.119 Test Acc: 0.830
Validation loss decreased (-0.811099 --> -0.829618).  Saving model ...
Epoch: 29 cost time: 0.6717691421508789
Epoch: 29, Steps: 2 | Train Loss: 0.979 Vali Loss: 1.073 Vali Acc: 0.837 Test Loss: 1.073 Test Acc: 0.837
Validation loss decreased (-0.829618 --> -0.837026).  Saving model ...
Epoch: 30 cost time: 0.5921578407287598
Epoch: 30, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.027 Vali Acc: 0.856 Test Loss: 1.027 Test Acc: 0.856
Validation loss decreased (-0.837026 --> -0.855545).  Saving model ...
Epoch: 31 cost time: 0.6600656509399414
Epoch: 31, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.981 Vali Acc: 0.870 Test Loss: 0.981 Test Acc: 0.870
Validation loss decreased (-0.855545 --> -0.870361).  Saving model ...
Epoch: 32 cost time: 0.6762361526489258
Epoch: 32, Steps: 2 | Train Loss: 0.838 Vali Loss: 0.936 Vali Acc: 0.878 Test Loss: 0.936 Test Acc: 0.878
Validation loss decreased (-0.870361 --> -0.877768).  Saving model ...
Epoch: 33 cost time: 0.658531904220581
Epoch: 33, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.894 Vali Acc: 0.874 Test Loss: 0.894 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7364826202392578
Epoch: 34, Steps: 2 | Train Loss: 0.755 Vali Loss: 0.853 Vali Acc: 0.878 Test Loss: 0.853 Test Acc: 0.878
Validation loss decreased (-0.877768 --> -0.877769).  Saving model ...
Epoch: 35 cost time: 0.5846540927886963
Epoch: 35, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.812 Vali Acc: 0.885 Test Loss: 0.812 Test Acc: 0.885
Validation loss decreased (-0.877769 --> -0.885177).  Saving model ...
Epoch: 36 cost time: 0.5681195259094238
Epoch: 36, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.772 Vali Acc: 0.881 Test Loss: 0.772 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.7857382297515869
Epoch: 37, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.733 Vali Acc: 0.889 Test Loss: 0.733 Test Acc: 0.889
Validation loss decreased (-0.885177 --> -0.888882).  Saving model ...
Epoch: 38 cost time: 0.5925438404083252
Epoch: 38, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.697 Vali Acc: 0.885 Test Loss: 0.697 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.762047529220581
Epoch: 39, Steps: 2 | Train Loss: 0.514 Vali Loss: 0.663 Vali Acc: 0.885 Test Loss: 0.663 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7269346714019775
Epoch: 40, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.632 Vali Acc: 0.893 Test Loss: 0.632 Test Acc: 0.893
Validation loss decreased (-0.888882 --> -0.892586).  Saving model ...
Epoch: 41 cost time: 0.6053171157836914
Epoch: 41, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.603 Vali Acc: 0.893 Test Loss: 0.603 Test Acc: 0.893
Validation loss decreased (-0.892586 --> -0.892587).  Saving model ...
Epoch: 42 cost time: 0.6169967651367188
Epoch: 42, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.576 Vali Acc: 0.896 Test Loss: 0.576 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 43 cost time: 0.5910835266113281
Epoch: 43, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.550 Vali Acc: 0.900 Test Loss: 0.550 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899994).  Saving model ...
Epoch: 44 cost time: 0.6083052158355713
Epoch: 44, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.528 Vali Acc: 0.904 Test Loss: 0.528 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 45 cost time: 0.7077312469482422
Epoch: 45, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.508 Vali Acc: 0.904 Test Loss: 0.508 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903699).  Saving model ...
Epoch: 46 cost time: 0.6916449069976807
Epoch: 46, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.489 Vali Acc: 0.911 Test Loss: 0.489 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911106).  Saving model ...
Epoch: 47 cost time: 0.6502659320831299
Epoch: 47, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.472 Vali Acc: 0.911 Test Loss: 0.472 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 48 cost time: 0.5938425064086914
Epoch: 48, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.458 Vali Acc: 0.896 Test Loss: 0.458 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6316573619842529
Epoch: 49, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.444 Vali Acc: 0.900 Test Loss: 0.444 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.6608788967132568
Epoch: 50, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.430 Vali Acc: 0.900 Test Loss: 0.430 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5447604656219482
Epoch: 51, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.416 Vali Acc: 0.904 Test Loss: 0.416 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.6294171810150146
Epoch: 52, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.403 Vali Acc: 0.915 Test Loss: 0.403 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914811).  Saving model ...
Epoch: 53 cost time: 0.5256285667419434
Epoch: 53, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.391 Vali Acc: 0.915 Test Loss: 0.391 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 54 cost time: 0.5669200420379639
Epoch: 54, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.380 Vali Acc: 0.930 Test Loss: 0.380 Test Acc: 0.930
Validation loss decreased (-0.914811 --> -0.929626).  Saving model ...
Epoch: 55 cost time: 0.6872673034667969
Epoch: 55, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7112820148468018
Epoch: 56, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.361 Vali Acc: 0.922 Test Loss: 0.361 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.523169994354248
Epoch: 57, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.353 Vali Acc: 0.930 Test Loss: 0.353 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 58 cost time: 0.6460847854614258
Epoch: 58, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.346 Vali Acc: 0.926 Test Loss: 0.346 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6226451396942139
Epoch: 59, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.339 Vali Acc: 0.926 Test Loss: 0.339 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5731384754180908
Epoch: 60, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.333 Vali Acc: 0.922 Test Loss: 0.333 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.7600927352905273
Epoch: 61, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.328 Vali Acc: 0.919 Test Loss: 0.328 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.6037576198577881
Epoch: 62, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.323 Vali Acc: 0.911 Test Loss: 0.323 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.5940694808959961
Epoch: 63, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.319 Vali Acc: 0.911 Test Loss: 0.319 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.6730411052703857
Epoch: 64, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.315 Vali Acc: 0.915 Test Loss: 0.315 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.7866499423980713
Epoch: 65, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.5608358383178711
Epoch: 66, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.304 Vali Acc: 0.915 Test Loss: 0.304 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.5735657215118408
Epoch: 67, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.300 Vali Acc: 0.915 Test Loss: 0.300 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 258974
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.536818265914917
Epoch: 1, Steps: 2 | Train Loss: 2.023 Vali Loss: 1.906 Vali Acc: 0.167 Test Loss: 1.906 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.7125551700592041
Epoch: 2, Steps: 2 | Train Loss: 1.914 Vali Loss: 1.871 Vali Acc: 0.167 Test Loss: 1.871 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.6400868892669678
Epoch: 3, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.846 Vali Acc: 0.167 Test Loss: 1.846 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 4 cost time: 0.7544140815734863
Epoch: 4, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.823 Vali Acc: 0.167 Test Loss: 1.823 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166648).  Saving model ...
Epoch: 5 cost time: 0.7758114337921143
Epoch: 5, Steps: 2 | Train Loss: 1.863 Vali Loss: 1.797 Vali Acc: 0.167 Test Loss: 1.797 Test Acc: 0.167
Validation loss decreased (-0.166648 --> -0.166649).  Saving model ...
Epoch: 6 cost time: 0.5811264514923096
Epoch: 6, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.769 Vali Acc: 0.193 Test Loss: 1.769 Test Acc: 0.193
Validation loss decreased (-0.166649 --> -0.192575).  Saving model ...
Epoch: 7 cost time: 0.6287262439727783
Epoch: 7, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.741 Vali Acc: 0.293 Test Loss: 1.741 Test Acc: 0.293
Validation loss decreased (-0.192575 --> -0.292575).  Saving model ...
Epoch: 8 cost time: 0.7886111736297607
Epoch: 8, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.714 Vali Acc: 0.348 Test Loss: 1.714 Test Acc: 0.348
Validation loss decreased (-0.292575 --> -0.348131).  Saving model ...
Epoch: 9 cost time: 0.5893762111663818
Epoch: 9, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.686 Vali Acc: 0.359 Test Loss: 1.686 Test Acc: 0.359
Validation loss decreased (-0.348131 --> -0.359242).  Saving model ...
Epoch: 10 cost time: 0.555732250213623
Epoch: 10, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.659 Vali Acc: 0.374 Test Loss: 1.659 Test Acc: 0.374
Validation loss decreased (-0.359242 --> -0.374057).  Saving model ...
Epoch: 11 cost time: 0.588493824005127
Epoch: 11, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.632 Vali Acc: 0.411 Test Loss: 1.632 Test Acc: 0.411
Validation loss decreased (-0.374057 --> -0.411095).  Saving model ...
Epoch: 12 cost time: 0.6541316509246826
Epoch: 12, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.604 Vali Acc: 0.470 Test Loss: 1.604 Test Acc: 0.470
Validation loss decreased (-0.411095 --> -0.470354).  Saving model ...
Epoch: 13 cost time: 0.5725021362304688
Epoch: 13, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.573 Vali Acc: 0.519 Test Loss: 1.573 Test Acc: 0.519
Validation loss decreased (-0.470354 --> -0.518503).  Saving model ...
Epoch: 14 cost time: 0.6823766231536865
Epoch: 14, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.541 Vali Acc: 0.567 Test Loss: 1.541 Test Acc: 0.567
Validation loss decreased (-0.518503 --> -0.566651).  Saving model ...
Epoch: 15 cost time: 0.5761151313781738
Epoch: 15, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.509 Vali Acc: 0.581 Test Loss: 1.509 Test Acc: 0.581
Validation loss decreased (-0.566651 --> -0.581466).  Saving model ...
Epoch: 16 cost time: 0.5801782608032227
Epoch: 16, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.475 Vali Acc: 0.611 Test Loss: 1.475 Test Acc: 0.611
Validation loss decreased (-0.581466 --> -0.611096).  Saving model ...
Epoch: 17 cost time: 0.5431370735168457
Epoch: 17, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.440 Vali Acc: 0.663 Test Loss: 1.440 Test Acc: 0.663
Validation loss decreased (-0.611096 --> -0.662949).  Saving model ...
Epoch: 18 cost time: 0.5480630397796631
Epoch: 18, Steps: 2 | Train Loss: 1.401 Vali Loss: 1.401 Vali Acc: 0.681 Test Loss: 1.401 Test Acc: 0.681
Validation loss decreased (-0.662949 --> -0.681467).  Saving model ...
Epoch: 19 cost time: 0.785527229309082
Epoch: 19, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.361 Vali Acc: 0.733 Test Loss: 1.361 Test Acc: 0.733
Validation loss decreased (-0.681467 --> -0.733320).  Saving model ...
Epoch: 20 cost time: 0.6078484058380127
Epoch: 20, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.319 Vali Acc: 0.767 Test Loss: 1.319 Test Acc: 0.767
Validation loss decreased (-0.733320 --> -0.766653).  Saving model ...
Epoch: 21 cost time: 0.6085143089294434
Epoch: 21, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.276 Vali Acc: 0.781 Test Loss: 1.276 Test Acc: 0.781
Validation loss decreased (-0.766653 --> -0.781469).  Saving model ...
Epoch: 22 cost time: 0.6706795692443848
Epoch: 22, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.233 Vali Acc: 0.793 Test Loss: 1.233 Test Acc: 0.793
Validation loss decreased (-0.781469 --> -0.792580).  Saving model ...
Epoch: 23 cost time: 0.5282008647918701
Epoch: 23, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.190 Vali Acc: 0.804 Test Loss: 1.190 Test Acc: 0.804
Validation loss decreased (-0.792580 --> -0.803692).  Saving model ...
Epoch: 24 cost time: 0.5191500186920166
Epoch: 24, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.146 Vali Acc: 0.815 Test Loss: 1.146 Test Acc: 0.815
Validation loss decreased (-0.803692 --> -0.814803).  Saving model ...
Epoch: 25 cost time: 0.6060292720794678
Epoch: 25, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.101 Vali Acc: 0.844 Test Loss: 1.101 Test Acc: 0.844
Validation loss decreased (-0.814803 --> -0.844433).  Saving model ...
Epoch: 26 cost time: 0.7096514701843262
Epoch: 26, Steps: 2 | Train Loss: 1.008 Vali Loss: 1.057 Vali Acc: 0.848 Test Loss: 1.057 Test Acc: 0.848
Validation loss decreased (-0.844433 --> -0.848138).  Saving model ...
Epoch: 27 cost time: 0.6113543510437012
Epoch: 27, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.014 Vali Acc: 0.856 Test Loss: 1.014 Test Acc: 0.856
Validation loss decreased (-0.848138 --> -0.855545).  Saving model ...
Epoch: 28 cost time: 0.6352758407592773
Epoch: 28, Steps: 2 | Train Loss: 0.957 Vali Loss: 0.971 Vali Acc: 0.870 Test Loss: 0.971 Test Acc: 0.870
Validation loss decreased (-0.855545 --> -0.870361).  Saving model ...
Epoch: 29 cost time: 0.5396053791046143
Epoch: 29, Steps: 2 | Train Loss: 0.858 Vali Loss: 0.928 Vali Acc: 0.874 Test Loss: 0.928 Test Acc: 0.874
Validation loss decreased (-0.870361 --> -0.874065).  Saving model ...
Epoch: 30 cost time: 0.6257820129394531
Epoch: 30, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.887 Vali Acc: 0.896 Test Loss: 0.887 Test Acc: 0.896
Validation loss decreased (-0.874065 --> -0.896287).  Saving model ...
Epoch: 31 cost time: 0.5646305084228516
Epoch: 31, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.848 Vali Acc: 0.896 Test Loss: 0.848 Test Acc: 0.896
Validation loss decreased (-0.896287 --> -0.896288).  Saving model ...
Epoch: 32 cost time: 0.5647182464599609
Epoch: 32, Steps: 2 | Train Loss: 0.743 Vali Loss: 0.809 Vali Acc: 0.915 Test Loss: 0.809 Test Acc: 0.915
Validation loss decreased (-0.896288 --> -0.914807).  Saving model ...
Epoch: 33 cost time: 0.5766928195953369
Epoch: 33, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.771 Vali Acc: 0.915 Test Loss: 0.771 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914807).  Saving model ...
Epoch: 34 cost time: 0.5630731582641602
Epoch: 34, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.735 Vali Acc: 0.922 Test Loss: 0.735 Test Acc: 0.922
Validation loss decreased (-0.914807 --> -0.922215).  Saving model ...
Epoch: 35 cost time: 0.6177413463592529
Epoch: 35, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.702 Vali Acc: 0.919 Test Loss: 0.702 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6106629371643066
Epoch: 36, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.671 Vali Acc: 0.915 Test Loss: 0.671 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7613883018493652
Epoch: 37, Steps: 2 | Train Loss: 0.542 Vali Loss: 0.642 Vali Acc: 0.915 Test Loss: 0.642 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6116728782653809
Epoch: 38, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.615 Vali Acc: 0.915 Test Loss: 0.615 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7093377113342285
Epoch: 39, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.589 Vali Acc: 0.919 Test Loss: 0.589 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.611318826675415
Epoch: 40, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.565 Vali Acc: 0.919 Test Loss: 0.565 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.6257810592651367
Epoch: 41, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.541 Vali Acc: 0.922 Test Loss: 0.541 Test Acc: 0.922
Validation loss decreased (-0.922215 --> -0.922217).  Saving model ...
Epoch: 42 cost time: 0.5503544807434082
Epoch: 42, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.519 Vali Acc: 0.919 Test Loss: 0.519 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.5617868900299072
Epoch: 43, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.498 Vali Acc: 0.926 Test Loss: 0.498 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 44 cost time: 0.577096700668335
Epoch: 44, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.479 Vali Acc: 0.930 Test Loss: 0.479 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 45 cost time: 0.6686718463897705
Epoch: 45, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.462 Vali Acc: 0.930 Test Loss: 0.462 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 46 cost time: 0.8174450397491455
Epoch: 46, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.446 Vali Acc: 0.933 Test Loss: 0.446 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 47 cost time: 0.6280765533447266
Epoch: 47, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.431 Vali Acc: 0.926 Test Loss: 0.431 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.562847375869751
Epoch: 48, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.418 Vali Acc: 0.930 Test Loss: 0.418 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5543127059936523
Epoch: 49, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.406 Vali Acc: 0.930 Test Loss: 0.406 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5508816242218018
Epoch: 50, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.396 Vali Acc: 0.933 Test Loss: 0.396 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 51 cost time: 0.6197729110717773
Epoch: 51, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.386 Vali Acc: 0.933 Test Loss: 0.386 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 52 cost time: 0.6262326240539551
Epoch: 52, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.377 Vali Acc: 0.933 Test Loss: 0.377 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 53 cost time: 0.6226041316986084
Epoch: 53, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.368 Vali Acc: 0.933 Test Loss: 0.368 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 54 cost time: 0.6138780117034912
Epoch: 54, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.360 Vali Acc: 0.933 Test Loss: 0.360 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 55 cost time: 0.8123431205749512
Epoch: 55, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.353 Vali Acc: 0.930 Test Loss: 0.353 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7396800518035889
Epoch: 56, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.346 Vali Acc: 0.930 Test Loss: 0.346 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6940176486968994
Epoch: 57, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.338 Vali Acc: 0.930 Test Loss: 0.338 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.7113018035888672
Epoch: 58, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.331 Vali Acc: 0.930 Test Loss: 0.331 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6409597396850586
Epoch: 59, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.325 Vali Acc: 0.930 Test Loss: 0.325 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.5552234649658203
Epoch: 60, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.6669983863830566
Epoch: 61, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.313 Vali Acc: 0.933 Test Loss: 0.313 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 62 cost time: 0.49157047271728516
Epoch: 62, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 63 cost time: 0.706364631652832
Epoch: 63, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 64 cost time: 0.5984392166137695
Epoch: 64, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 65 cost time: 0.5554995536804199
Epoch: 65, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.293 Vali Acc: 0.933 Test Loss: 0.293 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 66 cost time: 0.5349180698394775
Epoch: 66, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.289 Vali Acc: 0.937 Test Loss: 0.289 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 67 cost time: 0.558192253112793
Epoch: 67, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.285 Vali Acc: 0.937 Test Loss: 0.285 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 68 cost time: 0.5899031162261963
Epoch: 68, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.282 Vali Acc: 0.937 Test Loss: 0.282 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 69 cost time: 0.579113245010376
Epoch: 69, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6043763160705566
Epoch: 70, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.274 Vali Acc: 0.937 Test Loss: 0.274 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 71 cost time: 0.5255982875823975
Epoch: 71, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 72 cost time: 0.5659000873565674
Epoch: 72, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 73 cost time: 0.6057155132293701
Epoch: 73, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.5641822814941406
Epoch: 74, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.5897138118743896
Epoch: 75, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 76 cost time: 0.6213996410369873
Epoch: 76, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 77 cost time: 0.5434260368347168
Epoch: 77, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 78 cost time: 0.5312554836273193
Epoch: 78, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 79 cost time: 0.6879708766937256
Epoch: 79, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 80 cost time: 0.6857998371124268
Epoch: 80, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 81 cost time: 0.5826830863952637
Epoch: 81, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 82 cost time: 0.5730738639831543
Epoch: 82, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 83 cost time: 0.5477910041809082
Epoch: 83, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 84 cost time: 0.6697080135345459
Epoch: 84, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 85 cost time: 0.6311423778533936
Epoch: 85, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 86 cost time: 0.6614859104156494
Epoch: 86, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 87 cost time: 0.5987772941589355
Epoch: 87, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 88 cost time: 0.5875155925750732
Epoch: 88, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 89 cost time: 0.5708267688751221
Epoch: 89, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.6220617294311523
Epoch: 90, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 91 cost time: 0.5682163238525391
Epoch: 91, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 92 cost time: 0.6202859878540039
Epoch: 92, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 93 cost time: 0.6384060382843018
Epoch: 93, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 94 cost time: 0.6322965621948242
Epoch: 94, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.6503570079803467
Epoch: 95, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 96 cost time: 0.5048654079437256
Epoch: 96, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 97 cost time: 0.722707986831665
Epoch: 97, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 98 cost time: 0.6105964183807373
Epoch: 98, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.6395041942596436
Epoch: 99, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 100 cost time: 0.5875828266143799
Epoch: 100, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 258782
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2064080238342285
Epoch: 1, Steps: 2 | Train Loss: 1.943 Vali Loss: 1.887 Vali Acc: 0.159 Test Loss: 1.887 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.6073832511901855
Epoch: 2, Steps: 2 | Train Loss: 1.898 Vali Loss: 1.866 Vali Acc: 0.167 Test Loss: 1.866 Test Acc: 0.167
Validation loss decreased (-0.159240 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.5964486598968506
Epoch: 3, Steps: 2 | Train Loss: 1.931 Vali Loss: 1.849 Vali Acc: 0.163 Test Loss: 1.849 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.6232500076293945
Epoch: 4, Steps: 2 | Train Loss: 1.907 Vali Loss: 1.832 Vali Acc: 0.178 Test Loss: 1.832 Test Acc: 0.178
Validation loss decreased (-0.166648 --> -0.177759).  Saving model ...
Epoch: 5 cost time: 0.6644721031188965
Epoch: 5, Steps: 2 | Train Loss: 1.898 Vali Loss: 1.811 Vali Acc: 0.185 Test Loss: 1.811 Test Acc: 0.185
Validation loss decreased (-0.177759 --> -0.185167).  Saving model ...
Epoch: 6 cost time: 0.5225515365600586
Epoch: 6, Steps: 2 | Train Loss: 1.919 Vali Loss: 1.787 Vali Acc: 0.215 Test Loss: 1.787 Test Acc: 0.215
Validation loss decreased (-0.185167 --> -0.214797).  Saving model ...
Epoch: 7 cost time: 0.6333556175231934
Epoch: 7, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.760 Vali Acc: 0.259 Test Loss: 1.760 Test Acc: 0.259
Validation loss decreased (-0.214797 --> -0.259242).  Saving model ...
Epoch: 8 cost time: 0.688697099685669
Epoch: 8, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.732 Vali Acc: 0.293 Test Loss: 1.732 Test Acc: 0.293
Validation loss decreased (-0.259242 --> -0.292575).  Saving model ...
Epoch: 9 cost time: 0.6175591945648193
Epoch: 9, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.704 Vali Acc: 0.326 Test Loss: 1.704 Test Acc: 0.326
Validation loss decreased (-0.292575 --> -0.325909).  Saving model ...
Epoch: 10 cost time: 0.5363054275512695
Epoch: 10, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.675 Vali Acc: 0.367 Test Loss: 1.675 Test Acc: 0.367
Validation loss decreased (-0.325909 --> -0.366650).  Saving model ...
Epoch: 11 cost time: 0.5522503852844238
Epoch: 11, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.647 Vali Acc: 0.419 Test Loss: 1.647 Test Acc: 0.419
Validation loss decreased (-0.366650 --> -0.418502).  Saving model ...
Epoch: 12 cost time: 0.5510220527648926
Epoch: 12, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.619 Vali Acc: 0.467 Test Loss: 1.619 Test Acc: 0.467
Validation loss decreased (-0.418502 --> -0.466650).  Saving model ...
Epoch: 13 cost time: 0.640545129776001
Epoch: 13, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.590 Vali Acc: 0.515 Test Loss: 1.590 Test Acc: 0.515
Validation loss decreased (-0.466650 --> -0.514799).  Saving model ...
Epoch: 14 cost time: 0.6010730266571045
Epoch: 14, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.561 Vali Acc: 0.541 Test Loss: 1.561 Test Acc: 0.541
Validation loss decreased (-0.514799 --> -0.540725).  Saving model ...
Epoch: 15 cost time: 0.6862504482269287
Epoch: 15, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.531 Vali Acc: 0.552 Test Loss: 1.531 Test Acc: 0.552
Validation loss decreased (-0.540725 --> -0.551837).  Saving model ...
Epoch: 16 cost time: 0.6005613803863525
Epoch: 16, Steps: 2 | Train Loss: 1.531 Vali Loss: 1.499 Vali Acc: 0.585 Test Loss: 1.499 Test Acc: 0.585
Validation loss decreased (-0.551837 --> -0.585170).  Saving model ...
Epoch: 17 cost time: 0.5929014682769775
Epoch: 17, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.464 Vali Acc: 0.607 Test Loss: 1.464 Test Acc: 0.607
Validation loss decreased (-0.585170 --> -0.607393).  Saving model ...
Epoch: 18 cost time: 0.6199827194213867
Epoch: 18, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.428 Vali Acc: 0.615 Test Loss: 1.428 Test Acc: 0.615
Validation loss decreased (-0.607393 --> -0.614801).  Saving model ...
Epoch: 19 cost time: 0.6752192974090576
Epoch: 19, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.392 Vali Acc: 0.648 Test Loss: 1.392 Test Acc: 0.648
Validation loss decreased (-0.614801 --> -0.648134).  Saving model ...
Epoch: 20 cost time: 0.7619738578796387
Epoch: 20, Steps: 2 | Train Loss: 1.327 Vali Loss: 1.354 Vali Acc: 0.674 Test Loss: 1.354 Test Acc: 0.674
Validation loss decreased (-0.648134 --> -0.674061).  Saving model ...
Epoch: 21 cost time: 0.6170971393585205
Epoch: 21, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.314 Vali Acc: 0.711 Test Loss: 1.314 Test Acc: 0.711
Validation loss decreased (-0.674061 --> -0.711098).  Saving model ...
Epoch: 22 cost time: 0.589846134185791
Epoch: 22, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.275 Vali Acc: 0.733 Test Loss: 1.275 Test Acc: 0.733
Validation loss decreased (-0.711098 --> -0.733321).  Saving model ...
Epoch: 23 cost time: 0.6121814250946045
Epoch: 23, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.235 Vali Acc: 0.748 Test Loss: 1.235 Test Acc: 0.748
Validation loss decreased (-0.733321 --> -0.748136).  Saving model ...
Epoch: 24 cost time: 0.6889796257019043
Epoch: 24, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.194 Vali Acc: 0.759 Test Loss: 1.194 Test Acc: 0.759
Validation loss decreased (-0.748136 --> -0.759247).  Saving model ...
Epoch: 25 cost time: 0.7645134925842285
Epoch: 25, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.153 Vali Acc: 0.774 Test Loss: 1.153 Test Acc: 0.774
Validation loss decreased (-0.759247 --> -0.774063).  Saving model ...
Epoch: 26 cost time: 0.6589477062225342
Epoch: 26, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.111 Vali Acc: 0.800 Test Loss: 1.111 Test Acc: 0.800
Validation loss decreased (-0.774063 --> -0.799989).  Saving model ...
Epoch: 27 cost time: 0.8097460269927979
Epoch: 27, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.069 Vali Acc: 0.822 Test Loss: 1.069 Test Acc: 0.822
Validation loss decreased (-0.799989 --> -0.822212).  Saving model ...
Epoch: 28 cost time: 0.5456526279449463
Epoch: 28, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.026 Vali Acc: 0.826 Test Loss: 1.026 Test Acc: 0.826
Validation loss decreased (-0.822212 --> -0.825916).  Saving model ...
Epoch: 29 cost time: 0.56642746925354
Epoch: 29, Steps: 2 | Train Loss: 0.935 Vali Loss: 0.983 Vali Acc: 0.837 Test Loss: 0.983 Test Acc: 0.837
Validation loss decreased (-0.825916 --> -0.837027).  Saving model ...
Epoch: 30 cost time: 0.6145720481872559
Epoch: 30, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.941 Vali Acc: 0.837 Test Loss: 0.941 Test Acc: 0.837
Validation loss decreased (-0.837027 --> -0.837028).  Saving model ...
Epoch: 31 cost time: 0.7041542530059814
Epoch: 31, Steps: 2 | Train Loss: 0.832 Vali Loss: 0.899 Vali Acc: 0.856 Test Loss: 0.899 Test Acc: 0.856
Validation loss decreased (-0.837028 --> -0.855547).  Saving model ...
Epoch: 32 cost time: 0.5743608474731445
Epoch: 32, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.859 Vali Acc: 0.856 Test Loss: 0.859 Test Acc: 0.856
Validation loss decreased (-0.855547 --> -0.855547).  Saving model ...
Epoch: 33 cost time: 0.6911418437957764
Epoch: 33, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.820 Vali Acc: 0.867 Test Loss: 0.820 Test Acc: 0.867
Validation loss decreased (-0.855547 --> -0.866658).  Saving model ...
Epoch: 34 cost time: 0.6526286602020264
Epoch: 34, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.783 Vali Acc: 0.859 Test Loss: 0.783 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5211858749389648
Epoch: 35, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.748 Vali Acc: 0.859 Test Loss: 0.748 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5486640930175781
Epoch: 36, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.714 Vali Acc: 0.856 Test Loss: 0.714 Test Acc: 0.856
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5907196998596191
Epoch: 37, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.682 Vali Acc: 0.863 Test Loss: 0.682 Test Acc: 0.863
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6833512783050537
Epoch: 38, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.651 Vali Acc: 0.870 Test Loss: 0.651 Test Acc: 0.870
Validation loss decreased (-0.866658 --> -0.870364).  Saving model ...
Epoch: 39 cost time: 0.633551836013794
Epoch: 39, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.622 Vali Acc: 0.878 Test Loss: 0.622 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877772).  Saving model ...
Epoch: 40 cost time: 0.5730695724487305
Epoch: 40, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.594 Vali Acc: 0.900 Test Loss: 0.594 Test Acc: 0.900
Validation loss decreased (-0.877772 --> -0.899994).  Saving model ...
Epoch: 41 cost time: 0.6472253799438477
Epoch: 41, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.570 Vali Acc: 0.896 Test Loss: 0.570 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.578336238861084
Epoch: 42, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.547 Vali Acc: 0.896 Test Loss: 0.547 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.7473342418670654
Epoch: 43, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.525 Vali Acc: 0.904 Test Loss: 0.525 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 44 cost time: 0.7024335861206055
Epoch: 44, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.505 Vali Acc: 0.907 Test Loss: 0.505 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 45 cost time: 0.5873031616210938
Epoch: 45, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.486 Vali Acc: 0.911 Test Loss: 0.486 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 46 cost time: 0.6046571731567383
Epoch: 46, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.468 Vali Acc: 0.919 Test Loss: 0.468 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 47 cost time: 0.6914768218994141
Epoch: 47, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.452 Vali Acc: 0.922 Test Loss: 0.452 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 48 cost time: 0.6027491092681885
Epoch: 48, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.438 Vali Acc: 0.930 Test Loss: 0.438 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929625).  Saving model ...
Epoch: 49 cost time: 0.578618049621582
Epoch: 49, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.424 Vali Acc: 0.930 Test Loss: 0.424 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 50 cost time: 0.5617623329162598
Epoch: 50, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.412 Vali Acc: 0.930 Test Loss: 0.412 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 51 cost time: 0.5631508827209473
Epoch: 51, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.401 Vali Acc: 0.922 Test Loss: 0.401 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7036242485046387
Epoch: 52, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.391 Vali Acc: 0.926 Test Loss: 0.391 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.5903027057647705
Epoch: 53, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.381 Vali Acc: 0.930 Test Loss: 0.381 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 54 cost time: 0.6315324306488037
Epoch: 54, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.373 Vali Acc: 0.926 Test Loss: 0.373 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6031394004821777
Epoch: 55, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.364 Vali Acc: 0.930 Test Loss: 0.364 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 56 cost time: 0.5486054420471191
Epoch: 56, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.357 Vali Acc: 0.926 Test Loss: 0.357 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.616950511932373
Epoch: 57, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.349 Vali Acc: 0.926 Test Loss: 0.349 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6159000396728516
Epoch: 58, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 59 cost time: 0.6248278617858887
Epoch: 59, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.335 Vali Acc: 0.933 Test Loss: 0.335 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 60 cost time: 0.5611867904663086
Epoch: 60, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.330 Vali Acc: 0.933 Test Loss: 0.330 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 61 cost time: 0.6929066181182861
Epoch: 61, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 62 cost time: 0.5983893871307373
Epoch: 62, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.318 Vali Acc: 0.933 Test Loss: 0.318 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 63 cost time: 0.6672220230102539
Epoch: 63, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.313 Vali Acc: 0.930 Test Loss: 0.313 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6469156742095947
Epoch: 64, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.308 Vali Acc: 0.926 Test Loss: 0.308 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.6058559417724609
Epoch: 65, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.304 Vali Acc: 0.933 Test Loss: 0.304 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 66 cost time: 0.5191919803619385
Epoch: 66, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.299 Vali Acc: 0.933 Test Loss: 0.299 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 67 cost time: 0.6538822650909424
Epoch: 67, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 68 cost time: 0.6601409912109375
Epoch: 68, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 69 cost time: 0.5193166732788086
Epoch: 69, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.287 Vali Acc: 0.941 Test Loss: 0.287 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 70 cost time: 0.6664164066314697
Epoch: 70, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 71 cost time: 0.6491460800170898
Epoch: 71, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.279 Vali Acc: 0.941 Test Loss: 0.279 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 72 cost time: 0.5966637134552002
Epoch: 72, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 73 cost time: 0.6502995491027832
Epoch: 73, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.273 Vali Acc: 0.941 Test Loss: 0.273 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 74 cost time: 0.652714729309082
Epoch: 74, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.6748416423797607
Epoch: 75, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 76 cost time: 0.671438455581665
Epoch: 76, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 77 cost time: 0.5732612609863281
Epoch: 77, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.261 Vali Acc: 0.941 Test Loss: 0.261 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 78 cost time: 0.6107983589172363
Epoch: 78, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7078025341033936
Epoch: 79, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.6543076038360596
Epoch: 80, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.6114025115966797
Epoch: 81, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.637664794921875
Epoch: 82, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.5274295806884766
Epoch: 83, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 84 cost time: 0.6809062957763672
Epoch: 84, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 85 cost time: 0.6413962841033936
Epoch: 85, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 86 cost time: 0.6153028011322021
Epoch: 86, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 87 cost time: 0.6026186943054199
Epoch: 87, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 88 cost time: 0.5828802585601807
Epoch: 88, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 89 cost time: 0.6417300701141357
Epoch: 89, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 90 cost time: 0.6682732105255127
Epoch: 90, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 91 cost time: 0.6418647766113281
Epoch: 91, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 92 cost time: 0.5705487728118896
Epoch: 92, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 93 cost time: 0.8036050796508789
Epoch: 93, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 94 cost time: 0.5559718608856201
Epoch: 94, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 95 cost time: 0.7275817394256592
Epoch: 95, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 96 cost time: 0.5511868000030518
Epoch: 96, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.628551721572876
Epoch: 97, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.76698899269104
Epoch: 98, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.6289684772491455
Epoch: 99, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.6360683441162109
Epoch: 100, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 258590
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0654489994049072
Epoch: 1, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.858 Vali Acc: 0.204 Test Loss: 1.858 Test Acc: 0.204
Validation loss decreased (inf --> -0.203685).  Saving model ...
Epoch: 2 cost time: 0.5158298015594482
Epoch: 2, Steps: 2 | Train Loss: 1.874 Vali Loss: 1.826 Vali Acc: 0.193 Test Loss: 1.826 Test Acc: 0.193
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.6256463527679443
Epoch: 3, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.802 Vali Acc: 0.181 Test Loss: 1.802 Test Acc: 0.181
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.5835599899291992
Epoch: 4, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.778 Vali Acc: 0.178 Test Loss: 1.778 Test Acc: 0.178
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.6172926425933838
Epoch: 5, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.749 Vali Acc: 0.196 Test Loss: 1.749 Test Acc: 0.196
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 0.603905200958252
Epoch: 6, Steps: 2 | Train Loss: 1.726 Vali Loss: 1.718 Vali Acc: 0.219 Test Loss: 1.718 Test Acc: 0.219
Validation loss decreased (-0.203685 --> -0.218501).  Saving model ...
Epoch: 7 cost time: 0.6800334453582764
Epoch: 7, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.687 Vali Acc: 0.267 Test Loss: 1.687 Test Acc: 0.267
Validation loss decreased (-0.218501 --> -0.266650).  Saving model ...
Epoch: 8 cost time: 0.5300378799438477
Epoch: 8, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.655 Vali Acc: 0.341 Test Loss: 1.655 Test Acc: 0.341
Validation loss decreased (-0.266650 --> -0.340724).  Saving model ...
Epoch: 9 cost time: 0.5928466320037842
Epoch: 9, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.624 Vali Acc: 0.374 Test Loss: 1.624 Test Acc: 0.374
Validation loss decreased (-0.340724 --> -0.374058).  Saving model ...
Epoch: 10 cost time: 0.6919746398925781
Epoch: 10, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.592 Vali Acc: 0.400 Test Loss: 1.592 Test Acc: 0.400
Validation loss decreased (-0.374058 --> -0.399984).  Saving model ...
Epoch: 11 cost time: 0.5325772762298584
Epoch: 11, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.561 Vali Acc: 0.437 Test Loss: 1.561 Test Acc: 0.437
Validation loss decreased (-0.399984 --> -0.437021).  Saving model ...
Epoch: 12 cost time: 0.6639695167541504
Epoch: 12, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.530 Vali Acc: 0.481 Test Loss: 1.530 Test Acc: 0.481
Validation loss decreased (-0.437021 --> -0.481466).  Saving model ...
Epoch: 13 cost time: 0.5616822242736816
Epoch: 13, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.498 Vali Acc: 0.526 Test Loss: 1.498 Test Acc: 0.526
Validation loss decreased (-0.481466 --> -0.525911).  Saving model ...
Epoch: 14 cost time: 0.7058477401733398
Epoch: 14, Steps: 2 | Train Loss: 1.432 Vali Loss: 1.464 Vali Acc: 0.556 Test Loss: 1.464 Test Acc: 0.556
Validation loss decreased (-0.525911 --> -0.555541).  Saving model ...
Epoch: 15 cost time: 0.5501000881195068
Epoch: 15, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.428 Vali Acc: 0.600 Test Loss: 1.428 Test Acc: 0.600
Validation loss decreased (-0.555541 --> -0.599986).  Saving model ...
Epoch: 16 cost time: 0.5570931434631348
Epoch: 16, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.390 Vali Acc: 0.615 Test Loss: 1.390 Test Acc: 0.615
Validation loss decreased (-0.599986 --> -0.614801).  Saving model ...
Epoch: 17 cost time: 0.5415830612182617
Epoch: 17, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.352 Vali Acc: 0.626 Test Loss: 1.352 Test Acc: 0.626
Validation loss decreased (-0.614801 --> -0.625912).  Saving model ...
Epoch: 18 cost time: 0.6907978057861328
Epoch: 18, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.313 Vali Acc: 0.659 Test Loss: 1.313 Test Acc: 0.659
Validation loss decreased (-0.625912 --> -0.659246).  Saving model ...
Epoch: 19 cost time: 0.6269128322601318
Epoch: 19, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.273 Vali Acc: 0.678 Test Loss: 1.273 Test Acc: 0.678
Validation loss decreased (-0.659246 --> -0.677765).  Saving model ...
Epoch: 20 cost time: 0.6120548248291016
Epoch: 20, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.233 Vali Acc: 0.719 Test Loss: 1.233 Test Acc: 0.719
Validation loss decreased (-0.677765 --> -0.718506).  Saving model ...
Epoch: 21 cost time: 0.5946099758148193
Epoch: 21, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.193 Vali Acc: 0.733 Test Loss: 1.193 Test Acc: 0.733
Validation loss decreased (-0.718506 --> -0.733321).  Saving model ...
Epoch: 22 cost time: 0.613419771194458
Epoch: 22, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.152 Vali Acc: 0.737 Test Loss: 1.152 Test Acc: 0.737
Validation loss decreased (-0.733321 --> -0.737026).  Saving model ...
Epoch: 23 cost time: 0.6184303760528564
Epoch: 23, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.112 Vali Acc: 0.756 Test Loss: 1.112 Test Acc: 0.756
Validation loss decreased (-0.737026 --> -0.755544).  Saving model ...
Epoch: 24 cost time: 0.6111645698547363
Epoch: 24, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.071 Vali Acc: 0.763 Test Loss: 1.071 Test Acc: 0.763
Validation loss decreased (-0.755544 --> -0.762952).  Saving model ...
Epoch: 25 cost time: 0.6124894618988037
Epoch: 25, Steps: 2 | Train Loss: 0.927 Vali Loss: 1.030 Vali Acc: 0.789 Test Loss: 1.030 Test Acc: 0.789
Validation loss decreased (-0.762952 --> -0.788879).  Saving model ...
Epoch: 26 cost time: 0.6567728519439697
Epoch: 26, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.991 Vali Acc: 0.804 Test Loss: 0.991 Test Acc: 0.804
Validation loss decreased (-0.788879 --> -0.803694).  Saving model ...
Epoch: 27 cost time: 0.5463356971740723
Epoch: 27, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.951 Vali Acc: 0.815 Test Loss: 0.951 Test Acc: 0.815
Validation loss decreased (-0.803694 --> -0.814805).  Saving model ...
Epoch: 28 cost time: 0.7700517177581787
Epoch: 28, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.913 Vali Acc: 0.815 Test Loss: 0.913 Test Acc: 0.815
Validation loss decreased (-0.814805 --> -0.814806).  Saving model ...
Epoch: 29 cost time: 0.8347976207733154
Epoch: 29, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.875 Vali Acc: 0.826 Test Loss: 0.875 Test Acc: 0.826
Validation loss decreased (-0.814806 --> -0.825917).  Saving model ...
Epoch: 30 cost time: 0.5208332538604736
Epoch: 30, Steps: 2 | Train Loss: 0.749 Vali Loss: 0.838 Vali Acc: 0.826 Test Loss: 0.838 Test Acc: 0.826
Validation loss decreased (-0.825917 --> -0.825918).  Saving model ...
Epoch: 31 cost time: 0.6064977645874023
Epoch: 31, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.801 Vali Acc: 0.837 Test Loss: 0.801 Test Acc: 0.837
Validation loss decreased (-0.825918 --> -0.837029).  Saving model ...
Epoch: 32 cost time: 0.6683163642883301
Epoch: 32, Steps: 2 | Train Loss: 0.671 Vali Loss: 0.766 Vali Acc: 0.841 Test Loss: 0.766 Test Acc: 0.841
Validation loss decreased (-0.837029 --> -0.840733).  Saving model ...
Epoch: 33 cost time: 0.6588976383209229
Epoch: 33, Steps: 2 | Train Loss: 0.614 Vali Loss: 0.731 Vali Acc: 0.848 Test Loss: 0.731 Test Acc: 0.848
Validation loss decreased (-0.840733 --> -0.848141).  Saving model ...
Epoch: 34 cost time: 0.586885929107666
Epoch: 34, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.699 Vali Acc: 0.856 Test Loss: 0.699 Test Acc: 0.856
Validation loss decreased (-0.848141 --> -0.855549).  Saving model ...
Epoch: 35 cost time: 0.5702681541442871
Epoch: 35, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.668 Vali Acc: 0.863 Test Loss: 0.668 Test Acc: 0.863
Validation loss decreased (-0.855549 --> -0.862956).  Saving model ...
Epoch: 36 cost time: 0.7526054382324219
Epoch: 36, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.639 Vali Acc: 0.870 Test Loss: 0.639 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870364).  Saving model ...
Epoch: 37 cost time: 0.6385011672973633
Epoch: 37, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.612 Vali Acc: 0.881 Test Loss: 0.612 Test Acc: 0.881
Validation loss decreased (-0.870364 --> -0.881475).  Saving model ...
Epoch: 38 cost time: 0.7697975635528564
Epoch: 38, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.586 Vali Acc: 0.885 Test Loss: 0.586 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 39 cost time: 0.5855312347412109
Epoch: 39, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.562 Vali Acc: 0.885 Test Loss: 0.562 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885180).  Saving model ...
Epoch: 40 cost time: 0.6292867660522461
Epoch: 40, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.540 Vali Acc: 0.889 Test Loss: 0.540 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888883).  Saving model ...
Epoch: 41 cost time: 0.5735745429992676
Epoch: 41, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.519 Vali Acc: 0.889 Test Loss: 0.519 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888884).  Saving model ...
Epoch: 42 cost time: 0.6325430870056152
Epoch: 42, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.501 Vali Acc: 0.889 Test Loss: 0.501 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 43 cost time: 0.5826807022094727
Epoch: 43, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.484 Vali Acc: 0.893 Test Loss: 0.484 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 44 cost time: 0.5486886501312256
Epoch: 44, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.468 Vali Acc: 0.896 Test Loss: 0.468 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 45 cost time: 0.4828517436981201
Epoch: 45, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.453 Vali Acc: 0.896 Test Loss: 0.453 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 46 cost time: 0.5972497463226318
Epoch: 46, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.438 Vali Acc: 0.900 Test Loss: 0.438 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 47 cost time: 0.6048741340637207
Epoch: 47, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.424 Vali Acc: 0.907 Test Loss: 0.424 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907403).  Saving model ...
Epoch: 48 cost time: 0.5468933582305908
Epoch: 48, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.411 Vali Acc: 0.911 Test Loss: 0.411 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 49 cost time: 0.7002358436584473
Epoch: 49, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.399 Vali Acc: 0.911 Test Loss: 0.399 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 50 cost time: 0.7109224796295166
Epoch: 50, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.389 Vali Acc: 0.911 Test Loss: 0.389 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 51 cost time: 0.5518796443939209
Epoch: 51, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.379 Vali Acc: 0.911 Test Loss: 0.379 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 52 cost time: 0.6883838176727295
Epoch: 52, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.369 Vali Acc: 0.911 Test Loss: 0.369 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 53 cost time: 0.6114485263824463
Epoch: 53, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 54 cost time: 0.6331865787506104
Epoch: 54, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.351 Vali Acc: 0.915 Test Loss: 0.351 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914811).  Saving model ...
Epoch: 55 cost time: 0.6320538520812988
Epoch: 55, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.344 Vali Acc: 0.915 Test Loss: 0.344 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 56 cost time: 0.7665009498596191
Epoch: 56, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.336 Vali Acc: 0.915 Test Loss: 0.336 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 57 cost time: 0.5072727203369141
Epoch: 57, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.330 Vali Acc: 0.919 Test Loss: 0.330 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 58 cost time: 0.607048749923706
Epoch: 58, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.323 Vali Acc: 0.919 Test Loss: 0.323 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 59 cost time: 0.5819499492645264
Epoch: 59, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.317 Vali Acc: 0.922 Test Loss: 0.317 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 60 cost time: 0.6680359840393066
Epoch: 60, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 61 cost time: 0.7158286571502686
Epoch: 61, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 62 cost time: 0.6180036067962646
Epoch: 62, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.303 Vali Acc: 0.937 Test Loss: 0.303 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 63 cost time: 0.6541569232940674
Epoch: 63, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.297 Vali Acc: 0.937 Test Loss: 0.297 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 64 cost time: 0.7376606464385986
Epoch: 64, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 65 cost time: 0.6134743690490723
Epoch: 65, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.288 Vali Acc: 0.937 Test Loss: 0.288 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 66 cost time: 0.6473376750946045
Epoch: 66, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 67 cost time: 0.5978524684906006
Epoch: 67, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.596804141998291
Epoch: 68, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.275 Vali Acc: 0.930 Test Loss: 0.275 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6091897487640381
Epoch: 69, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.271 Vali Acc: 0.933 Test Loss: 0.271 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.539438009262085
Epoch: 70, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 71 cost time: 0.6777613162994385
Epoch: 71, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 72 cost time: 0.5429599285125732
Epoch: 72, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 0.6680629253387451
Epoch: 73, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 74 cost time: 0.5997514724731445
Epoch: 74, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 75 cost time: 0.5874037742614746
Epoch: 75, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.7465667724609375
Epoch: 76, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 77 cost time: 0.6695585250854492
Epoch: 77, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 0.6254701614379883
Epoch: 78, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 79 cost time: 0.6235766410827637
Epoch: 79, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.244 Vali Acc: 0.944 Test Loss: 0.244 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 80 cost time: 0.6836161613464355
Epoch: 80, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 81 cost time: 0.563889741897583
Epoch: 81, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 82 cost time: 0.6214039325714111
Epoch: 82, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 0.669745922088623
Epoch: 83, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 84 cost time: 0.6152811050415039
Epoch: 84, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 85 cost time: 0.5982248783111572
Epoch: 85, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 86 cost time: 0.6409854888916016
Epoch: 86, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 87 cost time: 0.5814695358276367
Epoch: 87, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 88 cost time: 0.5361020565032959
Epoch: 88, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 89 cost time: 0.5573558807373047
Epoch: 89, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 90 cost time: 0.6015582084655762
Epoch: 90, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 91 cost time: 0.6376707553863525
Epoch: 91, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.6760127544403076
Epoch: 92, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 93 cost time: 0.6548933982849121
Epoch: 93, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 94 cost time: 0.791405439376831
Epoch: 94, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 95 cost time: 0.637345552444458
Epoch: 95, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.216 Vali Acc: 0.948 Test Loss: 0.216 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 96 cost time: 0.5281755924224854
Epoch: 96, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 97 cost time: 0.5329654216766357
Epoch: 97, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 98 cost time: 0.5563838481903076
Epoch: 98, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 99 cost time: 0.6236393451690674
Epoch: 99, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 100 cost time: 0.681431770324707
Epoch: 100, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 258398
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1653332710266113
Epoch: 1, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.826 Vali Acc: 0.100 Test Loss: 1.826 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 0.6975226402282715
Epoch: 2, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.803 Vali Acc: 0.100 Test Loss: 1.803 Test Acc: 0.100
Validation loss decreased (-0.099982 --> -0.099982).  Saving model ...
Epoch: 3 cost time: 0.6630065441131592
Epoch: 3, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.786 Vali Acc: 0.111 Test Loss: 1.786 Test Acc: 0.111
Validation loss decreased (-0.099982 --> -0.111093).  Saving model ...
Epoch: 4 cost time: 0.6819362640380859
Epoch: 4, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.771 Vali Acc: 0.122 Test Loss: 1.771 Test Acc: 0.122
Validation loss decreased (-0.111093 --> -0.122205).  Saving model ...
Epoch: 5 cost time: 0.6542820930480957
Epoch: 5, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.753 Vali Acc: 0.148 Test Loss: 1.753 Test Acc: 0.148
Validation loss decreased (-0.122205 --> -0.148131).  Saving model ...
Epoch: 6 cost time: 0.689039945602417
Epoch: 6, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.733 Vali Acc: 0.181 Test Loss: 1.733 Test Acc: 0.181
Validation loss decreased (-0.148131 --> -0.181464).  Saving model ...
Epoch: 7 cost time: 0.6864101886749268
Epoch: 7, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.712 Vali Acc: 0.204 Test Loss: 1.712 Test Acc: 0.204
Validation loss decreased (-0.181464 --> -0.203687).  Saving model ...
Epoch: 8 cost time: 0.7405140399932861
Epoch: 8, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.690 Vali Acc: 0.263 Test Loss: 1.690 Test Acc: 0.263
Validation loss decreased (-0.203687 --> -0.262946).  Saving model ...
Epoch: 9 cost time: 0.7200722694396973
Epoch: 9, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.667 Vali Acc: 0.285 Test Loss: 1.667 Test Acc: 0.285
Validation loss decreased (-0.262946 --> -0.285169).  Saving model ...
Epoch: 10 cost time: 0.5759587287902832
Epoch: 10, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.643 Vali Acc: 0.330 Test Loss: 1.643 Test Acc: 0.330
Validation loss decreased (-0.285169 --> -0.329613).  Saving model ...
Epoch: 11 cost time: 0.8025679588317871
Epoch: 11, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.619 Vali Acc: 0.367 Test Loss: 1.619 Test Acc: 0.367
Validation loss decreased (-0.329613 --> -0.366650).  Saving model ...
Epoch: 12 cost time: 0.5827944278717041
Epoch: 12, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.594 Vali Acc: 0.441 Test Loss: 1.594 Test Acc: 0.441
Validation loss decreased (-0.366650 --> -0.440725).  Saving model ...
Epoch: 13 cost time: 0.8054816722869873
Epoch: 13, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.569 Vali Acc: 0.507 Test Loss: 1.569 Test Acc: 0.507
Validation loss decreased (-0.440725 --> -0.507392).  Saving model ...
Epoch: 14 cost time: 0.590543270111084
Epoch: 14, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.544 Vali Acc: 0.548 Test Loss: 1.544 Test Acc: 0.548
Validation loss decreased (-0.507392 --> -0.548133).  Saving model ...
Epoch: 15 cost time: 0.6399233341217041
Epoch: 15, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.516 Vali Acc: 0.585 Test Loss: 1.516 Test Acc: 0.585
Validation loss decreased (-0.548133 --> -0.585170).  Saving model ...
Epoch: 16 cost time: 0.5203690528869629
Epoch: 16, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.488 Vali Acc: 0.626 Test Loss: 1.488 Test Acc: 0.626
Validation loss decreased (-0.585170 --> -0.625911).  Saving model ...
Epoch: 17 cost time: 0.5708410739898682
Epoch: 17, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.459 Vali Acc: 0.648 Test Loss: 1.459 Test Acc: 0.648
Validation loss decreased (-0.625911 --> -0.648134).  Saving model ...
Epoch: 18 cost time: 0.6802539825439453
Epoch: 18, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.429 Vali Acc: 0.678 Test Loss: 1.429 Test Acc: 0.678
Validation loss decreased (-0.648134 --> -0.677763).  Saving model ...
Epoch: 19 cost time: 0.6462173461914062
Epoch: 19, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.396 Vali Acc: 0.700 Test Loss: 1.396 Test Acc: 0.700
Validation loss decreased (-0.677763 --> -0.699986).  Saving model ...
Epoch: 20 cost time: 0.5889930725097656
Epoch: 20, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.361 Vali Acc: 0.726 Test Loss: 1.361 Test Acc: 0.726
Validation loss decreased (-0.699986 --> -0.725912).  Saving model ...
Epoch: 21 cost time: 0.5855460166931152
Epoch: 21, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.325 Vali Acc: 0.748 Test Loss: 1.325 Test Acc: 0.748
Validation loss decreased (-0.725912 --> -0.748135).  Saving model ...
Epoch: 22 cost time: 0.6469154357910156
Epoch: 22, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.289 Vali Acc: 0.759 Test Loss: 1.289 Test Acc: 0.759
Validation loss decreased (-0.748135 --> -0.759246).  Saving model ...
Epoch: 23 cost time: 0.6743953227996826
Epoch: 23, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.253 Vali Acc: 0.789 Test Loss: 1.253 Test Acc: 0.789
Validation loss decreased (-0.759246 --> -0.788876).  Saving model ...
Epoch: 24 cost time: 0.7797112464904785
Epoch: 24, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.217 Vali Acc: 0.793 Test Loss: 1.217 Test Acc: 0.793
Validation loss decreased (-0.788876 --> -0.792580).  Saving model ...
Epoch: 25 cost time: 0.7291316986083984
Epoch: 25, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.181 Vali Acc: 0.800 Test Loss: 1.181 Test Acc: 0.800
Validation loss decreased (-0.792580 --> -0.799988).  Saving model ...
Epoch: 26 cost time: 0.6172699928283691
Epoch: 26, Steps: 2 | Train Loss: 1.010 Vali Loss: 1.145 Vali Acc: 0.819 Test Loss: 1.145 Test Acc: 0.819
Validation loss decreased (-0.799988 --> -0.818507).  Saving model ...
Epoch: 27 cost time: 0.6861841678619385
Epoch: 27, Steps: 2 | Train Loss: 1.003 Vali Loss: 1.108 Vali Acc: 0.819 Test Loss: 1.108 Test Acc: 0.819
Validation loss decreased (-0.818507 --> -0.818507).  Saving model ...
Epoch: 28 cost time: 0.7433080673217773
Epoch: 28, Steps: 2 | Train Loss: 0.975 Vali Loss: 1.071 Vali Acc: 0.844 Test Loss: 1.071 Test Acc: 0.844
Validation loss decreased (-0.818507 --> -0.844434).  Saving model ...
Epoch: 29 cost time: 0.610175371170044
Epoch: 29, Steps: 2 | Train Loss: 0.942 Vali Loss: 1.033 Vali Acc: 0.856 Test Loss: 1.033 Test Acc: 0.856
Validation loss decreased (-0.844434 --> -0.855545).  Saving model ...
Epoch: 30 cost time: 0.6716814041137695
Epoch: 30, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.994 Vali Acc: 0.863 Test Loss: 0.994 Test Acc: 0.863
Validation loss decreased (-0.855545 --> -0.862953).  Saving model ...
Epoch: 31 cost time: 0.5727193355560303
Epoch: 31, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.955 Vali Acc: 0.867 Test Loss: 0.955 Test Acc: 0.867
Validation loss decreased (-0.862953 --> -0.866657).  Saving model ...
Epoch: 32 cost time: 0.6527276039123535
Epoch: 32, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.918 Vali Acc: 0.867 Test Loss: 0.918 Test Acc: 0.867
Validation loss decreased (-0.866657 --> -0.866657).  Saving model ...
Epoch: 33 cost time: 0.5702154636383057
Epoch: 33, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.881 Vali Acc: 0.874 Test Loss: 0.881 Test Acc: 0.874
Validation loss decreased (-0.866657 --> -0.874065).  Saving model ...
Epoch: 34 cost time: 0.5861983299255371
Epoch: 34, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.845 Vali Acc: 0.885 Test Loss: 0.845 Test Acc: 0.885
Validation loss decreased (-0.874065 --> -0.885177).  Saving model ...
Epoch: 35 cost time: 0.7624673843383789
Epoch: 35, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.810 Vali Acc: 0.889 Test Loss: 0.810 Test Acc: 0.889
Validation loss decreased (-0.885177 --> -0.888881).  Saving model ...
Epoch: 36 cost time: 0.5118575096130371
Epoch: 36, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.775 Vali Acc: 0.900 Test Loss: 0.775 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899992).  Saving model ...
Epoch: 37 cost time: 0.6263060569763184
Epoch: 37, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.741 Vali Acc: 0.900 Test Loss: 0.741 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 38 cost time: 0.5245378017425537
Epoch: 38, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.709 Vali Acc: 0.911 Test Loss: 0.709 Test Acc: 0.911
Validation loss decreased (-0.899993 --> -0.911104).  Saving model ...
Epoch: 39 cost time: 0.5287933349609375
Epoch: 39, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.679 Vali Acc: 0.911 Test Loss: 0.679 Test Acc: 0.911
Validation loss decreased (-0.911104 --> -0.911104).  Saving model ...
Epoch: 40 cost time: 0.6200692653656006
Epoch: 40, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.650 Vali Acc: 0.915 Test Loss: 0.650 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 41 cost time: 0.5515127182006836
Epoch: 41, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.624 Vali Acc: 0.922 Test Loss: 0.624 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 42 cost time: 0.638068675994873
Epoch: 42, Steps: 2 | Train Loss: 0.441 Vali Loss: 0.599 Vali Acc: 0.922 Test Loss: 0.599 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922216).  Saving model ...
Epoch: 43 cost time: 0.5858798027038574
Epoch: 43, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.575 Vali Acc: 0.926 Test Loss: 0.575 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 44 cost time: 0.5793273448944092
Epoch: 44, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.553 Vali Acc: 0.933 Test Loss: 0.553 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933328).  Saving model ...
Epoch: 45 cost time: 0.6596634387969971
Epoch: 45, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.532 Vali Acc: 0.933 Test Loss: 0.532 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 46 cost time: 0.53409743309021
Epoch: 46, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.512 Vali Acc: 0.933 Test Loss: 0.512 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 47 cost time: 0.5568785667419434
Epoch: 47, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.494 Vali Acc: 0.930 Test Loss: 0.494 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.7064318656921387
Epoch: 48, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.478 Vali Acc: 0.930 Test Loss: 0.478 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5650901794433594
Epoch: 49, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.463 Vali Acc: 0.930 Test Loss: 0.463 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.670799732208252
Epoch: 50, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.448 Vali Acc: 0.933 Test Loss: 0.448 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 51 cost time: 0.5735781192779541
Epoch: 51, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.435 Vali Acc: 0.933 Test Loss: 0.435 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 52 cost time: 0.6540467739105225
Epoch: 52, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.423 Vali Acc: 0.933 Test Loss: 0.423 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 53 cost time: 0.6738269329071045
Epoch: 53, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.412 Vali Acc: 0.933 Test Loss: 0.412 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 54 cost time: 0.526599645614624
Epoch: 54, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.400 Vali Acc: 0.937 Test Loss: 0.400 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 55 cost time: 0.73116135597229
Epoch: 55, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.390 Vali Acc: 0.937 Test Loss: 0.390 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 56 cost time: 0.6368215084075928
Epoch: 56, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.380 Vali Acc: 0.937 Test Loss: 0.380 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 57 cost time: 0.585756778717041
Epoch: 57, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.372 Vali Acc: 0.937 Test Loss: 0.372 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 58 cost time: 0.5624189376831055
Epoch: 58, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.363 Vali Acc: 0.933 Test Loss: 0.363 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6532492637634277
Epoch: 59, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.356 Vali Acc: 0.933 Test Loss: 0.356 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.682110071182251
Epoch: 60, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.7562901973724365
Epoch: 61, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.343 Vali Acc: 0.930 Test Loss: 0.343 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.6220130920410156
Epoch: 62, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.6036491394042969
Epoch: 63, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.330 Vali Acc: 0.930 Test Loss: 0.330 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.6012670993804932
Epoch: 64, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.325 Vali Acc: 0.922 Test Loss: 0.325 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.5392532348632812
Epoch: 65, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.321 Vali Acc: 0.926 Test Loss: 0.321 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.5602860450744629
Epoch: 66, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.5177590847015381
Epoch: 67, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 159134
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.871325969696045
Epoch: 1, Steps: 2 | Train Loss: 1.935 Vali Loss: 1.871 Vali Acc: 0.185 Test Loss: 1.871 Test Acc: 0.185
Validation loss decreased (inf --> -0.185166).  Saving model ...
Epoch: 2 cost time: 0.5461857318878174
Epoch: 2, Steps: 2 | Train Loss: 1.811 Vali Loss: 1.832 Vali Acc: 0.185 Test Loss: 1.832 Test Acc: 0.185
Validation loss decreased (-0.185166 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 0.43746447563171387
Epoch: 3, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.803 Vali Acc: 0.193 Test Loss: 1.803 Test Acc: 0.193
Validation loss decreased (-0.185167 --> -0.192575).  Saving model ...
Epoch: 4 cost time: 0.5348970890045166
Epoch: 4, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.778 Vali Acc: 0.193 Test Loss: 1.778 Test Acc: 0.193
Validation loss decreased (-0.192575 --> -0.192575).  Saving model ...
Epoch: 5 cost time: 0.6420180797576904
Epoch: 5, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.748 Vali Acc: 0.193 Test Loss: 1.748 Test Acc: 0.193
Validation loss decreased (-0.192575 --> -0.192575).  Saving model ...
Epoch: 6 cost time: 0.547421932220459
Epoch: 6, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.715 Vali Acc: 0.196 Test Loss: 1.715 Test Acc: 0.196
Validation loss decreased (-0.192575 --> -0.196279).  Saving model ...
Epoch: 7 cost time: 0.6777129173278809
Epoch: 7, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.680 Vali Acc: 0.222 Test Loss: 1.680 Test Acc: 0.222
Validation loss decreased (-0.196279 --> -0.222205).  Saving model ...
Epoch: 8 cost time: 0.5469887256622314
Epoch: 8, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.646 Vali Acc: 0.248 Test Loss: 1.646 Test Acc: 0.248
Validation loss decreased (-0.222205 --> -0.248132).  Saving model ...
Epoch: 9 cost time: 0.5341682434082031
Epoch: 9, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.612 Vali Acc: 0.296 Test Loss: 1.612 Test Acc: 0.296
Validation loss decreased (-0.248132 --> -0.296280).  Saving model ...
Epoch: 10 cost time: 0.6207942962646484
Epoch: 10, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.581 Vali Acc: 0.359 Test Loss: 1.581 Test Acc: 0.359
Validation loss decreased (-0.296280 --> -0.359243).  Saving model ...
Epoch: 11 cost time: 0.6610171794891357
Epoch: 11, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.549 Vali Acc: 0.381 Test Loss: 1.549 Test Acc: 0.381
Validation loss decreased (-0.359243 --> -0.381466).  Saving model ...
Epoch: 12 cost time: 0.6278159618377686
Epoch: 12, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.519 Vali Acc: 0.459 Test Loss: 1.519 Test Acc: 0.459
Validation loss decreased (-0.381466 --> -0.459244).  Saving model ...
Epoch: 13 cost time: 0.6946537494659424
Epoch: 13, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.487 Vali Acc: 0.541 Test Loss: 1.487 Test Acc: 0.541
Validation loss decreased (-0.459244 --> -0.540726).  Saving model ...
Epoch: 14 cost time: 0.6956772804260254
Epoch: 14, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.456 Vali Acc: 0.574 Test Loss: 1.456 Test Acc: 0.574
Validation loss decreased (-0.540726 --> -0.574060).  Saving model ...
Epoch: 15 cost time: 0.7610187530517578
Epoch: 15, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.424 Vali Acc: 0.570 Test Loss: 1.424 Test Acc: 0.570
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5635335445404053
Epoch: 16, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.391 Vali Acc: 0.574 Test Loss: 1.391 Test Acc: 0.574
Validation loss decreased (-0.574060 --> -0.574060).  Saving model ...
Epoch: 17 cost time: 0.5642681121826172
Epoch: 17, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.357 Vali Acc: 0.589 Test Loss: 1.357 Test Acc: 0.589
Validation loss decreased (-0.574060 --> -0.588875).  Saving model ...
Epoch: 18 cost time: 0.8326883316040039
Epoch: 18, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.323 Vali Acc: 0.611 Test Loss: 1.323 Test Acc: 0.611
Validation loss decreased (-0.588875 --> -0.611098).  Saving model ...
Epoch: 19 cost time: 0.5953059196472168
Epoch: 19, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.289 Vali Acc: 0.644 Test Loss: 1.289 Test Acc: 0.644
Validation loss decreased (-0.611098 --> -0.644432).  Saving model ...
Epoch: 20 cost time: 0.6109683513641357
Epoch: 20, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.255 Vali Acc: 0.689 Test Loss: 1.255 Test Acc: 0.689
Validation loss decreased (-0.644432 --> -0.688876).  Saving model ...
Epoch: 21 cost time: 0.5982255935668945
Epoch: 21, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.219 Vali Acc: 0.722 Test Loss: 1.219 Test Acc: 0.722
Validation loss decreased (-0.688876 --> -0.722210).  Saving model ...
Epoch: 22 cost time: 0.8022911548614502
Epoch: 22, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.183 Vali Acc: 0.737 Test Loss: 1.183 Test Acc: 0.737
Validation loss decreased (-0.722210 --> -0.737025).  Saving model ...
Epoch: 23 cost time: 0.5927314758300781
Epoch: 23, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.146 Vali Acc: 0.763 Test Loss: 1.146 Test Acc: 0.763
Validation loss decreased (-0.737025 --> -0.762951).  Saving model ...
Epoch: 24 cost time: 0.6823258399963379
Epoch: 24, Steps: 2 | Train Loss: 1.056 Vali Loss: 1.109 Vali Acc: 0.781 Test Loss: 1.109 Test Acc: 0.781
Validation loss decreased (-0.762951 --> -0.781470).  Saving model ...
Epoch: 25 cost time: 0.6960325241088867
Epoch: 25, Steps: 2 | Train Loss: 1.059 Vali Loss: 1.070 Vali Acc: 0.807 Test Loss: 1.070 Test Acc: 0.807
Validation loss decreased (-0.781470 --> -0.807397).  Saving model ...
Epoch: 26 cost time: 0.6324260234832764
Epoch: 26, Steps: 2 | Train Loss: 0.983 Vali Loss: 1.033 Vali Acc: 0.830 Test Loss: 1.033 Test Acc: 0.830
Validation loss decreased (-0.807397 --> -0.829619).  Saving model ...
Epoch: 27 cost time: 0.5601637363433838
Epoch: 27, Steps: 2 | Train Loss: 0.928 Vali Loss: 0.996 Vali Acc: 0.844 Test Loss: 0.996 Test Acc: 0.844
Validation loss decreased (-0.829619 --> -0.844434).  Saving model ...
Epoch: 28 cost time: 0.5240275859832764
Epoch: 28, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.959 Vali Acc: 0.859 Test Loss: 0.959 Test Acc: 0.859
Validation loss decreased (-0.844434 --> -0.859250).  Saving model ...
Epoch: 29 cost time: 0.7164256572723389
Epoch: 29, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.922 Vali Acc: 0.856 Test Loss: 0.922 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6183047294616699
Epoch: 30, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.885 Vali Acc: 0.867 Test Loss: 0.885 Test Acc: 0.867
Validation loss decreased (-0.859250 --> -0.866658).  Saving model ...
Epoch: 31 cost time: 0.6007721424102783
Epoch: 31, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.851 Vali Acc: 0.874 Test Loss: 0.851 Test Acc: 0.874
Validation loss decreased (-0.866658 --> -0.874066).  Saving model ...
Epoch: 32 cost time: 0.6032764911651611
Epoch: 32, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.817 Vali Acc: 0.893 Test Loss: 0.817 Test Acc: 0.893
Validation loss decreased (-0.874066 --> -0.892584).  Saving model ...
Epoch: 33 cost time: 0.6898586750030518
Epoch: 33, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.784 Vali Acc: 0.907 Test Loss: 0.784 Test Acc: 0.907
Validation loss decreased (-0.892584 --> -0.907400).  Saving model ...
Epoch: 34 cost time: 0.8067624568939209
Epoch: 34, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.752 Vali Acc: 0.915 Test Loss: 0.752 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914807).  Saving model ...
Epoch: 35 cost time: 0.6803576946258545
Epoch: 35, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.721 Vali Acc: 0.915 Test Loss: 0.721 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 36 cost time: 0.7915091514587402
Epoch: 36, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.693 Vali Acc: 0.915 Test Loss: 0.693 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 37 cost time: 0.6325666904449463
Epoch: 37, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.666 Vali Acc: 0.907 Test Loss: 0.666 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6542482376098633
Epoch: 38, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.640 Vali Acc: 0.915 Test Loss: 0.640 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 39 cost time: 0.6855800151824951
Epoch: 39, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.615 Vali Acc: 0.915 Test Loss: 0.615 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914809).  Saving model ...
Epoch: 40 cost time: 0.4986398220062256
Epoch: 40, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.592 Vali Acc: 0.919 Test Loss: 0.592 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 41 cost time: 0.6150772571563721
Epoch: 41, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.570 Vali Acc: 0.919 Test Loss: 0.570 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 42 cost time: 0.5283641815185547
Epoch: 42, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.549 Vali Acc: 0.926 Test Loss: 0.549 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925920).  Saving model ...
Epoch: 43 cost time: 0.7492556571960449
Epoch: 43, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.529 Vali Acc: 0.926 Test Loss: 0.529 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 44 cost time: 0.6576094627380371
Epoch: 44, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.509 Vali Acc: 0.937 Test Loss: 0.509 Test Acc: 0.937
Validation loss decreased (-0.925921 --> -0.937032).  Saving model ...
Epoch: 45 cost time: 0.6093037128448486
Epoch: 45, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.490 Vali Acc: 0.941 Test Loss: 0.490 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 46 cost time: 0.6954975128173828
Epoch: 46, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.473 Vali Acc: 0.941 Test Loss: 0.473 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 47 cost time: 0.7390170097351074
Epoch: 47, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.456 Vali Acc: 0.941 Test Loss: 0.456 Test Acc: 0.941
Validation loss decreased (-0.940736 --> -0.940736).  Saving model ...
Epoch: 48 cost time: 0.7239696979522705
Epoch: 48, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.441 Vali Acc: 0.944 Test Loss: 0.441 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 49 cost time: 0.5183446407318115
Epoch: 49, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.427 Vali Acc: 0.944 Test Loss: 0.427 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 50 cost time: 0.6944088935852051
Epoch: 50, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.414 Vali Acc: 0.941 Test Loss: 0.414 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.9571876525878906
Epoch: 51, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.402 Vali Acc: 0.944 Test Loss: 0.402 Test Acc: 0.944
Validation loss decreased (-0.944440 --> -0.944440).  Saving model ...
Epoch: 52 cost time: 0.8451688289642334
Epoch: 52, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.390 Vali Acc: 0.948 Test Loss: 0.390 Test Acc: 0.948
Validation loss decreased (-0.944440 --> -0.948144).  Saving model ...
Epoch: 53 cost time: 0.5541386604309082
Epoch: 53, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.380 Vali Acc: 0.948 Test Loss: 0.380 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 54 cost time: 0.6715714931488037
Epoch: 54, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.371 Vali Acc: 0.948 Test Loss: 0.371 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948144).  Saving model ...
Epoch: 55 cost time: 0.6382601261138916
Epoch: 55, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.362 Vali Acc: 0.948 Test Loss: 0.362 Test Acc: 0.948
Validation loss decreased (-0.948144 --> -0.948145).  Saving model ...
Epoch: 56 cost time: 0.6210825443267822
Epoch: 56, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.355 Vali Acc: 0.944 Test Loss: 0.355 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6160941123962402
Epoch: 57, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.347 Vali Acc: 0.941 Test Loss: 0.347 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6385395526885986
Epoch: 58, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.339 Vali Acc: 0.941 Test Loss: 0.339 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.60727858543396
Epoch: 59, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5402591228485107
Epoch: 60, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.322 Vali Acc: 0.941 Test Loss: 0.322 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.6479594707489014
Epoch: 61, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.315 Vali Acc: 0.948 Test Loss: 0.315 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 62 cost time: 0.5762395858764648
Epoch: 62, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.308 Vali Acc: 0.948 Test Loss: 0.308 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 63 cost time: 0.6605467796325684
Epoch: 63, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.5989844799041748
Epoch: 64, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.295 Vali Acc: 0.948 Test Loss: 0.295 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 65 cost time: 0.5230262279510498
Epoch: 65, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.290 Vali Acc: 0.948 Test Loss: 0.290 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 66 cost time: 0.6373617649078369
Epoch: 66, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.286 Vali Acc: 0.948 Test Loss: 0.286 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 67 cost time: 0.5481858253479004
Epoch: 67, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.282 Vali Acc: 0.948 Test Loss: 0.282 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 68 cost time: 0.5488622188568115
Epoch: 68, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.278 Vali Acc: 0.948 Test Loss: 0.278 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 69 cost time: 0.79129958152771
Epoch: 69, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.6185750961303711
Epoch: 70, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6872067451477051
Epoch: 71, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.268 Vali Acc: 0.941 Test Loss: 0.268 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.6240329742431641
Epoch: 72, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.265 Vali Acc: 0.944 Test Loss: 0.265 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.6036052703857422
Epoch: 73, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.261 Vali Acc: 0.948 Test Loss: 0.261 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 74 cost time: 0.6989524364471436
Epoch: 74, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 75 cost time: 0.5714118480682373
Epoch: 75, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.255 Vali Acc: 0.952 Test Loss: 0.255 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951849).  Saving model ...
Epoch: 76 cost time: 0.5547738075256348
Epoch: 76, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.252 Vali Acc: 0.952 Test Loss: 0.252 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 77 cost time: 0.648435115814209
Epoch: 77, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.249 Vali Acc: 0.952 Test Loss: 0.249 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 78 cost time: 0.5818989276885986
Epoch: 78, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.245 Vali Acc: 0.952 Test Loss: 0.245 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 79 cost time: 0.4960355758666992
Epoch: 79, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.243 Vali Acc: 0.952 Test Loss: 0.243 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 80 cost time: 0.6885383129119873
Epoch: 80, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.240 Vali Acc: 0.952 Test Loss: 0.240 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 81 cost time: 0.5663027763366699
Epoch: 81, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.7215557098388672
Epoch: 82, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.235 Vali Acc: 0.948 Test Loss: 0.235 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.5394856929779053
Epoch: 83, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.6314244270324707
Epoch: 84, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.5502517223358154
Epoch: 85, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.5392611026763916
Epoch: 86, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.5440895557403564
Epoch: 87, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.5247492790222168
Epoch: 88, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.5506792068481445
Epoch: 89, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.5731446743011475
Epoch: 90, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 158942
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0339388847351074
Epoch: 1, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.817 Vali Acc: 0.096 Test Loss: 1.817 Test Acc: 0.096
Validation loss decreased (inf --> -0.096278).  Saving model ...
Epoch: 2 cost time: 0.5857255458831787
Epoch: 2, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.785 Vali Acc: 0.111 Test Loss: 1.785 Test Acc: 0.111
Validation loss decreased (-0.096278 --> -0.111093).  Saving model ...
Epoch: 3 cost time: 0.552098274230957
Epoch: 3, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.765 Vali Acc: 0.122 Test Loss: 1.765 Test Acc: 0.122
Validation loss decreased (-0.111093 --> -0.122205).  Saving model ...
Epoch: 4 cost time: 0.5875396728515625
Epoch: 4, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.746 Vali Acc: 0.137 Test Loss: 1.746 Test Acc: 0.137
Validation loss decreased (-0.122205 --> -0.137020).  Saving model ...
Epoch: 5 cost time: 0.6686677932739258
Epoch: 5, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.722 Vali Acc: 0.152 Test Loss: 1.722 Test Acc: 0.152
Validation loss decreased (-0.137020 --> -0.151835).  Saving model ...
Epoch: 6 cost time: 0.5129110813140869
Epoch: 6, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.697 Vali Acc: 0.185 Test Loss: 1.697 Test Acc: 0.185
Validation loss decreased (-0.151835 --> -0.185168).  Saving model ...
Epoch: 7 cost time: 0.5670788288116455
Epoch: 7, Steps: 2 | Train Loss: 1.684 Vali Loss: 1.670 Vali Acc: 0.244 Test Loss: 1.670 Test Acc: 0.244
Validation loss decreased (-0.185168 --> -0.244428).  Saving model ...
Epoch: 8 cost time: 0.5790517330169678
Epoch: 8, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.644 Vali Acc: 0.307 Test Loss: 1.644 Test Acc: 0.307
Validation loss decreased (-0.244428 --> -0.307391).  Saving model ...
Epoch: 9 cost time: 0.5235233306884766
Epoch: 9, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.617 Vali Acc: 0.344 Test Loss: 1.617 Test Acc: 0.344
Validation loss decreased (-0.307391 --> -0.344428).  Saving model ...
Epoch: 10 cost time: 0.531670331954956
Epoch: 10, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.592 Vali Acc: 0.356 Test Loss: 1.592 Test Acc: 0.356
Validation loss decreased (-0.344428 --> -0.355540).  Saving model ...
Epoch: 11 cost time: 0.5801103115081787
Epoch: 11, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.565 Vali Acc: 0.378 Test Loss: 1.565 Test Acc: 0.378
Validation loss decreased (-0.355540 --> -0.377762).  Saving model ...
Epoch: 12 cost time: 0.6720874309539795
Epoch: 12, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.538 Vali Acc: 0.437 Test Loss: 1.538 Test Acc: 0.437
Validation loss decreased (-0.377762 --> -0.437022).  Saving model ...
Epoch: 13 cost time: 0.6011154651641846
Epoch: 13, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.511 Vali Acc: 0.467 Test Loss: 1.511 Test Acc: 0.467
Validation loss decreased (-0.437022 --> -0.466652).  Saving model ...
Epoch: 14 cost time: 0.605079174041748
Epoch: 14, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.482 Vali Acc: 0.500 Test Loss: 1.482 Test Acc: 0.500
Validation loss decreased (-0.466652 --> -0.499985).  Saving model ...
Epoch: 15 cost time: 0.6524479389190674
Epoch: 15, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.453 Vali Acc: 0.537 Test Loss: 1.453 Test Acc: 0.537
Validation loss decreased (-0.499985 --> -0.537023).  Saving model ...
Epoch: 16 cost time: 0.5864353179931641
Epoch: 16, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.422 Vali Acc: 0.548 Test Loss: 1.422 Test Acc: 0.548
Validation loss decreased (-0.537023 --> -0.548134).  Saving model ...
Epoch: 17 cost time: 0.6240854263305664
Epoch: 17, Steps: 2 | Train Loss: 1.387 Vali Loss: 1.391 Vali Acc: 0.578 Test Loss: 1.391 Test Acc: 0.578
Validation loss decreased (-0.548134 --> -0.577764).  Saving model ...
Epoch: 18 cost time: 0.5613288879394531
Epoch: 18, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.357 Vali Acc: 0.593 Test Loss: 1.357 Test Acc: 0.593
Validation loss decreased (-0.577764 --> -0.592579).  Saving model ...
Epoch: 19 cost time: 0.5831122398376465
Epoch: 19, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.321 Vali Acc: 0.622 Test Loss: 1.321 Test Acc: 0.622
Validation loss decreased (-0.592579 --> -0.622209).  Saving model ...
Epoch: 20 cost time: 0.6929662227630615
Epoch: 20, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.286 Vali Acc: 0.637 Test Loss: 1.286 Test Acc: 0.637
Validation loss decreased (-0.622209 --> -0.637024).  Saving model ...
Epoch: 21 cost time: 0.5802764892578125
Epoch: 21, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.250 Vali Acc: 0.652 Test Loss: 1.250 Test Acc: 0.652
Validation loss decreased (-0.637024 --> -0.651839).  Saving model ...
Epoch: 22 cost time: 0.5837118625640869
Epoch: 22, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.214 Vali Acc: 0.689 Test Loss: 1.214 Test Acc: 0.689
Validation loss decreased (-0.651839 --> -0.688877).  Saving model ...
Epoch: 23 cost time: 0.6740360260009766
Epoch: 23, Steps: 2 | Train Loss: 1.115 Vali Loss: 1.178 Vali Acc: 0.715 Test Loss: 1.178 Test Acc: 0.715
Validation loss decreased (-0.688877 --> -0.714803).  Saving model ...
Epoch: 24 cost time: 0.6173279285430908
Epoch: 24, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.142 Vali Acc: 0.752 Test Loss: 1.142 Test Acc: 0.752
Validation loss decreased (-0.714803 --> -0.751840).  Saving model ...
Epoch: 25 cost time: 0.6436488628387451
Epoch: 25, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.105 Vali Acc: 0.759 Test Loss: 1.105 Test Acc: 0.759
Validation loss decreased (-0.751840 --> -0.759248).  Saving model ...
Epoch: 26 cost time: 0.5660991668701172
Epoch: 26, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.068 Vali Acc: 0.774 Test Loss: 1.068 Test Acc: 0.774
Validation loss decreased (-0.759248 --> -0.774063).  Saving model ...
Epoch: 27 cost time: 0.6008009910583496
Epoch: 27, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.031 Vali Acc: 0.804 Test Loss: 1.031 Test Acc: 0.804
Validation loss decreased (-0.774063 --> -0.803693).  Saving model ...
Epoch: 28 cost time: 0.5459496974945068
Epoch: 28, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.993 Vali Acc: 0.815 Test Loss: 0.993 Test Acc: 0.815
Validation loss decreased (-0.803693 --> -0.814805).  Saving model ...
Epoch: 29 cost time: 0.5325253009796143
Epoch: 29, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.957 Vali Acc: 0.830 Test Loss: 0.957 Test Acc: 0.830
Validation loss decreased (-0.814805 --> -0.829620).  Saving model ...
Epoch: 30 cost time: 0.6476407051086426
Epoch: 30, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.920 Vali Acc: 0.837 Test Loss: 0.920 Test Acc: 0.837
Validation loss decreased (-0.829620 --> -0.837028).  Saving model ...
Epoch: 31 cost time: 0.551316499710083
Epoch: 31, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.883 Vali Acc: 0.841 Test Loss: 0.883 Test Acc: 0.841
Validation loss decreased (-0.837028 --> -0.840732).  Saving model ...
Epoch: 32 cost time: 0.6007845401763916
Epoch: 32, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.848 Vali Acc: 0.863 Test Loss: 0.848 Test Acc: 0.863
Validation loss decreased (-0.840732 --> -0.862954).  Saving model ...
Epoch: 33 cost time: 0.5447208881378174
Epoch: 33, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.813 Vali Acc: 0.881 Test Loss: 0.813 Test Acc: 0.881
Validation loss decreased (-0.862954 --> -0.881473).  Saving model ...
Epoch: 34 cost time: 0.6655728816986084
Epoch: 34, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.781 Vali Acc: 0.881 Test Loss: 0.781 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881474).  Saving model ...
Epoch: 35 cost time: 0.5987198352813721
Epoch: 35, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.749 Vali Acc: 0.885 Test Loss: 0.749 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 36 cost time: 0.5605494976043701
Epoch: 36, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.718 Vali Acc: 0.900 Test Loss: 0.718 Test Acc: 0.900
Validation loss decreased (-0.885178 --> -0.899993).  Saving model ...
Epoch: 37 cost time: 0.6188051700592041
Epoch: 37, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.688 Vali Acc: 0.915 Test Loss: 0.688 Test Acc: 0.915
Validation loss decreased (-0.899993 --> -0.914808).  Saving model ...
Epoch: 38 cost time: 0.6014692783355713
Epoch: 38, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.660 Vali Acc: 0.915 Test Loss: 0.660 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 39 cost time: 0.4956977367401123
Epoch: 39, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.633 Vali Acc: 0.915 Test Loss: 0.633 Test Acc: 0.915
Validation loss decreased (-0.914808 --> -0.914808).  Saving model ...
Epoch: 40 cost time: 0.5275311470031738
Epoch: 40, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.607 Vali Acc: 0.919 Test Loss: 0.607 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 41 cost time: 0.5595667362213135
Epoch: 41, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.583 Vali Acc: 0.915 Test Loss: 0.583 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.65625
Epoch: 42, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.560 Vali Acc: 0.915 Test Loss: 0.560 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6575572490692139
Epoch: 43, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.538 Vali Acc: 0.919 Test Loss: 0.538 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 44 cost time: 0.6252946853637695
Epoch: 44, Steps: 2 | Train Loss: 0.402 Vali Loss: 0.518 Vali Acc: 0.919 Test Loss: 0.518 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 45 cost time: 0.6867349147796631
Epoch: 45, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.499 Vali Acc: 0.922 Test Loss: 0.499 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 46 cost time: 0.6640629768371582
Epoch: 46, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.481 Vali Acc: 0.922 Test Loss: 0.481 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 47 cost time: 0.6735293865203857
Epoch: 47, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.464 Vali Acc: 0.922 Test Loss: 0.464 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 48 cost time: 0.5848541259765625
Epoch: 48, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.447 Vali Acc: 0.926 Test Loss: 0.447 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925921).  Saving model ...
Epoch: 49 cost time: 0.547236442565918
Epoch: 49, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.432 Vali Acc: 0.926 Test Loss: 0.432 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 50 cost time: 0.6839747428894043
Epoch: 50, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.418 Vali Acc: 0.922 Test Loss: 0.418 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6941676139831543
Epoch: 51, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.406 Vali Acc: 0.922 Test Loss: 0.406 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5555791854858398
Epoch: 52, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.394 Vali Acc: 0.926 Test Loss: 0.394 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 53 cost time: 0.5168445110321045
Epoch: 53, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.383 Vali Acc: 0.926 Test Loss: 0.383 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 54 cost time: 0.6909072399139404
Epoch: 54, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.373 Vali Acc: 0.926 Test Loss: 0.373 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 55 cost time: 0.6225252151489258
Epoch: 55, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.363 Vali Acc: 0.933 Test Loss: 0.363 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 56 cost time: 0.5443723201751709
Epoch: 56, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.354 Vali Acc: 0.933 Test Loss: 0.354 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 57 cost time: 0.6264309883117676
Epoch: 57, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.345 Vali Acc: 0.941 Test Loss: 0.345 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940737).  Saving model ...
Epoch: 58 cost time: 0.46146249771118164
Epoch: 58, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.337 Vali Acc: 0.941 Test Loss: 0.337 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 59 cost time: 0.5418741703033447
Epoch: 59, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.329 Vali Acc: 0.944 Test Loss: 0.329 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 60 cost time: 0.5271575450897217
Epoch: 60, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.323 Vali Acc: 0.944 Test Loss: 0.323 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 61 cost time: 0.6372244358062744
Epoch: 61, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.318 Vali Acc: 0.937 Test Loss: 0.318 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.7158880233764648
Epoch: 62, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.7211611270904541
Epoch: 63, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.307 Vali Acc: 0.941 Test Loss: 0.307 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.5473377704620361
Epoch: 64, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.302 Vali Acc: 0.941 Test Loss: 0.302 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.5137972831726074
Epoch: 65, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.298 Vali Acc: 0.941 Test Loss: 0.298 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.6471474170684814
Epoch: 66, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.7036573886871338
Epoch: 67, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 0.5645847320556641
Epoch: 68, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.285 Vali Acc: 0.948 Test Loss: 0.285 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 69 cost time: 0.6723577976226807
Epoch: 69, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.8441476821899414
Epoch: 70, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.6961700916290283
Epoch: 71, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.6017115116119385
Epoch: 72, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.270 Vali Acc: 0.944 Test Loss: 0.270 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.6748611927032471
Epoch: 73, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.5076971054077148
Epoch: 74, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.5744550228118896
Epoch: 75, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.260 Vali Acc: 0.944 Test Loss: 0.260 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.5411598682403564
Epoch: 76, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 77 cost time: 0.5095627307891846
Epoch: 77, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.256 Vali Acc: 0.948 Test Loss: 0.256 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 78 cost time: 0.6110155582427979
Epoch: 78, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 79 cost time: 0.589461088180542
Epoch: 79, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.251 Vali Acc: 0.948 Test Loss: 0.251 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 80 cost time: 0.6118338108062744
Epoch: 80, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.249 Vali Acc: 0.948 Test Loss: 0.249 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 81 cost time: 0.7428336143493652
Epoch: 81, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.5239813327789307
Epoch: 82, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.6442129611968994
Epoch: 83, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.7427248954772949
Epoch: 84, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.5193922519683838
Epoch: 85, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.6115257740020752
Epoch: 86, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.6954362392425537
Epoch: 87, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.237 Vali Acc: 0.944 Test Loss: 0.237 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.6933753490447998
Epoch: 88, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.236 Vali Acc: 0.948 Test Loss: 0.236 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 89 cost time: 0.6397936344146729
Epoch: 89, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.6584494113922119
Epoch: 90, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.6957910060882568
Epoch: 91, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.6327950954437256
Epoch: 92, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.5863871574401855
Epoch: 93, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 0.5792467594146729
Epoch: 94, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 0.5495903491973877
Epoch: 95, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 96 cost time: 0.5334687232971191
Epoch: 96, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 97 cost time: 0.6598250865936279
Epoch: 97, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 98 cost time: 0.5699663162231445
Epoch: 98, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 158750
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9298038482666016
Epoch: 1, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.743 Vali Acc: 0.296 Test Loss: 1.743 Test Acc: 0.296
Validation loss decreased (inf --> -0.296279).  Saving model ...
Epoch: 2 cost time: 0.6234619617462158
Epoch: 2, Steps: 2 | Train Loss: 1.775 Vali Loss: 1.717 Vali Acc: 0.307 Test Loss: 1.717 Test Acc: 0.307
Validation loss decreased (-0.296279 --> -0.307390).  Saving model ...
Epoch: 3 cost time: 0.5676071643829346
Epoch: 3, Steps: 2 | Train Loss: 1.633 Vali Loss: 1.700 Vali Acc: 0.319 Test Loss: 1.700 Test Acc: 0.319
Validation loss decreased (-0.307390 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.5773420333862305
Epoch: 4, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.684 Vali Acc: 0.315 Test Loss: 1.684 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.5662174224853516
Epoch: 5, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.664 Vali Acc: 0.326 Test Loss: 1.664 Test Acc: 0.326
Validation loss decreased (-0.318502 --> -0.325909).  Saving model ...
Epoch: 6 cost time: 0.7139759063720703
Epoch: 6, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.643 Vali Acc: 0.333 Test Loss: 1.643 Test Acc: 0.333
Validation loss decreased (-0.325909 --> -0.333317).  Saving model ...
Epoch: 7 cost time: 0.5370714664459229
Epoch: 7, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.620 Vali Acc: 0.385 Test Loss: 1.620 Test Acc: 0.385
Validation loss decreased (-0.333317 --> -0.385169).  Saving model ...
Epoch: 8 cost time: 0.4960510730743408
Epoch: 8, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.597 Vali Acc: 0.426 Test Loss: 1.597 Test Acc: 0.426
Validation loss decreased (-0.385169 --> -0.425910).  Saving model ...
Epoch: 9 cost time: 0.6816914081573486
Epoch: 9, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.575 Vali Acc: 0.463 Test Loss: 1.575 Test Acc: 0.463
Validation loss decreased (-0.425910 --> -0.462947).  Saving model ...
Epoch: 10 cost time: 0.6184186935424805
Epoch: 10, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.552 Vali Acc: 0.489 Test Loss: 1.552 Test Acc: 0.489
Validation loss decreased (-0.462947 --> -0.488873).  Saving model ...
Epoch: 11 cost time: 0.7085318565368652
Epoch: 11, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.529 Vali Acc: 0.541 Test Loss: 1.529 Test Acc: 0.541
Validation loss decreased (-0.488873 --> -0.540725).  Saving model ...
Epoch: 12 cost time: 0.5733492374420166
Epoch: 12, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.506 Vali Acc: 0.556 Test Loss: 1.506 Test Acc: 0.556
Validation loss decreased (-0.540725 --> -0.555540).  Saving model ...
Epoch: 13 cost time: 0.5768024921417236
Epoch: 13, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.482 Vali Acc: 0.581 Test Loss: 1.482 Test Acc: 0.581
Validation loss decreased (-0.555540 --> -0.581467).  Saving model ...
Epoch: 14 cost time: 0.5377118587493896
Epoch: 14, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.457 Vali Acc: 0.607 Test Loss: 1.457 Test Acc: 0.607
Validation loss decreased (-0.581467 --> -0.607393).  Saving model ...
Epoch: 15 cost time: 0.49243783950805664
Epoch: 15, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.431 Vali Acc: 0.644 Test Loss: 1.431 Test Acc: 0.644
Validation loss decreased (-0.607393 --> -0.644430).  Saving model ...
Epoch: 16 cost time: 0.6220333576202393
Epoch: 16, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.403 Vali Acc: 0.652 Test Loss: 1.403 Test Acc: 0.652
Validation loss decreased (-0.644430 --> -0.651838).  Saving model ...
Epoch: 17 cost time: 0.514533281326294
Epoch: 17, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.374 Vali Acc: 0.670 Test Loss: 1.374 Test Acc: 0.670
Validation loss decreased (-0.651838 --> -0.670357).  Saving model ...
Epoch: 18 cost time: 0.49181175231933594
Epoch: 18, Steps: 2 | Train Loss: 1.267 Vali Loss: 1.345 Vali Acc: 0.693 Test Loss: 1.345 Test Acc: 0.693
Validation loss decreased (-0.670357 --> -0.692579).  Saving model ...
Epoch: 19 cost time: 0.47856974601745605
Epoch: 19, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.315 Vali Acc: 0.711 Test Loss: 1.315 Test Acc: 0.711
Validation loss decreased (-0.692579 --> -0.711098).  Saving model ...
Epoch: 20 cost time: 0.4596419334411621
Epoch: 20, Steps: 2 | Train Loss: 1.230 Vali Loss: 1.285 Vali Acc: 0.737 Test Loss: 1.285 Test Acc: 0.737
Validation loss decreased (-0.711098 --> -0.737024).  Saving model ...
Epoch: 21 cost time: 0.5255658626556396
Epoch: 21, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.253 Vali Acc: 0.763 Test Loss: 1.253 Test Acc: 0.763
Validation loss decreased (-0.737024 --> -0.762950).  Saving model ...
Epoch: 22 cost time: 0.5452322959899902
Epoch: 22, Steps: 2 | Train Loss: 1.142 Vali Loss: 1.222 Vali Acc: 0.781 Test Loss: 1.222 Test Acc: 0.781
Validation loss decreased (-0.762950 --> -0.781469).  Saving model ...
Epoch: 23 cost time: 0.5222172737121582
Epoch: 23, Steps: 2 | Train Loss: 1.136 Vali Loss: 1.191 Vali Acc: 0.793 Test Loss: 1.191 Test Acc: 0.793
Validation loss decreased (-0.781469 --> -0.792581).  Saving model ...
Epoch: 24 cost time: 0.5896334648132324
Epoch: 24, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.159 Vali Acc: 0.796 Test Loss: 1.159 Test Acc: 0.796
Validation loss decreased (-0.792581 --> -0.796285).  Saving model ...
Epoch: 25 cost time: 0.45020604133605957
Epoch: 25, Steps: 2 | Train Loss: 1.072 Vali Loss: 1.125 Vali Acc: 0.804 Test Loss: 1.125 Test Acc: 0.804
Validation loss decreased (-0.796285 --> -0.803692).  Saving model ...
Epoch: 26 cost time: 0.4981682300567627
Epoch: 26, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.092 Vali Acc: 0.804 Test Loss: 1.092 Test Acc: 0.804
Validation loss decreased (-0.803692 --> -0.803693).  Saving model ...
Epoch: 27 cost time: 0.5020170211791992
Epoch: 27, Steps: 2 | Train Loss: 0.959 Vali Loss: 1.058 Vali Acc: 0.826 Test Loss: 1.058 Test Acc: 0.826
Validation loss decreased (-0.803693 --> -0.825915).  Saving model ...
Epoch: 28 cost time: 0.5259625911712646
Epoch: 28, Steps: 2 | Train Loss: 0.913 Vali Loss: 1.023 Vali Acc: 0.852 Test Loss: 1.023 Test Acc: 0.852
Validation loss decreased (-0.825915 --> -0.851842).  Saving model ...
Epoch: 29 cost time: 0.5620608329772949
Epoch: 29, Steps: 2 | Train Loss: 0.904 Vali Loss: 0.987 Vali Acc: 0.863 Test Loss: 0.987 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862953).  Saving model ...
Epoch: 30 cost time: 0.5615382194519043
Epoch: 30, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.952 Vali Acc: 0.859 Test Loss: 0.952 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7996160984039307
Epoch: 31, Steps: 2 | Train Loss: 0.791 Vali Loss: 0.918 Vali Acc: 0.863 Test Loss: 0.918 Test Acc: 0.863
Validation loss decreased (-0.862953 --> -0.862954).  Saving model ...
Epoch: 32 cost time: 0.7590129375457764
Epoch: 32, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.885 Vali Acc: 0.881 Test Loss: 0.885 Test Acc: 0.881
Validation loss decreased (-0.862954 --> -0.881473).  Saving model ...
Epoch: 33 cost time: 0.5948765277862549
Epoch: 33, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.852 Vali Acc: 0.893 Test Loss: 0.852 Test Acc: 0.893
Validation loss decreased (-0.881473 --> -0.892584).  Saving model ...
Epoch: 34 cost time: 0.6764726638793945
Epoch: 34, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.820 Vali Acc: 0.896 Test Loss: 0.820 Test Acc: 0.896
Validation loss decreased (-0.892584 --> -0.896288).  Saving model ...
Epoch: 35 cost time: 0.5276384353637695
Epoch: 35, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.789 Vali Acc: 0.896 Test Loss: 0.789 Test Acc: 0.896
Validation loss decreased (-0.896288 --> -0.896288).  Saving model ...
Epoch: 36 cost time: 0.6806211471557617
Epoch: 36, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.758 Vali Acc: 0.907 Test Loss: 0.758 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907400).  Saving model ...
Epoch: 37 cost time: 0.5351510047912598
Epoch: 37, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.728 Vali Acc: 0.907 Test Loss: 0.728 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907400).  Saving model ...
Epoch: 38 cost time: 0.5542693138122559
Epoch: 38, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.700 Vali Acc: 0.900 Test Loss: 0.700 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5625324249267578
Epoch: 39, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.673 Vali Acc: 0.907 Test Loss: 0.673 Test Acc: 0.907
Validation loss decreased (-0.907400 --> -0.907401).  Saving model ...
Epoch: 40 cost time: 0.6055569648742676
Epoch: 40, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.647 Vali Acc: 0.915 Test Loss: 0.647 Test Acc: 0.915
Validation loss decreased (-0.907401 --> -0.914808).  Saving model ...
Epoch: 41 cost time: 0.5469005107879639
Epoch: 41, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.623 Vali Acc: 0.919 Test Loss: 0.623 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 42 cost time: 0.6147434711456299
Epoch: 42, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.600 Vali Acc: 0.922 Test Loss: 0.600 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 43 cost time: 0.49666428565979004
Epoch: 43, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.578 Vali Acc: 0.930 Test Loss: 0.578 Test Acc: 0.930
Validation loss decreased (-0.922216 --> -0.929624).  Saving model ...
Epoch: 44 cost time: 0.5555169582366943
Epoch: 44, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.558 Vali Acc: 0.930 Test Loss: 0.558 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 45 cost time: 0.5694570541381836
Epoch: 45, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.538 Vali Acc: 0.926 Test Loss: 0.538 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6273210048675537
Epoch: 46, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.520 Vali Acc: 0.926 Test Loss: 0.520 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.6091568470001221
Epoch: 47, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.502 Vali Acc: 0.926 Test Loss: 0.502 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5310482978820801
Epoch: 48, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.486 Vali Acc: 0.926 Test Loss: 0.486 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6799535751342773
Epoch: 49, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.471 Vali Acc: 0.930 Test Loss: 0.471 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 50 cost time: 0.5824949741363525
Epoch: 50, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.457 Vali Acc: 0.930 Test Loss: 0.457 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 51 cost time: 0.63653564453125
Epoch: 51, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.444 Vali Acc: 0.930 Test Loss: 0.444 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 52 cost time: 0.5606334209442139
Epoch: 52, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.431 Vali Acc: 0.922 Test Loss: 0.431 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5199966430664062
Epoch: 53, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.420 Vali Acc: 0.922 Test Loss: 0.420 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5690054893493652
Epoch: 54, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.409 Vali Acc: 0.922 Test Loss: 0.409 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5626628398895264
Epoch: 55, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.398 Vali Acc: 0.922 Test Loss: 0.398 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.5869462490081787
Epoch: 56, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.388 Vali Acc: 0.922 Test Loss: 0.388 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.5497877597808838
Epoch: 57, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.379 Vali Acc: 0.926 Test Loss: 0.379 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.6242532730102539
Epoch: 58, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.371 Vali Acc: 0.930 Test Loss: 0.371 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 59 cost time: 0.5931715965270996
Epoch: 59, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.363 Vali Acc: 0.926 Test Loss: 0.363 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.6020641326904297
Epoch: 60, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.355 Vali Acc: 0.926 Test Loss: 0.355 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7103097438812256
Epoch: 61, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.348 Vali Acc: 0.930 Test Loss: 0.348 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 62 cost time: 0.5328679084777832
Epoch: 62, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.341 Vali Acc: 0.930 Test Loss: 0.341 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 63 cost time: 0.553957462310791
Epoch: 63, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.334 Vali Acc: 0.930 Test Loss: 0.334 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 64 cost time: 0.530573844909668
Epoch: 64, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.327 Vali Acc: 0.930 Test Loss: 0.327 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 65 cost time: 0.4919297695159912
Epoch: 65, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.322 Vali Acc: 0.930 Test Loss: 0.322 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 66 cost time: 0.6139185428619385
Epoch: 66, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.317 Vali Acc: 0.930 Test Loss: 0.317 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 67 cost time: 0.5968754291534424
Epoch: 67, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.312 Vali Acc: 0.930 Test Loss: 0.312 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 68 cost time: 0.545813798904419
Epoch: 68, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 69 cost time: 0.6557621955871582
Epoch: 69, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.304 Vali Acc: 0.930 Test Loss: 0.304 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 70 cost time: 0.6695795059204102
Epoch: 70, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.301 Vali Acc: 0.930 Test Loss: 0.301 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 71 cost time: 0.6265771389007568
Epoch: 71, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.297 Vali Acc: 0.930 Test Loss: 0.297 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 72 cost time: 0.5486834049224854
Epoch: 72, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 73 cost time: 0.5704972743988037
Epoch: 73, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.289 Vali Acc: 0.930 Test Loss: 0.289 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 74 cost time: 0.5869407653808594
Epoch: 74, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.284 Vali Acc: 0.930 Test Loss: 0.284 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 75 cost time: 0.572688102722168
Epoch: 75, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.281 Vali Acc: 0.930 Test Loss: 0.281 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 76 cost time: 0.636263370513916
Epoch: 76, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.277 Vali Acc: 0.930 Test Loss: 0.277 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 77 cost time: 0.5403845310211182
Epoch: 77, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 78 cost time: 0.5015568733215332
Epoch: 78, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.270 Vali Acc: 0.930 Test Loss: 0.270 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 79 cost time: 0.609367847442627
Epoch: 79, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 80 cost time: 0.6409580707550049
Epoch: 80, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 81 cost time: 0.48297572135925293
Epoch: 81, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.262 Vali Acc: 0.930 Test Loss: 0.262 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 82 cost time: 0.5737810134887695
Epoch: 82, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 83 cost time: 0.6584253311157227
Epoch: 83, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 84 cost time: 0.6436910629272461
Epoch: 84, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 85 cost time: 0.674816370010376
Epoch: 85, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 86 cost time: 0.6146469116210938
Epoch: 86, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 87 cost time: 0.561983585357666
Epoch: 87, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 88 cost time: 0.6140773296356201
Epoch: 88, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 89 cost time: 0.7111856937408447
Epoch: 89, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 90 cost time: 0.5602321624755859
Epoch: 90, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 91 cost time: 0.5908751487731934
Epoch: 91, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 92 cost time: 0.5963430404663086
Epoch: 92, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 93 cost time: 0.6069498062133789
Epoch: 93, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 94 cost time: 0.6509344577789307
Epoch: 94, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 95 cost time: 0.5083844661712646
Epoch: 95, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 96 cost time: 0.5535135269165039
Epoch: 96, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 97 cost time: 0.6204986572265625
Epoch: 97, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 98 cost time: 0.6557981967926025
Epoch: 98, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 99 cost time: 0.6889448165893555
Epoch: 99, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 100 cost time: 0.6195921897888184
Epoch: 100, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 158558
model size : 1.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.285181999206543
Epoch: 1, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.832 Vali Acc: 0.215 Test Loss: 1.832 Test Acc: 0.215
Validation loss decreased (inf --> -0.214796).  Saving model ...
Epoch: 2 cost time: 0.5431416034698486
Epoch: 2, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.809 Vali Acc: 0.300 Test Loss: 1.809 Test Acc: 0.300
Validation loss decreased (-0.214796 --> -0.299982).  Saving model ...
Epoch: 3 cost time: 0.49932122230529785
Epoch: 3, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.792 Vali Acc: 0.326 Test Loss: 1.792 Test Acc: 0.326
Validation loss decreased (-0.299982 --> -0.325908).  Saving model ...
Epoch: 4 cost time: 0.4657480716705322
Epoch: 4, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.779 Vali Acc: 0.352 Test Loss: 1.779 Test Acc: 0.352
Validation loss decreased (-0.325908 --> -0.351834).  Saving model ...
Epoch: 5 cost time: 0.5939252376556396
Epoch: 5, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.762 Vali Acc: 0.367 Test Loss: 1.762 Test Acc: 0.367
Validation loss decreased (-0.351834 --> -0.366649).  Saving model ...
Epoch: 6 cost time: 0.5845522880554199
Epoch: 6, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.743 Vali Acc: 0.374 Test Loss: 1.743 Test Acc: 0.374
Validation loss decreased (-0.366649 --> -0.374057).  Saving model ...
Epoch: 7 cost time: 0.5226535797119141
Epoch: 7, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.722 Vali Acc: 0.400 Test Loss: 1.722 Test Acc: 0.400
Validation loss decreased (-0.374057 --> -0.399983).  Saving model ...
Epoch: 8 cost time: 0.7068221569061279
Epoch: 8, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.700 Vali Acc: 0.422 Test Loss: 1.700 Test Acc: 0.422
Validation loss decreased (-0.399983 --> -0.422205).  Saving model ...
Epoch: 9 cost time: 0.5840044021606445
Epoch: 9, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.676 Vali Acc: 0.448 Test Loss: 1.676 Test Acc: 0.448
Validation loss decreased (-0.422205 --> -0.448131).  Saving model ...
Epoch: 10 cost time: 0.5294263362884521
Epoch: 10, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.652 Vali Acc: 0.467 Test Loss: 1.652 Test Acc: 0.467
Validation loss decreased (-0.448131 --> -0.466650).  Saving model ...
Epoch: 11 cost time: 0.5965070724487305
Epoch: 11, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.628 Vali Acc: 0.485 Test Loss: 1.628 Test Acc: 0.485
Validation loss decreased (-0.466650 --> -0.485169).  Saving model ...
Epoch: 12 cost time: 0.6399576663970947
Epoch: 12, Steps: 2 | Train Loss: 1.544 Vali Loss: 1.606 Vali Acc: 0.507 Test Loss: 1.606 Test Acc: 0.507
Validation loss decreased (-0.485169 --> -0.507391).  Saving model ...
Epoch: 13 cost time: 0.555220365524292
Epoch: 13, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.583 Vali Acc: 0.552 Test Loss: 1.583 Test Acc: 0.552
Validation loss decreased (-0.507391 --> -0.551836).  Saving model ...
Epoch: 14 cost time: 0.6366634368896484
Epoch: 14, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.560 Vali Acc: 0.581 Test Loss: 1.560 Test Acc: 0.581
Validation loss decreased (-0.551836 --> -0.581466).  Saving model ...
Epoch: 15 cost time: 0.6361806392669678
Epoch: 15, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.537 Vali Acc: 0.604 Test Loss: 1.537 Test Acc: 0.604
Validation loss decreased (-0.581466 --> -0.603688).  Saving model ...
Epoch: 16 cost time: 0.7075526714324951
Epoch: 16, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.514 Vali Acc: 0.622 Test Loss: 1.514 Test Acc: 0.622
Validation loss decreased (-0.603688 --> -0.622207).  Saving model ...
Epoch: 17 cost time: 0.7977523803710938
Epoch: 17, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.489 Vali Acc: 0.656 Test Loss: 1.489 Test Acc: 0.656
Validation loss decreased (-0.622207 --> -0.655541).  Saving model ...
Epoch: 18 cost time: 0.7909762859344482
Epoch: 18, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.464 Vali Acc: 0.674 Test Loss: 1.464 Test Acc: 0.674
Validation loss decreased (-0.655541 --> -0.674059).  Saving model ...
Epoch: 19 cost time: 0.636925220489502
Epoch: 19, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.437 Vali Acc: 0.674 Test Loss: 1.437 Test Acc: 0.674
Validation loss decreased (-0.674059 --> -0.674060).  Saving model ...
Epoch: 20 cost time: 0.58272385597229
Epoch: 20, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.411 Vali Acc: 0.689 Test Loss: 1.411 Test Acc: 0.689
Validation loss decreased (-0.674060 --> -0.688875).  Saving model ...
Epoch: 21 cost time: 0.5213344097137451
Epoch: 21, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.383 Vali Acc: 0.700 Test Loss: 1.383 Test Acc: 0.700
Validation loss decreased (-0.688875 --> -0.699986).  Saving model ...
Epoch: 22 cost time: 0.5210120677947998
Epoch: 22, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.354 Vali Acc: 0.719 Test Loss: 1.354 Test Acc: 0.719
Validation loss decreased (-0.699986 --> -0.718505).  Saving model ...
Epoch: 23 cost time: 0.6409454345703125
Epoch: 23, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.325 Vali Acc: 0.733 Test Loss: 1.325 Test Acc: 0.733
Validation loss decreased (-0.718505 --> -0.733320).  Saving model ...
Epoch: 24 cost time: 0.6369161605834961
Epoch: 24, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.295 Vali Acc: 0.748 Test Loss: 1.295 Test Acc: 0.748
Validation loss decreased (-0.733320 --> -0.748135).  Saving model ...
Epoch: 25 cost time: 0.5967319011688232
Epoch: 25, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.263 Vali Acc: 0.774 Test Loss: 1.263 Test Acc: 0.774
Validation loss decreased (-0.748135 --> -0.774061).  Saving model ...
Epoch: 26 cost time: 0.5951118469238281
Epoch: 26, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.232 Vali Acc: 0.778 Test Loss: 1.232 Test Acc: 0.778
Validation loss decreased (-0.774061 --> -0.777765).  Saving model ...
Epoch: 27 cost time: 0.5365805625915527
Epoch: 27, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.200 Vali Acc: 0.785 Test Loss: 1.200 Test Acc: 0.785
Validation loss decreased (-0.777765 --> -0.785173).  Saving model ...
Epoch: 28 cost time: 0.6841022968292236
Epoch: 28, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.168 Vali Acc: 0.796 Test Loss: 1.168 Test Acc: 0.796
Validation loss decreased (-0.785173 --> -0.796285).  Saving model ...
Epoch: 29 cost time: 0.5523195266723633
Epoch: 29, Steps: 2 | Train Loss: 1.042 Vali Loss: 1.135 Vali Acc: 0.800 Test Loss: 1.135 Test Acc: 0.800
Validation loss decreased (-0.796285 --> -0.799989).  Saving model ...
Epoch: 30 cost time: 0.5330727100372314
Epoch: 30, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.102 Vali Acc: 0.800 Test Loss: 1.102 Test Acc: 0.800
Validation loss decreased (-0.799989 --> -0.799989).  Saving model ...
Epoch: 31 cost time: 0.5088810920715332
Epoch: 31, Steps: 2 | Train Loss: 0.933 Vali Loss: 1.068 Vali Acc: 0.804 Test Loss: 1.068 Test Acc: 0.804
Validation loss decreased (-0.799989 --> -0.803693).  Saving model ...
Epoch: 32 cost time: 0.584148645401001
Epoch: 32, Steps: 2 | Train Loss: 0.891 Vali Loss: 1.034 Vali Acc: 0.811 Test Loss: 1.034 Test Acc: 0.811
Validation loss decreased (-0.803693 --> -0.811101).  Saving model ...
Epoch: 33 cost time: 0.5155324935913086
Epoch: 33, Steps: 2 | Train Loss: 0.886 Vali Loss: 1.000 Vali Acc: 0.811 Test Loss: 1.000 Test Acc: 0.811
Validation loss decreased (-0.811101 --> -0.811101).  Saving model ...
Epoch: 34 cost time: 0.6300394535064697
Epoch: 34, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.965 Vali Acc: 0.819 Test Loss: 0.965 Test Acc: 0.819
Validation loss decreased (-0.811101 --> -0.818509).  Saving model ...
Epoch: 35 cost time: 0.6704235076904297
Epoch: 35, Steps: 2 | Train Loss: 0.806 Vali Loss: 0.932 Vali Acc: 0.837 Test Loss: 0.932 Test Acc: 0.837
Validation loss decreased (-0.818509 --> -0.837028).  Saving model ...
Epoch: 36 cost time: 0.571357011795044
Epoch: 36, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.901 Vali Acc: 0.830 Test Loss: 0.901 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5212557315826416
Epoch: 37, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.870 Vali Acc: 0.859 Test Loss: 0.870 Test Acc: 0.859
Validation loss decreased (-0.837028 --> -0.859251).  Saving model ...
Epoch: 38 cost time: 0.5366849899291992
Epoch: 38, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.839 Vali Acc: 0.856 Test Loss: 0.839 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5640206336975098
Epoch: 39, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.809 Vali Acc: 0.874 Test Loss: 0.809 Test Acc: 0.874
Validation loss decreased (-0.859251 --> -0.874066).  Saving model ...
Epoch: 40 cost time: 0.554307222366333
Epoch: 40, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.779 Vali Acc: 0.874 Test Loss: 0.779 Test Acc: 0.874
Validation loss decreased (-0.874066 --> -0.874066).  Saving model ...
Epoch: 41 cost time: 0.46138954162597656
Epoch: 41, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.751 Vali Acc: 0.878 Test Loss: 0.751 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877770).  Saving model ...
Epoch: 42 cost time: 0.5250661373138428
Epoch: 42, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.723 Vali Acc: 0.878 Test Loss: 0.723 Test Acc: 0.878
Validation loss decreased (-0.877770 --> -0.877771).  Saving model ...
Epoch: 43 cost time: 0.61012864112854
Epoch: 43, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.696 Vali Acc: 0.889 Test Loss: 0.696 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888882).  Saving model ...
Epoch: 44 cost time: 0.6986949443817139
Epoch: 44, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.670 Vali Acc: 0.900 Test Loss: 0.670 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899993).  Saving model ...
Epoch: 45 cost time: 0.4798102378845215
Epoch: 45, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.645 Vali Acc: 0.900 Test Loss: 0.645 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899994).  Saving model ...
Epoch: 46 cost time: 0.49167418479919434
Epoch: 46, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.621 Vali Acc: 0.900 Test Loss: 0.621 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 47 cost time: 0.5060214996337891
Epoch: 47, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.599 Vali Acc: 0.904 Test Loss: 0.599 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 48 cost time: 0.4761533737182617
Epoch: 48, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.577 Vali Acc: 0.907 Test Loss: 0.577 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 49 cost time: 0.4806802272796631
Epoch: 49, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.557 Vali Acc: 0.907 Test Loss: 0.557 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 50 cost time: 0.48917388916015625
Epoch: 50, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.537 Vali Acc: 0.907 Test Loss: 0.537 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 51 cost time: 0.7601413726806641
Epoch: 51, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.519 Vali Acc: 0.911 Test Loss: 0.519 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 52 cost time: 0.5767271518707275
Epoch: 52, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.502 Vali Acc: 0.915 Test Loss: 0.502 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 53 cost time: 0.5076789855957031
Epoch: 53, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.486 Vali Acc: 0.922 Test Loss: 0.486 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922217).  Saving model ...
Epoch: 54 cost time: 0.5646476745605469
Epoch: 54, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.470 Vali Acc: 0.922 Test Loss: 0.470 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 55 cost time: 0.4650764465332031
Epoch: 55, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.456 Vali Acc: 0.915 Test Loss: 0.456 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.564284086227417
Epoch: 56, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.444 Vali Acc: 0.919 Test Loss: 0.444 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.43512749671936035
Epoch: 57, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.431 Vali Acc: 0.919 Test Loss: 0.431 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5546138286590576
Epoch: 58, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.420 Vali Acc: 0.919 Test Loss: 0.420 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.5115571022033691
Epoch: 59, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.409 Vali Acc: 0.922 Test Loss: 0.409 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 60 cost time: 0.4877328872680664
Epoch: 60, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.398 Vali Acc: 0.922 Test Loss: 0.398 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 61 cost time: 0.48594236373901367
Epoch: 61, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.389 Vali Acc: 0.922 Test Loss: 0.389 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 62 cost time: 0.5097861289978027
Epoch: 62, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.379 Vali Acc: 0.922 Test Loss: 0.379 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 63 cost time: 0.5637586116790771
Epoch: 63, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.371 Vali Acc: 0.922 Test Loss: 0.371 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 64 cost time: 0.6608097553253174
Epoch: 64, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.363 Vali Acc: 0.922 Test Loss: 0.363 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 65 cost time: 0.6867308616638184
Epoch: 65, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.356 Vali Acc: 0.926 Test Loss: 0.356 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925922).  Saving model ...
Epoch: 66 cost time: 0.6625678539276123
Epoch: 66, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.349 Vali Acc: 0.926 Test Loss: 0.349 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 67 cost time: 0.6979711055755615
Epoch: 67, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.7909269332885742
Epoch: 68, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.337 Vali Acc: 0.922 Test Loss: 0.337 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.6748461723327637
Epoch: 69, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.332 Vali Acc: 0.926 Test Loss: 0.332 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 70 cost time: 0.5556213855743408
Epoch: 70, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 71 cost time: 0.5439469814300537
Epoch: 71, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 72 cost time: 0.6818351745605469
Epoch: 72, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.317 Vali Acc: 0.926 Test Loss: 0.317 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 73 cost time: 0.5692408084869385
Epoch: 73, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 74 cost time: 0.609504222869873
Epoch: 74, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.307 Vali Acc: 0.926 Test Loss: 0.307 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 75 cost time: 0.6305217742919922
Epoch: 75, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.302 Vali Acc: 0.930 Test Loss: 0.302 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 76 cost time: 0.7178161144256592
Epoch: 76, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.298 Vali Acc: 0.926 Test Loss: 0.298 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.6571030616760254
Epoch: 77, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 78 cost time: 0.6575126647949219
Epoch: 78, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933330).  Saving model ...
Epoch: 79 cost time: 0.5810105800628662
Epoch: 79, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.6101765632629395
Epoch: 80, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.281 Vali Acc: 0.930 Test Loss: 0.281 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.7039709091186523
Epoch: 81, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 82 cost time: 0.6667790412902832
Epoch: 82, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 83 cost time: 0.6086535453796387
Epoch: 83, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6691741943359375
Epoch: 84, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.7285010814666748
Epoch: 85, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.7595596313476562
Epoch: 86, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 87 cost time: 0.6497561931610107
Epoch: 87, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 88 cost time: 0.5947587490081787
Epoch: 88, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 89 cost time: 0.6097924709320068
Epoch: 89, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 90 cost time: 0.7198383808135986
Epoch: 90, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 91 cost time: 0.6163172721862793
Epoch: 91, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 92 cost time: 0.6307065486907959
Epoch: 92, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 93 cost time: 0.5895953178405762
Epoch: 93, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 94 cost time: 0.5561859607696533
Epoch: 94, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 95 cost time: 0.6136484146118164
Epoch: 95, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 96 cost time: 0.5377035140991211
Epoch: 96, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 97 cost time: 0.5501923561096191
Epoch: 97, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.6272993087768555
Epoch: 98, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.5163233280181885
Epoch: 99, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 100 cost time: 0.5031685829162598
Epoch: 100, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 109214
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9416332244873047
Epoch: 1, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.731 Vali Acc: 0.252 Test Loss: 1.731 Test Acc: 0.252
Validation loss decreased (inf --> -0.251835).  Saving model ...
Epoch: 2 cost time: 0.6844484806060791
Epoch: 2, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.706 Vali Acc: 0.252 Test Loss: 1.706 Test Acc: 0.252
Validation loss decreased (-0.251835 --> -0.251835).  Saving model ...
Epoch: 3 cost time: 0.6756765842437744
Epoch: 3, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.689 Vali Acc: 0.267 Test Loss: 1.689 Test Acc: 0.267
Validation loss decreased (-0.251835 --> -0.266650).  Saving model ...
Epoch: 4 cost time: 0.6572184562683105
Epoch: 4, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.674 Vali Acc: 0.300 Test Loss: 1.674 Test Acc: 0.300
Validation loss decreased (-0.266650 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 0.6393537521362305
Epoch: 5, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.657 Vali Acc: 0.337 Test Loss: 1.657 Test Acc: 0.337
Validation loss decreased (-0.299983 --> -0.337020).  Saving model ...
Epoch: 6 cost time: 0.732515811920166
Epoch: 6, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.637 Vali Acc: 0.389 Test Loss: 1.637 Test Acc: 0.389
Validation loss decreased (-0.337020 --> -0.388873).  Saving model ...
Epoch: 7 cost time: 0.6295933723449707
Epoch: 7, Steps: 2 | Train Loss: 1.631 Vali Loss: 1.617 Vali Acc: 0.463 Test Loss: 1.617 Test Acc: 0.463
Validation loss decreased (-0.388873 --> -0.462947).  Saving model ...
Epoch: 8 cost time: 0.5533614158630371
Epoch: 8, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.597 Vali Acc: 0.511 Test Loss: 1.597 Test Acc: 0.511
Validation loss decreased (-0.462947 --> -0.511095).  Saving model ...
Epoch: 9 cost time: 0.6090304851531982
Epoch: 9, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.577 Vali Acc: 0.537 Test Loss: 1.577 Test Acc: 0.537
Validation loss decreased (-0.511095 --> -0.537021).  Saving model ...
Epoch: 10 cost time: 0.5284442901611328
Epoch: 10, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.557 Vali Acc: 0.552 Test Loss: 1.557 Test Acc: 0.552
Validation loss decreased (-0.537021 --> -0.551836).  Saving model ...
Epoch: 11 cost time: 0.5841197967529297
Epoch: 11, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.536 Vali Acc: 0.570 Test Loss: 1.536 Test Acc: 0.570
Validation loss decreased (-0.551836 --> -0.570355).  Saving model ...
Epoch: 12 cost time: 0.7441890239715576
Epoch: 12, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.515 Vali Acc: 0.585 Test Loss: 1.515 Test Acc: 0.585
Validation loss decreased (-0.570355 --> -0.585170).  Saving model ...
Epoch: 13 cost time: 0.7240045070648193
Epoch: 13, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.493 Vali Acc: 0.619 Test Loss: 1.493 Test Acc: 0.619
Validation loss decreased (-0.585170 --> -0.618504).  Saving model ...
Epoch: 14 cost time: 0.5726075172424316
Epoch: 14, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.470 Vali Acc: 0.633 Test Loss: 1.470 Test Acc: 0.633
Validation loss decreased (-0.618504 --> -0.633319).  Saving model ...
Epoch: 15 cost time: 0.589259147644043
Epoch: 15, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.446 Vali Acc: 0.663 Test Loss: 1.446 Test Acc: 0.663
Validation loss decreased (-0.633319 --> -0.662949).  Saving model ...
Epoch: 16 cost time: 0.6029183864593506
Epoch: 16, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.420 Vali Acc: 0.711 Test Loss: 1.420 Test Acc: 0.711
Validation loss decreased (-0.662949 --> -0.711097).  Saving model ...
Epoch: 17 cost time: 0.5587942600250244
Epoch: 17, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.394 Vali Acc: 0.737 Test Loss: 1.394 Test Acc: 0.737
Validation loss decreased (-0.711097 --> -0.737023).  Saving model ...
Epoch: 18 cost time: 0.674119234085083
Epoch: 18, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.366 Vali Acc: 0.748 Test Loss: 1.366 Test Acc: 0.748
Validation loss decreased (-0.737023 --> -0.748134).  Saving model ...
Epoch: 19 cost time: 0.6781930923461914
Epoch: 19, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.339 Vali Acc: 0.756 Test Loss: 1.339 Test Acc: 0.756
Validation loss decreased (-0.748134 --> -0.755542).  Saving model ...
Epoch: 20 cost time: 0.5313689708709717
Epoch: 20, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.313 Vali Acc: 0.763 Test Loss: 1.313 Test Acc: 0.763
Validation loss decreased (-0.755542 --> -0.762950).  Saving model ...
Epoch: 21 cost time: 0.5453348159790039
Epoch: 21, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.285 Vali Acc: 0.774 Test Loss: 1.285 Test Acc: 0.774
Validation loss decreased (-0.762950 --> -0.774061).  Saving model ...
Epoch: 22 cost time: 0.6133174896240234
Epoch: 22, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.257 Vali Acc: 0.800 Test Loss: 1.257 Test Acc: 0.800
Validation loss decreased (-0.774061 --> -0.799987).  Saving model ...
Epoch: 23 cost time: 0.5565485954284668
Epoch: 23, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.229 Vali Acc: 0.793 Test Loss: 1.229 Test Acc: 0.793
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5870602130889893
Epoch: 24, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.201 Vali Acc: 0.804 Test Loss: 1.201 Test Acc: 0.804
Validation loss decreased (-0.799987 --> -0.803692).  Saving model ...
Epoch: 25 cost time: 0.5444314479827881
Epoch: 25, Steps: 2 | Train Loss: 1.138 Vali Loss: 1.171 Vali Acc: 0.811 Test Loss: 1.171 Test Acc: 0.811
Validation loss decreased (-0.803692 --> -0.811099).  Saving model ...
Epoch: 26 cost time: 0.5107464790344238
Epoch: 26, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.141 Vali Acc: 0.807 Test Loss: 1.141 Test Acc: 0.807
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.5897314548492432
Epoch: 27, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.110 Vali Acc: 0.811 Test Loss: 1.110 Test Acc: 0.811
Validation loss decreased (-0.811099 --> -0.811100).  Saving model ...
Epoch: 28 cost time: 0.6435530185699463
Epoch: 28, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.078 Vali Acc: 0.822 Test Loss: 1.078 Test Acc: 0.822
Validation loss decreased (-0.811100 --> -0.822211).  Saving model ...
Epoch: 29 cost time: 0.533583402633667
Epoch: 29, Steps: 2 | Train Loss: 1.027 Vali Loss: 1.045 Vali Acc: 0.837 Test Loss: 1.045 Test Acc: 0.837
Validation loss decreased (-0.822211 --> -0.837027).  Saving model ...
Epoch: 30 cost time: 0.5818431377410889
Epoch: 30, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.013 Vali Acc: 0.841 Test Loss: 1.013 Test Acc: 0.841
Validation loss decreased (-0.837027 --> -0.840731).  Saving model ...
Epoch: 31 cost time: 0.6492221355438232
Epoch: 31, Steps: 2 | Train Loss: 1.001 Vali Loss: 0.981 Vali Acc: 0.852 Test Loss: 0.981 Test Acc: 0.852
Validation loss decreased (-0.840731 --> -0.851842).  Saving model ...
Epoch: 32 cost time: 0.574390172958374
Epoch: 32, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.947 Vali Acc: 0.863 Test Loss: 0.947 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862953).  Saving model ...
Epoch: 33 cost time: 0.5435495376586914
Epoch: 33, Steps: 2 | Train Loss: 0.843 Vali Loss: 0.913 Vali Acc: 0.870 Test Loss: 0.913 Test Acc: 0.870
Validation loss decreased (-0.862953 --> -0.870361).  Saving model ...
Epoch: 34 cost time: 0.5802679061889648
Epoch: 34, Steps: 2 | Train Loss: 0.857 Vali Loss: 0.880 Vali Acc: 0.878 Test Loss: 0.880 Test Acc: 0.878
Validation loss decreased (-0.870361 --> -0.877769).  Saving model ...
Epoch: 35 cost time: 0.5640835762023926
Epoch: 35, Steps: 2 | Train Loss: 0.795 Vali Loss: 0.847 Vali Acc: 0.893 Test Loss: 0.847 Test Acc: 0.893
Validation loss decreased (-0.877769 --> -0.892584).  Saving model ...
Epoch: 36 cost time: 0.5553605556488037
Epoch: 36, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.814 Vali Acc: 0.900 Test Loss: 0.814 Test Acc: 0.900
Validation loss decreased (-0.892584 --> -0.899992).  Saving model ...
Epoch: 37 cost time: 0.6548652648925781
Epoch: 37, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.781 Vali Acc: 0.915 Test Loss: 0.781 Test Acc: 0.915
Validation loss decreased (-0.899992 --> -0.914807).  Saving model ...
Epoch: 38 cost time: 0.6164300441741943
Epoch: 38, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.750 Vali Acc: 0.915 Test Loss: 0.750 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914807).  Saving model ...
Epoch: 39 cost time: 0.5666005611419678
Epoch: 39, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.719 Vali Acc: 0.915 Test Loss: 0.719 Test Acc: 0.915
Validation loss decreased (-0.914807 --> -0.914808).  Saving model ...
Epoch: 40 cost time: 0.5623908042907715
Epoch: 40, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.689 Vali Acc: 0.919 Test Loss: 0.689 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 41 cost time: 0.5774571895599365
Epoch: 41, Steps: 2 | Train Loss: 0.600 Vali Loss: 0.661 Vali Acc: 0.919 Test Loss: 0.661 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 42 cost time: 0.6366703510284424
Epoch: 42, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.634 Vali Acc: 0.919 Test Loss: 0.634 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 43 cost time: 0.5525648593902588
Epoch: 43, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.609 Vali Acc: 0.919 Test Loss: 0.609 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918512).  Saving model ...
Epoch: 44 cost time: 0.690955400466919
Epoch: 44, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.586 Vali Acc: 0.922 Test Loss: 0.586 Test Acc: 0.922
Validation loss decreased (-0.918512 --> -0.922216).  Saving model ...
Epoch: 45 cost time: 0.5880768299102783
Epoch: 45, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.563 Vali Acc: 0.926 Test Loss: 0.563 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 46 cost time: 0.6913433074951172
Epoch: 46, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.542 Vali Acc: 0.926 Test Loss: 0.542 Test Acc: 0.926
Validation loss decreased (-0.925920 --> -0.925921).  Saving model ...
Epoch: 47 cost time: 0.7278673648834229
Epoch: 47, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.523 Vali Acc: 0.930 Test Loss: 0.523 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929624).  Saving model ...
Epoch: 48 cost time: 0.6124238967895508
Epoch: 48, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.503 Vali Acc: 0.937 Test Loss: 0.503 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937032).  Saving model ...
Epoch: 49 cost time: 0.6113290786743164
Epoch: 49, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.485 Vali Acc: 0.941 Test Loss: 0.485 Test Acc: 0.941
Validation loss decreased (-0.937032 --> -0.940736).  Saving model ...
Epoch: 50 cost time: 0.7370991706848145
Epoch: 50, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.468 Vali Acc: 0.944 Test Loss: 0.468 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944440).  Saving model ...
Epoch: 51 cost time: 0.5881094932556152
Epoch: 51, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.451 Vali Acc: 0.952 Test Loss: 0.451 Test Acc: 0.952
Validation loss decreased (-0.944440 --> -0.951847).  Saving model ...
Epoch: 52 cost time: 0.622471809387207
Epoch: 52, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.436 Vali Acc: 0.956 Test Loss: 0.436 Test Acc: 0.956
Validation loss decreased (-0.951847 --> -0.955551).  Saving model ...
Epoch: 53 cost time: 0.9455392360687256
Epoch: 53, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.422 Vali Acc: 0.956 Test Loss: 0.422 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 54 cost time: 0.7121090888977051
Epoch: 54, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.410 Vali Acc: 0.956 Test Loss: 0.410 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955551).  Saving model ...
Epoch: 55 cost time: 0.7288479804992676
Epoch: 55, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.398 Vali Acc: 0.952 Test Loss: 0.398 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7177259922027588
Epoch: 56, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.388 Vali Acc: 0.952 Test Loss: 0.388 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.594017505645752
Epoch: 57, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.378 Vali Acc: 0.948 Test Loss: 0.378 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.5809991359710693
Epoch: 58, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.368 Vali Acc: 0.948 Test Loss: 0.368 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.7051053047180176
Epoch: 59, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.359 Vali Acc: 0.948 Test Loss: 0.359 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.6457607746124268
Epoch: 60, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.351 Vali Acc: 0.948 Test Loss: 0.351 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.657508134841919
Epoch: 61, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.342 Vali Acc: 0.952 Test Loss: 0.342 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.686495304107666
Epoch: 62, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.334 Vali Acc: 0.948 Test Loss: 0.334 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.5085468292236328
Epoch: 63, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.325 Vali Acc: 0.952 Test Loss: 0.325 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.5377013683319092
Epoch: 64, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.317 Vali Acc: 0.956 Test Loss: 0.317 Test Acc: 0.956
Validation loss decreased (-0.955551 --> -0.955552).  Saving model ...
Epoch: 65 cost time: 0.4763164520263672
Epoch: 65, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.310 Vali Acc: 0.956 Test Loss: 0.310 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955552).  Saving model ...
Epoch: 66 cost time: 0.6921634674072266
Epoch: 66, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.304 Vali Acc: 0.956 Test Loss: 0.304 Test Acc: 0.956
Validation loss decreased (-0.955552 --> -0.955553).  Saving model ...
Epoch: 67 cost time: 0.6534154415130615
Epoch: 67, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.299 Vali Acc: 0.956 Test Loss: 0.299 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 68 cost time: 0.5556869506835938
Epoch: 68, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.295 Vali Acc: 0.952 Test Loss: 0.295 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.705965518951416
Epoch: 69, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.6461434364318848
Epoch: 70, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.289 Vali Acc: 0.944 Test Loss: 0.289 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.5542562007904053
Epoch: 71, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.285 Vali Acc: 0.944 Test Loss: 0.285 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.6517372131347656
Epoch: 72, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.282 Vali Acc: 0.941 Test Loss: 0.282 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 73 cost time: 0.5759611129760742
Epoch: 73, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.277 Vali Acc: 0.941 Test Loss: 0.277 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 74 cost time: 0.7433104515075684
Epoch: 74, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 75 cost time: 0.6729311943054199
Epoch: 75, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 76 cost time: 0.800001859664917
Epoch: 76, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 77 cost time: 0.7333123683929443
Epoch: 77, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.257 Vali Acc: 0.952 Test Loss: 0.257 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 109022
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.230539560317993
Epoch: 1, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.787 Vali Acc: 0.170 Test Loss: 1.787 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.7785904407501221
Epoch: 2, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.761 Vali Acc: 0.174 Test Loss: 1.761 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.7353627681732178
Epoch: 3, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.743 Vali Acc: 0.181 Test Loss: 1.743 Test Acc: 0.181
Validation loss decreased (-0.174056 --> -0.181464).  Saving model ...
Epoch: 4 cost time: 0.5624034404754639
Epoch: 4, Steps: 2 | Train Loss: 1.793 Vali Loss: 1.729 Vali Acc: 0.189 Test Loss: 1.729 Test Acc: 0.189
Validation loss decreased (-0.181464 --> -0.188872).  Saving model ...
Epoch: 5 cost time: 0.5619149208068848
Epoch: 5, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.712 Vali Acc: 0.204 Test Loss: 1.712 Test Acc: 0.204
Validation loss decreased (-0.188872 --> -0.203687).  Saving model ...
Epoch: 6 cost time: 0.5818037986755371
Epoch: 6, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.692 Vali Acc: 0.226 Test Loss: 1.692 Test Acc: 0.226
Validation loss decreased (-0.203687 --> -0.225909).  Saving model ...
Epoch: 7 cost time: 0.54396653175354
Epoch: 7, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.671 Vali Acc: 0.259 Test Loss: 1.671 Test Acc: 0.259
Validation loss decreased (-0.225909 --> -0.259243).  Saving model ...
Epoch: 8 cost time: 0.6711649894714355
Epoch: 8, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.649 Vali Acc: 0.285 Test Loss: 1.649 Test Acc: 0.285
Validation loss decreased (-0.259243 --> -0.285169).  Saving model ...
Epoch: 9 cost time: 0.7722976207733154
Epoch: 9, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.626 Vali Acc: 0.400 Test Loss: 1.626 Test Acc: 0.400
Validation loss decreased (-0.285169 --> -0.399984).  Saving model ...
Epoch: 10 cost time: 0.6210744380950928
Epoch: 10, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.604 Vali Acc: 0.478 Test Loss: 1.604 Test Acc: 0.478
Validation loss decreased (-0.399984 --> -0.477762).  Saving model ...
Epoch: 11 cost time: 0.7668755054473877
Epoch: 11, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.581 Vali Acc: 0.537 Test Loss: 1.581 Test Acc: 0.537
Validation loss decreased (-0.477762 --> -0.537021).  Saving model ...
Epoch: 12 cost time: 0.6323139667510986
Epoch: 12, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.558 Vali Acc: 0.593 Test Loss: 1.558 Test Acc: 0.593
Validation loss decreased (-0.537021 --> -0.592577).  Saving model ...
Epoch: 13 cost time: 0.5344204902648926
Epoch: 13, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.535 Vali Acc: 0.648 Test Loss: 1.535 Test Acc: 0.648
Validation loss decreased (-0.592577 --> -0.648133).  Saving model ...
Epoch: 14 cost time: 0.5999963283538818
Epoch: 14, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.512 Vali Acc: 0.670 Test Loss: 1.512 Test Acc: 0.670
Validation loss decreased (-0.648133 --> -0.670355).  Saving model ...
Epoch: 15 cost time: 0.6239926815032959
Epoch: 15, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.488 Vali Acc: 0.685 Test Loss: 1.488 Test Acc: 0.685
Validation loss decreased (-0.670355 --> -0.685170).  Saving model ...
Epoch: 16 cost time: 0.5183804035186768
Epoch: 16, Steps: 2 | Train Loss: 1.486 Vali Loss: 1.462 Vali Acc: 0.704 Test Loss: 1.462 Test Acc: 0.704
Validation loss decreased (-0.685170 --> -0.703689).  Saving model ...
Epoch: 17 cost time: 0.5150840282440186
Epoch: 17, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.436 Vali Acc: 0.707 Test Loss: 1.436 Test Acc: 0.707
Validation loss decreased (-0.703689 --> -0.707393).  Saving model ...
Epoch: 18 cost time: 0.5435609817504883
Epoch: 18, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.409 Vali Acc: 0.719 Test Loss: 1.409 Test Acc: 0.719
Validation loss decreased (-0.707393 --> -0.718504).  Saving model ...
Epoch: 19 cost time: 0.6622200012207031
Epoch: 19, Steps: 2 | Train Loss: 1.348 Vali Loss: 1.382 Vali Acc: 0.726 Test Loss: 1.382 Test Acc: 0.726
Validation loss decreased (-0.718504 --> -0.725912).  Saving model ...
Epoch: 20 cost time: 0.5975551605224609
Epoch: 20, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.354 Vali Acc: 0.741 Test Loss: 1.354 Test Acc: 0.741
Validation loss decreased (-0.725912 --> -0.740727).  Saving model ...
Epoch: 21 cost time: 0.464158296585083
Epoch: 21, Steps: 2 | Train Loss: 1.297 Vali Loss: 1.326 Vali Acc: 0.752 Test Loss: 1.326 Test Acc: 0.752
Validation loss decreased (-0.740727 --> -0.751839).  Saving model ...
Epoch: 22 cost time: 0.5567445755004883
Epoch: 22, Steps: 2 | Train Loss: 1.316 Vali Loss: 1.296 Vali Acc: 0.763 Test Loss: 1.296 Test Acc: 0.763
Validation loss decreased (-0.751839 --> -0.762950).  Saving model ...
Epoch: 23 cost time: 0.6328153610229492
Epoch: 23, Steps: 2 | Train Loss: 1.245 Vali Loss: 1.266 Vali Acc: 0.774 Test Loss: 1.266 Test Acc: 0.774
Validation loss decreased (-0.762950 --> -0.774061).  Saving model ...
Epoch: 24 cost time: 0.5511682033538818
Epoch: 24, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.234 Vali Acc: 0.781 Test Loss: 1.234 Test Acc: 0.781
Validation loss decreased (-0.774061 --> -0.781469).  Saving model ...
Epoch: 25 cost time: 0.5436551570892334
Epoch: 25, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.201 Vali Acc: 0.789 Test Loss: 1.201 Test Acc: 0.789
Validation loss decreased (-0.781469 --> -0.788877).  Saving model ...
Epoch: 26 cost time: 0.48854851722717285
Epoch: 26, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.168 Vali Acc: 0.796 Test Loss: 1.168 Test Acc: 0.796
Validation loss decreased (-0.788877 --> -0.796285).  Saving model ...
Epoch: 27 cost time: 0.5487637519836426
Epoch: 27, Steps: 2 | Train Loss: 1.128 Vali Loss: 1.134 Vali Acc: 0.815 Test Loss: 1.134 Test Acc: 0.815
Validation loss decreased (-0.796285 --> -0.814803).  Saving model ...
Epoch: 28 cost time: 0.5561213493347168
Epoch: 28, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.099 Vali Acc: 0.822 Test Loss: 1.099 Test Acc: 0.822
Validation loss decreased (-0.814803 --> -0.822211).  Saving model ...
Epoch: 29 cost time: 0.6646196842193604
Epoch: 29, Steps: 2 | Train Loss: 0.995 Vali Loss: 1.062 Vali Acc: 0.848 Test Loss: 1.062 Test Acc: 0.848
Validation loss decreased (-0.822211 --> -0.848138).  Saving model ...
Epoch: 30 cost time: 0.6409947872161865
Epoch: 30, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.026 Vali Acc: 0.852 Test Loss: 1.026 Test Acc: 0.852
Validation loss decreased (-0.848138 --> -0.851842).  Saving model ...
Epoch: 31 cost time: 0.7522547245025635
Epoch: 31, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.991 Vali Acc: 0.863 Test Loss: 0.991 Test Acc: 0.863
Validation loss decreased (-0.851842 --> -0.862953).  Saving model ...
Epoch: 32 cost time: 0.5628998279571533
Epoch: 32, Steps: 2 | Train Loss: 0.884 Vali Loss: 0.956 Vali Acc: 0.870 Test Loss: 0.956 Test Acc: 0.870
Validation loss decreased (-0.862953 --> -0.870361).  Saving model ...
Epoch: 33 cost time: 0.5098381042480469
Epoch: 33, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.920 Vali Acc: 0.870 Test Loss: 0.920 Test Acc: 0.870
Validation loss decreased (-0.870361 --> -0.870361).  Saving model ...
Epoch: 34 cost time: 0.6388437747955322
Epoch: 34, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.885 Vali Acc: 0.878 Test Loss: 0.885 Test Acc: 0.878
Validation loss decreased (-0.870361 --> -0.877769).  Saving model ...
Epoch: 35 cost time: 0.6198632717132568
Epoch: 35, Steps: 2 | Train Loss: 0.778 Vali Loss: 0.850 Vali Acc: 0.874 Test Loss: 0.850 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5886409282684326
Epoch: 36, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.816 Vali Acc: 0.878 Test Loss: 0.816 Test Acc: 0.878
Validation loss decreased (-0.877769 --> -0.877770).  Saving model ...
Epoch: 37 cost time: 0.6356453895568848
Epoch: 37, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.784 Vali Acc: 0.881 Test Loss: 0.784 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881474).  Saving model ...
Epoch: 38 cost time: 0.5703320503234863
Epoch: 38, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.751 Vali Acc: 0.885 Test Loss: 0.751 Test Acc: 0.885
Validation loss decreased (-0.881474 --> -0.885178).  Saving model ...
Epoch: 39 cost time: 0.5824816226959229
Epoch: 39, Steps: 2 | Train Loss: 0.611 Vali Loss: 0.721 Vali Acc: 0.885 Test Loss: 0.721 Test Acc: 0.885
Validation loss decreased (-0.885178 --> -0.885178).  Saving model ...
Epoch: 40 cost time: 0.5411369800567627
Epoch: 40, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.692 Vali Acc: 0.889 Test Loss: 0.692 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888882).  Saving model ...
Epoch: 41 cost time: 0.6221053600311279
Epoch: 41, Steps: 2 | Train Loss: 0.576 Vali Loss: 0.664 Vali Acc: 0.885 Test Loss: 0.664 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6339225769042969
Epoch: 42, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.639 Vali Acc: 0.900 Test Loss: 0.639 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899994).  Saving model ...
Epoch: 43 cost time: 0.6309459209442139
Epoch: 43, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.615 Vali Acc: 0.900 Test Loss: 0.615 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 44 cost time: 0.510474443435669
Epoch: 44, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.593 Vali Acc: 0.900 Test Loss: 0.593 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899994).  Saving model ...
Epoch: 45 cost time: 0.5452015399932861
Epoch: 45, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.570 Vali Acc: 0.915 Test Loss: 0.570 Test Acc: 0.915
Validation loss decreased (-0.899994 --> -0.914809).  Saving model ...
Epoch: 46 cost time: 0.5957691669464111
Epoch: 46, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.549 Vali Acc: 0.911 Test Loss: 0.549 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6235325336456299
Epoch: 47, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.529 Vali Acc: 0.911 Test Loss: 0.529 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.6014814376831055
Epoch: 48, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.510 Vali Acc: 0.919 Test Loss: 0.510 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 49 cost time: 0.5699877738952637
Epoch: 49, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.494 Vali Acc: 0.922 Test Loss: 0.494 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 50 cost time: 0.5746703147888184
Epoch: 50, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.478 Vali Acc: 0.922 Test Loss: 0.478 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 51 cost time: 0.6572518348693848
Epoch: 51, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.464 Vali Acc: 0.930 Test Loss: 0.464 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 52 cost time: 0.7193231582641602
Epoch: 52, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.450 Vali Acc: 0.926 Test Loss: 0.450 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.6068789958953857
Epoch: 53, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.437 Vali Acc: 0.930 Test Loss: 0.437 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 54 cost time: 0.5862042903900146
Epoch: 54, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.425 Vali Acc: 0.933 Test Loss: 0.425 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 55 cost time: 0.5613656044006348
Epoch: 55, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.414 Vali Acc: 0.937 Test Loss: 0.414 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 56 cost time: 0.5870981216430664
Epoch: 56, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.403 Vali Acc: 0.937 Test Loss: 0.403 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 57 cost time: 0.5610973834991455
Epoch: 57, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.392 Vali Acc: 0.937 Test Loss: 0.392 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 58 cost time: 0.5003693103790283
Epoch: 58, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.383 Vali Acc: 0.941 Test Loss: 0.383 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 59 cost time: 0.5503296852111816
Epoch: 59, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.374 Vali Acc: 0.941 Test Loss: 0.374 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 60 cost time: 0.5726914405822754
Epoch: 60, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.366 Vali Acc: 0.941 Test Loss: 0.366 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 61 cost time: 0.5477194786071777
Epoch: 61, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.358 Vali Acc: 0.941 Test Loss: 0.358 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 62 cost time: 0.7059979438781738
Epoch: 62, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.351 Vali Acc: 0.941 Test Loss: 0.351 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 63 cost time: 0.5866744518280029
Epoch: 63, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.344 Vali Acc: 0.941 Test Loss: 0.344 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 64 cost time: 0.5230622291564941
Epoch: 64, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.337 Vali Acc: 0.944 Test Loss: 0.337 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 65 cost time: 0.5593037605285645
Epoch: 65, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.332 Vali Acc: 0.941 Test Loss: 0.332 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.46088719367980957
Epoch: 66, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.560295820236206
Epoch: 67, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.323 Vali Acc: 0.937 Test Loss: 0.323 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.5652070045471191
Epoch: 68, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.318 Vali Acc: 0.937 Test Loss: 0.318 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.6046009063720703
Epoch: 69, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.7788021564483643
Epoch: 70, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.306 Vali Acc: 0.937 Test Loss: 0.306 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.5048055648803711
Epoch: 71, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.5504672527313232
Epoch: 72, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 73 cost time: 0.6078662872314453
Epoch: 73, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.290 Vali Acc: 0.937 Test Loss: 0.290 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 74 cost time: 0.5944993495941162
Epoch: 74, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.286 Vali Acc: 0.933 Test Loss: 0.286 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 108830
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.411367893218994
Epoch: 1, Steps: 2 | Train Loss: 2.098 Vali Loss: 1.996 Vali Acc: 0.167 Test Loss: 1.996 Test Acc: 0.167
Validation loss decreased (inf --> -0.166647).  Saving model ...
Epoch: 2 cost time: 0.5579135417938232
Epoch: 2, Steps: 2 | Train Loss: 2.011 Vali Loss: 1.957 Vali Acc: 0.167 Test Loss: 1.957 Test Acc: 0.167
Validation loss decreased (-0.166647 --> -0.166647).  Saving model ...
Epoch: 3 cost time: 0.6556754112243652
Epoch: 3, Steps: 2 | Train Loss: 1.959 Vali Loss: 1.932 Vali Acc: 0.167 Test Loss: 1.932 Test Acc: 0.167
Validation loss decreased (-0.166647 --> -0.166647).  Saving model ...
Epoch: 4 cost time: 0.6021993160247803
Epoch: 4, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.913 Vali Acc: 0.167 Test Loss: 1.913 Test Acc: 0.167
Validation loss decreased (-0.166647 --> -0.166648).  Saving model ...
Epoch: 5 cost time: 0.8670287132263184
Epoch: 5, Steps: 2 | Train Loss: 1.954 Vali Loss: 1.890 Vali Acc: 0.170 Test Loss: 1.890 Test Acc: 0.170
Validation loss decreased (-0.166648 --> -0.170351).  Saving model ...
Epoch: 6 cost time: 0.5794625282287598
Epoch: 6, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.865 Vali Acc: 0.163 Test Loss: 1.865 Test Acc: 0.163
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5816371440887451
Epoch: 7, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.840 Vali Acc: 0.167 Test Loss: 1.840 Test Acc: 0.167
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.6965386867523193
Epoch: 8, Steps: 2 | Train Loss: 1.885 Vali Loss: 1.814 Vali Acc: 0.200 Test Loss: 1.814 Test Acc: 0.200
Validation loss decreased (-0.170351 --> -0.199982).  Saving model ...
Epoch: 9 cost time: 0.49909043312072754
Epoch: 9, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.788 Vali Acc: 0.267 Test Loss: 1.788 Test Acc: 0.267
Validation loss decreased (-0.199982 --> -0.266649).  Saving model ...
Epoch: 10 cost time: 0.5272271633148193
Epoch: 10, Steps: 2 | Train Loss: 1.799 Vali Loss: 1.762 Vali Acc: 0.296 Test Loss: 1.762 Test Acc: 0.296
Validation loss decreased (-0.266649 --> -0.296279).  Saving model ...
Epoch: 11 cost time: 0.6270005702972412
Epoch: 11, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.737 Vali Acc: 0.311 Test Loss: 1.737 Test Acc: 0.311
Validation loss decreased (-0.296279 --> -0.311094).  Saving model ...
Epoch: 12 cost time: 0.5328860282897949
Epoch: 12, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.711 Vali Acc: 0.326 Test Loss: 1.711 Test Acc: 0.326
Validation loss decreased (-0.311094 --> -0.325909).  Saving model ...
Epoch: 13 cost time: 0.5629701614379883
Epoch: 13, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.685 Vali Acc: 0.333 Test Loss: 1.685 Test Acc: 0.333
Validation loss decreased (-0.325909 --> -0.333316).  Saving model ...
Epoch: 14 cost time: 0.61252760887146
Epoch: 14, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.660 Vali Acc: 0.378 Test Loss: 1.660 Test Acc: 0.378
Validation loss decreased (-0.333316 --> -0.377761).  Saving model ...
Epoch: 15 cost time: 0.573458194732666
Epoch: 15, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.634 Vali Acc: 0.393 Test Loss: 1.634 Test Acc: 0.393
Validation loss decreased (-0.377761 --> -0.392576).  Saving model ...
Epoch: 16 cost time: 0.6526851654052734
Epoch: 16, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.609 Vali Acc: 0.437 Test Loss: 1.609 Test Acc: 0.437
Validation loss decreased (-0.392576 --> -0.437021).  Saving model ...
Epoch: 17 cost time: 0.5453765392303467
Epoch: 17, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.583 Vali Acc: 0.481 Test Loss: 1.583 Test Acc: 0.481
Validation loss decreased (-0.437021 --> -0.481466).  Saving model ...
Epoch: 18 cost time: 0.42308616638183594
Epoch: 18, Steps: 2 | Train Loss: 1.596 Vali Loss: 1.556 Vali Acc: 0.556 Test Loss: 1.556 Test Acc: 0.556
Validation loss decreased (-0.481466 --> -0.555540).  Saving model ...
Epoch: 19 cost time: 0.5460638999938965
Epoch: 19, Steps: 2 | Train Loss: 1.506 Vali Loss: 1.528 Vali Acc: 0.589 Test Loss: 1.528 Test Acc: 0.589
Validation loss decreased (-0.555540 --> -0.588874).  Saving model ...
Epoch: 20 cost time: 0.47777605056762695
Epoch: 20, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.500 Vali Acc: 0.633 Test Loss: 1.500 Test Acc: 0.633
Validation loss decreased (-0.588874 --> -0.633318).  Saving model ...
Epoch: 21 cost time: 0.6025590896606445
Epoch: 21, Steps: 2 | Train Loss: 1.414 Vali Loss: 1.470 Vali Acc: 0.656 Test Loss: 1.470 Test Acc: 0.656
Validation loss decreased (-0.633318 --> -0.655541).  Saving model ...
Epoch: 22 cost time: 0.5077307224273682
Epoch: 22, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.439 Vali Acc: 0.681 Test Loss: 1.439 Test Acc: 0.681
Validation loss decreased (-0.655541 --> -0.681467).  Saving model ...
Epoch: 23 cost time: 0.5755565166473389
Epoch: 23, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.407 Vali Acc: 0.704 Test Loss: 1.407 Test Acc: 0.704
Validation loss decreased (-0.681467 --> -0.703690).  Saving model ...
Epoch: 24 cost time: 0.6177442073822021
Epoch: 24, Steps: 2 | Train Loss: 1.335 Vali Loss: 1.374 Vali Acc: 0.715 Test Loss: 1.374 Test Acc: 0.715
Validation loss decreased (-0.703690 --> -0.714801).  Saving model ...
Epoch: 25 cost time: 0.5203306674957275
Epoch: 25, Steps: 2 | Train Loss: 1.352 Vali Loss: 1.341 Vali Acc: 0.722 Test Loss: 1.341 Test Acc: 0.722
Validation loss decreased (-0.714801 --> -0.722209).  Saving model ...
Epoch: 26 cost time: 0.7377572059631348
Epoch: 26, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.308 Vali Acc: 0.737 Test Loss: 1.308 Test Acc: 0.737
Validation loss decreased (-0.722209 --> -0.737024).  Saving model ...
Epoch: 27 cost time: 0.5348999500274658
Epoch: 27, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.273 Vali Acc: 0.741 Test Loss: 1.273 Test Acc: 0.741
Validation loss decreased (-0.737024 --> -0.740728).  Saving model ...
Epoch: 28 cost time: 0.4781825542449951
Epoch: 28, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.238 Vali Acc: 0.763 Test Loss: 1.238 Test Acc: 0.763
Validation loss decreased (-0.740728 --> -0.762951).  Saving model ...
Epoch: 29 cost time: 0.693225622177124
Epoch: 29, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.204 Vali Acc: 0.770 Test Loss: 1.204 Test Acc: 0.770
Validation loss decreased (-0.762951 --> -0.770358).  Saving model ...
Epoch: 30 cost time: 0.6418075561523438
Epoch: 30, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.168 Vali Acc: 0.774 Test Loss: 1.168 Test Acc: 0.774
Validation loss decreased (-0.770358 --> -0.774062).  Saving model ...
Epoch: 31 cost time: 0.6253998279571533
Epoch: 31, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.131 Vali Acc: 0.785 Test Loss: 1.131 Test Acc: 0.785
Validation loss decreased (-0.774062 --> -0.785174).  Saving model ...
Epoch: 32 cost time: 0.5514857769012451
Epoch: 32, Steps: 2 | Train Loss: 0.964 Vali Loss: 1.094 Vali Acc: 0.785 Test Loss: 1.094 Test Acc: 0.785
Validation loss decreased (-0.785174 --> -0.785174).  Saving model ...
Epoch: 33 cost time: 0.5008654594421387
Epoch: 33, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.056 Vali Acc: 0.811 Test Loss: 1.056 Test Acc: 0.811
Validation loss decreased (-0.785174 --> -0.811101).  Saving model ...
Epoch: 34 cost time: 0.5325531959533691
Epoch: 34, Steps: 2 | Train Loss: 0.885 Vali Loss: 1.019 Vali Acc: 0.830 Test Loss: 1.019 Test Acc: 0.830
Validation loss decreased (-0.811101 --> -0.829619).  Saving model ...
Epoch: 35 cost time: 0.6199400424957275
Epoch: 35, Steps: 2 | Train Loss: 0.847 Vali Loss: 0.982 Vali Acc: 0.841 Test Loss: 0.982 Test Acc: 0.841
Validation loss decreased (-0.829619 --> -0.840731).  Saving model ...
Epoch: 36 cost time: 0.6370687484741211
Epoch: 36, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.946 Vali Acc: 0.856 Test Loss: 0.946 Test Acc: 0.856
Validation loss decreased (-0.840731 --> -0.855546).  Saving model ...
Epoch: 37 cost time: 0.647559642791748
Epoch: 37, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.912 Vali Acc: 0.867 Test Loss: 0.912 Test Acc: 0.867
Validation loss decreased (-0.855546 --> -0.866658).  Saving model ...
Epoch: 38 cost time: 0.5241992473602295
Epoch: 38, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.880 Vali Acc: 0.870 Test Loss: 0.880 Test Acc: 0.870
Validation loss decreased (-0.866658 --> -0.870362).  Saving model ...
Epoch: 39 cost time: 0.5053942203521729
Epoch: 39, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.848 Vali Acc: 0.881 Test Loss: 0.848 Test Acc: 0.881
Validation loss decreased (-0.870362 --> -0.881473).  Saving model ...
Epoch: 40 cost time: 0.5535292625427246
Epoch: 40, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.816 Vali Acc: 0.881 Test Loss: 0.816 Test Acc: 0.881
Validation loss decreased (-0.881473 --> -0.881473).  Saving model ...
Epoch: 41 cost time: 0.603945255279541
Epoch: 41, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.786 Vali Acc: 0.889 Test Loss: 0.786 Test Acc: 0.889
Validation loss decreased (-0.881473 --> -0.888881).  Saving model ...
Epoch: 42 cost time: 0.5948641300201416
Epoch: 42, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.757 Vali Acc: 0.900 Test Loss: 0.757 Test Acc: 0.900
Validation loss decreased (-0.888881 --> -0.899992).  Saving model ...
Epoch: 43 cost time: 0.46459341049194336
Epoch: 43, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.729 Vali Acc: 0.900 Test Loss: 0.729 Test Acc: 0.900
Validation loss decreased (-0.899992 --> -0.899993).  Saving model ...
Epoch: 44 cost time: 0.5049326419830322
Epoch: 44, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.702 Vali Acc: 0.907 Test Loss: 0.702 Test Acc: 0.907
Validation loss decreased (-0.899993 --> -0.907400).  Saving model ...
Epoch: 45 cost time: 0.5162453651428223
Epoch: 45, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.678 Vali Acc: 0.904 Test Loss: 0.678 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5611319541931152
Epoch: 46, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.653 Vali Acc: 0.915 Test Loss: 0.653 Test Acc: 0.915
Validation loss decreased (-0.907400 --> -0.914808).  Saving model ...
Epoch: 47 cost time: 0.6682498455047607
Epoch: 47, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.629 Vali Acc: 0.919 Test Loss: 0.629 Test Acc: 0.919
Validation loss decreased (-0.914808 --> -0.918512).  Saving model ...
Epoch: 48 cost time: 0.5783772468566895
Epoch: 48, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.605 Vali Acc: 0.926 Test Loss: 0.605 Test Acc: 0.926
Validation loss decreased (-0.918512 --> -0.925920).  Saving model ...
Epoch: 49 cost time: 0.6531827449798584
Epoch: 49, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.583 Vali Acc: 0.930 Test Loss: 0.583 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929624).  Saving model ...
Epoch: 50 cost time: 0.6811206340789795
Epoch: 50, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.562 Vali Acc: 0.930 Test Loss: 0.562 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 51 cost time: 0.5122113227844238
Epoch: 51, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.542 Vali Acc: 0.930 Test Loss: 0.542 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929624).  Saving model ...
Epoch: 52 cost time: 0.6107540130615234
Epoch: 52, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.524 Vali Acc: 0.933 Test Loss: 0.524 Test Acc: 0.933
Validation loss decreased (-0.929624 --> -0.933328).  Saving model ...
Epoch: 53 cost time: 0.5402817726135254
Epoch: 53, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.506 Vali Acc: 0.933 Test Loss: 0.506 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 54 cost time: 0.6240808963775635
Epoch: 54, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.490 Vali Acc: 0.933 Test Loss: 0.490 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933328).  Saving model ...
Epoch: 55 cost time: 0.5002989768981934
Epoch: 55, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.474 Vali Acc: 0.933 Test Loss: 0.474 Test Acc: 0.933
Validation loss decreased (-0.933328 --> -0.933329).  Saving model ...
Epoch: 56 cost time: 0.5823259353637695
Epoch: 56, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.460 Vali Acc: 0.933 Test Loss: 0.460 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 57 cost time: 0.5771863460540771
Epoch: 57, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.446 Vali Acc: 0.937 Test Loss: 0.446 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 58 cost time: 0.501777172088623
Epoch: 58, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.434 Vali Acc: 0.937 Test Loss: 0.434 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 59 cost time: 0.5084640979766846
Epoch: 59, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.422 Vali Acc: 0.933 Test Loss: 0.422 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5612876415252686
Epoch: 60, Steps: 2 | Train Loss: 0.265 Vali Loss: 0.412 Vali Acc: 0.937 Test Loss: 0.412 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 61 cost time: 0.6263906955718994
Epoch: 61, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.402 Vali Acc: 0.941 Test Loss: 0.402 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 62 cost time: 0.6515686511993408
Epoch: 62, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.393 Vali Acc: 0.941 Test Loss: 0.393 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 63 cost time: 0.5387551784515381
Epoch: 63, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.384 Vali Acc: 0.941 Test Loss: 0.384 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 64 cost time: 0.6476976871490479
Epoch: 64, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.375 Vali Acc: 0.941 Test Loss: 0.375 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 65 cost time: 0.589428186416626
Epoch: 65, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.367 Vali Acc: 0.941 Test Loss: 0.367 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 66 cost time: 0.49071598052978516
Epoch: 66, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.359 Vali Acc: 0.941 Test Loss: 0.359 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 67 cost time: 0.4958834648132324
Epoch: 67, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.351 Vali Acc: 0.937 Test Loss: 0.351 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 0.5467426776885986
Epoch: 68, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.343 Vali Acc: 0.937 Test Loss: 0.343 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.5525977611541748
Epoch: 69, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.337 Vali Acc: 0.937 Test Loss: 0.337 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 70 cost time: 0.5451090335845947
Epoch: 70, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.331 Vali Acc: 0.933 Test Loss: 0.331 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 71 cost time: 0.5925254821777344
Epoch: 71, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.325 Vali Acc: 0.933 Test Loss: 0.325 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 72 cost time: 0.5985627174377441
Epoch: 72, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.319 Vali Acc: 0.933 Test Loss: 0.319 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 73 cost time: 0.6766767501831055
Epoch: 73, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.314 Vali Acc: 0.933 Test Loss: 0.314 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 74 cost time: 0.5970308780670166
Epoch: 74, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.309 Vali Acc: 0.930 Test Loss: 0.309 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 75 cost time: 0.709444522857666
Epoch: 75, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 76 cost time: 0.5284693241119385
Epoch: 76, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 108638
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             4                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0520377159118652
Epoch: 1, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.884 Vali Acc: 0.170 Test Loss: 1.884 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.5397272109985352
Epoch: 2, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.853 Vali Acc: 0.174 Test Loss: 1.853 Test Acc: 0.174
Validation loss decreased (-0.170352 --> -0.174056).  Saving model ...
Epoch: 3 cost time: 0.632904052734375
Epoch: 3, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.833 Vali Acc: 0.185 Test Loss: 1.833 Test Acc: 0.185
Validation loss decreased (-0.174056 --> -0.185167).  Saving model ...
Epoch: 4 cost time: 0.5613815784454346
Epoch: 4, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.818 Vali Acc: 0.193 Test Loss: 1.818 Test Acc: 0.193
Validation loss decreased (-0.185167 --> -0.192574).  Saving model ...
Epoch: 5 cost time: 0.6828782558441162
Epoch: 5, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.799 Vali Acc: 0.200 Test Loss: 1.799 Test Acc: 0.200
Validation loss decreased (-0.192574 --> -0.199982).  Saving model ...
Epoch: 6 cost time: 0.5751562118530273
Epoch: 6, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.777 Vali Acc: 0.211 Test Loss: 1.777 Test Acc: 0.211
Validation loss decreased (-0.199982 --> -0.211093).  Saving model ...
Epoch: 7 cost time: 0.5795419216156006
Epoch: 7, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.754 Vali Acc: 0.222 Test Loss: 1.754 Test Acc: 0.222
Validation loss decreased (-0.211093 --> -0.222205).  Saving model ...
Epoch: 8 cost time: 0.5353012084960938
Epoch: 8, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.730 Vali Acc: 0.241 Test Loss: 1.730 Test Acc: 0.241
Validation loss decreased (-0.222205 --> -0.240723).  Saving model ...
Epoch: 9 cost time: 0.4872775077819824
Epoch: 9, Steps: 2 | Train Loss: 1.719 Vali Loss: 1.706 Vali Acc: 0.256 Test Loss: 1.706 Test Acc: 0.256
Validation loss decreased (-0.240723 --> -0.255538).  Saving model ...
Epoch: 10 cost time: 0.5579395294189453
Epoch: 10, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.684 Vali Acc: 0.296 Test Loss: 1.684 Test Acc: 0.296
Validation loss decreased (-0.255538 --> -0.296279).  Saving model ...
Epoch: 11 cost time: 0.6176822185516357
Epoch: 11, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.661 Vali Acc: 0.330 Test Loss: 1.661 Test Acc: 0.330
Validation loss decreased (-0.296279 --> -0.329613).  Saving model ...
Epoch: 12 cost time: 0.7021071910858154
Epoch: 12, Steps: 2 | Train Loss: 1.695 Vali Loss: 1.638 Vali Acc: 0.356 Test Loss: 1.638 Test Acc: 0.356
Validation loss decreased (-0.329613 --> -0.355539).  Saving model ...
Epoch: 13 cost time: 0.6849515438079834
Epoch: 13, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.615 Vali Acc: 0.400 Test Loss: 1.615 Test Acc: 0.400
Validation loss decreased (-0.355539 --> -0.399984).  Saving model ...
Epoch: 14 cost time: 0.5273926258087158
Epoch: 14, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.592 Vali Acc: 0.430 Test Loss: 1.592 Test Acc: 0.430
Validation loss decreased (-0.399984 --> -0.429614).  Saving model ...
Epoch: 15 cost time: 0.5531876087188721
Epoch: 15, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.569 Vali Acc: 0.470 Test Loss: 1.569 Test Acc: 0.470
Validation loss decreased (-0.429614 --> -0.470355).  Saving model ...
Epoch: 16 cost time: 0.6920938491821289
Epoch: 16, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.544 Vali Acc: 0.519 Test Loss: 1.544 Test Acc: 0.519
Validation loss decreased (-0.470355 --> -0.518503).  Saving model ...
Epoch: 17 cost time: 0.5284242630004883
Epoch: 17, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.518 Vali Acc: 0.559 Test Loss: 1.518 Test Acc: 0.559
Validation loss decreased (-0.518503 --> -0.559244).  Saving model ...
Epoch: 18 cost time: 0.5385379791259766
Epoch: 18, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.491 Vali Acc: 0.596 Test Loss: 1.491 Test Acc: 0.596
Validation loss decreased (-0.559244 --> -0.596281).  Saving model ...
Epoch: 19 cost time: 0.49312543869018555
Epoch: 19, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.465 Vali Acc: 0.611 Test Loss: 1.465 Test Acc: 0.611
Validation loss decreased (-0.596281 --> -0.611096).  Saving model ...
Epoch: 20 cost time: 0.5455012321472168
Epoch: 20, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.438 Vali Acc: 0.644 Test Loss: 1.438 Test Acc: 0.644
Validation loss decreased (-0.611096 --> -0.644430).  Saving model ...
Epoch: 21 cost time: 0.5603358745574951
Epoch: 21, Steps: 2 | Train Loss: 1.427 Vali Loss: 1.410 Vali Acc: 0.652 Test Loss: 1.410 Test Acc: 0.652
Validation loss decreased (-0.644430 --> -0.651838).  Saving model ...
Epoch: 22 cost time: 0.5261309146881104
Epoch: 22, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.382 Vali Acc: 0.663 Test Loss: 1.382 Test Acc: 0.663
Validation loss decreased (-0.651838 --> -0.662949).  Saving model ...
Epoch: 23 cost time: 0.5102691650390625
Epoch: 23, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.353 Vali Acc: 0.685 Test Loss: 1.353 Test Acc: 0.685
Validation loss decreased (-0.662949 --> -0.685172).  Saving model ...
Epoch: 24 cost time: 0.492203950881958
Epoch: 24, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.324 Vali Acc: 0.711 Test Loss: 1.324 Test Acc: 0.711
Validation loss decreased (-0.685172 --> -0.711098).  Saving model ...
Epoch: 25 cost time: 0.5359694957733154
Epoch: 25, Steps: 2 | Train Loss: 1.280 Vali Loss: 1.296 Vali Acc: 0.733 Test Loss: 1.296 Test Acc: 0.733
Validation loss decreased (-0.711098 --> -0.733320).  Saving model ...
Epoch: 26 cost time: 0.4557154178619385
Epoch: 26, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.268 Vali Acc: 0.752 Test Loss: 1.268 Test Acc: 0.752
Validation loss decreased (-0.733320 --> -0.751839).  Saving model ...
Epoch: 27 cost time: 0.5169720649719238
Epoch: 27, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.240 Vali Acc: 0.763 Test Loss: 1.240 Test Acc: 0.763
Validation loss decreased (-0.751839 --> -0.762951).  Saving model ...
Epoch: 28 cost time: 0.6048233509063721
Epoch: 28, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.210 Vali Acc: 0.767 Test Loss: 1.210 Test Acc: 0.767
Validation loss decreased (-0.762951 --> -0.766655).  Saving model ...
Epoch: 29 cost time: 0.5378632545471191
Epoch: 29, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.180 Vali Acc: 0.774 Test Loss: 1.180 Test Acc: 0.774
Validation loss decreased (-0.766655 --> -0.774062).  Saving model ...
Epoch: 30 cost time: 0.6169328689575195
Epoch: 30, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.151 Vali Acc: 0.785 Test Loss: 1.151 Test Acc: 0.785
Validation loss decreased (-0.774062 --> -0.785174).  Saving model ...
Epoch: 31 cost time: 0.5221447944641113
Epoch: 31, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.121 Vali Acc: 0.781 Test Loss: 1.121 Test Acc: 0.781
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5027263164520264
Epoch: 32, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.090 Vali Acc: 0.781 Test Loss: 1.090 Test Acc: 0.781
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5161628723144531
Epoch: 33, Steps: 2 | Train Loss: 0.961 Vali Loss: 1.059 Vali Acc: 0.785 Test Loss: 1.059 Test Acc: 0.785
Validation loss decreased (-0.785174 --> -0.785175).  Saving model ...
Epoch: 34 cost time: 0.5234408378601074
Epoch: 34, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.028 Vali Acc: 0.796 Test Loss: 1.028 Test Acc: 0.796
Validation loss decreased (-0.785175 --> -0.796286).  Saving model ...
Epoch: 35 cost time: 0.5112884044647217
Epoch: 35, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.996 Vali Acc: 0.807 Test Loss: 0.996 Test Acc: 0.807
Validation loss decreased (-0.796286 --> -0.807397).  Saving model ...
Epoch: 36 cost time: 0.5307769775390625
Epoch: 36, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.965 Vali Acc: 0.819 Test Loss: 0.965 Test Acc: 0.819
Validation loss decreased (-0.807397 --> -0.818509).  Saving model ...
Epoch: 37 cost time: 0.6739580631256104
Epoch: 37, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.934 Vali Acc: 0.819 Test Loss: 0.934 Test Acc: 0.819
Validation loss decreased (-0.818509 --> -0.818509).  Saving model ...
Epoch: 38 cost time: 0.6614489555358887
Epoch: 38, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.904 Vali Acc: 0.826 Test Loss: 0.904 Test Acc: 0.826
Validation loss decreased (-0.818509 --> -0.825917).  Saving model ...
Epoch: 39 cost time: 0.5792813301086426
Epoch: 39, Steps: 2 | Train Loss: 0.728 Vali Loss: 0.875 Vali Acc: 0.841 Test Loss: 0.875 Test Acc: 0.841
Validation loss decreased (-0.825917 --> -0.840732).  Saving model ...
Epoch: 40 cost time: 0.6571440696716309
Epoch: 40, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.845 Vali Acc: 0.856 Test Loss: 0.845 Test Acc: 0.856
Validation loss decreased (-0.840732 --> -0.855547).  Saving model ...
Epoch: 41 cost time: 0.590825080871582
Epoch: 41, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.817 Vali Acc: 0.856 Test Loss: 0.817 Test Acc: 0.856
Validation loss decreased (-0.855547 --> -0.855547).  Saving model ...
Epoch: 42 cost time: 0.5244743824005127
Epoch: 42, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.789 Vali Acc: 0.852 Test Loss: 0.789 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6153414249420166
Epoch: 43, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.762 Vali Acc: 0.863 Test Loss: 0.762 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862955).  Saving model ...
Epoch: 44 cost time: 0.4717576503753662
Epoch: 44, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.736 Vali Acc: 0.863 Test Loss: 0.736 Test Acc: 0.863
Validation loss decreased (-0.862955 --> -0.862956).  Saving model ...
Epoch: 45 cost time: 0.5287940502166748
Epoch: 45, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.712 Vali Acc: 0.863 Test Loss: 0.712 Test Acc: 0.863
Validation loss decreased (-0.862956 --> -0.862956).  Saving model ...
Epoch: 46 cost time: 0.6033494472503662
Epoch: 46, Steps: 2 | Train Loss: 0.552 Vali Loss: 0.688 Vali Acc: 0.870 Test Loss: 0.688 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870363).  Saving model ...
Epoch: 47 cost time: 0.5776839256286621
Epoch: 47, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.666 Vali Acc: 0.878 Test Loss: 0.666 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 48 cost time: 0.57993483543396
Epoch: 48, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.644 Vali Acc: 0.874 Test Loss: 0.644 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5622243881225586
Epoch: 49, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.623 Vali Acc: 0.870 Test Loss: 0.623 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.5653619766235352
Epoch: 50, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.602 Vali Acc: 0.889 Test Loss: 0.602 Test Acc: 0.889
Validation loss decreased (-0.877771 --> -0.888883).  Saving model ...
Epoch: 51 cost time: 0.58664870262146
Epoch: 51, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.583 Vali Acc: 0.889 Test Loss: 0.583 Test Acc: 0.889
Validation loss decreased (-0.888883 --> -0.888883).  Saving model ...
Epoch: 52 cost time: 0.5481259822845459
Epoch: 52, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.563 Vali Acc: 0.896 Test Loss: 0.563 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 53 cost time: 0.4275949001312256
Epoch: 53, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.545 Vali Acc: 0.907 Test Loss: 0.545 Test Acc: 0.907
Validation loss decreased (-0.896291 --> -0.907402).  Saving model ...
Epoch: 54 cost time: 0.45240116119384766
Epoch: 54, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.527 Vali Acc: 0.919 Test Loss: 0.527 Test Acc: 0.919
Validation loss decreased (-0.907402 --> -0.918513).  Saving model ...
Epoch: 55 cost time: 0.45749807357788086
Epoch: 55, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.511 Vali Acc: 0.922 Test Loss: 0.511 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 56 cost time: 0.5332214832305908
Epoch: 56, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.496 Vali Acc: 0.915 Test Loss: 0.496 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5340738296508789
Epoch: 57, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.482 Vali Acc: 0.915 Test Loss: 0.482 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5754847526550293
Epoch: 58, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.469 Vali Acc: 0.915 Test Loss: 0.469 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5717043876647949
Epoch: 59, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.457 Vali Acc: 0.915 Test Loss: 0.457 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5113654136657715
Epoch: 60, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.446 Vali Acc: 0.911 Test Loss: 0.446 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.5926551818847656
Epoch: 61, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.437 Vali Acc: 0.904 Test Loss: 0.437 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.6862680912017822
Epoch: 62, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.428 Vali Acc: 0.904 Test Loss: 0.428 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.613450288772583
Epoch: 63, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.418 Vali Acc: 0.904 Test Loss: 0.418 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.63606858253479
Epoch: 64, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.410 Vali Acc: 0.904 Test Loss: 0.410 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.5923020839691162
Epoch: 65, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.401 Vali Acc: 0.907 Test Loss: 0.401 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc4_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 84254
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             3                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2015817165374756
Epoch: 1, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.943 Vali Acc: 0.207 Test Loss: 1.943 Test Acc: 0.207
Validation loss decreased (inf --> -0.207388).  Saving model ...
Epoch: 2 cost time: 0.6593458652496338
Epoch: 2, Steps: 2 | Train Loss: 1.930 Vali Loss: 1.908 Vali Acc: 0.215 Test Loss: 1.908 Test Acc: 0.215
Validation loss decreased (-0.207388 --> -0.214796).  Saving model ...
Epoch: 3 cost time: 0.5648224353790283
Epoch: 3, Steps: 2 | Train Loss: 1.854 Vali Loss: 1.884 Vali Acc: 0.211 Test Loss: 1.884 Test Acc: 0.211
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8117294311523438
Epoch: 4, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.866 Vali Acc: 0.215 Test Loss: 1.866 Test Acc: 0.215
Validation loss decreased (-0.214796 --> -0.214796).  Saving model ...
Epoch: 5 cost time: 0.6317498683929443
Epoch: 5, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.845 Vali Acc: 0.219 Test Loss: 1.845 Test Acc: 0.219
Validation loss decreased (-0.214796 --> -0.218500).  Saving model ...
Epoch: 6 cost time: 0.5178322792053223
Epoch: 6, Steps: 2 | Train Loss: 1.845 Vali Loss: 1.819 Vali Acc: 0.215 Test Loss: 1.819 Test Acc: 0.215
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.5020368099212646
Epoch: 7, Steps: 2 | Train Loss: 1.769 Vali Loss: 1.792 Vali Acc: 0.222 Test Loss: 1.792 Test Acc: 0.222
Validation loss decreased (-0.218500 --> -0.222204).  Saving model ...
Epoch: 8 cost time: 0.5035803318023682
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.766 Vali Acc: 0.233 Test Loss: 1.766 Test Acc: 0.233
Validation loss decreased (-0.222204 --> -0.233316).  Saving model ...
Epoch: 9 cost time: 0.47994399070739746
Epoch: 9, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.740 Vali Acc: 0.237 Test Loss: 1.740 Test Acc: 0.237
Validation loss decreased (-0.233316 --> -0.237020).  Saving model ...
Epoch: 10 cost time: 0.5500383377075195
Epoch: 10, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.715 Vali Acc: 0.244 Test Loss: 1.715 Test Acc: 0.244
Validation loss decreased (-0.237020 --> -0.244427).  Saving model ...
Epoch: 11 cost time: 0.6465692520141602
Epoch: 11, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.691 Vali Acc: 0.244 Test Loss: 1.691 Test Acc: 0.244
Validation loss decreased (-0.244427 --> -0.244428).  Saving model ...
Epoch: 12 cost time: 0.5150120258331299
Epoch: 12, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.666 Vali Acc: 0.278 Test Loss: 1.666 Test Acc: 0.278
Validation loss decreased (-0.244428 --> -0.277761).  Saving model ...
Epoch: 13 cost time: 0.546900749206543
Epoch: 13, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.640 Vali Acc: 0.359 Test Loss: 1.640 Test Acc: 0.359
Validation loss decreased (-0.277761 --> -0.359243).  Saving model ...
Epoch: 14 cost time: 0.5331020355224609
Epoch: 14, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.615 Vali Acc: 0.426 Test Loss: 1.615 Test Acc: 0.426
Validation loss decreased (-0.359243 --> -0.425910).  Saving model ...
Epoch: 15 cost time: 0.5687375068664551
Epoch: 15, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.589 Vali Acc: 0.485 Test Loss: 1.589 Test Acc: 0.485
Validation loss decreased (-0.425910 --> -0.485169).  Saving model ...
Epoch: 16 cost time: 0.4923107624053955
Epoch: 16, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.563 Vali Acc: 0.544 Test Loss: 1.563 Test Acc: 0.544
Validation loss decreased (-0.485169 --> -0.544429).  Saving model ...
Epoch: 17 cost time: 0.46185731887817383
Epoch: 17, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.535 Vali Acc: 0.574 Test Loss: 1.535 Test Acc: 0.574
Validation loss decreased (-0.544429 --> -0.574059).  Saving model ...
Epoch: 18 cost time: 0.606438398361206
Epoch: 18, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.506 Vali Acc: 0.615 Test Loss: 1.506 Test Acc: 0.615
Validation loss decreased (-0.574059 --> -0.614800).  Saving model ...
Epoch: 19 cost time: 0.5685226917266846
Epoch: 19, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.475 Vali Acc: 0.652 Test Loss: 1.475 Test Acc: 0.652
Validation loss decreased (-0.614800 --> -0.651837).  Saving model ...
Epoch: 20 cost time: 0.5797607898712158
Epoch: 20, Steps: 2 | Train Loss: 1.404 Vali Loss: 1.444 Vali Acc: 0.689 Test Loss: 1.444 Test Acc: 0.689
Validation loss decreased (-0.651837 --> -0.688874).  Saving model ...
Epoch: 21 cost time: 0.5309133529663086
Epoch: 21, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.413 Vali Acc: 0.704 Test Loss: 1.413 Test Acc: 0.704
Validation loss decreased (-0.688874 --> -0.703690).  Saving model ...
Epoch: 22 cost time: 0.6558427810668945
Epoch: 22, Steps: 2 | Train Loss: 1.371 Vali Loss: 1.382 Vali Acc: 0.722 Test Loss: 1.382 Test Acc: 0.722
Validation loss decreased (-0.703690 --> -0.722208).  Saving model ...
Epoch: 23 cost time: 0.577326774597168
Epoch: 23, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.350 Vali Acc: 0.737 Test Loss: 1.350 Test Acc: 0.737
Validation loss decreased (-0.722208 --> -0.737024).  Saving model ...
Epoch: 24 cost time: 0.5079984664916992
Epoch: 24, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.317 Vali Acc: 0.763 Test Loss: 1.317 Test Acc: 0.763
Validation loss decreased (-0.737024 --> -0.762950).  Saving model ...
Epoch: 25 cost time: 0.49642109870910645
Epoch: 25, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.284 Vali Acc: 0.778 Test Loss: 1.284 Test Acc: 0.778
Validation loss decreased (-0.762950 --> -0.777765).  Saving model ...
Epoch: 26 cost time: 0.4557223320007324
Epoch: 26, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.250 Vali Acc: 0.796 Test Loss: 1.250 Test Acc: 0.796
Validation loss decreased (-0.777765 --> -0.796284).  Saving model ...
Epoch: 27 cost time: 0.5045228004455566
Epoch: 27, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.216 Vali Acc: 0.800 Test Loss: 1.216 Test Acc: 0.800
Validation loss decreased (-0.796284 --> -0.799988).  Saving model ...
Epoch: 28 cost time: 0.5084707736968994
Epoch: 28, Steps: 2 | Train Loss: 1.111 Vali Loss: 1.182 Vali Acc: 0.807 Test Loss: 1.182 Test Acc: 0.807
Validation loss decreased (-0.799988 --> -0.807396).  Saving model ...
Epoch: 29 cost time: 0.5726799964904785
Epoch: 29, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.147 Vali Acc: 0.822 Test Loss: 1.147 Test Acc: 0.822
Validation loss decreased (-0.807396 --> -0.822211).  Saving model ...
Epoch: 30 cost time: 0.5033309459686279
Epoch: 30, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.112 Vali Acc: 0.841 Test Loss: 1.112 Test Acc: 0.841
Validation loss decreased (-0.822211 --> -0.840730).  Saving model ...
Epoch: 31 cost time: 0.5261285305023193
Epoch: 31, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.075 Vali Acc: 0.852 Test Loss: 1.075 Test Acc: 0.852
Validation loss decreased (-0.840730 --> -0.851841).  Saving model ...
Epoch: 32 cost time: 0.5229663848876953
Epoch: 32, Steps: 2 | Train Loss: 0.959 Vali Loss: 1.039 Vali Acc: 0.856 Test Loss: 1.039 Test Acc: 0.856
Validation loss decreased (-0.851841 --> -0.855545).  Saving model ...
Epoch: 33 cost time: 0.48247861862182617
Epoch: 33, Steps: 2 | Train Loss: 0.960 Vali Loss: 1.004 Vali Acc: 0.878 Test Loss: 1.004 Test Acc: 0.878
Validation loss decreased (-0.855545 --> -0.877768).  Saving model ...
Epoch: 34 cost time: 0.4865572452545166
Epoch: 34, Steps: 2 | Train Loss: 0.898 Vali Loss: 0.971 Vali Acc: 0.874 Test Loss: 0.971 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.48110198974609375
Epoch: 35, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.938 Vali Acc: 0.885 Test Loss: 0.938 Test Acc: 0.885
Validation loss decreased (-0.877768 --> -0.885176).  Saving model ...
Epoch: 36 cost time: 0.49385690689086914
Epoch: 36, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.905 Vali Acc: 0.893 Test Loss: 0.905 Test Acc: 0.893
Validation loss decreased (-0.885176 --> -0.892584).  Saving model ...
Epoch: 37 cost time: 0.761986255645752
Epoch: 37, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.872 Vali Acc: 0.893 Test Loss: 0.872 Test Acc: 0.893
Validation loss decreased (-0.892584 --> -0.892584).  Saving model ...
Epoch: 38 cost time: 0.5128960609436035
Epoch: 38, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.840 Vali Acc: 0.896 Test Loss: 0.840 Test Acc: 0.896
Validation loss decreased (-0.892584 --> -0.896288).  Saving model ...
Epoch: 39 cost time: 0.5286858081817627
Epoch: 39, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.808 Vali Acc: 0.907 Test Loss: 0.808 Test Acc: 0.907
Validation loss decreased (-0.896288 --> -0.907399).  Saving model ...
Epoch: 40 cost time: 0.5570340156555176
Epoch: 40, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.777 Vali Acc: 0.911 Test Loss: 0.777 Test Acc: 0.911
Validation loss decreased (-0.907399 --> -0.911103).  Saving model ...
Epoch: 41 cost time: 0.6416072845458984
Epoch: 41, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.748 Vali Acc: 0.915 Test Loss: 0.748 Test Acc: 0.915
Validation loss decreased (-0.911103 --> -0.914807).  Saving model ...
Epoch: 42 cost time: 0.7256419658660889
Epoch: 42, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.719 Vali Acc: 0.919 Test Loss: 0.719 Test Acc: 0.919
Validation loss decreased (-0.914807 --> -0.918511).  Saving model ...
Epoch: 43 cost time: 0.5086016654968262
Epoch: 43, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.691 Vali Acc: 0.926 Test Loss: 0.691 Test Acc: 0.926
Validation loss decreased (-0.918511 --> -0.925919).  Saving model ...
Epoch: 44 cost time: 0.6136038303375244
Epoch: 44, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.665 Vali Acc: 0.930 Test Loss: 0.665 Test Acc: 0.930
Validation loss decreased (-0.925919 --> -0.929623).  Saving model ...
Epoch: 45 cost time: 0.45484089851379395
Epoch: 45, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.640 Vali Acc: 0.930 Test Loss: 0.640 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 46 cost time: 0.504479169845581
Epoch: 46, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.617 Vali Acc: 0.930 Test Loss: 0.617 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929623).  Saving model ...
Epoch: 47 cost time: 0.6477482318878174
Epoch: 47, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.594 Vali Acc: 0.930 Test Loss: 0.594 Test Acc: 0.930
Validation loss decreased (-0.929623 --> -0.929624).  Saving model ...
Epoch: 48 cost time: 0.6444439888000488
Epoch: 48, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.572 Vali Acc: 0.937 Test Loss: 0.572 Test Acc: 0.937
Validation loss decreased (-0.929624 --> -0.937031).  Saving model ...
Epoch: 49 cost time: 0.5446188449859619
Epoch: 49, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.553 Vali Acc: 0.937 Test Loss: 0.553 Test Acc: 0.937
Validation loss decreased (-0.937031 --> -0.937032).  Saving model ...
Epoch: 50 cost time: 0.6002497673034668
Epoch: 50, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.534 Vali Acc: 0.933 Test Loss: 0.534 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.5236542224884033
Epoch: 51, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.517 Vali Acc: 0.933 Test Loss: 0.517 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.4913060665130615
Epoch: 52, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.500 Vali Acc: 0.922 Test Loss: 0.500 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5127365589141846
Epoch: 53, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.485 Vali Acc: 0.922 Test Loss: 0.485 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5116961002349854
Epoch: 54, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.471 Vali Acc: 0.922 Test Loss: 0.471 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.6257219314575195
Epoch: 55, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.457 Vali Acc: 0.930 Test Loss: 0.457 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.5550634860992432
Epoch: 56, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.443 Vali Acc: 0.937 Test Loss: 0.443 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 57 cost time: 0.5251922607421875
Epoch: 57, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.430 Vali Acc: 0.933 Test Loss: 0.430 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 58 cost time: 0.6334569454193115
Epoch: 58, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.418 Vali Acc: 0.941 Test Loss: 0.418 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 59 cost time: 0.7024013996124268
Epoch: 59, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.407 Vali Acc: 0.941 Test Loss: 0.407 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 60 cost time: 0.6545639038085938
Epoch: 60, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.396 Vali Acc: 0.941 Test Loss: 0.396 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 61 cost time: 0.6302523612976074
Epoch: 61, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.387 Vali Acc: 0.941 Test Loss: 0.387 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 62 cost time: 0.499100923538208
Epoch: 62, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.378 Vali Acc: 0.941 Test Loss: 0.378 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 63 cost time: 0.5426859855651855
Epoch: 63, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.370 Vali Acc: 0.941 Test Loss: 0.370 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 64 cost time: 0.5132861137390137
Epoch: 64, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.362 Vali Acc: 0.941 Test Loss: 0.362 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 65 cost time: 0.5437288284301758
Epoch: 65, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.5470631122589111
Epoch: 66, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5696237087249756
Epoch: 67, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.342 Vali Acc: 0.930 Test Loss: 0.342 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.7001495361328125
Epoch: 68, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.336 Vali Acc: 0.930 Test Loss: 0.336 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.6676883697509766
Epoch: 69, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.330 Vali Acc: 0.930 Test Loss: 0.330 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.5288703441619873
Epoch: 70, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 71 cost time: 0.5796451568603516
Epoch: 71, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.318 Vali Acc: 0.937 Test Loss: 0.318 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 72 cost time: 0.5425539016723633
Epoch: 72, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.313 Vali Acc: 0.941 Test Loss: 0.313 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 73 cost time: 0.4737520217895508
Epoch: 73, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.308 Vali Acc: 0.948 Test Loss: 0.308 Test Acc: 0.948
Validation loss decreased (-0.940738 --> -0.948145).  Saving model ...
Epoch: 74 cost time: 0.5525667667388916
Epoch: 74, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.303 Vali Acc: 0.948 Test Loss: 0.303 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 75 cost time: 0.5013022422790527
Epoch: 75, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.299 Vali Acc: 0.948 Test Loss: 0.299 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 76 cost time: 0.522977352142334
Epoch: 76, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.294 Vali Acc: 0.948 Test Loss: 0.294 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 77 cost time: 0.5051465034484863
Epoch: 77, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.290 Vali Acc: 0.948 Test Loss: 0.290 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 78 cost time: 0.5333845615386963
Epoch: 78, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.286 Vali Acc: 0.948 Test Loss: 0.286 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 79 cost time: 0.5511684417724609
Epoch: 79, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.283 Vali Acc: 0.948 Test Loss: 0.283 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 80 cost time: 0.4848475456237793
Epoch: 80, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.280 Vali Acc: 0.948 Test Loss: 0.280 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 81 cost time: 0.48258042335510254
Epoch: 81, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.277 Vali Acc: 0.948 Test Loss: 0.277 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 82 cost time: 0.5245413780212402
Epoch: 82, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.6062982082366943
Epoch: 83, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.271 Vali Acc: 0.941 Test Loss: 0.271 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 84 cost time: 0.6139645576477051
Epoch: 84, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.269 Vali Acc: 0.941 Test Loss: 0.269 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 85 cost time: 0.5910446643829346
Epoch: 85, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.267 Vali Acc: 0.937 Test Loss: 0.267 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 86 cost time: 0.6202595233917236
Epoch: 86, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 87 cost time: 0.5230462551116943
Epoch: 87, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 88 cost time: 0.5485892295837402
Epoch: 88, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.261 Vali Acc: 0.937 Test Loss: 0.261 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 89 cost time: 0.562685489654541
Epoch: 89, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 90 cost time: 0.5774421691894531
Epoch: 90, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 91 cost time: 0.5002985000610352
Epoch: 91, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc3_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 84062
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             2                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8608605861663818
Epoch: 1, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.972 Vali Acc: 0.007 Test Loss: 1.972 Test Acc: 0.007
Validation loss decreased (inf --> -0.007388).  Saving model ...
Epoch: 2 cost time: 0.5204312801361084
Epoch: 2, Steps: 2 | Train Loss: 2.001 Vali Loss: 1.956 Vali Acc: 0.015 Test Loss: 1.956 Test Acc: 0.015
Validation loss decreased (-0.007388 --> -0.014795).  Saving model ...
Epoch: 3 cost time: 0.47110557556152344
Epoch: 3, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.944 Vali Acc: 0.011 Test Loss: 1.944 Test Acc: 0.011
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.5486354827880859
Epoch: 4, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.933 Vali Acc: 0.011 Test Loss: 1.933 Test Acc: 0.011
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.5619523525238037
Epoch: 5, Steps: 2 | Train Loss: 1.982 Vali Loss: 1.920 Vali Acc: 0.007 Test Loss: 1.920 Test Acc: 0.007
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.5763752460479736
Epoch: 6, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.904 Vali Acc: 0.019 Test Loss: 1.904 Test Acc: 0.019
Validation loss decreased (-0.014795 --> -0.018499).  Saving model ...
Epoch: 7 cost time: 0.5128810405731201
Epoch: 7, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.886 Vali Acc: 0.026 Test Loss: 1.886 Test Acc: 0.026
Validation loss decreased (-0.018499 --> -0.025907).  Saving model ...
Epoch: 8 cost time: 0.5931055545806885
Epoch: 8, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.867 Vali Acc: 0.044 Test Loss: 1.867 Test Acc: 0.044
Validation loss decreased (-0.025907 --> -0.044426).  Saving model ...
Epoch: 9 cost time: 0.5903956890106201
Epoch: 9, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.847 Vali Acc: 0.056 Test Loss: 1.847 Test Acc: 0.056
Validation loss decreased (-0.044426 --> -0.055537).  Saving model ...
Epoch: 10 cost time: 0.4745602607727051
Epoch: 10, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.826 Vali Acc: 0.063 Test Loss: 1.826 Test Acc: 0.063
Validation loss decreased (-0.055537 --> -0.062945).  Saving model ...
Epoch: 11 cost time: 0.44453930854797363
Epoch: 11, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.803 Vali Acc: 0.085 Test Loss: 1.803 Test Acc: 0.085
Validation loss decreased (-0.062945 --> -0.085167).  Saving model ...
Epoch: 12 cost time: 0.40866565704345703
Epoch: 12, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.781 Vali Acc: 0.096 Test Loss: 1.781 Test Acc: 0.096
Validation loss decreased (-0.085167 --> -0.096278).  Saving model ...
Epoch: 13 cost time: 0.6762971878051758
Epoch: 13, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.758 Vali Acc: 0.130 Test Loss: 1.758 Test Acc: 0.130
Validation loss decreased (-0.096278 --> -0.129612).  Saving model ...
Epoch: 14 cost time: 0.5377695560455322
Epoch: 14, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.734 Vali Acc: 0.170 Test Loss: 1.734 Test Acc: 0.170
Validation loss decreased (-0.129612 --> -0.170353).  Saving model ...
Epoch: 15 cost time: 0.5047035217285156
Epoch: 15, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.709 Vali Acc: 0.204 Test Loss: 1.709 Test Acc: 0.204
Validation loss decreased (-0.170353 --> -0.203687).  Saving model ...
Epoch: 16 cost time: 0.48711085319519043
Epoch: 16, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.683 Vali Acc: 0.233 Test Loss: 1.683 Test Acc: 0.233
Validation loss decreased (-0.203687 --> -0.233317).  Saving model ...
Epoch: 17 cost time: 0.5242764949798584
Epoch: 17, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.656 Vali Acc: 0.263 Test Loss: 1.656 Test Acc: 0.263
Validation loss decreased (-0.233317 --> -0.262946).  Saving model ...
Epoch: 18 cost time: 0.6006073951721191
Epoch: 18, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.628 Vali Acc: 0.296 Test Loss: 1.628 Test Acc: 0.296
Validation loss decreased (-0.262946 --> -0.296280).  Saving model ...
Epoch: 19 cost time: 0.5149867534637451
Epoch: 19, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.598 Vali Acc: 0.385 Test Loss: 1.598 Test Acc: 0.385
Validation loss decreased (-0.296280 --> -0.385169).  Saving model ...
Epoch: 20 cost time: 0.5475311279296875
Epoch: 20, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.569 Vali Acc: 0.441 Test Loss: 1.569 Test Acc: 0.441
Validation loss decreased (-0.385169 --> -0.440725).  Saving model ...
Epoch: 21 cost time: 0.48400378227233887
Epoch: 21, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.538 Vali Acc: 0.493 Test Loss: 1.538 Test Acc: 0.493
Validation loss decreased (-0.440725 --> -0.492577).  Saving model ...
Epoch: 22 cost time: 0.4967780113220215
Epoch: 22, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.508 Vali Acc: 0.541 Test Loss: 1.508 Test Acc: 0.541
Validation loss decreased (-0.492577 --> -0.540726).  Saving model ...
Epoch: 23 cost time: 0.4775874614715576
Epoch: 23, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.476 Vali Acc: 0.578 Test Loss: 1.476 Test Acc: 0.578
Validation loss decreased (-0.540726 --> -0.577763).  Saving model ...
Epoch: 24 cost time: 0.5128405094146729
Epoch: 24, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.445 Vali Acc: 0.611 Test Loss: 1.445 Test Acc: 0.611
Validation loss decreased (-0.577763 --> -0.611097).  Saving model ...
Epoch: 25 cost time: 0.6234321594238281
Epoch: 25, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.413 Vali Acc: 0.626 Test Loss: 1.413 Test Acc: 0.626
Validation loss decreased (-0.611097 --> -0.625912).  Saving model ...
Epoch: 26 cost time: 0.5059468746185303
Epoch: 26, Steps: 2 | Train Loss: 1.269 Vali Loss: 1.381 Vali Acc: 0.637 Test Loss: 1.381 Test Acc: 0.637
Validation loss decreased (-0.625912 --> -0.637023).  Saving model ...
Epoch: 27 cost time: 0.5956988334655762
Epoch: 27, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.349 Vali Acc: 0.663 Test Loss: 1.349 Test Acc: 0.663
Validation loss decreased (-0.637023 --> -0.662949).  Saving model ...
Epoch: 28 cost time: 0.5368566513061523
Epoch: 28, Steps: 2 | Train Loss: 1.249 Vali Loss: 1.317 Vali Acc: 0.689 Test Loss: 1.317 Test Acc: 0.689
Validation loss decreased (-0.662949 --> -0.688876).  Saving model ...
Epoch: 29 cost time: 0.5310335159301758
Epoch: 29, Steps: 2 | Train Loss: 1.238 Vali Loss: 1.284 Vali Acc: 0.707 Test Loss: 1.284 Test Acc: 0.707
Validation loss decreased (-0.688876 --> -0.707395).  Saving model ...
Epoch: 30 cost time: 0.516455888748169
Epoch: 30, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.249 Vali Acc: 0.726 Test Loss: 1.249 Test Acc: 0.726
Validation loss decreased (-0.707395 --> -0.725913).  Saving model ...
Epoch: 31 cost time: 0.4312317371368408
Epoch: 31, Steps: 2 | Train Loss: 1.117 Vali Loss: 1.214 Vali Acc: 0.748 Test Loss: 1.214 Test Acc: 0.748
Validation loss decreased (-0.725913 --> -0.748136).  Saving model ...
Epoch: 32 cost time: 0.47737789154052734
Epoch: 32, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.180 Vali Acc: 0.770 Test Loss: 1.180 Test Acc: 0.770
Validation loss decreased (-0.748136 --> -0.770359).  Saving model ...
Epoch: 33 cost time: 0.504939079284668
Epoch: 33, Steps: 2 | Train Loss: 1.018 Vali Loss: 1.145 Vali Acc: 0.793 Test Loss: 1.145 Test Acc: 0.793
Validation loss decreased (-0.770359 --> -0.792581).  Saving model ...
Epoch: 34 cost time: 0.6464684009552002
Epoch: 34, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.112 Vali Acc: 0.796 Test Loss: 1.112 Test Acc: 0.796
Validation loss decreased (-0.792581 --> -0.796285).  Saving model ...
Epoch: 35 cost time: 0.5113298892974854
Epoch: 35, Steps: 2 | Train Loss: 0.971 Vali Loss: 1.077 Vali Acc: 0.807 Test Loss: 1.077 Test Acc: 0.807
Validation loss decreased (-0.796285 --> -0.807397).  Saving model ...
Epoch: 36 cost time: 0.5646920204162598
Epoch: 36, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.042 Vali Acc: 0.815 Test Loss: 1.042 Test Acc: 0.815
Validation loss decreased (-0.807397 --> -0.814804).  Saving model ...
Epoch: 37 cost time: 0.4871056079864502
Epoch: 37, Steps: 2 | Train Loss: 0.896 Vali Loss: 1.006 Vali Acc: 0.815 Test Loss: 1.006 Test Acc: 0.815
Validation loss decreased (-0.814804 --> -0.814805).  Saving model ...
Epoch: 38 cost time: 0.5485744476318359
Epoch: 38, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.971 Vali Acc: 0.826 Test Loss: 0.971 Test Acc: 0.826
Validation loss decreased (-0.814805 --> -0.825916).  Saving model ...
Epoch: 39 cost time: 0.605323314666748
Epoch: 39, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.937 Vali Acc: 0.826 Test Loss: 0.937 Test Acc: 0.826
Validation loss decreased (-0.825916 --> -0.825917).  Saving model ...
Epoch: 40 cost time: 0.46779918670654297
Epoch: 40, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.904 Vali Acc: 0.830 Test Loss: 0.904 Test Acc: 0.830
Validation loss decreased (-0.825917 --> -0.829621).  Saving model ...
Epoch: 41 cost time: 0.5232079029083252
Epoch: 41, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.871 Vali Acc: 0.848 Test Loss: 0.871 Test Acc: 0.848
Validation loss decreased (-0.829621 --> -0.848139).  Saving model ...
Epoch: 42 cost time: 0.5517387390136719
Epoch: 42, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.838 Vali Acc: 0.856 Test Loss: 0.838 Test Acc: 0.856
Validation loss decreased (-0.848139 --> -0.855547).  Saving model ...
Epoch: 43 cost time: 0.6343762874603271
Epoch: 43, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.807 Vali Acc: 0.859 Test Loss: 0.807 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859251).  Saving model ...
Epoch: 44 cost time: 0.5295534133911133
Epoch: 44, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.776 Vali Acc: 0.867 Test Loss: 0.776 Test Acc: 0.867
Validation loss decreased (-0.859251 --> -0.866659).  Saving model ...
Epoch: 45 cost time: 0.5374488830566406
Epoch: 45, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.747 Vali Acc: 0.878 Test Loss: 0.747 Test Acc: 0.878
Validation loss decreased (-0.866659 --> -0.877770).  Saving model ...
Epoch: 46 cost time: 0.5321376323699951
Epoch: 46, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.719 Vali Acc: 0.885 Test Loss: 0.719 Test Acc: 0.885
Validation loss decreased (-0.877770 --> -0.885178).  Saving model ...
Epoch: 47 cost time: 0.6237697601318359
Epoch: 47, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.692 Vali Acc: 0.893 Test Loss: 0.692 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 48 cost time: 0.45487093925476074
Epoch: 48, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.666 Vali Acc: 0.896 Test Loss: 0.666 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896290).  Saving model ...
Epoch: 49 cost time: 0.5538802146911621
Epoch: 49, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.642 Vali Acc: 0.900 Test Loss: 0.642 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 50 cost time: 0.5334491729736328
Epoch: 50, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.619 Vali Acc: 0.904 Test Loss: 0.619 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903698).  Saving model ...
Epoch: 51 cost time: 0.48549628257751465
Epoch: 51, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.597 Vali Acc: 0.900 Test Loss: 0.597 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7200899124145508
Epoch: 52, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.576 Vali Acc: 0.907 Test Loss: 0.576 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 53 cost time: 0.5577301979064941
Epoch: 53, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.557 Vali Acc: 0.911 Test Loss: 0.557 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 54 cost time: 0.6340422630310059
Epoch: 54, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.539 Vali Acc: 0.922 Test Loss: 0.539 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922217).  Saving model ...
Epoch: 55 cost time: 0.6103782653808594
Epoch: 55, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.521 Vali Acc: 0.922 Test Loss: 0.521 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 56 cost time: 0.5567927360534668
Epoch: 56, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.505 Vali Acc: 0.926 Test Loss: 0.505 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 57 cost time: 0.5270466804504395
Epoch: 57, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.491 Vali Acc: 0.930 Test Loss: 0.491 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 58 cost time: 0.5722723007202148
Epoch: 58, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.477 Vali Acc: 0.926 Test Loss: 0.477 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5167996883392334
Epoch: 59, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.464 Vali Acc: 0.922 Test Loss: 0.464 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5324838161468506
Epoch: 60, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.451 Vali Acc: 0.926 Test Loss: 0.451 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5492870807647705
Epoch: 61, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.438 Vali Acc: 0.930 Test Loss: 0.438 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 62 cost time: 0.7125945091247559
Epoch: 62, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.426 Vali Acc: 0.937 Test Loss: 0.426 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 63 cost time: 0.6243364810943604
Epoch: 63, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.415 Vali Acc: 0.937 Test Loss: 0.415 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 64 cost time: 0.5075395107269287
Epoch: 64, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.406 Vali Acc: 0.933 Test Loss: 0.406 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.62430739402771
Epoch: 65, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.396 Vali Acc: 0.933 Test Loss: 0.396 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.6269090175628662
Epoch: 66, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.387 Vali Acc: 0.933 Test Loss: 0.387 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.5801622867584229
Epoch: 67, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.379 Vali Acc: 0.933 Test Loss: 0.379 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.5240588188171387
Epoch: 68, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.370 Vali Acc: 0.933 Test Loss: 0.370 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.45336365699768066
Epoch: 69, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.363 Vali Acc: 0.941 Test Loss: 0.363 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 70 cost time: 0.5140817165374756
Epoch: 70, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.355 Vali Acc: 0.941 Test Loss: 0.355 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 71 cost time: 0.4971659183502197
Epoch: 71, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.349 Vali Acc: 0.948 Test Loss: 0.349 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 72 cost time: 0.4640200138092041
Epoch: 72, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.342 Vali Acc: 0.944 Test Loss: 0.342 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.5181689262390137
Epoch: 73, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.336 Vali Acc: 0.944 Test Loss: 0.336 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.5168271064758301
Epoch: 74, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.331 Vali Acc: 0.941 Test Loss: 0.331 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.5184164047241211
Epoch: 75, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.325 Vali Acc: 0.937 Test Loss: 0.325 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.48123860359191895
Epoch: 76, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.321 Vali Acc: 0.944 Test Loss: 0.321 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.4907662868499756
Epoch: 77, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.316 Vali Acc: 0.941 Test Loss: 0.316 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.48056602478027344
Epoch: 78, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.312 Vali Acc: 0.933 Test Loss: 0.312 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.5236837863922119
Epoch: 79, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.6054062843322754
Epoch: 80, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.304 Vali Acc: 0.933 Test Loss: 0.304 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.49240589141845703
Epoch: 81, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.300 Vali Acc: 0.937 Test Loss: 0.300 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc2_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 83870
model size : 1.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              Crossformer         

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              5                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.920231819152832
Epoch: 1, Steps: 2 | Train Loss: 2.015 Vali Loss: 1.906 Vali Acc: 0.181 Test Loss: 1.906 Test Acc: 0.181
Validation loss decreased (inf --> -0.181462).  Saving model ...
Epoch: 2 cost time: 0.5144407749176025
Epoch: 2, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.888 Vali Acc: 0.185 Test Loss: 1.888 Test Acc: 0.185
Validation loss decreased (-0.181462 --> -0.185166).  Saving model ...
Epoch: 3 cost time: 0.6420032978057861
Epoch: 3, Steps: 2 | Train Loss: 2.008 Vali Loss: 1.876 Vali Acc: 0.189 Test Loss: 1.876 Test Acc: 0.189
Validation loss decreased (-0.185166 --> -0.188870).  Saving model ...
Epoch: 4 cost time: 0.7131283283233643
Epoch: 4, Steps: 2 | Train Loss: 1.944 Vali Loss: 1.866 Vali Acc: 0.211 Test Loss: 1.866 Test Acc: 0.211
Validation loss decreased (-0.188870 --> -0.211092).  Saving model ...
Epoch: 5 cost time: 0.5537078380584717
Epoch: 5, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.853 Vali Acc: 0.222 Test Loss: 1.853 Test Acc: 0.222
Validation loss decreased (-0.211092 --> -0.222204).  Saving model ...
Epoch: 6 cost time: 0.5179920196533203
Epoch: 6, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.839 Vali Acc: 0.244 Test Loss: 1.839 Test Acc: 0.244
Validation loss decreased (-0.222204 --> -0.244426).  Saving model ...
Epoch: 7 cost time: 0.5555787086486816
Epoch: 7, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.823 Vali Acc: 0.270 Test Loss: 1.823 Test Acc: 0.270
Validation loss decreased (-0.244426 --> -0.270352).  Saving model ...
Epoch: 8 cost time: 0.521449089050293
Epoch: 8, Steps: 2 | Train Loss: 1.925 Vali Loss: 1.806 Vali Acc: 0.296 Test Loss: 1.806 Test Acc: 0.296
Validation loss decreased (-0.270352 --> -0.296278).  Saving model ...
Epoch: 9 cost time: 0.5851013660430908
Epoch: 9, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.787 Vali Acc: 0.337 Test Loss: 1.787 Test Acc: 0.337
Validation loss decreased (-0.296278 --> -0.337019).  Saving model ...
Epoch: 10 cost time: 0.6553859710693359
Epoch: 10, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.768 Vali Acc: 0.370 Test Loss: 1.768 Test Acc: 0.370
Validation loss decreased (-0.337019 --> -0.370353).  Saving model ...
Epoch: 11 cost time: 0.6487791538238525
Epoch: 11, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.747 Vali Acc: 0.385 Test Loss: 1.747 Test Acc: 0.385
Validation loss decreased (-0.370353 --> -0.385168).  Saving model ...
Epoch: 12 cost time: 0.48319220542907715
Epoch: 12, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.725 Vali Acc: 0.400 Test Loss: 1.725 Test Acc: 0.400
Validation loss decreased (-0.385168 --> -0.399983).  Saving model ...
Epoch: 13 cost time: 0.5926282405853271
Epoch: 13, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.703 Vali Acc: 0.411 Test Loss: 1.703 Test Acc: 0.411
Validation loss decreased (-0.399983 --> -0.411094).  Saving model ...
Epoch: 14 cost time: 0.7517373561859131
Epoch: 14, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.680 Vali Acc: 0.437 Test Loss: 1.680 Test Acc: 0.437
Validation loss decreased (-0.411094 --> -0.437020).  Saving model ...
Epoch: 15 cost time: 0.6071591377258301
Epoch: 15, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.656 Vali Acc: 0.441 Test Loss: 1.656 Test Acc: 0.441
Validation loss decreased (-0.437020 --> -0.440724).  Saving model ...
Epoch: 16 cost time: 0.6675198078155518
Epoch: 16, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.631 Vali Acc: 0.456 Test Loss: 1.631 Test Acc: 0.456
Validation loss decreased (-0.440724 --> -0.455539).  Saving model ...
Epoch: 17 cost time: 0.635185956954956
Epoch: 17, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.605 Vali Acc: 0.474 Test Loss: 1.605 Test Acc: 0.474
Validation loss decreased (-0.455539 --> -0.474058).  Saving model ...
Epoch: 18 cost time: 0.7417478561401367
Epoch: 18, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.579 Vali Acc: 0.500 Test Loss: 1.579 Test Acc: 0.500
Validation loss decreased (-0.474058 --> -0.499984).  Saving model ...
Epoch: 19 cost time: 0.5321927070617676
Epoch: 19, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.551 Vali Acc: 0.552 Test Loss: 1.551 Test Acc: 0.552
Validation loss decreased (-0.499984 --> -0.551836).  Saving model ...
Epoch: 20 cost time: 0.4886484146118164
Epoch: 20, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.522 Vali Acc: 0.596 Test Loss: 1.522 Test Acc: 0.596
Validation loss decreased (-0.551836 --> -0.596281).  Saving model ...
Epoch: 21 cost time: 0.49606847763061523
Epoch: 21, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.493 Vali Acc: 0.619 Test Loss: 1.493 Test Acc: 0.619
Validation loss decreased (-0.596281 --> -0.618504).  Saving model ...
Epoch: 22 cost time: 0.5547168254852295
Epoch: 22, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.462 Vali Acc: 0.659 Test Loss: 1.462 Test Acc: 0.659
Validation loss decreased (-0.618504 --> -0.659245).  Saving model ...
Epoch: 23 cost time: 0.5639185905456543
Epoch: 23, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.431 Vali Acc: 0.681 Test Loss: 1.431 Test Acc: 0.681
Validation loss decreased (-0.659245 --> -0.681467).  Saving model ...
Epoch: 24 cost time: 0.44950103759765625
Epoch: 24, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.399 Vali Acc: 0.693 Test Loss: 1.399 Test Acc: 0.693
Validation loss decreased (-0.681467 --> -0.692579).  Saving model ...
Epoch: 25 cost time: 0.5899331569671631
Epoch: 25, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.368 Vali Acc: 0.693 Test Loss: 1.368 Test Acc: 0.693
Validation loss decreased (-0.692579 --> -0.692579).  Saving model ...
Epoch: 26 cost time: 0.5106194019317627
Epoch: 26, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.337 Vali Acc: 0.700 Test Loss: 1.337 Test Acc: 0.700
Validation loss decreased (-0.692579 --> -0.699987).  Saving model ...
Epoch: 27 cost time: 0.6251063346862793
Epoch: 27, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.305 Vali Acc: 0.700 Test Loss: 1.305 Test Acc: 0.700
Validation loss decreased (-0.699987 --> -0.699987).  Saving model ...
Epoch: 28 cost time: 0.47157788276672363
Epoch: 28, Steps: 2 | Train Loss: 1.197 Vali Loss: 1.274 Vali Acc: 0.715 Test Loss: 1.274 Test Acc: 0.715
Validation loss decreased (-0.699987 --> -0.714802).  Saving model ...
Epoch: 29 cost time: 0.460888147354126
Epoch: 29, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.242 Vali Acc: 0.733 Test Loss: 1.242 Test Acc: 0.733
Validation loss decreased (-0.714802 --> -0.733321).  Saving model ...
Epoch: 30 cost time: 0.6832268238067627
Epoch: 30, Steps: 2 | Train Loss: 1.184 Vali Loss: 1.209 Vali Acc: 0.741 Test Loss: 1.209 Test Acc: 0.741
Validation loss decreased (-0.733321 --> -0.740729).  Saving model ...
Epoch: 31 cost time: 0.5739147663116455
Epoch: 31, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.177 Vali Acc: 0.756 Test Loss: 1.177 Test Acc: 0.756
Validation loss decreased (-0.740729 --> -0.755544).  Saving model ...
Epoch: 32 cost time: 0.5267465114593506
Epoch: 32, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.144 Vali Acc: 0.778 Test Loss: 1.144 Test Acc: 0.778
Validation loss decreased (-0.755544 --> -0.777766).  Saving model ...
Epoch: 33 cost time: 0.591101884841919
Epoch: 33, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.112 Vali Acc: 0.815 Test Loss: 1.112 Test Acc: 0.815
Validation loss decreased (-0.777766 --> -0.814804).  Saving model ...
Epoch: 34 cost time: 0.6043996810913086
Epoch: 34, Steps: 2 | Train Loss: 1.027 Vali Loss: 1.079 Vali Acc: 0.811 Test Loss: 1.079 Test Acc: 0.811
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.743640661239624
Epoch: 35, Steps: 2 | Train Loss: 0.973 Vali Loss: 1.047 Vali Acc: 0.815 Test Loss: 1.047 Test Acc: 0.815
Validation loss decreased (-0.814804 --> -0.814804).  Saving model ...
Epoch: 36 cost time: 0.7297139167785645
Epoch: 36, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.016 Vali Acc: 0.815 Test Loss: 1.016 Test Acc: 0.815
Validation loss decreased (-0.814804 --> -0.814805).  Saving model ...
Epoch: 37 cost time: 0.5815572738647461
Epoch: 37, Steps: 2 | Train Loss: 0.963 Vali Loss: 0.985 Vali Acc: 0.837 Test Loss: 0.985 Test Acc: 0.837
Validation loss decreased (-0.814805 --> -0.837027).  Saving model ...
Epoch: 38 cost time: 0.5445659160614014
Epoch: 38, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.955 Vali Acc: 0.837 Test Loss: 0.955 Test Acc: 0.837
Validation loss decreased (-0.837027 --> -0.837027).  Saving model ...
Epoch: 39 cost time: 0.6585829257965088
Epoch: 39, Steps: 2 | Train Loss: 0.874 Vali Loss: 0.924 Vali Acc: 0.837 Test Loss: 0.924 Test Acc: 0.837
Validation loss decreased (-0.837027 --> -0.837028).  Saving model ...
Epoch: 40 cost time: 0.7223222255706787
Epoch: 40, Steps: 2 | Train Loss: 0.842 Vali Loss: 0.893 Vali Acc: 0.856 Test Loss: 0.893 Test Acc: 0.856
Validation loss decreased (-0.837028 --> -0.855547).  Saving model ...
Epoch: 41 cost time: 0.6576225757598877
Epoch: 41, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.861 Vali Acc: 0.863 Test Loss: 0.861 Test Acc: 0.863
Validation loss decreased (-0.855547 --> -0.862954).  Saving model ...
Epoch: 42 cost time: 0.5124497413635254
Epoch: 42, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.829 Vali Acc: 0.874 Test Loss: 0.829 Test Acc: 0.874
Validation loss decreased (-0.862954 --> -0.874066).  Saving model ...
Epoch: 43 cost time: 0.6180868148803711
Epoch: 43, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.798 Vali Acc: 0.885 Test Loss: 0.798 Test Acc: 0.885
Validation loss decreased (-0.874066 --> -0.885177).  Saving model ...
Epoch: 44 cost time: 0.49747252464294434
Epoch: 44, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.768 Vali Acc: 0.896 Test Loss: 0.768 Test Acc: 0.896
Validation loss decreased (-0.885177 --> -0.896289).  Saving model ...
Epoch: 45 cost time: 0.6540095806121826
Epoch: 45, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.738 Vali Acc: 0.904 Test Loss: 0.738 Test Acc: 0.904
Validation loss decreased (-0.896289 --> -0.903696).  Saving model ...
Epoch: 46 cost time: 0.5740053653717041
Epoch: 46, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.710 Vali Acc: 0.907 Test Loss: 0.710 Test Acc: 0.907
Validation loss decreased (-0.903696 --> -0.907400).  Saving model ...
Epoch: 47 cost time: 0.5516045093536377
Epoch: 47, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.683 Vali Acc: 0.911 Test Loss: 0.683 Test Acc: 0.911
Validation loss decreased (-0.907400 --> -0.911104).  Saving model ...
Epoch: 48 cost time: 0.6317789554595947
Epoch: 48, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.658 Vali Acc: 0.915 Test Loss: 0.658 Test Acc: 0.915
Validation loss decreased (-0.911104 --> -0.914808).  Saving model ...
Epoch: 49 cost time: 0.5314967632293701
Epoch: 49, Steps: 2 | Train Loss: 0.517 Vali Loss: 0.633 Vali Acc: 0.922 Test Loss: 0.633 Test Acc: 0.922
Validation loss decreased (-0.914808 --> -0.922216).  Saving model ...
Epoch: 50 cost time: 0.7327888011932373
Epoch: 50, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.609 Vali Acc: 0.926 Test Loss: 0.609 Test Acc: 0.926
Validation loss decreased (-0.922216 --> -0.925920).  Saving model ...
Epoch: 51 cost time: 0.7043240070343018
Epoch: 51, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.587 Vali Acc: 0.933 Test Loss: 0.587 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933327).  Saving model ...
Epoch: 52 cost time: 0.5278623104095459
Epoch: 52, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.566 Vali Acc: 0.933 Test Loss: 0.566 Test Acc: 0.933
Validation loss decreased (-0.933327 --> -0.933328).  Saving model ...
Epoch: 53 cost time: 0.6801443099975586
Epoch: 53, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.546 Vali Acc: 0.937 Test Loss: 0.546 Test Acc: 0.937
Validation loss decreased (-0.933328 --> -0.937032).  Saving model ...
Epoch: 54 cost time: 0.6010398864746094
Epoch: 54, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.527 Vali Acc: 0.937 Test Loss: 0.527 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 55 cost time: 0.5429246425628662
Epoch: 55, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.509 Vali Acc: 0.937 Test Loss: 0.509 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 56 cost time: 0.6435501575469971
Epoch: 56, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.493 Vali Acc: 0.933 Test Loss: 0.493 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6688551902770996
Epoch: 57, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.478 Vali Acc: 0.933 Test Loss: 0.478 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6327142715454102
Epoch: 58, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.464 Vali Acc: 0.922 Test Loss: 0.464 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6227102279663086
Epoch: 59, Steps: 2 | Train Loss: 0.272 Vali Loss: 0.451 Vali Acc: 0.922 Test Loss: 0.451 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.7680881023406982
Epoch: 60, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.437 Vali Acc: 0.922 Test Loss: 0.437 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.5819370746612549
Epoch: 61, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.424 Vali Acc: 0.922 Test Loss: 0.424 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.5570476055145264
Epoch: 62, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.412 Vali Acc: 0.922 Test Loss: 0.412 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.6020069122314453
Epoch: 63, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.399 Vali Acc: 0.937 Test Loss: 0.399 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 64 cost time: 0.5603327751159668
Epoch: 64, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.387 Vali Acc: 0.941 Test Loss: 0.387 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 65 cost time: 0.5827069282531738
Epoch: 65, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.376 Vali Acc: 0.944 Test Loss: 0.376 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 66 cost time: 0.5434088706970215
Epoch: 66, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.366 Vali Acc: 0.944 Test Loss: 0.366 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 67 cost time: 0.5223953723907471
Epoch: 67, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.358 Vali Acc: 0.944 Test Loss: 0.358 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 68 cost time: 0.4941370487213135
Epoch: 68, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.350 Vali Acc: 0.948 Test Loss: 0.350 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 69 cost time: 0.5819861888885498
Epoch: 69, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.344 Vali Acc: 0.948 Test Loss: 0.344 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 70 cost time: 0.5676679611206055
Epoch: 70, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.337 Vali Acc: 0.944 Test Loss: 0.337 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.6873228549957275
Epoch: 71, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.330 Vali Acc: 0.941 Test Loss: 0.330 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.5995547771453857
Epoch: 72, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.6043810844421387
Epoch: 73, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.316 Vali Acc: 0.944 Test Loss: 0.316 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.5504999160766602
Epoch: 74, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.309 Vali Acc: 0.944 Test Loss: 0.309 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.6499848365783691
Epoch: 75, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.302 Vali Acc: 0.941 Test Loss: 0.302 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.6108949184417725
Epoch: 76, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.296 Vali Acc: 0.941 Test Loss: 0.296 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.6496388912200928
Epoch: 77, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.7081518173217773
Epoch: 78, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.286 Vali Acc: 0.941 Test Loss: 0.286 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.6539897918701172
Epoch: 79, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.282 Vali Acc: 0.941 Test Loss: 0.282 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_Crossformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_expand2_dc4_fc1_ebtimeF_dtTrue_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 83678
model size : 1.00MB
